http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, "Ambassador Diagnostic Overview", "Ambassador version")
    - contains_any(body, "Cluster ID", "Ambassador Route Table", "Ambassador namespace")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/ambassador/v0/diag/'
id: ambassador-api-diagnostics-exposure
info:
  author: 0x_Akoko
  description: 'Detected Ambassador API Gateway diagnostics portal, revealing service
    mappings, API endpoints, routing configurations, and internal cluster information.

    '
  metadata:
    fofa-query: title="Ambassador Diagnostic Overview"
    max-request: 1
    shodan-query: http.title:"Ambassador Diagnostic Overview"
    verified: true
  name: Ambassador API Gateway Diagnostics - Exposure
  reference:
  - https://www.getambassador.io/docs/edge-stack/latest/
  - https://www.getambassador.io/docs/edge-stack/latest/topics/running/diagnostics/
  severity: medium
  tags: exposure,ambassador,api,gateway,misconfig
