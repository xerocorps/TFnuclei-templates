http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - admin-css-mu
  - dsl:
    - compare_versions(version, '<= 2.6')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/admin-css-mu/readme.txt'
  redirects: true
id: CVE-2022-40700-284ef63a6f552bb64351e6d2cece204d
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-40700
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L
    cvss-score: 8.3
  description: 'The module cerdic/csstidy, which is used in several plugins, is vulnerable
    to Server-Side Request Forgery due to the inclusion of test code that does not
    verify a user-provided URL. This can allow unauthenticated attackers to to make
    web requests to arbitrary locations originating from the web application which
    can be used to query and modify information from internal services.

    '
  metadata:
    fofa-query: wp-content/plugins/admin-css-mu/
    google-query: inurl:"/wp-content/plugins/admin-css-mu/"
    shodan-query: vuln:CVE-2022-40700
  name: 'CSSTidy - Server-Side Request Forgery

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/fb534d86-c477-4a9c-b048-2fbc002168b2?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,admin-css-mu,high
