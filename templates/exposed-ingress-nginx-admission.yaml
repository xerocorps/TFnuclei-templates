id: exposed-ingress-nginx-admission
info:
  author: Wiz research
  description: Ingress Nginx admission controller endpoint should not be exposed
  metadata:
    max-request: 1
  name: Publicly exposed Ingress NGINX Admission
  severity: high
  tags: ssl,tls
ssl:
- address: '{{Host}}:{{Port}}'
  extractors:
  - json:
    - .issuer_org[0]
    name: issuer_org
    type: json
  - json:
    - .subject_org[0]
    name: subject_org
    type: json
  - json:
    - .subject_an[0]
    name: subject_an
    type: json
  matchers:
  - condition: and
    dsl:
    - contains(issuer_org, "nil1")
    - contains(subject_org, "nil2")
    - contains(subject_an, "nginx")
    type: dsl
