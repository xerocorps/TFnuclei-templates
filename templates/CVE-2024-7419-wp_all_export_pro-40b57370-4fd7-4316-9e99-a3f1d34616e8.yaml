http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-all-export-pro
  - dsl:
    - compare_versions(version, '<= 1.9.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-all-export-pro/readme.txt'
  redirects: true
id: CVE-2024-7419-wp_all_export_pro-40b57370-4fd7-4316-9e99-a3f1d34616e8
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-7419
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H
    cvss-score: 8.3
  description: 'The WP ALL Export Pro plugin for WordPress is vulnerable to Remote
    Code Execution in all versions up to, and including, 1.9.1 via the custom export
    fields. This is due to the missing input validation and sanitization of user-supplied
    data. This makes it possible for unauthenticated attackers to inject arbitrary
    PHP code into form fields that get executed on the server during the export, potentially
    leading to a complete site compromise.  As a prerequisite, the custom export field
    should include fields containing user-supplied data.

    '
  metadata:
    fofa-query: wp-content/plugins/wp-all-export-pro/
    google-query: inurl:"/wp-content/plugins/wp-all-export-pro/"
    shodan-query: http.html:"wp-content/plugins/wp-all-export-pro/"
  name: 'WP All Export Pro <= 1.9.1 - Unauthenticated Remote Code Execution via Custom
    Export Fields

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/40b57370-4fd7-4316-9e99-a3f1d34616e8?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,wp-all-export-pro,critical,production
