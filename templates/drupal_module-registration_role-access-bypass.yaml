http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '<= 2.0.1')
    type: dsl
  matchers:
  - condition: and
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - condition: and
    status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - registration_role
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/registration_role/registration_role.info'
  redirects: true
id: drupal_module-registration_role-access-bypass
info:
  author: me
  description: The Registration role module lets an administrator select a role (or
    multiple roles) to automatically assign to new users. The selected role (or roles)
    will be assigned to new registrants. The module has a logic error when handling
    sites that upgraded code and did not run the Drupal update process (e.g. update.php).
    This vulnerability is mitigated by the fact that the problem does not exist on
    sites that followed the process of updating code and running the standard updates.
  metadata:
    created_at: '2025-01-09'
    fofa-query: /sites/all/modules/registration_role/
    google-query: inurl:'/sites/all/modules/registration_role/
    impact: medium
    security-risk: "Critical 18\u2009\u2215\u200925 AC:Basic/A:None/CI:All/II:All/E:Theoretical/TD:Uncommon"
    type: indicator
    vulnerability: access-bypass
  name: drupal_module-registration_role-access-bypass
  reference:
  - https://www.drupal.org/sa-contrib-2024-015
  severity: medium
  tags: drupal
