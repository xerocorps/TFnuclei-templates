code:
- args:
  - -c
  - "# Check if the ldap-utils package is installed\nif dpkg-query -W -f='${Status}'\
    \ ldap-utils 2>/dev/null | grep -q \"install ok installed\"; then\n  echo \"[cis-ldap-client-check:Policy-Fail]\
    \ [ldap-utils is installed] [CIS_FAIL]\"\nelse\n  echo \"[cis-ldap-client-check:Policy-Pass]\
    \ [ldap-utils is not installed] [CIS_PASS]\"\nfi\n"
  engine:
  - bash
  matchers:
  - name: policy-pass
    type: word
    words:
    - Policy-Pass
  - name: policy-fail
    type: word
    words:
    - Policy-Fail
id: ldap-client
info:
  author: Th3l0newolf
  description: "The ldap-utils package provides LDAP client utilities that allow systems\
    \ to query and interact with LDAP directories.If not explicitly required, it should\
    \ be removed to minimize the system\u2019s attack surface and reduce security\
    \ risks.\n"
  metadata:
    verified: true
  name: Ensure LDAP Client is Not Installed
  reference:
  - https://www.cisecurity.org/benchmark/ubuntu_linux
  remediation: '- Ensure the ldap-utils package is not installed unless explicitly
    required.

    - To remove the package, run: sudo apt-get remove ldap-utils -y

    '
  severity: info
  tags: cis,local,cisecurity,audit,linux,ubuntu,ldap
self-contained: true
