headless:
- matchers:
  - part: extract
    type: word
    words:
    - 'true'
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}'
  - action: waitload
  - action: script
    args:
      code: '() => {

        return (Reveal.VERSION <= "3.8.0" || Reveal.VERSION < "4.3.0")

        }

        '
    name: extract
id: CVE-2022-0776
info:
  author: LogicalHunter
  classification:
    cpe: cpe:2.3:a:revealjs:reveal.js:*:*:*:*:*:node.js:*:*
    cve-id: CVE-2022-0776
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.95283
    epss-score: 0.20046
  description: RevealJS postMessage before 4.3.0 contains a cross-site scripting vulnerability
    via the document object model.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to potential data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    framework: node.js
    product: reveal.js
    vendor: revealjs
  name: RevealJS postMessage <4.3.0 - Cross-Site Scripting
  reference:
  - https://hackerone.com/reports/691977
  - https://github.com/hakimel/reveal.js/pull/3137
  - https://huntr.dev/bounties/be2b7ee4-f487-42e1-874a-6bcc410e4001/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0776
  - https://github.com/hakimel/reveal.js/commit/32cdd3b1872ba8e2267c9e87ae216cb55f40f4d2
  remediation: 'Upgrade to RevealJS postMessage version 4.3.0 or later to mitigate
    this vulnerability.

    '
  severity: medium
  tags: cve,cve2022,hackerone,huntr,headless,postmessage,revealjs,node.js,vuln
