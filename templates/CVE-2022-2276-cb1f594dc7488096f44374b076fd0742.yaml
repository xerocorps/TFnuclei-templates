http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-edit-menu
  - dsl:
    - compare_versions(version, '< 1.5.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-edit-menu/readme.txt'
  redirects: true
id: CVE-2022-2276-cb1f594dc7488096f44374b076fd0742
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-2276
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
  description: 'The WP Edit Menu plugin for WordPress lacks authorization checks on
    one of its ajax action and is vulnerable to Arbitrary Post Deletion in versions
    below 1.5.0. This is due to a missing capability check in the function wpem_remove_menu_entry.
    This makes it possible for an unauthenticated attacker to delete posts and pages.

    '
  metadata:
    fofa-query: wp-content/plugins/wp-edit-menu/
    google-query: inurl:"/wp-content/plugins/wp-edit-menu/"
    shodan-query: vuln:CVE-2022-2276
  name: 'WP Edit Menu < 1.5.0 - Missing Authorization to Post Deletion

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/dce76d59-e798-4762-8247-eddebd38c165?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,wp-edit-menu,high
