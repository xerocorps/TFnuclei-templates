id: oracle-tns-listener
info:
  author: pussycat0x
  description: 'Oracle clients communicate with the database using the Transparent
    Network Substrate (TNS) protocol. When the listener receives a connection request
    (tcp port 1521, by default), it starts up a new database process and establishes
    a connection between the client and the database.

    '
  metadata:
    max-request: 1
    shodan-query: product:"Oracle TNS Listener"
    verified: true
  name: Oracle TNS Listener - Detect
  reference:
  - https://www.tenable.com/plugins/nessus/110053
  severity: info
  tags: js,detect,oracle,tns,network,discovery
javascript:
- args:
    Host: '{{Host}}'
    Port: '1521'
  code: 'var m = require("nuclei/oracle");

    var response = m.IsOracle(Host, Port);

    Export(response);

    '
  extractors:
  - name: Version
    regex:
    - Oracle TNS Listener Version:([0-9.]+)
    type: regex
  pre-condition: 'isPortOpen(Host,Port);

    '
