code:
- engine:
  - sh
  - bash
  matchers:
  - status:
    - 0
    type: status
  - negative: true
    type: word
    words:
    - does not exist
  matchers-condition: and
  source: 'defaults read /Library/Preferences/com.apple.loginwindow autoLoginUser
    2>&1

    '
id: auto-login-enabled
info:
  author: geeknik
  description: 'Checks if automatic login is enabled on macOS, allowing users to log
    in to the system without entering a password upon startup.

    '
  impact: 'Enabling automatic login can lead to unauthorized access to the user''s
    account and data if the device is physically accessed.

    '
  name: macOS Automatic Login Enabled
  remediation: 'Disable automatic login to require a password at startup and enhance
    physical security.

    '
  severity: high
  tags: macos,audit,local,security
self-contained: true
