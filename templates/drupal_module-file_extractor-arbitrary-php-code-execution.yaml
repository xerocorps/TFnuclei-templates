http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '4.0.0')
    - compare_versions(version, '3.0.0')
    - compare_versions(version, '2.0.2')
    - compare_versions(version, '2.0.1')
    - compare_versions(version, '2.0.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - file_extractor
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/file_extractor/file_extractor.info'
  redirects: true
id: drupal_module-file_extractor-arbitrary-php-code-execution
info:
  author: Bishopfox
  description: This module enables you to extract the textual content of files for
    use on a website, e.g. to display it or use it in search indexes. The module doesnt
    sufficiently protect the administrator-defined commands that are executed on the
    server, which leads to post-authentication remote code execution by a limited
    set of users. This vulnerability is mitigated by the fact that an attacker must
    have a role with the permission Administer File Extractor to access the settings
    form. Sites are encouraged to review which roles have that permission and which
    users have that role, to ensure that only trusted users have that permission.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/file_extractor/
    google-query: inurl:'/sites/all/modules/file_extractor/
    impact: medium
    security-risk: "Critical 15\u221525 AC:Complex/A:Admin/CI:All/II:All/E:Theoretical/TD:Default"
    type: indicator
    vulnerability: arbitrary-php-code-execution
  name: drupal_module-file_extractor-arbitrary-php-code-execution
  reference:
  - https://www.drupal.org/sa-contrib-2021-033
  severity: medium
  tags: drupal
