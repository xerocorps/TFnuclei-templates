http:
- extractors:
  - group: 1
    part: body
    regex:
    - <Name>([^<]+)</Name>
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/xml")
    - contains(header, "AliyunOSS")
    - contains_all(body, "<ListBucketResult", "<Name>", "<Contents>", "<Key>")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}'
id: alibaba-bucket-listing
info:
  author: 0x_Akoko
  description: 'Alibaba Cloud Object Storage Service (OSS) bucket is publicly accessible
    and allows anonymous listing of objects. This misconfiguration can expose sensitive
    data, lead to data breaches, and result in unexpected charges on the Alibaba Cloud
    bill.

    '
  metadata:
    google-query: site:aliyuncs.com "ListBucketResult" "<Contents>"
    max-request: 1
    verified: true
  name: Alibaba Cloud OSS Bucket - Public Listing Enabled
  reference:
  - https://www.alibabacloud.com/help/en/oss/user-guide/block-public-access
  - https://www.trendmicro.com/cloudoneconformity/knowledge-base/alibaba-cloud/AlibabaCloud-OSS/publicly-accessible-oss-bucket.html
  severity: unknown
  tags: alibaba,cloud,bucket,misconfig,exposure,devops,cicd
