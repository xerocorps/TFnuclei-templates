http:
- body: '{{valid_json}}'
  headers:
    Content-type: application/json
    Host: '{{Hostname}}'
  method: POST
  path:
  - '{{BaseURL}}'
- body: '{{invalid_json}}'
  extractors:
  - dsl:
    - http_1_status_code
    name: Valid json submission status code
    type: dsl
  - dsl:
    - http_2_status_code
    name: Invalid json submission status code
    type: dsl
  headers:
    Content-type: application/json
    Host: '{{Hostname}}'
  matchers:
  - dsl:
    - http_1_status_code == http_2_status_code
    name: JSON schema validation does not take place
    type: dsl
  method: POST
  path:
  - '{{BaseURL}}'
id: ASVS-4-0-3-V13-2-2
info:
  author: Hamed Salimian
  classification:
    cwe-id: CWE-20
  description: 'Verify that JSON schema validation is in place and verified before
    accepting input.

    '
  name: ASVS 13.2.2 Check
  reference:
  - https://snbig.github.io/Vulnerable-Pages/ASVS_13_2_2/index.html
  severity: medium
  tags: asvs,13.2.2
variables:
  invalid_json: '{"name":"John Doe","age":200}'
  valid_json: '{"name":"John Doe","age":20}'
