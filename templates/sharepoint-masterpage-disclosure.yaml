http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, "Master Page Gallery", "Recycle")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/_catalogs/masterpage/Forms/AllItems.aspx'
  - '{{BaseURL}}/_catalogs/15/masterpage/Forms/AllItems.aspx'
  stop-at-first-match: true
id: sharepoint-masterpage-disclosure
info:
  author: DhiyaneshDk
  description: 'Detected exposed SharePoint Master Page endpoints.

    '
  metadata:
    fofa-query: title="SharePoint"
    max-request: 2
    shodan-query: http.title:"SharePoint"
    verified: true
  name: Microsoft SharePoint - Master Page Disclosure
  reference:
  - https://sharepointstuff.com/2021/03/30/useful-sharepoint-urls/
  severity: low
  tags: sharepoint,microsoft,exposure,misconfig
