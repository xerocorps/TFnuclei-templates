id: cloud-enum-aws-s3-bucket
info:
  author: initstring
  description: Searches for open and protected buckets in AWS S3
  name: Cloud Enumeration - AWS S3 Buckets
  reference: tba
  severity: medium
  tags: cloud,aws
requests:
- attack: batteringram
  matchers:
  - name: Open AWS S3 Bucket
    status:
    - 200
    type: status
  - name: Protected AWS S3 Bucket
    status:
    - 403
    type: status
  raw:
  - 'GET http://{{keyword}}.{{baseDNS}} HTTP/1.1

    Host: {{keyword}}.{{baseDNS}}

    '
  redirects: false
  threads: 10
self-contained: true
variables:
  baseDNS: s3.amazonaws.com
