http:
- extractors:
  - group: 1
    part: body
    regex:
    - MapProxy(?i) ([0-9]+\.[0-9]+\.[0-9]+)
    type: regex
  host-redirects: true
  matchers:
  - condition: or
    part: body
    type: word
    words:
    - Welcome to MapProxy
    - MapProxy Demo
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/demo'
id: mappproxy-detect
info:
  author: philippedelteil
  description: 'Checks for a running MapProxy instance and obtain version number.
    Also checks if the demo page is enabled. MapProxy is an open source proxy for
    geospatial data. It caches, accelerates and transforms data from existing map
    services and serves any desktop or web GIS client.

    '
  metadata:
    max-request: 2
    shodan-query: http.html:"Welcome to MapProxy"
  name: Mapproxy - Detect
  reference:
  - https://github.com/mapproxy/mapproxy
  - https://mapproxy.org
  severity: info
  tags: tech,mapproxy,detect,discovery
