code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: hostedzones
    type: json
  source: 'aws route53 list-hosted-zones --region $region --query "HostedZones[*].Id"
    --output json

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - hostedzone + " DNSSEC Signing for Route 53 Hosted Zones is Disabled"
    type: dsl
  matchers:
  - type: word
    words:
    - NOT_SIGNING
  source: 'aws route53 get-dnssec --region $region --hosted-zone-id "$hostedzone"
    --query "Status.ServeSignature" --output json

    '
flow: "code(1)\nfor(let HostedZones of iterate(template.hostedzones)){\n  set(\"hostedzone\"\
  , HostedZones)\n  code(2)\n}\n"
id: route53-dnssec-signing-disabled
info:
  author: DhiyaneshDK
  description: 'Ensure that Domain Name System Security Extensions (DNSSEC) signing
    is enabled for your Amazon Route 53 public hosted zones in order to protect your
    domains against spoofing and cache poisoning attacks. By default, DNSSEC signing
    is not enabled for Route 53 hosted zones.

    '
  impact: 'Attackers can hijack the process of domain/IP lookup and redirect users
    to malicious web content through DNS hijacking and Man-In-The-Middle (MITM) attacks.
    DNSSEC security feature helps mitigate the risk of such attacks by encrypting
    signing DNS records.

    '
  name: DNSSEC Signing for Route 53 Hosted Zones - Disabled
  reference:
  - https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/Route53/enable-query-logging.html
  - https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/monitoring-overview.html
  remediation: 'Enable DNSSEC signing in the Route 53 console for the hosted zone,
    sign the zone with a strong key algorithm, and ensure all DNS records are published
    correctly.

    '
  severity: medium
  tags: cloud,devops,aws,amazon,route53,aws-cloud-config
self-contained: true
variables:
  region: us-west-2
