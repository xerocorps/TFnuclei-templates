http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '7.x-3.3')
    - compare_versions(version, '7.x-3.2')
    - compare_versions(version, '7.x-3.1')
    - compare_versions(version, '7.x-3.0')
    - compare_versions(version, '7.x-2.8')
    - compare_versions(version, '7.x-2.7')
    - compare_versions(version, '7.x-2.5')
    - compare_versions(version, '7.x-2.4')
    - compare_versions(version, '7.x-2.3')
    - compare_versions(version, '7.x-2.1')
    - compare_versions(version, '7.x-2.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - backup_migrate
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/backup_migrate/backup_migrate.info'
  redirects: true
id: drupal_module-backup_migrate-arbitrary-php-code-execution
info:
  author: Bishopfox
  description: This module enables you to create manual and scheduled backups of a
    site, and restore the site from backup. The module doesnt sufficiently identify
    that its custom permissions are risky and should only be granted to highly trusted
    roles. Sites using this module should review the permissions page to verify only
    trusted users are granted permissions defined by the module.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/backup_migrate/
    google-query: inurl:'/sites/all/modules/backup_migrate/
    impact: medium
    security-risk: "Critical 15\u221525 AC:Basic/A:User/CI:Some/II:All/E:Theoretical/TD:Default"
    type: indicator
    vulnerability: arbitrary-php-code-execution
  name: drupal_module-backup_migrate-arbitrary-php-code-execution
  reference:
  - https://www.drupal.org/sa-contrib-2018-004
  severity: medium
  tags: drupal
