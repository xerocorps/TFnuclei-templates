http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '<= 3.4.0 || >=4.0.0 <= 4.6.0')
    type: dsl
  matchers:
  - condition: and
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - condition: and
    status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - graphql
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/graphql/graphql.info'
  redirects: true
id: drupal_module-graphql-cross-site-request-forgery
info:
  author: me
  description: The GraphQL module enables you to build GraphQL APIs which can include
    data fetching through Queries and data updates (create, update, delete) through
    mutations. The module does not sufficiently validate incoming requests that are
    made from domains other than the one serving the GraphQL endpoint. In case a user
    visits a malicious site, that site may make requests on the users behalf which
    can lead to the execution of mutations, exposing a CSRF vulnerability. Whether
    data is returned to the malicious site depends on your sites CORS configuration.
    This vulnerability is mitigated by the fact that a user with access to the API
    must have an active session cookie while visiting a malicious site. This vulnerability
    is also mitigated by restricting session cookies with the SameSite attribute (see
    solution below).
  metadata:
    created_at: '2025-01-09'
    fofa-query: /sites/all/modules/graphql/
    google-query: inurl:'/sites/all/modules/graphql/
    impact: medium
    security-risk: "Moderately critical 12\u2009\u2215\u200925 AC:Basic/A:None/CI:None/II:Some/E:Theoretical/TD:Default"
    type: indicator
    vulnerability: cross-site-request-forgery
  name: drupal_module-graphql-cross-site-request-forgery
  reference:
  - https://www.drupal.org/sa-contrib-2023-051
  severity: medium
  tags: drupal
