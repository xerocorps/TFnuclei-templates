id: open-redirect-vulnerability
info:
  author: Mamilate
  description: This template detects open redirect vulnerabilities.
  name: Open Redirect Vulnerability
  severity: medium
  tags: open-redirect, redirect
requests:
- headers:
    User-Agent: nuclei-open-redirect-check
  matchers:
  - condition: and
    part: header
    type: word
    words:
    - https://evil.com
    - http://evil.com
  - status:
    - 302
    - 301
    type: status
  - part: header
    regex:
    - 'Location: .*evil\.com'
    type: regex
  method: GET
  path:
  - '{{BaseURL}}/redirect?url={{RedirectURL}}'
  - '{{BaseURL}}/redir?target={{RedirectURL}}'
  - '{{BaseURL}}/out?link={{RedirectURL}}'
  - '{{BaseURL}}/go?to={{RedirectURL}}'
  payloads:
    RedirectURL:
    - https://evil.com
    - http://evil.com
    - //evil.com
    - /\evil.com
