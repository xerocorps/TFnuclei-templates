http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '8.x-3.5')
    - compare_versions(version, '8.x-3.4')
    - compare_versions(version, '8.x-3.3')
    - compare_versions(version, '8.x-3.2')
    - compare_versions(version, '8.x-3.1')
    - compare_versions(version, '8.x-3.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - ctools
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/ctools/ctools.info'
  redirects: true
id: drupal_module-ctools-information-disclosure
info:
  author: Bishopfox
  description: Chaos tool suite (ctools) module provides a number of APIs and extensions
    for Drupal, its 8.x-3.x branch is a start from scratch to evaluate the features
    of ctools that didnt make it into Drupal Core 8.0.x and port them. The module
    doesnt sufficiently handle access control on its EntityView plugin. This vulnerability
    is mitigated by the fact that successful exploitation requires special conditions
    in place such as custom solutions that allow injecting the context by means other
    than the route.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/ctools/
    google-query: inurl:'/sites/all/modules/ctools/
    impact: medium
    security-risk: "Moderately critical 12\u221525 AC:Complex/A:None/CI:Some/II:None/E:Theoretical/TD:All"
    type: indicator
    vulnerability: information-disclosure
  name: drupal_module-ctools-information-disclosure
  reference:
  - https://www.drupal.org/sa-contrib-2021-009
  severity: medium
  tags: drupal
