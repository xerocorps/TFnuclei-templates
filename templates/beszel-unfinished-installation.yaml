http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/json")
    - contains(body, "\"firstRun\":true")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/api/beszel/first-run'
id: beszel-unfinished-installation
info:
  author: 0x_Akoko
  description: 'Detected Beszel server monitoring hub had an unfinished installation
    with no admin account configured, allowing attackers to create an admin account
    and gain full control.

    '
  metadata:
    fofa-query: body="globalThis.BESZEL"
    max-request: 1
    shodan-query: html:"globalThis.BESZEL"
    verified: true
  name: Beszel Unfinished Installation
  reference:
  - https://github.com/henrygd/beszel
  severity: high
  tags: beszel,misconfig,install,exposure
