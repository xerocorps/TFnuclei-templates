http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - envira-gallery-lite
  - dsl:
    - compare_versions(version, '< 1.8.3.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/envira-gallery-lite/readme.txt'
  redirects: true
id: CVE-2021-24126
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24126
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
  description: Unvalidated input and lack of output encoding in the Envira Gallery
    Lite WordPress plugin, versions before 1.8.3.3, did not properly sanitise the
    images metadata (namely title) before outputting them in the generated gallery,
    which could lead to privilege escalation.
  metadata:
    fofa-query: wp-content/plugins/envira-gallery-lite/
    google-query: inurl:"/wp-content/plugins/envira-gallery-lite/"
    shodan-query: vuln:CVE-2021-24126
  name: Envira Gallery Lite <= 1.8.3.2 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/f3952bd1-ac2f-4007-9e19-6c44a22465f3
  - https://plugins.trac.wordpress.org/changeset/2442591
  severity: medium
  tags: cve,wordpress,wp-plugin,envira-gallery-lite,medium
