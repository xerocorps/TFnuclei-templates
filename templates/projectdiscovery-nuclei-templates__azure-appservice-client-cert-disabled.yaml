code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: webAppIds
    type: json
  source: 'az webapp list --output json --query ''[*].id''

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"Client certificate not required for " + id'
    type: dsl
  matchers:
  - type: word
    words:
    - 'false'
  source: 'az webapp show --ids "$ids" --query ''clientCertEnabled'' --output json

    '
flow: "code(1);\nfor (let WebAppId of iterate(template.webAppIds)) {\n  set(\"ids\"\
  , WebAppId);\n  code(2);\n}\n"
id: azure-appservice-client-cert-disabled
info:
  author: princechaddha
  description: 'Ensure that your Microsoft Azure App Service web applications are
    configured to require an SSL certificate from all incoming requests, for security
    and compliance purposes. Once the certificate is implemented, only web clients
    that have this valid SSL certificate will be able to reach your web application.
    By default, incoming client certificates are disabled for Azure App Service web
    applications.

    '
  impact: 'If incoming client certificates are not required, unauthorized clients
    might be able to access the web application, which can lead to security breaches.

    '
  name: Azure App Service Client Certificate Not Required
  reference:
  - https://docs.microsoft.com/en-us/azure/app-service/configure-ssl-certificate#require-incoming-certificate
  remediation: 'Configure Azure App Services to require SSL certificates for incoming
    requests to enhance security and compliance with regulations.

    '
  severity: medium
  tags: cloud,devops,azure,microsoft,appservice,azure-cloud-config
self-contained: true
