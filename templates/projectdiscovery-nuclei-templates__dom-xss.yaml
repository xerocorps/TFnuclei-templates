headless:
- fuzzing:
  - fuzz:
    - '{{url_encode(reflection)}}'
    mode: single
    part: query
    type: postfix
  - fuzz:
    - '{{reflection}}'
    mode: single
    part: path
    type: postfix
  matchers:
  - condition: and
    dsl:
    - reflected == true
    - reflected_message == num
    type: dsl
  payloads:
    reflection:
    - '''"><script>alert({{num}})</script>'
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}'
  - action: waitdialog
    name: reflected
  stop-at-first-match: true
id: dom-xss
info:
  author: theamanrawat,AmirHossein Raeisi,dwisiswant0
  description: 'Detects DOM-based Cross Site Scripting (XSS) vulnerabilities.

    '
  impact: 'Allows attackers to execute malicious scripts in the victim''s browser.

    '
  name: DOM Cross Site Scripting
  remediation: 'Sanitize and validate user input to prevent script injection.

    '
  severity: medium
  tags: xss,dom,dast,headless,vuln
variables:
  num: '{{rand_int(10000, 99999)}}'
