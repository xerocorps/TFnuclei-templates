code:
- engine:
  - sh
  - bash
  source: 'cat /etc/security/pwquality.conf 2>/dev/null || true

    '
- engine:
  - sh
  - bash
  matchers:
  - condition: or
    name: password-quality
    part: code_1_response
    regex:
    - minlen\s*=\s*[0-7]
    - dcredit\s*=\s*0
    - ucredit\s*=\s*0
    - lcredit\s*=\s*0
    - ocredit\s*=\s*0
    type: regex
  - name: pam
    part: code_2_response
    type: word
    words:
    - pam_pwquality.so
  - negative: true
    part: code_2_response
    type: word
    words:
    - enforce_for_root
  source: 'grep pam_pwquality.so /etc/pam.d/system-auth /etc/pam.d/common-password
    2>/dev/null || true

    '
id: weak-password-complexity
info:
  author: songyaeji
  description: 'The system did not enforce password complexity policies. This allowed
    weak passwords to be used, increasing the risk of unauthorized access through
    brute-force or dictionary attacks.

    '
  metadata:
    verified: true
  name: Linux Password Complexity Not Enforced
  reference:
  - https://isms.kisa.or.kr/main/csap/notice/
  severity: high
  tags: linux,local,audit,kisa,compliance,local
self-contained: true
