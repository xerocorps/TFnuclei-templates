http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_any(content_type, "application/x-sql")
    - contains_any(body, "CREATE TABLE", "INSERT INTO", "DROP TABLE", "MySQL", "phpMyAdmin")
    type: dsl
  max-size: 102400
  method: GET
  path:
  - '{{BaseURL}}{{paths}}'
  payloads:
    paths:
    - /backup.sql
    - /database.sql
    - /db.sql
    - /dump.sql
    - /mysql.sql
    - /{{Hostname}}.sql
    - /wp-content/uploads/backup.sql
    - /wp-content/uploads/database.sql
    - /wp-content/uploads/dump.sql
    - /wp-content/uploads/{{Hostname}}.sql
    - /wp-content/database.sql
    - /backups/database.sql
id: wordpress-db-exposure
info:
  author: 0x_Akoko
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-200
  description: 'Detected WordPress database backup files that were publicly accessible,
    exposing sensitive data including user credentials, email addresses, and site
    content.

    '
  metadata:
    max-request: 12
    verified: true
  name: WordPress Database Backup File - Exposure
  reference:
  - https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload
  - https://wordpress.org/support/article/backing-up-your-database/
  severity: high
  tags: exposure,wordpress,backup,database,sql,misconfig
