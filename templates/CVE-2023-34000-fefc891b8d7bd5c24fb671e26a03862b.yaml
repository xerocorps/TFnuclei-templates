http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - woocommerce-gateway-stripe
  - dsl:
    - compare_versions(version, '7.4.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/woocommerce-gateway-stripe/readme.txt'
  redirects: true
id: CVE-2023-34000-fefc891b8d7bd5c24fb671e26a03862b
info:
  author: topscoder
  classification:
    cve-id: CVE-2023-34000
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
  description: 'The WooCommerce Stripe Payment Gateway plugin for WordPress is vulnerable
    to Insecure Direct Object Reference in versions up to, and including, 7.4.0. This
    is due to insufficient validation in the payment_fields() and javascript_params
    () functions that do not properly validate order ownership. This makes it possible
    for unauthenticated attackers to retrieve potentially sensitive data for orders
    other than their own.

    '
  metadata:
    fofa-query: wp-content/plugins/woocommerce-gateway-stripe/
    google-query: inurl:"/wp-content/plugins/woocommerce-gateway-stripe/"
    shodan-query: vuln:CVE-2023-34000
  name: 'WooCommerce Stripe Payment Gateway <= 7.4.0 - Unauthenticated Insecure Direct
    Object Reference to Sensitive Information Disclosure

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/70971072-d743-466b-affe-d7f79d5712aa?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,woocommerce-gateway-stripe,high
