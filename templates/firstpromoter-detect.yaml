http:
- matchers:
  - condition: and
    dsl:
    - contains_any(body, "cdn.firstpromoter.com/fpr.js", "cdn.firstpromoter.com/fprom.js",
      "//cdn.firstpromoter.com")
    - status_code == 200
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}'
id: firstpromoter-detect
info:
  author: Shivam Kamboj
  description: 'Detects FirstPromoter affiliate and referral tracking artifacts.

    '
  metadata:
    max-request: 1
    product: firstpromoter
    shodan-query:
    - http.html:"cdn.firstpromoter.com"
    - http.html:"fpr.js"
    vendor: firstpromoter
    verified: true
  name: FirstPromoter - Detect
  reference:
  - https://firstpromoter.com/
  - https://docs.firstpromoter.com/guides/tracking-with-fprjs
  severity: info
  tags: tech,discovery,affiliate,firstpromoter
