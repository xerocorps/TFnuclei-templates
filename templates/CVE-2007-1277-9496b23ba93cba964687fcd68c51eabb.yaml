http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '2.2.1')
    - compare_versions(version_by_js, '2.2.1')
    - compare_versions(version_by_css, '2.2.1')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2007-1277-9496b23ba93cba964687fcd68c51eabb
info:
  author: topscoder
  classification:
    cve-id: CVE-2007-1277
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'WordPress 2.1.1, as downloaded from some official distribution sites
    during February and March 2007, contains an externally introduced backdoor that
    allows remote attackers to execute arbitrary commands via (1) an eval injection
    vulnerability in the ix parameter to wp-includes/feed.php, and (2) an untrusted
    passthru call in the iz parameter to wp-includes/theme.php.

    '
  metadata:
    shodan-query: vuln:CVE-2007-1277
  name: 'WordPress Core 2.2.1 - Backdoor

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/e5539ad8-4203-4d22-9a40-0ed6e0471e19?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-core,critical
