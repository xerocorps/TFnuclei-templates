code:
- args:
  - -c
  - "INACTIVE_DAYS=$(useradd -D | grep -i INACTIVE | awk -F= '{print $2}')\nif [ -z\
    \ \"$INACTIVE_DAYS\" ] || [ \"$INACTIVE_DAYS\" -gt 45 ]; then\n  echo \"[inactive-password-lock-default-check:Policy-Fail]\
    \ [INACTIVE=$INACTIVE_DAYS (invalid)] [CIS_FAIL]\"\nelse\n  echo \"[inactive-password-lock-default-check:Policy-Pass]\
    \ [INACTIVE=$INACTIVE_DAYS (valid)] [CIS_PASS]\"\nfi\n"
  engine:
  - bash
  matchers:
  - name: policy-pass
    type: word
    words:
    - Policy-Pass
  - name: policy-fail
    type: word
    words:
    - Policy-Fail
id: inactive-password-lock-default
info:
  author: Th3l0newolf
  description: 'This policy ensures the default user inactivity lock is configured
    properly.User accounts that remain inactive for more than 45 days after password
    expiration should be disabled.

    '
  metadata:
    verified: true
  name: Ensure Inactive Password Lock is Configured (Default Setting)
  reference:
  - https://www.cisecurity.org/benchmark/ubuntu_linux
  remediation: 'Ensure the default INACTIVE parameter is set to 45 days for new accounts.To
    configure, run: sudo useradd -D -f 45

    '
  severity: high
  tags: cis,local,cisecurity,audit,linux,ubuntu,password
self-contained: true
