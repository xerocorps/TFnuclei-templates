expression: r0()
id: phpmywind-cms-id-sql-inject
info:
  author: daffainfo
  description: "\u6240\u8C13SQL\u6CE8\u5165\uFF0C\u5C31\u662F\u901A\u8FC7\u628ASQL\u547D\
    \u4EE4\u63D2\u5165\u5230Web\u8868\u5355\u63D0\u4EA4\u6216\u8F93\u5165\u57DF\u540D\
    \u6216\u9875\u9762\u8BF7\u6C42\u7684\u67E5\u8BE2\u5B57\u7B26\u4E32\uFF0C\u6700\
    \u7EC8\u8FBE\u5230\u6B3A\u9A97\u670D\u52A1\u5668\u6267\u884C\u6076\u610F\u7684\
    SQL\u547D\u4EE4\u3002\u5177\u4F53\u6765\u8BF4\uFF0C\u5B83\u662F\u5229\u7528\u73B0\
    \u6709\u5E94\u7528\u7A0B\u5E8F\uFF0C\u5C06\uFF08\u6076\u610F\uFF09\u7684SQL\u547D\
    \u4EE4\u6CE8\u5165\u5230\u540E\u53F0\u6570\u636E\u5E93\u5F15\u64CE\u6267\u884C\
    \u7684\u80FD\u529B\uFF0C\u5B83\u53EF\u4EE5\u901A\u8FC7\u5728Web\u8868\u5355\u4E2D\
    \u8F93\u5165\uFF08\u6076\u610F\uFF09SQL\u8BED\u53E5\u5F97\u5230\u4E00\u4E2A\u5B58\
    \u5728\u5B89\u5168\u6F0F\u6D1E\u7684\u7F51\u7AD9\u4E0A\u7684\u6570\u636E\u5E93\
    \uFF0C\u800C\u4E0D\u662F\u6309\u7167\u8BBE\u8BA1\u8005\u610F\u56FE\u53BB\u6267\
    \u884CSQL\u8BED\u53E5\u3002 \u9020\u6210SQL\u6CE8\u5165\u6F0F\u6D1E\u539F\u56E0\
    \u6709\u4E24\u4E2A\uFF1A\u4E00\u4E2A\u662F\u6CA1\u6709\u5BF9\u8F93\u5165\u7684\
    \u6570\u636E\u8FDB\u884C\u8FC7\u6EE4\uFF08\u8FC7\u6EE4\u8F93\u5165\uFF09\uFF0C\
    \u8FD8\u6709\u4E00\u4E2A\u662F\u6CA1\u6709\u5BF9\u53D1\u9001\u5230\u6570\u636E\
    \u5E93\u7684\u6570\u636E\u8FDB\u884C\u8F6C\u4E49\uFF08\u8F6C\u4E49\u8F93\u51FA\
    \uFF09\u3002\n\u4FEE\u8865\u5EFA\u8BAE\n\u5EFA\u8BAE\u5728\u4EE3\u7801\u4E2D\u5BF9\
    \u6570\u5B57\u7C7B\u578B\u7684\u53C2\u6570\u5148\u8FDB\u884C\u6570\u5B57\u7C7B\
    \u578B\u53D8\u6362\uFF0C\u7136\u540E\u518D\u4EE3\u5165\u5230SQL\u67E5\u8BE2\u8BED\
    \u53E5\u4E2D\uFF0C\u8FD9\u6837\u4EFB\u4F55\u6CE8\u5165\u884C\u4E3A\u90FD\u4E0D\
    \u80FD\u6210\u529F\u3002\u5E76\u4E14\u8003\u8651\u8FC7\u6EE4\u4E00\u4E9B\u53C2\
    \u6570\uFF0C\u6BD4\u5982get\u53C2\u6570\u548Cpost\u53C2\u6570\u4E2D\u5BF9\u4E8E\
    SQL\u8BED\u8A00\u67E5\u8BE2\u7684\u90E8\u5206\u3002\n\u6240\u4EE5\u9632\u8303\u7684\
    \u65F6\u5019\u9700\u8981\u5BF9\u7528\u6237\u7684\u8F93\u5165\u8FDB\u884C\u68C0\
    \u67E5\u3002\u7279\u522B\u5F0F\u4E00\u4E9B\u7279\u6B8A\u5B57\u7B26\uFF0C\u6BD4\
    \u5982\u5355\u5F15\u53F7\uFF0C\u53CC\u5F15\u53F7\uFF0C\u5206\u53F7\uFF0C\u9017\
    \u53F7\uFF0C\u5192\u53F7\uFF0C\u8FDE\u63A5\u53F7\u7B49\u8FDB\u884C\u8F6C\u6362\
    \u6216\u8005\u8FC7\u6EE4\u3002\nfofa-query: \"PHPMyWind\"\n"
  name: "PHPMyWind CMS id \u53C2\u6570 SQL \u6CE8\u5165\u6F0F\u6D1E"
  severity: high
  verified: true
rules:
  r0:
    expression: "response.status == 200 && response.body.bcontains(b'PHPMyWind\u5B89\
      \u5168\u8B66\u544A\uFF1AMySql Error\uFF01') && response.body.bcontains(b'\u9519\
      \u8BEF\u6587\u4EF6</strong>\uFF1A/show.php') && response.headers[\"content-type\"\
      ].contains(\"text/html\")"
    request:
      method: GET
      path: /show.php?id=-1+or+1=2
