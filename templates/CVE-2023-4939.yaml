http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - salesmanago
  - dsl:
    - compare_versions(version, '<= 3.2.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/salesmanago/readme.txt'
  redirects: true
id: CVE-2023-4939
info:
  author: topscoder
  classification:
    cve-id: CVE-2023-4939
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
  description: 'The SALESmanago plugin for WordPress is vulnerable to Log Injection
    in versions up to, and including, 3.2.4. This is due to the use of a weak authentication
    token for the /wp-json/salesmanago/v1/callbackApiV3 API endpoint which is simply
    a SHA1 hash of the site URL and client ID found in the page source of the website.
    This makes it possible for unauthenticated attackers to inject arbitrary content
    into the log files, and when combined with another vulnerability this could have
    significant consequences.

    '
  metadata:
    fofa-query: wp-content/plugins/salesmanago/
    google-query: inurl:"/wp-content/plugins/salesmanago/"
    shodan-query: vuln:CVE-2023-4939
  name: 'SALESmanago <= 3.2.4 - Log Injection via Weak Authentication Token

    '
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/de7db1d6-b352-44c7-a6cc-b21cb65a0482?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,salesmanago,medium
