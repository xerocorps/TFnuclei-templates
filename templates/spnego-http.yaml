id: spnego-http
info:
  author: lady_bug, ruppde
  name: Identifying SPNEGO over HTTP (might be useful for finding CVE-2022-37958)
  reference:
  - https://arstechnica.com/information-technology/2022/12/critical-windows-code-execution-vulnerability-went-undetected-until-now/?utm_social-type=owned&utm_source=twitter&utm_medium=social&utm_brand=ars
  severity: info
  tags: misc,windows
requests:
- extractors:
  - kval:
    - www_authenticate
    type: kval
  matchers:
  - dsl:
    - 'contains(tolower(all_headers), ''www-authenticate: negotiate'')'
    type: dsl
  matchers-condition: and
  max-redirects: 5
  method: GET
  path:
  - '{{BaseURL}}'
  redirects: true
  threads: 10
