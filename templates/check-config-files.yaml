http:
- matchers:
  - condition: or
    part: body
    type: word
    words:
    - MAIL_HOST=
    - MAIL_FROM_ADDRESS=
    - MAIL_ENCRYPTION=
  - condition: or
    regex:
    - (?m)^APP_(NAME|ENV|KEY|DEBUG|URL|PASSWORD|SECRET)
    - (?m)^DB_(HOST|NAME|DEBUG|PASSWORD|DATABASE|PASS)
    - (?m)^ADMIN_(HOST|NAME|DEBUG|PASSWORD|DATABASE|PASS)
    - (?m)^AWS_(SESSION|LAMBDA|SECRET|REGION|ACCESS)
    - jdbc:[a-z:]+://[A-Za-z0-9\.\-_:;=/@?,&]+
    - ((?i)password|pwd|pass|secretkey|secret_key)=
    type: regex
  - condition: and
    part: body
    type: word
    words:
    - USER
    - PASS
    - HOST
  - condition: and
    part: body
    type: word
    words:
    - env
    - debug
    - variable
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}/common/config.php.new'
  - '{{BaseURL}}/config.php.new'
  - '{{BaseURL}}/common/config.php.old'
  - '{{BaseURL}}/config.php.old'
id: check-config-files
info:
  author: SirBugs
  name: Check for config.php.new leaks
  reference: https://example.com/reference
  severity: low
  tags: generic,config-files
