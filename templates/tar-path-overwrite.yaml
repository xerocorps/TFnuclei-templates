file:
- extensions:
  - all
  matchers:
  - condition: or
    regex:
    - \$X = require\('tar-stream'\)
    - \$EXTRACT\.on\('entry', function \$FUNC\(...\) {
    - \$FS\.createWriteStream\(\$FIL, ...\)
    - \$FS\.writeFile\(\$FIL, ...\)
    - \$FS\.writeFileSync\(\$FIL, ...\)
    type: regex
id: tar-path-overwrite
info:
  author: me_dheeraj (https://twitter.com/Dheerajmadhukar)
  description: Insecure TAR archive extraction can result in arbitrary path over write
    and can result in code injection.
  name: Tar Path Overwrite
  severity: info
  tags: file,nodejs
