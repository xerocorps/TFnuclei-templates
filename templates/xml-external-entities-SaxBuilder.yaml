file:
- extensions:
  - java
  matchers:
  - name: SaxBuilder
    regex:
    - new\s+SAXBuilder\(\)
    type: regex
  - condition: and
    name: SaxBuilder
    negative: true
    regex:
    - .+\.setFeature\(\"http:\/\/apache.org\/xml\/features\/disallow-doctype-decl\",\s*true\);
    - .+\.setFeature\(\"http:\/\/xml.org\/sax\/features\/external-general-entities\",\s*false\);
    - .+\.setFeature\(\"http:\/\/xml.org\/sax\/features\/external-parameter-entities\",\s*false\);
    type: regex
  matchers-condition: and
id: xml-external-entities-SaxBuilder
info:
  author: sklnhunt
  description: XXE (XML External Entity) attacks in Java involve exploiting vulnerabilities
    in XML parsers to read sensitive files on the server or execute arbitrary code.
    These attacks can be mitigated by disabling external entity processing or using
    a secure XML parser such as SAXbuilder.
  name: XML External Entities (SaxBuilder)
  reference: https://portswigger.net/web-security/xxe
  severity: critical
  tags: java
