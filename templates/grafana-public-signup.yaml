id: grafana-public-signup
info:
  author: pdteam
  name: Grafana Public Signup
  severity: medium
  tags: grafana,intrusive
requests:
- matchers:
  - type: word
    words:
    - User sign up completed successfully
  - condition: and
    part: header
    type: word
    words:
    - grafana_sess
    - grafana_user
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /api/user/signup/step2 HTTP/1.1

    Host: {{Hostname}}

    content-type: application/json

    Origin: {{BaseURL}}

    Referer: {{BaseURL}}


    {"username":"nuclei_{{randstr}}","password":"{{randstr_1}}"}

    '
