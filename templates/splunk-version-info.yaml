id: splunk-version-info
info:
  author: milo2012
  name: Splunk Enterprise Version and Build Disclosure
  severity: info
  tags: splunk, version, build, enterprise
requests:
- extractors:
  - name: splunk_version
    part: body
    type: xpath
    xpath:
    - //s:key[@name="version"]/text()
  - name: splunk_build
    part: body
    type: xpath
    xpath:
    - //generator/@build
  - name: splunk_license_label
    part: body
    type: xpath
    xpath:
    - //s:key[@name="license_labels"]/s:list/s:item/text()
  matchers:
  - part: header
    type: word
    words:
    - Splunkd
  - part: body
    regex:
    - <s:key name="license_labels">\s*<s:list>\s*<s:item>Splunk Enterprise</s:item>
    type: regex
  method: GET
  path:
  - '{{BaseURL}}/en-US/splunkd/__raw/services/server/info'
