id: CVE-2006-2173
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:filezilla:filezilla_server:*:*:*:*:*:*:*:*
    cve-id: CVE-2006-2173
    cvss-metrics: CVSS:2.0/AV:N/AC:L/Au:N/C:N/I:P/A:P
    cvss-score: 6.4
    epss-percentile: 0.71993
    epss-score: 0.00726
  description: 'FileZilla FTP Server version 2.2.22 contains a buffer overflow vulnerability
    that allows remote authenticated attackers to cause denial of service and potentially
    execute arbitrary code. The vulnerability can be triggered by sending excessively
    long PORT or PASS commands followed by MLSD commands, or through the remote interface.

    '
  impact: 'Authenticated attackers can send excessively long PORT or PASS commands
    followed by MLSD commands to trigger buffer overflow, causing denial of service
    or potentially executing arbitrary code on the FTP server.

    '
  metadata:
    max-request: 1
    product: filezilla_server
    shodan-query: product:"FileZilla"
    vendor: filezilla
    verified: true
  name: FileZilla FTP Server 2.2.22 - Buffer Overflow
  reference:
  - http://marc.info/?l=bugtraq&m=114658586018818&w=2
  - http://www.infigo.hr/hr/in_focus/advisories/INFIGO-2006-05-03
  - https://exchange.xforce.ibmcloud.com/vulnerabilities/26303
  remediation: 'Update FileZilla FTP Server to a version newer than 2.2.22 that properly
    validates command length and prevents buffer overflow vulnerabilities.

    '
  severity: medium
  tags: cve,cve2006,network,ftp,filezilla,tcp,passive,buffer-overflow,vuln
tcp:
- extractors:
  - group: 1
    name: version
    regex:
    - FileZilla Server version ([0-9.]+)
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: 0
    type: hex
  matchers:
  - condition: and
    dsl:
    - contains(raw, 'FileZilla')
    - contains(version, '2.2.22')
    type: dsl
  port: 21
  read-size: 1024
