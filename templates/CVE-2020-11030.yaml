http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 5.4', '<= 5.4')
    - compare_versions(version_by_js, '>= 5.4', '<= 5.4')
    - compare_versions(version_by_css, '>= 5.4', '<= 5.4')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2020-11030
info:
  author: topscoder
  classification:
    cve-id: CVE-2020-11030
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 6.4
  description: In affected versions of WordPress, a special payload can be crafted
    that can lead to scripts getting executed within the search block of the block
    editor. This requires an authenticated user with the ability to add content. This
    has been patched in version 5.4.1, along with all the previously affected versions
    via a minor release (5.3.3, 5.2.6, 5.1.5, 5.0.9, 4.9.14, 4.8.13, 4.7.17, 4.6.18,
    4.5.21, 4.4.22, 4.3.23, 4.2.27, 4.1.30, 4.0.30, 3.9.31, 3.8.33, 3.7.33).
  metadata:
    shodan-query: vuln:CVE-2020-11030
  name: WordPress Core < 5.4.1 - Cross-Site Scripting in the Block Editor
  reference:
  - https://wordpress.org/support/wordpress-version/version-5-4-1/#security-updates
  - https://github.com/WordPress/wordpress-develop/security/advisories/GHSA-vccm-6gmc-qhjh
  - https://www.debian.org/security/2020/dsa-4677
  severity: medium
  tags: cve,wordpress,wp-core,medium
