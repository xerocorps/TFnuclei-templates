http:
- extractors:
  - kval:
    - www_authenticate
    type: kval
  host-redirects: true
  matchers:
  - dsl:
    - 'contains(tolower(header), ''www-authenticate: negotiate'')'
    type: dsl
  matchers-condition: and
  max-redirects: 5
  method: GET
  path:
  - '{{BaseURL}}'
id: spnego-detect
info:
  author: lady_bug,ruppde
  description: 'SPNEGO stands for Simple and Protected GSSAPI Negotiation Mechanism.
    It is a protocol used for secure authentication and negotiation between client
    and server applications in a network environment. SPNEGO is based on the Generic
    Security Services Application Programming Interface (GSSAPI) framework.

    '
  metadata:
    max-request: 1
    shodan-query: 'www-authenticate: negotiate'
    verified: true
  name: SPNEGO - Detect
  reference:
  - https://www.ibm.com/docs/en/was-liberty/core?topic=authentication-single-sign-http-requests-using-spnego-web
  - https://arstechnica.com/information-technology/2022/12/critical-windows-code-execution-vulnerability-went-undetected-until-now/
  severity: info
  tags: miscellaneous,misc,windows,spnego,vuln
