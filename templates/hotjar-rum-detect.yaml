http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200 || status_code == 400
    type: dsl
  - condition: or
    part: body
    regex:
    - 'h\._hjSettings\s*=\s*\{\s*hjid\s*:'
    - '_hjSettings\s*=\s*\{\s*hjid\s*:'
    - <script[^>]*src=['"][^'"]*static\.hotjar\.com[^'"]*['"]
    - <script[^>]*src=['"][^'"]*script\.hotjar\.com[^'"]*['"]
    - window\.hj\s*=\s*window\.hj\s*\|\|
    - \(function\s*\([^)]*\)\s*\{[^}]*hotjar[^}]*hjid
    type: regex
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}'
  redirects: true
id: hotjar-rum-detect
info:
  author: Shivam Kamboj
  description: 'Detects Hotjar Web Analytics & Session Recording artifacts.

    '
  metadata:
    fofa-query: body="hotjar" || header="hotjar"
    max-request: 1
    shodan-query: http.html:"static.hotjar.com"
    verified: true
  name: Hotjar RUM - Detect
  reference:
  - https://www.hotjar.com/
  severity: info
  tags: tech,discovery,rum,hotjar
