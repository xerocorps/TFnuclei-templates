http:
- fuzzing:
  - fuzz:
    - '{{reflection}}'
    mode: single
    part: query
    type: postfix
  matchers:
  - condition: and
    regex:
    - '108000'
    type: regex
  - status:
    - 200
    - 500
    - 403
    - 301
    type: status
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
  payloads:
    reflection:
    - '{9000*12}'
    - '*{9000*12}'
    - '{{9000*12}}'
    - ${9000*12}
    - '@(9000*12)'
    - <?=9000*12?>
    - <%= 9000*12 %>
    - ${= 9000*12}
    - '{{= 9000*12}}'
    - ${{9000*12}}
    - '#{9000*12}'
    - '[% 9000*12 %]'
    - <% 9000*12 %>
    - '[%= 9000*12 %]'
    - <% 9000*12 %>
    - '{{% 9000*12 %}}'
    - '{{<% 9000*12 %>}}'
    - '[[ 9000*12 ]]'
    - '{{# 9000*12 }}'
    - '<# 9000*12 #>'
    - '[- 9000*12 -]'
    - '[=9000*12]'
  stop-at-first-match: true
id: ScanReflectedSSTI
info:
  author: Hernan Rodriguez
  description: SSTI or CSTI via GET parameter
  name: Server Side Template Injection (SSTI)
  reference: https://www.linkedin.com/in/hernanrodriguez-/ -
  severity: Critical
  tags: SSTI
variables:
  first: '{{rand_int(10000, 99999)}}'
