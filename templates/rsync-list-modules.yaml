id: rsync-list-modules
info:
  author: pussycat0x
  description: 'Lists modules available for rsync (remote file sync) synchronization.

    '
  metadata:
    max-request: 1
    shodan-query: port:873
    verified: true
  name: Rsync List Modules - Enumeration
  reference:
  - https://nmap.org/nsedoc/scripts/rsync-list-modules.html
  severity: low
  tags: network,rsync,enum,js
javascript:
- args:
    Host: '{{Host}}'
    Port: 873
  code: 'const c = require("nuclei/net");

    const data = "@RSYNCD: 31.0\n\n"

    const conn = c.Open(''tcp'', `${Host}:${Port}`);

    conn.Send(data);

    response = conn.RecvFullString(1024)

    const rsyncRegex = /@RSYNCD: EXIT|@RSYNCD: 31.0|@RSYNCD:|@RSYNCD: 30.0/g;

    const resultString = response.replace(rsyncRegex, "");

    const whitespaceRegex = /[\s\t\n]+/g;

    const finalResult = resultString.replace(whitespaceRegex, "  ");

    if (finalResult.trim() === "") {

    exit();

    }

    else{

    finalResult

    }

    '
  extractors:
  - dsl:
    - response
    type: dsl
  matchers:
  - negative: true
    type: word
    words:
    - HTTP/1.1
  pre-condition: 'isPortOpen(Host,Port);

    '
