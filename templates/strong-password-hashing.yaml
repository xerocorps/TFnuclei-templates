code:
- args:
  - -c
  - "HASH_METHOD_LINE=$(grep -Pi -- '^\\h*ENCRYPT_METHOD\\h+(SHA512|yescrypt)\\b'\
    \ /etc/login.defs | head -n1)\nif [ -n \"$HASH_METHOD_LINE\" ]; then\n  VALUE=$(echo\
    \ \"$HASH_METHOD_LINE\" | awk '{print $2}' | tr '[:upper:]' '[:lower:]')\n  if\
    \ [ \"$VALUE\" = \"sha512\" ] || [ \"$VALUE\" = \"yescrypt\" ]; then\n    echo\
    \ \"[strong-password-hashing-check:Policy-Pass] [ENCRYPT_METHOD is $VALUE (valid)]\
    \ [CIS_PASS]\"\n  else\n    echo \"[strong-password-hashing-check:Policy-Fail]\
    \ [ENCRYPT_METHOD is $VALUE (invalid)] [CIS_FAIL]\"\n  fi\nelse\n  echo \"[strong-password-hashing-check:Policy-Fail]\
    \ [ENCRYPT_METHOD not set or malformed] [CIS_FAIL]\"\nfi\n"
  engine:
  - bash
  matchers:
  - name: policy-pass
    type: word
    words:
    - Policy-Pass
  - name: policy-fail
    type: word
    words:
    - Policy-Fail
id: strong-password-hashing
info:
  author: Th3l0newolf
  description: 'The ENCRYPT_METHOD setting in /etc/login.defs specifies the algorithm
    used to hash passwords.It should be set to SHA512 or yescrypt, as weaker algorithms
    may expose passwords to brute-force attacks.

    '
  metadata:
    verified: true
  name: Ensure Strong Password Hashing Algorithm is Configured
  reference:
  - https://www.cisecurity.org/benchmark/ubuntu_linux
  remediation: 'Edit /etc/login.defs and set ENCRYPT_METHOD to either SHA512 or yescrypt.Verify
    with: grep -Pi -- ''^\h*ENCRYPT_METHOD\h+(SHA512|yescrypt)\b'' /etc/login.defs

    '
  severity: high
  tags: cis,local,cisecurity,audit,linux,ubuntu,password
self-contained: true
