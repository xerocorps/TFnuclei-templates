http:
- matchers:
  - part: header
    type: word
    words:
    - 'Location: https://interact.sh'
  - part: body
    type: word
    words:
    - alert(document.cookie)
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/signin?from=https://interact.sh'
  - '{{BaseURL}}/signin?from=javascript:alert(document.cookie)'
id: CVE-2022-0087
info:
  author: ShivanshKhari
  classification:
    cpe: cpe:2.3:a:keystonejs:keystone:*:*:*:*:*:node.js:*:*
    cve-id: CVE-2022-0087
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.97995
    epss-score: 0.56131
  description: 'On the login page, there is a "from=" parameter in URL which is vulnerable
    to open redirect and can be escalated to reflected XSS.

    '
  impact: 'Attackers can redirect users to malicious websites or inject malicious
    JavaScript via the from parameter, potentially facilitating phishing attacks or
    stealing user credentials.

    '
  metadata:
    framework: node.js
    max-request: 2
    product: keystone
    vendor: keystonejs
  name: Keystone 6 Login Page - Open Redirect and Cross-Site Scripting
  reference:
  - https://huntr.com/bounties/c9d7374f-2cb9-4bac-9c90-a965942f413e
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0087
  - https://github.com/keystonejs/keystone/commit/96bf833a23b1a0a5d365cf394467a943cc481b38
  remediation: 'Please upgrade to @keystone-6/auth >= 1.0.2, where this vulnerability
    has been closed. If you are using @keystone-next/auth, we strongly recommend you
    upgrade to @keystone-6

    '
  severity: medium
  tags: cve,cve2022,keystone,redirect,xss,node.js,keystonejs,vuln
