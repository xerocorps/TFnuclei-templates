file:
- extensions:
  - conf
  matchers:
  - condition: and
    type: word
    words:
    - http
    - events
  - negative: true
    type: word
    words:
    - 'add_header Strict-Transport-Security '
  matchers-condition: and
id: file-missing-nginx-hsts
info:
  author: pussycat0x
  description: 'Ensures that HSTS (Strict-Transport-Security) is enabled in Nginx.

    '
  metadata:
    verified: true
  name: Missing Nginx HSTS
  reference:
  - https://wiki.devsecopsguides.com/docs/checklists/nginx/
  - https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security
  remediation: 'Add ''add_header Strict-Transport-Security "max-age=31536000; includeSubDomains;
    preload";'' in /etc/nginx/nginx.conf under the server block.

    '
  severity: high
  tags: file,audit,nginx,hardening
