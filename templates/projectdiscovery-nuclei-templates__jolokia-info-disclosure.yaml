http:
- attack: clusterbomb
  matchers:
  - name: memory
    type: word
    words:
    - '"mbean":"java.lang:type=Memory"'
  - name: implementation-vendor
    type: word
    words:
    - '"attribute":"ImplementationVendor"'
  - name: implementation-version
    type: word
    words:
    - '"attribute":"ImplementationVersion"'
  - name: implementation-name
    type: word
    words:
    - '"attribute":"ImplementationName"'
  - name: specification-vendor
    type: word
    words:
    - '"attribute":"SpecificationVendor"'
  - name: mbean-serverid
    type: word
    words:
    - '"attribute":"MBeanServerId"'
  - name: specification-name
    type: word
    words:
    - '"attribute":"SpecificationName"'
  - name: specification-version
    type: word
    words:
    - '"attribute":"SpecificationVersion'
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}{{jolokia_paths}}{{mbean_paths}}'
  payloads:
    jolokia_paths:
    - /jolokia
    - /actuator/jolokia
    mbean_paths:
    - /read/JMImplementation:type=MBeanServerDelegate/ImplementationName
    - /read/JMImplementation:type=MBeanServerDelegate/ImplementationVendor
    - /read/JMImplementation:type=MBeanServerDelegate/ImplementationVersion
    - /read/JMImplementation:type=MBeanServerDelegate/MBeanServerId
    - /read/JMImplementation:type=MBeanServerDelegate/SpecificationName
    - /read/JMImplementation:type=MBeanServerDelegate/SpecificationVendor
    - /read/JMImplementation:type=MBeanServerDelegate/SpecificationVersion
    - /read/java.lang:type=Memory
id: jolokia-info-disclosure
info:
  author: pussycat0x
  description: Jolokia - Information is exposed.
  metadata:
    max-request: 16
  name: Jolokia - Information disclosure
  reference:
  - https://thinkloveshare.com/hacking/ssrf_to_rce_with_jolokia_and_mbeans/
  - https://github.com/laluka/jolokia-exploitation-toolkit
  severity: medium
  tags: jolokia,springboot,mbean,misconfig,vuln
