http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - nextgen-gallery
  - dsl:
    - compare_versions(version, '<= 2.1.56')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/nextgen-gallery/readme.txt'
  redirects: true
id: CVE-2016-6565
info:
  author: topscoder
  classification:
    cve-id: CVE-2016-6565
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.5
  description: The Imagely NextGen Gallery plugin for Wordpress prior to version 2.1.57
    does not properly validate user input in the cssfile parameter of a HTTP POST
    request, which may allow an authenticated user to read arbitrary files from the
    server, or execute arbitrary code on the server in some circumstances (dependent
    on server configuration).
  metadata:
    fofa-query: wp-content/plugins/nextgen-gallery/
    google-query: inurl:"/wp-content/plugins/nextgen-gallery/"
    shodan-query: vuln:CVE-2016-6565
  name: NextGen Gallery <= 2.1.56 - Remote File Inclusion
  reference:
  - https://www.kb.cert.org/vuls/id/346175
  severity: high
  tags: cve,wordpress,wp-plugin,nextgen-gallery,high
