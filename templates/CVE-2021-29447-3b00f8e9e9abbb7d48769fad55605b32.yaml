http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 5.7', '< 5.7.1')
    - compare_versions(version_by_js, '>= 5.7', '< 5.7.1')
    - compare_versions(version_by_css, '>= 5.7', '< 5.7.1')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2021-29447-3b00f8e9e9abbb7d48769fad55605b32
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-29447
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N
    cvss-score: 7.1
  description: 'Wordpress is an open source CMS. A user with the ability to upload
    files (like an Author) can exploit an XML parsing issue in the Media Library leading
    to XXE attacks. This requires WordPress installation to be using PHP 8. Access
    to internal files is possible in a successful XXE attack. This has been patched
    in WordPress version 5.7.1, along with the older affected versions via a minor
    release. We strongly recommend you keep auto-updates enabled.

    '
  metadata:
    shodan-query: vuln:CVE-2021-29447
  name: 'WordPress Core < 5.7.1 - XXE Injection

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/9df45c8e-c040-4031-9c51-4c43d12f08b0?source=api-prod
  severity: high
  tags: cve,wordpress,wp-core,high
