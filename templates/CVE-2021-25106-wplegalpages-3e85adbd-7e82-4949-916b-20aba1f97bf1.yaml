http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wplegalpages
  - dsl:
    - compare_versions(version, '< 2.7.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wplegalpages/readme.txt'
  redirects: true
id: CVE-2021-25106-wplegalpages-3e85adbd-7e82-4949-916b-20aba1f97bf1
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-25106
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
  description: 'The Privacy Policy Generator, Terms & Conditions Generator WordPress
    Plugin : WPLegalPages WordPress plugin before 2.7.1 does not check for authorisation
    and has a flawed CSRF logic when saving its settings, allowing any authenticated
    users, such as subscriber, to update them. Furthermore, due to the lack of sanitisation
    and escaping, it could lead to Stored Cross-Site Scripting

    '
  metadata:
    fofa-query: wp-content/plugins/wplegalpages/
    google-query: inurl:"/wp-content/plugins/wplegalpages/"
    shodan-query: http.html:"wp-content/plugins/wplegalpages/"
  name: 'Privacy Policy Generator, Terms & Conditions Generator - WPLegalPages <=
    2.7.0 - Arbitrary Settings Update to Stored Cross-Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/3e85adbd-7e82-4949-916b-20aba1f97bf1?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,wplegalpages,low,production
