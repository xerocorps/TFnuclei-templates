id: cloudfoundry-detect
info:
  author: uomogrande
  description: Detects cloudfoundry based on response headers
  name: Cloudfoundry Detect
  reference: https://docs.cloudfoundry.org/concepts/cf-routing-architecture.html
  severity: info
  tags: cloudfoundry,tech
requests:
- matchers:
  - dsl:
    - contains(all_headers, "X-Vcap-Request-Id:") || contains(all_headers, "X-Cf-Routererror:")
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET / HTTP/1.1

    Host: {{randstr}}.com

    '
  req-condition: true
  stop-at-first-match: true
