id: javascript-env
info:
  author: pdp,geeknik
  description: Detects common JavaScript environment configuration files.
  name: JavaScript Environment Config
  severity: low
  tags: javascript,config,exposure
requests:
- matchers:
  - status:
    - 200
    type: status
  - dsl:
    - 'contains(tolower(all_headers), ''content-type: application/javascript'')'
    part: header
    type: dsl
  - condition: or
    part: body
    type: word
    words:
    - module.exports
    - const audience
    - const domain
    - NODE_ENV
    - LOG_LEVEL
    - TOKEN
    - KEY
    - PASSWORD
    - VERSION
  - condition: or
    negative: true
    part: body
    type: word
    words:
    - Bootstrap
    - jQuery
    - CSS TRANSITION SUPPORT
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/env.js'
  - '{{BaseURL}}/env.development.js'
  - '{{BaseURL}}/env.production.js'
  - '{{BaseURL}}/env.test.js'
  - '{{BaseURL}}/env.dev.js'
  - '{{BaseURL}}/env.prod.js'
