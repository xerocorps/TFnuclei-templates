http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '<= 3.7')
    - compare_versions(version_by_js, '<= 3.7')
    - compare_versions(version_by_css, '<= 3.7')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2019-16781
info:
  author: topscoder
  classification:
    cve-id: CVE-2019-16781
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:N/A:N
    cvss-score: 5.8
  description: In WordPress before 5.3.1, authenticated users with lower privileges
    (like contributors) can inject JavaScript code in the block editor, which is executed
    within the dashboard. It can lead to an admin opening the affected post in the
    editor leading to XSS.
  metadata:
    shodan-query: vuln:CVE-2019-16781
  name: WordPress Core < 5.3.1 - Authenticated Stored Cross-Site Scripting
  reference:
  - https://wpvulndb.com/vulnerabilities/9976
  - https://wordpress.org/news/2019/12/wordpress-5-3-1-security-and-maintenance-release/
  - https://github.com/WordPress/wordpress-develop/security/advisories/GHSA-pg4x-64rh-3c9v
  - https://hackerone.com/reports/731301
  - https://seclists.org/bugtraq/2020/Jan/8
  - https://www.debian.org/security/2020/dsa-4599
  - https://www.debian.org/security/2020/dsa-4677
  severity: medium
  tags: cve,wordpress,wp-core,medium
