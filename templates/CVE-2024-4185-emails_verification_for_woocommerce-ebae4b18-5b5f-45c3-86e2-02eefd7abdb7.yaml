http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - emails-verification-for-woocommerce
  - dsl:
    - compare_versions(version, '<= 2.7.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/emails-verification-for-woocommerce/readme.txt'
  redirects: true
id: CVE-2024-4185-emails_verification_for_woocommerce-ebae4b18-5b5f-45c3-86e2-02eefd7abdb7
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-4185
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
  description: 'The Customer Email Verification for WooCommerce plugin for WordPress
    is vulnerable to Email Verification and Authentication Bypass in all versions
    up to, and including, 2.7.4 via the use of insufficiently random activation code.
    This makes it possible for unauthenticated attackers to bypass the email verification,
    and if both the "Login the user automatically after the account is verified" and
    "Verify account for current users" options are checked, then it potentially makes
    it possible for attackers to bypass authentication for other users.

    '
  metadata:
    fofa-query: wp-content/plugins/emails-verification-for-woocommerce/
    google-query: inurl:"/wp-content/plugins/emails-verification-for-woocommerce/"
    shodan-query: http.html:"wp-content/plugins/emails-verification-for-woocommerce/"
  name: 'Customer Email Verification for WooCommerce <= 2.7.4 - Email Verification
    and Authentication Bypass due to Insufficient Randomness

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/ebae4b18-5b5f-45c3-86e2-02eefd7abdb7?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,emails-verification-for-woocommerce,critical,production
