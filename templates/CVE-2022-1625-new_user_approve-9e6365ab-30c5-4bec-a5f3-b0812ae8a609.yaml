http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - new-user-approve
  - dsl:
    - compare_versions(version, '<= 2.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/new-user-approve/readme.txt'
  redirects: true
id: CVE-2022-1625-new_user_approve-9e6365ab-30c5-4bec-a5f3-b0812ae8a609
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-1625
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    cvss-score: 9.6
  description: 'The New User Approve WordPress plugin before 2.4.1 does not have CSRF
    check in place when updating its settings and adding invitation codes, which could
    allow attackers to add invitation codes (for bypassing the provided restrictions)
    and to change plugin settings by tricking admin users into visiting specially
    crafted websites.

    '
  metadata:
    fofa-query: wp-content/plugins/new-user-approve/
    google-query: inurl:"/wp-content/plugins/new-user-approve/"
    shodan-query: http.html:"wp-content/plugins/new-user-approve/"
  name: 'New User Approve <= 2.4 - Cross-Site Request Forgery

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/9e6365ab-30c5-4bec-a5f3-b0812ae8a609?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,new-user-approve,critical,production
