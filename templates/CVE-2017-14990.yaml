http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 4.8.2', '<= 4.8.2')
    - compare_versions(version_by_js, '>= 4.8.2', '<= 4.8.2')
    - compare_versions(version_by_css, '>= 4.8.2', '<= 4.8.2')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2017-14990
info:
  author: topscoder
  classification:
    cve-id: CVE-2017-14990
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
  description: WordPress 4.8.2 stores cleartext wp_signups.activation_key values (but
    stores the analogous wp_users.user_activation_key values as hashes), which might
    make it easier for remote attackers to hijack unactivated user accounts by leveraging
    database read access (such as access gained through an unspecified SQL injection
    vulnerability).
  metadata:
    shodan-query: vuln:CVE-2017-14990
  name: WordPress Core 4.8.2 - Cleartext Storage of wp_signups.activation_key
  reference:
  - https://www.debian.org/security/2017/dsa-3997
  - http://www.securitytracker.com/id/1039554
  - https://core.trac.wordpress.org/ticket/38474
  severity: medium
  tags: cve,wordpress,wp-core,medium
