id: influxdb-version
info:
  author: c-sh0
  description: Obtain InfluxDB Version Information
  name: InfluxDB Version Detection
  reference:
  - https://docs.influxdata.com/influxdb/v1.8/tools/api/#ping-http-endpoint
  - https://github.com/influxdata/influxdb/blob/master/http/platform_handler.go#L62
  - /ping endpoint always returns 204 status
  - verbose option was removed in later versions see commit f2898d199243ce45b9d7db65da165920d1b83fbb
  severity: info
  tags: tech,influxdb,api
requests:
- extractors:
  - group: 1
    part: header
    regex:
    - X-Influxdb-Version:.*([0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3})
    type: regex
  matchers:
  - status:
    - 204
    type: status
  - part: header
    type: word
    words:
    - 'X-Influxdb-Version:'
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/ping'
