id: kubernetes-version
info:
  author: raesene,idealphase
  description: Searches for exposed Kubernetes API servers which return version information
    unauthenticated. For Google Kubernetes Engine (GKE) and Amazon Elastic Kubernetes
    Service (EKS) this template will extract default patch version for you.
  metadata:
    shodan-query: product:"Kubernetes" version:"1.21.5-eks-bc4871b"
  name: Kubernetes Version Exposure
  reference:
  - https://cloud.google.com/kubernetes-engine/docs/release-notes
  - https://docs.aws.amazon.com/eks/latest/userguide/kubernetes-versions.html
  severity: info
  tags: tech,k8s,kubernetes,devops
requests:
- extractors:
  - json:
    - .gitVersion
    type: json
  matchers:
  - condition: and
    type: word
    words:
    - gitVersion
    - goVersion
    - platform
  method: GET
  path:
  - '{{BaseURL}}/version'
