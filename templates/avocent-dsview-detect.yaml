id: avocent-dsview-detect
info:
  author: milo2012
  name: Avocent DSView Detection
  severity: info
  tags: tech,avocent,dsview
requests:
- extractors:
  - group: 1
    part: body
    regex:
    - <parameter id="product" structure="ROtext" visible="false"><value label="(.*?)">
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - condition: or
    part: body
    type: word
    words:
    - <avtrans>
    - payload
  - part: header
    type: word
    words:
    - text/xml
  matchers-condition: and
  raw:
  - 'POST /appliance/avtrans HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    <avtrans><sid></sid><action>get</action><agents><src>wmi</src><dest>controller</dest></agents><paths><path>login</path></paths></avtrans>

    '
