id: exposed-laravel-horizon
info:
  author: osamahamad
  description: Detects horizon, the one that get expose to the public.
  name: exposed-laravel-horizon
  reference:
  - https://laravel.com/docs/9.x/horizon
  severity: medium
  tags: laravel,custom
requests:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - horizon
    - jobs/completed
    - jobs/pending
    - metrics
    - dashboard
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}/horizon'
  - '{{BaseURL}}:8000/horizon'
  redirects: true
