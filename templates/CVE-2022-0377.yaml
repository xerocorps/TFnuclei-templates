http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - learnpress
  - dsl:
    - compare_versions(version, '<= 4.1.4.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/learnpress/readme.txt'
  redirects: true
id: CVE-2022-0377
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-0377
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 4.3
  description: Users of the LearnPress WordPress plugin before 4.1.5 can upload an
    image as a profile avatar after the registration. After this process the user
    crops and saves the image. Then a 'POST' request that contains user supplied name
    of the image is sent to the server for renaming and cropping of the image. As
    a result of this request, the name of the user-supplied image is changed with
    a MD5 value. This process can be conducted only when type of the image is JPG
    or PNG. An attacker can use this vulnerability in order to rename an arbitrary
    image file. By doing this, they could destroy the design of the web site.
  metadata:
    fofa-query: wp-content/plugins/learnpress/
    google-query: inurl:"/wp-content/plugins/learnpress/"
    shodan-query: vuln:CVE-2022-0377
  name: LearnPress <= 4.1.4.1 - Arbitrary Image Renaming
  reference:
  - https://wpscan.com/vulnerability/0d95ada6-53e3-4a80-a395-eacd7b090f26
  - https://bozogullarindan.com/en/2022/01/wordpress-learnpress-plugin-4.1.4.1-arbitrary-image-renaming/
  - https://github.com/LearnPress/learnpress/commit/d1dc4af7ef2950f1000abc21bd9520fb3eb98faf
  severity: medium
  tags: cve,wordpress,wp-plugin,learnpress,medium
