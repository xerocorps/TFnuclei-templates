http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - astra-sites
  - dsl:
    - compare_versions(version, '<= 2.7.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/astra-sites/readme.txt'
  redirects: true
id: CVE-2021-42360
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-42360
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:L
    cvss-score: 7.6
  description: On sites that also had the Elementor plugin for WordPress installed,
    it was possible for users with the edit_posts capability, which includes Contributor-level
    users, to import blocks onto any page using the astra-page-elementor-batch-process
    AJAX action. An attacker could craft and host a block containing malicious JavaScript
    on a server they controlled, and then use it to overwrite any post or page by
    sending an AJAX request with the action set to astra-page-elementor-batch-process
    and the url parameter pointed to their remotely-hosted malicious block, as well
    as an id parameter containing the post or page to overwrite. Any post or page
    that had been built with Elementor, including published pages, could be overwritten
    by the imported block, and the malicious JavaScript in the imported block would
    then be executed in the browser of any visitors to that page.
  metadata:
    fofa-query: wp-content/plugins/astra-sites/
    google-query: inurl:"/wp-content/plugins/astra-sites/"
    shodan-query: vuln:CVE-2021-42360
  name: "Starter Templates \u2014 Elementor, Gutenberg & Beaver Builder Templates\
    \  <= 2.7.0 - Missing Authorization to Stored Cross-Site Scripting"
  reference:
  - https://www.wordfence.com/blog/2021/11/over-1-million-sites-impacted-by-vulnerability-in-starter-templates-plugin/
  severity: high
  tags: cve,wordpress,wp-plugin,astra-sites,high
