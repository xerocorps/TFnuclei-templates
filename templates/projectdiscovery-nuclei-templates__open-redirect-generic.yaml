http:
- matchers:
  - part: header
    regex:
    - (?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)(?:[a-zA-Z0-9\-_\.@]*)oast\.me\/?(\/|[^.].*)?$
    type: regex
  - condition: or
    status:
    - 301
    - 302
    - 307
    - 308
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{RootURL}}/{{redirect}}'
  payloads:
    redirect:
    - '%0a/oast.me/'
    - '%0d/oast.me/'
    - '%00/oast.me/'
    - '%09/oast.me/'
    - '%5C%5Coast.me/%252e%252e%252f'
    - '%5Coast.me'
    - '%5coast.me/%2f%2e%2e'
    - '%5c{{RootURL}}oast.me/%2f%2e%2e'
    - ../oast.me
    - .oast.me
    - /%5coast.me
    - ////\;@oast.me
    - ////oast.me
    - ///oast.me
    - ///oast.me/%2f%2e%2e
    - ///oast.me@//
    - ///{{RootURL}}oast.me/%2f%2e%2e
    - //;@oast.me
    - //\/oast.me/
    - //\@oast.me
    - //\oast.me
    - //\toast.me/
    - //oast.me/%2F..
    - //oast.me//
    - //%6f%61%73%74%2e%6d%65
    - //oast.me@//
    - //oast.me\toast.me/
    - //https://oast.me//
    - /<>//oast.me
    - /\/\/oast.me/
    - /\/oast.me
    - /\oast.me
    - /oast.me
    - /oast.me/%2F..
    - /oast.me/
    - /oast.me/..;/css
    - /https:oast.me
    - /{{RootURL}}oast.me/
    - "/\u3031oast.me"
    - "/\u3035oast.me"
    - "/\u309Doast.me"
    - "/\u30FCoast.me"
    - "/\uFF70oast.me"
    - <>//oast.me
    - '@oast.me'
    - '@https://oast.me'
    - \/\/oast.me/
    - oast%E3%80%82me
    - oast.me
    - oast.me/
    - oast.me//
    - oast.me;@
    - https%3a%2f%2foast.me%2f
    - https:%0a%0doast.me
    - https://%0a%0doast.me
    - https://%09/oast.me
    - https://%2f%2f.oast.me/
    - https://%3F.oast.me/
    - https://%5c%5c.oast.me/
    - https://%5coast.me@
    - https://%23.oast.me/
    - https://.oast.me
    - https://////oast.me
    - https:///oast.me
    - https:///oast.me/%2e%2e
    - https:///oast.me/%2f%2e%2e
    - https:///oast.me@oast.me/%2e%2e
    - https:///oast.me@oast.me/%2f%2e%2e
    - https://:80#@oast.me/
    - https://:80?@oast.me/
    - https://:@\@oast.me
    - https://:@oast.me\@oast.me
    - https://;@oast.me
    - https://\toast.me/
    - https://oast.me/oast.me
    - https://oast.me/https://oast.me/
    - https://www.\.oast.me
    - https:/\/\oast.me
    - https:/\oast.me
    - https:/oast.me
    - https:oast.me
    - '{{RootURL}}oast.me'
    - "\u3031oast.me"
    - "\u3035oast.me"
    - "\u309Doast.me"
    - "\u30FCoast.me"
    - "\uFF70oast.me"
    - redirect/oast.me
    - cgi-bin/redirect.cgi?oast.me
    - out?oast.me
    - login?to=http://oast.me
    - 1/_https@oast.me
    - redirect?targeturl=https://oast.me
    - /?url_redirect=https://oast.me
  stop-at-first-match: true
id: open-redirect-generic
info:
  author: afaq,melbadry9,Elmahdi,pxmme1337,Regala_,andirrahmani1,geeknik
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-601
  description: An open redirect vulnerability was detected. An attacker can redirect
    a user to a malicious site and possibly obtain sensitive information, modify data,
    and/or execute unauthorized operations.
  metadata:
    max-request: 93
  name: Open Redirect - Detection
  severity: medium
  tags: redirect,generic,vuln
