flow: http(1) && http(2)
http:
- extractors:
  - internal: true
    name: token
    part: body
    regex:
    - \b(glpat-[0-9a-zA-Z_-]{20})(?:\b|$)
    type: regex
  method: GET
  path:
  - '{{BaseURL}}'
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"id":'
    - '"created_at":'
  raw:
  - '@Host: https://gitlab.com:443

    GET /api/v4/personal_access_tokens HTTP/1.1

    Host: gitlab.com

    PRIVATE-TOKEN: {{token}}

    '
  self-contained: true
id: gitlab-personal-token
info:
  author: DhiyaneshDK
  metadata:
    max-request: 1
    verified: true
  name: GitLab Personal Access Token
  reference:
  - https://github.com/praetorian-inc/noseyparker/blob/main/crates/noseyparker/data/default/builtin/rules/gitlab.yml
  - https://docs.gitlab.com/ee/user/profile/personal_access_tokens.html
  severity: high
  tags: gitlab,token,exposure
