http:
- matchers:
  - part: body
    regex:
    - (?:InvalidURI|InvalidArgument|NoSuchBucket)
    type: regex
  - dsl:
    - contains(to_lower(server), "amazons3")
    - contains(to_lower(header), "x-amz-id")
    - contains(to_lower(header), "x-amz-request-id")
    type: dsl
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}/%c0'
id: s3-detect
info:
  author: melbadry9
  metadata:
    max-request: 1
  name: Detect Amazon-S3 Bucket
  severity: info
  tags: aws,s3,bucket,tech,discovery
