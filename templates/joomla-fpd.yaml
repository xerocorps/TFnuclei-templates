http:
- matchers:
  - condition: or
    part: body
    regex:
    - (?i)in\s+/.*\.php\s+on\s+line\s+\d+
    - (?i)fatal\s+error
    - (?i)warning
    - (?i)notice
    type: regex
  - status:
    - 200
    type: status
  - part: body
    regex:
    - (/[^\s:]+/joomla[^\s:]*)
    - (/[^\s:]+/libraries[^\s:]*)
    type: regex
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/libraries/php-inputfilter/inputfilter.php'
  - '{{BaseURL}}/libraries/php-fileupload/fileupload.php'
  - '{{BaseURL}}/libraries/joomla/filesystem/archive/archive.php'
  - '{{BaseURL}}/libraries/joomla/filesystem/archive/tar.php'
  - '{{BaseURL}}/libraries/joomla/filesystem/archive/zip.php'
  - '{{BaseURL}}/libraries/phpmailer/phpmailer.php'
  - '{{BaseURL}}/libraries/phputf8/utils/bad.php'
  - '{{BaseURL}}/libraries/phputf8/utils/unicode.php'
  stop-at-first-match: true
id: joomla-fpd
info:
  author: pussycat0x
  description: 'Detects full path disclosure in Joomla! sending requests to specific
    paths and identifying fatal error stack traces that leaked absolute filesystem
    paths.

    '
  metadata:
    shodan-query: http.component:"joomla"
    verified: true
  name: Joomla! - Full Path Disclosure
  reference:
  - https://developer.joomla.org/security-centre/884-20220801-core-multiple-full-path-disclosures-because-of-missing-jexec-or-die-check.html
  severity: low
  tags: joomla,misconfiguration,fpd,disclosure
