http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '8.x-2.2')
    - compare_versions(version, '8.x-1.2')
    - compare_versions(version, '8.x-1.1')
    - compare_versions(version, '8.x-1.0')
    - compare_versions(version, '7.x-1.9')
    - compare_versions(version, '7.x-1.8')
    - compare_versions(version, '7.x-1.7')
    - compare_versions(version, '7.x-1.6')
    - compare_versions(version, '7.x-1.5')
    - compare_versions(version, '7.x-1.4')
    - compare_versions(version, '7.x-1.3')
    - compare_versions(version, '7.x-1.2')
    - compare_versions(version, '7.x-1.1')
    - compare_versions(version, '7.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - exif
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/exif/exif.info'
  redirects: true
id: drupal_module-exif-remote-code-execution
info:
  author: Bishopfox
  description: This module enables you to automatically scan images uploaded to the
    site to extract their meta data and store it in taxonomy structures. The module
    doesnt sufficiently protect against malicious files being used to attack the site.
    This vulnerability is mitigated by the fact that an attacker must have permission
    to upload images to the site.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/exif/
    google-query: inurl:'/sites/all/modules/exif/
    impact: medium
    security-risk: "Critical 18\u221525 AC:Basic/A:User/CI:All/II:All/E:Theoretical/TD:All"
    type: indicator
    vulnerability: remote-code-execution
  name: drupal_module-exif-remote-code-execution
  reference:
  - https://www.drupal.org/sa-contrib-2022-015
  severity: medium
  tags: drupal
