file:
- extensions:
  - php
  extractors:
  - regex:
    - (?i)\b(passthru|eval|exec|system|phpinfo|assert|call_user_func|call_user_func_array)\(
    - (?i)cmd.exe
    - (?i)/bin/sh
    - (?i)/bin/bash
    - (?i)WScript.Shell
    type: regex
  - regex:
    - (?i)gzuncompress\(base64_decode\(
    - \]\(\$_(GET|POST|COOKIE|REQUEST)\[
    - (?i)new\s*(ReflectionFunction|ReflectionClass)
    - (?i)0x647261646e617473
    - '65786563'
    - (?i)\$\w+\(\$_(GET|POST|COOKIE|REQUEST)
    - (?i)b4tm4n
    - (?i)cmdshell
    type: regex
id: php-webshell-scanner
info:
  author: lu4nx
  name: PHP Webshell Scanner
  reference:
  - https://github.com/tennc/webshell
  severity: high
  tags: php,file
