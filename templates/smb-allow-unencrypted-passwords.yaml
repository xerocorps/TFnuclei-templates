code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'EnablePlainTextPassword : 1'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'Get-ItemProperty -Path ''HKLM:\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters''
    -Name ''EnablePlainTextPassword''

    '
id: smb-allow-unencrypted-passwords
info:
  author: princechaddha
  description: Verifies if the system allows sending unencrypted passwords to third-party
    SMB servers, which is a security risk.
  impact: 'Sending unencrypted passwords over the network can lead to credential theft
    by attackers.

    '
  name: Unencrypted Passwords to SMB Servers Allowed
  remediation: 'Configure SMB to prevent sending unencrypted passwords.

    '
  severity: high
  tags: smb,password,unencrypted,code,windows-audit
self-contained: true
