code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: dbclusters
    type: json
  source: 'aws rds describe-db-clusters --region $region --output json --query ''DBClusters[?Engine==`aurora-mysql`].DBClusterIdentifier
    | []''

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - dbcluster + " AWS RDS Backtrack is Disabled"
    type: dsl
  matchers:
  - type: word
    words:
    - '[]'
  source: 'aws rds describe-db-clusters --region $region --db-cluster-identifier $dbcluster
    --query ''DBClusters[*].BacktrackWindow'' --output json

    '
flow: "code(1)\nfor(let DBClusterIdentifier of iterate(template.dbclusters)){\n  set(\"\
  dbcluster\", DBClusterIdentifier)\n  code(2)\n}\n"
id: rds-backtrack-disabled
info:
  author: DhiyaneshDK
  description: 'Ensure that the Backtrack feature is enabled for your Amazon Aurora
    (with MySQL compatibility) database clusters in order to backtrack your clusters
    to a specific time, without using backups.

    '
  impact: 'Unable to quickly revert the database to a previous state, leading to longer
    recovery times in case of accidental changes or data corruption.

    '
  name: AWS RDS Backtrack - Disabled
  reference:
  - https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/RDS/backtrack.html
  - https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/AuroraMySQL.Managing.Backtrack.html
  remediation: 'Enable Backtrack for the RDS instance through the AWS Management Console,
    CLI, or API, and configure the desired backtrack window to allow quick recovery.

    '
  severity: low
  tags: cloud,devops,aws,amazon,rds,aws-cloud-config
self-contained: true
variables:
  region: us-west-2
