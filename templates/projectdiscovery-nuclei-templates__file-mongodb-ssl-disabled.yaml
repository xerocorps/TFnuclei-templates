file:
- extensions:
  - conf
  matchers:
  - condition: and
    type: word
    words:
    - storage
    - operationProfiling
    - 'ssl:'
    - 'mode: requireSSL'
  - negative: true
    type: word
    words:
    - 'mode: disabled'
  matchers-condition: and
id: file-mongodb-ssl-disabled
info:
  author: pussycat0x
  description: 'Ensures MongoDB uses SSL/TLS for secure connections.

    '
  metadata:
    verified: true
  name: MongoDB SSL Disabled
  reference:
  - https://wiki.devsecopsguides.com/docs/checklists/mongodb/
  - https://www.mongodb.com/docs/manual/tutorial/configure-ssl/
  remediation: 'Set ''net.ssl.mode: requireSSL'' and define ''PEMKeyFile'' in /etc/mongod.conf.

    '
  severity: high
  tags: mongodb,audit,file,hardening
