id: detect-openam
info:
  author: melbadry9 & xelkomy
  description: "The vulnerability was found in the password reset feature that OpenAM\
    \ provides. When a user tries to reset his password, he is asked to enter his\
    \ username then the backend validates whether the user exists or not through an\
    \ LDAP query before the password reset token is sent to the user\u2019s email."
  name: Detect openam reset password token
  reference: https://blog.cybercastle.io/ldap-injection-in-openam/
  severity: info
requests:
- matchers:
  - dsl:
    - contains(body, "jato.pageSession") && status_code==200
    name: detect-openam
    type: dsl
  raw:
  - "GET /openam/ui/PWResetUserValidation HTTP/1.1\nHost: {{Hostname}}\nUser-Agent:\
    \ Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\
    \ Chrome/87.0.4280.88 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\n\
    \  \n"
  - "GET /OpenAM-11.0.0/ui/PWResetUserValidation HTTP/1.1\nHost: {{Hostname}}\nUser-Agent:\
    \ Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\
    \ Chrome/87.0.4280.88 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\n\
    \  \n"
  - "GET /ui/PWResetUserValidation HTTP/1.1\nHost: {{Hostname}}\nUser-Agent: Mozilla/5.0\
    \ (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88\
    \ Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\n\
    \  \n"
  req-condition: true
