code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[].projectId
    name: projectIds
    type: json
  source: 'gcloud projects list --format="json(projectId)"

    '
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[].name
    name: managedZones
    type: json
  source: 'gcloud dns managed-zones list --project $projectId --format="json(name,visibility)"

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"DNSSEC not enabled for Managed Zone: " + managedZoneName + " in Project: "
      + projectId'
    type: dsl
  matchers:
  - type: word
    words:
    - 'off'
  source: 'gcloud dns managed-zones describe $managedZoneName --project $projectId
    --format="json(dnssecConfig.state)"

    '
flow: "code(1)\nfor(let projectId of iterate(template.projectIds)){\n  set(\"projectId\"\
  , projectId)\n  code(2)\n  for(let managedZone of iterate(template.managedZones)){\n\
  \    set(\"managedZoneName\", managedZone)\n    code(3)\n  }\n}\n"
id: gcloud-dns-dnssec-unenabled
info:
  author: princechaddha
  description: 'Ensure that DNSSEC security feature is enabled for all your Google
    Cloud DNS managed zones in order to protect your domains against spoofing and
    cache poisoning attacks. By default, DNSSEC is not enabled for Google Cloud public
    DNS managed zones.

    '
  impact: 'Not enabling DNSSEC for DNS zones can increase the risk of DNS spoofing
    and cache poisoning, compromising the security of domain resolutions.

    '
  name: DNSSEC Not Enabled for Google Cloud DNS Zones
  reference:
  - https://cloud.google.com/dns/docs/dnssec
  remediation: 'Enable DNSSEC for each Google Cloud DNS managed zone through the Google
    Cloud Console or using the `gcloud dns managed-zones update` command with the
    `--dnssec-state=on` flag.

    '
  severity: medium
  tags: cloud,devops,gcp,gcloud,dns,gcp-cloud-config,discovery
self-contained: true
