code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .Users.User[].UserName
    name: username
    type: json
  source: 'aliyun ram ListUsers --region $region

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - username + "MFA For RAM Users With Console Password is Disabled "
    type: dsl
  matchers:
  - type: word
    words:
    - '"MFABindRequired": false'
  source: 'aliyun ram GetLoginProfile --UserName $user --region $region

    '
flow: "code(1)\nfor(let UserName of iterate(template.username)){\n  set(\"user\",\
  \ UserName)\n  code(2)\n}\n"
id: mfa-console-password-disabled
info:
  author: DhiyaneshDK
  description: 'MFA (Multi-Factor Authentication) for RAM users with console password
    is currently disabled, meaning users can access the console without requiring
    a second form of authentication. This configuration reduces security by not enforcing
    an additional layer of protection beyond the password.

    '
  metadata:
    max-request: 1
    verified: true
  name: MFA For RAM Users With Console Password - Disabled
  reference:
  - https://www.alibabacloud.com/help/en/ram/user-guide/bind-an-mfa-device-to-a-ram-user
  - https://www.trendmicro.com/cloudoneconformity/knowledge-base/alibaba-cloud/AlibabaCloud-RAM/ram-user-multi-factor-authentication-enabled.html
  severity: medium
  tags: cloud,devops,aliyun,alibaba,alibaba-cloud-config,alibaba-ram
self-contained: true
variables:
  region: cn-hangzhou
