code:
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"GuardDuty Is Not Enabled"'
    type: dsl
  matchers:
  - type: word
    words:
    - '[]'
  source: 'aws guardduty list-detectors --region $region --query ''DetectorIds'' --output
    json

    '
id: guardduty-not-enabled
info:
  author: DhiyaneshDK
  description: 'Ensure that Amazon GuardDuty service is currently enabled in all regions
    in order to protect your AWS environment and infrastructure (AWS accounts and
    resources, IAM credentials, guest operating systems, applications, etc) against
    security threats.

    '
  impact: 'GuardDuty disabled leaves your AWS environment vulnerable to undetected
    threats, such as unauthorized access, anomalous activities, and potential security
    breaches, compromising the overall security posture.

    '
  name: GuardDuty Not Enabled
  reference:
  - https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/GuardDuty/guardduty-enabled.html
  - https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_settingup.html
  remediation: 'Enable GuardDuty to continuously monitor and detect security threats
    in your AWS environment.

    '
  severity: info
  tags: cloud,devops,aws,amazon,guardduty,aws-cloud-config
self-contained: true
variables:
  region: us-west-2
