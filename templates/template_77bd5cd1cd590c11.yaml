info:
  author: twitter/drfabiocastro
  classification:
    country: any
    tags:
    - security
    - laravel
    - disclosure
  description: Detects the exposure of sensitive information in Laravel applications.
  id: laravel-env-disclosure
  matcher-condition: or
  matchers:
  - description: Matching APP_ variables found in response body
    pattern: (?m)^APP_(NAME|ENV|KEY|DEBUG|URL|PASSWORD)
    type: body
  - description: Matching DB_ variables found in response body
    pattern: (?m)^DB_(HOST|PASSWORD|DATABASE)
    type: body
  name: Laravel Sensitive Data Disclosure
  requests:
    condition: or
    description: Attempt to access Laravel sensitive data files.
    method: GET
    path:
    - /.env
  response:
  - status:
    - 200
  severity: High
