http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - condition: or
    regex:
    - <generator>https?:\/\/wordpress\.org.*</generator>
    - wp-login.php
    - \/wp-content/themes\/
    - \/wp-includes\/
    - name="generator" content="wordpress
    - <link[^>]+s\d+\.wp\.com
    - <!-- This site is optimized with the Yoast (?:WordPress )?SEO plugin v([\d.]+)
      -
    - <!--[^>]+WP-Super-Cache
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: wordpress-website-detect
info:
  author: TykerDeploy
  metadata:
    category: cms
    max-request: 4
    product: wordpress
    shodan-query: http.component:"WordPress"
    vendor: wordpress
    verified: true
  name: WordPress Detect
  severity: info
  tags: tech,wordpress,cms,wp
