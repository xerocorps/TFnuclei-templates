code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'ConsentPromptBehaviorAdmin : 0'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'Get-ItemProperty -Path ''HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System''
    -Name ''ConsentPromptBehaviorAdmin''

    '
id: uac-elevate-without-prompt
info:
  author: princechaddha
  description: Checks if User Account Control (UAC) elevates privileges without prompting,
    reducing security.
  impact: 'Elevating privileges without prompting can allow unauthorized changes to
    the system.

    '
  name: UAC Elevate Without Prompting Enabled
  remediation: 'Configure UAC to prompt for administrative actions.

    '
  severity: high
  tags: uac,privilege,code,windows-audit
self-contained: true
