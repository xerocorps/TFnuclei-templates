http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 4.3', '<= 4.3')
    - compare_versions(version_by_js, '>= 4.3', '<= 4.3')
    - compare_versions(version_by_css, '>= 4.3', '<= 4.3')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2015-5714
info:
  author: topscoder
  classification:
    cve-id: CVE-2015-5714
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 6.4
  description: Cross-site scripting (XSS) vulnerability in WordPress before 4.3.1
    allows remote attackers to inject arbitrary web script or HTML by leveraging the
    mishandling of unclosed HTML elements during processing of shortcode tags.
  metadata:
    shodan-query: vuln:CVE-2015-5714
  name: WordPress Core < 4.3.1 - Cross-Site Scripting via Shortcodes
  reference:
  - https://wpvulndb.com/vulnerabilities/8186
  - https://codex.wordpress.org/Version_4.3.1
  - http://www.debian.org/security/2015/dsa-3375
  - https://github.com/WordPress/WordPress/commit/f72b21af23da6b6d54208e5c1d65ececdaa109c8
  - https://wordpress.org/news/2015/09/wordpress-4-3-1/
  - http://www.securitytracker.com/id/1033979
  - http://www.debian.org/security/2015/dsa-3383
  - https://security-tracker.debian.org/tracker/CVE-2015-5714
  - http://www.securityfocus.com/bid/76745
  severity: medium
  tags: cve,wordpress,wp-core,medium
