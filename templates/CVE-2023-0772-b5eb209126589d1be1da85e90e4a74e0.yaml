http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - optinmonster
  - dsl:
    - compare_versions(version, '<= 2.12.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/optinmonster/readme.txt'
  redirects: true
id: CVE-2023-0772-b5eb209126589d1be1da85e90e4a74e0
info:
  author: topscoder
  classification:
    cve-id: CVE-2023-0772
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 4.3
  description: 'The OptinMonster plugin for WordPress is vulnerable to unauthorized
    access of data due to insufficient post type validation on the  ''prepare_campaign''
    function in versions up to 2.12.1. This makes it possible for authenticated attackers
    with subscriber-level access, and above, to access potentially sensitive information
    due to lack of protections and information restrictions that let campaign information
    or even private post and content information to be leaked.

    '
  metadata:
    fofa-query: wp-content/plugins/optinmonster/
    google-query: inurl:"/wp-content/plugins/optinmonster/"
    shodan-query: vuln:CVE-2023-0772
  name: 'OptinMonster <= 2.12.1 -  Authenticated (Subscriber+) Sensitive Information
    Disclosure via Shortcode

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/dfbdb5a7-e949-4d3a-8c8d-5dc6702f4675?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,optinmonster,low
