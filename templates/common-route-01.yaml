id: common-route-01
info:
  name: Weird Case in route handler
origin:
  headers:
  - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101
      Firefox/55
  method: GET
  redirect: false
  url: '{{.BaseURL}}/hopefully404'
requests:
- detections:
  - StatusCode() == 200 && !StringSearch("response", "Not found") && Math.abs(ContentLength()
    - OriginContentLength()) > 1000
  headers:
  - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101
      Firefox/55
  method: GET
  redirect: false
  url: '{{.BaseURL}}/{{.prefix}}{{.dir}}'
type: list
variables:
- prefix: '%2e

    %2e%2e

    %252e

    %252e%252e

    '
- dir: 'old/

    new/

    backup/

    bak/

    db/

    database/

    data/

    sql/

    tmp/

    temp/

    uploads/

    downloads/

    intranet/

    extranet/

    logs/

    mails/

    files/

    _admin/

    administrador/

    administracion/

    ajax/

    cms/

    '
