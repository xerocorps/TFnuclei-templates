id: sonicwall-secure-mobile-access-version-detect
info:
  author: milo2012
  metadata:
    shodan-query: sonicwall product:"SonicWALL SSL-VPN http proxy" port:443
    verified: true
  name: Sonicwall Secure Mobile Access Version Detect
  severity: info
  tags: tech,sonicwall
requests:
- extractors:
  - group: 1
    part: body
    regex:
    - <meta name="connect-agent-version" content="(.*?)">
    - SWL_LOGIN.sonicwallSMAConnectAgentVersion = "(.*?)";
    type: regex
  matchers:
  - dsl:
    - contains(body,"SWL_LOGIN.sonicwallSMAConnectAgentVersion = \"1.1.20\"")
    - contains(body,"SWL_LOGIN.sonicwallSMAConnectAgentVersion = \"1.1.18\"")
    name: version 10.0.0.0
    type: dsl
  - dsl:
    - contains(body,"SWL_LOGIN.sonicwallSMAConnectAgentVersion = \"10.0.807\"")
    - contains(body,"SWL_LOGIN.sonicwallSMAConnectAgentVersion = \"10.0.0.282\"")
    name: version 10.0.0.1
    type: dsl
  - dsl:
    - contains(body,"SWL_LOGIN.sonicwallSMAConnectAgentVersion = \"1.1.31\"")
    name: version 10.0.0.6
    type: dsl
  - dsl:
    - contains(body,"SWL_LOGIN.sonicwallSMAConnectAgentVersion = \"1.1.27\"")
    - contains(body,"SWL_LOGIN.sonicwallSMAConnectAgentVersion = \"1.1.22\"")
    name: version 10.2.0.0
    type: dsl
  - dsl:
    - contains(body,"SWL_LOGIN.sonicwallSMAConnectAgentVersion = \"1.1.29\"")
    - contains(body,"SWL_LOGIN.sonicwallSMAConnectAgentVersion = \"1.1.22\"")
    name: version 10.2.0.1
    type: dsl
  - dsl:
    - contains(body,"SWL_LOGIN.sonicwallSMAConnectAgentVersion = \"1.1.37\"")
    - contains(body,"SWL_LOGIN.sonicwallSMAConnectAgentVersion = \"1.1.30\"")
    name: version 10.2.0.8
    type: dsl
  - dsl:
    - contains(body,"SWL_LOGIN.sonicwallSMAConnectAgentVersion = \"1.1.36\"")
    - contains(body,"SWL_LOGIN.sonicwallSMAConnectAgentVersion = \"1.1.28\"")
    name: version 10.2.1.0
    type: dsl
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/cgi-bin/welcome'
