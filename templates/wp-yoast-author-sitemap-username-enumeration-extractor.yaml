http:
- extractors:
  - group: 1
    name: usernames
    regex:
    - \/author\/([^\/\?<]+)
    type: regex
  - group: 2
    name: sitemap_lastmod
    regex:
    - <url>\s*<loc>([^<]*\/author\/[^<]+)<\/loc>\s*<lastmod>([^<]+)<\/lastmod>
    type: regex
  - dsl:
    - len(split(body, "/author/")) - 1
    name: user_count
    type: dsl
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - <?xml
    - <lastmod>
    - <loc>
  - condition: or
    part: header
    type: word
    words:
    - application/xml
    - text/xml
  - status:
    - 200
    type: status
  - dsl:
    - len(body) > 100
    type: dsl
  matchers-condition: and
  raw:
  - 'GET /author-sitemap.xml HTTP/1.1

    Host: {{Hostname}}

    '
id: wp-yoast-author-sitemap-username-enumeration-extractor
info:
  author: Caddyshack2175
  classification:
    cpe: cpe:2.3:a:yoast:yoast_seo:*:*:*:*:wordpress:*:*:*
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
  name: WordPress Yoast SEO Plugin - User Enumeration and Extracttion
  reference:
  - https://developer.yoast.com/features/xml-sitemaps/functional-specification/
  severity: info
  tags: information, discloser, wordpress, enum, user, wp, wp-plugin
