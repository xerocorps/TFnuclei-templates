http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 6.3', '<= 6.3.1')
    - compare_versions(version_by_js, '>= 6.3', '<= 6.3.1')
    - compare_versions(version_by_css, '>= 6.3', '<= 6.3.1')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2023-5561
info:
  author: topscoder
  classification:
    cve-id: CVE-2023-5561
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
  description: 'WordPress Core is vulnerable to Sensitive Information Exposure in
    versions between 4.7.0 and 6.3.1 via the User REST endpoint. While the search
    results do not display user email addresses unless the requesting user has the
    ''list_users'' capability, the search is applied to the user_email column. This
    can allow unauthenticated attackers to brute force or verify the email addresses
    of users with published posts or pages on the site.

    '
  metadata:
    shodan-query: vuln:CVE-2023-5561
  name: 'WordPress Core 4.7.0 - 6.3.1 - Sensitive Information Exposure via User Search
    REST Endpoint

    '
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/38b63167-e1a6-4279-97cf-900df0651f20?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-core,medium
