http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '8.x-1.0')
    - compare_versions(version, '7.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - phpconfig
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/phpconfig/phpconfig.info'
  redirects: true
id: drupal_module-phpconfig-arbitrary-php-code-execution
info:
  author: Bishopfox
  description: This module enables you to add or overwrite PHP configuration on a
    drupal website. The module doesnt sufficiently allow access to set these configurations,
    leading to arbitrary PHP configuration execution by an attacker. This vulnerability
    is mitigated by the fact that an attacker must have a role with the permission
    administer phpconfig. After updating the module, its important to review the permissions
    of your website and if administer phpconfig permission is given to a not fully
    trusted user role, we advise to revoke it.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/phpconfig/
    google-query: inurl:'/sites/all/modules/phpconfig/
    impact: medium
    security-risk: "Critical 17\u221525 AC:Basic/A:Admin/CI:All/II:All/E:Theoretical/TD:All"
    type: indicator
    vulnerability: arbitrary-php-code-execution
  name: drupal_module-phpconfig-arbitrary-php-code-execution
  reference:
  - https://www.drupal.org/sa-contrib-2018-055
  severity: medium
  tags: drupal
