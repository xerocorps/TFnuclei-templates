http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-maintenance-mode-site-under-construction
  - dsl:
    - compare_versions(version, '< 1.5.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-maintenance-mode-site-under-construction/readme.txt'
  redirects: true
id: CVE-2021-24190
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24190
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: Low privileged users can use the AJAX action 'cp_plugins_do_button_job_later_callback'
    in the WooCommerce Conditional Marketing Mailer WordPress plugin before 1.5.2,
    to install any plugin (including a specific version) from the WordPress repository,
    as well as activate arbitrary plugin from the blog, which helps attackers install
    vulnerable plugins and could lead to more critical vulnerabilities like RCE.
  metadata:
    fofa-query: wp-content/plugins/wp-maintenance-mode-site-under-construction/
    google-query: inurl:"/wp-content/plugins/wp-maintenance-mode-site-under-construction/"
    shodan-query: vuln:CVE-2021-24190
  name: WooCommerce Conditional Marketing Mailer <= 1.5.1 - Improper Authorization
  reference:
  - https://wpscan.com/vulnerability/74889e29-5349-43d1-baf5-1622493be90c
  severity: high
  tags: cve,wordpress,wp-plugin,wp-maintenance-mode-site-under-construction,high
