http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - blackhole-bad-bots
  - dsl:
    - compare_versions(version, '< 3.3.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/blackhole-bad-bots/readme.txt'
  redirects: true
id: CVE-2022-1165-blackhole_bad_bots-a8447fa0-f994-4de3-b6e7-2fe61e06bed1
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-1165
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
    cvss-score: 9.1
  description: 'The Blackhole for Bad Bots WordPress plugin before 3.3.2 uses headers
    such as CF-CONNECTING-IP, CLIENT-IP etc to determine the IP address of requests
    hitting the blackhole URL, which allows them to be spoofed. This could result
    in blocking arbitrary IP addresses, such as legitimate/good search engine crawlers
    / bots. This could also be abused by competitors to cause damage related to visibility
    in search engines, can be used to bypass arbitrary blocks caused by this plugin,
    block any visitor or even the administrator and even more.

    '
  metadata:
    fofa-query: wp-content/plugins/blackhole-bad-bots/
    google-query: inurl:"/wp-content/plugins/blackhole-bad-bots/"
    shodan-query: http.html:"wp-content/plugins/blackhole-bad-bots/"
  name: 'Blackhole for Bad Bots <= 3.3.1 - Arbitrary IP Address Blocking via IP Spoofing

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/a8447fa0-f994-4de3-b6e7-2fe61e06bed1?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,blackhole-bad-bots,critical,production
