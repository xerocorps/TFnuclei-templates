http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '4.0')
    - compare_versions(version_by_js, '4.0')
    - compare_versions(version_by_css, '4.0')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2014-9031-cef64c30a374f729b1ff049f921475c5
info:
  author: topscoder
  classification:
    cve-id: CVE-2014-9031
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 6.4
  description: 'Cross-site scripting (XSS) vulnerability in the wptexturize function
    in WordPress before 3.7.5, 3.8.x before 3.8.5, and 3.9.x before 3.9.3 allows remote
    attackers to inject arbitrary web script or HTML via crafted use of shortcode
    brackets in a text field, as demonstrated by a comment or a post.

    '
  metadata:
    shodan-query: vuln:CVE-2014-9031
  name: 'WordPress Core < 4.0.1 - Cross-Site Scripting via Shortcode Brackets

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/705a0e1f-79c6-4c2a-8622-fb3df944cf22?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-core,medium
