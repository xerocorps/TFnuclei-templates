code:
- engine:
  - sh
  - bash
  matchers:
  - status:
    - 0
    type: status
  - negative: true
    regex:
    - ^-rw-r--r--\s+\d+\s+root\s+\w+
    type: regex
  matchers-condition: and
  source: 'ls -l /etc/exports 2>&1

    '
id: insecure-etc-exports-permissions
info:
  author: geeknik
  description: 'Identifies insecure permissions on the /etc/exports file used to configure
    NFS exports on macOS.

    '
  impact: 'Insecure permissions on /etc/exports could allow unauthorized users to
    modify the file and gain access to exported filesystems.

    '
  name: macOS Insecure /etc/exports Permissions
  remediation: 'Ensure that the /etc/exports file is owned by root with a system group
    (wheel, admin, etc.) and has permissions of 0644 or more restrictive.

    '
  severity: high
  tags: macos,audit,local,security,nfs
self-contained: true
