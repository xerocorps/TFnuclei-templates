id: redis-info
info:
  author: DhiyaneshDK
  description: 'Retrieves information (such as version number and architecture) from
    a Redis key-value store.

    '
  metadata:
    max-request: 1
    shodan-query: product:"redis"
  name: Redis Info - Detect
  reference:
  - https://nmap.org/nsedoc/scripts/redis-info.html
  severity: info
  tags: js,redis,network
javascript:
- args:
    Host: '{{Host}}'
    Port: '6379'
  code: 'const redis = require(''nuclei/redis'');

    const info = redis.GetServerInfo(Host,Port);

    Export(info);

    '
  extractors:
  - part: response
    regex:
    - redis_version:(\d+\.\d+\.\d+)
    - os:(.*?)\\r\\n
    - arch_bits:(\d+)\s+bits
    - process_id:(\d+)
    - used_cpu_sys:(\d+\.\d+)
    - used_cpu_user:(\d+\.\d+)
    - connected_clients:(\d+)
    - connected_slaves:(\d+)
    - used_memory_human:(\d+\.\d+[KMGTPEZY]?)
    - role:(\w+)
    type: regex
