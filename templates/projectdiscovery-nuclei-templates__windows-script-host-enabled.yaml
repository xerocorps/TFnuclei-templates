code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'True'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: '$(Get-ItemProperty -Path ''HKLM:\Software\Microsoft\Windows Script Host\Settings''
    -Name ''Enabled'' -ErrorAction SilentlyContinue).Enabled -eq 0

    '
id: windows-script-host-enabled
info:
  author: princechaddha
  description: Checks if Windows Script Host is enabled, which can be used to run
    malicious scripts.
  impact: 'Leaving Windows Script Host enabled may allow attackers to execute harmful
    scripts on the system.

    '
  name: Windows Script Host Enabled
  remediation: 'Disable Windows Script Host by setting the Enabled registry key to
    0.

    '
  severity: medium
  tags: windows,code,windows-audit
self-contained: true
