expression: r0() && (r1() || r2())
id: activemq-default-password
info:
  author: pa55w0rd(www.pa55w0rd.online/)
  name: ActiveMQ Default Password
  severity: high
  verified: true
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b"<h2>Welcome to
      the Apache ActiveMQ!</h2>") && response.body.bcontains(b"<title>Apache ActiveMQ</title>")
    request:
      method: GET
      path: /
    stop_if_mismatch: true
  r1:
    expression: response.status == 200 && response.body.bcontains(b"Welcome to the
      Apache ActiveMQ Console of") && response.body.bcontains(b"<h2>Broker</h2>")
    request:
      headers:
        Authorization: Basic {{admin}}
      method: GET
      path: /admin/
    stop_if_match: true
  r2:
    expression: response.status == 200 && response.body.bcontains(b"Welcome to the
      Apache ActiveMQ Console of") && response.body.bcontains(b"<h2>Broker</h2>")
    request:
      headers:
        Authorization: Basic {{user}}
      method: GET
      path: /admin/
    stop_if_match: true
set:
  admin: base64('admin:admin')
  user: base64('user:user')
