flow: http(1) && http(2)
http:
- matchers:
  - dsl:
    - '!contains_all(body, "Index of /", "PARENTDIR")'
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    type: word
    words:
    - Index of /
    - Last modified
    - Parent Directory
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/sites/'
  - '{{BaseURL}}/modules/'
  - '{{BaseURL}}/themes/'
  - '{{BaseURL}}/profiles/'
  - '{{BaseURL}}/includes/'
  - '{{BaseURL}}/misc/'
  - '{{BaseURL}}/scripts/'
  - '{{BaseURL}}/core/'
  - '{{BaseURL}}/vendor/'
  - '{{BaseURL}}/libraries/'
  stop-at-first-match: true
id: drupal-directory-listing
info:
  author: ritikchaddha
  description: Detects enabled directory listing on Drupal installations that may
    expose sensitive files and directory structures.
  metadata:
    shodan-query: http.component:"Drupal"
  name: Drupal Directory Listing
  reference:
  - https://www.drupal.org/
  - https://www.drupal.org/docs/security-in-drupal
  severity: low
  tags: drupal,directory-listing,exposure
