id: xss-deprecated-header-detect
info:
  author: joshlarsen
  description: Setting the XSS-Protection header is deprecated by most browsers. Setting
    the header to anything other than `0` can actually introduce an XSS vulnerability.
  name: Detect Deprecated XSS Protection Header
  reference:
  - https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection
  - https://owasp.org/www-project-secure-headers/#x-xss-protection
  severity: info
  tags: xss,misconfig,generic
requests:
- extractors:
  - kval:
    - x_xss_protection
    part: header
    type: kval
  matchers:
  - negative: true
    part: header
    regex:
    - '(?i)x-xss-protection: 0'
    type: regex
  - part: header
    regex:
    - '(?i)x-xss-protection: 1+'
    type: regex
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
