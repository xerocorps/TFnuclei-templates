http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - iq-block-country
  - dsl:
    - compare_versions(version, '<= 1.2.18')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/iq-block-country/readme.txt'
  redirects: true
id: CVE-2022-41155-d1a399847f3045d9a29d652a881e3154
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-41155
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
  description: 'The iQ Block Country plugin for WordPress is vulnerable to Country
    Blocking Bypass in versions up to, and including, 1.2.18. This is due to the improperly
    implemented login page verification check in the iqblockcountry_is_login_page
    function. This makes it possible for unauthenticated attackers to bypass the country
    block by including the string ''wp-login'' in the URL.

    '
  metadata:
    fofa-query: wp-content/plugins/iq-block-country/
    google-query: inurl:"/wp-content/plugins/iq-block-country/"
    shodan-query: vuln:CVE-2022-41155
  name: 'iQ Block Country <= 1.2.18 - Country Blocking Bypass

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/abc983c6-aa30-4d1b-b6af-99b5ba1c8481?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,iq-block-country,medium
