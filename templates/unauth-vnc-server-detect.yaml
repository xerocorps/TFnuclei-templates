id: unauth-vnc-server-detect
info:
  author: pussycat0x
  description: 'The remote host had a VNC server that permitted access without requiring
    authentication.

    '
  metadata:
    shodan-query: product:"vnc"
    verified: true
  name: Unauthenticated VNC  Server - Detect
  severity: critical
  tags: js,network,vnc,unauth,misconfig,vuln
javascript:
- args:
    Host: '{{Host}}'
    Port: 5900
  code: 'var vnc = require(''nuclei/vnc'');

    var client = new vnc.VNCClient();

    var resp = client.Connect(Host, Port, " ");

    resp;

    '
  matchers:
  - condition: and
    dsl:
    - success == true
    - response == true
    type: dsl
  pre-condition: 'isPortOpen(Host,Port);

    '
