http:
- extractors:
  - group: 1
    regex:
    - CasaOS Version:\s*([0-9.]+)
    type: regex
  matchers:
  - dsl:
    - contains(to_lower(body), 'casaos version')
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/v1/sys/debug'
id: casaos-detection
info:
  author: pdteam
  classification:
    cpe: cpe:2.3:o:icewhale:casaos:*:*:*:*:*:*:*:*
  metadata:
    fofa-query: body="/CasaOS-UI/public/index.html"
    max-request: 1
    product: casaos
    shodan-query: http.html:"/CasaOS-UI/public/index.html"
    vendor: icewhale
  name: CasaOS Detection
  reference:
  - https://github.com/IceWhaleTech/CasaOS
  severity: info
  tags: casaos,tech,oss,discovery
