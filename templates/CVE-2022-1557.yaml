http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - uleak-security-dashboard
  - dsl:
    - compare_versions(version, '<= 1.2.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/uleak-security-dashboard/readme.txt'
  redirects: true
id: CVE-2022-1557
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-1557
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 6.4
  description: The ULeak Security & Monitoring WordPress plugin through 1.2.3 does
    not have authorisation and CSRF checks when updating its settings, and is also
    lacking sanitisation as well as escaping in some of them, which could allow any
    authenticated users such as subscriber to perform Stored Cross-Site Scripting
    attacks against admins viewing the settings.
  metadata:
    fofa-query: wp-content/plugins/uleak-security-dashboard/
    google-query: inurl:"/wp-content/plugins/uleak-security-dashboard/"
    shodan-query: vuln:CVE-2022-1557
  name: ULeak Security & Monitoring Plugin <= 1.2.3 - Stored Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/e2b6dbf5-8709-4a2c-90be-3214ff55ed56
  - https://packetstormsecurity.com/files/166564/
  severity: medium
  tags: cve,wordpress,wp-plugin,uleak-security-dashboard,medium
