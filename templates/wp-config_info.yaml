id: wp-config_info
info:
  author: th3_r3sistanc3
  description: Confifuration file is being leaked with db_username and password
  name: wp-config_exposed
  reference:
  - https://
  - http://
  severity: high
  tags: tags
requests:
- matchers:
  - part: body
    type: word
    words:
    - DB
  - part: body
    type: word
    words:
    - MySQL
  - part: body
    type: word
    words:
    - DB_NAME
  - part: body
    type: word
    words:
    - DB_USER
  matchers-condition: or
  raw:
  - 'GET /wordpress/wp-config.php_orig HTTP/2

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8

    Accept-Language: en-US,en;q=0.5

    Accept-Encoding: gzip, deflate

    Upgrade-Insecure-Requests: 1

    Sec-Fetch-Dest: document

    Sec-Fetch-Mode: navigate

    Sec-Fetch-Site: none

    Sec-Fetch-User: ?1

    Te: trailers

    Connection: close


    '
  - 'GET /wordpress/wp-config.php HTTP/2

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8

    Accept-Language: en-US,en;q=0.5

    Accept-Encoding: gzip, deflate

    Upgrade-Insecure-Requests: 1

    Sec-Fetch-Dest: document

    Sec-Fetch-Mode: navigate

    Sec-Fetch-Site: none

    Sec-Fetch-User: ?1

    Te: trailers

    Connection: close


    '
  - 'GET /wordpress/wp-config.bak HTTP/2

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8

    Accept-Language: en-US,en;q=0.5

    Accept-Encoding: gzip, deflate

    Upgrade-Insecure-Requests: 1

    Sec-Fetch-Dest: document

    Sec-Fetch-Mode: navigate

    Sec-Fetch-Site: none

    Sec-Fetch-User: ?1

    Te: trailers

    Connection: close


    '
  - 'GET /wordpress/wp-config.md HTTP/2

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8

    Accept-Language: en-US,en;q=0.5

    Accept-Encoding: gzip, deflate

    Upgrade-Insecure-Requests: 1

    Sec-Fetch-Dest: document

    Sec-Fetch-Mode: navigate

    Sec-Fetch-Site: none

    Sec-Fetch-User: ?1

    Te: trailers

    Connection: close


    '
  - "GET /wp-config.php HTTP/2\nHost: {{Hostname}}\nUser-Agent: Mozilla/5.0 (X11;\
    \ Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\n\
    Accept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nUpgrade-Insecure-Requests:\
    \ 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: none\n\
    Sec-Fetch-User: ?1\nTe: trailers\nConnection: close        \n\n"
