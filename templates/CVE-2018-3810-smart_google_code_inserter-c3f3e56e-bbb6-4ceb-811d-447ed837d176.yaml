http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - smart-google-code-inserter
  - dsl:
    - compare_versions(version, '< 3.5')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/smart-google-code-inserter/readme.txt'
  redirects: true
id: CVE-2018-3810-smart_google_code_inserter-c3f3e56e-bbb6-4ceb-811d-447ed837d176
info:
  author: topscoder
  classification:
    cve-id: CVE-2018-3810
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
  description: 'Authentication Bypass vulnerability in the Oturia Smart Google Code
    Inserter plugin before 3.5 for WordPress allows unauthenticated attackers to insert
    arbitrary JavaScript or HTML code (via the sgcgoogleanalytic parameter) that runs
    on all pages served by WordPress. The saveGoogleCode() function in smartgooglecode.php
    does not check if the current request is made by an authorized user, thus allowing
    any unauthenticated user to successfully update the inserted code.

    '
  metadata:
    fofa-query: wp-content/plugins/smart-google-code-inserter/
    google-query: inurl:"/wp-content/plugins/smart-google-code-inserter/"
    shodan-query: http.html:"wp-content/plugins/smart-google-code-inserter/"
  name: 'Smart Google Code Inserter < 3.5 - Stored Cross-Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/c3f3e56e-bbb6-4ceb-811d-447ed837d176?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,smart-google-code-inserter,high,production
