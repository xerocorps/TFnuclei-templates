http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - debug-tool
  - dsl:
    - compare_versions(version, '<= 2.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/debug-tool/readme.txt'
  redirects: true
id: CVE-2024-10586-debug_tool-5e9d5c93-dcd7-450e-8c52-5c95fc5473d2
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-10586
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The Debug Tool plugin for WordPress is vulnerable to arbitrary file
    creation due to a missing capability check on the dbt_pull_image() function and
    missing file type validation in all versions up to, and including, 2.2. This makes
    it possible for unauthenticated attackers to to create arbitrary files such as
    .php files that can be leveraged for remote code execution. CVE-2024-52416 may
    be a duplicate of this issue.

    '
  metadata:
    fofa-query: wp-content/plugins/debug-tool/
    google-query: inurl:"/wp-content/plugins/debug-tool/"
    shodan-query: http.html:"wp-content/plugins/debug-tool/"
  name: 'Debug Tool <= 2.2 - Unauthenticated Arbitrary File Creation

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/5e9d5c93-dcd7-450e-8c52-5c95fc5473d2?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,debug-tool,critical,production
