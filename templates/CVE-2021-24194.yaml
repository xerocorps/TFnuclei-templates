http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-limit-failed-login-attempts
  - dsl:
    - compare_versions(version, '< 2.9')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-limit-failed-login-attempts/readme.txt'
  redirects: true
id: CVE-2021-24194
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24194
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: Low privileged users can use the AJAX action 'cp_plugins_do_button_job_later_callback'
    in the Login Protection - Limit Failed Login Attempts WordPress plugin before
    2.9, to install any plugin (including a specific version) from the WordPress repository,
    as well as activate arbitrary plugin from the blog, which helps attackers install
    vulnerable plugins and could lead to more critical vulnerabilities like RCE.
  metadata:
    fofa-query: wp-content/plugins/wp-limit-failed-login-attempts/
    google-query: inurl:"/wp-content/plugins/wp-limit-failed-login-attempts/"
    shodan-query: vuln:CVE-2021-24194
  name: Limit Login Attempts (Spam Protection) <= 2.8 - Missing Authorization to Arbitrary
    Plugin Installation/Activation
  reference:
  - https://wpscan.com/vulnerability/74889e29-5349-43d1-baf5-1622493be90c
  severity: high
  tags: cve,wordpress,wp-plugin,wp-limit-failed-login-attempts,high
