http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - gallery-from-files
  - dsl:
    - compare_versions(version, '<= 1.60')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/gallery-from-files/readme.txt'
  redirects: true
id: CVE-2021-24349-b26001e90f6c7c6bad20c46e57f69cfa
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24349
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
  description: 'This Gallery from files WordPress plugin through 1.6.0 gives the functionality
    of uploading images to the server. But filenames are not properly sanitized before
    being output in an error message when they have an invalid extension, leading
    to a reflected Cross-Site Scripting issue. Due to the lack of CSRF check, the
    attack could also be performed via such vector.

    '
  metadata:
    fofa-query: wp-content/plugins/gallery-from-files/
    google-query: inurl:"/wp-content/plugins/gallery-from-files/"
    shodan-query: vuln:CVE-2021-24349
  name: 'Gallery from files <= 1.60 - Reflected Cross-Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/d76b08c3-0d28-4e81-8843-5afded9efaa6?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,gallery-from-files,medium
