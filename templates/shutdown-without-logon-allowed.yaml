code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'shutdownwithoutlogon : 1'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'Get-ItemProperty -Path ''HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System''
    -Name ''ShutdownWithoutLogon''

    '
id: shutdown-without-logon-allowed
info:
  author: princechaddha
  description: Checks if the system allows shutdown without logging on, which could
    lead to denial-of-service attacks.
  impact: 'Allowing shutdown without logging on can result in denial-of-service or
    unauthorized shutdown of the system.

    '
  name: System Allows Shutdown Without Logging On
  remediation: 'Restrict system shutdown to logged-in users to prevent unauthorized
    access.

    '
  severity: medium
  tags: windows,shutdown,logon,code,windows-audit
self-contained: true
