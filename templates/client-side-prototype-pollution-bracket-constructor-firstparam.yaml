headless:
- matchers:
  - part: resp
    type: word
    words:
    - rs0n
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}?constructor[prototype][rs0n]=rs0n'
  - action: waitload
  - action: script
    args:
      code: '() => { document.body.innerHTML = rs0n }

        '
    name: pollution-check
id: client-side-prototype-pollution-bracket-constructor-firstparam
info:
  author: rs0n
  description: 'Client-Side Prototype Pollution was detected -- PAYLOAD: {{BaseURL}}?constructor[prototype][rs0n]=rs0n

    '
  name: Prototype Pollution Check Using Dot Notation
  reference:
  - https://book.hacktricks.xyz/pentesting-web/deserialization/nodejs-proto-prototype-pollution/client-side-prototype-pollution
  - https://portswigger.net/web-security/prototype-pollution
  - https://www.youtube.com/watch?v=guPuPblLPI8
  - https://github.com/R-s0n/Green-Energy
  severity: medium
  tags: headless, prototype-pollution
