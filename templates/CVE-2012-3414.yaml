http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '<= 3.3.1')
    - compare_versions(version_by_js, '<= 3.3.1')
    - compare_versions(version_by_css, '<= 3.3.1')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2012-3414
info:
  author: topscoder
  classification:
    cve-id: CVE-2012-3414
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
  description: Cross-site scripting (XSS) vulnerability in swfupload.swf in SWFUpload
    2.2.0.1 and earlier, as used in WordPress before 3.3.2, TinyMCE Image Manager
    1.1, and other products, allows remote attackers to inject arbitrary web script
    or HTML via the movieName parameter, related to the 'ExternalInterface.call' function.
  metadata:
    shodan-query: vuln:CVE-2012-3414
  name: WordPress Core <= 3.3.1 - Cross-Site Scripting
  reference:
  - http://code.google.com/p/swfupload/issues/detail?id=376
  - http://www.securityfocus.com/bid/54245
  - http://www.openwall.com/lists/oss-security/2012/07/17/12
  - http://bot24.blogspot.ca/2013/04/swfupload-object-injectioncsrf.html
  - https://nealpoole.com/blog/2012/05/xss-and-csrf-via-swf-applets-swfupload-plupload/
  - http://www.openwall.com/lists/oss-security/2012/07/16/4
  - http://make.wordpress.org/core/2013/06/21/secure-swfupload/
  - http://packetstormsecurity.com/files/122399/TinyMCE-Image-Manager-1.1-Cross-Site-Scripting.html
  - https://wordpress.org/news/2012/04/wordpress-3-3-2/
  severity: medium
  tags: cve,wordpress,wp-core,medium
