code:
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"Automatic Provisioning for Microsoft Defender are not enabled"'
    type: dsl
  matchers:
  - type: word
    words:
    - '"autoProvision": "Off"'
  source: 'az security auto-provisioning-setting list

    '
id: azure-defender-auto-provisioning-disabled
info:
  author: princechaddha
  description: 'Ensure that the automatic provisioning extensions are enabled within
    the Microsoft Defender for Cloud settings to collect security data and events
    from your Azure virtual machines (VMs) and containers. By enabling Auto provisioning,
    you can ensure that the agents needed for processes such as vulnerability assessments,
    log analytics, and container monitoring are automatically installed on your infrastructure.

    '
  impact: 'Disabling or not configuring automatic provisioning may lead to lack of
    critical security data collection, hindering effective security monitoring and
    incident response.

    '
  name: Azure Defender for Cloud Automatic Provisioning Disabled
  reference:
  - https://docs.microsoft.com/en-us/azure/security-center/security-center-auto-provisioning
  remediation: 'Enable the automatic provisioning feature within Microsoft Defender
    for Cloud to ensure that all necessary security agents are automatically deployed
    across your Azure resources.

    '
  severity: medium
  tags: cloud,devops,azure,microsoft,defender-for-cloud,azure-cloud-config
self-contained: true
