http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - woocommerce-jetpack
  - dsl:
    - compare_versions(version, '<= 5.4.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/woocommerce-jetpack/readme.txt'
  redirects: true
id: CVE-2021-34646-woocommerce_jetpack-af37f301-d97f-47d3-b6a8-88cb41344541
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-34646
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'Versions up to, and including, 5.4.3, of the Booster for WooCommerce
    WordPress plugin are vulnerable to authentication bypass via the process_email_verification
    function due to a random token generation weakness in the reset_and_mail_activation_link
    function found in the ~/includes/class-wcj-emails-verification.php file. This
    allows attackers to impersonate users and trigger an email address verification
    for arbitrary accounts, including administrative accounts, and automatically be
    logged in as that user, including any site administrators. This requires the Email
    Verification module to be active in the plugin and the Login User After Successful
    Verification setting to be enabled, which it is by default.

    '
  metadata:
    fofa-query: wp-content/plugins/woocommerce-jetpack/
    google-query: inurl:"/wp-content/plugins/woocommerce-jetpack/"
    shodan-query: http.html:"wp-content/plugins/woocommerce-jetpack/"
  name: 'Booster for WooCommerce <= 5.4.3 - Authentication Bypass

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/af37f301-d97f-47d3-b6a8-88cb41344541?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,woocommerce-jetpack,critical,production
