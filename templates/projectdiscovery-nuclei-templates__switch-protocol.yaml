http:
- extractors:
  - dsl:
    - upgrade
    type: dsl
  matchers:
  - dsl:
    - status_code == 101
    - contains(to_lower(header), "switching protocols")
    - 'contains(to_lower(header), "connection: upgrade")'
    - contains(to_lower(header), "upgrade:")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}'
id: switch-protocol
info:
  author: pdteam
  metadata:
    max-request: 1
    shodan-query: '"connection: upgrade"'
    verified: true
  name: Switching Protocol Detection
  severity: info
  tags: protocol,switching,tech,websocket,h2c,discovery
