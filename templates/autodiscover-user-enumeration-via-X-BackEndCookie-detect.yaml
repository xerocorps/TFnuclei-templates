http:
- extractors:
  - group: 1
    name: xbackendcookie_value
    part: header
    regex:
    - X-BackEndCookie=([^;]*)
    type: regex
  matchers:
  - name: cookie
    part: header
    type: word
    words:
    - X-BackEndCookie
  raw:
  - 'GET /autodiscover/autodiscover.json/v1.0/user@example.com?Protocol=Autodiscoverv1
    HTTP/1.1

    Host: {{Host}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36

    Connection: close

    '
id: autodiscover-user-enumeration-via-X-BackEndCookie-detect
info:
  author: salavoz
  description: 'Detects unauthenticated user enumeration via X-BackEndCookie from
    Autodiscover JSON endpoint.

    '
  name: Microsoft Autodiscover - X-BackEndCookie User Enumeration
  severity: medium
