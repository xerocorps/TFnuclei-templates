id: ricoh-weak-password
info:
  author: gy741
  name: Ricoh Weak Password
  reference: https://ricoh-printer.co/default-username-and-password-for-ricoh-web-image-monitor/
  severity: high
  tags: ricoh,default-login
requests:
- attack: pitchfork
  matchers:
  - part: header
    regex:
    - wimsesid=[0-9]+
    type: regex
  - status:
    - 302
    type: status
  matchers-condition: and
  payloads:
    username:
    - admin
  raw:
  - 'POST /web/guest/tw/websys/webArch/login.cgi HTTP/1.1

    Host: {{Hostname}}

    Cookie: cookieOnOffChecker=on;


    wimToken=&userid_work=&userid={{base64(username)}}&password_work=&password=&open=

    '
