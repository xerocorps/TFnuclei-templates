id: rtl-tcp-server-detect
info:
  author: RandomRobbie
  description: 'Discovers RTL-TCP servers utilized for Software Defined Radio (SDR).
    RTL-TCP enables remote access to RTL-SDR dongles via TCP connections. These servers
    are compatible with SDR applications such as SDR#, GQRX, CubicSDR, and others

    '
  metadata:
    max-request: 2
    verified: true
  name: RTL-TCP Server Detection
  reference:
  - https://github.com/steve-m/librtlsdr
  - https://osmocom.org/projects/rtl-sdr/wiki/Rtl-sdr
  severity: info
  tags: rtl-sdr,sdr,radio,iot,network,detect
tcp:
- extractors:
  - kval:
    - host
    - port
    name: server-info
    type: kval
  host:
  - '{{Hostname}}'
  inputs:
  - data: '{{hex_decode(''01000000070b8140'')}}'
  - data: '{{hex_decode(''020000000024f600'')}}'
  matchers:
  - name: rtl0-handshake
    type: word
    words:
    - RTL0
  - condition: or
    name: sdr-software
    type: word
    words:
    - SoapySDR
    - GNU Radio
    - rtl_tcp
  - dsl:
    - len(body) > 100
    name: iq-data-stream
    type: dsl
  matchers-condition: or
  port: 1234,8888,50000,50001,1235,8889
  read-size: 1024
