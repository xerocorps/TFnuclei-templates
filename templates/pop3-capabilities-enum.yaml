id: pop3-capabilities-enum
info:
  author: pussycat0x
  description: 'POP3 capabilities are defined in RFC 2449. The CAPA command allows
    a client to ask a server what commands it supports and possibly any site-specific
    policy. Besides the list of supported commands, the IMPLEMENTATION string giving
    the server version may be available.

    '
  metadata:
    max-request: 1
    shodan-query: port:110
    verified: true
  name: POP3 Capabilities - Enumeration
  reference:
  - https://nmap.org/nsedoc/scripts/pop3-capabilities.html
  severity: info
  tags: js,network,pop3,enum
javascript:
- args:
    Host: '{{Host}}'
    Port: 110
  code: 'let data = "CAPA\r\n"

    let c = require("nuclei/net");

    let conn = c.Open(''tcp'', `${Host}:${Port}`);

    conn.Send(data);

    let result = conn.RecvString();

    let cleanedData = result.replace(/\+OK Dovecot ready\.\r\n\+OK|\r\n|\s/g, " ");

    console.log(Export(cleanedData))

    '
  extractors:
  - dsl:
    - response
    name: null
    type: dsl
  matchers:
  - dsl:
    - success == true
    type: dsl
  - negative: true
    type: word
    words:
    - HTTP/1.1
  matchers-condition: and
