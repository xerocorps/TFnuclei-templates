code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'True'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: '(Get-SmbServerConfiguration).EnableSMB1Protocol

    '
id: smb-v1-enabled
info:
  author: princechaddha
  description: Detects if SMB v1 protocol is enabled, which is vulnerable to numerous
    exploits.
  impact: 'SMB v1 is vulnerable to multiple attacks, including the infamous WannaCry
    ransomware.

    '
  name: SMB v1 Protocol Enabled
  remediation: 'Disable SMB v1 protocol to enhance the security of your system.

    '
  severity: critical
  tags: windows,smb,network,protocol,code,windows-audit
self-contained: true
