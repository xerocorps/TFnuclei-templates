http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - autoptimize
  - dsl:
    - compare_versions(version, '< 2.8.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/autoptimize/readme.txt'
  redirects: true
id: CVE-2021-24332-autoptimize-be24d47e-4880-4d7f-9be2-cf8eb1afe888
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24332
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 5.5
  description: 'The Autoptimize WordPress plugin before 2.8.4 was missing proper escaping
    and sanitisation in some of its settings, allowing high privilege users to set
    XSS payloads in them, leading to stored Cross-Site Scripting issues.

    '
  metadata:
    fofa-query: wp-content/plugins/autoptimize/
    google-query: inurl:"/wp-content/plugins/autoptimize/"
    shodan-query: http.html:"wp-content/plugins/autoptimize/"
  name: 'Autoptimize <= 2.8.3 - Stored Cross-Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/be24d47e-4880-4d7f-9be2-cf8eb1afe888?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,autoptimize,medium,production
