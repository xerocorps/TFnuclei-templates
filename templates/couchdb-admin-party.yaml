expression: r0()
id: couchdb-admin-party
info:
  author: organiccrap
  description: Requests made against CouchDB are done in the context of an admin user.
  name: CouchDB Admin Party
  severity: high
  verified: false
rules:
  r0:
    expression: response.body.bcontains(b'total_rows') && response.body.bcontains(b'offset')
      && response.headers["server"].icontains("CouchDB/")
    request:
      method: GET
      path: /_users/_all_docs
