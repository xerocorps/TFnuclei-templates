http:
- extractors:
  - group: 1
    part: body
    regex:
    - '[a-z]+\.v?([0-9_\.]+)\.'
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains_any(body, "\"@odata.type\":", "/redfish/v1/$metadata#Message")
    - contains(header, "application/json")
    - status_code == 200 || status_code == 502
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/redfish/v1/'
id: redfish-api
info:
  author: righettod
  description: 'Redfish API was detected.

    '
  metadata:
    max-request: 1
    shodan-query: http.html:"/redfish/v1"
    verified: true
  name: Redfish API - Detect
  reference:
  - https://en.wikipedia.org/wiki/Redfish_(specification)
  - https://www.dmtf.org/standards/redfish
  severity: info
  tags: config,exposure,redfish,api
