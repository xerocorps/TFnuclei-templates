code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'True'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: '($null -eq (Get-ItemProperty -Path ''HKLM:\SYSTEM\CurrentControlSet\Control\Lsa''
    -Name ''RunAsPPL'' -ErrorAction SilentlyContinue).RunAsPPL) -or ((Get-ItemProperty
    -Path ''HKLM:\SYSTEM\CurrentControlSet\Control\Lsa'' -Name ''RunAsPPL'' -ErrorAction
    SilentlyContinue).RunAsPPL -eq 0)

    '
id: windows-lsa-protection-not-enabled
info:
  author: princechaddha
  description: 'Checks if LSA (Local Security Authority) protection is disabled or
    not configured.

    '
  impact: 'Disabling or not configuring LSA protection can allow attackers to perform
    credential dumping.

    '
  name: LSA Protection Not Enabled or Not Configured
  remediation: 'Enable LSA protection to prevent malicious actors from dumping credentials
    from the system.

    '
  severity: high
  tags: windows,lsa,code,windows-audit
self-contained: true
