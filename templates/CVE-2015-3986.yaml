http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - thecartpress
  - dsl:
    - compare_versions(version, '<= 1.5.3.6')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/thecartpress/readme.txt'
  redirects: true
id: CVE-2015-3986
info:
  author: topscoder
  classification:
    cve-id: CVE-2015-3986
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: Cross-site request forgery (CSRF) vulnerability in the TheCartPress
    eCommerce Shopping Cart (aka The Professional WordPress eCommerce Plugin) plugin
    for WordPress before 1.3.9.3 allows remote attackers to hijack the authentication
    of administrators for requests that conduct directory traversal attacks via the
    tcp_box_path parameter in the checkout_editor_settings page to wp-admin/admin.php.
  metadata:
    fofa-query: wp-content/plugins/thecartpress/
    google-query: inurl:"/wp-content/plugins/thecartpress/"
    shodan-query: vuln:CVE-2015-3986
  name: TheCartPress eCommerce Shopping Cart <= 1.5.3.6 Cross-Site Request Forgery
  reference:
  - https://www.htbridge.com/advisory/HTB23254
  - https://wordpress.org/plugins/thecartpress/changelog/
  - http://packetstormsecurity.com/files/131673/WordPress-TheCartPress-1.3.9-XSS-Local-File-Inclusion.html
  - http://www.securityfocus.com/bid/74395
  - https://www.exploit-db.com/exploits/36860/
  - http://www.securityfocus.com/archive/1/535396/100/0/threaded
  - https://thecartpress.com/extend/important-note-nota-importante/
  severity: high
  tags: cve,wordpress,wp-plugin,thecartpress,high
