id: CVE-2021-29156 2
info:
  author: melbadry9,xelkomy
  description: "The vulnerability was found in the password reset feature that OpenAM\
    \ provides. When a user tries to reset his password, he is asked to enter his\
    \ username then the backend validates whether the user exists or not through an\
    \ LDAP query before the password reset token is sent to the user\xE2\u20AC\u2122\
    s email."
  name: LDAP Injection In Openam
  reference: https://blog.cybercastle.io/ldap-injection-in-openam/
  severity: high
  tags: cve,cve2021,openam
requests:
- attack: sniper
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - jato.pageSession
  matchers-condition: and
  payloads:
    Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
  raw:
  - 'GET /OpenAM-11.0.0/ui/PWResetUserValidation HTTP/1.1

    Host: {{Subdomains}}

    '
  threads: 100
