code:
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"Azure Account han an Entra ID guest user Microsoft Entra ID"'
    type: dsl
  matchers:
  - type: word
    words:
    - '"userType": "Guest"'
  source: 'az ad user list --query "[?userType==''Guest'']" --output json

    '
id: azure-entra-id-guest-users-unmonitored
info:
  author: princechaddha
  description: 'For a Microsoft Azure business-to-business (B2B) collaboration, each
    Microsoft Entra ID guest user needs to be associated with a business owner or
    business process. Ensure that there are no unassociated Microsoft Entra ID guest
    users within your Microsoft Azure account when there is no need for B2B collaboration.

    '
  impact: 'Presence of unmonitored Microsoft Entra ID guest users can lead to unauthorized
    access and potential security risks within the Azure environment.

    '
  name: Azure Entra ID Guest Users Unmonitored
  reference:
  - https://docs.microsoft.com/en-us/azure/active-directory/external-identities/
  remediation: 'Regularly review and monitor guest users in Microsoft Entra ID to
    ensure each is associated with a business owner or process. Remove any unnecessary
    guest user accounts.

    '
  severity: medium
  tags: cloud,devops,azure,microsoft,entra-id,azure-cloud-config
self-contained: true
