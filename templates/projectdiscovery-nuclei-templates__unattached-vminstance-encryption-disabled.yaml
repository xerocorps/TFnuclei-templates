code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .Disks.Disk[].InstanceId
    name: instanceid
    type: json
  source: 'aliyun ecs DescribeDisks --region $region

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - instanceid + " Encryption for VM Instance Disks is Disabled"
    type: dsl
  matchers:
  - type: word
    words:
    - '"Encrypted": false'
  - negative: true
    type: word
    words:
    - '"InstanceId": ""'
  matchers-condition: and
  source: 'aliyun ecs DescribeDisks --InstanceId $instanceid --region $region

    '
flow: "code(1)\nfor(let InstanceId of iterate(template.instanceid)){\n  set(\"instanceid\"\
  , InstanceId)\n  code(2)\n}\n"
id: unattached-vminstance-encryption-disabled
info:
  author: DhiyaneshDK
  description: 'The encryption for VM instance disks in Alibaba Cloud is currently
    disabled. This means that the data stored on these disks is not automatically
    encrypted for enhanced security.

    '
  metadata:
    max-request: 1
    verified: true
  name: Encryption for VM Instance Disks - Disabled
  reference:
  - https://www.trendmicro.com/cloudoneconformity/knowledge-base/alibaba-cloud/AlibabaCloud-ECS/encrypt-vm-instance-disks.html
  - https://www.alibabacloud.com/help/en/ecs/user-guide/encrypt-a-system-disk
  - https://www.alibabacloud.com/help/en/ecs/user-guide/encrypt-a-data-disk
  severity: high
  tags: cloud,devops,aliyun,alibaba,alibaba-cloud-config,ecs
self-contained: true
variables:
  region: cn-hangzhou
