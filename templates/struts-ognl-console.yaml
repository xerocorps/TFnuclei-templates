http:
- matchers:
  - part: body
    type: word
    words:
    - Welcome to the OGNL console!
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/struts/webconsole.html?debug=console'
  - '{{BaseURL}}/sdp/struts/webconsole.html?debug=console'
  - '{{BaseURL}}/webconsole.html?debug=console'
  - '{{BaseURL}}/..;/webconsole.html?debug=console'
  - '{{BaseURL}}/struts/webconsole.html'
  - '{{BaseURL}}/..;/struts/webconsole.html'
  - '{{BaseURL}}/..;/struts/webconsole.html?debug=console'
  - '{{BaseURL}}/admin/struts/webconsole.html?debug=console'
  - '{{BaseURL}}/api/struts/webconsole.html?debug=console'
  - '{{BaseURL}}/admin/..;/struts/webconsole.html?debug=console'
  stop-at-first-match: true
id: struts-ognl-console
info:
  author: DhiyaneshDK
  description: 'This development console allows the evaluation of OGNL expressions
    that could lead to Remote Command Execution

    '
  metadata:
    shodan-query: html:"Struts Problem Report"
    verified: 'true'
  name: Apache Struts - OGNL Console
  reference:
  - https://github.com/PortSwigger/j2ee-scan/blob/master/src/main/java/burp/j2ee/issues/impl/ApacheStrutsWebConsole.java
  - https://medium.com/@yousefmoh15/how-i-got-rce-in-one-of-bugcrowds-public-programs-5725c8dc46ce
  remediation: Restrict access to the struts console on the production server
  severity: high
  tags: java,apache,generic
