id: oracle-detect
info:
  author: pussycat0x
  description: Detects if a target host is running Oracle service on port 1521
  metadata:
    max-request: 1
    shodan-query: oracle port:1521
    verified: true
  name: Oracle - Detection
  severity: info
  tags: js,network,oracle,info,enum,discovery
javascript:
- args:
    Host: '{{Host}}'
    Port: '1521'
  code: 'let m = require(''nuclei/oracle'');

    let response = m.IsOracle(Host,Port);

    Export(response);

    '
  matchers:
  - condition: and
    dsl:
    - success == true
    - 'contains(response, "\"IsOracle\": true")'
    type: dsl
