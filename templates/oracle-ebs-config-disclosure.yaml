id: oracle-ebs-config-disclosure
info:
  confidence: Tentative
  name: Oracle EBS Config Disclosure
  risk: Medium
params:
- root: '{{.BaseURL}}'
references:
- links:
  - https://www.blackhat.com/docs/us-16/materials/us-16-Litchfield-Hackproofing-Oracle-eBusiness-Suite-wp-4.pdf
  - https://www.blackhat.com/docs/us-16/materials/us-16-Litchfield-Hackproofing-Oracle-eBusiness-Suite.pdf
  - http://www.davidlitchfield.com/AssessingOraclee-BusinessSuite11i.pdf
requests:
- detections:
  - StatusCode() == 200 && StringSearch("body", "Web CGI Configuration") && StringSearch("body",
    "OA_JAVA")
  headers:
  - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101
      Firefox/55
  method: GET
  redirect: false
  url: '{{.root}}{{.prefix}}/bin/appsweb.cfg'
- detections:
  - StatusCode() == 200 && StringSearch("body", "Pasta configuration file") && StringSearch("body",
    "%%") && StringSearch("resHeaders", "text/plain")
  headers:
  - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101
      Firefox/55
  method: GET
  redirect: false
  url: '{{.root}}{{.prefix}}/bin/pasta.cfg'
variables:
- prefix: '/html

    //html/

    //OA_HTML/

    '
