id: aix-websm-detect
info:
  author: righettod
  description: 'Detects IBM AIX Web-based System Manager services.

    '
  metadata:
    max-request: 1
    shodan-query: /websm/
    verified: true
  name: AIX WebSM - Detect
  reference:
  - https://en.wikipedia.org/wiki/IBM_Web-based_System_Manager
  - https://www.filibeto.org/unix/aix/lib/rel/5.2/wsmadmn.pdf
  severity: info
  tags: network,aix,detect,detection,tcp,discovery
tcp:
- host:
  - '{{Hostname}}'
  inputs:
  - data: "en_US\r\n"
    read: 1024
  matchers:
  - condition: and
    part: data
    type: word
    words:
    - /var/websm/
    - startNewWServer
  port: 9090
  read-size: 4096
