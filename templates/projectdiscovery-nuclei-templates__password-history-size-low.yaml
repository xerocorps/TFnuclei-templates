code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - Password history size is too low or not configured.
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: '$policy = Get-ItemProperty -Path ''HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon''
    -Name ''PasswordHistorySize'' -ErrorAction SilentlyContinue; if ($null -eq $policy.PasswordHistorySize
    -or $policy.PasswordHistorySize -lt 24) { "Password history size is too low or
    not configured." }

    '
id: password-history-size-low
info:
  author: princechaddha
  description: Checks if the password history count is too low or not configured,
    allowing password reuse.
  impact: 'A low or unset password history setting may allow users to reuse recently
    used passwords, increasing the risk of password compromise.

    '
  name: Password History Size Too Low
  remediation: 'Increase the password history count to at least 24 previous passwords
    to prevent rapid reuse of old passwords.

    '
  severity: medium
  tags: password,history,code,windows-audit
self-contained: true
