http:
- extractors:
  - group: 1
    part: body
    regex:
    - (?i)&copy;\s+([0-9]+)\s+Esri\.
    - <b>Current\s+Version:\s+<\/b>([0-9.]+)
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_any(to_lower(body), "<title>arcgis portal directory", "search arcgis
      enterprise help", "<title>arcgis</title>", "arcgis rest services directory",
      "<title>arcgis hub</title>")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/portal/sharing/rest'
  - '{{BaseURL}}/portal/portalhelp/en/rest/'
  - '{{BaseURL}}/arcgis/rest/services'
  - '{{BaseURL}}/server/rest/services'
  - '{{BaseURL}}/arcgis/'
  stop-at-first-match: true
id: arcgis-detect
info:
  author: righettod
  description: 'ArcGIS products was detected.

    '
  metadata:
    max-request: 5
    shodan-query: http.title:"ArcGIS"
    verified: true
  name: ArcGIS - Detect
  reference:
  - https://enterprise.arcgis.com/en/
  severity: info
  tags: tech,arcgis,detect,discovery
