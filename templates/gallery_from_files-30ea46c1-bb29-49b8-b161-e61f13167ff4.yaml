http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - gallery-from-files
  - dsl:
    - compare_versions(version, '<= 1.60')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/gallery-from-files/readme.txt'
  redirects: true
id: gallery_from_files-30ea46c1-bb29-49b8-b161-e61f13167ff4
info:
  author: topscoder
  classification:
    cve-id: null
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The Gallery From Files plugin for WordPress is vulnerable to arbitrary
    file uploads in versions up to, and including, 1.60 via improperly implemented
    allowed extension checks. This allows unauthenticated attackers to upload malicious
    files to the server which can be used to obtain remote code exectution.

    '
  metadata:
    fofa-query: wp-content/plugins/gallery-from-files/
    google-query: inurl:"/wp-content/plugins/gallery-from-files/"
    shodan-query: http.html:"wp-content/plugins/gallery-from-files/"
  name: 'Gallery From Files <= 1.60 - Arbitrary File Upload

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/30ea46c1-bb29-49b8-b161-e61f13167ff4?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,gallery-from-files,critical,production
