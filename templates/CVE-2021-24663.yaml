http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - simple-schools-staff-directory
  - dsl:
    - compare_versions(version, '<= 1.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/simple-schools-staff-directory/readme.txt'
  redirects: true
id: CVE-2021-24663
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24663
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
  description: The Simple Schools Staff Directory WordPress plugin through 1.1 does
    not validate uploaded logo pictures to ensure that are indeed images, allowing
    high privilege users such as admin to upload arbitrary file like PHP, leading
    to RCE
  metadata:
    fofa-query: wp-content/plugins/simple-schools-staff-directory/
    google-query: inurl:"/wp-content/plugins/simple-schools-staff-directory/"
    shodan-query: vuln:CVE-2021-24663
  name: Simple Schools Staff Directory <= 1.1 - Authenticated (Admin+) Arbitrary File
    Upload
  reference:
  - https://wpscan.com/vulnerability/8b5b5b57-50c5-4cd8-9171-168c3e9df46a
  severity: high
  tags: cve,wordpress,wp-plugin,simple-schools-staff-directory,high
