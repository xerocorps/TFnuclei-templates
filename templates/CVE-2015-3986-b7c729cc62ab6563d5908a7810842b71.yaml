http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - thecartpress
  - dsl:
    - compare_versions(version, '<= 1.5.3.6')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/thecartpress/readme.txt'
  redirects: true
id: CVE-2015-3986-b7c729cc62ab6563d5908a7810842b71
info:
  author: topscoder
  classification:
    cve-id: CVE-2015-3986
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: 'Cross-site request forgery (CSRF) vulnerability in the TheCartPress
    eCommerce Shopping Cart (aka The Professional WordPress eCommerce Plugin) plugin
    for WordPress before 1.3.9.3 allows remote attackers to hijack the authentication
    of administrators for requests that conduct directory traversal attacks via the
    tcp_box_path parameter in the checkout_editor_settings page to wp-admin/admin.php.

    '
  metadata:
    fofa-query: wp-content/plugins/thecartpress/
    google-query: inurl:"/wp-content/plugins/thecartpress/"
    shodan-query: vuln:CVE-2015-3986
  name: 'TheCartPress eCommerce Shopping Cart <= 1.5.3.6 Cross-Site Request Forgery

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/8593b14e-672d-43b8-b516-d068cbd735b7?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,thecartpress,high
