code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'RestrictAnonymous: 0'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: '$restrictAnonymous = Get-ItemProperty -Path ''HKLM:\SYSTEM\CurrentControlSet\Control\Lsa''
    -Name ''RestrictAnonymous''

    Write-Host "RestrictAnonymous: $($restrictAnonymous.RestrictAnonymous)"

    '
id: restrict-anonymous-access-disabled
info:
  author: princechaddha
  description: Verifies if anonymous access restrictions are disabled.
  impact: 'Disabling restrictions on anonymous access could expose sensitive information
    and increase the attack surface.

    '
  name: Restrict Anonymous Access Disabled
  remediation: 'Enable anonymous access restrictions by setting the RestrictAnonymous
    registry key to 1 or 2.

    '
  severity: high
  tags: windows,anonymous-access,code,windows-audit
self-contained: true
