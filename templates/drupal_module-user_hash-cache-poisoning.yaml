http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '2.0.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - user_hash
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/user_hash/user_hash.info'
  redirects: true
id: drupal_module-user_hash-cache-poisoning
info:
  author: Bishopfox
  description: This module enables you to create an individual hash for each user.
    These hashes can be used for authentication instead of the users password, e.g.
    for views exporters. The module doesnt sufficiently invalidate page output when
    the page_cache module is used. This vulnerability is mitigated by the fact that
    an attacker must have a user hash that grants access to specific content and the
    attack must be timed to the reset of the page cache.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/user_hash/
    google-query: inurl:'/sites/all/modules/user_hash/
    impact: medium
    security-risk: "Moderately critical 12\u221525 AC:Complex/A:None/CI:Some/II:None/E:Theoretical/TD:All"
    type: indicator
    vulnerability: cache-poisoning
  name: drupal_module-user_hash-cache-poisoning
  reference:
  - https://www.drupal.org/sa-contrib-2021-030
  severity: medium
  tags: drupal
