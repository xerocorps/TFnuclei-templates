id: deprecated-tls
info:
  author: righettod,forgedhallpass
  description: 'Both TLS 1.1 and SSLv3 are deprecated in favor of stronger encryption.

    '
  metadata:
    max-request: 3
    shodan-query: ssl.version:sslv2 ssl.version:sslv3 ssl.version:tlsv1 ssl.version:tlsv1.1
  name: Deprecated TLS Detection
  reference:
  - https://ssl-config.mozilla.org/#config=intermediate
  remediation: 'Update the web server''s TLS configuration to disable TLS 1.1 and
    SSLv3.

    '
  severity: info
  tags: ssl,tls,vuln
ssl:
- address: '{{Host}}:{{Port}}'
  extractors:
  - json:
    - ' .tls_version'
    name: tls_1.1
    type: json
  max_version: tls11
  min_version: tls11
- address: '{{Host}}:{{Port}}'
  extractors:
  - json:
    - ' .tls_version'
    name: tls_1.0
    type: json
  max_version: tls10
  min_version: tls10
- address: '{{Host}}:{{Port}}'
  extractors:
  - json:
    - ' .tls_version'
    name: ssl_3.0
    type: json
  max_version: ssl30
  min_version: ssl30
