code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell.exe
  matchers:
  - type: word
    words:
    - Installer runs with elevated privileges
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: "if ((Get-ItemProperty -Path 'HKLM:\\Software\\Policies\\Microsoft\\Windows\\\
    Installer' -Name 'AlwaysInstallElevated' -ErrorAction SilentlyContinue).AlwaysInstallElevated\
    \ -eq 1) {\n  Write-Output 'Installer runs with elevated privileges';\n}\n"
id: windows-installer-elevated-privileges
info:
  author: princechaddha
  description: Checks if Windows Installer runs with elevated privileges for non-admin
    users, which could be exploited.
  impact: 'Elevated privileges for the Windows Installer may allow non-administrative
    users to install unauthorized software.

    '
  name: Windows Installer Elevated Privileges Enabled
  remediation: 'Disable elevated privileges for non-admin users in Windows Installer
    settings.

    '
  severity: medium
  tags: installer,elevated-privileges,code,windows-audit
self-contained: true
