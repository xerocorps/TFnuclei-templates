code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell.exe
  matchers:
  - type: word
    words:
    - Unsigned driver installation allowed
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'if ((Get-ItemProperty ''HKLM:\SOFTWARE\Policies\Microsoft\Windows\DriverInstall''
    -Name ''BehaviorOnFailedVerify'' -ErrorAction SilentlyContinue).BehaviorOnFailedVerify
    -eq 0) { Write-Output ''Unsigned driver installation allowed''; }

    '
id: unsigned-kernel-mode-drivers-allowed
info:
  author: princechaddha
  description: Checks if the system allows installation of unsigned kernel-mode drivers,
    which can be malicious.
  impact: 'Unsigned kernel-mode drivers can be malicious and compromise system security.

    '
  name: Installation of Unsigned Kernel-Mode Drivers Allowed
  remediation: 'Restrict the installation of unsigned drivers by enforcing driver
    signature checks.

    '
  severity: high
  tags: drivers,kernel-mode,code,windows-audit
self-contained: true
