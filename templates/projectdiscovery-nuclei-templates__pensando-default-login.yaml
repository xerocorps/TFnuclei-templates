flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - contains(body,"<title>AMD Pensando PSM</title>")
    - status_code == 200
    internal: true
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}'
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, "\"name\":\"admin\"")
    - contains(content_type, "application/json")
    type: dsl
  raw:
  - 'POST /v1/login HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"username":"{{username}}","password":"{{password}}","tenant":"default"}

    '
id: pensando-default-login
info:
  author: tpierru
  description: 'The AMD Pensando Policy and Services Manager used a default password
    for the admin account.This allowed instances to be accessed using the default
    credentials.

    '
  metadata:
    fofa-query: icon_hash="1907840597"
    verified: true
  name: AMD Pensando PSM - Default Login
  reference:
  - https://www.amd.com/en/solutions/data-center/networking.html
  - https://arubanetworking.hpe.com/techdocs/Pensando/AMD_Pensando_PSM_for_DSS_Guide-1.72.1-T.pdf
  severity: high
  tags: pensando,default-login,vuln
variables:
  password: Pensando0$
  username: admin
