http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '<= 3.6.1')
    - compare_versions(version_by_js, '<= 3.6.1')
    - compare_versions(version_by_css, '<= 3.6.1')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: Yes-675ede79d493b0a76c720ffb103f738d
info:
  author: topscoder
  classification:
    cve-id: null
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 5.5
  description: WordPress Core is vulnerable to Stored Cross-Site Scripting, exploitable
    during comment editing, in versions up to 6.0.3. This is due to insufficient escaping
    and sanitization on the values being stored during a comment update. This makes
    it possible for authenticated users with high level permissions, such as an editor,
    to modify post comments to include malicious web scripts that will execute whenever
    someone accesses the comment.
  metadata:
    shodan-query: 'vuln:'
  name: WordPress Core < 6.0.3 - Authenticated (Editor+) Stored Cross-Site Scripting
    via Comments
  reference:
  - https://www.wordfence.com/blog/2022/10/patch-now-the-wordpress-6-0-3-security-update-contains-important-fixes/
  - https://core.trac.wordpress.org/changeset/54537
  - https://wordpress.org/news/2022/10/wordpress-6-0-3-security-release/
  severity: medium
  tags: cve,wordpress,wp-core,medium
