http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - <version>([^<]+)</version>
    type: regex
  matchers:
  - condition: or
    part: body
    type: word
    words:
    - RetrieveServiceContentResponse
    - urn:vim
  - part: content_type
    type: word
    words:
    - text/xml
  - status:
    - 200
    type: status
  - dsl:
    - compare_versions(version, '< 6.7.0')
    type: dsl
  matchers-condition: and
  raw:
  - "POST /sdk/ HTTP/1.1\nHost: {{Hostname}}\nContent-Type: text/xml\nSOAPAction:\
    \ \"urn:vim25/6.5\"\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<soap:Envelope\
    \ xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\
    \ xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n   <soap:Header>\n\
    \      <operationID>00000001-00000001</operationID>\n   </soap:Header>\n   <soap:Body>\n\
    \      <RetrieveServiceContent xmlns=\"urn:internalvim25\">\n         <_this xsi:type=\"\
    ManagedObjectReference\" type=\"ServiceInstance\">ServiceInstance</_this>\n  \
    \    </RetrieveServiceContent>\n   </soap:Body>\n</soap:Envelope>\n"
id: CVE-2020-3952
info:
  author: 0x_Akoko
  classification:
    cpe: cpe:2.3:a:vmware:vcenter_server:6.7:-:*:*:*:*:*:*
    cve-id: CVE-2020-3952
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-306
    epss-percentile: 0.99956
    epss-score: 0.94355
  description: 'Under certain conditions, vmdir that ships with VMware vCenter Server,
    as part of an embedded or external Platform Services Controller (PSC), does not
    correctly implement access controls.

    '
  impact: 'Unauthorized users may access sensitive functions, potentially leading
    to privilege escalation or data exposure.

    '
  metadata:
    max-request: 1
    product: vcenter_server
    vendor: vmware
    verified: false
  name: VMware vCenter Server LDAP Broken Access Control
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2020-3952
  - https://www.vmware.com/security/advisories/VMSA-2020-0006.html
  - https://github.com/guardicore/vmware_vcenter_cve_2020_3952
  remediation: 'Apply the latest security patches and updates provided by VMware to
    address access control issues.

    '
  severity: critical
  tags: cve,cve2020,vmware,vcenter,ldap,auth-bypass,passive,kev,vkev
