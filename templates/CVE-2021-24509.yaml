http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - page-views-count
  - dsl:
    - compare_versions(version, '<= 2.4.8')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/page-views-count/readme.txt'
  redirects: true
id: CVE-2021-24509
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24509
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
  description: The Page View Count WordPress plugin before 2.4.9 does not escape the
    postid parameter of pvc_stats shortcode, allowing users with a role as low as
    Contributor to perform Stored XSS attacks. A post made by a contributor would
    still have to be approved by an admin to have the XSS triggered in the frontend,
    however, higher privilege users, such as editor could exploit this without the
    need of approval, and even when the blog disallows the unfiltered_html capability.
  metadata:
    fofa-query: wp-content/plugins/page-views-count/
    google-query: inurl:"/wp-content/plugins/page-views-count/"
    shodan-query: vuln:CVE-2021-24509
  name: Page View Counts <= 2.4.8 - Contributor+ Stored Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/06df2729-21da-4c22-ae1e-dda1f15bdf8f
  severity: medium
  tags: cve,wordpress,wp-plugin,page-views-count,medium
