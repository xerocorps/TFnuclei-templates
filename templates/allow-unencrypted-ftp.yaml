code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - Deny
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'Get-WebConfiguration -Filter system.ftpServer/security/authentication/basicAuthentication
    -PSPath IIS:\ -ErrorAction SilentlyContinue

    '
id: allow-unencrypted-ftp
info:
  author: princechaddha
  description: Verifies if the FTP server allows unencrypted connections, which can
    expose sensitive data.
  impact: 'Allowing unencrypted FTP can expose credentials and data to attackers during
    transmission.

    '
  name: Allow Unencrypted FTP
  remediation: 'Configure FTP to require encrypted connections using SSL/TLS.

    '
  severity: high
  tags: ftp,windows,code,windows-audit
self-contained: true
