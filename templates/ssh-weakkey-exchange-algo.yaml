id: ssh-weakkey-exchange-algo
info:
  author: pussycat0x
  description: 'SSH Weak Key Exchange Algorithms Enabled indicates that the SSH server
    or client is configured to allow the use of less secure key exchange methods,
    posing a potential security risk during the establishment of secure connections.
    It''s crucial to update configurations to prioritize stronger key exchange algorithms.

    '
  metadata:
    max-request: 2
    shodan-query: product:"OpenSSH"
    verified: true
  name: SSH Weak Key Exchange Algorithms Enabled
  reference:
  - https://www.tenable.com/plugins/nessus/153953
  severity: low
  tags: js,ssh,misconfig,network
javascript:
- args:
    Host: '{{Host}}'
    Port: '22'
  code: 'let m = require("nuclei/ssh");

    let c = m.SSHClient();

    let response = c.ConnectSSHInfoMode(Host, Port);

    to_json(response);

    '
  matchers:
  - type: word
    words:
    - ServerKex
  - condition: or
    type: word
    words:
    - diffie-hellman-group-exchange-sha1
    - diffie-hellman-group1-sha1
    - gss-gex-sha1
    - gss-group1-sha1
    - gss-group14-sha1
    - rsa1024-sha1
  matchers-condition: and
  pre-condition: 'isPortOpen(Host,Port);

    '
