http:
- attack: pitchfork
  extractors:
  - group: 1
    internal: true
    name: csrf_tkn
    part: body
    regex:
    - csrf_tkn=([A-Za-z0-9.-]+)
    type: regex
  - internal: true
    kval:
    - JSESSIONID
    name: session
    part: header
    type: kval
  matchers:
  - part: header
    type: word
    words:
    - /super/index.html
  - status:
    - 302
    type: status
  matchers-condition: and
  payloads:
    password:
    - password
    username:
    - super
  raw:
  - 'GET /super/login.html?lang=en HTTP/1.1

    Host: {{Hostname}}

    Origin: {{BaseURL}}

    '
  - 'POST /super/super_security_check;jsessionid={{session}}?csrf_tkn={{csrf_tkn}}
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    Origin: {{BaseURL}}

    Referer: {{RootURL}}/super/login.html?lang=en

    Cookie: JSESSIONID={{session}} ; VidyoPortalSuperLanguage=en


    username={{username}}&password={{password}}

    '
id: vidyo-default-login
info:
  author: izn0u
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    cvss-score: 5.8
    cwe-id: CWE-522
  description: Vidyo default credentials were discovered.
  metadata:
    max-request: 2
  name: Vidyo Default Login
  reference:
  - https://support.vidyocloud.com/hc/en-us/articles/226265128
  severity: medium
  tags: vidyo,default-login,vuln
