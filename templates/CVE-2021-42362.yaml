http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wordpress-popular-posts
  - dsl:
    - compare_versions(version, '<= 5.3.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wordpress-popular-posts/readme.txt'
  redirects: true
id: CVE-2021-42362
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-42362
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: The WordPress Popular Posts WordPress plugin is vulnerable to arbitrary
    file uploads due to insufficient input file type validation found in the ~/src/Image.php
    file which makes it possible for attackers with contributor level access and above
    to upload malicious files that can be used to obtain remote code execution, in
    versions up to and including 5.3.2.
  metadata:
    fofa-query: wp-content/plugins/wordpress-popular-posts/
    google-query: inurl:"/wp-content/plugins/wordpress-popular-posts/"
    shodan-query: vuln:CVE-2021-42362
  name: WordPress Popular Posts <= 5.3.2 - Authenticated Arbitrary File Upload
  reference:
  - https://blog.nintechnet.com/improper-input-validation-fixed-in-wordpress-popular-posts-plugin/
  - https://www.wordfence.com/vulnerability-advisories/#CVE-2021-42362
  - https://plugins.trac.wordpress.org/changeset/2542638/wordpress-popular-posts/trunk/src/Image.php
  - https://wpscan.com/vulnerability/bd4f157c-a3d7-4535-a587-0102ba4e3009
  - http://packetstormsecurity.com/files/165376/WordPress-Popular-Posts-5.3.2-Remote-Code-Execution.html
  severity: high
  tags: cve,wordpress,wp-plugin,wordpress-popular-posts,high
