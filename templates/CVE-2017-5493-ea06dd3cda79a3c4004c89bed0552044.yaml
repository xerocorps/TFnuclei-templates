http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 4.7', '<= 4.7.0')
    - compare_versions(version_by_js, '>= 4.7', '<= 4.7.0')
    - compare_versions(version_by_css, '>= 4.7', '<= 4.7.0')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2017-5493-ea06dd3cda79a3c4004c89bed0552044
info:
  author: topscoder
  classification:
    cve-id: CVE-2017-5493
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
  description: 'wp-includes/ms-functions.php in the Multisite WordPress API in WordPress
    before 4.7.1 does not properly choose random numbers for keys, which makes it
    easier for remote attackers to bypass intended access restrictions via a crafted
    (1) site signup or (2) user signup.

    '
  metadata:
    shodan-query: vuln:CVE-2017-5493
  name: 'WordPress Core < 4.7.1 - Weak Multi-Site Activation Key for User and Site
    Signup

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/14b7fd1e-6e2d-49bb-8492-b072afeebd88?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-core,medium
