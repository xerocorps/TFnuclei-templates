headless:
- extractors:
  - kval:
    - extract
    part: extract
    type: kval
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}'
  - action: waitload
  - action: script
    args:
      code: "() => {\n return '\\n' + [...new Set(Array.from(document.querySelectorAll('[src],\
        \ [href], [url], [action]')).map(i => i.src || i.href || i.url || i.action))].join('\\\
        r\\n') + '\\n'\n}\n"
    name: extract
id: extract-urls
info:
  author: dwisiswant0
  name: Extract URLs from HTML attributes
  severity: info
  tags: headless,extractor
