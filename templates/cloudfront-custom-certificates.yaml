code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: distributions
    type: json
  source: 'aws cloudfront list-distributions --output table --query ''DistributionList.Items[*].Id''
    --region $region --output json

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"Cloudfront Custom SSL/TLS Certificates " + distribution + " In Use"'
    type: dsl
  matchers:
  - type: word
    words:
    - 'False'
  source: 'aws cloudfront get-distribution --region $region --id $distribution --query
    ''Distribution.DistributionConfig.ViewerCertificate.CloudFrontDefaultCertificate''
    --output text

    '
flow: "code(1)\nfor(let DistributionListItemsId of iterate(template.distributions)){\n\
  \  set(\"distribution\", DistributionListItemsId)\n  code(2)\n}\n"
id: cloudfront-custom-certificates
info:
  author: DhiyaneshDK
  description: 'Ensure that your Amazon CloudFront distributions are configured to
    use a custom SSL/TLS certificate instead of the default one.

    '
  impact: 'Failing to use custom SSL/TLS certificates in CloudFront can result in
    trust issues with end users, exposing your web content to man-in-the-middle attacks
    and potentially damaging your brand''s reputation due to untrusted connection
    warnings.

    '
  name: Cloudfront Custom SSL/TLS Certificates - In Use
  reference:
  - https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/CloudFront/cloudfront-distro-custom-tls.html
  - https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/CNAMEs.html
  remediation: 'Configure your Amazon CloudFront distribution to use custom SSL/TLS
    certificates to ensure secure and trusted connections for your users, enhancing
    data protection and maintaining brand integrity.

    '
  severity: medium
  tags: cloud,devops,aws,amazon,cloudfront,aws-cloud-config
self-contained: true
variables:
  region: us-west-2
