http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - rest-api-to-miniprogram
  - dsl:
    - compare_versions(version, '<= 4.7.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/rest-api-to-miniprogram/readme.txt'
  redirects: true
id: CVE-2024-8485-rest_api_to_miniprogram-b53066d3-2ff3-4460-896a-facd77455914
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-8485
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The REST API TO MiniProgram plugin for WordPress is vulnerable to
    privilege escalation via account takeovr in all versions up to, and including,
    4.7.1 via the updateUserInfo() due to missing validation on the ''openid'' user
    controlled key that determines what user will be updated. This makes it possible
    for unauthenticated attackers to update arbitrary user''s accounts, including
    their email to a @weixin.com email, which can the be leveraged to reset the password
    of the user''s account, including administrators.

    '
  metadata:
    fofa-query: wp-content/plugins/rest-api-to-miniprogram/
    google-query: inurl:"/wp-content/plugins/rest-api-to-miniprogram/"
    shodan-query: http.html:"wp-content/plugins/rest-api-to-miniprogram/"
  name: 'REST API TO MiniProgram <= 4.7.1 - Unauthenticated Arbitrary User Email Update
    and Privilege Escalation via Account Takeover

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/b53066d3-2ff3-4460-896a-facd77455914?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,rest-api-to-miniprogram,critical,production
