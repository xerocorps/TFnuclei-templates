http:
- matchers:
  - name: http
    part: interactsh_protocol
    type: word
    words:
    - http
  - name: dns
    part: interactsh_protocol
    type: word
    words:
    - dns
  matchers-condition: or
  raw:
  - 'GET / HTTP/1.1

    Host: {{interactsh-url}}

    Cache-Control: no-transform

    Accept: */*


    '
  - 'GET / HTTP/1.1

    Host: @{{interactsh-url}}

    Cache-Control: no-transform

    Accept: */*


    '
  - 'GET http://{{interactsh-url}}/ HTTP/1.1

    Host: {{Hostname}}

    Cache-Control: no-transform

    Accept: */*


    '
  - 'GET @{{interactsh-url}}/ HTTP/1.1

    Host: {{Hostname}}

    Cache-Control: no-transform

    Accept: */*


    '
  - 'GET {{interactsh-url}}:80/ HTTP/1.1

    Host: {{Hostname}}

    Cache-Control: no-transform

    Accept: */*


    '
  unsafe: true
id: request-based-interaction
info:
  author: pdteam
  description: The remote server fetched a spoofed DNS Name from the request.
  metadata:
    max-request: 5
  name: OOB Request Based Interaction
  reference:
  - https://portswigger.net/research/cracking-the-lens-targeting-https-hidden-attack-surface
  severity: info
  tags: oast,ssrf,generic,vuln
