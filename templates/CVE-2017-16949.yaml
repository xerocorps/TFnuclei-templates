http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - accesspress-anonymous-post-pro
  - dsl:
    - compare_versions(version, '< 3.2.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/accesspress-anonymous-post-pro/readme.txt'
  redirects: true
id: CVE-2017-16949
info:
  author: topscoder
  classification:
    cve-id: CVE-2017-16949
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: An issue was discovered in the AccessKeys AccessPress Anonymous Post
    Pro plugin through 3.1.9 for WordPress. Improper input sanitization allows the
    attacker to override the settings for allowed file extensions and upload file
    size, related to inc/cores/file-uploader.php and file-uploader/file-uploader-class.php.
    This allows the attacker to upload anything they want to the server, as demonstrated
    by an action=ap_file_upload_action&allowedExtensions[]=php request to /wp-admin/admin-ajax.php
    that results in a .php file upload and resultant PHP code execution.
  metadata:
    fofa-query: wp-content/plugins/accesspress-anonymous-post-pro/
    google-query: inurl:"/wp-content/plugins/accesspress-anonymous-post-pro/"
    shodan-query: vuln:CVE-2017-16949
  name: AccessPress Anonymous Post Pro <= 3.1.9 - Unauthenticated Arbitrary File Upload
  reference:
  - https://www.exploit-db.com/exploits/43324/
  - https://wpvulndb.com/vulnerabilities/8977
  - http://packetstormsecurity.com/files/145398/Accesspress-Anonymous-Post-Pro-Unauthenticated-Arbitrary-File-Upload.html
  severity: critical
  tags: cve,wordpress,wp-plugin,accesspress-anonymous-post-pro,critical
