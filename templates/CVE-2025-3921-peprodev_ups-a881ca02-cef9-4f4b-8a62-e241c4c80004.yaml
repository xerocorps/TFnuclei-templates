http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - peprodev-ups
  - dsl:
    - compare_versions(version, '>= 1.9.1', '<= 7.5.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/peprodev-ups/readme.txt'
  redirects: true
id: CVE-2025-3921-peprodev_ups-a881ca02-cef9-4f4b-8a62-e241c4c80004
info:
  author: topscoder
  classification:
    cve-id: CVE-2025-3921
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:L
    cvss-score: 8.2
  description: 'The PeproDev Ultimate Profile Solutions plugin for WordPress is vulnerable
    to unauthorized modification of data due to a missing capability check on the
    handel_ajax_req() function in versions 1.9.1 to 7.5.2. This makes it possible
    for unauthenticated attackers to update arbitrary user''s metadata which can be
    leveraged to block an administrator from accessing their site when wp_capabilities
    is set to 0.

    '
  metadata:
    fofa-query: wp-content/plugins/peprodev-ups/
    google-query: inurl:"/wp-content/plugins/peprodev-ups/"
    shodan-query: http.html:"wp-content/plugins/peprodev-ups/"
  name: 'PeproDev Ultimate Profile Solutions 1.9.1 - 7.5.2 - Missing Authorization
    to Limited Unauthenticated Arbitrary User Meta Update via handel_ajax_req Function

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/a881ca02-cef9-4f4b-8a62-e241c4c80004?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,peprodev-ups,high,production
