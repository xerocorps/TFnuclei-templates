http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - ultimate-member
  - dsl:
    - compare_versions(version, '< 2.1.12')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/ultimate-member/readme.txt'
  redirects: true
id: CVE-2020-36155
info:
  author: topscoder
  classification:
    cve-id: CVE-2020-36155
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
  description: An issue was discovered in the Ultimate Member plugin before 2.1.12
    for WordPress, aka Unauthenticated Privilege Escalation via User Meta. An attacker
    could supply an array parameter for sensitive metadata, such as the wp_capabilities
    user meta that defines a user's role. During the registration process, submitted
    registration details were passed to the update_profile function, and any metadata
    was accepted, e.g., wp_capabilities[administrator] for Administrator access.
  metadata:
    fofa-query: wp-content/plugins/ultimate-member/
    google-query: inurl:"/wp-content/plugins/ultimate-member/"
    shodan-query: vuln:CVE-2020-36155
  name: Ultimate Member <= 2.1.11 - Unauthenticated Privilege Escalation via User
    Meta
  reference:
  - https://wordpress.org/plugins/ultimate-member/#developers
  - https://www.wordfence.com/blog/2020/11/critical-privilege-escalation-vulnerabilities-affect-100k-sites-using-ultimate-member-plugin/
  - https://wpscan.com/vulnerability/cf13b0f8-5815-4d27-a276-5eff8985fc0b
  severity: critical
  tags: cve,wordpress,wp-plugin,ultimate-member,critical
