expression: r0() && (r1() || r2())
id: jenkins-default-pwd
info:
  author: zan8in
  description: app="Jenkins"
  name: Jenkins Default Password
  severity: high
  verified: true
rules:
  r0:
    expression: 'response.status == 200 && response.body.bcontains(b''Sign in [Jenkins]'')

      '
    request:
      method: GET
      path: /login
    stop_if_mismatch: true
  r1:
    expression: 'response.status == 302 && !response.headers["location"].contains("loginError")

      '
    request:
      body: 'j_username=admin&j_password=admin&from=&Submit=Sign+in

        '
      method: POST
      path: /j_spring_security_check
    stop_if_match: true
  r2:
    expression: "response.status == 302 && response.body.bcontains(b'<title>\u5DE5\
      \u4F5C\u53F0 [Jenkins]</title>')\n"
    request:
      body: 'j_username=jenkins&j_password=password&from=&Submit=Sign+in

        '
      method: POST
      path: /j_spring_security_check
    stop_if_match: true
