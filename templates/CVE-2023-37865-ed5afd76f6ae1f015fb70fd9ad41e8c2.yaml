http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - ip2location-country-blocker
  - dsl:
    - compare_versions(version, '<= 2.29.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/ip2location-country-blocker/readme.txt'
  redirects: true
id: CVE-2023-37865-ed5afd76f6ae1f015fb70fd9ad41e8c2
info:
  author: topscoder
  classification:
    cve-id: CVE-2023-37865
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 6.5
  description: 'The Download IP2Location Country Blocker plugin for WordPress is vulnerable
    to IP Address Spoofing in versions up to, and including, 2.29.1. This is due to
    insufficient restrictions on where the IP Address information is being retrieved
    for request logging and access restrictions. Attackers can supply the X-Real-IP
    or X-Forwarded-For header with a different IP Address that will be logged and
    can be used to bypass settings that may have blocked out an IP address from accessing
    a page on the site.

    '
  metadata:
    fofa-query: wp-content/plugins/ip2location-country-blocker/
    google-query: inurl:"/wp-content/plugins/ip2location-country-blocker/"
    shodan-query: vuln:CVE-2023-37865
  name: 'Download IP2Location Country Blocker <= 2.29.1 - Bypass via IP Spoofing

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/814fd060-8781-46ad-86e6-e2b75a7fffc0?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,ip2location-country-blocker,medium
