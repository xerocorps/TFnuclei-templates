code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'True'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: '$rdpService = Get-Service -Name TermService;

    $rdpPort = (Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal
    Server\WinStations\RDP-Tcp").PortNumber;

    if ($rdpService.Status -eq ''Running'' -and $rdpPort -eq 3389) { Write-Host "True"
    } else { Write-Host "False" }

    '
id: remote-desktop-default-port
info:
  author: asteria121
  description: 'The Remote Desktop Protocol (RDP) service listens on a default port
    (TCP 3389), which is commonly targeted by attackers.

    '
  impact: 'Exposure of the default RDP port (TCP 3389) increases the risk of brute-force
    attacks and unauthorized access. This can lead to system compromise, data breaches,
    and ransomware deployment.

    '
  name: Remote Desktop Listening Default Port - Detect
  remediation: 'Change the default RDP listening port to a non-standard port to reduce
    exposure.

    '
  severity: info
  tags: windows,rdp,audit
self-contained: true
