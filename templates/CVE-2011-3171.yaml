id: CVE-2011-3171
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:pureftpd:pure-ftpd:*:*:*:*:*:*:*:*
    cve-id: CVE-2011-3171
    cvss-metrics: CVSS:2.0/AV:L/AC:L/Au:N/C:N/I:P/A:P
    cvss-score: 3.6
    cwe-id: CWE-22
    epss-percentile: 0.04288
    epss-score: 0.00019
  description: "Pure-FTPd versions \u2264 1.0.22 (and earlier) contain a directory\
    \ traversal vulnerability when the \"Netware OES remote server\" feature is enabled.\
    \ This allows local users to overwrite arbitrary files on the system, potentially\
    \ leading to unauthorized file modification or system compromise.\n"
  impact: 'Local users can exploit directory traversal when Netware OES remote server
    feature is enabled to overwrite arbitrary files on the system, potentially leading
    to privilege escalation or system compromise.

    '
  metadata:
    max-request: 1
    product: pure-ftpd
    shodan-query:
    - product:"pure-ftpd" version:"1.0.14"
    - cpe:"cpe:2.3:a:pureftpd:pure-ftpd"
    vendor: pureftpd
    verified: true
  name: "Pure-FTPd \u2264 1.0.22 - Directory Traversal"
  reference:
  - http://lists.opensuse.org/opensuse-security-announce/2011-09/msg00015.html
  - http://lists.opensuse.org/opensuse-security-announce/2011-09/msg00016.html
  - https://exchange.xforce.ibmcloud.com/vulnerabilities/69686
  remediation: 'Update Pure-FTPd to a version newer than 1.0.22 that properly validates
    paths when Netware OES remote server feature is enabled and prevents directory
    traversal attacks.

    '
  severity: low
  tags: cve,cve2011,network,ftp,pure-ftpd,tcp,passive,lfi,vuln
tcp:
- extractors:
  - group: 1
    name: version
    regex:
    - Pure-FTPd ([0-9.]+)
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: 0
    type: hex
  matchers:
  - condition: and
    dsl:
    - contains(raw, 'Pure-FTPd')
    - compare_versions(version, '<= 1.0.22')
    type: dsl
  port: 21
  read-size: 1024
