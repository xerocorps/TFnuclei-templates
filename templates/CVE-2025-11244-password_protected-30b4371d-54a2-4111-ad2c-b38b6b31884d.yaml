http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - password-protected
  - dsl:
    - compare_versions(version, '<= 2.7.11')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/password-protected/readme.txt'
  redirects: true
id: CVE-2025-11244-password_protected-30b4371d-54a2-4111-ad2c-b38b6b31884d
info:
  author: topscoder
  classification:
    cve-id: CVE-2025-11244
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 3.7
  description: 'The Password Protected plugin for WordPress is vulnerable to authorization
    bypass via IP address spoofing in all versions up to, and including, 2.7.11. This
    is due to the plugin trusting client-controlled HTTP headers (such as X-Forwarded-For,
    HTTP_CLIENT_IP, and similar headers) to determine user IP addresses in the `pp_get_ip_address()`
    function when the "Use transients" feature is enabled. This makes it possible
    for attackers to bypass authorization by spoofing these headers with the IP address
    of a legitimately authenticated user, granted the "Use transients" option is enabled
    (non-default configuration) and the site is not behind a CDN or reverse proxy
    that overwrites these headers.

    '
  metadata:
    fofa-query: wp-content/plugins/password-protected/
    google-query: inurl:"/wp-content/plugins/password-protected/"
    shodan-query: http.html:"wp-content/plugins/password-protected/"
  name: 'Password Protected <= 2.7.11 - Unauthenticated Authorization Bypass via IP
    Address Spoofing

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/30b4371d-54a2-4111-ad2c-b38b6b31884d?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,password-protected,low,production
