id: auth-js
info:
  author: geeknik
  name: auth.js
  severity: high
requests:
- matchers:
  - status:
    - 200
    type: status
  - condition: and
    type: word
    words:
    - state_token =
    - client_secret
  - condition: or
    part: header
    type: word
    words:
    - text/plain
    - text/javascript
    - application/javascript
    - application/x-javascript
  - negative: true
    part: header
    type: word
    words:
    - text/html
  - condition: or
    negative: true
    part: body
    type: word
    words:
    - <html
    - window.location = x
    - can not find auth.js
    - function _popwnd_open
    - window.dataLayer
    - console.log(
    - window.location
    - Unknown Host
    - <h1
    - 'Error 404: Error not found'
    - SERVICE_NOT_EXIST
    - <p>
    - Static content proxy
    - ABORTED
    - // Cedexis Inc.
    - This is a placeholder.
    - Counting any requests
    - ': 409,'
    - No action executes!
  - dsl:
    - len(body) > 50 && len(body) < 8192
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/auth.js'
  - '{{BaseURL}}/api/auth.js'
  - '{{BaseURL}}/config/auth.js'
  - '{{BaseURL}}/web/auth.js'
  - '{{BaseURL}}/src/auth.js'
  - '{{BaseURL}}/src/api/auth.js'
  - '{{BaseURL}}/web/api/auth.js'
