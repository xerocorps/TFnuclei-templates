id: swagger-version
info:
  author: c-sh0
  description: Obtain Swagger Version
  name: Swagger 2.x Version Detection
  reference:
  - Swagger UI 2.x and under
  - https://github.com/swagger-api/swagger-ui/blob/master/docs/usage/version-detection.md
  severity: info
  tags: tech,swagger,api
requests:
- extractors:
  - group: 1
    part: body
    regex:
    - '@version (v[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3})'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/swagger-ui/swagger-ui.js'
  - '{{BaseURL}}/swagger/swagger-ui.js'
  - '{{BaseURL}}/swagger-ui.js'
  - '{{BaseURL}}/swagger/ui/swagger-ui.js'
