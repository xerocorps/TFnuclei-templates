http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - advanced-forms
  - dsl:
    - compare_versions(version, '< 1.6.9')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/advanced-forms/readme.txt'
  redirects: true
id: CVE-2021-24892
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24892
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: Insecure Direct Object Reference in edit function of Advanced Forms
    (Free & Pro) before 1.6.9 allows authenticated remote attacker to change arbitrary
    user's email address and request for reset password, which could lead to take
    over of WordPress's administrator account. To exploit this vulnerability, an attacker
    must register to obtain a valid WordPress's user and use such user to authenticate
    with WordPress in order to exploit the vulnerable edit function.
  metadata:
    fofa-query: wp-content/plugins/advanced-forms/
    google-query: inurl:"/wp-content/plugins/advanced-forms/"
    shodan-query: vuln:CVE-2021-24892
  name: Advanced Forms for ACF <= 1.6.8 - Insecure Direct Object Reference
  reference:
  - https://wpscan.com/vulnerability/364b0843-a990-4204-848a-60c928cc5bc0
  - https://github.com/advancedforms/advanced-forms/commit/2ce3ab6985c3a909eefb01c562995bc6a994d3a2
  severity: high
  tags: cve,wordpress,wp-plugin,advanced-forms,high
