http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"terminal":'
    - '"user_id":"'
    - '"account_id":'
  - part: header
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/api/v1/terminal/sessions/'
id: CVE-2023-42442
info:
  author: xianke
  classification:
    cpe: cpe:2.3:a:fit2cloud:jumpserver:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-42442
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-287
    epss-percentile: 0.99455
    epss-score: 0.88067
  description: 'JumpServer is an open source bastion host and a professional operation
    and maintenance security audit system. Starting in version 3.0.0 and prior to
    versions 3.5.5 and 3.6.4, session replays can download without authentication.
    Session replays stored in S3, OSS, or other cloud storage are not affected. The
    api `/api/v1/terminal/sessions/` permission control is broken and can be accessed
    anonymously. SessionViewSet permission classes set to `[RBACPermission | IsSessionAssignee]`,
    relation is or, so any permission matched will be allowed. Versions 3.5.5 and
    3.6.4 have a fix. After upgrading, visit the api `$HOST/api/v1/terminal/sessions/?limit=1`.
    The expected http response code is 401 (`not_authenticated`).

    '
  impact: 'The vulnerability allows an attacker to gain sensitive information from
    the JumpServer application.

    '
  metadata:
    fofa-query:
    - title="JumpServer"
    - title="jumpserver"
    max-request: 1
    product: jumpserver
    vendor: fit2cloud
    verified: true
  name: JumpServer > 3.6.4 - Information Disclosure
  reference:
  - https://github.com/jumpserver/jumpserver/blob/v3.6.1/apps/terminal/api/session/session.py#L91
  - https://nvd.nist.gov/vuln/detail/CVE-2023-42442
  - https://github.com/jumpserver/jumpserver/commit/0a58bba59cd275bab8e0ae58bf4b359fbc5eb74a
  - https://github.com/Marco-zcl/POC
  - https://github.com/nomi-sec/PoC-in-GitHub
  remediation: 'Apply the latest security patches and updates from the vendor to address
    this vulnerability.

    '
  severity: medium
  tags: cve2023,cve,jumpserver,exposure,fit2cloud,vuln
