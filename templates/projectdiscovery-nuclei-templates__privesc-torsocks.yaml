code:
- engine:
  - sh
  - bash
  source: 'whoami

    '
- engine:
  - sh
  - bash
  source: 'torsocks whoami

    '
- engine:
  - sh
  - bash
  matchers:
  - negative: true
    part: code_1_response
    type: word
    words:
    - root
  - condition: or
    dsl:
    - contains(code_2_response, "root")
    - contains(code_3_response, "root")
    type: dsl
  matchers-condition: and
  source: 'sudo torsocks whoami

    '
id: privesc-torsocks
info:
  author: daffainfo
  description: 'torsocks is a wrapper that enables the use of the Tor network for
    any program, including those that do not natively support proxy settings. It intercepts
    and redirects network calls from the target program through the Tor network, providing
    a way to anonymize the network traffic of various applications.

    '
  metadata:
    max-request: 3
    verified: true
  name: Torsocks - Privilege Escalation
  reference:
  - https://gtfobins.github.io/gtfobins/torsocks/
  severity: high
  tags: code,linux,torsocks,privesc,local
self-contained: true
