http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - oauth-client-for-user-authentication
  - dsl:
    - compare_versions(version, '<= 3.0.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/oauth-client-for-user-authentication/readme.txt'
  redirects: true
id: CVE-2022-3119
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-3119
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 7.3
  description: The OAuth client Single Sign On for WordPress ( OAuth 2.0 SSO ) plugin
    for WordPress is vulnerable to authorization bypass due to a missing capability
    check on the save_oauthclient_config() function that is hooked via 'init' in versions
    up to, and including, 3.0.3. This makes it possible for unauthenticated attackers
    to modify the plugin's oAuth settings which could lead to unauthorized and high
    privileged access to a vulnerable site.
  metadata:
    fofa-query: wp-content/plugins/oauth-client-for-user-authentication/
    google-query: inurl:"/wp-content/plugins/oauth-client-for-user-authentication/"
    shodan-query: vuln:CVE-2022-3119
  name: OAuth client Single Sign On for WordPress ( OAuth 2.0 SSO ) <= 3.0.3 - Missing
    Authorization
  reference:
  - https://plugins.trac.wordpress.org/browser/oauth-client-for-user-authentication/trunk/oauthclient_controller.php?rev=2735075#L117
  - https://plugins.trac.wordpress.org/changeset/2773153/oauth-client-for-user-authentication/trunk/oauthclient_controller.php
  - https://wpscan.com/vulnerability/55b83cee-a8a5-4f9d-a976-a3eed9a558e5
  severity: high
  tags: cve,wordpress,wp-plugin,oauth-client-for-user-authentication,high
