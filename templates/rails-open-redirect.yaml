id: rails-open-redirect
info:
  author: melbadry9 & xelkomy
  description: A user-controlled input redirect users to an external website.
  name: Rails Open Redirect
  reference: https://hackerone.com/reports/904059
  severity: low
requests:
- matchers:
  - part: header
    regex:
    - (?m)^(?:Location\s*?:\s*?)(?:https?://|//)?(?:[a-zA-Z0-9\-_]*\.)?evil\.com(?:\s*?)$
    type: regex
  method: POST
  path:
  - '{{BaseURL}}/rails/actions?error=ActiveRecord::PendingMigrationError&action=Run%20pending%20migrations&location=//evil.com'
