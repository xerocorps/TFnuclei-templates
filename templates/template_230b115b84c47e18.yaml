info:
  author: OpenAI
  classification:
    country: any
    tags:
    - docker
    - security
    - credentials
    - exposure
  description: Template to detect Docker installations exposing credentials
  id: docker-credentials-exposure
  matcher-condition: or
  matchers:
  - description: Response header indicating successful connection to the Docker socket
    pattern: HTTP/1.0 200 OK
    type: header
  name: Docker Credentials Exposure - Detect
  reference:
  - https://docs.docker.com/engine/security/security/#docker-daemon-attack-surface
  requests:
    condition: and
    description: Attempt to connect to the Docker socket
    method: GET
    path:
    - /var/run/docker.sock
  response:
  - status:
    - 200
  severity: High
