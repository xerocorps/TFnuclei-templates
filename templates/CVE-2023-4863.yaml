id: CVE-2023-4863
info:
  author: dwisiswant0
  description: 'Heap buffer overflow in libwebp in Google Chrome prior to 116.0.5845.187

    and libwebp 1.3.2 allowed a remote attacker to perform an out of bounds

    memory write via a crafted HTML page.

    '
  name: CVE-2023-4863
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2023-4863
  - https://github.com/mistymntncop/CVE-2023-4863
  - https://github.com/bbaranoff/CVE-2023-4863
  - https://github.com/talbeerysec/BAD-WEBP-CVE-2023-4863
  - https://github.com/OITApps/Find-VulnerableElectronVersion
  - https://github.com/GTGalaxi/ElectronVulnerableVersion
  - https://github.com/murphysecurity/libwebp-checker
  severity: high
javascript:
- args:
    file: '{{file}}'
  code: "const fs = require('nuclei/fs');\nconst isElectron = /Electron v.*/g,\n \
    \ vulnPattern = /(VP8LBuildHuffmanTable|WebPCopyP(ixels|lane))/g,\n  vulnVersions\
    \ = [22, 24, 25, 26],\n  safeString = 'VP8LHuffmanTablesAllocate';\nlet vuln =\
    \ false;\ntry {\n  const f = fs.ReadFileAsString(file);\n  vuln = f.match(vulnPattern)\
    \ && !f.includes(safeString);\n  if (!vuln) {\n    let electron = f.match(isElectron);\n\
    \    if (electron[0] !== null) {\n      for (const vulnVersion of vulnVersions)\
    \ {\n        vuln = electron[0].includes(vulnVersion.toString());\n        if\
    \ (vuln) break;\n      }\n    }\n  }\n} catch (e) { vuln; }\nvuln;\n"
  extractors:
  - dsl:
    - file
    type: dsl
  matchers:
  - dsl:
    - success && response
    type: dsl
self-contained: true
