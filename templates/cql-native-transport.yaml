id: cql-native-transport
info:
  author: pussycat0x
  description: 'Native transport requests (NTR) are any requests made via the CQL
    Native Protocol. CQL Native Protocol is the way the Cassandra driver communicates
    with the server.

    '
  metadata:
    max-request: 1
    shodan-query: cassandra
    verified: true
  name: CQL Native Transport Detect
  severity: info
  tags: network,cassandra,cql,detect
tcp:
- extractors:
  - regex:
    - 'protocol version: ([0-9]+)'
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: /n
  - data: /n
  - data: /n
  - data: /n
  - data: /n
  - data: /n
  - data: /n
  - data: /n
  matchers:
  - type: word
    words:
    - valid or unsupported protocol
  port: 9042
