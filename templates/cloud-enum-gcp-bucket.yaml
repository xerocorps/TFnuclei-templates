id: cloud-enum-gcp-bucket
info:
  author: initstring
  description: Searches for open and protected buckets in GCP
  name: Cloud Enumeration - GCP Buckets
  reference: tba
  severity: medium
  tags: cloud,gcp
requests:
- attack: batteringram
  matchers:
  - name: Open GCP Bucket
    status:
    - 200
    type: status
  - name: Protected GCP Bucket
    status:
    - 403
    type: status
  raw:
  - 'GET http://{{keyword}}.{{baseDNS}} HTTP/1.1

    Host: {{keyword}}.{{baseDNS}}

    '
  redirects: false
  threads: 10
self-contained: true
variables:
  baseDNS: storage.googleapis.com
