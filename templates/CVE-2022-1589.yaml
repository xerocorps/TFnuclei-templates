http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - change-wp-admin-login
  - dsl:
    - compare_versions(version, '<= 1.0.9')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/change-wp-admin-login/readme.txt'
  redirects: true
id: CVE-2022-1589
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-1589
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:H/A:N
    cvss-score: 5.4
  description: The Change wp-admin login WordPress plugin before 1.1.0 does not properly
    check for authorisation and is also missing CSRF check when updating its settings,
    which could allow unauthenticated users to change the settings. The attacked could
    also be performed via a CSRF vector
  metadata:
    fofa-query: wp-content/plugins/change-wp-admin-login/
    google-query: inurl:"/wp-content/plugins/change-wp-admin-login/"
    shodan-query: vuln:CVE-2022-1589
  name: Change wp-admin login <= 1.0.9 - Missing Authorization Checks
  reference:
  - https://wpscan.com/vulnerability/257f9e14-4f43-4852-8384-80c15d087633
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2719146%40change-wp-admin-login%2Ftrunk&old=2718810%40change-wp-admin-login%2Ftrunk&sfp_email=&sfph_mail=
  - https://patchstack.com/database/vulnerability/change-wp-admin-login-/wordpress-change-wp-admin-login-plugin-1-0-9-unauthenticated-arbitrary-settings-update-vulnerability
  severity: medium
  tags: cve,wordpress,wp-plugin,change-wp-admin-login,medium
