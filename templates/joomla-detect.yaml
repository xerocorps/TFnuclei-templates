id: joomla-detect
info:
  author: ricardomaia
  description: 'Joomla, also spelled Joomla! (with an exclamation mark) and sometimes
    abbreviated as J!, is a free and open-source content management system (CMS) for
    publishing web content on websites.

    '
  metadata:
    google-dork: Joomla! Administration Login inurl:"/index.php" || intitle:"Joomla
      Web Installer"
    verified: true
  name: Joomla! Detect
  reference:
  - https://www.joomla.org/
  - https://github.com/joomla/joomla-cms
  - https://www.itoctopus.com/how-to-quickly-know-the-version-of-any-joomla-website
  - https://hackertarget.com/attacking-enumerating-joomla/
  severity: info
  tags: tech,joomla,cms,oss
requests:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?i)<version>(.*)</version>
    - (?i)Joomla_([\d.|\d]+)_version_history
    type: regex
  host-redirects: true
  matchers:
  - condition: or
    regex:
    - (?i)<meta.name="generator".content="(Joomla!).*/>
    - (?i)Joomla_([\d.|\d]+)_version_history
    type: regex
  - condition: and
    part: body
    type: word
    words:
    - <version>
    - <creationDate>
    - </metafile>
  matchers-condition: or
  max-redirects: 2
  method: null
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/language/en-GB/en-GB.xml'
  - '{{BaseURL}}/administrator/manifests/files/joomla.xml'
  - '{{BaseURL}}/README.txt'
  - '{{BaseURL}}/modules/custom.xml'
  stop-at-first-match: true
