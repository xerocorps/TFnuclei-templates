id: aws-cognito-misconfiguration-markers
info:
  author: Coastlincyber
  description: Detects potential AWS Cognito misconfigurations by searching for sensitive
    markers in JavaScript files.
  name: AWS Cognito Misconfiguration Markers
  reference: https://www.yassineaboukir.com/talks/NahamConEU2022.pdf
  severity: high
  tags: aws,cognito,misconfiguration,javascript
requests:
- extractors:
  - part: body
    regex:
    - (us|ap|ca|cn|eu|sa)-[a-z]+-\d:[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}
    type: regex
  matchers:
  - condition: or
    part: body
    type: word
    words:
    - identityPoolId
    - cognitoIdentityPoolId
    - userPoolWebClientId
    - userPoolId
    - aws_user_pools_id
    - aws_cognito_identity_pool_id
  - condition: or
    part: body
    type: word
    words:
    - AWSCognitoIdentityProviderService
    - CognitoIdentityCredentials
    - AWS.CognitoIdentityServiceProvider
    - cognitoUser
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}'
