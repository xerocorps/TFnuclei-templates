http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - buddypress
  - dsl:
    - compare_versions(version, '>= 5.0.0', '<= 7.2.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/buddypress/readme.txt'
  redirects: true
id: CVE-2021-21389-buddypress-c3da10da-8de3-4547-abe4-202002728c80
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-21389
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: 'BuddyPress is an open source WordPress plugin to build a community
    site. In releases of BuddyPress from 5.0.0 before 7.2.1 it''s possible for a non-privileged,
    regular user to obtain administrator rights by exploiting an issue in the REST
    API members endpoint. The vulnerability has been fixed in BuddyPress 7.2.1. Existing
    installations of the plugin should be updated to this version to mitigate the
    issue.

    '
  metadata:
    fofa-query: wp-content/plugins/buddypress/
    google-query: inurl:"/wp-content/plugins/buddypress/"
    shodan-query: http.html:"wp-content/plugins/buddypress/"
  name: 'BuddyPress 5.0.0-7.2.0 - Privilege Escalation via REST API

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/c3da10da-8de3-4547-abe4-202002728c80?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,buddypress,high,production
