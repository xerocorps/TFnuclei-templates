code:
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"Azure Monitor Diagnostic Settings for Subscription Activity Log Export are
      not configured."'
    type: dsl
  matchers:
  - type: word
    words:
    - '[]'
  source: 'az monitor diagnostic-settings subscription list --query ''value[*].id''
    --output json

    '
id: azure-monitor-diagnostic-unrestricted
info:
  author: princechaddha
  description: 'Ensure that Azure Monitor Diagnostic Settings are configured to export
    activity logs for the selected Microsoft Azure subscription. This helps in maintaining
    a record of all operational actions which are crucial for security and operational
    auditing.

    '
  impact: 'Not having diagnostic settings configured to export activity logs can lead
    to a lack of visibility into operational actions within the subscription, increasing
    the risk of undetected malicious activities or misconfigurations.

    '
  name: Azure Monitor Diagnostic Settings for Subscription Activity Log Export Check
  reference:
  - https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/activity-log
  remediation: 'Configure Azure Monitor Diagnostic Settings to export activity logs.
    Refer to the Azure documentation on how to set up diagnostic settings for activity
    log export.

    '
  severity: medium
  tags: cloud,devops,azure,microsoft,monitor,azure-cloud-config
self-contained: true
