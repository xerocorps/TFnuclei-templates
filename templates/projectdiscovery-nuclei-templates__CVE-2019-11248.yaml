http:
- matchers:
  - condition: or
    type: word
    words:
    - 'Types of profiles available:'
    - Profile Descriptions
    - 'goroutine profile: total'
  method: GET
  path:
  - '{{BaseURL}}/debug/pprof/'
  - '{{BaseURL}}/debug/pprof/goroutine?debug=1'
  stop-at-first-match: true
id: CVE-2019-11248
info:
  author: 0xceeb,ritikchaddha
  classification:
    cpe: cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:*
    cve-id: CVE-2019-11248
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:L
    cvss-score: 8.2
    cwe-id: CWE-862,CWE-419
    epss-percentile: 0.99626
    epss-score: 0.91212
  description: 'The debugging endpoint /debug/pprof is exposed over the unauthenticated
    Kubelet healthz port. This debugging endpoint can potentially leak sensitive information
    such as internal Kubelet memory addresses and configuration, or for limited denial
    of service. Versions prior to 1.15.0, 1.14.4, 1.13.8, and 1.12.10 are affected.
    The issue is of medium severity, but not exposed by the default configuration.

    '
  impact: 'An attacker can exploit this vulnerability to gather sensitive information,
    potentially leading to further attacks.

    '
  metadata:
    fofa-query:
    - title="kubernetes web view"
    - app="kubernetes-enterprise-manager"
    google-query: intitle:"kubernetes web view"
    max-request: 2
    product: kubernetes
    shodan-query: http.title:"kubernetes web view"
    vendor: kubernetes
  name: Debug Endpoint pprof - Exposure Detection
  reference:
  - https://medium.com/bugbountywriteup/my-first-bug-bounty-21d3203ffdb0
  - http://mmcloughlin.com/posts/your-pprof-is-showing
  - https://github.com/kubernetes/kubernetes/issues/81023
  - https://groups.google.com/d/msg/kubernetes-security-announce/pKELclHIov8/BEDtRELACQAJ
  - https://nvd.nist.gov/vuln/detail/CVE-2019-11248
  remediation: 'Disable or restrict access to the Debug Endpoint pprof to prevent
    unauthorized access.

    '
  severity: high
  tags: cve2019,cve,debug,kubernetes,kubelet,devops,unauth,disclosure,vkev,vuln
