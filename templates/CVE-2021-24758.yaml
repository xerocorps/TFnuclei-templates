http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - email-log
  - dsl:
    - compare_versions(version, '<= 2.4.6')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/email-log/readme.txt'
  redirects: true
id: CVE-2021-24758
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24758
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
  description: The Email Log WordPress plugin before 2.4.7 does not properly validate,
    sanitise and escape the 'orderby' and 'order' GET parameters before using them
    in SQL statement in the admin dashboard, leading to SQL injections
  metadata:
    fofa-query: wp-content/plugins/email-log/
    google-query: inurl:"/wp-content/plugins/email-log/"
    shodan-query: vuln:CVE-2021-24758
  name: Email Log <= 2.4.6 - Admin+ SQL Injection
  reference:
  - https://wpscan.com/vulnerability/8dd70db4-5845-440d-8b1d-012738abaac2
  severity: high
  tags: cve,wordpress,wp-plugin,email-log,high
