file:
- extensions:
  - java
  matchers:
  - name: DocumentBuilderFactory
    regex:
    - newDocumentBuilder\(
    type: regex
  - condition: and
    name: DocumentBuilderFactory
    negative: true
    regex:
    - .+\.setFeature\(XMLConstants\.FEATURE_SECURE_PROCESSING,\s*true\);
    type: regex
  matchers-condition: and
id: xml-entity-expansion-DocumentBuilder
info:
  author: sklnhunt
  description: XML entity expansion vulnerabilities arise because the XML specification
    allows XML documents to define entities that reference other entities defined
    within the document. If this is done recursively to a significant depth, then
    the XML parser will consume exponentially increasing amounts of memory and processor
    resources as each level of recursion is processed.
  name: XML Entities Expansion Injection(DocumentBuilder)
  reference: https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing
  severity: medium
  tags: java
