http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - redi-restaurant-reservation
  - dsl:
    - compare_versions(version, '<= 21.0307')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/redi-restaurant-reservation/readme.txt'
  redirects: true
id: CVE-2021-24299
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24299
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
  description: The ReDi Restaurant Reservation WordPress plugin before 21.0426 provides
    the functionality to let users make restaurant reservations. These reservations
    are stored and can be listed on an 'Upcoming' page provided by the plugin. An
    unauthenticated user can fill in the form to make a restaurant reservation. The
    form to make a restaurant reservation field called 'Comment' does not use proper
    input validation and can be used to store XSS payloads. The XSS payloads will
    be executed when the plugin user goes to the 'Upcoming' page, which is an external
    website https://upcoming.reservationdiary.eu/ loaded in an iframe, and the stored
    reservation with XSS payload is loaded.
  metadata:
    fofa-query: wp-content/plugins/redi-restaurant-reservation/
    google-query: inurl:"/wp-content/plugins/redi-restaurant-reservation/"
    shodan-query: vuln:CVE-2021-24299
  name: ReDi Restaurant Reservation <= 21.0307 - Stored Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/fd6ce00b-8c5f-4180-b648-f47b37303670
  - http://packetstormsecurity.com/files/162756/WordPress-ReDi-Restaurant-Reservation-21.0307-Cross-Site-Scripting.html
  - https://patchstack.com/database/vulnerability/redi-restaurant-reservation/wordpress-redi-restaurant-reservation-plugin-21-0307-unauthenticated-stored-cross-site-scripting-xss-vulnerability
  severity: high
  tags: cve,wordpress,wp-plugin,redi-restaurant-reservation,high
