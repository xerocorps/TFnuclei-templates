code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .AccountId
    name: account
    type: json
  matchers:
  - internal: true
    type: word
    words:
    - '"UserId":'
  source: 'aliyun sts GetCallerIdentity

    '
- engine:
  - sh
  - bash
  matchers:
  - type: word
    words:
    - jq is installed
  source: 'jq --version >/dev/null 2>&1 && echo "jq is installed." || echo "jq is
    not installed."

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"Aliyun CLI is properly configured for account \"" + account + "\" and all
      the necessary tools required are installed."'
    type: dsl
  matchers:
  - type: word
    words:
    - ossutil is installed
  source: 'ossutil --version >/dev/null 2>&1 && echo "ossutil is installed." || echo
    "ossutil is not installed."

    '
flow: code(1) && code(2) && code (3)
id: alibaba-cloud-code-env
info:
  author: DhiyaneshDK
  description: 'Checks if Aliyun CLI is set up and all necessary tools are installed
    on the environment.

    '
  metadata:
    max-request: 3
    verified: true
  name: Alibaba Cloud Environment Validation
  reference:
  - https://github.com/aliyun/aliyun-cli
  severity: info
  tags: cloud,devops,aliyun,alibaba,alibaba-cloud-config
self-contained: true
variables:
  region: cn-hangzhou
