http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '<= *')
    - compare_versions(version_by_js, '<= *')
    - compare_versions(version_by_css, '<= *')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2017-14990-wordpress-9fda5e15-fdf9-4b67-93d3-2dbfa94aefe9
info:
  author: topscoder
  classification:
    cve-id: CVE-2017-14990
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
  description: 'All known versions of WordPress Core store cleartext wp_signups.activation_key
    values (but stores the analogous wp_users.user_activation_key values as hashes),
    which might make it easier for remote attackers to hijack unactivated user accounts
    by leveraging database read access (such as access gained through an unspecified
    SQL injection vulnerability).

    '
  metadata:
    shodan-query: vuln:CVE-2017-14990
  name: 'WordPress Core - All Known Versions - Cleartext Storage of wp_signups.activation_key

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/9fda5e15-fdf9-4b67-93d3-2dbfa94aefe9?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-core,medium,production
