id: adsb-ultrafeeder-detect
info:
  author: Random-Robbie
  description: "Detected ADS-B (Automatic Dependent Surveillance\u2013Broadcast) ultrafeeders\
    \ operating with the Beast Mode protocol on port 30005. These devices capture\
    \ aircraft transponder signals using software-defined radios (SDRs) and distribute\
    \ the decoded data over the internet.\n"
  metadata:
    fofa-query: port="30005" && body="ADSB"
    max-request: 1
    shodan-query: html:"ADSB"
    verified: true
  name: ADSB Ultrafeeder Beast Mode - Detection
  reference:
  - https://github.com/flightaware/dump1090
  - https://github.com/wiedehopf/readsb
  - https://mode-s.org/decode/content/ads-b/1-basics.html
  severity: info
  tags: network,tcp,flight,adsb,enum
tcp:
- extractors:
  - name: beast_message_types
    regex:
    - 1a(3[1-3])
    type: regex
  - name: feed_quality
    regex:
    - (1a)
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: 0
    type: hex
  matchers:
  - binary:
    - 1a31
    - 1a32
    - 1a33
    condition: or
    type: binary
  port: 30005
  read-size: 2048
