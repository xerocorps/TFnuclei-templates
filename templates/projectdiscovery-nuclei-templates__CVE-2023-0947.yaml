http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "<title>Index of /fp-content</title>")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/fp-content/'
  - '{{BaseURL}}/flatpress/fp-content/'
  stop-at-first-match: true
id: CVE-2023-0947
info:
  author: r3Y3r53
  classification:
    cpe: cpe:2.3:a:flatpress:flatpress:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-0947
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-22
    epss-percentile: 0.99028
    epss-score: 0.79336
  description: 'Path Traversal in GitHub repository flatpressblog/flatpress prior
    to 1.3.

    '
  impact: 'Unauthenticated attackers can exploit path traversal to access and list
    sensitive directories and files in the FlatPress blogging system, potentially
    exposing configuration files and user data.

    '
  metadata:
    fofa-query:
    - body="flatpress"
    - icon_hash=-1189292869
    max-request: 2
    product: flatpress
    shodan-query:
    - http.favicon.hash:-1189292869
    - http.html:"flatpress"
    vendor: flatpress
    verified: true
  name: Flatpress < 1.3 - Path Traversal
  reference:
  - https://huntr.dev/bounties/7379d702-72ff-4a5d-bc68-007290015496/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-0947
  - https://github.com/flatpressblog/flatpress/commit/9c4e5d6567e446c472f3adae3b2fe612f66871c7
  remediation: 'Update FlatPress to version 1.3 or later that properly validates directory
    paths and prevents unauthorized directory listing in fp-content.

    '
  severity: critical
  tags: cve,cve2023,huntr,lfi,flatpress,listing,vuln
