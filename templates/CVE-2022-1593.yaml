http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - site-is-offline-plugin
  - dsl:
    - compare_versions(version, '<= 1.6.6')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/site-is-offline-plugin/readme.txt'
  redirects: true
id: CVE-2022-1593
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-1593
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    cvss-score: 9.6
  description: The Site Offline or Coming Soon WordPress plugin through 1.6.6 does
    not have CSRF check in place when updating its settings, and it also lacking sanitisation
    as well as escaping in some of them. As a result, attackers could make a logged
    in admin change them and put Cross-Site Scripting payloads in them via a CSRF
    attack
  metadata:
    fofa-query: wp-content/plugins/site-is-offline-plugin/
    google-query: inurl:"/wp-content/plugins/site-is-offline-plugin/"
    shodan-query: vuln:CVE-2022-1593
  name: Site Offline or Coming Soon <= 1.6.6 - Cross-Site Request Forgery to Settings
    Update and Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/67678666-402b-4010-ac56-7067a0f40185
  severity: critical
  tags: cve,wordpress,wp-plugin,site-is-offline-plugin,critical
