id: open-redirect-04
info:
  name: Open Redirect
  risk: Low
params:
- dest: '{{.oob}}'
payloads:
- '{{.dest}}'
requests:
- method: GET
- detections:
  - 'RegexSearch("resHeaders", "(?m)^(L|l)ocation: ((http|https)://)?{{.dest}}")'
  generators:
  - Path("[[.origin]]{{.prefix}}{{.payload}}", "*")
  - Path("{{.prefix}}{{.payload}}", "*")
  - Path("{{.payload}}", "*")
  - Query("{{.prefix}}{{.payload}}")
  - Query("{{.payload}}")
type: fuzz
variables:
- prefix: '/

    //

    ///

    ///;@

    '
