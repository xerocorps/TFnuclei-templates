id: CVE-2021-30047
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:vsftpd_project:vsftpd:3.0.3:*:*:*:*:*:*:*
    cve-id: CVE-2021-30047
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    epss-percentile: 0.96588
    epss-score: 0.3126
  description: 'vsftpd before 3.0.3 allows remote attackers to cause a denial of service
    by sending a crafted FTP command.

    '
  impact: 'Attackers can send crafted FTP commands to crash the vsftpd daemon, causing
    denial of service and interrupting FTP services for legitimate users.

    '
  metadata:
    max-request: 1
    product: vsftpd
    shodan-query:
    - vsftpd
    - product:"vsftpd"
    vendor: vsftpd_project
    verified: true
  name: vsftpd < 3.0.3 - DoS
  reference:
  - https://github.com/kuppamjohari/vsftpd-3.0.3-DoS
  remediation: 'Upgrade to vsftpd version 3.0.3 or later that addresses the denial
    of service vulnerability.

    '
  severity: high
  tags: cve,cve2021,network,ftp,vsftpd,tcp,passive,vuln
tcp:
- extractors:
  - group: 1
    name: version
    regex:
    - vsFTPd ([0-9.]+)
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: 0
    type: hex
  matchers:
  - condition: and
    dsl:
    - contains(raw, 'vsFTPd')
    - compare_versions(version, '< 3.0.3')
    type: dsl
  port: 21
  read-size: 1024
