expression: r1()
id: docker-remote-api-unauth
info:
  author: zan8in
  description: "\u8BE5\u672A\u6388\u6743\u8BBF\u95EE\u6F0F\u6D1E\u662F\u56E0\u4E3A\
    \ Docker remote api \u53EF\u6267\u884Cdocker\u547D\u4EE4\uFF0C\u83B7\u53D6\u4FE1\
    \u606F\n\u4ECE\u5B98\u65B9\u6587\u6863\u53EF\u4EE5\u770B\u51FA\uFF0C\u8BE5\u63A5\
    \u53E3\u662F\u76EE\u7684\u662F\u53D6\u4EE3docker \u547D\u4EE4\u754C\u9762\uFF0C\
    \u901A\u8FC7url\u64CD\u4F5Cdocker\u3002\n\u800CDocker swarm\u662Fdocker\u4E0B\u7684\
    \u5206\u5E03\u5316\u5E94\u7528\u7684\u672C\u5730\u96C6\u7FA4\uFF0C\u5728\u5F00\
    \u653E2375\u76D1\u542C\u96C6\u7FA4\u5BB9\u5668\u65F6\uFF0C\u5C31\u4F1A\u8C03\u7528\
    \u8FD9\u4E2Aapi\nprotocol=\"docker\"\n"
  name: Docker remote api Unauth
  reference:
  - http://wiki.peiqi.tech/redteam/vulnerability/unauthorized/Docker%202375%E7%AB%AF%E5%8F%A3.html
  severity: critical
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'"MinAPIVersion":')
      && response.body.bcontains(b'"Version":') && response.body.bcontains(b'"ApiVersion":')
    request:
      method: GET
      path: /version
  r1:
    expression: response.status == 200 && response.body.bcontains(b'<title>GPON Home
      Gateway</title>')
    request:
      method: GET
      path: /containers/json
