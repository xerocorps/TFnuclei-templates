code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .items[]
    name: items
    type: json
  source: kubectl get pods --all-namespaces --output=json
flow: "code(1);\nfor (let pod of template.items) {\n  set(\"pod\", pod)\n  javascript(1);\n\
  }\n"
id: k8s-host-network-namespace-shared
info:
  author: princechaddha
  description: Checks if containers in Kubernetes Pods are configured to share the
    host's network namespace, which can lead to security risks.
  impact: 'Sharing the host''s network namespace allows containers to access the host
    network directly. This can lead to potential security breaches as containers might
    bypass network policies and gain unrestricted network access on the host.

    '
  name: Host Network Namespace Sharing
  reference:
  - https://kubernetes.io/docs/concepts/policy/pod-security-policy/#host-namespaces
  remediation: 'Ensure that the ''hostNetwork'' field is set to false in all Kubernetes
    Pods to prevent containers from sharing the host''s network namespace.

    '
  severity: high
  tags: cloud,devops,kubernetes,k8s,devsecops,namespace,k8s-cluster-security
javascript:
- code: "pod = JSON.parse(template.pod);\nif (pod.spec.hostNetwork) {\n  let result\
    \ = (`Pod '${pod.metadata.name}' in namespace '${pod.metadata.namespace}' is configured\
    \ to share the host's network namespace.`);\n  Export(result);\n}\n"
  extractors:
  - dsl:
    - response
    type: dsl
self-contained: true
