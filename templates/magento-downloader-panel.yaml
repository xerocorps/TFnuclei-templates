id: magento-downloader-panel
info:
  author: 5up3r541y4n
  description: 'Magento Connect Manager available via /downloader/ location is used
    for installation of Magento extensions and Magento upgrades and requires Magento
    admin rights for the action. It uses the same authorization methods as for Backend.
    Therefore if bot will find out a matching pair of login/password, whole Magento
    installation will be compromised. Attacker will be able to discover backend URL
    for login (even if it is customized as described in Securing Magento /admin/),
    install a Filesystem extension to obtain full access to all files and finally
    database.

    '
  metadata:
    shodan-query: http.component:"Magento"
    verified: true
  name: Magento Downloader Exposed
  reference:
  - https://magentary.com/kb/restrict-access-to-magento-downloader/
  - https://www.mageplaza.com/kb/how-to-stop-brute-force-attacks-magento.html#solution-3
  severity: info
  tags: magento,exposure
requests:
- extractors:
  - group: 1
    part: body
    regex:
    - \(Magento Connect Manager ver\. ([0-9.]+)
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - Magento Downloader
    - Log In
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/downloader/'
