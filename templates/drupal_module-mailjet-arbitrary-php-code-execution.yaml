http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '<= 4.0.1')
    type: dsl
  matchers:
  - condition: and
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - condition: and
    status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - mailjet
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/mailjet/mailjet.info'
  redirects: true
id: drupal_module-mailjet-arbitrary-php-code-execution
info:
  author: me
  description: This module for Drupal provides complete control of Email settings
    with Drupal and Mailjet. In certain cases the module doesnt securely pass data
    to PHPs unserialize() function, which could result in Remote Code Execution via
    PHP Object Injection. This vulnerability is mitigated by the fact that an attack
    must operate with the permission administer mailjet module, however this could
    be the case if this issue were combined with others in an attack chain.
  metadata:
    created_at: '2025-01-09'
    fofa-query: /sites/all/modules/mailjet/
    google-query: inurl:'/sites/all/modules/mailjet/
    impact: medium
    security-risk: "Moderately critical 14\u2009\u2215\u200925 AC:Complex/A:Admin/CI:All/II:All/E:Theoretical/TD:Uncommon"
    type: indicator
    vulnerability: arbitrary-php-code-execution
  name: drupal_module-mailjet-arbitrary-php-code-execution
  reference:
  - https://www.drupal.org/sa-contrib-2024-062
  severity: medium
  tags: drupal
