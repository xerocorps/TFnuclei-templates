flow: http(1) && http(2)
http:
- matchers:
  - dsl:
    - '!contains_all(body, "Index of /", "PARENTDIR")'
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    type: word
    words:
    - Index of /typo3temp
    - Last modified
    - Parent Directory
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/typo3temp/'
id: typo3-directory-listing
info:
  author: theamanrawat
  description: 'Detects directory listing enabled on the TYPO3 temp directory. The
    typo3temp folder contains cached files, compiled assets, and temporary data that
    may reveal sensitive information about the application structure and configuration.

    '
  metadata:
    shodan-query: http.component:"typo3"
  name: Typo3 Directory Listing
  reference:
  - https://docs.typo3.org/m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/FileStructure/Index.html
  severity: low
  tags: typo3,directory-listing,exposure
