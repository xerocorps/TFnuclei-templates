http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '<= 3.5.1')
    - compare_versions(version_by_js, '<= 3.5.1')
    - compare_versions(version_by_css, '<= 3.5.1')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2012-2399
info:
  author: topscoder
  classification:
    cve-id: CVE-2012-2399
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
  description: Cross-site scripting (XSS) vulnerability in swfupload.swf in SWFupload
    2.2.0.1 and earlier, as used in WordPress before 3.5.2, TinyMCE Image Manager
    1.1 and earlier, and other products allows remote attackers to inject arbitrary
    web script or HTML via the buttonText parameter, a different vulnerability than
    CVE-2012-3414.
  metadata:
    shodan-query: vuln:CVE-2012-2399
  name: WordPress Core <= 3.5.1 - Cross-Site Scripting
  reference:
  - http://core.trac.wordpress.org/browser/branches/3.3/wp-includes/js/swfupload/swfupload.swf?rev=20503
  - https://exchange.xforce.ibmcloud.com/vulnerabilities/75210
  - http://osvdb.org/81459
  - http://secunia.com/advisories/49138
  - http://packetstormsecurity.com/files/122399/tinymce11-xss.txt
  - http://www.osvdb.org/91134
  - http://www.debian.org/security/2012/dsa-2470
  - http://packetstormsecurity.com/files/120746/SWFUpload-Content-Spoofing-Cross-Site-Scripting.html
  - http://www.openwall.com/lists/oss-security/2013/07/18/13
  - http://make.wordpress.org/core/2013/06/21/secure-swfupload/
  - http://www.securityfocus.com/bid/53192
  - http://wordpress.org/news/2012/04/wordpress-3-3-2/
  - http://jvndb.jvn.jp/jvndb/JVNDB-2012-002110
  - http://jvn.jp/en/jp/JVN25280162/index.html
  - http://seclists.org/fulldisclosure/2013/Mar/110
  - https://www.rapid7.com/db/vulnerabilities/wordpress-cve-2012-2399/
  severity: high
  tags: cve,wordpress,wp-core,high
