id: samba-detect
info:
  author: pussycat0x
  classification:
    cwe-id: CWE-200
  description: Samba is a free and open-source software that allows files to be shared
    across Windows and Linux systems simply and easily.
  metadata:
    max-request: 1
  name: Samba Service Detection
  reference:
  - https://www.samba.org/samba/what_is_samba.html
  - https://www.samba.org/samba/history/security.html
  remediation: Always apply the latest security patch.
  severity: info
  tags: network,smb,samba,detect
tcp:
- host:
  - '{{Hostname}}'
  inputs:
  - data: 000000a4ff534d4272000000000801400000000000000000000000000000400600000100008100025043204e4554574f524b2050524f4752414d20312e3000024d4943524f534f4654204e4554574f524b5320312e303300024d4943524f534f4654204e4554574f524b5320332e3000024c414e4d414e312e3000024c4d312e3258303032000253616d626100024e54204c414e4d414e20312e3000024e54204c4d20302e313200
    type: hex
  matchers:
  - type: word
    words:
    - SMBr
  - negative: true
    type: word
    words:
    - HTTP/1.1
  matchers-condition: and
  port: 139
