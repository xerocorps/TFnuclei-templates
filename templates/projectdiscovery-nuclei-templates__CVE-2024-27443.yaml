http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - CLIENT_VERSION\",\s+{type:ZmSetting\.T_CONFIG, defaultValue:"([0-9.]+)_([A-Z_0-9]+)"\}
    type: regex
  matchers:
  - part: body
    type: word
    words:
    - Zimbra Collaboration
  - part: content_type
    type: word
    words:
    - application/x-javascript
  - condition: or
    dsl:
    - compare_versions(version, '9.0.0')
    - compare_versions(version, '>= 10.0.0', '< 10.0.7')
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/js/zimbraMail/share/model/ZmSettings.js'
id: CVE-2024-27443
info:
  author: rxerium
  classification:
    cpe: cpe:2.3:a:zimbra:collaboration:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-27443
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.96159
    epss-score: 0.26676
  description: 'An issue was discovered in Zimbra Collaboration (ZCS) 9.0 and 10.0.
    A Cross-Site Scripting (XSS) vulnerability exists in the CalendarInvite feature
    of the Zimbra webmail classic user interface, because of improper input validation
    in the handling of the calendar header. An attacker can exploit this via an email
    message containing a crafted calendar header with an embedded XSS payload.

    '
  impact: 'Unauthenticated attackers can execute arbitrary JavaScript via crafted
    calendar headers in emails, potentially stealing user credentials or session data.

    '
  metadata:
    fofa-query:
    - icon_hash="1624375939"
    - "app=\"zimbra-\u90AE\u4EF6\u7CFB\u7EDF\""
    - body="zimbra collaboration suite web client"
    - icon_hash="475145467"
    max-request: 1
    product: collaboration
    shodan-query:
    - http.favicon.hash:"1624375939"
    - http.html:"zimbra collaboration suite web client"
    - http.favicon.hash:"475145467"
    vendor: zimbra
    verified: true
  name: Zimbra Collaboration - Cross-Site Scripting (XSS)
  reference:
  - https://wiki.zimbra.com/wiki/Zimbra_Releases/10.0.7#Security_Fixes
  - https://wiki.zimbra.com/wiki/Zimbra_Releases/9.0.0/P39#Security_Fixes
  - https://nvd.nist.gov/vuln/detail/CVE-2024-27443
  remediation: 'Update Zimbra Collaboration to version 9.0.0 P39 or 10.0.7 or later.

    '
  severity: medium
  tags: cve,cve2022,zimbra,kev,passive,xss,vkev
