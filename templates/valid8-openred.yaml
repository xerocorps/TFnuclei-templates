id: valid8-openred
info:
  author: Rutger Harmers
  name: Open Redirect Detection
  severity: medium
requests:
- fuzzing:
  - fuzz:
    - https://{{redirect}}
    keys:
    - AuthState
    - URL
    - _url
    - callback
    - checkout
    - checkout_url
    - content
    - continue
    - continueTo
    - counturl
    - data
    - dest
    - dest_url
    - destination
    - dir
    - document
    - domain
    - done
    - download
    - feed
    - file
    - file_name
    - file_url
    - folder
    - folder_url
    - forward
    - from_url
    - go
    - goto
    - host
    - html
    - http
    - https
    - image
    - image_src
    - image_url
    - imageurl
    - img
    - img_url
    - include
    - langTo
    - load_file
    - load_url
    - login_to
    - login_url
    - logout
    - media
    - navigation
    - next
    - next_page
    - open
    - out
    - page
    - page_url
    - pageurl
    - path
    - picture
    - port
    - proxy
    - r
    - r2
    - redir
    - redirect
    - redirectUri
    - redirectUrl
    - redirect_to
    - redirect_uri
    - redirect_url
    - reference
    - referrer
    - req
    - request
    - ret
    - retUrl
    - return
    - returnTo
    - return_path
    - return_to
    - return_url
    - rt
    - rurl
    - show
    - site
    - source
    - src
    - target
    - to
    - u
    - uri
    - url
    - val
    - validate
    - view
    - window
    mode: single
    part: query
  - fuzz:
    - https://{{redirect}}
    mode: single
    part: query
    values:
    - https?://
  matchers:
  - part: header
    regex:
    - (?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)?(?:[a-zA-Z0-9\-_\.@]*)evil\.com\/?(\/|[^.].*)?$
    type: regex
  - status:
    - 301
    - 302
    - 307
    type: status
  matchers-condition: and
  method: GET
  path:
  - http://testphp.vulnweb.com/redir.php?r=https://www.hackerone.com
  payloads:
    redirect:
    - evil.com
  stop-at-first-match: true
