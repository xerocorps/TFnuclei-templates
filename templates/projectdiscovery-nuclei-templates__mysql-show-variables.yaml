id: mysql-show-variables
info:
  author: DhiyaneshDk
  description: Attempts to show all variables on a MySQL server.
  metadata:
    max-request: 16
    shodan-query: port:3306
  name: MySQL - Show Variables
  reference:
  - https://nmap.org/nsedoc/scripts/mysql-variables.html
  severity: high
  tags: js,mysql,network,enum,discovery
javascript:
- args:
    Host: '{{Host}}'
    Pass: '{{passwords}}'
    Port: '3306'
    Query: show variables;
    User: '{{usernames}}'
  attack: clusterbomb
  code: 'let m = require(''nuclei/mysql'');

    let c = m.MySQLClient();

    let response = c.ExecuteQuery(Host,Port,User,Pass,Query);

    Export(response);

    '
  extractors:
  - json:
    - .Rows[].Variable_name
    part: response
    type: json
  matchers:
  - dsl:
    - success == true
    type: dsl
  payloads:
    passwords:
    - root
    - admin
    - mysql
    - test
    usernames:
    - root
    - admin
    - mysql
    - test
  pre-condition: 'isPortOpen(Host,Port);

    '
  stop-at-first-match: true
