id: cloud-enum-gcp-app-engine
info:
  author: initstring
  description: Searches for App Engine Apps in GCP
  name: Cloud Enumeration - GCP App Engine (Appspot)
  reference: tba
  severity: medium
  tags: cloud,gcp
requests:
- attack: batteringram
  matchers:
  - name: Open GCP App Engine App
    status:
    - 200
    type: status
  - condition: and
    dsl:
    - status_code==302
    - contains(location, "login")
    name: Protected GCP App Engine App
    type: dsl
  raw:
  - 'GET https://{{keyword}}.{{baseDNS}} HTTP/1.1

    Host: {{keyword}}.{{baseDNS}}

    '
  redirects: false
  threads: 10
self-contained: true
variables:
  baseDNS: appspot.com
  loginRedirect: accounts.google.com
