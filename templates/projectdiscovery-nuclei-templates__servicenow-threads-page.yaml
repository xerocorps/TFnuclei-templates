http:
- extractors:
  - group: 1
    name: cluster_node
    regex:
    - Connected to cluster node:\s*([^\s<]+)
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(tolower(body), "servlet thread information", "java.base")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/threads.do'
id: servicenow-threads-page
info:
  author: cham423
  description: 'Detects exposed ServiceNow thread information pages (threads.do) that
    reveal cluster and system details.

    '
  metadata:
    max-request: 1
    shodan-query: http.component:"ServiceNow"
    verified: true
  name: ServiceNow Threads Page - Detection
  reference:
  - https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB0517269
  - https://www.servicenow.com/community/servicenow-ai-platform-forum/is-there-a-way-to-restrict-access-to-the-stats-do-page/m-p/1026919
  severity: info
  tags: servicenow,exposure,misconfig
