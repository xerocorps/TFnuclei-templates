http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, "dashboards:read", "name\":\"Dashboard list")
    name: dashboards-exposed
    type: dsl
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/json")
    - contains_all(body, "\"uid\"", "\"title\"")
    - contains_any(body, "\"type\":\"dash-db\"", "\"folderTitle\"")
    name: dashboard-search-exposed
    type: dsl
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/json")
    - contains_all(body, "\"dashboard\"", "\"meta\"")
    name: home-dashboard-exposed
    type: dsl
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/json")
    - contains_all(body, "\"id\"", "\"name\"")
    - contains_any(body, "\"address\"", "\"orgId\"")
    name: organization-info-exposed
    type: dsl
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/json")
    - contains_any(body, "\"login\"", "\"email\"")
    - contains_any(body, "\"isAdmin\"", "\"authLabels\"")
    name: users-list-exposed
    type: dsl
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/json")
    - contains_all(body, "\"type\"", "\"url\"")
    - contains_any(body, "\"database\"", "\"access\"")
    name: datasources-exposed
    type: dsl
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/json")
    - contains_any(body, "\"allowOrgCreate\"", "\"authProxyEnabled\"")
    - contains_any(body, "\"buildInfo\"", "\"datasources\"")
    name: frontend-settings-exposed
    type: dsl
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}/api/search?type=dash-db'
  - '{{BaseURL}}/api/dashboards/home'
  - '{{BaseURL}}/dashboard'
  - '{{BaseURL}}/api/org'
  - '{{BaseURL}}/api/users'
  - '{{BaseURL}}/api/datasources'
  - '{{BaseURL}}/api/frontend/settings'
  stop-at-first-match: true
id: grafana-unauth-access
info:
  author: ritikchaddha
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-306
  description: 'Detects Grafana instances configured with anonymous access enabled,
    allowing unauthenticated users to access dashboards, data sources, organization
    info, and potentially sensitive monitoring data without any credentials.

    '
  metadata:
    fofa-query: title="Grafana"
    max-request: 7
    shodan-query: title:"Grafana"
    verified: true
  name: Grafana Unauthenticated Access
  severity: high
  tags: grafana,misconfig,unauth,exposure,dashboard
