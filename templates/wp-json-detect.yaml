id: wp-json-detect
info:
  author: rix4uni
  metadata:
    shodan-query: wordpress
    verified: true
  name: Wordpress Users Disclosure
  reference:
  - https://hackerone.com/reports/1735586
  severity: Critical
  tags: wordpress,tech
requests:
- matchers:
  - part: body
    type: word
    words:
    - '"id":1,"name":'
    - '"id":2,"name":'
    - '"id":3,"name":'
    - '"id":4,"name":'
    - '"id":5,"name":'
    - '"id":6,"name":'
    - '"id":7,"name":'
    - '"id":8,"name":'
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-json/wp/v2/users'
  - '{{BaseURL}}/wp-json/wp/v2/users/1'
  - '{{BaseURL}}/wp-json/wp/v2/users/2'
  - '{{BaseURL}}/wp-json/wp/v2/users/3'
  - '{{BaseURL}}/wp-json/wp/v2/users/4'
  - '{{BaseURL}}/wp-json/wp/v2/users/5'
  - '{{BaseURL}}/wp-json/wp/v2/users/6'
  - '{{BaseURL}}/wp-json/wp/v2/users/7'
  - '{{BaseURL}}/wp-json/wp/v2/users/8'
  stop-at-first-match: true
