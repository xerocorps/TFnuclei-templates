http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - stopbadbots
  - dsl:
    - compare_versions(version, '< 6.67')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/stopbadbots/readme.txt'
  redirects: true
id: CVE-2021-24863-stopbadbots-e1634f86-21c0-4b9a-b521-c6b9986f91fc
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24863
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The WP Block and Stop Bad Bots Crawlers and Spiders and Anti Spam
    Protection Plugin StopBadBots WordPress plugin before 6.67 does not sanitise and
    escape the User Agent before using it in a SQL statement to save it, leading to
    a SQL injection

    '
  metadata:
    fofa-query: wp-content/plugins/stopbadbots/
    google-query: inurl:"/wp-content/plugins/stopbadbots/"
    shodan-query: http.html:"wp-content/plugins/stopbadbots/"
  name: 'WP Block and Stop Bad Bots Crawlers and Spiders and Anti Spam Protection
    Plugin StopBadBots < 6.67 - Unauthenticated SQL Injection

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/e1634f86-21c0-4b9a-b521-c6b9986f91fc?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,stopbadbots,critical,production
