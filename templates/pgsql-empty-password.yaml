id: pgsql-empty-password
info:
  author: pussycat0x
  description: 'Postgresql has a flaw that allows the attacker to login with empty
    password.

    '
  metadata:
    shodan-query: product:"PostgreSQL"
    verified: true
  name: Postgresql Empty Password - Detect
  reference:
  - https://www.tenable.com/plugins/nessus/104031
  severity: critical
  tags: js,network,postgresql,authenticated
javascript:
- args:
    Host: '{{Host}}'
    Pass: ''
    Port: 5432
    User: postgres
  code: 'const postgres = require(''nuclei/postgres'');

    const client = new postgres.PGClient;

    const connected = client.Connect(Host, Port, User, Pass);

    connected;

    '
  matchers:
  - condition: and
    dsl:
    - success == true
    - response == true
    type: dsl
