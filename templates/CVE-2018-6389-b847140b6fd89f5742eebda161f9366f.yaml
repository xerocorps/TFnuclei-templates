http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '< 5.0')
    - compare_versions(version_by_js, '< 5.0')
    - compare_versions(version_by_css, '< 5.0')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2018-6389-b847140b6fd89f5742eebda161f9366f
info:
  author: topscoder
  classification:
    cve-id: CVE-2018-6389
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
  description: 'In WordPress before 5.0, unauthenticated attackers can cause a denial
    of service (resource consumption) by using the large list of registered .js files
    (from wp-includes/script-loader.php) to construct a series of requests to load
    every file many times. It looks like most of the slowness was due to forcing PHP
    to repeatedly compress the output scripts, which was addressed in 5.0.

    '
  metadata:
    shodan-query: vuln:CVE-2018-6389
  name: 'WordPress Core < 5.0 - Denial of Service

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/1d5987cd-1304-487c-8d1c-cab0510fbb84?source=api-prod
  severity: high
  tags: cve,wordpress,wp-core,high
