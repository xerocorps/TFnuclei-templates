code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: redisList
    type: json
  source: 'az redis list --query ''[*].id''

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - name + " has non-SSL port enabled, therefore encryption in transit is not enforced."
    type: dsl
  matchers:
  - type: word
    words:
    - 'true'
  matchers-condition: and
  source: 'az redis show --ids "$name" --query ''enableNonSslPort''

    '
flow: "code(1);\nfor (let CacheData of iterate(template.redisList)) {\n  set(\"name\"\
  , CacheData);\n  code(2);\n}\n"
id: azure-redis-nonssl-port-disabled
info:
  author: princechaddha
  description: 'Ensure that the SSL connection to your Azure Redis Cache servers is
    enabled in order to meet cloud security and compliance requirements. Enforcing
    an SSL connection helps prevent unauthorized users from reading sensitive data
    that is intercepted as it travels through the network, between clients/applications
    and cache servers, known as data in transit.

    '
  impact: 'Not enabling SSL connections on Redis Cache servers allows sensitive data
    to be intercepted during transmission, increasing the risk of data breaches and
    non-compliance with regulatory standards.

    '
  name: Azure Redis Cache In-Transit Encryption Not Enabled
  reference:
  - https://docs.microsoft.com/en-us/azure/azure-cache-for-redis/cache-configure#ssl-ports
  remediation: 'Enable SSL on your Azure Redis Cache servers and ensure the non-SSL
    port (6379) is disabled to enforce encryption in transit.

    '
  severity: high
  tags: cloud,devops,azure,microsoft,redis,azure-cloud-config
self-contained: true
