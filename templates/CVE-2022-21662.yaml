http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 5.4', '<= 5.4.9')
    - compare_versions(version_by_js, '>= 5.4', '<= 5.4.9')
    - compare_versions(version_by_css, '>= 5.4', '<= 5.4.9')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2022-21662
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-21662
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H
    cvss-score: 8.0
  description: WordPress is a free and open-source content management system written
    in PHP and paired with a MariaDB database. Low-privileged authenticated users
    (like author) in WordPress core are able to execute JavaScript/perform stored
    XSS attack, which can affect high-privileged users. This has been patched in WordPress
    version 5.8.3. Older affected versions are also fixed via security release, that
    go back till 3.7.37. We strongly recommend that you keep auto-updates enabled.
    There are no known workarounds for this issue.
  metadata:
    shodan-query: vuln:CVE-2022-21662
  name: WordPress Core < 5.8.3 - Authenticated (Author+) Stored Cross Site Scripting
  reference:
  - https://wordpress.org/news/2022/01/wordpress-5-8-3-security-release/
  - https://github.com/WordPress/wordpress-develop/security/advisories/GHSA-699q-3hj9-889w
  - https://www.debian.org/security/2022/dsa-5039
  - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/DM6XPH3JN6V4NF4WBOJTOXZIVE6VKKE3/
  - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/CV4UNEC63UU5GEU47IIR4RMTZAHNEOJG/
  - https://lists.debian.org/debian-lts-announce/2022/01/msg00019.html
  - https://blog.sonarsource.com/wordpress-stored-xss-vulnerability
  - https://wpscan.com/vulnerability/dc6f04c2-7bf2-4a07-92b5-dd197e4d94c8
  severity: high
  tags: cve,wordpress,wp-core,high
