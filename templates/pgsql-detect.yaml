id: pgsql-detect
info:
  author: nybble04,geeknik
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    cwe-id: CWE-200
  description: 'PostgreSQL authentication error messages which could reveal information
    useful in formulating further attacks were detected.

    '
  metadata:
    max-request: 1
    shodan-query: port:5432 product:"PostgreSQL"
    verified: true
  name: PostgreSQL Authentication - Detect
  reference:
  - https://www.postgresql.org/docs/current/errcodes-appendix.html
  - https://www.postgresql.org/docs/current/client-authentication-problems.html
  severity: info
  tags: network,postgresql,db,detect
tcp:
- host:
  - '{{Hostname}}'
  inputs:
  - data: 000000500003000075736572006e75636c6569006461746162617365006e75636c6569006170706c69636174696f6e5f6e616d65007073716c00636c69656e745f656e636f64696e6700555446380000
    type: hex
  - data: 7000000036534352414d2d5348412d32353600000000206e2c2c6e3d2c723d000000000000000000000000000000000000000000000000
    type: hex
  matchers:
  - condition: or
    part: body
    type: word
    words:
    - C0A000
    - C08P01
    - '28000'
    - 28P01
    - SCRAM-SHA-256
    - pg_hba.conf
    - user "nuclei"
    - database "nuclei"
  - negative: true
    type: word
    words:
    - HTTP/1.1
  matchers-condition: and
  port: 5432
  read-size: 2048
