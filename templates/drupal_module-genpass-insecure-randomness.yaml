http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '7.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - genpass
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/genpass/genpass.info'
  redirects: true
id: drupal_module-genpass-insecure-randomness
info:
  author: Bishopfox
  description: The Genpass module makes the password field optional (or hidden) on
    the add new user page (admin & registration). If the password field is not set
    during registration, the system generates a password.  The module doesnt use a
    strong source of randomness, creating weak and predictable passwords. This vulnerability
    is mitigated by the fact that the site must be configured to reveal the password
    to the attacker which is a common configuration.  CVE identifier(s) issued  A
    CVE identifier will be requested, and added upon issuance, in accordance with
    Drupal Security Team processes.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/genpass/
    google-query: inurl:'/sites/all/modules/genpass/
    impact: medium
    security-risk: "Less critical 9\u221525 AC:Complex/A:User/CI:Some/II:None/E:Theoretical/TD:Default"
    type: indicator
    vulnerability: insecure-randomness
  name: drupal_module-genpass-insecure-randomness
  reference:
  - https://www.drupal.org/sa-contrib-2018-042
  severity: medium
  tags: drupal
