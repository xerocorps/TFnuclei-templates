code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: functionApps
    type: json
  source: 'az functionapp list --query ''[*].{name:name, resourceGroup:resourceGroup}''
    --output json

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - name + " does not have Application Insights integration enabled"
    type: dsl
  matchers:
  - negative: true
    type: word
    words:
    - APPINSIGHTS_INSTRUMENTATIONKEY
  - part: body
    type: word
    words:
    - '['
  matchers-condition: and
  source: 'az functionapp config appsettings list --name $name --resource-group $resourceGroup
    --query ''[*].name'' --output json

    '
flow: "code(1);\nfor (let AppData of iterate(template.functionApps)) {\n  AppData\
  \ = JSON.parse(AppData);\n  set(\"name\", AppData.name);\n  set(\"resourceGroup\"\
  , AppData.resourceGroup);\n  code(2);\n}\n"
id: azure-functionapp-appinsights-missing
info:
  author: princechaddha
  description: 'Ensure that the functions managed with Microsoft Azure Function App
    are configured to use Azure Monitor Application Insights. Application Insights
    is a robust APM solution designed to cater to the needs of both developers and
    DevOps experts. By enabling this service, you can effortlessly set up continuous
    monitoring for your serverless application. Application Insights excels at identifying
    performance irregularities and offers a suite of potent analytical tools to assist
    you in troubleshooting problems and gaining deep insights into user interactions
    with your application.

    '
  impact: 'Without integration with Application Insights, Azure Function Apps may
    lack comprehensive monitoring, impacting the visibility and troubleshooting of
    performance issues.

    '
  name: Application Insights Integration for Azure Function Apps
  reference:
  - https://docs.microsoft.com/en-us/azure/azure-monitor/app/app-insights-overview
  remediation: 'Configure your Azure Function Apps to integrate with Application Insights
    to enable detailed monitoring and analytics capabilities.

    '
  severity: high
  tags: cloud,devops,azure,microsoft,application-insights,azure-cloud-config
self-contained: true
