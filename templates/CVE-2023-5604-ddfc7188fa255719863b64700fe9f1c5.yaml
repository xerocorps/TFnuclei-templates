http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - asgaros-forum
  - dsl:
    - compare_versions(version, '< 2.7.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/asgaros-forum/readme.txt'
  redirects: true
id: CVE-2023-5604-ddfc7188fa255719863b64700fe9f1c5
info:
  author: topscoder
  classification:
    cve-id: CVE-2023-5604
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 6.6
  description: 'The Asgaros Forum plugin for WordPress is vulnerable to unauthorized
    control of the plugin''s settings due to an insufficient capability check on the
    forum options update in all versions up to 2.7.1 (exclusive). This makes it possible
    for authenticated attackers, with administrator-level access and above, to modify
    the plugin''s settings so that they can upload malicious PHP files that can be
    used for remote code execution.

    '
  metadata:
    fofa-query: wp-content/plugins/asgaros-forum/
    google-query: inurl:"/wp-content/plugins/asgaros-forum/"
    shodan-query: vuln:CVE-2023-5604
  name: 'Asgaros Forum <= 2.7.0 - Insufficient Authorization to Authenticated (Admin+)
    Arbitrary File Upload

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/63b472fb-c853-4e56-b34c-3cf986c4cf80?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,asgaros-forum,low
