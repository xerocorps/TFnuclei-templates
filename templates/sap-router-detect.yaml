id: sap-router-detect
info:
  author: pussycat0x
  description: 'The SAProuter is a proxy program that controls and secures communication
    between SAP systems and external networks.

    '
  metadata:
    shodan-query: product:"SAProuter"
    verified: true
  name: SAProuter - Detect
  severity: info
  tags: network,tcp,sap,tech,discovery
tcp:
- extractors:
  - regex:
    - SAProuter ([0-9.]+)
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: '00000000'
    type: hex
  matchers:
  - condition: and
    part: raw
    type: word
    words:
    - SAProuter
    - network interface
  port: 3200
  read-size: 1024
