code:
- engine:
  - sh
  - bash
  matchers:
  - part: response
    regex:
    - ^root\s+root\s+(600|644)$
    type: regex
  source: 'stat -c "%U %G %a" /etc/hosts 2>/dev/null || echo "not-found"

    '
id: rw-hosts-file
info:
  author: songyaeji
  description: 'The /etc/hosts file was writable by non-root users, allowing attackers
    to register malicious DNS mappings and redirect legitimate domains (pharming attacks).
    This check verified that /etc/hosts was owned by root and had appropriate permissions.

    '
  metadata:
    verified: true
  name: /etc/hosts File Read/Write Check
  reference:
  - https://isms.kisa.or.kr/main/csap/notice/
  severity: high
  tags: local,linux,hosts,file,audit,kisa
self-contained: true
