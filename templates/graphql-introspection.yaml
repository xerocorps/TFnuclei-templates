http:
- body: '{"query": "query IntrospectionQuery { __schema { queryType { name } mutationType
    { name } subscriptionType { name } types { ...FullType } directives { name description
    locations args { ...InputValue } } } } fragment FullType on __Type { kind name
    description fields(includeDeprecated: true) { name description args { ...InputValue
    } type { ...TypeRef } isDeprecated deprecationReason } inputFields { ...InputValue
    } interfaces { ...TypeRef } enumValues(includeDeprecated: true) { name description
    isDeprecated deprecationReason } possibleTypes { ...TypeRef } } fragment InputValue
    on __InputValue { name description type { ...TypeRef } defaultValue } fragment
    TypeRef on __Type { kind name ofType { kind name ofType { kind name ofType { kind
    name ofType { kind name ofType { kind name ofType { kind name ofType { kind name
    } } } } } } } }"}

    '
  headers:
    Content-Type: application/json
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - __schema
    - queryType
    - mutationType
  method: POST
  path:
  - '{{BaseURL}}/graphql'
  - '{{BaseURL}}/api/graphql'
  - '{{BaseURL}}/v1/graphql'
- body: '{"query": "{ __type(name: \"User\") { fields { name type { name } } } }"}

    '
  headers:
    Content-Type: application/json
  matchers:
  - case-insensitive: true
    part: body
    type: word
    words:
    - password
    - email
    - token
    - secret
  method: POST
  path:
  - '{{BaseURL}}/graphql'
id: graphql-introspection
info:
  author: security-team
  description: Detects GraphQL introspection queries and sensitive data exposure
  name: GraphQL Introspection & Information Disclosure
  severity: medium
  tags: graphql,introspection,info-disclosure
