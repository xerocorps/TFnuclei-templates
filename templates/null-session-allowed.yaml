code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - Null sessions are allowed
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'if ((Get-ItemProperty -Path ''HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters''
    -Name ''NullSessionPipes'').NullSessionPipes.Count -gt 0) { "Null sessions are
    allowed" }

    '
id: null-session-allowed
info:
  author: princechaddha
  description: Checks if null sessions are allowed via any entry in the NullSessionPipes
    registry key, posing a security risk.
  impact: 'Allowing null sessions can lead to unauthorized access to network resources,
    increasing vulnerability to attacks.

    '
  name: Null Session Allowed
  remediation: 'Disable null sessions by ensuring no entries are allowed in the NullSessionPipes
    registry key.

    '
  severity: high
  tags: windows,null-session,code,windows-audit
self-contained: true
