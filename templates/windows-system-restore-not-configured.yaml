code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - SystemRestoreUnavailable
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: '$restorePoints = Get-ComputerRestorePoint -ErrorAction SilentlyContinue;
    if ($null -eq $restorePoints) { Write-Output "SystemRestoreUnavailable" }

    '
id: windows-system-restore-not-configured
info:
  author: princechaddha
  description: Checks if System Restore is not configured, which can prevent recovery
    from system issues.
  impact: 'Without System Restore, recovering from system failures may require more
    drastic measures like reinstallation.

    '
  name: System Restore Not Configured
  remediation: 'Configure System Restore to ensure you can roll back changes if needed.

    '
  severity: medium
  tags: windows,code,windows-audit
self-contained: true
