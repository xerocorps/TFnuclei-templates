http:
- host-redirects: true
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - Change your password
    - New password
    - Confirm new password
  - part: header
    type: word
    words:
    - gitlab_session
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}/users/sign_in'
id: gitlab-uninitialized-password
info:
  author: GitLab Red Team
  description: 'Prior to version 14, GitLab installations required a root password
    to be

    set via the web UI. If the administrator skipped this step, any visitor

    could set a password and control the instance.

    '
  metadata:
    max-request: 1
    shodan-query: http.title:"GitLab"
  name: Uninitialized GitLab instances
  reference:
  - https://gitlab.com/gitlab-org/gitlab/-/issues/211328
  - https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/5331
  - https://docs.gitlab.com/omnibus/installation/#set-up-the-initial-password
  severity: high
  tags: gitlab,misconfig,unauth
