http:
- matchers:
  - part: body
    type: word
    words:
    - app/arguments/admin
  - status:
    - 200
    type: status
  matchers-condition: and
  max-size: 1000
  method: GET
  path:
  - '{{BaseURL}}/files.md5'
  - '{{BaseURL}}/testrail/files.md5'
  stop-at-first-match: true
id: CVE-2021-40875
info:
  author: oscarintherocks
  classification:
    cpe: cpe:2.3:a:gurock:testrail:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-40875
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-425
    epss-percentile: 0.99115
    epss-score: 0.81108
  description: Improper access control in Gurock TestRail versions < 7.2.0.3014 resulted
    in sensitive information exposure. A threat actor can access the /files.md5 file
    on the client side of a Gurock TestRail application, disclosing a full list of
    application files and the corresponding file paths which can then be tested, and
    in some cases result in the disclosure of hardcoded credentials, API keys, or
    other sensitive data.
  impact: 'An attacker could use the exposed files.md5 to gain insight into the application''s
    file structure and potentially identify vulnerabilities or sensitive information.

    '
  metadata:
    fofa-query: body="testrail"
    max-request: 2
    product: testrail
    shodan-query:
    - http.html:"TestRail"
    - http.html:"testrail"
    vendor: gurock
  name: Gurock TestRail Application files.md5 Exposure
  reference:
  - htttps://github.com/SakuraSamuraii/derailed
  - https://johnjhacking.com/blog/cve-2021-40875/
  - https://www.gurock.com/testrail/tour/enterprise-edition
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40875
  - https://github.com/SakuraSamuraii/derailed
  remediation: 'Securely restrict access to the files.md5 file and ensure that it
    is not accessible to unauthorized users.

    '
  severity: high
  tags: cve2021,cve,exposure,gurock,testrail,vkev,vuln
