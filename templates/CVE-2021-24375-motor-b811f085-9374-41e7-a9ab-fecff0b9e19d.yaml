http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Version:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - motor
  - dsl:
    - compare_versions(version, '< 3.1.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/themes/motor/style.css'
  redirects: true
id: CVE-2021-24375-motor-b811f085-9374-41e7-a9ab-fecff0b9e19d
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24375
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'Lack of authentication or validation in motor_load_more, motor_gallery_load_more,
    motor_quick_view and motor_project_quick_view AJAX handlers of the Motor WordPress
    theme before 3.1.0 allows an unauthenticated attacker access to arbitrary files
    in the server file system, and to execute arbitrary php scripts found on the server
    file system. We found no vulnerability for uploading files with this theme, so
    any scripts to be executed must already be on the server file system.

    '
  metadata:
    fofa-query: wp-content/themes/motor/
    google-query: inurl:"/wp-content/themes/motor/"
    shodan-query: http.html:"wp-content/themes/motor/"
  name: "Motor \u2013 Cars, Parts, Service, Equipments and Accessories WooCommerce\
    \ Store < 3.1.0 - Local File Inclusion\n"
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/b811f085-9374-41e7-a9ab-fecff0b9e19d?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-theme,motor,critical,production
