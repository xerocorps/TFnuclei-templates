id: prometheus-disclose
info:
  author: SirBugs
  description: This Template checks disclosing secret information via /prometheus
  name: prometheus Disclosure
  severity: medium
  tags: prometheus, mysql
requests:
- matchers:
  - condition: or
    part: body
    type: word
    words:
    - mysql_connection_acquisition_seconds_bucket
    - '# HELP tomcat_global_request_seconds'
    - logback_events_total
    - jvm_memory_used_bytes
  method: GET
  path:
  - '{{BaseURL}}/prometheus'
  - '{{BaseURL}}/prometheus/prometheus'
