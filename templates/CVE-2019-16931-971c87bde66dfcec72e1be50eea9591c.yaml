http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - visualizer
  - dsl:
    - compare_versions(version, '<= 3.3.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/visualizer/readme.txt'
  redirects: true
id: CVE-2019-16931-971c87bde66dfcec72e1be50eea9591c
info:
  author: topscoder
  classification:
    cve-id: CVE-2019-16931
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
  description: 'A stored XSS vulnerability in the Visualizer plugin 3.3.0 for WordPress
    allows an unauthenticated attacker to execute arbitrary JavaScript when an admin
    or other privileged user edits the chart via the admin dashboard. This occurs
    because classes/Visualizer/Gutenberg/Block.php registers wp-json/visualizer/v1/update-chart
    with no access control, and classes/Visualizer/Render/Page/Data.php lacks output
    sanitization.

    '
  metadata:
    fofa-query: wp-content/plugins/visualizer/
    google-query: inurl:"/wp-content/plugins/visualizer/"
    shodan-query: vuln:CVE-2019-16931
  name: 'Visualizer: Tables and Charts Manager for WordPress <= 3.3.0 - Stored Cross-Site
    Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/eaaf1ac0-1ea6-4bcb-a385-87267525801c?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,visualizer,high
