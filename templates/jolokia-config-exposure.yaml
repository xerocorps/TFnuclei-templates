http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, "host=", "port=", "protocol=", "password=") || contains_all(body,
      "<restrict>", "<remote>", "<host>", "<mbean>")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/jolokia-agent.properties'
  - '{{BaseURL}}/jolokia-access.xml'
  - '{{BaseURL}}/WEB-INF/classes/jolokia-agent.properties'
  - '{{BaseURL}}/WEB-INF/classes/jolokia-access.xml'
  stop-at-first-match: true
id: jolokia-config-exposure
info:
  author: theamanrawat
  description: 'Detected exposed Jolokia configuration files (jolokia-agent.properties
    and jolokia-access.xml). Exposure of these files could have revealed sensitive
    agent configuration, authentication credentials, or access control policies (CORS,
    allowed MBeans).

    '
  metadata:
    max-request: 4
    verified: false
  name: Jolokia Configuration - Exposure
  reference:
  - https://jolokia.org/reference/html/agents.html
  - https://docs.microfocus.com/doc/388/24.3/confjolokia
  severity: medium
  tags: config,exposure,jolokia,jmx,devops
