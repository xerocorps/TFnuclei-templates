code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - '0'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'Get-ItemProperty -Path ''HKLM:\System\CurrentControlSet\Control\Terminal
    Server'' -Name ''fDenyTSConnections''

    '
id: remote-desktop-enabled-non-server
info:
  author: princechaddha
  description: "Checks if Remote Desktop is enabled on workstation editions where\
    \ it\u2019s not required."
  impact: 'Enabling Remote Desktop on non-server OS could lead to unauthorized remote
    access.

    '
  name: Remote Desktop Enabled on Non-Server OS
  remediation: 'Disable Remote Desktop on non-server editions to reduce the risk of
    remote attacks.

    '
  severity: high
  tags: windows,remote-desktop,network,code,windows-audit
self-contained: true
