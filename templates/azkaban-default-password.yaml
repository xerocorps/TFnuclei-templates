expression: r0()
id: azkaban-default-password
info:
  author: pussycat0x
  name: Azkaban Web Client Default Credential
  severity: high
  verified: true
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'"session.id"')
      && response.body.bcontains(b'"success"') && response.raw_header.bcontains(b'application/json')
      && response.raw_header.bcontains(b'azkaban.browser.session.id')
    request:
      body: action=login&username=admin&password=admin
      method: POST
      path: /
