http:
- matchers:
  - negative: true
    part: body
    type: word
    words:
    - Registration is not allowed (Internal)
  - case-insensitive: true
    condition: and
    part: body
    type: word
    words:
    - Enter your Userdata
    - zitadel
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/ui/login/register'
id: CVE-2024-49757
info:
  author: Sujal Tuladhar
  classification:
    cve-id: CVE-2024-49757
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-287
    epss-percentile: 0.92198
    epss-score: 0.0872
  description: 'The open-source identity infrastructure software Zitadel allows administrators
    to disable the user self-registration. Due to a missing security check in versions
    prior to 2.64.0, 2.63.5, 2.62.7, 2.61.4, 2.60.4, 2.59.5, and 2.58.7, disabling
    the "User Registration allowed" option only hid the registration button on the
    login page. Users could bypass this restriction by directly accessing the registration
    URL (/ui/login/loginname) and register a user that way. Versions 2.64.0, 2.63.5,
    2.62.7, 2.61.4, 2.60.4, 2.59.5, and 2.58.7 contain a patch. No known workarounds
    are available.

    '
  impact: 'Unauthenticated users can bypass the disabled user registration restriction
    and register accounts.

    '
  metadata:
    max-request: 1
    shodan-query: title:"Zitadel"
    verified: true
  name: Zitadel - User Registration Bypass
  reference:
  - https://github.com/zitadel/zitadel/releases/tag/v2.62.7
  - https://nvd.nist.gov/vuln/detail/CVE-2024-49757
  remediation: 'Update Zitadel to version 2.64.0, 2.63.5, 2.62.7, 2.61.4, 2.60.4,
    2.59.5, or 2.58.7 or later.

    '
  severity: high
  tags: cve,cve2024,register,zitadel,vuln
