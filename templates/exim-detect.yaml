id: exim-detect
info:
  author: ricardomaia
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    cwe-id: CWE-200
  description: 'Exim can accept messages from remote hosts using SMTP over TCP/IP,
    and as well as from local processes. It handles local deliveries to mailbox files
    or to pipes attached to commands, as well as remote SMTP deliveries to other hosts.

    '
  metadata:
    max-request: 1
    shodan-query: product:"Exim smtpd"
    verified: true
  name: Exim - Detect
  reference:
  - https://www.exim.org/docs.html
  severity: info
  tags: network,detect,smtp,mail,exim
tcp:
- extractors:
  - group: 1
    name: version
    regex:
    - (?i)SMTP.Exim\s?([\w.]+)
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: '

      '
  matchers:
  - type: word
    words:
    - ESMTP Exim
  port: 587
