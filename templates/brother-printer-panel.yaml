http:
- extractors:
  - group: 1
    part: body
    regex:
    - (?i)<title[^>]*>([^<]+)</title>
    type: regex
  matchers:
  - condition: or
    dsl:
    - status_code == 200 && contains(tolower(body), "brother industries")
    - status_code == 200 && contains(tolower(body), "brother printer")
    - status_code == 200 && contains(tolower(body), "brother mfc")
    - status_code == 200 && contains(tolower(body), "brother hl")
    - status_code == 200 && contains(tolower(body), "brother dcp")
    type: dsl
  - dsl:
    - status_code == 200 && contains(tolower(body), "solutions.brother.com")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/general/status.html'
id: brother-printer-panel
info:
  author: pdteam
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    cwe-id: CWE-200
  description: 'Brother printer web interface and management panel was detected. This
    template identifies exposed Brother printer panels that may be accessible without
    authentication.

    '
  metadata:
    fofa-query:
    - app="brother-Printer"
    max-request: 3
    shodan-query:
    - http.title:"Brother" OR http.title:"Printer" AND "Brother Industries"
    verified: true
    zoomeye-query:
    - device="brother-Printer" || app="brother-Printer"
  name: Brother Printer Panel - Detect
  reference:
  - https://www.rapid7.com/blog/post/multiple-brother-devices-multiple-vulnerabilities-fixed
  - https://support.brother.com/g/b/faqend.aspx?c=eu_ot&lang=en&prod=group2&faqid=faq00100846_000
  severity: info
  tags: panel,brother,printer,iot,discovery
