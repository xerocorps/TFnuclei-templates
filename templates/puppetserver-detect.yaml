id: puppetserver-detect
info:
  author: c-sh0
  name: Puppetserver Detection
  reference:
  - https://insinuator.net/2020/09/puppet-assessment-techniques/
  severity: info
  tags: tech,puppet,exposure
requests:
- extractors:
  - kval:
    - x_puppet_version
    type: kval
  matchers:
  - status:
    - 404
    type: status
  - case-insensitive: true
    part: header
    type: word
    words:
    - x-puppet-version
  - part: body
    type: word
    words:
    - '{{randstr}}'
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/puppet-ca/v1/certificate_request/{{randstr}}'
