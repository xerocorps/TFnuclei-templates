http:
- extractors:
  - json:
    - '"OS Release: "+ .system.info._v_.os_release'
    - '"OS Build: "+ .system.info._v_.os_build'
    - '"OS INFO: "+ .system.info._v_.os_name'
    - '"Firmware Version: "+ .charging_controllers | .[].info._v_.firmware_version
      | capture("V(?<version>\\d+(?:\\.\\d+)*)"; "i") | .version '
    - '"Hardware Version: "+ .charging_controllers | .[].info._v_.hardware_version
      | capture("V(?<version>\\d+(?:\\.\\d+)*)"; "i") | .version'
    - '"Device Name: "+ .charging_controllers | .[].info._v_.device_name'
    - '"Machine Arch: "+ .system.info._v_.machine_arch'
    - '"Machine ID: "+ .system.info._v_.machine_id'
    - '"Kernel Release: "+ .system.info._v_.kernel_release'
    - '"Kernel Version: "+ .system.info._v_.kernel_version'
    - '"Hardware Name: "+ .system.info._v_.hardware_name'
    - '"Device Type: "+ .charging_controllers | .[].info._v_.device_type'
    - '"Device UID: "+ .charging_controllers | .[].info._v_.device_uid'
    type: json
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, "charging_controllers", "system")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/api/v1.0/web/retained-data'
id: phoenix-contact-charx-api
info:
  author: inokii
  description: 'Phoenix Contact CHARX SEC-3XXX AC Charging Controller REST API was
    detected.

    '
  metadata:
    max-request: 1
    shodan-query: title:"Phoenix Contact - CHARX"
    verified: true
  name: Phoenix Contact CHARX SEC-3XXX AC Charging Controller REST API - Detect
  reference:
  - https://www.phoenixcontact.com/en-us/products/ac-charging-controllers
  severity: info
  tags: phoenix-contact,charx,ics,api,discovery
