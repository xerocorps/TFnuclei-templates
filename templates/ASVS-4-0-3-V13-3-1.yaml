http:
- body: '{{valid_xml}}'
  headers:
    Content-type: application/xml
    Host: '{{Hostname}}'
  method: POST
  path:
  - '{{BaseURL}}'
- body: '{{invalid_xml}}'
  extractors:
  - dsl:
    - http_1_status_code
    name: Valid xml submission status code
    type: dsl
  - dsl:
    - http_2_status_code
    name: Invalid xml submission status code
    type: dsl
  headers:
    Content-type: application/xml
    Host: '{{Hostname}}'
  matchers:
  - dsl:
    - http_1_status_code == http_2_status_code
    name: XSD schema validation does not take place
    type: dsl
  method: POST
  path:
  - '{{BaseURL}}'
id: ASVS-4-0-3-V13-3-1
info:
  author: Hamed Salimian
  classification:
    cwe-id: CWE-20
  description: 'Verify that XSD schema validation takes place to ensure a properly
    formed XML document, followed by validation of each input field before any processing
    of that data takes place.

    '
  name: ASVS 13.3.1 Check
  reference:
  - https://cheatsheetseries.owasp.org/cheatsheets/XML_Security_Cheat_Sheet.html
  - https://snbig.github.io/Vulnerable-Pages/ASVS_13_3_1/index.html
  severity: medium
  tags: asvs,13.3.1
variables:
  invalid_xml: <user><username>John</username><email>John.Doe</email></user>
  valid_xml: <user><username>John</username><email>John.Doe@mail.com</email></user>
