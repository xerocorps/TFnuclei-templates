code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: volumes
    type: json
  source: 'aws ec2 describe-volumes --region $region --query ''Volumes[*].VolumeId''  --output
    json

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"EBS Encryption  " + volumes + " is Disabled"'
    type: dsl
  matchers:
  - type: word
    words:
    - 'False'
  source: 'aws ec2 describe-volumes --region $region --volume-ids $volume --query
    ''Volumes[*].Encrypted'' --output text

    '
flow: "code(1)\nfor(let VolumesVolumeId of iterate(template.volumes)){\n  set(\"volume\"\
  , VolumesVolumeId)\n  code(2)\n}\n"
id: ebs-encryption-disabled
info:
  author: DhiyaneshDK
  description: 'Ensure that all your Amazon Elastic Block Store (EBS) volumes are
    encrypted in order to meet security and compliance requirements. With encryption
    enabled, your EBS volumes can hold sensitive, confidential, and critical data.

    '
  impact: 'Disabling AWS EBS encryption exposes sensitive data to unauthorized access,
    increasing the risk of data breaches and compliance violations.

    '
  name: EBS Encryption - Disabled
  reference:
  - https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/EBS/ebs-encrypted.html
  - http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html
  remediation: 'Enable encryption for all existing EBS volumes and ensure that all
    new volumes created are configured to use encryption by default. Additionally,
    update any snapshots to be encrypted and use AWS Key Management Service (KMS)
    to manage encryption keys securely.

    '
  severity: high
  tags: cloud,devops,aws,amazon,ebs,aws-cloud-config
self-contained: true
variables:
  region: us-west-2
