code:
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"AllowUsersToChangePassword Policy is not enabled in your AWS account"'
    type: dsl
  matchers:
  - type: word
    words:
    - 'false'
  source: 'aws iam get-account-password-policy --query ''PasswordPolicy.AllowUsersToChangePassword''

    '
id: iam-user-password-change
info:
  author: princechaddha
  description: 'Verifies that all Amazon IAM users have permissions to change their
    own console passwords, allowing access to ''iam:ChangePassword'' for their accounts
    and ''iam:GetAccountPasswordPolicy'' action.

    '
  name: Enable Self-Service Password Change for IAM Users
  reference:
  - https://docs.aws.amazon.com/cli/latest/reference/iam/get-account-password-policy.html
  severity: high
  tags: cloud,devops,aws,amazon,iam,aws-cloud-config
self-contained: true
