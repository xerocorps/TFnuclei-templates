http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - age-restriction
  - dsl:
    - compare_versions(version, '<= 3.0.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/age-restriction/readme.txt'
  redirects: true
id: CVE-2025-7401-age_restriction-e0906a45-6d9b-48a0-98ae-df7b591a8848
info:
  author: topscoder
  classification:
    cve-id: CVE-2025-7401
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The Premium Age Verification / Restriction for WordPress plugin for
    WordPress is vulnerable to arbitrary file read and write due to the existence
    of an insufficiently protected remote support functionality in remote_tunnel.php
    in all versions up to, and including, 3.0.2. This makes it possible for unauthenticated
    attackers to read from or write to arbitrary files on the affected site''s server
    which may make the exposure of sensitive information or remote code execution
    possible.

    '
  metadata:
    fofa-query: wp-content/plugins/age-restriction/
    google-query: inurl:"/wp-content/plugins/age-restriction/"
    shodan-query: http.html:"wp-content/plugins/age-restriction/"
  name: 'Premium Age Verification / Restriction for WordPress <= 3.0.2 - Unauthenticated
    Arbitrary File Read and Write via remote_tunnel.php

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/e0906a45-6d9b-48a0-98ae-df7b591a8848?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,age-restriction,critical,production
