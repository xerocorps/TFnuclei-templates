http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, "Fatal error", "not found", "downloader/lib/Mage/")
    - contains_any(body, "Mage_Backup", "Mage_Archive")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/downloader/lib/Mage/Backup/Nomedia.php'
  - '{{BaseURL}}/downloader/lib/Mage/Archive/Tar.php'
  - '{{BaseURL}}/downloader/lib/Mage/Archive/Gz.php'
  - '{{BaseURL}}/downloader/lib/Mage/Archive/Bz.php'
  stop-at-first-match: true
id: magento-downloader-fpd
info:
  author: 0x_Akoko
  classification:
    cwe-id: CWE-200
  description: 'Detected Magento Downloader component exposed internal file system
    paths through direct file access.

    '
  metadata:
    max-request: 4
    verified: true
  name: Magento Downloader - Full Path Disclosure
  reference:
  - https://magento.com
  severity: low
  tags: magento,fpd,exposure,disclosure
