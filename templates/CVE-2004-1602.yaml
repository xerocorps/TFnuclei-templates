id: CVE-2004-1602
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:proftpd:proftpd:*:*:*:*:*:*:*:*
    cve-id: CVE-2004-1602
    cvss-metrics: CVSS:2.0/AV:N/AC:L/Au:N/C:P/I:N/A:N
    cvss-score: 5
    cwe-id: CWE-203
    epss-percentile: 0.7393
    epss-score: 0.0083
  description: 'ProFTPD versions 1.2.x (including 1.2.8 and 1.2.10) are vulnerable
    to timing attacks that allow remote attackers to distinguish valid usernames from
    invalid ones. The server responds in varying amounts of time when a given username
    exists, enabling username enumeration through response time analysis.

    '
  impact: 'Attackers can enumerate valid usernames by analyzing server response times,
    facilitating subsequent brute force or targeted attacks against ProFTPD authentication.

    '
  metadata:
    max-request: 1
    product: proftpd
    shodan-query:
    - product:"proftpd"
    - cpe:"cpe:2.3:a:proftpd:proftpd"
    vendor: proftpd
    verified: true
  name: ProFTPD 1.2.x - Username Enumeration via Timing Attack
  reference:
  - http://marc.info/?l=bugtraq&m=109786760926133&w=2
  - https://exchange.xforce.ibmcloud.com/vulnerabilities/17724
  remediation: 'Upgrade ProFTPD to a version later than 1.2.10 that normalizes response
    times for authentication attempts regardless of username validity.

    '
  severity: medium
  tags: cve,cve2004,network,ftp,proftpd,tcp,passive,timing-attack,user-enum,vuln
tcp:
- extractors:
  - group: 1
    name: version
    regex:
    - ProFTPD ([0-9.]+)
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: 0
    type: hex
  matchers:
  - condition: and
    dsl:
    - contains(raw, 'ProFTPD')
    - compare_versions(version, '>= 1.2.0', '<= 1.2.10')
    type: dsl
  port: 21
  read-size: 1024
