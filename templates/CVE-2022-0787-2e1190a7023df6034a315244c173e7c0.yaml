http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-limit-failed-login-attempts
  - dsl:
    - compare_versions(version, '<= 4.9.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-limit-failed-login-attempts/readme.txt'
  redirects: true
id: CVE-2022-0787-2e1190a7023df6034a315244c173e7c0
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-0787
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The Limit Login Attempts (Spam Protection) WordPress plugin before
    5.1 does not sanitise and escape some parameters before using them in SQL statements
    via AJAX actions (available to unauthenticated users), leading to SQL Injections

    '
  metadata:
    fofa-query: wp-content/plugins/wp-limit-failed-login-attempts/
    google-query: inurl:"/wp-content/plugins/wp-limit-failed-login-attempts/"
    shodan-query: vuln:CVE-2022-0787
  name: 'Limit Login Attempts (Spam Protection) <= 4.9.1 - Unauthenticated SQL Injection

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/49ea8af1-7171-4498-bfb0-bb3cbd72e6f3?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,wp-limit-failed-login-attempts,critical
