code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: accountList
    type: json
  source: 'az storage account list --query ''[*].{"Name":name}''

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - name + " has logging for read, write, delete not enabled"
    type: dsl
  matchers:
  - condition: and
    type: word
    words:
    - '"delete": false'
    - '"read": false'
    - '"write": false'
  source: 'az storage logging show --services t --account-name "$name" --output json

    '
flow: "code(1);\nfor (let AccountData of iterate(template.accountList)) {\n  AccountData\
  \ = JSON.parse(AccountData);\n  set(\"name\", AccountData.Name);\n  code(2);\n}\n"
id: azure-storage-table-logging-disabled
info:
  author: princechaddha
  description: 'Ensure that Azure Storage Table service logging is enabled for read,
    write, and delete requests. The Azure Storage Table service stores structured
    NoSQL data in the cloud, providing a key/attribute store with a schema-less design.
    Storage logging is performed server-side and allows details for both successful
    and failed requests to be recorded in the associated storage account.

    '
  impact: 'Failing to enable logging for the Azure Storage Table service can prevent
    tracking of successful and failed requests, impacting auditing and troubleshooting
    capabilities.

    '
  name: Azure Storage Table Logging Not Enabled
  reference:
  - https://docs.microsoft.com/en-us/azure/storage/tables/table-storage-overview
  remediation: 'Enable logging for read, write, and delete requests in the Azure Storage
    Table service through the Azure portal or using the Azure CLI.

    '
  severity: medium
  tags: cloud,devops,azure,microsoft,azure-storage,azure-cloud-config
self-contained: true
