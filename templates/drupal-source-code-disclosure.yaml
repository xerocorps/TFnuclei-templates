http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, 'Drupal database driver', 'drupal_initialize_variables()',
      'allow_authorize_operations')
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/sites/default/settings.php'
  - '{{BaseURL}}/sites/default/settings.php~'
  - '{{BaseURL}}/sites/default/settings.php.bak'
  - '{{BaseURL}}/sites/default/settings.php.old'
  - '{{BaseURL}}/sites/default/settings.php.orig'
  - '{{BaseURL}}/sites/default/settings.php.save'
  - '{{BaseURL}}/sites/default/settings.php.swp'
  - '{{BaseURL}}/sites/default/settings.local.php'
  stop-at-first-match: true
id: drupal-source-code-disclosure
info:
  author: pussycat0x
  description: 'Detected exposed Drupal source code, backup files, and sensitive configurations,
    potentially disclosing database credentials and API keys. This exposure revealed
    internal system paths and critical site metadata, increasing the risk of full
    system compromise.

    '
  metadata:
    max-request: 8
    product: drupal
    shodan-query: http.component:"drupal"
    vendor: drupal
    verified: true
  name: Drupal - Source Code Disclosure
  reference:
  - https://www.drupal.org/docs/security-in-drupal
  - https://www.drupal.org/project/drupal/issues/3457781
  severity: medium
  tags: drupal,exposure,disclosure,misconfig
