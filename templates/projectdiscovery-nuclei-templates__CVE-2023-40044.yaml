http:
- extractors:
  - part: body
    regex:
    - \d+-(0[1-9]|1[0-2])-(19\d{2}|20[01]\d|202[0-2])
    - \d+-(0[1-8])-2023
    type: regex
  matchers:
  - condition: or
    part: body
    regex:
    - /\*! fileTransfer \d+-(0[1-9]|1[0-2])-(19\d{2}|20[01]\d|202[0-2]) \*/
    - /\*! fileTransfer \d+-(0[1-8])-2023 \*/
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/AHT/AHT_UI/public/js/app.min.js'
id: CVE-2023-40044
info:
  author: 0x_Akoko
  classification:
    cpe: cpe:2.3:a:progress:ws_ftp_server:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-40044
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cwe-id: CWE-502
    epss-percentile: 0.99984
    epss-score: 0.94436
  description: 'In WS_FTP Server versions prior to 8.7.4 and 8.8.2, a pre-authenticated
    attacker could leverage a .NET deserialization vulnerability in the Ad Hoc Transfer
    module to execute remote commands on the underlying WS_FTP Server operating system.

    '
  impact: 'Unauthenticated attackers can exploit .NET deserialization vulnerability
    in the Ad Hoc Transfer module to execute arbitrary commands on the WS_FTP Server,
    potentially compromising the entire file transfer infrastructure and accessing
    all transferred files.

    '
  metadata:
    max-request: 1
    product: ws_ftp_server
    shodan-query: title:"Ad Hoc Transfer"
    vendor: progress
    verified: true
  name: WS_FTP Server - Insecure Deserialization
  reference:
  - https://attackerkb.com/topics/bn32f9sNax/cve-2023-40044
  - https://censys.com/cve-2023-40044/
  - https://www.progress.com/ws_ftp
  - https://www.rapid7.com/blog/post/2023/09/29/etr-critical-vulnerabilities-in-ws_ftp-server/
  - https://www.theregister.com/2023/10/02/ws_ftp_update/
  remediation: 'Update Progress WS_FTP Server to version 8.7.4 or 8.8.2 or later that
    properly validates deserialization input in the Ad Hoc Transfer module.

    '
  severity: critical
  tags: cve,cve2023,ws_ftp,kev,passive,vkev
