http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '5.4')
    - compare_versions(version_by_js, '5.4')
    - compare_versions(version_by_css, '5.4')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2020-11026-27df0ea7c6590b827fd75993432bfee2
info:
  author: topscoder
  classification:
    cve-id: CVE-2020-11026
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 6.4
  description: 'In affected versions of WordPress, files with a specially crafted
    name when uploaded to the Media section can lead to script execution upon accessing
    the file. This requires an authenticated user with privileges to upload files.
    This has been patched in version 5.4.1, along with all the previously affected
    versions via a minor release (5.3.3, 5.2.6, 5.1.5, 5.0.9, 4.9.14, 4.8.13, 4.7.17,
    4.6.18, 4.5.21, 4.4.22, 4.3.23, 4.2.27, 4.1.30, 4.0.30, 3.9.31, 3.8.33, 3.7.33).

    '
  metadata:
    shodan-query: vuln:CVE-2020-11026
  name: 'WordPress Core < 5.4.1 - Authenticated (Author+) Cross-Site Scripting via
    File Uploads

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/3379dde1-d1fb-4ec8-b834-de00fb6a38f2?source=api-prod
  severity: low
  tags: cve,wordpress,wp-core,low
