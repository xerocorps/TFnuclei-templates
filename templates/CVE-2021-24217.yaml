http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - official-facebook-pixel
  - dsl:
    - compare_versions(version, '<= 2.2.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/official-facebook-pixel/readme.txt'
  redirects: true
id: CVE-2021-24217
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24217
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
  description: The run_action function of the Facebook for WordPress plugin before
    3.0.0 deserializes user supplied data making it possible for PHP objects to be
    supplied creating an Object Injection vulnerability. There was also a useable
    magic method in the plugin that could be used to achieve remote code execution.
  metadata:
    fofa-query: wp-content/plugins/official-facebook-pixel/
    google-query: inurl:"/wp-content/plugins/official-facebook-pixel/"
    shodan-query: vuln:CVE-2021-24217
  name: Meta pixel for WordPress <= 2.2.2 - PHP Object Injection
  reference:
  - https://wpscan.com/vulnerability/509f2754-a1a1-4142-9126-ae023a88533a
  - https://www.wordfence.com/blog/2021/03/two-vulnerabilities-patched-in-facebook-for-wordpress-plugin/
  severity: high
  tags: cve,wordpress,wp-plugin,official-facebook-pixel,high
