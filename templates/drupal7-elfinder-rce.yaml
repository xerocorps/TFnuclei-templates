http:
- matchers:
  - part: body
    type: word
    words:
    - '{"cwd":'
  - part: content_type
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/sites/all/libraries/elfinder/connectors/php/connector.php'
id: drupal7-elfinder-rce
info:
  author: 1337kro
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-434
  description: 'Identifies Drupal sites with the elfinder library installed, which
    could be vulnerable to unrestricted file upload through the connector.php file.When
    this component is detected, the site may be vulnerable to remote code execution
    attacks via PHP file uploads.This template only detects the presence of the vulnerable
    component and does not perform any exploitation.

    '
  metadata:
    fofa-query: app="drupal"
    product: Drupal
    vendor: Drupal
    verified: true
  name: Drupal 7 Elfinder - Remote Code Execution
  reference:
  - https://github.com/Kro0oz/drupal-7-elfinder
  remediation: 'Remove the elfinder library if not needed, or implement proper file
    upload restrictions and input validation. Additionally, consider implementing
    Web Application Firewall rules to block access to the connector.php file.

    '
  severity: critical
  tags: drupal,elfinder,filemanager,exposure,vuln
