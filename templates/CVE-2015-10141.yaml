http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: header
    type: word
    words:
    - 'Set-Cookie: XDEBUG_SESSION={{randstr}}'
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /?XDEBUG_SESSION_START={{randstr}} HTTP/1.1

    Host: {{Hostname}}

    X-Forwarded-For: {{interactsh-url}}

    '
id: CVE-2015-10141
info:
  author: pwnhxl
  classification:
    cve-id: CVE-2015-10141
    cvss-metrics: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    cwe-id: CWE-78
    epss-percentile: 0.97768
    epss-score: 0.51456
  description: 'Xdebug <= 2.5.5 contains an unauthenticated command injection caused
    by accepting debugger protocol commands without authentication when remote debugging
    is enabled, letting remote attackers execute arbitrary PHP code and system commands,
    exploit requires remote debugging enabled.

    '
  impact: 'Attackers can execute arbitrary PHP code and system commands remotely without
    authentication, leading to complete server compromise.

    '
  metadata:
    max-request: 1
    verified: true
  name: Xdebug <= 2.5.5 - Command Injection
  reference:
  - https://github.com/vulhub/vulhub/tree/master/php/xdebug-rce
  - https://redshark1802.com/blog/2015/11/13/xpwn-exploiting-xdebug-enabled-servers/
  - https://paper.seebug.org/397/
  - https://github.com/D3Ext/XDEBUG-Exploit
  - https://www.exploit-db.com/exploits/44568
  - https://www.vulncheck.com/advisories/xdebug-remote-debugger-unauth-os-command-execution
  remediation: 'Disable remote debugging in production environments or upgrade to
    Xdebug version 2.6.0 or later with proper authentication controls.

    '
  severity: critical
  tags: cve,cve2015,oast,rce,vulhub,php,debug,xdebug,intrusive,vuln
