id: obsolete-ssh-version
info:
  author: pussycat0x
  metadata:
    max-request: 2
    shodan-query: port:22
  name: Obsolete and less secure SSH Version
  reference:
  - https://nmap.org/nsedoc/scripts/sshv1.html
  severity: info
  tags: js,ssh,network
javascript:
- args:
    Host: '{{Host}}'
    Port: '22'
  code: 'var m = require("nuclei/ssh");

    var c = m.SSHClient();

    var response = c.ConnectSSHInfoMode(Host, Port);

    to_json(response);

    '
  extractors:
  - json:
    - .ServerID.ProtoVersion
    name: SSH Protocol Version
    type: json
  - internal: true
    json:
    - .ServerID.ProtoVersion
    name: version
    type: json
  matchers:
  - condition: and
    dsl:
    - success == true
    - version == '1.0'
    type: dsl
  pre-condition: 'isPortOpen(Host,Port)

    '
