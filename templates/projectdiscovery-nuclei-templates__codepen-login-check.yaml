http:
- extractors:
  - dsl:
    - username
    - password
    type: dsl
  - internal: true
    name: token
    part: body
    type: xpath
    xpath:
    - //input[@name="authenticity_token"]/@value
  matchers:
  - negative: true
    part: body
    type: word
    words:
    - The username or password you entered is incorrect, please try again.
  - status:
    - 302
    type: status
  matchers-condition: and
  raw:
  - 'GET https://codepen.io/login HTTP/1.1

    Host: codepen.io

    '
  - 'POST https://codepen.io/login/login HTTP/1.1

    Host: codepen.io

    Content-Type: application/x-www-form-urlencoded

    X-CSRF-Token: {{token}}


    authenticity_token={{token}}&email={{username}}&password={{password}}&login-type=fullpage

    '
id: codepen-login-check
info:
  author: parthmalhotra,pdresearch
  description: Checks for a valid codepen account.
  metadata:
    max-request: 2
  name: codepen.io Login Check
  reference:
  - https://owasp.org/www-community/attacks/Credential_stuffing
  severity: critical
  tags: creds-stuffing,login-check,cloud,codepen,vuln
self-contained: true
