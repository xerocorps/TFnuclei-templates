http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - ultimate-member
  - dsl:
    - compare_versions(version, '< 2.1.12')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/ultimate-member/readme.txt'
  redirects: true
id: CVE-2020-36155-ultimate_member-ef2ac5c8-9e76-40b8-a2a4-8cb4291871f2
info:
  author: topscoder
  classification:
    cve-id: CVE-2020-36155
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
  description: 'An issue was discovered in the Ultimate Member plugin before 2.1.12
    for WordPress, aka Unauthenticated Privilege Escalation via User Meta. An attacker
    could supply an array parameter for sensitive metadata, such as the wp_capabilities
    user meta that defines a user''s role. During the registration process, submitted
    registration details were passed to the update_profile function, and any metadata
    was accepted, e.g., wp_capabilities[administrator] for Administrator access.

    '
  metadata:
    fofa-query: wp-content/plugins/ultimate-member/
    google-query: inurl:"/wp-content/plugins/ultimate-member/"
    shodan-query: http.html:"wp-content/plugins/ultimate-member/"
  name: 'Ultimate Member <= 2.1.11 - Unauthenticated Privilege Escalation via User
    Meta

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/ef2ac5c8-9e76-40b8-a2a4-8cb4291871f2?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,ultimate-member,critical,production
