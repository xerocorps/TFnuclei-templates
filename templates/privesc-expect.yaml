code:
- engine:
  - sh
  - bash
  source: 'whoami

    '
- engine:
  - sh
  - bash
  source: 'expect -c ''spawn whoami;interact''

    '
- engine:
  - sh
  - bash
  matchers:
  - negative: true
    part: code_1_response
    type: word
    words:
    - root
  - condition: or
    dsl:
    - contains(code_2_response, "root")
    - contains(code_3_response, "root")
    type: dsl
  matchers-condition: and
  source: 'sudo expect -c ''spawn whoami;interact''

    '
id: privesc-expect
info:
  author: daffainfo
  description: 'expect is a Unix scripting and testing utility that automates interactive
    applications such as telnet, ftp, passwd, fsck, rlogin, tip, and more. It uses
    scripts to control interactive applications, making it useful for automating tasks
    that involve user input.

    '
  metadata:
    max-request: 3
    verified: true
  name: expect - Privilege Escalation
  reference:
  - https://gtfobins.github.io/gtfobins/expect/
  severity: high
  tags: code,linux,expect,privesc,local
self-contained: true
