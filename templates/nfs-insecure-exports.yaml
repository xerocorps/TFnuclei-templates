code:
- engine:
  - sh
  - bash
  matchers:
  - part: response
    type: word
    words:
    - '[VULNERABLE]'
  source: "if grep -Eq '^[^#].*\\(.*no_root_squash.*\\)' /etc/exports; then\n  echo\
    \ \"[VULNERABLE] NFS allows root access with no_root_squash\"\nelif grep -Eq '^[^#].*\\\
    *' /etc/exports; then\n  echo \"[VULNERABLE] NFS allows access to all (*) hosts\"\
    \nelif grep -Eq '^[^#].*\\(.*all_squash.*\\)' /etc/exports; then\n  echo \"[WARN]\
    \ NFS uses all_squash (verify if access is restricted)\"\nelse\n  echo \"[SAFE]\
    \ NFS access appears restricted\"\nfi\n"
id: nfs-insecure-exports
info:
  author: songyaeji
  description: 'Verified whether access control was properly configured on NFS.Highlighted
    possibilities such as allowing all hosts, no_root_squash, or unrestricted all_squash
    that could let unauthorized users access shared directories.

    '
  name: NFS Insecure Exports Check
  reference:
  - https://isms.kisa.or.kr
  severity: high
  tags: linux,local,audit,kisa,compliance
self-contained: true
