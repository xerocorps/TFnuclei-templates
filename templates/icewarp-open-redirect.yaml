id: icewarp-open-redirect
info:
  author: uomogrande
  description: Detects icewarp open redirects / fixed in Version 13.0.2.4
  metadata:
    shodan-query: title:"icewarp"
    verified: true
  name: IceWarp - Open Redirect
  severity: medium
  tags: icewarp,redirect
requests:
- extractors:
  - group: 1
    name: redirected
    part: header
    regex:
    - 'Server: (.{4,20})'
    type: regex
  matchers:
  - part: header
    type: word
    words:
    - IceWarp
  - part: header
    regex:
    - (?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)?(?:[a-zA-Z0-9\-_\.@]*)interact\.sh\/?(\/|[^.].*)?$
    type: regex
  matchers-condition: and
  raw:
  - 'GET ///interact.sh/%2F.. HTTP/1.1

    '
