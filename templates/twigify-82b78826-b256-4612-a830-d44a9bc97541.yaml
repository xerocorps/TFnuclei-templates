http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - twigify
  - dsl:
    - compare_versions(version, '<= 1.1.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/twigify/readme.txt'
  redirects: true
id: twigify-82b78826-b256-4612-a830-d44a9bc97541
info:
  author: topscoder
  classification:
    cve-id: null
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 7.3
  description: 'The Twigify plugin for WordPress is running a vulnerable version of
    Twig (1.16.3) in all versions up to, and including, 1.1.2, the AP Twig Bridge
    plugin for WordPress is running a vulnerable version of Twig (1.5.0) in all versions
    up to, and including, 1.0, and the Content Template Engine plugin for WordPress
    is running a vulnerable version of Twig (1.22.3) in all versions up to, and including,
    0.9.4. This version of Twig contains many security vulnerabilities, though none
    have been confirmed exploitable in the Twigify or AP Twig Bridge plugins.

    '
  metadata:
    fofa-query: wp-content/plugins/twigify/
    google-query: inurl:"/wp-content/plugins/twigify/"
    shodan-query: http.html:"wp-content/plugins/twigify/"
  name: 'Twigify <= 1.1.2 & AP Twig Bridge <= 1.0 & Content Template Engine <= 0.9.4  -
    Running Vulnerable Twig Package

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/82b78826-b256-4612-a830-d44a9bc97541?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,twigify,high,production
