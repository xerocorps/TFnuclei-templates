http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '< 3.0.1')
    - compare_versions(version_by_js, '< 3.0.1')
    - compare_versions(version_by_css, '< 3.0.1')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2010-5297
info:
  author: topscoder
  classification:
    cve-id: CVE-2010-5297
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 4.7
  description: WordPress before 3.0.1, when a Multisite installation is used, permanently
    retains the 'site administrators can add users' option once changed, which might
    allow remote authenticated administrators to bypass intended access restrictions
    in opportunistic circumstances via an add action after a temporary change.
  metadata:
    shodan-query: vuln:CVE-2010-5297
  name: WordPress Core < 3.0.1 - Missing Authorization
  reference:
  - http://codex.wordpress.org/Changelog/3.0.1
  - http://core.trac.wordpress.org/query?status=closed&group=resolution&order=priority&milestone=3.0.1&resolution=fixed
  - https://core.trac.wordpress.org/ticket/14119
  - https://core.trac.wordpress.org/changeset/15342
  - https://wordpress.org/news/2010/07/wordpress-3-0-1/
  severity: medium
  tags: cve,wordpress,wp-core,medium
