id: red-lion-enip-detect
info:
  author: biero-el-corridor
  description: 'Detects Red Lion industrial control devices by sending Ethernet/IP
    (ENIP) protocol requests to port 789 and identifying devices that respond with
    "Red Lion Controls" in their response. This template can be used to discover and
    fingerprint Red Lion devices on industrial networks.

    '
  metadata:
    max-request: 2
  name: Red Lion ENIP - Detect
  severity: info
  tags: ics,redlion,detect,network,tcp
tcp:
- host:
  - '{{Hostname}}'
  inputs:
  - data: 0004012b1b00
    name: info
    read: 200
    type: hex
  - data: 0004012a1a00
    name: note
    read: 200
    type: hex
  matchers:
  - binary:
    - 526564204c696f6e20436f6e74726f6c73
    part: info
    type: binary
  port: 502
  read-size: 1024
