code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'False'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: '(Get-SmbServerConfiguration).EncryptData

    '
id: unencrypted-file-sharing-enabled
info:
  author: princechaddha
  description: Checks if file sharing is enabled without encryption.
  impact: 'Unencrypted file sharing exposes sensitive data to interception, leading
    to potential data breaches.

    '
  name: Unencrypted File Sharing Enabled
  remediation: 'Enable encryption for file sharing to ensure the confidentiality and
    integrity of shared files.

    '
  severity: medium
  tags: windows,file-sharing,encryption,code,windows-audit
self-contained: true
