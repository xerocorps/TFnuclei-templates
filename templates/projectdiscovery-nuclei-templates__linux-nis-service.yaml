code:
- engine:
  - sh
  - bash
  matchers:
  - part: response
    type: word
    words:
    - '[VULNERABLE]'
  source: "if command -v systemctl >/dev/null 2>&1; then\n    if systemctl is-active\
    \ --quiet ypserv ypbind; then\n        echo \"[VULNERABLE] NIS service is running\"\
    \n        systemctl status ypserv ypbind\n    else\n        echo \"[SAFE] NIS\
    \ service is not running\"\n    fi\nelse\n    running=$(ps -ef | egrep \"ypserv|ypbind\"\
    \ | grep -v grep)\n    if [ -n \"$running\" ]; then\n        echo \"[VULNERABLE]\
    \ NIS service is running\"\n        echo \"$running\"\n    else\n        echo\
    \ \"[SAFE] NIS service is not running\"\n    fi\nfi\n"
id: linux-nis-service
info:
  author: songyaeji
  description: 'Evaluated the status of NIS service daemons on the system. Active
    NIS services could have permitted unauthorized users to escalate privileges or
    access sensitive account information, posing a significant security risk.

    '
  name: NIS Service Should Be Disabled
  reference:
  - https://isms.kisa.or.kr
  severity: high
  tags: linux,local,audit,kisa,compliance
self-contained: true
