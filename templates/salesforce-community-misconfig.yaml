http:
- extractors:
  - group: 1
    internal: true
    name: aura_context
    part: body
    regex:
    - \/s\/sfsites\/l\/([a-zA-Z0-9\-_~.%]+)\/[^\/]+\.js
    type: regex
  matchers:
  - internal: true
    status:
    - 200
    type: status
  max-redirects: 1
  method: GET
  path:
  - '{{RootURL}}/s/'
  redirects: true
- body: 'message={{url_encode(actions)}}&aura.context={{aura_context}}&aura.token=null

    '
  headers:
    Content-Type: application/x-www-form-urlencoded
  matchers:
  - part: body
    type: word
    words:
    - recordTypeInfo
  method: POST
  path:
  - '{{RootURL}}/s/sfsites/aura'
id: salesforce-community-misconfig
info:
  author: domwhewell-sage
  description: 'A misconfigured Salesforce Community may lead to sensitive Salesforce
    data being exposed to anyone on the internet. Anonymous users can query objects
    that contain sensitive information such as customer lists, support cases, and
    employee email addresses.

    '
  metadata:
    publicwww-query: sfsites
    verified: true
  name: Salesforce Community Misconfiguration
  reference:
  - https://www.varonis.com/blog/abusing-salesforce-communities
  - https://www.enumerated.ie/index/salesforce
  severity: medium
  tags: aura,unauth,salesforce,exposure,misconfig,vuln
variables:
  actions: '{"actions":[{"id":"{{randstr}}","descriptor":"serviceComponent://ui.force.components.controllers.lists.selectableListDataProvider.SelectableListDataProviderController/ACTION$getItems","callingDescriptor":"UNKNOWN","params":{"entityNameOrId":"ContentDocument","layoutType":"FULL","pageSize":20,"currentPage":0,"useTimeout":false,"getCount":true,"enableRowActions":false}}]}'
