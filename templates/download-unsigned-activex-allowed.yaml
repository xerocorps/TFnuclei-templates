code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 1004=0
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: '$prop = Get-ItemProperty -Path ''HKCU:\Software\Microsoft\Windows\CurrentVersion\Internet
    Settings\Zones\0'' -Name ''1004'' -ErrorAction SilentlyContinue; if ($null -eq
    $prop.''1004'') { "Property ''1004'' does not exist" } else { $prop.''1004'' }

    '
id: download-unsigned-activex-allowed
info:
  author: princechaddha
  description: Verifies if the system allows downloading and installing unsigned ActiveX
    controls.
  impact: 'Allowing unsigned ActiveX controls can lead to the execution of malicious
    code.

    '
  name: Download of Unsigned ActiveX Controls Allowed
  remediation: 'Disable the download and installation of unsigned ActiveX controls.

    '
  severity: high
  tags: activex,code-signing,code,windows-audit
self-contained: true
