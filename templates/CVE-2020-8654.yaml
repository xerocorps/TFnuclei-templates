id: CVE-2020-8654
info:
  author: praetorian-thendrickson
  classification:
    cve-id: CVE-2020-8654
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cwe-id: CWE-78
  description: EyesOfNetwork version 5.1-5.3 is vulnerable to multiple exploits. Version
    5.3 is vulnerable to CVE-2020-8654 (authenticated rce), CVE-2020-8655 (privesc),
    CVE-2020-8656 (SQLi - API version before 2.4.2), and 2020-8657 (hardcoded api
    key). Versions 5.1-5.3 are vulnerable to CVE-2020-9465 (SQLi).
  name: EyesOfNetwork 5.3 - Authenticated RCE
  reference:
  - https://github.com/h4knet/eonrce
  - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/eyesofnetwork_autodiscovery_rce.rb
  - https://nvd.nist.gov/vuln/detail/CVE-2020-8657
  - https://github.com/EyesOfNetworkCommunity/eonweb/issues/50
  severity: high
  tags: cve,cve2020,cisa,eyesofnetwork,rce,authenticated
requests:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '# VERSION : ([0-9.]+)'
    type: regex
  matchers:
  - dsl:
    - compare_versions(version, '< 5.4', '>= 5.1')
    type: dsl
  - part: body
    type: word
    words:
    - EyesOfNetwork
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/css/eonweb.css'
