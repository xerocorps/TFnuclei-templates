http:
- extractors:
  - json:
    - .data.version.name
    name: version
    part: body_2
    type: json
  matchers:
  - dsl:
    - contains(body_1, "<title>Traggo</title>") && contains(body_1, "webpackJsonpui")
      && contains(body_2, "\"data\"") && contains(body_2, "\"version\"")
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /graphql HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"query":"{ version { name commit buildDate } }"}

    '
id: traggo-server-detect
info:
  author: 0x_Akoko
  description: 'Detected Traggo time tracking server.

    '
  metadata:
    max-request: 2
    shodan-query: http.title:"Traggo"
    verified: true
  name: Traggo Time Tracking Server - Detect
  reference:
  - https://github.com/traggo/server
  severity: info
  tags: tech,traggo,detect,graphql,discovery
