http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - echo-knowledge-base
  - dsl:
    - compare_versions(version, '<= 11.30.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/echo-knowledge-base/readme.txt'
  redirects: true
id: CVE-2024-24842-42718c04ccc53a658e939685a7322624
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-24842
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The Knowledge Base for Documentation, FAQs with AI Assistance plugin
    for WordPress is vulnerable to PHP Object Injection in all versions up to, and
    including, 11.30.2 via deserialization of untrusted input in the is_article_recently_viewed
    function. This makes it possible for unauthenticated attackers to inject a PHP
    Object. If a POP chain is present via an additional plugin or theme installed
    on the target system, it could allow the attacker to delete arbitrary files, retrieve
    sensitive data, or execute code.

    '
  metadata:
    fofa-query: wp-content/plugins/echo-knowledge-base/
    google-query: inurl:"/wp-content/plugins/echo-knowledge-base/"
    shodan-query: vuln:CVE-2024-24842
  name: 'Knowledge Base for Documentation, FAQs with AI Assistance <= 11.30.2 - Unauthenticated
    PHP Object Injection in is_article_recently_viewed

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/41cfe1d7-2fab-413c-80e5-40d77133d229?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,echo-knowledge-base,critical
