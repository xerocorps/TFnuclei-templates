code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'True'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: '(Get-Item WSMan:\localhost\Service).AllowUnencrypted

    '
id: winrm-allows-unencrypted-traffic
info:
  author: princechaddha
  description: Verifies if Windows Remote Management (WinRM) is allowing unencrypted
    traffic, exposing sensitive data.
  impact: 'Allowing unencrypted traffic in WinRM can expose sensitive information
    to attackers.

    '
  name: WinRM Allows Unencrypted Traffic
  remediation: 'Configure WinRM to require encrypted traffic by setting `AllowUnencrypted`
    to `False`.

    '
  severity: high
  tags: winrm,unencrypted,traffic,code,windows-audit
self-contained: true
