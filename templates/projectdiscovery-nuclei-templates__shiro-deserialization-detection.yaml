http:
- matchers:
  - condition: and
    dsl:
    - contains(header_1, "Set-Cookie") && (contains(header_1, "rememberMe=") || contains(header_1,
      "=deleteMe"))
    - '!contains(header_2, "rememberMe=") && !contains(header_2, "=deleteMe")'
    type: dsl
  - condition: and
    dsl:
    - "!contains(body_2, \"<p>\u5F53\u524D\u8BBF\u95EE\u7591\u4F3C\u9ED1\u5BA2\u653B\
      \u51FB\uFF0C\u5DF2\u88AB\u7F51\u7AD9\u7BA1\u7406\u5458\u8BBE\u7F6E\u62E6\u622A\
      \u5E76\u8BB0\u5F55</p>\")"
    - "!contains(body_2, \"\u5F88\u62B1\u6B49\uFF0C\u7531\u4E8E\u60A8\u8BBF\u95EE\u7684\
      URL\u6709\u53EF\u80FD\u5BF9\u7F51\u7AD9\u9020\u6210\u5B89\u5168\u5A01\u80C1\uFF0C\
      \u60A8\u7684\u8BBF\u95EE\u88AB\u963B\u65AD\")"
    type: dsl
  matchers-condition: and
  payloads:
    key: helpers/wordlists/shiro_encrypted_keys.txt
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    Cookie: JSESSIONID={{randstr}};rememberMe=123;

    '
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    Cookie: JSESSIONID={{randstr}};rememberMe={{key}};

    '
  stop-at-first-match: true
id: shiro-deserialization-detection
info:
  author: hotpot,j4vaovo
  description: 'This template is designed to detect the Shiro framework''s default
    key vulnerabilities. It leverages 51 built-in Shiro keys to probe for potential
    vulnerabilities.

    '
  metadata:
    max-request: 102
  name: Shiro <= 1.2.4 Deserialization Detection
  reference:
  - https://github.com/sv3nbeast/ShiroScan
  severity: unknown
  tags: shiro,deserialization,rce,apache,vuln
