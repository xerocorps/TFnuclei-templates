http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - Exception
    - REQUEST_TIME
    - ThinkPHP Constants
  - condition: or
    status:
    - 200
    - 500
    - 404
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/index.php?s=example'
id: CVE-2022-25481
info:
  author: caon
  classification:
    cpe: cpe:2.3:a:thinkphp:thinkphp:5.0.24:*:*:*:*:*:*:*
    cve-id: CVE-2022-25481
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-668
    epss-percentile: 0.95328
    epss-score: 0.20316
  description: 'ThinkPHP 5.0.24 is susceptible to information disclosure. This version
    was configured without the PATHINFO parameter. This can allow an attacker to access
    all system environment parameters from index.php, thereby possibly obtaining sensitive
    information, modifying data, and/or executing unauthorized operations.

    '
  impact: 'An attacker can exploit this vulnerability to gain sensitive information.

    '
  metadata:
    fofa-query:
    - title="thinkphp"
    - header="think_lang"
    google-query: intitle:"thinkphp"
    max-request: 1
    product: thinkphp
    shodan-query:
    - title:"ThinkPHP"
    - http.title:"thinkphp"
    - cpe:"cpe:2.3:a:thinkphp:thinkphp"
    vendor: thinkphp
    verified: true
  name: ThinkPHP 5.0.24 - Information Disclosure
  reference:
  - https://github.com/Lyther/VulnDiscover/blob/master/Web/ThinkPHP_InfoLeak.md
  - https://nvd.nist.gov/vuln/detail/CVE-2022-25481
  - https://github.com/20142995/sectool
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Upgrade to a patched version of ThinkPHP or apply the necessary security
    patches.

    '
  severity: high
  tags: cve,cve2022,thinkphp,exposure,oss,vuln
