id: ldap-get-ad-grp
info:
  author: pussycat0x
  description: 'Attempts to list the supported capabilities in a SMBv2 server for
    each enabled dialect.

    '
  metadata:
    max-request: 1
    shodan-query: ldap
  name: LDAP Get Active Directory Group - Enumeration
  reference:
  - https://docs.projectdiscovery.io/templates/protocols/javascript/modules/ldap.Client#getadgroups
  severity: info
  tags: js,network,ldap,enum
javascript:
- args:
    Host: ldap://{{Host}}
    Port: 389
  code: "const ldap = require('nuclei/ldap');\nconst cfg = new ldap.Config();\ncfg.Upgrade\
    \ = true;\nconst client = new ldap.Client(Host, Port, cfg);\nconst groups = client.GetADGroups();\n\
    const bytes = require('nuclei/bytes');\nconst buffer = new bytes.Buffer();\nfor\
    \ (const group of groups) {\n  buffer.WriteString(\"DistinguishedName: '\" + group.DistinguishedName+\
    \ \"' ,\");\n  buffer.WriteString(\"SAMAccountName: '\" + group.SAMAccountName+\
    \ \"' ,\");\n  buffer.WriteString(\"PWDLastSet: '\" + group.PWDLastSet+ \"' ,\"\
    );\n  buffer.WriteString(\"LastLogon: '\" + group.LastLogon+ \"' ,\");\n  buffer.WriteString(\"\
    MemberOf: '\" + group.MemberOf+ \"' ,\");\n  buffer.WriteString(\"ServicePrincipalName:\
    \ '\" + group.ServicePrincipalName+ \"' ,\");\n}\nExport(buffer.String());\n"
  extractors:
  - dsl:
    - response
    type: dsl
