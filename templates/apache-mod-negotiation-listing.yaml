http:
- extractors:
  - group: 1
    name: exposed_files
    part: body
    regex:
    - <a href="([^"]+)">
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - Available variants
    - href=
  - status:
    - 406
    type: status
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  payloads:
    path:
    - /index
    - /test
    - /admin
    - /login
    - /config
  raw:
  - 'GET {{path}} HTTP/1.1

    Host: {{Hostname}}

    Accept: fake/fake

    '
id: apache-mod-negotiation-listing
info:
  author: 0x_Akoko
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-538
  description: 'Detected Apache server with mod_negotiation and MultiViews enabled,
    exposing a pseudo directory listing when invalid Accept headers are sent to extensionless
    filenames.

    '
  metadata:
    max-request: 5
    verified: true
  name: Apache mod_negotiation - Pseudo Directory Listing
  reference:
  - https://www.acunetix.com/vulnerabilities/web/apache-mod_negotiation-filename-bruteforcing/
  - https://cwe.mitre.org/data/definitions/538.html
  severity: low
  tags: apache,misconfig,exposure,mod-negotiation
