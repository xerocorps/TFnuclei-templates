dns:
- attack: batteringram
  class: inet
  matchers:
  - part: answer
    type: word
    words:
    - "IN\tA"
  name: '{{wordlist}}.{{regionname}}.{{BaseDNS}}'
  recursion: true
  type: A
id: azure-vm-cloud-enum
info:
  author: initstring
  description: 'Searches for Azure virtual machines via their registered DNS names.

    '
  metadata:
    max-request: 1
    verified: true
  name: Azure Virtual Machines - Cloud Enumeration
  severity: info
  tags: cloud,cloud-enum,azure,fuzz,enum,dns,discovery
self-contained: true
variables:
  BaseDNS: cloudapp.azure.com
  regionname:
  - eastasia
  - southeastasia
  - centralus
  - eastus
  - eastus2
  - westus
  - northcentralus
  - southcentralus
  - northeurope
  - westeurope
  - japanwest
  - japaneast
  - brazilsouth
  - australiaeast
  - australiasoutheast
  - southindia
  - centralindia
  - westindia
  - canadacentral
  - canadaeast
  - uksouth
  - ukwest
  - westcentralus
  - westus2
  - koreacentral
  - koreasouth
  - francecentral
  - francesouth
  - australiacentral
  - australiacentral2
  - southafricanorth
  - southafricawest
