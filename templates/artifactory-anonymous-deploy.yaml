id: artifactory-anonymous-deploy
info:
  author: panch0r3d
  name: Artifactory repos with anonymous deploy permissions (https://www.errno.fr/artifactory/Attacking_Artifactory.html)
  severity: high
requests:
- extractors:
  - part: body
    regex:
    - (repoTypesList).*?["].*["]
    - (repoList).*?["].*["]
    type: regex
  headers:
    User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:43.0) Gecko/20100101 Firefox/43.0
  matchers:
  - part: body
    regex:
    - (repoList).*?["].*["]
    - (repoTypesList).*?["].*["]
    type: regex
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/artifactory/ui/repodata?deploy=true'
