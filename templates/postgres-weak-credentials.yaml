id: postgres-weak-credentials
info:
  author: Ice3man
  description: 'Postgres service was accessed with easily guessed credentials.

    '
  metadata:
    max-request: 9
    shodan-query: port:5432
  name: Postgres - Default Logins
  severity: high
  tags: js,postgresql,default-login,network
javascript:
- args:
    Host: '{{Host}}'
    Pass: '{{passwords}}'
    Port: '5432'
    User: '{{usernames}}'
  attack: clusterbomb
  code: 'var m = require("nuclei/postgres");

    var c = m.PGClient();

    c.Connect(Host, Port, User, Pass);

    '
  matchers:
  - condition: and
    dsl:
    - response == true
    - success == true
    type: dsl
  payloads:
    passwords:
    - password
    - secret
    - admin
    - postgres
    usernames:
    - postgres
    - admin
  pre-condition: 'var m = require("nuclei/postgres");

    var c = m.PGClient();

    c.IsPostgres(Host, Port);

    '
  stop-at-first-match: true
