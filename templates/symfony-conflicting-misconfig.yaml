http:
- headers:
    Forwarded: for=127.0.0.1;host=oast.me
    X-Forwarded-Host: oast.me
  matchers:
  - part: body
    type: word
    words:
    - Symfony\Component\HttpFoundation\Exception\ConflictingHeadersException
  - status:
    - 500
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
id: symfony-conflicting-misconfig
info:
  author: wakedxy
  description: "A misconfiguration in Symfony\u2019s trusted proxy and header settings\
    \ could trigger a ConflictingHeadersException when both Forwarded and X-Forwarded-*\
    \ headers were present. When debug mode was enabled in production, this issue\
    \ could have exposed sensitive environment details such as SMTP credentials, application\
    \ paths, or system configuration.\n"
  metadata:
    max-request: 1
    shodan-query: http.title:"Symfony"
    verified: true
  name: Symfony Conflicting Headers - Information Disclosure
  reference:
  - https://symfony.com/doc/current/deployment/proxies.html
  - https://owasp.org/Top10/A05_2021-Security_Misconfiguration/
  severity: medium
  tags: misconfig,symfony,exposure,vuln
