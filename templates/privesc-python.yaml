code:
- engine:
  - sh
  - bash
  source: 'whoami

    '
- engine:
  - sh
  - bash
  source: 'python -c ''import os; os.system("whoami")''

    '
- engine:
  - sh
  - bash
  source: 'sudo python -c ''import os; os.system("whoami")''

    '
- engine:
  - sh
  - bash
  matchers:
  - negative: true
    part: code_1_response
    type: word
    words:
    - root
  - condition: or
    dsl:
    - contains(code_2_response, "root")
    - contains(code_3_response, "root")
    - contains(code_4_response, "root")
    type: dsl
  matchers-condition: and
  source: 'python -c ''import os; os.setuid(0); os.system("whoami")''

    '
id: privesc-python
info:
  author: daffainfo
  description: 'Python is a high-level, general-purpose programming language known
    for its readability and simplicity. It is widely used for web development, scientific
    computing, artificial intelligence, and system automation. Python''s versatility,
    extensive standard library, and large community make it a popular choice for a
    wide range of applications.

    '
  metadata:
    max-request: 4
    verified: true
  name: PHP - Privilege Escalation
  reference:
  - https://gtfobins.github.io/gtfobins/python/
  severity: high
  tags: code,linux,php,privesc,local
self-contained: true
