http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/json")
    - contains_all(body, "\"cameras\"", "\"version\"", "\"detectors\"")
    - contains_any(body, "\"mqtt\"", "\"frigate\"", "\"birdseye\"", "\"record\"")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/api/config'
id: frigate-api-exposure
info:
  author: 0x_Akoko
  description: 'Detected an exposed Frigate NVR API, potentially allowing unauthorized
    access to camera feeds, internal network configuration, and MQTT credentials.

    '
  metadata:
    fofa-query: title="Frigate"
    max-request: 1
    shodan-query: http.title:"Frigate"
    verified: true
  name: Frigate NVR - API Exposure
  reference:
  - https://frigate.video/
  - https://github.com/blakeblackshear/frigate
  severity: medium
  tags: frigate,nvr,iot,exposure,camera,config
