code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'requiresecuritysignature : 0'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'Get-ItemProperty -Path ''HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters''
    -Name ''RequireSecuritySignature''

    '
id: smb-signing-not-required
info:
  author: princechaddha
  description: Checks if SMB signing is not required, exposing SMB communications
    to man-in-the-middle attacks.
  impact: 'Not requiring SMB signing allows for tampering of data in transit, enabling
    man-in-the-middle attacks.

    '
  name: SMB Signing Not Required
  remediation: 'Configure SMB to require security signatures for communication.

    '
  severity: high
  tags: windows,smb,signing,code,windows-audit
self-contained: true
