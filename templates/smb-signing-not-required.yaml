id: smb-signing-not-required
info:
  author: pussycat0x
  description: 'Signing is not required on the remote SMB server. An unauthenticated,
    remote attacker can exploit this to conduct man-in-the-middle attacks against
    the SMB server.

    '
  metadata:
    max-request: 1
    shodan-query: port:445
    verified: true
  name: SMB Signing Not Required
  reference:
  - https://www.tenable.com/plugins/nessus/57608
  - https://nmap.org/nsedoc/scripts/smb2-security-mode.html
  severity: medium
  tags: js,network,smb,enum
javascript:
- args:
    Host: '{{Host}}'
    Pass: test
    Port: '445'
    User: test
  code: 'var m = require("nuclei/smb");

    var c = m.SMBClient();

    var response = c.ListSMBv2Metadata(Host, Port, User, Pass);

    to_json(response);

    '
  matchers:
  - condition: and
    type: word
    words:
    - '"SigningEnabled": true'
    - '"SigningRequired": false'
