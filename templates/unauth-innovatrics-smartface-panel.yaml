flow: http(1) && http(2)
http:
- host-redirects: true
  matchers:
  - condition: and
    dsl:
    - contains_all(body, '<title>Smartface')
    - 'contains(header, ''X-Powered-By: Express'')'
    - status_code == 200
    type: dsl
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, 'version', 'isCollectingData')
    internal: true
    type: dsl
  raw:
  - 'POST /-/graphql HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"query":"query getIsCollectingData {\n  isCollectingData\n}","operationName":"getIsCollectingData","variables":{}}

    '
id: unauth-innovatrics-smartface-panel
info:
  author: matejsmycka
  description: 'An unauthenticated SmartFace login was detected. The panel, used for
    facial recognition from video streams, allowed attackers to extract camera connection
    strings and other sensitive information

    '
  metadata:
    max-request: 1
    shodan-query: http.favicon.hash:-1410437493
  name: Unauthenticated SmartFace Panel - Detect
  reference:
  - https://www.innovatrics.com/face-recognition-solutions/
  severity: medium
  tags: panel,smartface,login,detect,vuln
