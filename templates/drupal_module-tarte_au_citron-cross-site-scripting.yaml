http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '>=2.0.0 <= 2.0.5')
    type: dsl
  matchers:
  - condition: and
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - condition: and
    status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - tarte_au_citron
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/tarte_au_citron/tarte_au_citron.info'
  redirects: true
id: drupal_module-tarte_au_citron-cross-site-scripting
info:
  author: me
  description: This module integrates Tarte au citron JS library with Drupal and prevent
    services to be loaded without user consent. Administrators can enable and configure
    services which will be managed by Tarte au citron. When Google Tag Manager (GTM)
    service is enabled, an attacker can load a GTM container that can completely change
    the page or insert malicious JS.  This vulnerability is mitigated by the fact
    that the attacker must have a role with the permission administer tarte au citron.
  metadata:
    created_at: '2025-01-09'
    fofa-query: /sites/all/modules/tarte_au_citron/
    google-query: inurl:'/sites/all/modules/tarte_au_citron/
    impact: medium
    security-risk: "Moderately critical 13\u2009\u2215\u200925 AC:Basic/A:Admin/CI:Some/II:Some/E:Theoretical/TD:All"
    type: indicator
    vulnerability: cross-site-scripting
  name: drupal_module-tarte_au_citron-cross-site-scripting
  reference:
  - https://www.drupal.org/sa-contrib-2024-064
  severity: medium
  tags: drupal
