http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "text/html")
    - contains_all(body, "window.REDUX_STATE", "window.AdminBro", "\"session\":null",
      "\"resources\":[")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/admin'
  - '{{BaseURL}}/admin/'
  stop-at-first-match: true
id: adminbro-dashboard-exposure
info:
  author: 0x_Akoko
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
    cvss-score: 8.2
    cwe-id: CWE-306
  description: 'Detected AdminBro/AdminJS admin panel was exposed without authentication,
    allowing unauthenticated users to access the admin dashboard and potentially view,
    modify, or delete sensitive data. This misconfiguration occurred when developers
    used buildRouter() instead of buildAuthenticatedRouter().

    '
  metadata:
    max-request: 2
    verified: true
  name: AdminBro Dashboard - Unauthenticated Access
  reference:
  - https://docs.adminjs.co/basics/authentication
  - https://github.com/SoftwareBrothers/adminjs
  severity: high
  tags: adminbro,adminjs,misconfig,exposure,unauth,panel
