http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - backupbuddy
  - dsl:
    - compare_versions(version, '>= 8.5.8.0', '<= 8.7.4.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/backupbuddy/readme.txt'
  redirects: true
id: CVE-2022-31474-9e0957a74fe3519f94643705095b30b7
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-31474
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
  description: 'The BackupBuddy plugin for WordPress is vulnerable to unauthenticated
    arbitrary file downloads via the ''local-download'' found in the backupbuddy_local_download()
    function in versions 8.5.8.0 to 8.7.4.1. This is due to a missing capability check
    and nonce check on the affected function that is called via an admin_init hook
    along with insufficient file path validation  on the supplied download file. This
    makes is possible for unauthenticated attackers to supply the complete path to
    a file, or use directory traversal techniques, to read any file hosted on the
    server. This includes sensitive files such as /etc/passwd and /wp-config.php.

    '
  metadata:
    fofa-query: wp-content/plugins/backupbuddy/
    google-query: inurl:"/wp-content/plugins/backupbuddy/"
    shodan-query: vuln:CVE-2022-31474
  name: 'BackupBuddy 8.5.8.0 - 8.7.4.1 - Arbitrary File Download

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/91221712-8f66-4c6f-94fb-75c34a7f1fa8?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,backupbuddy,high
