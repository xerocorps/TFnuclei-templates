id: iam-password-policy
info:
  author: princechaddha
  description: 'Retrieves the password policy for the AWS account. This tells you
    the complexity requirements and mandatory rotation periods for the IAM user passwords
    in your account.

    '
  name: AWS IAM Password Policy
  reference:
  - https://docs.aws.amazon.com/IAM/latest/APIReference/API_GetAccountPasswordPolicy.html
  - https://docs.aws.amazon.com/IAM/latest/APIReference/welcome.html
  remediation: Implementing a password policy can greatly decrease the likelihood
    of successful password-guessing and brute-force attacks
  severity: medium
  tags: aws,amazon,cloud,iam
requests:
- extractors:
  - dsl:
    - '"Missing AWS IAM user password policy"'
    type: dsl
  matchers:
  - condition: and
    type: word
    words:
    - NoSuchEntity
    - Password Policy
  matchers-condition: and
  raw:
  - 'POST https://{{service}}.amazonaws.com HTTP/1.1

    Host: {{service}}.amazonaws.com

    Accept-Encoding: gzip, deflate

    Content-Type: application/x-www-form-urlencoded; charset=utf-8

    User-Agent: aws-cli/2.9.15 Python/3.11.1 Darwin/21.6.0 source/arm64 prompt/off
    command/iam.get-account-password-policy


    Action=GetAccountPasswordPolicy&Version=2010-05-08

    '
self-contained: true
signature: aws
variables:
  region: us-east-1
  service: iam
