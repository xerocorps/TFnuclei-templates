http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '8.x-1.9')
    - compare_versions(version, '8.x-1.8')
    - compare_versions(version, '8.x-1.7')
    - compare_versions(version, '8.x-1.6')
    - compare_versions(version, '8.x-1.5')
    - compare_versions(version, '8.x-1.4')
    - compare_versions(version, '8.x-1.3')
    - compare_versions(version, '8.x-1.2')
    - compare_versions(version, '8.x-1.1')
    - compare_versions(version, '8.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - jsonapi
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/jsonapi/jsonapi.info'
  redirects: true
id: drupal_module-jsonapi-multiple-vulnerabilities
info:
  author: Bishopfox
  description: 'This module provides a JSON API standards-compliant API for accessing
    and manipulating Drupal content and configuration entities.  The module doesnt
    sufficiently associate cacheability metadata in certain situations thereby causing
    an access bypass vulnerability. This vulnerability is mitigated by the fact that
    an attacker cannot trigger an exploitable situation themselves.   The module doesnt
    sufficiently check access in certain situations. This vulnerability is mitigated
    by the fact that an attacker must have permission to create entities of certain
    content entity types.    Update: This is fixed in 8.x-1.10 not 8.x-1.9'
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/jsonapi/
    google-query: inurl:'/sites/all/modules/jsonapi/
    impact: medium
    security-risk: "Moderately critical 13\u221525 AC:Complex/A:User/CI:Some/II:Some/E:Theoretical/TD:All"
    type: indicator
    vulnerability: multiple-vulnerabilities
  name: drupal_module-jsonapi-multiple-vulnerabilities
  reference:
  - https://www.drupal.org/sa-contrib-2018-015
  severity: medium
  tags: drupal
