http:
- matchers:
  - condition: and
    regex:
    - ^remote\s*=\s*
    - ^\[(.*?)\]$
    type: regex
  method: GET
  path:
  - '{{BaseURL}}{{paths}}'
  payloads:
    paths:
    - /deployment.ini
    - /deploy.ini
    - /production.ini
    - /prod.ini
    - /deployment.production.ini
    - /deployment.prod.ini
    - /deploy.production.ini
    - /deploy.prod.ini
    - /server.ini
    - /ftp.ini
    - /ftps.ini
    - /sftp.ini
  stop-at-first-match: true
id: deployment-ini
info:
  author: Michal Mikolas (nanuqcz)
  description: 'Config file for "FTP deployment" utility usually contains server''s
    FTP credentials in plain text.

    '
  metadata:
    max-request: 12
    product: ftp-deployment
    vendor: dg
  name: FTP Deployment Config File - Exposure
  reference:
  - https://github.com/dg/ftp-deployment
  remediation: 'Delete the config file from server & add it to `ignore` section of
    the deployment file. Or block access to the file using `.htaccess` on the server.

    '
  severity: medium
  tags: config,exposure,dg,vuln
