http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - envira-gallery-lite
  - dsl:
    - compare_versions(version, '< 1.8.3.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/envira-gallery-lite/readme.txt'
  redirects: true
id: CVE-2021-24126-envira_gallery_lite-98361cfd-1277-43fd-b0da-db2549628383
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24126
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
  description: 'Unvalidated input and lack of output encoding in the Envira Gallery
    Lite WordPress plugin, versions before 1.8.3.3, did not properly sanitise the
    images metadata (namely title) before outputting them in the generated gallery,
    which could lead to privilege escalation.

    '
  metadata:
    fofa-query: wp-content/plugins/envira-gallery-lite/
    google-query: inurl:"/wp-content/plugins/envira-gallery-lite/"
    shodan-query: http.html:"wp-content/plugins/envira-gallery-lite/"
  name: 'Envira Gallery Lite <= 1.8.3.2 - Cross-Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/98361cfd-1277-43fd-b0da-db2549628383?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,envira-gallery-lite,medium,production
