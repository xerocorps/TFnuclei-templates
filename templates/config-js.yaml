id: config-js
info:
  author: geeknik
  name: config.js
  severity: high
requests:
- matchers:
  - status:
    - 200
    type: status
  - condition: or
    type: word
    words:
    - 'accessKey: '
    - 'secreKey: '
    - 'apiKey: '
    - '"client_secret": '
    - mongodb+srv://
  - condition: or
    part: header
    type: word
    words:
    - text/plain
    - text/javascript
    - application/javascript
    - application/x-javascript
  - negative: true
    part: header
    type: word
    words:
    - text/html
  - condition: or
    negative: true
    part: body
    type: word
    words:
    - <html
    - window.location = x
    - can not find config.js
    - function _popwnd_open
    - window.dataLayer
    - console.log(
    - window.location
    - Unknown Host
    - <h1
    - 'Error 404: Error not found'
    - SERVICE_NOT_EXIST
    - <p>
    - Static content proxy
    - ABORTED
    - // Cedexis Inc.
    - This is a placeholder.
    - Counting any requests
    - ': 409,'
    - No action executes!
  - dsl:
    - len(body) > 50 && len(body) < 16384
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/config.js'
  - '{{BaseURL}}/api/config.js'
  - '{{BaseURL}}/app/config.js'
  - '{{BaseURL}}/config/config.js'
  - '{{BaseURL}}/web/config.js'
  - '{{BaseURL}}/src/config.js'
  - '{{BaseURL}}/src/api/config.js'
  - '{{BaseURL}}/web/api/config.js'
