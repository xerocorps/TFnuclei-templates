expression: html0() && html1() && html2() && html3() || php0() && php1() && php2()
  && php3()
id: phpstudy-nginx-wrong-resolve
info:
  author: LoRexxar(https://lorexxar.cn),0h1in9e(https://www.ohlinge.cn)
  name: Phpstudy Nginx Wrong Resolve
  severity: high
rules:
  html0:
    expression: response.status != 200
    request:
      method: GET
      path: /{{name}}.php
  html1:
    expression: response.status == 200 && response.headers["server"].contains("nginx")
    request:
      method: GET
      path: /index.html
  html2:
    expression: response.status == 200 && response.headers["server"].contains("nginx")
    request:
      method: GET
      path: /index.html/.php
  html3:
    expression: response.status != 200
    request:
      method: GET
      path: /index.html/.xxx
  php0:
    expression: response.status != 200
    request:
      method: GET
      path: /{{name}}.php
  php1:
    expression: response.status == 200 && response.headers["server"].contains("nginx")
    request:
      method: GET
      path: /index.php
  php2:
    expression: response.status == 200 && response.headers["server"].contains("nginx")
    request:
      method: GET
      path: /index.php/.php
  php3:
    expression: response.status != 200
    request:
      method: GET
      path: /index.php/.xxx
set:
  name: randomInt(10000000, 99999999)
