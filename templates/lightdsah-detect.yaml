http:
- extractors:
  - attribute: src
    internal: true
    name: index_js
    type: xpath
    xpath:
    - /html/head/script[1]
  matchers:
  - status:
    - 200
    type: status
  - condition: and
    type: word
    words:
    - lightdash
    - https://docs.lightdash.com/
  matchers-condition: and
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/'
  - '{{BaseURL}}{{index_js}}'
  - '{{BaseURL}}/{{index_js}}'
- extractors:
  - json:
    - .results.version
    type: json
  matchers:
  - status:
    - 200
    type: status
  - condition: and
    type: word
    words:
    - '"status"'
    - '"ok"'
  matchers-condition: and
  path:
  - '{{ BaseURL }}api/v1/health'
  - '{{ BaseURL }}/api/v1/health'
id: lightdsah-detect
info:
  author: Esonhugh-self-maintained
  description: 'lightdash has an api endpoint to read slack image but it can abused
    to read arbitray file

    '
  metadata:
    fofa: lightdash
  name: lightdash version detect
  severity: info
  tags: lightdash
