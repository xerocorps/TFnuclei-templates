code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - Password reset from lock screen is enabled.
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'if ((Get-ItemProperty -Path ''HKLM:\SOFTWARE\Policies\Microsoft\Windows\System''
    -Name ''DisablePasswordReset'' -ErrorAction SilentlyContinue).DisablePasswordReset
    -eq 0) { "Password reset from lock screen is enabled." }

    '
id: password-reset-lock-screen-enabled
info:
  author: princechaddha
  description: Checks if password reset options are available on the lock screen,
    which can lead to unauthorized access.
  impact: 'Allowing password resets from the lock screen could permit attackers to
    reset passwords without authorization.

    '
  name: Password Reset from Lock Screen Enabled
  remediation: 'Disable password reset options on the lock screen.

    '
  severity: medium
  tags: password,code,windows-audit
self-contained: true
