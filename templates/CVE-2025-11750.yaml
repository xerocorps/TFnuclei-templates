flow: http(1) && http(2)
http:
- host-redirects: true
  matchers:
  - condition: and
    dsl:
    - contains(body, "<title>Dify")
    - status_code == 200
    internal: true
    type: dsl
  max-redirects: 2
  raw:
  - 'GET /signin HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - contains_all(body, "account_not_found", "message")
    - contains(content_type, "application/json")
    - status_code == 400
    type: dsl
  raw:
  - 'POST /console/api/login HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"email":"{{fake_email}}","password":"{{fake_password}}","language":"en-EN","remember_me":true}

    '
id: CVE-2025-11750
info:
  author: Kazgangap
  description: 'A user enumeration vulnerability exists in langgenius/dify, where
    the login API leaks information about whether a user account exists or not. When
    an invalid/non-existent email is used during login, the API returns a distinct
    error message such as "account_not_found" or "Account not found.", allowing attackers
    to identify valid accounts.

    '
  impact: 'Attackers can enumerate valid user accounts through distinct error messages
    returned by the login API, facilitating targeted credential stuffing and phishing
    attacks against Dify installations.

    '
  metadata:
    fofa-query: icon_hash="97378986"
    product: dify
    shodan-query: http.favicon.hash:"97378986"
    vendor: langgenius
    verified: true
  name: Dify - User Enumeration via "Account not found" Message
  reference:
  - https://huntr.com/bounties/e7359f9f-c004-4304-9de9-753622d370a1
  - https://github.com/Kazgangap/cve-poc-garage/blob/main/2025/CVE-2025-11750.md
  - https://github.com/langgenius/dify/issues/24323
  - https://github.com/langgenius/dify/pull/25369
  remediation: 'Upgrade to the patched version of Dify that implements generic error
    messages for authentication failures.

    '
  severity: medium
  tags: cve,cve2025,langgenius,dify,user-enum,vuln
variables:
  fake_email: '{{to_lower(rand_text_alphanumeric(16))}}@{{to_lower(rand_text_alphanumeric(16))}}.com'
  fake_password: '{{rand_text_alphanumeric(16)}}'
