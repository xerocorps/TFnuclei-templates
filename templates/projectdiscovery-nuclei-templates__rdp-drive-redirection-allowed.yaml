code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'fDisableCdm  : 0'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'New-ItemProperty -Path ''HKLM:\Software\Policies\Microsoft\Windows NT\Terminal
    Services'' -Name ''fDisableCdm'' -Value 1 -PropertyType ''DWord''

    '
id: rdp-drive-redirection-allowed
info:
  author: princechaddha
  description: Checks if Remote Desktop users are allowed to redirect local drives,
    which can pose a security risk.
  impact: 'Allowing drive redirection during remote desktop sessions can expose sensitive
    files and data to remote users.

    '
  name: Remote Desktop Users Can Redirect Drives
  remediation: 'Disable drive redirection in Remote Desktop settings.

    '
  severity: medium
  tags: rdp,drive-redirection,code,windows-audit
self-contained: true
