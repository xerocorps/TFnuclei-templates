file:
- extensions:
  - all
  matchers:
  - case-insensitive: true
    condition: and
    type: word
    words:
    - SetWindowsHookEx
    - WH_KEYBOARD_LL
  - case-insensitive: true
    condition: and
    type: word
    words:
    - SetWindowsHookEx
    - WH_KEYBOARD
  - case-insensitive: true
    condition: and
    type: word
    words:
    - WH_KEYBOARD
    - WH_KEYBOARD_LL
  matchers-condition: or
id: malware_cap_hookexkeylogger
info:
  author: daffainfo
  name: CAP HookExKeylogger Malware Detector
  reference: https://github.com/Yara-Rules/rules/blob/master/malware/MALW_CAP_HookExKeylogger.yar
  severity: critical
  tags: malware,file
