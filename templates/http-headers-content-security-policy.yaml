http:
- host-redirects: true
  matchers:
  - condition: and
    dsl:
    - '!regex(''(?i)content-security-policy'', header)'
    - status_code != 301 && status_code != 302
    name: content-security-policy
    type: dsl
  matchers-condition: or
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}'
id: http-headers-content-security-policy
info:
  author: nvsecurity
  description: 'The website is missing the `Content-Security-Policy` security header.
    The lack of this header *could* allow an attacker to inject arbitrary JavaScript
    into the page.

    '
  metadata:
    max-request: 1
  name: Missing HTTP Header - Content-Security-Policy
  reference:
  - https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#content-security-policy-csp
  - https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy
  severity: low
  tags: misconfig,headers
