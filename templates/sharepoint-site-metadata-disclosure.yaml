http:
- headers:
    Accept: application/json;odata=verbose
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, "__metadata","WelcomePage") || contains_all(body, "ServerRelativeUrl","Upgrading")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/_api/site'
  - '{{BaseURL}}/_api/web'
id: sharepoint-site-metadata-disclosure
info:
  author: 0x_Akoko
  description: 'Detected exposed SharePoint site metadata endpoints.

    '
  metadata:
    fofa-query: title="SharePoint"
    max-request: 2
    shodan-query: http.title:"SharePoint"
    verified: true
  name: Microsoft SharePoint - Site Metadata Disclosure
  reference:
  - https://learn.microsoft.com/en-us/sharepoint/dev/sp-add-ins/get-to-know-the-sharepoint-rest-service
  - https://medium.com/@ujmalhotra95/tales-of-sharepoint-api-misconfigurations-11073ad384fd
  severity: low
  tags: sharepoint,microsoft,exposure,misconfig
