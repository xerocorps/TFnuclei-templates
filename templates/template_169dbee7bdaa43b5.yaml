name: add labels
true:
  issues:
    types:
    - labeled
jobs:
  check-issues:
    env:
      PAYLOAD: ${{toJSON(github.event)}}
    if: contains(github.event.issue.title,'[') && contains(github.event.issue.title,']')
      && github.event.sender.login == 'cn-kali-team' && github.event.label.name ==
      'Reviewed'
    runs-on: ubuntu-latest
    steps:
    - name: Check out code
      uses: actions/checkout@master
      with:
        fetch-depth: 0
        persist-credentials: false
    - id: issue_helper
      name: Check Issue
      run: 'python .github/scripts/issue_helper.py > /tmp/verify.log

        echo "::set-output name=changes::$(git status -s | wc -l)"

        '
    - if: steps.issue_helper.outputs.changes > 0
      name: Commit files
      run: 'git config --local user.email "action@github.com"

        git config --local user.name "GitHub Action"

        git add .

        git commit -m "Auto Update FingerPrint [$(date)] :robot:" -a

        '
    - if: steps.issue_helper.outputs.changes > 0
      name: Push changes
      uses: ad-m/github-push-action@master
      with:
        branch: ${{ github.ref }}
        github_token: ${{ secrets.GITHUB_TOKEN }}
    - name: Create Pending Review Comment
      uses: actions-cool/issues-helper@v3
      with:
        actions: create-comment,close-issue
        body: "## \u5BA1\u6838\u901A\u8FC7:\n- \u6307\u7EB9\u89C4\u5219\u5DF2\u7ECF\
          \u5408\u5E76\uFF0C\u611F\u8C22\u63D0\u4EA4\u3002"
        issue-number: ${{ github.event.issue.number }}
        token: ${{ secrets.GITHUB_TOKEN }}
