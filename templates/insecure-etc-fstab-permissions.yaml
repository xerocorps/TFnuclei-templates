code:
- engine:
  - sh
  - bash
  matchers:
  - status:
    - 0
    type: status
  - negative: true
    regex:
    - ^-rw-r--r--\s+\d+\s+root\s+\w+
    type: regex
  matchers-condition: and
  source: 'ls -l /etc/fstab 2>&1

    '
id: insecure-etc-fstab-permissions
info:
  author: geeknik
  description: 'Validates permissions on the /etc/fstab file that defines how disk
    partitions and filesystems are mounted on macOS.

    '
  impact: 'Insecure permissions on /etc/fstab could allow unauthorized users to modify
    the file and mount malicious filesystems.

    '
  name: macOS Insecure /etc/fstab Permissions
  remediation: 'Ensure that the /etc/fstab file is owned by root with a system group
    (wheel, admin, etc.) and has permissions of 0644 or more restrictive.

    '
  severity: high
  tags: macos,audit,local,security
self-contained: true
