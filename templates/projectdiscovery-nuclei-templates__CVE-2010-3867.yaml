id: CVE-2010-3867
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:proftpd:proftpd:1.2.10:*:*:*:*:*:*:*
    cve-id: CVE-2010-3867
    cvss-metrics: CVSS:2.0/AV:N/AC:H/Au:S/C:C/I:C/A:C
    cvss-score: 7.1
    cwe-id: CWE-22
    epss-percentile: 0.40822
    epss-score: 0.00187
  description: 'ProFTPD versions before 1.3.3c contain directory traversal vulnerabilities
    in the mod_site_misc module. The vulnerability allows attackers to traverse directories
    and potentially overwrite arbitrary files on the system through crafted input
    to commands like SITE MKDIR and other SITE commands.

    '
  impact: 'Authenticated attackers can exploit directory traversal in mod_site_misc
    module through SITE MKDIR and other SITE commands to traverse directories and
    overwrite arbitrary files on the ProFTPD server.

    '
  metadata:
    max-request: 1
    product: proftpd
    shodan-query:
    - product:"proftpd"
    - cpe:"cpe:2.3:a:proftpd:proftpd"
    vendor: proftpd
    verified: true
  name: ProFTPD < 1.3.3c - Directory Traversal via mod_site_misc
  reference:
  - http://bugs.proftpd.org/show_bug.cgi?id=3519
  - http://lists.fedoraproject.org/pipermail/package-announce/2010-November/050687.html
  - http://lists.fedoraproject.org/pipermail/package-announce/2010-November/050703.html
  - http://lists.fedoraproject.org/pipermail/package-announce/2010-November/050726.html
  - http://slackware.com/security/viewer.php?l=slackware-security&y=2010&m=slackware-security.498209
  remediation: 'Update ProFTPD to version 1.3.3c or later that properly validates
    paths in mod_site_misc module and prevents directory traversal attacks.

    '
  severity: high
  tags: cve,cve2010,network,ftp,proftpd,tcp,passive,lfi,vuln
tcp:
- extractors:
  - group: 1
    name: version
    regex:
    - ProFTPD ([0-9.a-z]+)
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: 0
    type: hex
  matchers:
  - condition: and
    dsl:
    - contains(raw, 'ProFTPD')
    - compare_versions(version, '< 1.3.3c')
    type: dsl
  port: 21
  read-size: 1024
