http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - donate-with-qrcode
  - dsl:
    - compare_versions(version, '<= 1.4.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/donate-with-qrcode/readme.txt'
  redirects: true
id: CVE-2021-24618-donate_with_qrcode-9a4c327c-f756-4f50-8121-363791c6bd8c
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24618
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
  description: 'The Donate With QRCode WordPress plugin before 1.4.5 does not sanitise
    or escape its QRCode Image setting, which result into a Stored Cross-Site Scripting
    (XSS). Furthermore, the plugin also does not have any CSRF and capability checks
    in place when saving such setting, allowing any authenticated user (as low as
    subscriber), or unauthenticated user via a CSRF vector to update them and perform
    such attack.

    '
  metadata:
    fofa-query: wp-content/plugins/donate-with-qrcode/
    google-query: inurl:"/wp-content/plugins/donate-with-qrcode/"
    shodan-query: http.html:"wp-content/plugins/donate-with-qrcode/"
  name: 'Donate With QRCode <= 1.4.4 - Authenticated (Subscriber+) Stored Cross-Site
    Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/9a4c327c-f756-4f50-8121-363791c6bd8c?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,donate-with-qrcode,low,production
