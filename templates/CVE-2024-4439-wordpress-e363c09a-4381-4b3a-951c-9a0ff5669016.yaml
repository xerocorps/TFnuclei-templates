http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 6.5', '<= 6.5.1')
    - compare_versions(version_by_js, '>= 6.5', '<= 6.5.1')
    - compare_versions(version_by_css, '>= 6.5', '<= 6.5.1')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2024-4439-wordpress-e363c09a-4381-4b3a-951c-9a0ff5669016
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-4439
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
  description: 'WordPress Core is vulnerable to Stored Cross-Site Scripting via user
    display names in the Avatar block in various versions up to 6.5.2 due to insufficient
    output escaping on the display name. This makes it possible for authenticated
    attackers, with contributor-level access and above, to inject arbitrary web scripts
    in pages that will execute whenever a user accesses an injected page. In addition,
    it also makes it possible for unauthenticated attackers to inject arbitrary web
    scripts in pages that have the comment block present and display the comment author''s
    avatar.

    '
  metadata:
    shodan-query: vuln:CVE-2024-4439
  name: 'WordPress Core < 6.5.2 - Unauthenticated & Authenticated (Contributor+) Stored
    Cross-Site Scripting via Avatar Block

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/e363c09a-4381-4b3a-951c-9a0ff5669016?source=api-prod
  severity: low
  tags: cve,wordpress,wp-core,low,production
