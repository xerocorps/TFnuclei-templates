http:
- fuzzing:
  - fuzz:
    - '{{ldap}}'
    mode: single
    part: query
    type: replace
  matchers:
  - condition: or
    type: word
    words:
    - A constraint violation occurred
    - An inappropriate matching occurred
    - com.sun.jndi.ldap
    - Invalid DN syntax
    - javax.naming.NameNotFoundException
    - Bad search filter
    - LDAPException
    - No Such Object
    - Object does not exist
    - Protocol error occurred
    - Results returned are too large
    - 'Search: Operations error in'
    - Size limit has exceeded
    - The alias is invalid
    - The distinguished name has an invalid syntax
    - The search filter cannot be recognized
    - The search filter is incorrect
    - The search filter is invalid
    - The server does not handle directory requests
    - The syntax is invalid
    - There was a naming violation
    - There was an object class violation
    - 'Undefined index: cn'
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}'
  payloads:
    ldap:
    - '*)(&'
    - '!(()&&!|*|\'
    - ^(#$!@#$)(()))
    - '*))%00'
    - ")(cn=))\0"
    - '*()|&'''
  redirects: true
  stop-at-first-match: true
id: ldap-code-injection
info:
  author: reewardius
  name: LDAP Code Injection
  severity: critical
  tags: fuzzing-req,dast
