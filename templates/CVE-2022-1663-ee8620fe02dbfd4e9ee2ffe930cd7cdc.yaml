http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - stop-spam-comments
  - dsl:
    - compare_versions(version, '<= 0.2.1.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/stop-spam-comments/readme.txt'
  redirects: true
id: CVE-2022-1663-ee8620fe02dbfd4e9ee2ffe930cd7cdc
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-1663
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
  description: 'The Stop Spam Comments plugin for WordPress is vulnerable to protection
    mechanism bypass on the p_ssc_process() function in versions up to, and including,
    0.2.1.2 due to the method in which the spam comment key is generated and stored
    on the page. This makes it possible for attackers to easily scrape a web-page
    and continue to submit spam comments.

    '
  metadata:
    fofa-query: wp-content/plugins/stop-spam-comments/
    google-query: inurl:"/wp-content/plugins/stop-spam-comments/"
    shodan-query: vuln:CVE-2022-1663
  name: 'Stop Spam Comments <= 0.2.1.2 - Protection Mechanism Bypass

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/62061cf9-cdbf-4cb2-9890-36bdcbc65c21?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,stop-spam-comments,medium
