code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell.exe
  matchers:
  - type: word
    words:
    - Active Desktop enabled
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'if ((Get-ItemProperty -Path ''HKCU:\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer''
    -Name ''NoActiveDesktop'' -ErrorAction SilentlyContinue).NoActiveDesktop -eq 0)
    { Write-Output ''Active Desktop enabled''; }

    '
id: windows-active-desktop-enabled
info:
  author: princechaddha
  description: Checks if Active Desktop is enabled, which can be exploited to deliver
    malicious content.
  impact: 'Enabling Active Desktop allows attackers to inject malicious content or
    scripts.

    '
  name: Active Desktop Enabled
  remediation: 'Disable Active Desktop unless it''s specifically required.

    '
  severity: medium
  tags: windows,active-desktop,security,code,windows-audit
self-contained: true
