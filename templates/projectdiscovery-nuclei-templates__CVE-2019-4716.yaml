http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - var appVersion = "([0-9.]+)";
    type: regex
  host-redirects: true
  matchers:
  - condition: and
    dsl:
    - contains_any(body, "IBM Planning Analytics","IBM Cognos TM1")
    - compare_versions(version, '>= 2.0.0') && compare_versions(version, '<= 2.0.8')
    - status_code == 200
    type: dsl
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
id: CVE-2019-4716
info:
  author: 0x_Akoko
  classification:
    cpe: cpe:2.3:a:ibm:planning_analytics:*:*:*:*:*:*:*:*
    cve-id: CVE-2019-4716
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-94
    epss-percentile: 0.9965
    epss-score: 0.91546
  description: 'IBM Planning Analytics versions 2.0.0 through 2.0.8 are vulnerable
    to a configuration overwrite that allows an unauthenticated user to login as "admin",
    and then execute code as root or SYSTEM via TM1 scripting.

    '
  impact: 'Attackers can gain admin access and execute arbitrary code with SYSTEM
    privileges, leading to full system compromise.

    '
  metadata:
    max-request: 1
    product: planning_analytics
    shodan-query: title:"Arc for TM1"
    vendor: ibm
    verified: true
  name: IBM Planning Analytics - Authentication Bypass & Remote Code Execution Version
    Detection
  reference:
  - https://www.ibm.com/support/pages/node/1127781
  - https://nvd.nist.gov/vuln/detail/CVE-2019-4716
  - http://packetstormsecurity.com/files/156953/IBM-Cognos-TM1-IBM-Planning-Analytics-Server-Configuration-Overwrite-Code-Execution.html
  remediation: 'Update to the latest version or 2.0.9 or apply the security patches
    provided by IBM.

    '
  severity: critical
  tags: cve,cve2019,ibm,planning_analytics,passive,kev,vkev
