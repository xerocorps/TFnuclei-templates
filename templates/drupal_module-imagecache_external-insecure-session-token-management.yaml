http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '8.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - imagecache_external
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/imagecache_external/imagecache_external.info'
  redirects: true
id: drupal_module-imagecache_external-insecure-session-token-management
info:
  author: Bishopfox
  description: This module that allows you to store external images on your server
    and apply your own Image Styles. The module exposes cookies to external sites
    when making external image requests. This vulnerability is mitigated by using
    the whitelisted host feature to restrict external image requests from trusted
    sources.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/imagecache_external/
    google-query: inurl:'/sites/all/modules/imagecache_external/
    impact: medium
    security-risk: "Critical 15\u221525 AC:Complex/A:None/CI:Some/II:Some/E:Theoretical/TD:All"
    type: indicator
    vulnerability: insecure-session-token-management
  name: drupal_module-imagecache_external-insecure-session-token-management
  reference:
  - https://www.drupal.org/sa-contrib-2019-065
  severity: medium
  tags: drupal
