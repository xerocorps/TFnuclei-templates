http:
- matchers:
  - condition: and
    dsl:
    - contains_any(body, "main.DEBUG", "main.CRITICAL", "main.ERROR", "main.INFO")
    - contains_any(body, "Magento\\", "/vendor/magento/", "cache_invalidate", "Cron
      Job")
    - contains_any(content_type, "text/x-log")
    - status_code == 200
    type: dsl
  max-size: 500000
  method: GET
  path:
  - '{{BaseURL}}/var/log/debug.log'
id: magento-debug-log-exposure
info:
  author: 0x_Akoko
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-538
  description: 'Detected Magento debug.log file was publicly accessible. This file
    contained sensitive debugging information including full server paths, stack traces,
    customer activity, internal code paths, cache data, and cron job details.

    '
  metadata:
    max-request: 1
    verified: true
  name: Magento Debug Log - Exposure
  reference:
  - https://devdocs.magento.com/guides/v2.4/config-guide/log/log-intro.html
  severity: medium
  tags: magento,exposure,logs,misconfig
