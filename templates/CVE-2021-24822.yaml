http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - stylish-cost-calculator
  - dsl:
    - compare_versions(version, '<= 7.0.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/stylish-cost-calculator/readme.txt'
  redirects: true
id: CVE-2021-24822
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24822
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
  description: The Stylish Cost Calculator WordPress plugin before 7.0.4 does not
    have any authorisation and CSRF checks on some of its AJAX actions (available
    to authenticated users), which could allow any authenticated users, such as subscriber
    to call them, and perform Stored Cross-Site Scripting attacks against logged in
    admin, as well as frontend users due to the lack of sanitisation and escaping
    in some parameters
  metadata:
    fofa-query: wp-content/plugins/stylish-cost-calculator/
    google-query: inurl:"/wp-content/plugins/stylish-cost-calculator/"
    shodan-query: vuln:CVE-2021-24822
  name: Stylish Cost Calculator <= 7.0.3 - Stored Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/db84a782-d4c8-4abf-99ea-ea672a9b806e
  severity: medium
  tags: cve,wordpress,wp-plugin,stylish-cost-calculator,medium
