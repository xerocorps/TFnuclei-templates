headless:
- matchers:
  - part: body
    type: word
    words:
    - 'true'
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}'
  - action: waitload
  - action: script
    args:
      code: "() => {\n  var headers = document.getElementsByTagName('head')[0].childNodes;\n\
        \  var result = false;\n  headers.forEach(function(header) {\n    if (header.name\
        \ === 'X-Frame-Options' && header.content !== 'DENY') {\n      result = true;\n\
        \    }\n  });\n  return result;\n}\n"
      hook: true
  stop-at-first-match: true
id: clickjacking-detect
info:
  author: geeknik
  description: 'This template detects potential Clickjacking vulnerabilities. An attacker
    can trick a user into clicking on a concealed link, which can lead to unauthorized
    actions.

    '
  name: Clickjacking - Detect
  severity: low
  tags: clickjacking,headless
