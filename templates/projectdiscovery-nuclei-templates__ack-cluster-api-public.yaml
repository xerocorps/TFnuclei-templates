code:
- engine:
  - sh
  - bash
  matchers:
  - type: word
    words:
    - 'master_url":'
    - api_server_endpoint\":\"
  - negative: true
    type: word
    words:
    - api_server_endpoint\":\"\",
  matchers-condition: and
  source: 'aliyun cs GET /clusters --header "Content-Type=application/json;" --body
    "{}"

    '
id: ack-cluster-api-public
info:
  author: ritikchaddha
  description: 'Ensure that your ACK cluster''s API server is not publicly accessible
    in order to avoid exposing private data and minimizing security risks. The level
    of access to your Kubernetes API server depends on your application use cases,
    however, for most use cases, the Kubernetes API Server should be accessible only
    from within your Virtual Private Cloud (VPC).

    '
  metadata:
    max-request: 1
    verified: true
  name: Public Access to ACK Cluster's API Server - Enabled
  reference:
  - https://www.trendmicro.com/cloudoneconformity/knowledge-base/alibaba-cloud/AlibabaCloud-ACK/private-cluster.html
  severity: high
  tags: cloud,devops,aliyun,alibaba,aliyun-cloud-config,ack
self-contained: true
variables:
  region: cn-hangzhou
