code:
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"Azure Network Watcher is not enabled in all locations."'
    type: dsl
  matchers:
  - type: word
    words:
    - '[]'
  source: 'az network watcher list --query ''[*].{"location":location,"provisioningState":provisioningState,"resourceGroup":resourceGroup}''
    --output json

    '
id: azure-network-watcher
info:
  author: princechaddha
  description: 'Ensure that Azure Network Watcher service is enabled for all regions
    in your Microsoft Azure subscription to help monitor and diagnose conditions at
    the network level.

    '
  impact: 'Not having Azure Network Watcher enabled can prevent effective monitoring
    and diagnosing of network conditions, increasing the risk of network failures
    going undetected.

    '
  name: Azure Network Watcher Service Not Enabled
  reference:
  - https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-monitoring-overview
  remediation: 'Enable Azure Network Watcher in all regions of your Microsoft Azure
    subscription. Refer to Azure documentation on how to enable and manage Azure Network
    Watcher.

    '
  severity: high
  tags: cloud,devops,azure,microsoft,network-watcher,azure-cloud-config
self-contained: true
