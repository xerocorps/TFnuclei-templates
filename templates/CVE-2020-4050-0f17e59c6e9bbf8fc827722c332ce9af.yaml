http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 5.3', '<= 5.3.3')
    - compare_versions(version_by_js, '>= 5.3', '<= 5.3.3')
    - compare_versions(version_by_css, '>= 5.3', '<= 5.3.3')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2020-4050-0f17e59c6e9bbf8fc827722c332ce9af
info:
  author: topscoder
  classification:
    cve-id: CVE-2020-4050
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:N/I:L/A:N
    cvss-score: 3.5
  description: 'In affected versions of WordPress, misuse of the `set-screen-option`
    filter''s return value allows arbitrary user meta fields to be saved. It does
    require an admin to install a plugin that would misuse the filter. Once installed,
    it can be leveraged by low privileged users. This has been patched in version
    5.4.2, along with all the previously affected versions via a minor release (5.3.4,
    5.2.7, 5.1.6, 5.0.10, 4.9.15, 4.8.14, 4.7.18, 4.6.19, 4.5.22, 4.4.23, 4.3.24,
    4.2.28, 4.1.31, 4.0.31, 3.9.32, 3.8.34, 3.7.34).

    '
  metadata:
    shodan-query: vuln:CVE-2020-4050
  name: 'WordPress Core < 5.4.2 - Arbitrary User Meta Update

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/8746bd3a-6e2b-4ed2-9b21-4ed5a0e58de8?source=api-prod
  severity: low
  tags: cve,wordpress,wp-core,low
