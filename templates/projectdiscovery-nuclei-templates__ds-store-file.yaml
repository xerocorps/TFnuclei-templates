http:
- matchers:
  - condition: or
    dsl:
    - contains(hex_encode(body), '44534442')
    - contains(hex_encode(body), '0000000142756431')
    type: dsl
  - dsl:
    - "contains(to_lower(body), '\0<\0h\0t\0m\0l')"
    - "contains(to_lower(body), '\0<\0b\0o\0d\0y')"
    negative: true
    type: dsl
  - dsl:
    - status_code == 200
    type: dsl
  - condition: or
    dsl:
    - 'contains(to_lower(header), "accept-ranges: bytes")'
    - contains(to_lower(header), "octet-stream")
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/.DS_Store'
id: ds-store-file
info:
  author: 0w4ys,pwnhxl
  description: A .DS_Store file was found. This file may contain names of files that
    exist on the server, including backups or other files that aren't meant to be
    publicly available.
  metadata:
    max-request: 1
  name: DS_Store File - Exposed
  reference:
  - https://github.com/lijiejie/ds_store_exp
  severity: info
  tags: exposure,files,ds_store,config,vuln
