code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - '0'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'Get-ItemProperty -Path ''HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System''
    -Name ''DontDisplayLastUserName''

    '
id: display-last-username-enabled
info:
  author: princechaddha
  description: Verifies if the system displays the last logged-in username, which
    may aid unauthorized access attempts.
  impact: 'Displaying the last user name on the login screen can assist attackers
    in targeting accounts.

    '
  name: Do Not Display Last User Name Disabled
  remediation: 'Enable the policy to hide the last logged-in username.

    '
  severity: medium
  tags: login,username,code,windows-audit
self-contained: true
