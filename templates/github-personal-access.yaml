flow: http(1) && http(2)
http:
- extractors:
  - internal: true
    name: token
    part: body
    regex:
    - \b(ghp_[a-zA-Z0-9]{36})\b
    type: regex
  method: GET
  path:
  - '{{BaseURL}}'
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"login":'
    - '"avatar_url":'
  raw:
  - '@Host: https://api.github.com:443

    GET /user HTTP/1.1

    Host: api.github.com

    Authorization: Basic {{base64(''user:'' + token)}}

    '
  self-contained: true
id: github-personal-access
info:
  author: DhiyaneshDK
  metadata:
    max-request: 1
    verified: true
  name: GitHub Personal Access Token
  reference:
  - https://github.com/praetorian-inc/noseyparker/blob/main/crates/noseyparker/data/default/builtin/rules/github.yml
  - https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/about-authentication-to-github
  - https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token
  - https://github.blog/2021-04-05-behind-githubs-new-authentication-token-formats/
  severity: high
  tags: github,token,exposure
