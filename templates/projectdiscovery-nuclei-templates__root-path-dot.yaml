code:
- engine:
  - sh
  matchers:
  - part: response
    type: word
    words:
    - dot-in-path
  source: 'echo $PATH | grep -Eq ''(^\.?:|:.:|:\.$|^\.$)'' && echo "dot-in-path" ||
    echo "safe-path"

    '
id: root-path-dot
info:
  author: songyaeji
  description: "root user\u2019s PATH environment variable included the current directory\
    \ (\u201C.\u201D).This allowed scripts or binaries in the working directory to\
    \ be executed with root privileges. The misconfiguration resulted in potential\
    \ privilege escalation and unsafe behavior.\n"
  metadata:
    verified: true
  name: Root PATH Contains Current Directory
  reference:
  - https://isms.kisa.or.kr/main/csap/notice/
  - https://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/
  severity: high
  tags: local,linux,audit,privesc,kisa
self-contained: true
