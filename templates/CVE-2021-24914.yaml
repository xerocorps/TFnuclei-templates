http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - tawkto-live-chat
  - dsl:
    - compare_versions(version, '<= 0.6.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/tawkto-live-chat/readme.txt'
  redirects: true
id: CVE-2021-24914
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24914
    cvss-metrics: null
    cvss-score: null
  description: The Tawk.To Live Chat WordPress plugin before 0.6.0 does not have capability
    and CSRF checks in the tawkto_setwidget and tawkto_removewidget AJAX actions,
    available to any authenticated user. The first one allows low-privileged users
    (including simple subscribers) to change the 'tawkto-embed-widget-page-id' and
    'tawkto-embed-widget-widget-id' parameters. Any authenticated user can thus link
    the vulnerable website to their own Tawk.to instance. Consequently, they will
    be able to monitor the vulnerable website and interact with its visitors (receive
    contact messages, answer, ...). They will also be able to display an arbitrary
    Knowledge Base. The second one will remove the live chat widget from pages.
  metadata:
    fofa-query: wp-content/plugins/tawkto-live-chat/
    google-query: inurl:"/wp-content/plugins/tawkto-live-chat/"
    shodan-query: vuln:CVE-2021-24914
  name: Tawk.To Live Chat <= 0.5.4 - Missing Authorization to Visitor Monitoring &
    Chat Removal
  reference: null
  severity: high
  tags: cve,wordpress,wp-plugin,tawkto-live-chat,high
