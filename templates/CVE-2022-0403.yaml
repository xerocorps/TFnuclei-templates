http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - file-manager
  - dsl:
    - compare_versions(version, '<= 5.2.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/file-manager/readme.txt'
  redirects: true
id: CVE-2022-0403
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-0403
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: The Library File Manager WordPress plugin before 5.2.3 is using an
    outdated version of the elFinder library, which is known to be affected by security
    issues (CVE-2021-32682), and does not have any authorisation as well as CSRF checks
    in its connector AJAX action, allowing any authenticated users, such as subscriber
    to call it. Furthermore, as the options passed to the elFinder library does not
    restrict any file type, users with a role as low as subscriber can Create/Upload/Delete
    Arbitrary files and folders.
  metadata:
    fofa-query: wp-content/plugins/file-manager/
    google-query: inurl:"/wp-content/plugins/file-manager/"
    shodan-query: vuln:CVE-2022-0403
  name: Library File Manager <= 5.2.2 - Subscriber+ Arbitrary File Creation/Upload/Deletion
  reference:
  - https://wpscan.com/vulnerability/997a7fbf-98c6-453e-ad84-75c1e91d5a1e
  severity: high
  tags: cve,wordpress,wp-plugin,file-manager,high
