http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wpo365-login
  - dsl:
    - compare_versions(version, '<= 15.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wpo365-login/readme.txt'
  redirects: true
id: CVE-2021-43409-wpo365_login-cd552e86-5f0f-4203-b648-f069503b48e3
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-43409
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
  description: 'The WPO365 | LOGIN WordPress plugin (up to and including version 15.3)
    by wpo365.com is vulnerable to a persistent Cross-Site Scripting (XSS) vulnerability
    (also known as Stored or Second-Order XSS). Persistent XSS vulnerabilities occur
    when the application stores and retrieves client supplied data without proper
    handling of dangerous content. This type of XSS vulnerability is exploited by
    submitting malicious script content to the application which is then retrieved
    and executed by other application users. The attacker could exploit this to conduct
    a range of attacks against users of the affected application such as session hijacking,
    account take over and accessing sensitive data. In this case, the XSS payload
    can be submitted by any anonymous user, the payload then renders and executes
    when a WordPress administrator authenticates and accesses the WordPress Dashboard.
    The injected payload can carry out actions on behalf of the administrator including
    adding other administrative users and changing application settings. This flaw
    could be exploited to ultimately provide full control of the affected system to
    the attacker.

    '
  metadata:
    fofa-query: wp-content/plugins/wpo365-login/
    google-query: inurl:"/wp-content/plugins/wpo365-login/"
    shodan-query: http.html:"wp-content/plugins/wpo365-login/"
  name: 'WordPress + Microsoft Office 365 / Azure AD | LOGIN <= 15.3 - Stored Cross-Site
    Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/cd552e86-5f0f-4203-b648-f069503b48e3?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,wpo365-login,medium,production
