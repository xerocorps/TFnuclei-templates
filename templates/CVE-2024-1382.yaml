http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - nd-restaurant-reservations
  - dsl:
    - compare_versions(version, '< 1.9')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/nd-restaurant-reservations/readme.txt'
  redirects: true
id: CVE-2024-1382
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-1382
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: 'The Restaurant Reservations plugin for WordPress is vulnerable to
    Local File Inclusion in all versions up to, and including, 1.9 via the nd_rst_layout
    attribute of the nd_rst_search shortcode. This makes it possible for authenticated
    attackers, with contributor-level access and above, to include and execute arbitrary
    PHP files on the server, allowing the execution of any PHP code in those files.
    This can be used to bypass access controls, obtain sensitive data, or achieve
    code execution in cases where an uploaded PHP file may not be directly accessible.

    '
  metadata:
    fofa-query: wp-content/plugins/nd-restaurant-reservations/
    google-query: inurl:"/wp-content/plugins/nd-restaurant-reservations/"
    shodan-query: vuln:CVE-2024-1382
  name: 'Restaurant Reservations <= 1.9 - Directory Traversal to Authenticated (Contributor+)
    Local File Inclusion

    '
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/d51db160-c701-426d-890f-73cc4785cad8?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,nd-restaurant-reservations,high
