flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    name: token
    part: body
    regex:
    - xoxb-[0-9A-Za-z\\-]{52}
    - (xoxb-[0-9]{10,13}\-[0-9]{10,13}[a-zA-Z0-9-]*)
    type: regex
  method: GET
  path:
  - '{{BaseURL}}'
- disable-path-automerge: true
  extractors:
  - dsl:
    - token
    type: dsl
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, "team_id", "user_id", "bot_id")
    - contains(content_type, "application/json")
    type: dsl
  raw:
  - '@Host: https://slack.com:443

    POST /api/auth.test?pretty=1 HTTP/1.1

    Host: slack.com

    Origin: https://api.slack.com

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryDL3VHEC7cFaxeAhK


    ------WebKitFormBoundaryDL3VHEC7cFaxeAhK

    Content-Disposition: form-data; name="content"


    null

    ------WebKitFormBoundaryDL3VHEC7cFaxeAhK

    Content-Disposition: form-data; name="token"


    {{token}}

    ------WebKitFormBoundaryDL3VHEC7cFaxeAhK--

    '
id: slack-bot-token
info:
  author: nadino
  metadata:
    max-request: 1
    verified: true
  name: Slack Bot token
  reference:
  - https://api.slack.com/authentication/token-types
  severity: high
  tags: exposure,token,slack,vuln
