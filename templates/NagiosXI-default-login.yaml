http:
- extractors:
  - group: 1
    name: nagios_cookie
    part: header
    regex:
    - nagiosxi=([a-zA-Z0-9]+);
    type: regex
  - group: 1
    name: nsp_token
    regex:
    - type="hidden" value="(.*?)">
    type: regex
  method: GET
  path:
  - '{{BaseURL}}/nagiosxi/login.php'
- attack: pitchfork
  matchers:
  - part: body
    type: word
    words:
    - <b>Nagios XI</b>
  - status:
    - 302
    type: status
  matchers-condition: and
  payloads:
    password:
    - nagios
    username:
    - nagiosadmin
  raw:
  - 'POST /nagiosxi/login.php HTTP/1.1

    Host: {{Hostname}}

    Origin: {{BaseURL}}

    Content-Type: application/x-www-form-urlencoded

    Referer: {{BaseURL}}/nagiosxi/login.php

    Cookie: nagiosxi={{nagios_cookie}}


    nsp={{nsp_token}}&page=auth&debug=&pageopt=login&username={{username}}&password={{password}}&loginButton=

    '
id: NagiosXI-default-login
info:
  author: YashVardhanTripathi
  description: NagiosXI CMS Default Login Template.
  name: NagiosXI Default Login
  severity: high
