http:
- extractors:
  - group: 1
    regex:
    - (?m)"harbor_version":"([0-9.]+)",
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"auth_mode"'
    - '"harbor_version"'
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/api/v2.0/systeminfo'
id: harbor-detect
info:
  author: pikpikcu,daffainfo
  description: Harbor is an open source trusted cloud native registry project that
    stores, signs, and scans content.
  metadata:
    fofa-query: icon_hash=657337228
    max-request: 1
    product: harbor
    shodan-query: http.favicon.hash:657337228
    vendor: linuxfoundation
    verified: true
  name: Harbor Detect
  reference:
  - https://github.com/goharbor/harbor
  severity: info
  tags: tech,harbor,discovery
