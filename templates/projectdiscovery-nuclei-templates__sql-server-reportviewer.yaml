http:
- matchers:
  - condition: and
    dsl:
    - status_code_1 == 200 && status_code_2 != 401
    - contains(body, 'Data Source') && contains(body, 'SQL Server Reporting Services')
    type: dsl
  raw:
  - 'GET /Reports/Pages/Folder.aspx HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /ReportServer/Pages/Folder.aspx HTTP/1.1

    Host: {{Hostname}}

    '
id: sql-server-reportviewer
info:
  author: kazet
  classification:
    cpe: cpe:2.3:a:microsoft:sql_server:*:*:*:*:*:*:*:*
  description: SQL Server ReportViewer page exposed.
  metadata:
    google-query: inurl:"/Reports/Pages/Folder.aspx"
    max-request: 2
    product: sql_server
    vendor: microsoft
    verified: true
  name: SQL Server ReportViewer - Exposure
  reference:
  - https://learn.microsoft.com/en-us/sql/reporting-services/create-deploy-and-manage-mobile-and-paginated-reports?view=sql-server-ver16
  severity: high
  tags: misconfig,sql,report,exposure,vuln
