http:
- extractors:
  - dsl:
    - status_code
    name: TRACE method is Enabled
    type: dsl
  headers:
    Host: '{{Hostname}}'
  matchers:
  - negative: true
    status:
    - 405
    - 501
    - 404
    - 400
    type: status
  - part: body
    regex:
    - ^TRACE \S+ HTTP\/[0-9]\.[0-9]
    type: regex
  matchers-condition: and
  method: TRACE
  path:
  - '{{BaseURL}}'
- matchers:
  - name: CUSTOM method is allowed.
    negative: true
    status:
    - 405
    - 501
    - 404
    - 400
    type: status
  raw:
  - '{{to_upper(rand_text_alpha(4))}} {{BaseURL}} HTTP/1.1

    Host: {{Hostname}}

    '
id: ASVS-4-0-3-V14-5-1
info:
  author: Hamed Salimian
  classification:
    cwe-id: CWE-749
  description: 'Verify that the application server only accepts the HTTP methods in
    use by the application/API, including pre-flight OPTIONS, and logs/alerts on any
    requests that are not valid for the application context.

    '
  name: ASVS 14.5.1 Check
  reference:
  - https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/06-Test_HTTP_Methods.html
  severity: low
  tags: asvs,14.5.1
