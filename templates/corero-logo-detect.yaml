id: corero-logo-detect
info:
  author: c-sh0
  metadata:
    shodan-query:
    - http.favicon.hash:1134048212
    - http.favicon.hash:-1294635231
  name: Corero Network Security Inc. logo detection
  reference:
  - https://www.corero.com
  severity: info
  tags: tech,corero,ddos,favicon
requests:
- matchers:
  - condition: or
    dsl:
    - status_code==200 && ("-1294635231" == mmh3(base64_py(body)))
    - status_code==200 && ("-2112191080" == mmh3(base64_py(body)))
    - status_code==200 && ("1134048212" == mmh3(base64_py(body)))
    - status_code==200 && ("714312296" == mmh3(base64_py(body)))
    - status_code==200 && ("1745177497" == mmh3(base64_py(body)))
    - status_code==200 && ("1596032150" == mmh3(base64_py(body)))
    - status_code==200 && ("-905639582" == mmh3(base64_py(body)))
    name: corero
    type: dsl
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}/favicons/favicon.ico'
  - '{{BaseURL}}/favicons/favicon-144.png'
  - '{{BaseURL}}/login/imgs/favicon.ico'
  - '{{BaseURL}}/login/imgs/Corero-Logo-Full-Color.png'
  - '{{BaseURL}}/en-US/static/app/securewatch_analytics_tdd/img/favicon.png'
  - '{{BaseURL}}/en-US/static/app/securewatch_analytics_tdd/img/CoreroSecureWatchLogo.jpg'
  - '{{BaseURL}}/api/theme/faviconImage/D_32X32'
  - '{{BaseURL}}/api/theme/logoImage'
  - '{{BaseURL}}/api/logo/image'
  - '{{BaseURL}}/static/media/Corero-Logo-Full-Color.849b14ba.png'
  redirects: true
  stop-at-first-match: true
