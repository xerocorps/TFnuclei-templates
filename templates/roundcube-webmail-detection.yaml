http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?i)roundcube\s+webmail\s+([\d.]+)
    - (?i)var rcmail_version\s*=\s*['"]([\d.]+)['"]
    type: regex
  matchers:
  - condition: or
    part: body
    type: word
    words:
    - <title>Roundcube Webmail</title>
    - var rcmail = new rcube_webmail();
    - class="roundcube-logo"
    - 'Roundcube Webmail :: Welcome to Roundcube Webmail'
  - part: body
    regex:
    - (?i)<meta[^>]+roundcube
    - (?i)<title>[^<]*roundcube[^<]*</title>
    - (?i)powered by.*roundcube
    type: regex
  - part: header
    type: word
    words:
    - 'X-Roundcube-Version:'
  matchers-condition: or
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/roundcube/'
  - '{{BaseURL}}/mail/'
  - '{{BaseURL}}/webmail/'
  redirects: true
id: roundcube-webmail-detection
info:
  author: Mark Dube
  description: Detects the presence of Roundcube webmail interfaces.
  name: Roundcube Webmail Detection
  severity: low
  tags: tech,webmail,roundcube
