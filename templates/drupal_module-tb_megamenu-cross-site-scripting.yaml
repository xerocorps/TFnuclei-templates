http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '8.x-1.3')
    - compare_versions(version, '8.x-1.2')
    - compare_versions(version, '8.x-1.1')
    - compare_versions(version, '8.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - tb_megamenu
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/tb_megamenu/tb_megamenu.info'
  redirects: true
id: drupal_module-tb_megamenu-cross-site-scripting
info:
  author: Bishopfox
  description: This module provides an admin interface for creating drop down menus
    that combine Drupal menu items with rich media content. It does not sufficiently
    sanitize user input such that an admin with permissions to edit a menu may be
    able to exploit one or more Cross-Site-Scripting (XSS) vulnerabilities. This vulnerability
    is mitigated by the fact that an attacker must have permission to administer mega
    menus and/or create or edit menu links, to inject the XSS.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/tb_megamenu/
    google-query: inurl:'/sites/all/modules/tb_megamenu/
    impact: medium
    security-risk: "Moderately critical 13\u221525 AC:Complex/A:User/CI:Some/II:Some/E:Theoretical/TD:All"
    type: indicator
    vulnerability: cross-site-scripting
  name: drupal_module-tb_megamenu-cross-site-scripting
  reference:
  - https://www.drupal.org/sa-contrib-2021-039
  severity: medium
  tags: drupal
