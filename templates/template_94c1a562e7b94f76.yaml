detail:
  Affected Version: go pprof leak
  author: pa55w0rd(www.pa55w0rd.online/)
  links:
  - https://cloud.tencent.com/developer/news/312276
expression: r0() && r1()
manual: true
name: poc-yaml-go-pprof-leak
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(bytes(string(b"Types
      of profiles available"))) && response.body.bcontains(bytes(string(b"Profile
      Descriptions")))
    request:
      cache: true
      method: GET
      path: /debug/pprof/
  r1:
    expression: 'response.status == 200 && response.body.bcontains(bytes(string(b"goroutine
      profile: total")))'
    request:
      cache: true
      method: GET
      path: /debug/pprof/goroutine?debug=1
transport: http
