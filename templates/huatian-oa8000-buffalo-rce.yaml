http:
- matchers:
  - condition: and
    dsl:
    - status_code_1 == 500 && contains(body_1,'Buffalo worker support POST only!')
      && contains(body_1,'net.buffalo.service.BuffaloWorker.validate')
    - status_code_2 == 500 && contains(body_2,'net.buffalo.service.NoSuchServiceException')
      && contains(body_2,'net.buffalo.service.BuffaloWorker.processRequest')
    type: dsl
  raw:
  - 'GET /OAapp/bfapp/buffalo/ HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /OAapp/bfapp/buffalo/ HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    '
id: huatian-oa8000-buffalo-rce
info:
  author: SleepingBag945
  description: Huatian OA8000 Buffalo found to be vulnerable to Remote Code Execution
    vulnerability
  metadata:
    fofa-query: "app=\"\u534E\u5929\u52A8\u529B-OA8000\""
    max-request: 2
    verified: true
  name: Huatian OA8000 Buffalo - Remote Code Execution
  severity: critical
  tags: huatian,oa,buffalo,rce
