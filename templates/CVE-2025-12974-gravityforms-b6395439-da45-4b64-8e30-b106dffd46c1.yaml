http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - gravityforms
  - dsl:
    - compare_versions(version, '<= 2.9.21.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/gravityforms/readme.txt'
  redirects: true
id: CVE-2025-12974-gravityforms-b6395439-da45-4b64-8e30-b106dffd46c1
info:
  author: topscoder
  classification:
    cve-id: CVE-2025-12974
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
  description: 'The Gravity Forms plugin for WordPress is vulnerable to arbitrary
    file uploads due to missing file type validation in the legacy chunked upload
    mechanism in all versions up to, and including, 2.9.21.1. This is due to the extension
    blacklist not including .phar files, which can be uploaded through the chunked
    upload mechanism. This makes it possible for unauthenticated attackers to upload
    executable .phar files and achieve remote code execution on the server, granted
    they can discover or enumerate the upload path. In order for an attacker to achieve
    RCE, the web server needs to be set up to process .phar file as PHP via file handler
    mapping or similar.

    '
  metadata:
    fofa-query: wp-content/plugins/gravityforms/
    google-query: inurl:"/wp-content/plugins/gravityforms/"
    shodan-query: http.html:"wp-content/plugins/gravityforms/"
  name: 'Gravity Forms <= 2.9.21.1 - Unauthenticated Arbitrary File Upload via Legacy
    Chunked Upload

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/b6395439-da45-4b64-8e30-b106dffd46c1?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,gravityforms,critical,production
