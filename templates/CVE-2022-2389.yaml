http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-marketing-automations
  - dsl:
    - compare_versions(version, '<= 2.1.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-marketing-automations/readme.txt'
  redirects: true
id: CVE-2022-2389
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-2389
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 6.3
  description: The Abandoned Cart Recovery for WooCommerce by Autonami plugin for
    WordPress is vulnerable to unauthorized execution of various AJAX actions due
    to insufficient capability checking and nonce validation on various AJAX actions
    and their hooked functions in versions up to, and including 2.1.1. This makes
    it possible for authenticated attackers, with minimal permissions such as subscribers,
    to perform a wide variety of unauthorized actions.
  metadata:
    fofa-query: wp-content/plugins/wp-marketing-automations/
    google-query: inurl:"/wp-content/plugins/wp-marketing-automations/"
    shodan-query: vuln:CVE-2022-2389
  name: Abandoned Cart Recovery for WooCommerce by Autonami <= 2.1.1 - Missing Authorization
  reference:
  - https://plugins.trac.wordpress.org/changeset/2757000/wp-marketing-automations/trunk/includes/abstracts/class-bwfan-ajax-controller.php
  - https://plugins.trac.wordpress.org/browser/wp-marketing-automations/trunk/includes/class-bwfan-common.php?rev=2757000#L1611
  severity: medium
  tags: cve,wordpress,wp-plugin,wp-marketing-automations,medium
