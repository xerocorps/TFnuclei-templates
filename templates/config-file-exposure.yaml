http:
- matchers:
  - case-insensitive: true
    part: body
    type: word
    words:
    - sftp_password
    - ftp_password
    - ssh_password
    - ssh_username
    - 'credentials:'
  - part: body
    type: word
    words:
    - MAIL_HOST=
    - MAIL_FROM_ADDRESS=
    - MAIL_ENCRYPTION=
  - regex:
    - (?m)^APP_(NAME|ENV|KEY|DEBUG|URL|PASSWORD|SECRET)
    - (?m)^DB_(HOST|NAME|DEBUG|PASSWORD|DATABASE|PASS)
    - (?m)^ADMIN_(HOST|NAME|DEBUG|PASSWORD|DATABASE|PASS)
    - (?m)^AWS_(SESSION|LAMBDA|SECRET|REGION|ACCESS)
    - jdbc:[a-z:]+://[A-Za-z0-9\.\-_:;=/@?,&]+
    - ((?i)password|pwd|pass|secretkey|secret_key)=
    type: regex
  - condition: and
    part: body
    type: word
    words:
    - USER
    - PASS
    - HOST
  - condition: and
    part: body
    type: word
    words:
    - env
    - debug
    - variable
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}/sftp-config.json'
  - '{{BaseURL}}/config/sftp-config.json'
  - '{{BaseURL}}/.vscode/sftp.json'
  - '{{BaseURL}}/deployment-config.json'
  - '{{BaseURL}}/user-config.json'
  - '{{BaseURL}}/ssh-config.json'
  - '{{BaseURL}}/database-config.json'
  - '{{BaseURL}}/config/database-config.json'
  - '{{BaseURL}}/database.json'
  - '{{BaseURL}}/config/database.json'
  - '{{BaseURL}}/config.json'
  - '{{BaseURL}}/config/sftp-config.json'
  - '{{BaseURL}}/config/config.json'
  - '{{BaseURL}}/git_config.json'
id: config-file-exposure
info:
  author: reewardius
  description: This template can be used to detect config files containing sensitive
    information.
  name: Config file exposure
  severity: low
  tags: generic,config-files
