http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '7.x-10.3')
    - compare_versions(version, '7.x-10.2')
    - compare_versions(version, '7.x-10.1')
    - compare_versions(version, '7.x-10.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - moneysuite
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/moneysuite/moneysuite.info'
  redirects: true
id: drupal_module-moneysuite-access-bypass
info:
  author: Bishopfox
  description: MoneySuite provides a set of modules for Drupal sites that rely on
    the sale of memberships and/or content for revenue. The modules have an access
    bypass vulnerability which allows untrusted users (including anonymous users)
    to view payments made by users within the system. No data can be modified, nor
    are any credit card numbers displayed.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/moneysuite/
    google-query: inurl:'/sites/all/modules/moneysuite/
    impact: medium
    security-risk: "Moderately critical 14\u221525 AC:None/A:None/CI:Some/II:None/E:Theoretical/TD:Default"
    type: indicator
    vulnerability: access-bypass
  name: drupal_module-moneysuite-access-bypass
  reference:
  - https://www.drupal.org/sa-contrib-2017-085
  severity: medium
  tags: drupal
