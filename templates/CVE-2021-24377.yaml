http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - autoptimize
  - dsl:
    - compare_versions(version, '< 2.7.8')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/autoptimize/readme.txt'
  redirects: true
id: CVE-2021-24377
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24377
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
  description: The Autoptimize WordPress plugin before 2.7.8 attempts to remove potential
    malicious files from the extracted archive uploaded via the 'Import Settings'
    feature, however this is not sufficient to protect against RCE as a race condition
    can be achieved in between the moment the file is extracted on the disk but not
    yet removed. It is a bypass of CVE-2020-24948.
  metadata:
    fofa-query: wp-content/plugins/autoptimize/
    google-query: inurl:"/wp-content/plugins/autoptimize/"
    shodan-query: vuln:CVE-2021-24377
  name: Autoptimize <= 2.7.7 - Race Condition leading to Remote Code Execution
  reference:
  - https://wpscan.com/vulnerability/85c0a564-2e56-413d-bc3a-1039343207e4
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24377
  severity: high
  tags: cve,wordpress,wp-plugin,autoptimize,high
