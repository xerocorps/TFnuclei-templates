http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - 'global:'
    - 'scrape_configs:'
    - scrape_interval
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/config'
  - '{{BaseURL}}/api/v1/status/config'
id: prometheus-unauth
info:
  author: pussycat0x
  description: 'Detects unauthenticated access to Prometheus Time Series Collection
    and Processing Server by checking for specific elements in the response from the
    `/graph` endpoint.

    '
  metadata:
    max-request: 2
    shodan-query: http.title:"Prometheus Time Series"
    verified: true
  name: Prometheus Monitoring System - Unauthenticated
  severity: high
  tags: unauth,prometheus,misconfig,vuln
