http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '<= 2.2.1')
    - compare_versions(version_by_js, '<= 2.2.1')
    - compare_versions(version_by_css, '<= 2.2.1')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2007-4153-3db58a43549b1a343265bc6999275163
info:
  author: topscoder
  classification:
    cve-id: CVE-2007-4153
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 5.5
  description: 'Multiple cross-site scripting (XSS) vulnerabilities in WordPress 2.2.1
    allow remote authenticated administrators to inject arbitrary web script or HTML
    via (1) the Options Database Table in the Admin Panel, accessed through options.php;
    or (2) the opml_url parameter to link-import.php.  NOTE: this might not cross
    privilege boundaries in some configurations, since the Administrator role has
    the unfiltered_html capability.

    '
  metadata:
    shodan-query: vuln:CVE-2007-4153
  name: 'WordPress Core <= 2.2.1 - Authenticated (Admin+) Cross-Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/8f896e4a-565a-4545-9683-045cd08ccca0?source=api-prod
  severity: low
  tags: cve,wordpress,wp-core,low
