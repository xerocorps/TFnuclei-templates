id: jfrog-version-header
info:
  author: c-sh0
  description: Query health check endpoints for X-JFrog-Version header.
  name: JFrog Version header detection
  reference:
  - https://www.jfrog.com/confluence/display/JFROG/JFrog+Platform+REST+API
  severity: info
  tags: jfrog,artifactory,tech,api
requests:
- extractors:
  - group: 1
    part: header
    regex:
    - X-Jfrog-Version:\s+([^\s]+)
    type: regex
  matchers:
  - condition: or
    status:
    - 200
    - 404
    type: status
  - part: header
    type: word
    words:
    - 'X-Jfrog-Version:'
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}/api/system/ping'
  - '{{BaseURL}}/api/v1/system/readiness'
  - '{{BaseURL}}/api/v1/system/liveness'
  - '{{BaseURL}}/doesNotExist404'
  redirects: true
  stop-at-first-match: true
