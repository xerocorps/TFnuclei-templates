id: minecraft-enum
info:
  author: pussycat0x
  description: 'Minecraft server for some basic information about the host.The information
    that is queried is the Description, Maximum Number of Players, number of Online
    Players, Version number, and Protocol Number

    '
  metadata:
    max-request: 1
    shodan-query: product:"Minecraft"
    verified: true
  name: Minecraft - enum
  reference:
  - https://github.com/sjhilt/Nmap-NSEs/blob/master/minecraft-info.nse
  severity: info
  tags: js,network,minecraft,enum,discovery
javascript:
- pre-condition: 'isPortOpen(Host,Port);

    '
- args:
    Host: '{{Host}}'
    Port: 25565
  code: "let data = \"fe01\"\nlet c = require(\"nuclei/net\");\nlet conn = c.Open('tcp',\
    \ `${Host}:${Port}`);\nconn.SendHex(data);\nlet response = conn.RecvString();\n\
    if (response.includes(\"HTTP/1.1\")) {\n  conn.Close();\n} else {\n  let cleanedResponse\
    \ = response.replace(/\\x00/g, '');\n  const version = cleanedResponse.slice(16,\
    \ 30).replace(/(\\d+)(\\d{1})(\\d+)/, \"$1.$2.$3\");\n  const description = cleanedResponse.slice(30,\
    \ -4);\n  const onlinePlayers = cleanedResponse.slice(-1);\n  const maxPlayers\
    \ = cleanedResponse.slice(-3);\n  Export(\"Version: \", version , \" Description:\"\
    , description ,\" Online Players:\", onlinePlayers, \" Maximum Players:\", maxPlayers);\n\
    }\n"
  extractors:
  - dsl:
    - response
    type: dsl
  matchers:
  - dsl:
    - success == true
    type: dsl
  matchers-condition: and
