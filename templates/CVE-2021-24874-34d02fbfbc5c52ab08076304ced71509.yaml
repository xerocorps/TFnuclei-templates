http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - mailin
  - dsl:
    - compare_versions(version, '< 3.1.31')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/mailin/readme.txt'
  redirects: true
id: CVE-2021-24874-34d02fbfbc5c52ab08076304ced71509
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24874
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
  description: 'The Newsletter, SMTP, Email marketing and Subscribe forms by Sendinblue
    WordPress plugin before 3.1.31 does not escape the lang and pid parameter before
    outputting them back in attributes, leading to Reflected Cross-Site Scripting
    issues

    '
  metadata:
    fofa-query: wp-content/plugins/mailin/
    google-query: inurl:"/wp-content/plugins/mailin/"
    shodan-query: vuln:CVE-2021-24874
  name: 'Newsletter, SMTP, Email marketing and Subscribe forms by Sendinblue <= 3.1.30
    - Reflected Cross-Site Scripting via lang & pid Parameters

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/8173596d-a127-4dc1-a72a-640381536c67?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,mailin,medium
