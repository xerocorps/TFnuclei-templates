http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - w3-total-cache
  - dsl:
    - compare_versions(version, '<= 2.8.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/w3-total-cache/readme.txt'
  redirects: true
id: CVE-2024-12365-w3_total_cache-196e629f-7c77-4bcb-8224-305a0108b630
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-12365
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N
    cvss-score: 8.5
  description: 'The W3 Total Cache plugin for WordPress is vulnerable to unauthorized
    access of data due to a missing capability check on the is_w3tc_admin_page function
    in all versions up to, and including, 2.8.1. This makes it possible for authenticated
    attackers, with Subscriber-level access and above, to obtain the plugin''s nonce
    value and perform unauthorized actions, resulting in information disclosure, service
    plan limits consumption as well as making web requests to arbitrary locations
    originating from the web application that can be used to query information from
    internal services, including instance metadata on cloud-based applications.

    '
  metadata:
    fofa-query: wp-content/plugins/w3-total-cache/
    google-query: inurl:"/wp-content/plugins/w3-total-cache/"
    shodan-query: http.html:"wp-content/plugins/w3-total-cache/"
  name: 'W3 Total Cache <= 2.8.1 - Authenticated (Subscriber+) Missing Authorization
    to Server-Side Request Forgery

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/196e629f-7c77-4bcb-8224-305a0108b630?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,w3-total-cache,low,production
