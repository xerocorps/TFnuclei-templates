file:
- extensions:
  - conf
  matchers:
  - condition: and
    type: word
    words:
    - http
    - events
  - condition: and
    negative: true
    type: word
    words:
    - limit_req_zone $binary_remote_addr zone=
    - rate=
  matchers-condition: and
id: file-missing-nginx-rate-limiting
info:
  author: pussycat0x
  description: 'Ensures that rate limiting is properly configured in Nginx to prevent
    excessive requests from a single client.

    '
  metadata:
    verified: true
  name: Missing Nginx Rate Limiting Configuration
  reference:
  - https://wiki.devsecopsguides.com/docs/checklists/mongodb/
  - https://nginx.org/en/docs/http/ngx_http_limit_req_module.html
  remediation: 'Add ''limit_req_zone $binary_remote_addr zone=mylimit:10m rate=10r/s;''
    in /etc/nginx/nginx.conf.

    '
  severity: medium
  tags: audit,file,nginx,hardening
