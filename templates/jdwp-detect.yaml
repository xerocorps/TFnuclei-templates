id: jdwp-detect
info:
  author: johnk3r
  description: 'JDWP, short for Java Debug Wire Protocol, is a standard feature in
    the Java platform, designed to help developers debug live applications. It allows
    remote inspection of threads, memory, and execution flow without restarting the
    application. To enable it, developers typically start the JVM with a flag like
    the one below. This setup tells the JVM to listen for debugger connections on
    port 5005 and accept incoming connections on all interfaces.

    '
  metadata:
    shodan-query: product:"Java Debug Wire Protocol"
    verified: true
  name: Java Debug Wire Protocol - Detect
  reference:
  - https://www.wiz.io/blog/exposed-jdwp-exploited-in-the-wild
  severity: info
  tags: network,jdwp,tcp,detect,discovery
tcp:
- extractors:
  - name: jdwp-version
    part: raw
    regex:
    - JVM version ([0-9\.]+)
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: 4a4457502d48616e647368616b65
    read: 14
    type: hex
  - data: 0000000b00000001000101
    read: 1024
    type: hex
  matchers:
  - condition: and
    part: raw
    type: word
    words:
    - JVM version
    - VM
  port: 5005
