http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 6.0', '<= 6.0.1')
    - compare_versions(version_by_js, '>= 6.0', '<= 6.0.1')
    - compare_versions(version_by_css, '>= 6.0', '<= 6.0.1')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2022-4973-wordpress-b5582e89-83e6-4898-b9fe-09eddeb5f7ae
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-4973
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 4.9
  description: 'WordPress Core, in versions up to 6.0.2, is vulnerable to Authenticated
    Stored Cross-Site Scripting that can be exploited by users with access to the
    WordPress post and page editor, typically consisting of Authors, Contributors,
    and Editors making it possible to inject arbitrary web scripts into posts and
    pages that execute if the the_meta(); function is called on that page.

    '
  metadata:
    shodan-query: vuln:CVE-2022-4973
  name: 'WordPress Core < 6.0.2 - Authenticated (Contributor+) Stored Cross-Site Scripting
    via use of the_meta(); function

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/b5582e89-83e6-4898-b9fe-09eddeb5f7ae?source=api-prod
  severity: low
  tags: cve,wordpress,wp-core,low,production
