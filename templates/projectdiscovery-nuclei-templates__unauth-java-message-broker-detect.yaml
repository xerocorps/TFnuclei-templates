id: unauth-java-message-broker-detect
info:
  author: matejsmycka
  description: 'Detection of a Java Message Service (JMS) broker, typically used by
    Oracle GlassFish Message Queue and Payara Application Server. This port should
    remain closed to the internet, as it enables unauthenticated access to messaging
    services.

    '
  metadata:
    shodan-query: product:"Java Message Service"
    verified: true
  name: Unauthenticated Java Message Broker - Detect
  severity: low
  tags: network,tcp,jms,openmq,unauth
tcp:
- extractors:
  - regex:
    - imqbroker ([0-9.]+)
    type: regex
  host:
  - '{{Host}}:7676'
  inputs:
  - data: '

      '
  matchers:
  - condition: and
    type: word
    words:
    - 101 imqbroker
    - cluster_discovery
