http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - ip2location-country-blocker
  - dsl:
    - compare_versions(version, '<= 2.26.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/ip2location-country-blocker/readme.txt'
  redirects: true
id: CVE-2021-25095
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-25095
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:H
    cvss-score: 7.1
  description: The IP2Location Country Blocker WordPress plugin before 2.26.5 does
    not have authorisation and CSRF checks in the ip2location_country_blocker_save_rules
    AJAX action, allowing any authenticated users, such as subscriber to call it and
    block arbitrary country, or block all of them at once, preventing users from accessing
    the frontend.
  metadata:
    fofa-query: wp-content/plugins/ip2location-country-blocker/
    google-query: inurl:"/wp-content/plugins/ip2location-country-blocker/"
    shodan-query: vuln:CVE-2021-25095
  name: IP2Location Country Blocker <= 2.26.4 - Subscriber+ Arbitrary Country Ban
  reference:
  - https://wpscan.com/vulnerability/cbfa7211-ac1f-4cf2-bd79-ebce2fc4baa1
  - https://plugins.trac.wordpress.org/changeset/2652469
  severity: high
  tags: cve,wordpress,wp-plugin,ip2location-country-blocker,high
