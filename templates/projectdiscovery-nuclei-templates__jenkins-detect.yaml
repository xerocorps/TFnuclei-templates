http:
- extractors:
  - kval:
    - x_jenkins
    name: version
    type: kval
  - kval:
    - version
    type: kval
  host-redirects: true
  matchers:
  - case-insensitive: true
    part: header
    type: word
    words:
    - 'x-jenkins:'
  - type: word
    words:
    - Jenkins
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/whoAmI/'
  stop-at-first-match: true
id: jenkins-detect
info:
  author: philippdelteil,daffainfo,c-sh0,AdamCrosser
  classification:
    cpe: cpe:2.3:a:jenkins:jenkins:*:*:*:*:*:*:*:*
  metadata:
    category: devops
    fofa-query: icon_hash=81586312
    max-request: 2
    product: jenkins
    shodan-query:
    - http.favicon.hash:81586312
    - cpe:"cpe:2.3:a:jenkins:jenkins"
    - product:"jenkins"
    vendor: jenkins
  name: Jenkins Detection
  reference:
  - https://www.jenkins.io/doc/book/using/remote-access-api/#RemoteaccessAPI-DetectingJenkinsversion
  - https://github.com/jenkinsci/jenkins/pull/470
  - https://www.jenkins.io/doc/book/security/access-control/permissions/#access-granted-without-overallread
  severity: info
  tags: tech,jenkins,detect,discovery
