id: pgsql-default-db
info:
  author: pussycat0x
  description: 'postgres is the default database you will connect to before you have
    created any other databases.

    '
  metadata:
    max-request: 40
    shodan-query: product:"PostgreSQL"
    verified: true
  name: Postgresql Default Database - Enumeration
  reference:
  - https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/PostgreSQL%20Injection.md#postgresql-database-name
  severity: high
  tags: js,network,postgresql,authenticated,enum,discovery
javascript:
- args:
    Db: '{{database}}'
    Host: '{{Host}}'
    Pass: '{{password}}'
    Port: 5432
    User: '{{usernames}}'
  attack: clusterbomb
  code: 'const postgres = require(''nuclei/postgres'');

    const client = new postgres.PGClient;

    connected = client.ConnectWithDB(Host, Port, User, Pass, Db);

    connected  ;

    '
  matchers:
  - condition: and
    dsl:
    - success == true
    - response == true
    type: dsl
  payloads:
    database:
    - foresight
    - postgres
    - template0
    - template1
    - test
    password:
    - postgres
    - null
    - 123
    - amber
    usernames:
    - postgres
    - admin
  pre-condition: 'isPortOpen(Host,Port);

    '
