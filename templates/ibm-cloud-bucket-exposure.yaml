http:
- extractors:
  - group: 1
    name: bucket-name
    part: body
    regex:
    - <Name>([^<]+)</Name>
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, "<ListBucketResult", "<Name>")
    - contains_any(tolower(header), "ibm-sse-kp-enabled", "ibm-sse-kp-customer-root-key-crn",
      "ibm-")
    - contains_any(tolower(content_type), "application/xml", "text/xml")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/?list-type=2'
  stop-at-first-match: true
id: ibm-cloud-bucket-exposure
info:
  author: 0x_Akoko
  description: 'IBM Cloud Object Storage bucket is publicly accessible, potentially
    exposing sensitive files and data. Public bucket listing allows enumeration of
    stored objects.

    '
  metadata:
    fofa-query: host="cloud-object-storage.appdomain.cloud"
    max-request: 2
    shodan-query: ssl.cert.subject.cn:"cloud-object-storage.appdomain.cloud"
    verified: true
  name: IBM Cloud Object Storage - Bucket Exposure
  reference:
  - https://cloud.ibm.com/docs/cloud-object-storage
  - https://cloud.ibm.com/docs/cloud-object-storage?topic=cloud-object-storage-iam-bucket-permissions
  severity: unknown
  tags: ibm,cloud,bucket,exposure,misconfig,s3
