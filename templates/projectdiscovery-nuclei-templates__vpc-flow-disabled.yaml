code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .Vpcs.Vpc[].VpcId
    name: vpcid
    type: json
  source: 'aliyun vpc DescribeVpcs --region $region

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - vpcid + " VPC Flow Log is Disabled "
    type: dsl
  matchers:
  - type: word
    words:
    - '"FlowLog": []'
  source: 'aliyun vpc DescribeFlowLogs --RegionId $region --VpcId $vpcid

    '
flow: "code(1)\nfor(let VpcId of iterate(template.vpcid)){\n  set(\"vpc\", VpcId)\n\
  \  code(2)\n}\n"
id: vpc-flow-disabled
info:
  author: DhiyaneshDK
  description: 'The VPC Flow Log is disabled, meaning network traffic data is not
    being captured or monitored. This lack of logging reduces visibility into network
    activities, making it difficult to detect and investigate potential security incidents
    or performance issues.

    '
  metadata:
    max-request: 1
    verified: true
  name: VPC Flow Log - Disabled
  reference:
  - https://www.alibabacloud.com/help/en/vpc/user-guide/create-and-manage-flow-log
  - https://www.trendmicro.com/cloudoneconformity/knowledge-base/alibaba-cloud/AlibabaCloud-VPC/enable-flow-logs.html
  severity: medium
  tags: cloud,devops,aliyun,alibaba,alibaba-cloud-config,alibaba-vpc
self-contained: true
variables:
  region: cn-hangzhou
