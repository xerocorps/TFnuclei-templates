http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - leaflet-map
  - dsl:
    - compare_versions(version, '<= 2.23.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/leaflet-map/readme.txt'
  redirects: true
id: CVE-2021-24467
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24467
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
  description: The Leaflet Map WordPress plugin before 3.0.0 does not verify the CSRF
    nonce when saving its settings, which allows attackers to make a logged in admin
    update the settings via a Cross-Site Request Forgery attack. This could lead to
    Cross-Site Scripting issues by either changing the URL of the JavaScript library
    being used, or using malicious attributions which will be executed in all page
    with an embed map from the plugin
  metadata:
    fofa-query: wp-content/plugins/leaflet-map/
    google-query: inurl:"/wp-content/plugins/leaflet-map/"
    shodan-query: vuln:CVE-2021-24467
  name: Leaflet Map < 3.0.0 -  Cross-Site Request Forgery to Stored Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/ac32d265-066e-49ec-9042-3145cd99e2e8
  severity: medium
  tags: cve,wordpress,wp-plugin,leaflet-map,medium
