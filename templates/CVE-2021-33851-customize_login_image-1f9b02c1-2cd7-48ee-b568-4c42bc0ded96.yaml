http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - customize-login-image
  - dsl:
    - compare_versions(version, '<= 3.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/customize-login-image/readme.txt'
  redirects: true
id: CVE-2021-33851-customize_login_image-1f9b02c1-2cd7-48ee-b568-4c42bc0ded96
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-33851
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
  description: 'A cross-site scripting (XSS) attack can cause arbitrary code (JavaScript)
    to run in a user''s browser and can use an application as the vehicle for the
    attack. The XSS payload given in the "Custom logo link" executes whenever the
    user opens the Settings Page of the "Customize Login Image" Plugin.

    '
  metadata:
    fofa-query: wp-content/plugins/customize-login-image/
    google-query: inurl:"/wp-content/plugins/customize-login-image/"
    shodan-query: http.html:"wp-content/plugins/customize-login-image/"
  name: 'Customize Login Image <= 3.4 - Cross-Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/1f9b02c1-2cd7-48ee-b568-4c42bc0ded96?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,customize-login-image,medium,production
