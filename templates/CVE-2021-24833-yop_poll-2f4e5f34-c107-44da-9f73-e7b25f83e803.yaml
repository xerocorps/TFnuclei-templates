http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - yop-poll
  - dsl:
    - compare_versions(version, '<= 6.3.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/yop-poll/readme.txt'
  redirects: true
id: CVE-2021-24833-yop_poll-2f4e5f34-c107-44da-9f73-e7b25f83e803
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24833
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
  description: 'The YOP Poll WordPress plugin before 6.3.1 is affected by a stored
    Cross-Site Scripting vulnerability, which exists in the Admin preview module where
    a user with a role as low as author is allowed to execute arbitrary script code
    within the context of the application. This vulnerability is due to insufficient
    validation of question and answer text parameters in Create Poll module.

    '
  metadata:
    fofa-query: wp-content/plugins/yop-poll/
    google-query: inurl:"/wp-content/plugins/yop-poll/"
    shodan-query: http.html:"wp-content/plugins/yop-poll/"
  name: 'YOP Poll <= 6.3.0 - Author+ Stored Cross-Site Scripting via Preview Module

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/2f4e5f34-c107-44da-9f73-e7b25f83e803?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,yop-poll,medium,production
