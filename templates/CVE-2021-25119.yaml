http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - automatic-grid-image-listing
  - dsl:
    - compare_versions(version, '<= 1.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/automatic-grid-image-listing/readme.txt'
  redirects: true
id: CVE-2021-25119
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-25119
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
  description: The AGIL WordPress plugin through 1.0 accepts all zip files and automatically
    extracts the zip file without validating the extracted file type. Allowing high
    privilege users such as admin to upload an arbitrary file like PHP, leading to
    RCE
  metadata:
    fofa-query: wp-content/plugins/automatic-grid-image-listing/
    google-query: inurl:"/wp-content/plugins/automatic-grid-image-listing/"
    shodan-query: vuln:CVE-2021-25119
  name: AGIL(Automatic Grid Image Listing) <= 1.0 - Arbitrary File Upload
  reference:
  - https://wpscan.com/vulnerability/47235989-d9f1-48a5-9799-fdef0889bf8a
  - https://patchstack.com/database/vulnerability/automatic-grid-image-listing-/wordpress-agil-plugin-1-0-arbitrary-file-upload-vulnerability
  severity: high
  tags: cve,wordpress,wp-plugin,automatic-grid-image-listing,high
