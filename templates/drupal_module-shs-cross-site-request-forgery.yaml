http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '7.x-1.7')
    - compare_versions(version, '7.x-1.6')
    - compare_versions(version, '7.x-1.5')
    - compare_versions(version, '7.x-1.4')
    - compare_versions(version, '7.x-1.3')
    - compare_versions(version, '7.x-1.2')
    - compare_versions(version, '7.x-1.1')
    - compare_versions(version, '7.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - shs
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/shs/shs.info'
  redirects: true
id: drupal_module-shs-cross-site-request-forgery
info:
  author: Bishopfox
  description: Simple hierarchical select defines a new form widget for taxonomy fields
    to select a term by browsing through the vocabularies hierarchy. It also allows
    users to create new taxonomy terms using its widget directly in the node form.
    Version 7.x of Simple hierarchical select doesnt sufficiently checks permission
    when creating new terms so attackers can create arbitrary taxonomy terms in any
    vocabularies the victim has access to.. This vulnerability is mitigated by the
    fact that an attacker must trick a user with permission to create terms to visit
    a specially prepared web page controlled by the attacker.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/shs/
    google-query: inurl:'/sites/all/modules/shs/
    impact: medium
    security-risk: "Moderately critical 10\u221525 AC:Basic/A:User/CI:None/II:Some/E:Theoretical/TD:Default"
    type: indicator
    vulnerability: cross-site-request-forgery
  name: drupal_module-shs-cross-site-request-forgery
  reference:
  - https://www.drupal.org/sa-contrib-2019-038
  severity: medium
  tags: drupal
