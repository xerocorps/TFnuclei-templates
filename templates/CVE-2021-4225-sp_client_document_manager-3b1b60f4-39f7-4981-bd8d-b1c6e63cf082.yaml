http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - sp-client-document-manager
  - dsl:
    - compare_versions(version, '< 4.24')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/sp-client-document-manager/readme.txt'
  redirects: true
id: CVE-2021-4225-sp_client_document_manager-3b1b60f4-39f7-4981-bd8d-b1c6e63cf082
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-4225
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: 'The SP Project & Document Manager WordPress plugin before 4.24 allows
    any authenticated users, such as subscribers, to upload files. The plugin attempts
    to prevent PHP and other similar files that could be executed on the server from
    being uploaded by checking the file extension. It was discovered that on Windows
    servers, the security checks in place were insufficient, enabling bad actors to
    potentially upload backdoors on vulnerable sites.

    '
  metadata:
    fofa-query: wp-content/plugins/sp-client-document-manager/
    google-query: inurl:"/wp-content/plugins/sp-client-document-manager/"
    shodan-query: http.html:"wp-content/plugins/sp-client-document-manager/"
  name: 'SP Project & Document Manager  <= 4.23 - Subscriber+ Arbitrary File Upload

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/3b1b60f4-39f7-4981-bd8d-b1c6e63cf082?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,sp-client-document-manager,low,production
