code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'Administrative Share Found: C$'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: '$Share = Get-SmbShare -Name C$

    Write-Host "Administrative Share Found: $($Share.Name)"

    '
id: windows-administrative-shares-enabled
info:
  author: princechaddha
  description: Checks if administrative shares (C$, D$, etc.) are enabled, which can
    pose a security risk.
  impact: 'Enabling administrative shares can provide attackers with remote access
    to the system drives.

    '
  name: Administrative Shares Enabled
  remediation: 'Disable administrative shares to minimize exposure to remote attacks.

    '
  severity: high
  tags: windows,shares,administrative,code,windows-audit
self-contained: true
