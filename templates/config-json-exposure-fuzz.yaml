http:
- extractors:
  - name: api_credentials
    regex:
    - \"(api_key|apikey|token|secret|auth)\":\s*\"([^\"]{8,})\"
    - \"access_token\":\s*\"([^\"]{8,})\"
    - \"authorization\":\s*\"([^\"]{8,})\"
    type: regex
  - name: aws_credentials
    regex:
    - \"aws_access_key_id\":\s*\"([^\"]{20,})\"
    - \"aws_secret_access_key\":\s*\"([^\"]{20,})\"
    - \"aws_session_token\":\s*\"([^\"]{20,})\"
    type: regex
  - name: database_credentials
    regex:
    - \"(db_password|database_password|mysql_password|postgresql_password|mongo_password)\":\s*\"([^\"]{8,})\"
    - \"(connection_string|connection_url|database_url)\":\s*\"([^\"]+)\"
    type: regex
  - name: endpoints
    regex:
    - \"(url|endpoint|uri|host|server)\":\s*\"(https?://[^\"]+)\"
    - \"(webhook|callback)\":\s*\"(https?://[^\"]+)\"
    type: regex
  - name: base_urls
    regex:
    - '"baseUrl":\s*"(https?://[^"]+)"'
    - '"baseURL":\s*"(https?://[^"]+)"'
    - '"fileUrl":\s*"(https?://[^"]+)"'
    - '"loginAppUrl":\s*"(https?://[^"]+)"'
    - '"aimBaseUrl":\s*"(https?://[^"]+)"'
    type: regex
  - name: access_codes
    regex:
    - '"accessCode":\s*"([A-Za-z0-9+/=]{40,})"'
    - '"recaptchaSiteKey":\s*"([A-Za-z0-9_-]{40,})"'
    type: regex
  - name: token_config
    regex:
    - '"tokenExpire":\s*(\d+)'
    - '"refreshTokenExpire":\s*(\d+)'
    type: regex
  - name: environment
    regex:
    - '"production":\s*(true|false)'
    type: regex
  - name: sensitive_endpoints
    regex:
    - https?://[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/(?:login|api|admin|dashboard|auth)
    type: regex
  matchers:
  - condition: or
    part: header
    type: word
    words:
    - application/json
    - text/json
    - text/plain
  - condition: or
    negative: true
    part: header
    type: word
    words:
    - text/html
    - text/php
  - status:
    - 200
    type: status
  - condition: or
    part: body
    regex:
    - (?i)(\"(api_key|apikey|token|secret|password|passwd|pwd|auth|access_key|secret_key)\":\s*\"[^\"]{8,}\")
    - (?i)(\"(aws|azure|gcp|google|slack|github|twitter|facebook)\":\s*\{)
    - (?i)(\"(host|endpoint|url|uri|connection|server)\":\s*\"[^\"]+\")
    - (?i)(\"(username|user|uid|login)\":\s*\"[^\"]+\")
    - (?i)(\"(db|database|mongo|mysql|postgresql|redis)\":\s*\{)
    - (?i)"production":\s*(true|false)
    - (?i)"baseUrl":\s*"[^"]+"
    - (?i)"(accessCode|recaptchaSiteKey|tokenExpire)":\s*"[^"]+"
    - (?i)"(fileUrl|loginAppUrl|aimBaseUrl)":\s*"[^"]+"
    type: regex
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}{{path}}'
  payloads:
    path:
    - /config.json
    - /configuration.json
    - /settings.json
    - /configs.json
    - /conf.json
    - /app.config.json
    - /application.json
    - /config.prod.json
    - /config.production.json
    - /config.dev.json
    - /config.development.json
    - /config.staging.json
    - /config.test.json
    - /config.local.json
    - /config/config.json
    - /config/default.json
    - /config/prod.json
    - /config/production.json
    - /config/development.json
    - /config/app.json
    - /app/config.json
    - /src/config.json
    - /assets/config.json
    - /assets/config.production.json
    - /assets/configs.json
    - /static/config.json
    - /public/config.json
    - /dist/config.json
    - /js/config.json
    - /api/config.json
    - /api/v1/config.json
    - /api/v2/config.json
    - /apiconfig.json
    - /angular/config.json
    - /react/config.json
    - /vue/config.json
    - /credentials/config.json
    - /secrets/config.json
    - /secret/config.json
    - /keys/config.json
    - /auth/config.json
    - /aws/config.json
    - /aws/credentials.json
    - /cloud/config.json
    - /s3/config.json
    - /db/config.json
    - /database/config.json
    - /mysql/config.json
    - /postgres/config.json
    - /mongodb/config.json
  stop-at-first-match: true
id: config-json-exposure-fuzz
info:
  author: geeknik
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cwe-id: CWE-200
  description: 'Detects exposed JSON configuration files containing sensitive information
    including API keys, access tokens, AWS credentials, database configurations, base
    URLs, file paths, and application settings. These files often contain production
    configurations and credentials that should not be publicly accessible.

    '
  metadata:
    github-query: filename:config.json
    max-request: 50
  name: Exposed JSON Configuration Files
  severity: critical
  tags: config,exposure,files,vuln
