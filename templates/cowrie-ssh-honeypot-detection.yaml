id: cowrie-ssh-honeypot-detection
info:
  author: UnaPibaGeek
  description: 'A Cowrie (or Twisted) SSH honeypot has been identified.

    The response to a wrong SSH version differs from real installations, signaling
    a possible deceptive setup.

    '
  metadata:
    max-request: 2
    product: ssh
    vendor: cowrie
  name: Cowrie SSH Honeypot Detection
  severity: info
  tags: cowrie,twisted,ssh,honeypot
tcp:
- host:
  - '{{Hostname}}'
  - '{{Host}}:22'
  inputs:
  - data: "SSH-1337-OpenSSH_9.0\r\n"
  matchers:
  - part: body
    regex:
    - SSH\-([0-9.-A-Za-z_ ]+)
    type: regex
  - condition: or
    type: word
    words:
    - Protocol major versions differ.
    - bad version 1337
  matchers-condition: and
