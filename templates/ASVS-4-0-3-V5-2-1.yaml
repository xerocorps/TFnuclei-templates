http:
- fuzzing:
  - fuzz:
    - '{{reflection}}'
    keys:
    - ops
    - insert
    - ops
    - insert
    - attributes
    - bold
    - italic
    - link
    - time
    - blocks
    - type
    - data
    - text
    - level
    - style
    - items
    - version
    mode: multiple
    part: body
    type: postfix
  matchers:
  - part: body
    type: word
    words:
    - '{{reflection}}'
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  payloads:
    reflection:
    - '''"><{{first}}>'
    - '''><{{first}}>'
    - '"><{{first}}>'
  pre-condition:
  - dsl:
    - method == POST
    - len(body) > 0
    type: dsl
  stop-at-first-match: true
id: ASVS-4-0-3-V5-2-1
info:
  author: Masoud Abdaal,AmirHossein Raeisi
  classification:
    cwe-id: CWE-116
  description: 'Verify that all untrusted HTML input from WYSIWYG editors or similar
    is properly sanitized with an HTML sanitizer library or framework feature.

    '
  name: ASVS 5.2.1 Check
  reference:
  - https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/03-Testing_for_HTML_Injection
  - https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing
  severity: high
  tags: asvs,5.2.1
variables:
  first: '{{rand_int(10000, 99999)}}'
