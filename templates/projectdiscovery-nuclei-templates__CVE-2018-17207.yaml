http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - Plugin Version:.*?([0-9].*?)<
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - <title>Duplicator</title>
    - dupx-header-version
    - 'Deployment Path:'
  - status:
    - 200
    type: status
  - dsl:
    - compare_versions(version, '< 1.2.42')
    type: dsl
  matchers-condition: and
  raw:
  - 'POST /installer-backup.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action_step=1

    '
id: CVE-2018-17207
info:
  author: synacktiv,iamnoooob,pdresearch
  classification:
    cpe: cpe:2.3:a:snapcreek:duplicator:*:*:*:*:lite:wordpress:*:*
    cve-id: CVE-2018-17207
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-94
    epss-percentile: 0.996
    epss-score: 0.90823
  description: 'An issue was discovered in Snap Creek Duplicator before 1.2.42. By
    accessing leftover installer files (installer.php and installer-backup.php), an
    attacker can inject PHP code into wp-config.php during the database setup step,
    achieving arbitrary code execution.

    '
  impact: 'Unauthenticated attackers can inject and execute arbitrary PHP code by
    exploiting leftover installer files, leading to complete WordPress site compromise
    and potential server takeover.

    '
  metadata:
    framework: wordpress
    google-query: inurl:"/wp-content/plugins/duplicator"
    max-request: 1
    product: duplicator
    publicwww-query: /wp-content/plugins/duplicator
    vendor: snapcreek
    verified: true
  name: WordPress Duplicator Plugin < 1.2.42 - Arbitrary Code Execution
  reference:
  - https://www.synacktiv.com/posts/exploit/wordpress-duplicator-plugin-arbitrary-code-execution.html
  - https://nvd.nist.gov/vuln/detail/CVE-2018-17207
  remediation: 'Remove installer.php and installer-backup.php files after installation,
    and upgrade to Duplicator version 1.2.42 or later.

    '
  severity: critical
  tags: cve,cve2018,wordpress,duplicator,rce,vkev,passive,vuln
