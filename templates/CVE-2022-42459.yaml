http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - image-hover-effects-ultimate
  - dsl:
    - compare_versions(version, '<= 9.7.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/image-hover-effects-ultimate/readme.txt'
  redirects: true
id: CVE-2022-42459
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-42459
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
  description: The Image Hover Effects Ultimate plugin for WordPress is vulnerable
    to Arbitrary Options Update in versions up to, and including, 9.7.1. This is due
    to a lack of validation on the settings supplied to the post_oxi_settings() function.
    This makes it possible for authenticated attackers, with administrative level
    permissions, to update arbitrary options on the WordPress site. This would only
    affect sites where the administrator has been restricted to not 'manage_options'
    or the administrator has allowed users with lower permissions to update the plugin's
    settings.
  metadata:
    fofa-query: wp-content/plugins/image-hover-effects-ultimate/
    google-query: inurl:"/wp-content/plugins/image-hover-effects-ultimate/"
    shodan-query: vuln:CVE-2022-42459
  name: Image Hover Effects Ultimate <= 9.7.1 - Authenticated (Admin+) Arbitrary Options
    Update
  reference:
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2657304%40image-hover-effects-ultimate%2Ftrunk&old=2648086%40image-hover-effects-ultimate%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/changeset/2657304/image-hover-effects-ultimate/trunk/Classes/ImageApi.php?old=2648086&old_path=image-hover-effects-ultimate%2Ftrunk%2FClasses%2FImageApi.php
  severity: high
  tags: cve,wordpress,wp-plugin,image-hover-effects-ultimate,high
