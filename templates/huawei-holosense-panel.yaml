flow: http(1) && http(2) && http(3)
http:
- matchers:
  - condition: and
    dsl:
    - contains_any(server, "SDC Server", "WebServer/1.0.0")
    - contains(body, "cmcc-login")
    - status_code == 200
    internal: true
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}'
- body: 'action=LoginState&glToken=null&stChannelId=101&channelId=101&para=

    '
  matchers:
  - condition: and
    dsl:
    - contains(body, "LOGIN_NORMAL")
    - status_code == 200
    internal: true
    type: dsl
  method: POST
  path:
  - '{{BaseURL}}/cgi-bin/main.cgi'
- body: 'action=WebTransterToRestLogout&url=GET+%2FSDCAPI%2FV1.0%2FCustomization%2FElement%0D%0A%0D%0A

    '
  extractors:
  - group: 1
    regex:
    - '"model"\s*:\s*"([^"]+)"'
    type: regex
  - group: 1
    regex:
    - '"version"\s*:\s*"([^"]+)"'
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains_all(body, 'brand', 'HoloSens SDC')
    - status_code == 200
    type: dsl
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/cgi-bin/main.cgi'
id: huawei-holosense-panel
info:
  author: darses
  description: 'Huawei HoloSens SDC Panel was discovered.

    '
  metadata:
    fofa-query:
    - '"Server: SDC Server" && protocol="https"'
    - '"Server: WebServer/1.0.0" && port="1443"'
    max-requests: 1
    product: holosense_sdc
    shodan-query:
    - 'Server: SDC Server'
    - http.html_hash:-968212412
    vendor: huawei
  name: Huawei HoloSens SDC - Panel
  reference:
  - https://www.huawei.com/en/products/intelligent-devices/holosens-sdc
  severity: info
  tags: panel,detect,huawei,holosens,iot,discovery
