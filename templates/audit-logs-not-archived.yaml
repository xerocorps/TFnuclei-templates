code:
- engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'retention: false'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'wevtutil get-log security

    '
id: audit-logs-not-archived
info:
  author: princechaddha
  description: Checks if audit logs are not archived when full, leading to potential
    data loss.
  impact: 'Failure to archive full logs could result in the loss of crucial audit
    data, hindering forensic analysis and incident response.

    '
  name: Audit Logs Not Archived When Full
  remediation: 'Enable log archiving to preserve important security event data.

    '
  severity: high
  tags: windows,audit,code,windows-audit
self-contained: true
