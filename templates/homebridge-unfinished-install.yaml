flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "<title>Homebridge")
    internal: true
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/'
- matchers:
  - part: body
    type: word
    words:
    - '"setupWizardComplete":false'
  - part: header
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/api/auth/settings'
id: homebridge-unfinished-install
info:
  author: theamanrawat
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-284
  description: 'Homebridge instance with incomplete installation detected. The setup
    wizard is exposed, allowing anyone to create the first admin account and gain
    full control over the Homebridge instance. This can lead to unauthorized access
    to smart home devices and potential network compromise.

    '
  metadata:
    fofa-query: title="Homebridge"
    max-request: 2
    shodan-query: title:"Homebridge"
    verified: true
  name: Homebridge - Unfinished Installation
  reference:
  - https://homebridge.io/
  - https://github.com/homebridge/homebridge-config-ui-x
  severity: high
  tags: homebridge,misconfig,exposure,iot,smart-home,unauth
