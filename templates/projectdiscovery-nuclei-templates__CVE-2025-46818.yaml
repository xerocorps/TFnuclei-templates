flow: javascript(1) && javascript(2)
id: CVE-2025-46818
info:
  author: pussycat0x
  description: 'Redis is an open source, in-memory database that persists on disk.
    Versions 8.2.1 and below allow an authenticated user to use a specially crafted
    Lua script to manipulate different LUA objects and potentially run their own code
    in the context of another user. The problem exists in all versions of Redis with
    LUA scripting. This issue is fixed in version 8.2.2. A workaround to mitigate
    the problem without patching the redis-server executable is to prevent users from
    executing LUA scripts. This can be done using ACL to block a script by restricting
    both the EVAL and FUNCTION command families.

    '
  impact: 'Authenticated users can execute arbitrary code in the context of other
    users, potentially leading to full system compromise.

    '
  metadata:
    max-request: 1
    shodan-query: product:"redis"
    verified: true
  name: Redis Lua Sandbox < 8.2.2 - Cross-User Escape
  reference:
  - https://github.com/dwisiswant0/CVE-2025-46818
  remediation: 'Upgrade to version 8.2.2 or later.

    '
  severity: high
  tags: cve,cve2025,js,redis,network,passive,authenticated,vuln
javascript:
- args:
    Host: '{{Host}}'
    Port: '6379'
  code: 'const redis = require(''nuclei/redis'');

    const info = redis.GetServerInfo(Host,Port);

    Export(info);

    '
  extractors:
  - group: 1
    name: version
    part: response
    regex:
    - redis_version:(\d+\.\d+\.\d+)
    type: regex
  matchers:
  - condition: and
    dsl:
    - success == true
    - compare_versions(version, ' < 8.2.2')
    type: dsl
  pre-condition: 'isPortOpen(Host,Port);

    '
- args:
    Host: '{{Host}}'
    Password: '{{passwords}}'
    Payload: return "lua enabled"
    Port: '6379'
  code: 'const redis = require(''nuclei/redis'');

    const info = redis.RunLuaScript(Host,Port,Password,Payload);

    Export(info);

    '
  matchers:
  - condition: and
    dsl:
    - success == true
    - contains(response, 'lua enabled')
    internal: true
    type: dsl
  payloads:
    passwords:
    - ''
