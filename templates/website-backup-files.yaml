http:
- attack: clusterbomb
  matchers:
  - binary:
    - 377ABCAF271C
    - '314159265359'
    - 53514c69746520666f726d6174203300
    - 1f8b
    - 526172211A0700
    - 526172211A070100
    - FD377A585A0000
    - 1F9D
    - 1FA0
    - 4C5A4950
    - 504B0304
    condition: or
    part: body
    type: binary
  - part: header
    regex:
    - application/[-\w.]+
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  max-size: 500
  method: GET
  path:
  - '{{BaseURL}}/{{FILENAME}}.{{EXT}}'
  payloads:
    EXT:
    - 7z
    - bz2
    - gz
    - lz
    - rar
    - tar.gz
    - tar.bz2
    - xz
    - zip
    - z
    - tar.z
    - db
    - sqlite
    - sqlitedb
    - sql.7z
    - sql.bz2
    - sql.gz
    - sql.lz
    - sql.rar
    - sql.tar.gz
    - sql.xz
    - sql.zip
    - sql.z
    - sql.tar.z
    - war
    - bkp.zip
    FILENAME:
    - '{{RDN}}'
    - '{{DN}}'
  threads: 10
id: website-backup-files
info:
  author: rix4uni
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-200
  description: Multiple compressed backup files were detected.
  metadata:
    max-request: 600
  name: Compressed Backup File - Detect
  reference: https://twitter.com/kingcoolvikas/status/1662805448150646784
  severity: medium
  tags: exposure,backup
