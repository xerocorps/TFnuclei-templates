http:
- body: "<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<soap:Envelope xmlns:soap=\"\
    http://schemas.xmlsoap.org/soap/envelope/\">\n  <soap:Body>\n    <GetConfig xmlns=\"\
    http://www.microsoft.com/SoftwareDistribution/Server/ClientWebService\">\n   \
    \   <protocolVersion>3.2</protocolVersion>\n    </GetConfig>\n  </soap:Body>\n\
    </soap:Envelope>\n"
  extractors:
  - group: 1
    regex:
    - <LastChange>([\d\-]+)T[\d\w\-\:\.]+</LastChange>
    type: regex
  - group: 1
    regex:
    - <Name>PackageServerShare</Name><Value>\\\\([\d\w\-\.]+)\\[\w\d\-]+</Value>
    type: regex
  headers:
    Content-Type: text/xml
    Soapaction: http://www.microsoft.com/SoftwareDistribution/Server/ClientWebService/GetConfig
  matchers:
  - type: word
    words:
    - LastChange
  - status:
    - 200
    type: status
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/ClientWebService/Client.asmx'
id: wsus-detect
info:
  author: darses
  classification:
    cve-id: todo
  description: 'Microsoft Product was detected.

    '
  metadata:
    fofa-query:
    - 'server="Microsoft-IIS" && "Content-Length: 0" && "X-Powered-By: ASP.NET" &&
      status_code="200" && header!="X-Frame-Options" && header!="Etag" && header!="Last-Modified"
      && header!="Set-Cookie" && header!="Content-Type"'
    max-requests: 2
    product: product
    shodan-query:
    - null
    vendor: microsoft
    verified: false
  name: Microsoft Product - Detect
  reference:
  - http://example.com
  severity: info
  tags: tech,microsoft
