id: mysql-empty-password
info:
  author: DhiyaneshDk
  description: 'Checks for MySQL servers with an empty password for root or anonymous.

    '
  metadata:
    max-request: 3
    shodan-query: port:3306
  name: MySQL - Empty Password
  severity: high
  tags: js,mysql,network,vuln
javascript:
- args:
    Host: '{{Host}}'
    Pass: ' '
    Port: '3306'
    User: '{{username}}'
  code: 'var m = require("nuclei/mysql");

    var c = m.MySQLClient();

    c.Connect(Host,Port,User,Pass)

    '
  matchers:
  - condition: and
    dsl:
    - response == true
    - success == true
    type: dsl
  payloads:
    usernames:
    - root
    - anonymous
  pre-condition: 'isPortOpen(Host,Port);

    '
  stop-at-first-match: true
