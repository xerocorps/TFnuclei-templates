id: aws-cloudfront-service
info:
  author: jiheon-dev
  description: Detect websites using AWS cloudfront service
  name: AWS Cloudfront service detection
  severity: info
  tags: aws,tech,service
requests:
- matchers:
  - condition: or
    dsl:
    - 'contains(tolower(all_headers), ''x-cache: hit from cloudfront'')'
    - 'contains(tolower(all_headers), ''x-cache: refreshhit from cloudfront'')'
    - 'contains(tolower(all_headers), ''x-cache: miss from cloudfront'')'
    - 'contains(tolower(all_headers), ''x-cache: error from cloudfront'')'
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}'
