id: CVE-2017-12149
info:
  author: fopina
  classification:
    cve-id: CVE-2017-12149
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-502
  description: Jboss Application Server as shipped with Red Hat Enterprise Application
    Platform 5.2 is susceptible to a remote code execution vulnerability because  the
    doFilter method in the ReadOnlyAccessFilter of the HTTP Invoker does not restrict
    classes for which it performs deserialization, thus allowing an attacker to execute
    arbitrary code via crafted serialized data.
  name: Jboss Application Server - Remote Code Execution
  reference:
  - https://chowdera.com/2020/12/20201229190934023w.html
  - https://github.com/vulhub/vulhub/tree/master/jboss/CVE-2017-12149
  - https://nvd.nist.gov/vuln/detail/CVE-2017-12149
  - https://bugzilla.redhat.com/show_bug.cgi?id=1486220
  severity: critical
  tags: cve,cve2017,jboss,java,rce,deserialization
requests:
- matchers:
  - part: body
    type: word
    words:
    - ClassCastException
  - part: header
    type: word
    words:
    - application/x-java-serialized-object
  matchers-condition: and
  raw:
  - 'POST /invoker/JMXInvokerServlet/ HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/octet-stream


    {{ base64_decode("rO0ABXNyABNqYXZhLnV0aWwuQXJyYXlMaXN0eIHSHZnHYZ0DAAFJAARzaXpleHAAAAACdwQAAAACdAAJZWxlbWVudCAxdAAJZWxlbWVudCAyeA==")
    }}

    '
  - 'POST /invoker/EJBInvokerServlet/ HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/octet-stream


    {{ base64_decode("rO0ABXNyABNqYXZhLnV0aWwuQXJyYXlMaXN0eIHSHZnHYZ0DAAFJAARzaXpleHAAAAACdwQAAAACdAAJZWxlbWVudCAxdAAJZWxlbWVudCAyeA==")
    }}

    '
