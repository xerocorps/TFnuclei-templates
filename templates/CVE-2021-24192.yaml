http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - tree-website-map
  - dsl:
    - compare_versions(version, '<= 2.9')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/tree-website-map/readme.txt'
  redirects: true
id: CVE-2021-24192
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24192
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: Low privileged users can use the AJAX action 'cp_plugins_do_button_job_later_callback'
    in the Tree Sitemap WordPress plugin before 2.9, to install any plugin (including
    a specific version) from the WordPress repository, as well as activate arbitrary
    plugin from then blog, which helps attackers install vulnerable plugins and could
    lead to more critical vulnerabilities like RCE.
  metadata:
    fofa-query: wp-content/plugins/tree-website-map/
    google-query: inurl:"/wp-content/plugins/tree-website-map/"
    shodan-query: vuln:CVE-2021-24192
  name: Tree Sitemap (Pages, Posts & Categories list) <= 2.9 - Missing Authorization
    to Arbitrary Plugin Installation/Activation
  reference:
  - https://wpscan.com/vulnerability/74889e29-5349-43d1-baf5-1622493be90c
  severity: high
  tags: cve,wordpress,wp-plugin,tree-website-map,high
