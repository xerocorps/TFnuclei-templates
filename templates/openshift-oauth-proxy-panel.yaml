http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - OpenShift
    - Log in with
  - name: csrf-cookie-header
    part: header
    regex:
    - (?i)_oauth_proxy_csrf=[^;]+
    - (?i)_oauth_proxy=[^;]*
    type: regex
  - status:
    - 403
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{RootURL}}:9001'
  stop-at-first-match: true
id: openshift-oauth-proxy-panel
info:
  author: r3dg33k
  description: 'Detects OpenShift OAuth Proxy login endpoints via `_oauth_proxy_csrf`
    or `_oauth_proxy` cookie and login page content. Checks both the default port
    and port 9001.

    '
  metadata:
    fofa-query: body="Openshift" && port="9001"
    max-request: 2
    verified: true
  name: OpenShift OAuth Proxy - Panel Detect
  severity: info
  tags: openshift,redhat,detect,oauth,proxy,login,discovery
