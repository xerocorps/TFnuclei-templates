http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-staging
  - dsl:
    - compare_versions(version, '<= 3.4.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-staging/readme.txt'
  redirects: true
id: CVE-2024-3682-e9cb294ed402d6aaed5331aaec315bcd
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-3682
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
  description: 'The WP STAGING and WP STAGING Pro plugins for WordPress are vulnerable
    to Sensitive Information Exposure in versions up to, and including, 3.4.3, and
    versions up to, and including, 5.4.3, respectively, via the ajaxSendReport function.
    This makes it possible for unauthenticated attackers to extract sensitive data
    from a log file, including system information and (in the Pro version) license
    keys. Successful exploitation requires an administrator to have used the ''Contact
    Us'' functionality along with the "Enable this option to automatically submit
    the log files." option.

    '
  metadata:
    fofa-query: wp-content/plugins/wp-staging/
    google-query: inurl:"/wp-content/plugins/wp-staging/"
    shodan-query: vuln:CVE-2024-3682
  name: 'WP STAGING <= 3.4.3 and WP STAGING Pro <= 5.4.3 - Sensitive Information Exposure
    via Log File

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/75eab54b-dbe0-4440-b4ab-601c5041e180?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,wp-staging,medium
