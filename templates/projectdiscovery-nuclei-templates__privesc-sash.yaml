code:
- engine:
  - sh
  - bash
  source: 'whoami

    '
- engine:
  - sh
  - bash
  source: 'sash -c ''whoami''

    '
- engine:
  - sh
  - bash
  matchers:
  - negative: true
    part: code_1_response
    type: word
    words:
    - root
  - condition: or
    dsl:
    - contains(code_2_response, "root")
    - contains(code_3_response, "root")
    type: dsl
  matchers-condition: and
  source: 'sudo sash -c ''whoami''

    '
id: privesc-sash
info:
  author: daffainfo
  description: 'sash is a stand-alone shell that is commonly used for system recovery
    and maintenance. It provides a minimal set of commands and features, making it
    useful in situations where the regular shell environment may not be available
    or functional. sash is often used in emergency situations to troubleshoot and
    repair systems.

    '
  metadata:
    max-request: 3
    verified: true
  name: sash - Privilege Escalation
  reference:
  - https://gtfobins.github.io/gtfobins/sash/
  severity: high
  tags: code,linux,sash,privesc,local
self-contained: true
