id: ftp-anonymous-login
info:
  author: C3l3si4n,pussycat0x
  description: 'Anonymous FTP access allows anyone to access your public_ftp folder,
    allowing unidentified visitors to download (and possibly upload) files on your
    website. Anonymous FTP creates the potential for a security hole for hackers and
    is not recommended.

    '
  metadata:
    max-request: 1
    verified: true
  name: FTP Anonymous Login
  reference:
  - https://tools.ietf.org/html/rfc2577
  severity: medium
  tags: network,ftp,default-login,tcp,vuln
tcp:
- host:
  - '{{Hostname}}'
  inputs:
  - data: "USER anonymous\r\n"
    read: 1024
  - data: "PASS anonymous\r\n"
    read: 1024
  matchers:
  - condition: or
    part: raw
    type: word
    words:
    - Anonymous access allowed,
    - Logged in anonymously
    - Anonymous user logged
    - Login successful
    - Guest login ok
  - condition: or
    negative: true
    part: raw
    type: word
    words:
    - HTTP/1.1
    - '230.'
    - '.230'
    - User cannot log
    - ESMTP
  matchers-condition: and
  port: 21
