code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: appServiceList
    type: json
  source: 'az webapp list --output json --query ''[*].{id:id}''

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - id + " does not have Microsoft Entra ID configured"
    type: dsl
  matchers:
  - part: all
    type: word
    words:
    - ''
  source: 'az webapp identity show --ids "$ids" --query ''principalId'' --output json

    '
flow: "code(1);\nfor (let AppServiceData of iterate(template.appServiceList)) {\n\
  \  AppServiceData = JSON.parse(AppServiceData);\n  set(\"id\", AppServiceData.id);\n\
  \  code(2);\n}\n"
id: azure-appservice-entra-id-missing
info:
  author: princechaddha
  description: 'Ensure that registration with Microsoft Entra ID is enabled for Microsoft
    Azure App Service web applications so that your applications can connect to other
    Azure cloud services securely without the need of access credentials such as user
    names and passwords.

    '
  impact: 'If the Microsoft Entra ID is not configured, it could prevent secure and
    simplified access to cloud services, potentially leading to manual management
    of credentials and increased security risks.

    '
  name: Azure App Service Microsoft Entra ID Not Configured
  reference:
  - https://docs.microsoft.com/en-us/azure/app-service/overview-managed-identity
  remediation: 'Enable the Microsoft Entra ID for Azure App Services to ensure secure
    connectivity to other Azure services without manual credential handling.

    '
  severity: medium
  tags: cloud,devops,azure,microsoft,appservice,azure-cloud-config
self-contained: true
