http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - oauth-client-for-user-authentication
  - dsl:
    - compare_versions(version, '<= 3.0.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/oauth-client-for-user-authentication/readme.txt'
  redirects: true
id: CVE-2022-3119-oauth_client_for_user_authentication-b028a70d-f103-4232-b854-17b88d4dc7d9
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-3119
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 7.3
  description: 'The OAuth client Single Sign On for WordPress ( OAuth 2.0 SSO ) plugin
    for WordPress is vulnerable to authorization bypass due to a missing capability
    check on the save_oauthclient_config() function that is hooked via ''init'' in
    versions up to, and including, 3.0.3. This makes it possible for unauthenticated
    attackers to modify the plugin''s oAuth settings which could lead to unauthorized
    and high privileged access to a vulnerable site.

    '
  metadata:
    fofa-query: wp-content/plugins/oauth-client-for-user-authentication/
    google-query: inurl:"/wp-content/plugins/oauth-client-for-user-authentication/"
    shodan-query: http.html:"wp-content/plugins/oauth-client-for-user-authentication/"
  name: 'OAuth client Single Sign On for WordPress ( OAuth 2.0 SSO ) <= 3.0.3 - Missing
    Authorization

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/b028a70d-f103-4232-b854-17b88d4dc7d9?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,oauth-client-for-user-authentication,high,production
