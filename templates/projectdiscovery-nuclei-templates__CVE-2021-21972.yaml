http:
- matchers:
  - condition: and
    part: header
    type: word
    words:
    - VSPHERE-UI-JSESSIONID
  - part: body
    regex:
    - (Install|Config) Final Progress
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/ui/vropspluginui/rest/services/getstatus'
id: CVE-2021-21972
info:
  author: dwisiswant0
  classification:
    cpe: cpe:2.3:a:vmware:cloud_foundation:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-21972
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-22
    epss-percentile: 0.99846
    epss-score: 0.93795
  description: VMware vCenter vSphere Client (HTML5) contains a remote code execution
    vulnerability in a vCenter Server plugin. A malicious actor with network access
    to port 443 may exploit this issue to execute commands with unrestricted privileges
    on the underlying operating system that hosts vCenter Server. This affects VMware
    vCenter Server (7.x before 7.0 U1c, 6.7 before 6.7 U3l and 6.5 before 6.5 U3n)
    and VMware Cloud Foundation (4.x before 4.2 and 3.x before 3.10.1.2).
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the affected system.

    '
  metadata:
    max-request: 1
    product: cloud_foundation
    vendor: vmware
  name: VMware vSphere Client (HTML5) - Remote Code Execution
  reference:
  - https://swarm.ptsecurity.com/unauth-rce-vmware/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-21972
  - https://www.vmware.com/security/advisories/VMSA-2021-0002.html
  - http://packetstormsecurity.com/files/161590/VMware-vCenter-Server-7.0-Arbitrary-File-Upload.html
  - https://github.com/NS-Sp4ce/CVE-2021-21972
  remediation: 'Apply the necessary security patches or updates provided by VMware
    to mitigate this vulnerability.

    '
  severity: critical
  tags: cve2021,cve,vmware,rce,vcenter,kev,packetstorm,vkev,vuln
