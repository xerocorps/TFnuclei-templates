http:
- matchers:
  - status:
    - 200
    type: status
  - dsl:
    - contains(tolower(content_type), 'application/javascript')
    type: dsl
  - condition: or
    part: body
    type: word
    words:
    - module.exports
    - const audience
    - const domain
    - NODE_ENV
    - LOG_LEVEL
    - TOKEN
    - KEY
    - PASSWORD
    - VERSION
    - window.__ENV =
  - condition: or
    negative: true
    part: body
    type: word
    words:
    - Bootstrap
    - jQuery
    - CSS TRANSITION SUPPORT
    - is_ad_blocked
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/env.js'
  - '{{BaseURL}}/env.development.js'
  - '{{BaseURL}}/env.production.js'
  - '{{BaseURL}}/env.test.js'
  - '{{BaseURL}}/env.dev.js'
  - '{{BaseURL}}/env.prod.js'
  - '{{BaseURL}}/__ENV.js'
  stop-at-first-match: true
id: javascript-env
info:
  author: pdp,geeknik,hetyh
  description: Multiple common JavaScript environment configuration files were detected.
  metadata:
    max-request: 7
  name: JavaScript Environment Configuration - Detect
  severity: low
  tags: javascript,config,exposure,vuln
