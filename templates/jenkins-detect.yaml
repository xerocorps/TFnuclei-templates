id: jenkins-detect
info:
  author: philippdelteil,daffainfo,c-sh0
  metadata:
    shodan-query: http.favicon.hash:81586312
  name: Jenkins Detection
  reference:
  - https://www.jenkins.io/doc/book/using/remote-access-api/#RemoteaccessAPI-DetectingJenkinsversion
  - https://github.com/jenkinsci/jenkins/pull/470
  - https://www.jenkins.io/doc/book/security/access-control/permissions/#access-granted-without-overallread
  severity: info
  tags: tech,jenkins
requests:
- extractors:
  - kval:
    - x_jenkins
    type: kval
  matchers:
  - case-insensitive: true
    part: header
    type: word
    words:
    - x-jenkins
  - type: word
    words:
    - Jenkins
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/whoAmI/'
  redirects: true
  stop-at-first-match: true
