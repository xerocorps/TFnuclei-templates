http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - cardgate
  - dsl:
    - compare_versions(version, '< 3.1.16')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/cardgate/readme.txt'
  redirects: true
id: CVE-2020-8819
info:
  author: topscoder
  classification:
    cve-id: CVE-2020-8819
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 8.1
  description: An issue was discovered in the CardGate Payments plugin through 3.1.15
    for WooCommerce. Lack of origin authentication in the IPN callback processing
    function in cardgate/cardgate.php allows an attacker to remotely replace critical
    plugin settings (merchant ID, secret key, etc.) and therefore bypass the payment
    process (e.g., spoof an order status by manually sending an IPN callback request
    with a valid signature but without real payment) and/or receive all of the subsequent
    payments.
  metadata:
    fofa-query: wp-content/plugins/cardgate/
    google-query: inurl:"/wp-content/plugins/cardgate/"
    shodan-query: vuln:CVE-2020-8819
  name: CardGate Payments for WooCommerce <= 3.1.15 - Lack of Origin Validation
  reference:
  - https://github.com/cardgate/woocommerce/blob/f2111af7b1a3fd701c1c5916137f3ac09482feeb/cardgate/cardgate.php#L426-L442
  - https://github.com/cardgate/woocommerce/issues/18
  - http://packetstormsecurity.com/files/156504/WordPress-WooCommerce-CardGate-Payment-Gateway-3.1.15-Bypass.html
  - https://www.exploit-db.com/exploits/48134
  - https://wpvulndb.com/vulnerabilities/10097
  severity: high
  tags: cve,wordpress,wp-plugin,cardgate,high
