http:
- attack: clusterbomb
  cookie-reuse: true
  matchers:
  - dsl:
    - status_code < 210 && status_code >= 200
    - to_number(forbidden_status_code) != status_code
    name: Access Restriction Bypass Via Origin Spoof
    type: dsl
  payloads:
    origin_host:
    - 127.0.0.1
    - localhost
    - '{{resolve("{{FQDN}}")}}'
    origin_port:
    - null
    - :80
    - :443
    origin_schema:
    - http://
    - https://
  raw:
  - 'GET {{BaseURL}} HTTP/1.1

    Host: {{Hostname}}

    Origin: {{origin_schema}}{{origin_host}}{{origin_port}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
    like Gecko) Chrome/116.0.0.0 Safari/537.36

    Accept: */*

    '
  stop-at-first-match: true
id: ASVS-4-0-3-V13-2-3
info:
  author: Masoud Abdaal
  classification:
    cwe-id: CWE-352
  description: 'Verify that RESTful web services that utilize cookies are protected
    from Cross-Site Request Forgery via the use of at least one or more of the following:
    double submit cookie pattern, CSRF nonces, or Origin request header checks

    '
  name: ASVS 13.2.3 Check
  reference:
  - https://github.com/OWASP/ASVS/blob/master/4.0/en/0x21-V13-API.md#v132-restful-web-service
  severity: medium
  tags: asvs,13.2.3
