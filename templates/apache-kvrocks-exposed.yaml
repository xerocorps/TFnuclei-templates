id: apache-kvrocks-exposed
info:
  author: icarot
  description: 'Detects if an Apache Kvrocks server is exposed with no authentication
    credentials, this application is a distributed key value NoSQL database that uses
    RocksDB as storage engine and is compatible with Redis protocol.

    '
  metadata:
    max-request: 1
    verified: true
  name: Apache Kvrocks - Exposed
  reference:
  - https://github.com/apache/kvrocks
  severity: high
  tags: apache,kvrocks,network,unauth,js,exposed
javascript:
- args:
    Host: '{{Host}}'
    Port: '6379'
  code: 'const redis = require(''nuclei/redis'');

    const info = redis.GetServerInfo(Host,Port);

    Export(info);

    '
  extractors:
  - part: response
    regex:
    - kvrocks_version:[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}
    - kvrocks_git_sha1:\w+
    - kvrocks_mode:standalone
    type: regex
  matchers:
  - condition: or
    type: word
    words:
    - kvrocks_version
    - kvrocks_git_sha1
    - kvrocks_mode
  matchers-condition: and
  pre-condition: 'isPortOpen(Host,Port);

    '
