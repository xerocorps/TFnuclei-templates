http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"responseHeader":'
    - '"solr.jetty":'
    - system.env
  - part: header
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/solr/admin/metrics'
id: CVE-2023-50290
info:
  author: Banana69,DhiyaneshDK
  classification:
    cpe: cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-50290
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 6.5
    cwe-id: CWE-200,NVD-CWE-noinfo
    epss-percentile: 0.99772
    epss-score: 0.93074
  description: 'Exposure of Sensitive Information to an Unauthorized Actor Vulnerability
    in Apache Solr.

    The Solr Metrics API publishes all unprotected environment variables available
    to each Apache Solr instance. Users can specify which environment variables to
    hide, however, the default list is designed to work for known secret Java system
    properties. Environment variables cannot be strictly defined in Solr, like Java
    system properties can be, and may be set for the entire host,unlike Java system
    properties which are set per-Java-proccess.

    '
  impact: 'This vulnerability can lead to the exposure of sensitive information, potentially
    allowing an attacker to gain unauthorized access or perform further attacks.

    '
  metadata:
    fofa-query:
    - title="solr admin"
    - title="apache solr"
    google-query:
    - intitle:"apache solr"
    - intitle:"solr admin"
    max-request: 1
    product: solr
    shodan-query:
    - title:"Apache Solr"
    - http.title:"apache solr"
    - cpe:"cpe:2.3:a:apache:solr"
    - http.title:"solr admin"
    vendor: apache
  name: Apache Solr - Host Environment Variables Leak via Metrics API
  reference:
  - https://solr.apache.org/security.html#cve-2023-50290-apache-solr-allows-read-access-to-host-environment-variables
  - https://x.com/sirifu4k1/status/1746755165066236216?s=20
  - https://nvd.nist.gov/vuln/detail/CVE-2023-50290
  - https://github.com/wy876/POC
  - https://github.com/wy876/wiki
  remediation: Users are recommended to upgrade to version 9.3.0 or later, in which
    environment variables are not published via the Metrics API.
  severity: medium
  tags: cve,cve2023,apache,solr,exposure,vuln
