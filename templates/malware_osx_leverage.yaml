file:
- extensions:
  - all
  matchers:
  - condition: and
    type: word
    words:
    - ioreg -l | grep "IOPlatformSerialNumber" | awk -F
    - '+:Users:Shared:UserEvent.app:Contents:MacOS:'
    - rm '/Users/Shared/UserEvent.app/Contents/Resources/UserEvent.icns'
    - osascript -e 'tell application "System Events" to get the hidden of every login
      item'
    - osascript -e 'tell application "System Events" to get the name of every login
      item'
    - osascript -e 'tell application "System Events" to get the path of every login
      item'
    - "serverVisible \0"
  matchers-condition: and
id: malware_osx_leverage
info:
  author: daffainfo
  name: OSX Leverage Malware Detector
  reference: https://github.com/Yara-Rules/rules/blob/master/malware/MALW_OSX_Leverage.yar
  severity: critical
  tags: malware,file
