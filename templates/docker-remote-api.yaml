expression: r0() && r1()
id: docker-remote-api
info:
  author: zan8in
  description: 'fofa: port="2375" && server="docker"

    '
  name: Docker Remote API
  reference:
  - http://wiki.peiqi.tech/redteam/vulnerability/unauthorized/Docker%202375%E7%AB%AF%E5%8F%A3.html
  severity: critical
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'KernelVersion')
      && response.body.bcontains(b'BuildTime') && response.content_type.contains("application/json")
    request:
      method: GET
      path: /version
  r1:
    expression: response.status == 200 && response.content_type.contains("application/json")
    request:
      method: GET
      path: /containers/json
