http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - download-monitor
  - dsl:
    - compare_versions(version, '<= 4.5.9')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/download-monitor/readme.txt'
  redirects: true
id: CVE-2022-2222
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-2222
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 4.9
  description: The Download Monitor WordPress plugin before 4.5.91 does not ensure
    that files to be downloaded are inside the blog folders, and not sensitive, allowing
    high privilege users such as admin to download the wp-config.php or /etc/passwd
    even in an hardened environment or multisite setup.
  metadata:
    fofa-query: wp-content/plugins/download-monitor/
    google-query: inurl:"/wp-content/plugins/download-monitor/"
    shodan-query: vuln:CVE-2022-2222
  name: Download Monitor <= 4.5.9 - Authenticated Arbitrary File Download
  reference:
  - https://wpscan.com/vulnerability/dd48624a-1781-419c-a3c4-1e3eaf5e2c1b
  - https://patchstack.com/database/vulnerability/download-monitor-/wordpress-download-monitor-plugin-4-5-9-authenticated-arbitrary-file-download-vulnerability
  severity: medium
  tags: cve,wordpress,wp-plugin,download-monitor,medium
