code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[].projectId
    name: projectIds
    type: json
  source: 'gcloud projects list --format="json(projectId)"

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"The default VPC network is in use in project " + projectId'
    type: dsl
  matchers:
  - part: body
    type: word
    words:
    - '"name": "default"'
  source: 'gcloud compute networks list --project $projectId --format="json(name)"

    '
flow: "code(1)\nfor(let projectId of iterate(template.projectIds)){\n  set(\"projectId\"\
  , projectId)\n  code(2)\n}\n"
id: gcloud-default-vpc-in-use
info:
  author: princechaddha
  description: 'Ensure that your Google Cloud Platform (GCP) projects are not using
    the default Virtual Private Cloud (VPC) network. Using the default VPC network
    does not adhere to security best practices and may not meet specific networking
    requirements.

    '
  impact: 'Using the default VPC network can expose your infrastructure to security
    risks due to overly permissive rules and configurations.

    '
  name: Default VPC Network In Use
  reference:
  - https://cloud.google.com/vpc/docs/vpc
  remediation: 'Delete the default VPC network and create custom VPC networks with
    tailored configurations to meet your organization''s security and networking requirements.

    '
  severity: medium
  tags: cloud,devops,gcp,gcloud,google-cloud-vpc,networking,security,gcp-cloud-config
self-contained: true
