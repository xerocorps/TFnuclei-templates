expression: r0()
id: xerox-workcentre7-default-password
info:
  author: MiroslavSotak
  description: Testing default credentials admin:1111 on Xerox WorkCentre 7xxx printer.
  name: Xerox WorkCentre 7xxx - Default Login
  severity: high
  verified: false
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'window.opener.top.location.pathname')
      && response.body.bcontains(b'Xerox Corporation')  && (response.body.bcontains(b'invalid')
      || response.body.bcontains(b'errmsg'))
    request:
      body: _fun_function=HTTP_Authenticate_fn&NextPage=%2Fproperties%2Fauthentication%2FluidLogin.php&webUsername=admin&webPassword=1111&frmaltDomain=default
      method: POST
      path: /userpost/xerox.set
