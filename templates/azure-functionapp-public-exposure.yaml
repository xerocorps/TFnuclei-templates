code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: functionApps
    type: json
  source: 'az functionapp list --output json --query ''[*].{name:name, resourceGroup:resourceGroup}''

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - name + " is publicly accessible and should restrict network access"
    type: dsl
  matchers:
  - type: word
    words:
    - Enabled
  source: 'az functionapp show --name $name --resource-group $resourceGroup --query
    ''publicNetworkAccess'' --output json

    '
flow: "code(1);\nfor (let AppData of iterate(template.functionApps)) {\n  AppData\
  \ = JSON.parse(AppData);\n  set(\"name\", AppData.name);\n  set(\"resourceGroup\"\
  , AppData.resourceGroup);\n  code(2);\n}\n"
id: azure-functionapp-public-exposure
info:
  author: princechaddha
  description: 'To follow Azure cloud security best practices and prevent public exposure,
    ensure that the functions managed with Microsoft Azure Function App are not publicly
    accessible. An Azure function is considered publicly accessible when it is configured
    to allow inbound access through the default (public) endpoint.

    '
  impact: 'Allowing public network access to Azure Functions can expose sensitive
    business logic and data to potential security risks.

    '
  name: Exposed Azure Functions
  reference:
  - https://docs.microsoft.com/en-us/azure/azure-functions/functions-networking-options
  remediation: 'Configure Azure Functions to restrict access from the public network
    by setting the ''publicNetworkAccess'' to ''Disabled''.

    '
  severity: high
  tags: cloud,devops,azure,microsoft,functionapp,azure-cloud-config
self-contained: true
