http:
- extractors:
  - group: 1
    name: version
    regex:
    - Apache Tomcat/([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - Apache Tomcat
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/manager/status'
  - '{{BaseURL}}:8080/manager/status'
  - '{{BaseURL}}:8000/manager/status'
- attack: batteringram
  extractors:
  - group: 1
    name: jmx_port
    regex:
    - :([0-9]+)
    type: regex
  matchers:
  - condition: and
    type: word
    words:
    - JMX
    - RMI
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}:{{jmx_ports}}'
  payloads:
    jmx_ports:
    - '1099'
    - '9999'
    - '8999'
- extractors:
  - name: jmxproxy
    regex:
    - JMXProxyServlet
    type: regex
  matchers:
  - type: word
    words:
    - JMXProxyServlet
  - dsl:
    - version != "" && jmx_port != "" && (version < "6.0.48" || (version >= "7.0.0"
      && version < "7.0.73") || (version >= "8.0.0" && version < "8.0.39") || (version
      >= "8.5.0" && version < "8.5.7") || (version >= "9.0.0" && version < "9.0.0.M12"))
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/manager/jmxproxy'
id: CVE-2016-8735-tomcat-jmx-rce
info:
  author: your_github_username
  classification:
    cve-id: CVE-2016-8735
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
  description: Apache Tomcat versions before 6.0.48, 7.x before 7.0.73, 8.x before
    8.0.39, 8.5.x before 8.5.7, and 9.x before 9.0.0.M12 are vulnerable to remote
    code execution if JmxRemoteLifecycleListener is used and the JMX ports are exposed.
  name: Apache Tomcat JMX Remote Code Execution
  reference:
  - http://rhn.redhat.com/errata/RHSA-2017-0457.html
  - http://www.securityfocus.com/bid/94463
  - http://tomcat.apache.org/security-9.html
  severity: critical
  tags: cve,cve2016,apache,tomcat,rce,jmx
