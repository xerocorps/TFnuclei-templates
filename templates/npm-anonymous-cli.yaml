id: npm-anonymous-cli
info:
  author: DhiyaneshDK
  metadata:
    shodan-query: html:"anonymous-cli-metrics.json"
    verified: true
  name: NPM Anonymous CLI Metrics Exposure
  reference:
  - https://github.com/maurosoria/dirsearch/blob/master/db/dicc.txt
  severity: info
  tags: exposure,npm,config,files
requests:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"metricId":'
    - '"metrics":'
    - '"successfulInstalls":'
  - part: header
    type: word
    words:
    - application/json
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/.npm/anonymous-cli-metrics.json'
  - '{{BaseURL}}/anonymous-cli-metrics.json'
  stop-at-first-match: true
