http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '8.x-1.3')
    - compare_versions(version, '8.x-1.2')
    - compare_versions(version, '8.x-1.1')
    - compare_versions(version, '8.x-1.0')
    - compare_versions(version, '7.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - samlauth
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/samlauth/samlauth.info'
  redirects: true
id: drupal_module-samlauth-access-bypass
info:
  author: Bishopfox
  description: The SAML Authentication module allows users to authenticate against
    a SAML identity provider to login to your Drupal site. The module doesnt sufficiently
    protect against unauthorized local access, by way of using the password reset
    facility, for users who are supposed to only be able to log in through the identity
    provider. This creates a scenario where after such a user is blocked from logging
    in through the identity provider but not explicitly blocked in Drupal, they are
    still able to log in by sending themselves a Drupal password reset e-mail.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/samlauth/
    google-query: inurl:'/sites/all/modules/samlauth/
    impact: medium
    security-risk: "Moderately critical 14\u221525 AC:Basic/A:User/CI:Some/II:Some/E:Theoretical/TD:All"
    type: indicator
    vulnerability: access-bypass
  name: drupal_module-samlauth-access-bypass
  reference:
  - https://www.drupal.org/sa-contrib-2021-006
  severity: medium
  tags: drupal
