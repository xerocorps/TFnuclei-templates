http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - litespeed-cache
  - dsl:
    - compare_versions(version, '<= 6.3.0.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/litespeed-cache/readme.txt'
  redirects: true
id: CVE-2024-28000-litespeed_cache-104badec-6e6e-44bb-936b-d135dd80890d
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-28000
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The LiteSpeed Cache plugin for WordPress is vulnerable to privilege
    escalation in all versions up to, and including, 6.3.0.1. This is due to the plugin
    not properly restricting the role simulation functionality allowing a user to
    set their current ID to that of an administrator, if they have access to a valid
    hash which can be found in the debug logs or brute forced. This makes it possible
    for unauthenticated attackers to spoof their user ID to that of an administrator,
    and then create a new user account with the administrator role utilizing the /wp-json/wp/v2/users
    REST API endpoint. In some environments, the crawler may be disabled making this
    a non-exploitable issue in those instances.

    '
  metadata:
    fofa-query: wp-content/plugins/litespeed-cache/
    google-query: inurl:"/wp-content/plugins/litespeed-cache/"
    shodan-query: http.html:"wp-content/plugins/litespeed-cache/"
  name: 'LiteSpeed Cache <= 6.3.0.1 - Unauthenticated Privilege Escalation

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/104badec-6e6e-44bb-936b-d135dd80890d?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,litespeed-cache,critical,production
