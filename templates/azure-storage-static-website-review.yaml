code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: accountList
    type: json
  source: 'az storage account list --query ''[*].{"Name":name}''

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - name + " is configured to host static websites"
    type: dsl
  matchers:
  - type: word
    words:
    - 'true'
  matchers-condition: and
  source: 'az storage blob service-properties show --account-name "$name" --query
    ''staticWebsite.enabled''

    '
flow: "code(1);\nfor (let accountData of iterate(template.accountList)) {\n  accountData\
  \ = JSON.parse(accountData);\n  set(\"name\", accountData.Name);\n  code(2);\n}\n"
id: azure-storage-static-website-review
info:
  author: princechaddha
  description: 'Ensure that all the Microsoft Azure Storage accounts configured to
    host static websites are regularly reviewed for security and compliance purposes.
    Upon enabling this rule on your Cloud Conformity console, you must specify the
    storage account or the list of storage accounts that are expected to host static
    content (HTML, CSS, JavaScript, and image files).

    '
  impact: 'Failing to review storage accounts hosting static websites can lead to
    potential security risks and non-compliance with data handling standards.

    '
  name: Azure Storage Static Website Configuration Review
  reference:
  - https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blob-static-website
  remediation: 'Regularly review your Azure Storage accounts that host static websites
    and ensure they comply with security and data protection standards.

    '
  severity: medium
  tags: cloud,devops,azure,microsoft,storage-account,azure-cloud-config
self-contained: true
