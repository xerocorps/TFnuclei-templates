http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - twenty20
  - dsl:
    - compare_versions(version, '1.6.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/twenty20/readme.txt'
  redirects: true
id: CVE-2024-6297-05b8b2a97ccecc2fd598cd6786810965
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-6297
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
  description: 'Several plugins for WordPress hosted on WordPress.org have been compromised
    and injected with malicious PHP scripts. A malicious threat actor compromised
    the source code of various plugins and injected code that exfiltrates database
    credentials and is used to create new, malicious, administrator users and send
    that data back to a server. Currently, not all plugins have been patched and we
    strongly recommend uninstalling the plugins for the time being and running a complete
    malware scan.

    '
  metadata:
    fofa-query: wp-content/plugins/twenty20/
    google-query: inurl:"/wp-content/plugins/twenty20/"
    shodan-query: vuln:CVE-2024-6297
  name: 'Several WordPress.org Plugins <= Various Versions  - Injected Backdoor

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/56d24bc8-4a1a-4e60-aec5-960703a6058a?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,twenty20,critical
