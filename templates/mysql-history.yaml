http:
- matchers:
  - condition: or
    type: word
    words:
    - _HiStOrY_V2_
    - show databases;
  - part: header
    type: word
    words:
    - application/octet-stream
    - text/plain
    - filename=".mysql_
  - negative: true
    part: response
    type: word
    words:
    - <?xml
    - <env
    - application/javascript
    - application/json
    - application/xml
    - html>
    - text/html
    - image/
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/.mysql_history'
id: mysql-history
info:
  author: kazet
  description: 'The mysql_history file is a history file used by the MySQL command-line
    client (mysql) to store a record of the SQL commands and statements entered by
    a user during their interactive MySQL sessions. It serves as a command history
    for the MySQL client, allowing users to recall and reuse previously executed SQL
    commands.

    '
  metadata:
    max-request: 1
    shodan-query: html:"mysql_history"
    verified: true
  name: Mysql History - File Disclosure
  reference:
  - http://doc.docs.sk/mysql-refman-5.5/mysql-history-file.html
  severity: low
  tags: misconfig,disclosure,config
