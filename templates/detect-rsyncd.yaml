id: detect-rsyncd
info:
  author: geeknik
  name: Detect rsyncd
  reference: https://linux.die.net/man/1/rsync
  severity: info
  tags: network,rsyncd
network:
- extractors:
  - regex:
    - 'RSYNCD: \d\d.\d'
    type: regex
  host:
  - '{{Hostname}}'
  - '{{Hostname}}:873'
  inputs:
  - data: "?\r\n"
  matchers:
  - condition: and
    type: word
    words:
    - 'RSYNCD: '
    - 'ERROR: protocol startup error'
