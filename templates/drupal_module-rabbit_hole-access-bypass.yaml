http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '7.x-2.24')
    - compare_versions(version, '7.x-2.23')
    - compare_versions(version, '7.x-2.22')
    - compare_versions(version, '7.x-2.21')
    - compare_versions(version, '7.x-2.3')
    - compare_versions(version, '7.x-2.2')
    - compare_versions(version, '7.x-2.1')
    - compare_versions(version, '7.x-2.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - rabbit_hole
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/rabbit_hole/rabbit_hole.info'
  redirects: true
id: drupal_module-rabbit_hole-access-bypass
info:
  author: Bishopfox
  description: The Rabbit Hole module allows administrators to control what should
    happen when a regular user tries to view an entity at its own page; for example,
    it may deliver a 403 Access Denied or 404 Page Not Found response, or redirect
    the user to another path. The module doesnt respect the Rabbit Hole settings when
    an entity is being requested with a certain header. This could lead to certain
    data being exposed even if it shouldnt be. The vulnerability is mitigated by the
    fact that the user also needs permission to view the content being requested.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/rabbit_hole/
    google-query: inurl:'/sites/all/modules/rabbit_hole/
    impact: medium
    security-risk: "Moderately critical 14\u221525 AC:None/A:None/CI:Some/II:None/E:Theoretical/TD:Default"
    type: indicator
    vulnerability: access-bypass
  name: drupal_module-rabbit_hole-access-bypass
  reference:
  - https://www.drupal.org/sa-contrib-2019-029
  severity: medium
  tags: drupal
