http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-statistics
  - dsl:
    - compare_versions(version, '<= 13.1.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-statistics/readme.txt'
  redirects: true
id: CVE-2022-0513-d611c1315b3faed11745a63d6bb90a43
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-0513
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The WP Statistics WordPress plugin is vulnerable to SQL Injection
    due to insufficient escaping and parameterization of the exclusion_reason parameter
    found in the ~/includes/class-wp-statistics-exclusion.php file which allows attackers
    without authentication to inject arbitrary SQL queries to obtain sensitive information,
    in versions up to and including 13.1.4. This requires the "Record Exclusions"
    option to be enabled on the vulnerable site.

    '
  metadata:
    fofa-query: wp-content/plugins/wp-statistics/
    google-query: inurl:"/wp-content/plugins/wp-statistics/"
    shodan-query: vuln:CVE-2022-0513
  name: 'WP Statistics <= 13.1.4 - Unauthenticated Blind SQL Injection

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/bbc2a1f7-4c3c-4f37-a187-572f40e9b792?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,wp-statistics,critical
