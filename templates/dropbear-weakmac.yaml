id: dropbear-weakmac
info:
  author: pussycat0x
  description: 'The mac-alg command specifies which MAC algorithms in the SSH client
    profile for SSH encryption negotiation with an SFTP server when the DataPower
    Gateway acts as an SFTP client.

    '
  metadata:
    max-request: 1
    shodan-query: product:"Dropbear sshd"
    verified: true
  name: Dropbear Weak MAC Algorithms Enabled
  reference: 'https://www.virtuesecurity.com/kb/ssh-weak-mac-algorithms-enabled

    '
  remediation: 'Disable MD5 and 96-bit MAC algorithms.

    '
  severity: low
  tags: network,ssh,dropbear,misconfig
tcp:
- host:
  - '{{Hostname}}'
  inputs:
  - data: '

      '
  matchers:
  - condition: or
    type: word
    words:
    - hmac-md5
    - hmac-sha1
  - type: word
    words:
    - SSH-
  matchers-condition: and
  port: 22
