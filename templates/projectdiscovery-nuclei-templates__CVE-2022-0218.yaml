http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"background":'
    - '"footer":'
  - part: header
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/index.php?rest_route=/whm/v3/themesettings'
id: CVE-2022-0218
info:
  author: hexcat
  classification:
    cpe: cpe:2.3:a:codemiq:wordpress_email_template_designer:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-0218
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.98567
    epss-score: 0.69049
  description: WordPress Email Template Designer WP HTML Mail allows stored cross-site
    scripting through an unprotected REST-API endpoint.
  impact: 'An attacker can exploit this vulnerability to inject malicious scripts
    into the subject field of an email template, potentially leading to unauthorized
    access, data theft, or further compromise of the affected system.

    '
  metadata:
    framework: wordpress
    max-request: 1
    product: wordpress_email_template_designer
    vendor: codemiq
  name: HTML Email Template Designer < 3.1 - Stored Cross-Site Scripting
  reference:
  - https://www.wordfence.com/blog/2022/01/unauthenticated-xss-vulnerability-patched-in-html-email-template-designer-plugin/
  - https://wordpress.org/plugins/wp-html-mail/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0218
  - https://plugins.trac.wordpress.org/changeset/2656984/wp-html-mail/trunk/includes/class-template-designer.php
  - https://github.com/ARPSyndicate/cvemon
  remediation: 'Update to version 3.1 or later of the HTML Email Template Designer
    plugin to fix the vulnerability.

    '
  severity: medium
  tags: cve,cve2022,wordpress,wp-plugin,xss,codemiq,vkev,vuln
