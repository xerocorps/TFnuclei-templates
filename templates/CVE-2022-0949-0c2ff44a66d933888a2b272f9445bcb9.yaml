http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - stopbadbots
  - dsl:
    - compare_versions(version, '< 6.930')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/stopbadbots/readme.txt'
  redirects: true
id: CVE-2022-0949-0c2ff44a66d933888a2b272f9445bcb9
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-0949
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The Block Bad Bots and Stop Bad Bots Crawlers and Spiders and Anti
    Spam Protection WordPress plugin before 6.930 does not properly sanitise and escape
    the fingerprint parameter before using it in a SQL statement via the stopbadbots_grava_fingerprint
    AJAX action, available to unauthenticated users, leading to a SQL injection

    '
  metadata:
    fofa-query: wp-content/plugins/stopbadbots/
    google-query: inurl:"/wp-content/plugins/stopbadbots/"
    shodan-query: vuln:CVE-2022-0949
  name: 'WP Block and Stop Bad Bots <= 6.92 - SQL Injection

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/b27995b1-3321-4997-8a25-80c9488b8405?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,stopbadbots,critical
