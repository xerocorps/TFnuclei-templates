detail:
  author: Dem0ns (https://github.com/dem0ns)
  links:
  - https://github.com/dem0ns/improper/tree/master/laravel/5_debug
expression: r0()
manual: true
name: poc-yaml-laravel-debug-info-leak
rules:
  r0:
    expression: response.status == 405 && response.body.bcontains(b"MethodNotAllowedHttpException")
      && response.body.bcontains(b"Environment &amp; details") && (response.body.bcontains(b"vendor\\laravel\\framework\\src\\Illuminate\\Routing\\RouteCollection.php")
      || response.body.bcontains(b"vendor/laravel/framework/src/Illuminate/Routing/RouteCollection.php"))
    request:
      cache: true
      follow_redirects: false
      method: POST
      path: /
transport: http
