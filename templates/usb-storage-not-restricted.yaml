code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'Start        : 4'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'Get-ItemProperty -Path ''HKLM:\SYSTEM\CurrentControlSet\Services\USBSTOR''
    -Name ''Start''

    '
id: usb-storage-not-restricted
info:
  author: princechaddha
  description: Checks if USB storage devices are allowed, potentially introducing
    security risks through external devices.
  impact: 'Allowing unrestricted USB storage access increases the risk of data exfiltration
    or malware introduction via external devices.

    '
  name: USB Storage Devices Not Restricted
  remediation: 'Restrict the use of USB storage devices to protect the system from
    external threats.

    '
  severity: medium
  tags: windows,usb,storage,code,windows-audit
self-contained: true
