http:
- extractors:
  - json:
    - .[] | .slug
    - .[].name
    name: usernames
    part: body
    type: json
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"id":'
    - '"name":'
    - '"avatar_urls":'
  - part: header
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-json/wp/v2/users/'
  - '{{BaseURL}}/?rest_route=/wp/v2/users/'
  stop-at-first-match: true
id: wp-user-enum
info:
  author: Manas_Harsh,daffainfo,geeknik,dr0pd34d
  description: 'The REST API exposed user data for all users who had authored a post
    of a public post type. WordPress 4.7.1 limits this to only post types which have
    specified that they should be shown within the REST API.

    '
  impact: 'An attacker can easily determine valid usernames, which can lead to targeted
    attacks such as brute force attacks or social engineering.

    '
  metadata:
    max-request: 2
    product: wordpress
    shodan-query: http.component:"WordPress"
    vendor: wordpress
    verified: true
  name: WordPress REST API User Enumeration
  reference:
  - https://www.acunetix.com/vulnerabilities/web/wordpress-rest-api-user-enumeration/
  - https://wordpress.org/plugins/stop-user-enumeration/
  - https://www.afteractive.com/wordpress-user-enumeration-vulnerability/
  remediation: 'Install a WordPress plugin such as Stop User Enumeration. Stop User
    Enumeration is a security plugin designed to detect and prevent hackers scanning
    your site for user names.

    '
  severity: low
  tags: cve2017,cve,wordpress,wp,edb
