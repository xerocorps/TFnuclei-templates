http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - patreon-connect
  - dsl:
    - compare_versions(version, '< 1.7.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/patreon-connect/readme.txt'
  redirects: true
id: CVE-2021-24227-patreon_connect-081bd3a9-2139-416f-bb36-b86aef6fa6db
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24227
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
  description: 'The Jetpack Scan team identified a Local File Disclosure vulnerability
    in the Patreon WordPress plugin before 1.7.0 that could be abused by anyone visiting
    the site. Using this attack vector, an attacker could leak important internal
    files like wp-config.php, which contains database credentials and cryptographic
    keys used in the generation of nonces and cookies.

    '
  metadata:
    fofa-query: wp-content/plugins/patreon-connect/
    google-query: inurl:"/wp-content/plugins/patreon-connect/"
    shodan-query: http.html:"wp-content/plugins/patreon-connect/"
  name: 'Patreon WordPress < 1.7.0 - Local File Disclosure

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/081bd3a9-2139-416f-bb36-b86aef6fa6db?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,patreon-connect,high,production
