http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-file-upload
  - dsl:
    - compare_versions(version, '<= 4.24.15')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-file-upload/readme.txt'
  redirects: true
id: CVE-2024-11613-wp_file_upload-31052fe6-a0ae-4502-b2d2-dbc3b3bf672f
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-11613
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The WordPress File Upload plugin for WordPress is vulnerable to Remote
    Code Execution, Arbitrary File Read, and Arbitrary File Deletion in all versions
    up to, and including, 4.24.15 via the ''wfu_file_downloader.php'' file. This is
    due to lack of proper sanitization of the ''source'' parameter and allowing a
    user-defined directory path. This makes it possible for unauthenticated attackers
    to execute code on the server.

    '
  metadata:
    fofa-query: wp-content/plugins/wp-file-upload/
    google-query: inurl:"/wp-content/plugins/wp-file-upload/"
    shodan-query: http.html:"wp-content/plugins/wp-file-upload/"
  name: 'WordPress File Upload <= 4.24.15 - Unauthenticated Remote Code Execution,
    Arbitrary File Read, and Arbitrary File Deletion

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/31052fe6-a0ae-4502-b2d2-dbc3b3bf672f?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,wp-file-upload,critical,production
