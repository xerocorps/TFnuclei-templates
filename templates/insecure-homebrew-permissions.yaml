code:
- engine:
  - sh
  - bash
  matchers:
  - regex:
    - \d+\s+-[rwx-]*w[rwx-]*w[rwx-]*\s+
    type: regex
  source: 'find $(brew --prefix)/ -perm -o+w -type f -ls 2>/dev/null

    '
id: insecure-homebrew-permissions
info:
  author: geeknik
  description: 'Scans for world-writable files in the Homebrew directory that could
    be exploited for privilege escalation.

    '
  impact: 'World-writable files in the Homebrew directory can be modified by any user
    on the system, potentially leading to privilege escalation or execution of malicious
    code.

    '
  name: macOS World-Writable Homebrew Files
  remediation: 'Review and correct the permissions of world-writable files in the
    Homebrew directory.

    '
  severity: medium
  tags: macos,audit,local,security,homebrew
self-contained: true
