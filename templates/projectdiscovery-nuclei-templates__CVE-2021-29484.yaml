http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - XMLHttpRequest.prototype.open = XMLHttpRequest.prototype.send
    - top.postMessage(
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/ghost/preview'
id: CVE-2021-29484
info:
  author: rootxharsh,iamnoooob
  classification:
    cpe: cpe:2.3:a:ghost:ghost:*:*:*:*:*:node.js:*:*
    cve-id: CVE-2021-29484
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N
    cvss-score: 6.8
    cwe-id: CWE-79
    epss-percentile: 0.99164
    epss-score: 0.82004
  description: Ghost CMS 4.0.0 to 4.3.2 contains a DOM cross-site scripting vulnerability.
    An unused endpoint added during the development of 4.0.0 allows attackers to gain
    access by getting logged-in users to click a link containing malicious code.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to potential data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    framework: node.js
    max-request: 1
    product: ghost
    shodan-query: http.component:"ghost"
    vendor: ghost
  name: Ghost CMS <=4.32 - Cross-Site Scripting
  reference:
  - https://github.com/TryGhost/Ghost/security/advisories/GHSA-9fgx-q25h-jxrg
  - https://www.npmjs.com/package/ghost
  - https://forum.ghost.org/t/critical-security-update-available-for-ghost-4-x/22290
  - https://nvd.nist.gov/vuln/detail/CVE-2021-29484
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/TryGhost/Ghost/blob/95651b33a66f3240535a61999b292a725f1b3317/core/server/web/admin/views/preview.html
  - https://www.sonarsource.com/blog/ghost-admin-takeover/
  remediation: This issue has been fixed in 4.3.3.
  severity: medium
  tags: cve2021,cve,xss,ghost,node.js,vuln
