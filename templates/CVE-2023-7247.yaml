http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - login-as-customer-or-user
  - dsl:
    - compare_versions(version, '3.8')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/login-as-customer-or-user/readme.txt'
  redirects: true
id: CVE-2023-7247
info:
  author: topscoder
  classification:
    cve-id: CVE-2023-7247
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
  description: 'The Login as User or Customer plugin for WordPress is vulnerable to
    admin account compromise in version 3.8. This is due to the plugin not validating
    that the user switching back to the administrative account is the user who initiated
    the original login as another user. This makes it possible for unauthenticated
    attackers to access administrative user accounts when user switching is in progress
    by an administrator. Please note that this would be extremely difficult to exploit
    as it relies on the administrator switching to another user and the attacker knowing
    the admin users ID and the user ID of the user the admin switched to. It may be
    possible with social engineering.

    '
  metadata:
    fofa-query: wp-content/plugins/login-as-customer-or-user/
    google-query: inurl:"/wp-content/plugins/login-as-customer-or-user/"
    shodan-query: vuln:CVE-2023-7247
  name: 'Login as User or Customer <= 3.8 - Unauthenticated Limited Admin Account
    Compromise

    '
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/2a97f59d-c4b1-4544-8cef-37a01cc6f7ec?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,login-as-customer-or-user,high
