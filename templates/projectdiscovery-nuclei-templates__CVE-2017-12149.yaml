http:
- matchers:
  - case-insensitive: true
    condition: and
    part: response
    type: word
    words:
    - JBoss
    - ClassCastException
  - status:
    - 200
    - 500
    type: status
  matchers-condition: and
  raw:
  - 'POST /invoker/JMXInvokerServlet/ HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/octet-stream


    {{ base64_decode("rO0ABXNyABNqYXZhLnV0aWwuQXJyYXlMaXN0eIHSHZnHYZ0DAAFJAARzaXpleHAAAAACdwQAAAACdAAJZWxlbWVudCAxdAAJZWxlbWVudCAyeA==")
    }}

    '
  - 'POST /invoker/EJBInvokerServlet/ HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/octet-stream


    {{ base64_decode("rO0ABXNyABNqYXZhLnV0aWwuQXJyYXlMaXN0eIHSHZnHYZ0DAAFJAARzaXpleHAAAAACdwQAAAACdAAJZWxlbWVudCAxdAAJZWxlbWVudCAyeA==")
    }}

    '
  - 'POST /invoker/readonly HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/octet-stream


    {{ base64_decode("rO0ABXNyABNqYXZhLnV0aWwuQXJyYXlMaXN0eIHSHZnHYZ0DAAFJAARzaXpleHAAAAACdwQAAAACdAAJZWxlbWVudCAxdAAJZWxlbWVudCAyeA==")
    }}

    '
id: CVE-2017-12149
info:
  author: fopina,s0obi
  classification:
    cpe: cpe:2.3:a:redhat:jboss_enterprise_application_platform:5.0.0:*:*:*:*:*:*:*
    cve-id: CVE-2017-12149
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-502
    epss-percentile: 0.99943
    epss-score: 0.94313
  description: Jboss Application Server as shipped with Red Hat Enterprise Application
    Platform 5.2 is susceptible to a remote code execution vulnerability because  the
    doFilter method in the ReadOnlyAccessFilter of the HTTP Invoker does not restrict
    classes for which it performs deserialization, thus allowing an attacker to execute
    arbitrary code via crafted serialized data.
  impact: 'Successful exploitation of this vulnerability can lead to unauthorized
    remote code execution on the affected server.

    '
  metadata:
    fofa-query: title="jboss"
    google-query: intitle:"jboss"
    max-request: 3
    product: jboss_enterprise_application_platform
    shodan-query:
    - http.title:"jboss"
    - cpe:"cpe:2.3:a:redhat:jboss_enterprise_application_platform"
    vendor: redhat
  name: Jboss Application Server - Remote Code Execution
  reference:
  - https://chowdera.com/2020/12/20201229190934023w.html
  - https://github.com/vulhub/vulhub/tree/master/jboss/CVE-2017-12149
  - https://nvd.nist.gov/vuln/detail/CVE-2017-12149
  - https://bugzilla.redhat.com/show_bug.cgi?id=1486220
  - https://access.redhat.com/errata/RHSA-2018:1607
  remediation: 'Apply the latest security patches and updates provided by Jboss to
    fix this vulnerability.

    '
  severity: critical
  tags: cve2017,cve,java,rce,deserialization,kev,vulhub,jboss,intrusive,redhat,vkev,vuln
