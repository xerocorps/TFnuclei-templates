http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - formidable
  - dsl:
    - compare_versions(version, '< 4.09.05')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/formidable/readme.txt'
  redirects: true
id: CVE-2021-24884
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24884
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    cvss-score: 9.6
  description: The Formidable Form Builder WordPress plugin before 4.09.05 allows
    to inject certain HTML Tags like <audio>,<video>,<img>,<a> and<button>.This could
    allow an unauthenticated, remote attacker to exploit a HTML-injection byinjecting
    a malicous link. The HTML-injection may trick authenticated users to follow the
    link. If the Link gets clicked, Javascript code can be executed. The vulnerability
    is due to insufficient sanitization of the 'data-frmverify' tag for links in the
    web-based entry inspection page of affected systems. A successful exploitation
    incomibantion with CSRF could allow the attacker to perform arbitrary actions
    on an affected system with the privileges of the user. These actions include stealing
    the users account by changing their password or allowing attackers to submit their
    own code through an authenticated user resulting in Remote Code Execution. If
    an authenticated user who is able to edit Wordpress PHP Code in any kind, clicks
    the malicious link, PHP code can be edited.
  metadata:
    fofa-query: wp-content/plugins/formidable/
    google-query: inurl:"/wp-content/plugins/formidable/"
    shodan-query: vuln:CVE-2021-24884
  name: Formidable Form Builder <= 4.09.04 - Unauthenticated Stored Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/b57dacdd-43c2-48f8-ac1e-eb8306b22533
  - https://github.com/Strategy11/formidable-forms/pull/335/files
  - https://github.com/S1lkys/XSS-in-Formidable-4.09.04/blob/main/XSS-in-Formidable-4.09.04.pdf
  severity: critical
  tags: cve,wordpress,wp-plugin,formidable,critical
