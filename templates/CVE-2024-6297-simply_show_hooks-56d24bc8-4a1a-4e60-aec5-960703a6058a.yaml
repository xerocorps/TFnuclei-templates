http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - simply-show-hooks
  - dsl:
    - compare_versions(version, '>= 1.2.1', '<= 1.2.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/simply-show-hooks/readme.txt'
  redirects: true
id: CVE-2024-6297-simply_show_hooks-56d24bc8-4a1a-4e60-aec5-960703a6058a
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-6297
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
  description: 'Several plugins for WordPress hosted on WordPress.org have been compromised
    and injected with malicious PHP scripts. A malicious threat actor compromised
    the source code of various plugins and injected code that exfiltrates database
    credentials and is used to create new, malicious, administrator users and send
    that data back to a server. All plugins have received updates reverting any added
    malicious code. Simply Show Hooks affected version (1.2.1) is the same as the
    patched version (1.2.1) - it does not appear that the malicious copy was ever
    officially released, so sites running 1.2.1 should be unaffected, though it is
    a good idea to run a complete Wordfence scan and verify that there are no rogue
    administrator accounts present.

    '
  metadata:
    fofa-query: wp-content/plugins/simply-show-hooks/
    google-query: inurl:"/wp-content/plugins/simply-show-hooks/"
    shodan-query: http.html:"wp-content/plugins/simply-show-hooks/"
  name: 'Several WordPress.org Plugins <= Various Versions  - Injected Backdoor

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/56d24bc8-4a1a-4e60-aec5-960703a6058a?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,simply-show-hooks,critical,production
