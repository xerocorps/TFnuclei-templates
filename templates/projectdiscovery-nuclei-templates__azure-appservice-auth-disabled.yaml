code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: webAppList
    type: json
  source: 'az webapp list --output json --query ''[*].{id:id}''

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - id + " does not have App Service Authentication enabled"
    type: dsl
  matchers:
  - type: word
    words:
    - 'false'
  source: 'az webapp auth show --ids "$id" --query ''enabled'' --output json

    '
flow: "code(1);\nfor (let WebAppData of iterate(template.webAppList)) {\n  WebAppData\
  \ = JSON.parse(WebAppData);\n  set(\"id\", WebAppData.id);\n  code(2);\n}\n"
id: azure-appservice-auth-disabled
info:
  author: princechaddha
  description: 'Ensure that App Service Authentication feature is enabled for Microsoft
    Azure App Service to add an extra layer of security to the authentication process
    implemented by your web applications.

    '
  impact: 'Disabling App Service Authentication can expose the application to unauthorized
    access and potential security vulnerabilities.

    '
  name: Azure App Service Authentication Not Enabled
  reference:
  - https://docs.microsoft.com/en-us/azure/app-service/overview-authentication-authorization
  remediation: 'Enable the App Service Authentication feature for Azure App Services
    to ensure an additional layer of security for your web applications.

    '
  severity: medium
  tags: cloud,devops,azure,microsoft,appservice,azure-cloud-config
self-contained: true
