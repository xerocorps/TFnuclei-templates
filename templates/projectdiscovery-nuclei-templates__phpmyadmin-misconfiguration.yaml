flow: http(1) || http(2)
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - regex("var\\s+db\\s*=\\s*\'information_schema\'",body)
    - regex("var\\s+opendb_url\\s*=\\s*\'db_structure\\.php\'",body)
    type: dsl
  - condition: and
    dsl:
    - contains(body, "name=\\\"login_form\\\"")
    - contains(body, "id=\\\"input_username\\\"")
    negative: true
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/phpmyadmin/index.php?db=information_schema'
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - regex("var\\s+db\\s*=\\s*\'information_schema\'",body)
    - regex("var\\s+opendb_url\\s*=\\s*\'db_structure\\.php\'",body)
    type: dsl
  - condition: and
    dsl:
    - contains(body, "name=\\\"login_form\\\"")
    - contains(body, "id=\\\"input_username\\\"")
    negative: true
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/phpMyAdmin/index.php?db=information_schema'
id: phpmyadmin-misconfiguration
info:
  author: pussycat0x
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-200
  description: 'An unauthenticated instance of phpmyadmin was discovered, which could
    be leveraged to access sensitive information.

    '
  metadata:
    fofa-query:
    - body="pma_servername" && body="4.8.4"
    - title="phpmyadmin"
    max-request: 2
    product: phpmyadmin
    shodan-query:
    - http.title:phpMyAdmin
    - http.title:"phpmyadmin"
    - http.component:"phpmyadmin"
    - cpe:"cpe:2.3:a:phpmyadmin:phpmyadmin"
    vendor: phpmyadmin
  name: phpmyadmin Data Exposure
  reference:
  - https://www.exploit-db.com/ghdb/6997
  severity: medium
  tags: phpmyadmin,misconfig,edb,vuln
