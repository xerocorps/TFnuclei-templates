http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - ultimate-member
  - dsl:
    - compare_versions(version, '<= 2.5.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/ultimate-member/readme.txt'
  redirects: true
id: CVE-2022-3361
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-3361
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 4.3
  description: 'The Ultimate Member plugin for WordPress is vulnerable to directory
    traversal in versions up to, and including 2.5.0 due to insufficient input validation
    on the ''template'' attribute used in shortcodes. This makes it possible for attackers
    with administrative privileges to supply arbitrary paths using traversal (../../)
    to access and include files outside of the intended directory. If an attacker
    can successfully upload a php file then remote code execution via inclusion may
    also be possible. Note: for users with less than administrative capabilities,
    /wp-admin access needs to be enabled for that user in order for this to be exploitable
    by those users.'
  metadata:
    fofa-query: wp-content/plugins/ultimate-member/
    google-query: inurl:"/wp-content/plugins/ultimate-member/"
    shodan-query: vuln:CVE-2022-3361
  name: "Ultimate Member \u2013 User Profile, User Registration, Login & Membership\
    \ Plugin <= 2.5.0 - Authenticated (Contributor+) Directory Traversal via Shortcodes"
  reference:
  - https://www.yuque.com/docs/share/23f988ad-1402-42f2-b8d2-c7a87a4022bd
  - https://github.com/H4de5-7/vulnerabilities/blob/main/CVE-2022-3361.md
  - https://www.wordfence.com/vulnerability-advisories-continued/#CVE-2022-3361
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2805393%40ultimate-member&new=2805393%40ultimate-member&sfp_email=&sfph_mail=
  severity: medium
  tags: cve,wordpress,wp-plugin,ultimate-member,medium
