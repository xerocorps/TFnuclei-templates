http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wholesale-market-for-woocommerce
  - dsl:
    - compare_versions(version, '<= 1.0.7')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wholesale-market-for-woocommerce/readme.txt'
  redirects: true
id: CVE-2022-4108-wholesale_market_for_woocommerce-52f820c5-d4ce-4925-a055-a7c75a320971
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-4108
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 4.9
  description: 'The Wholesale Market for WooCommerce plugin for WordPress is vulnerable
    to arbitrary file download due to missing user input validation during the system
    path generation process in versions up to, and including, 1.0.7. This makes it
    possible for authenticated attackers with administrator-level privileges to download
    arbitrary files on the affected site''s server, including database configuration
    files from other sites.

    '
  metadata:
    fofa-query: wp-content/plugins/wholesale-market-for-woocommerce/
    google-query: inurl:"/wp-content/plugins/wholesale-market-for-woocommerce/"
    shodan-query: http.html:"wp-content/plugins/wholesale-market-for-woocommerce/"
  name: 'Wholesale Market for WooCommerce <= 1.0.7 - Authenticated (Administrator+)
    Arbitrary File Download

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/52f820c5-d4ce-4925-a055-a7c75a320971?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,wholesale-market-for-woocommerce,low,production
