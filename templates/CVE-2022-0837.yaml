http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - ameliabooking
  - dsl:
    - compare_versions(version, '< 1.0.48')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/ameliabooking/readme.txt'
  redirects: true
id: CVE-2022-0837
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-0837
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 6.4
  description: The Amelia WordPress plugin before 1.0.48 does not have proper authorisation
    when handling Amelia SMS service, allowing any customer to send paid test SMS
    notification as well as retrieve sensitive information about the admin, such as
    the email, account balance and payment history. A malicious actor can abuse this
    vulnerability to drain out the account balance by keep sending SMS notification.
  metadata:
    fofa-query: wp-content/plugins/ameliabooking/
    google-query: inurl:"/wp-content/plugins/ameliabooking/"
    shodan-query: vuln:CVE-2022-0837
  name: "Appointment and Event Booking Calendar for WordPress \u2013 Amelia <= 1.0.47\
    \ - Information Disclosure and SMS Spam"
  reference:
  - https://wpscan.com/vulnerability/0882e5c0-f319-4994-9346-aa18438fda6a
  severity: medium
  tags: cve,wordpress,wp-plugin,ameliabooking,medium
