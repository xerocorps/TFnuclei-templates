http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - autoptimize
  - dsl:
    - compare_versions(version, '< 2.8.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/autoptimize/readme.txt'
  redirects: true
id: CVE-2021-24332
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24332
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 5.5
  description: The Autoptimize WordPress plugin before 2.8.4 was missing proper escaping
    and sanitisation in some of its settings, allowing high privilege users to set
    XSS payloads in them, leading to stored Cross-Site Scripting issues.
  metadata:
    fofa-query: wp-content/plugins/autoptimize/
    google-query: inurl:"/wp-content/plugins/autoptimize/"
    shodan-query: vuln:CVE-2021-24332
  name: Autoptimize <= 2.8.3 - Stored Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/6678e064-ce21-4bb2-8c50-061073fb22fb
  - https://m0ze.ru/vulnerability/%5B2021-04-01%5D-%5BWordPress%5D-%5BCWE-79%5D-Autoptimize-WordPress-Plugin-v2.8.3.txt
  severity: medium
  tags: cve,wordpress,wp-plugin,autoptimize,medium
