id: CVE-2020-9274
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:pureftpd:pure-ftpd:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-9274
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-824
    epss-percentile: 0.94401
    epss-score: 0.15323
  description: "Pure-FTPd versions \u2264 1.0.49 (>= ~0.96) contain a vulnerability\
    \ in the init_aliases() function within diraliases.c when processing aliases.\
    \ This leads to access of an uninitialized pointer, which can cause a denial of\
    \ service (DoS) condition.\n"
  impact: 'Attackers can trigger denial of service by exploiting an uninitialized
    pointer in the init_aliases() function when processing FTP aliases, causing the
    Pure-FTPd daemon to crash and disrupting FTP services.

    '
  metadata:
    max-request: 1
    product: pure-ftpd
    shodan-query:
    - product:"pure-ftpd" version:"1.0.49"
    - cpe:"cpe:2.3:a:pureftpd:pure-ftpd"
    vendor: pureftpd
    verified: true
  name: "Pure-FTPd \u2264 1.0.49 - DoS via Uninitialized Pointer"
  reference:
  - https://lists.debian.org/debian-lts-announce/2020/02/msg00029.html
  - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/22P44PECZWNDP7CMBL7NRBMNFS73C5Z2/
  - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/B5NSUDWXZVWUCL6R2PTX3KBB42Z62CA5/
  - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/U5DBVHJCXWRSJPNJQCJQCKZF6ZDPZCKA/
  - https://security.gentoo.org/glsa/202003-54
  remediation: 'Upgrade to Pure-FTPd version 1.0.50 or later that fixes the uninitialized
    pointer vulnerability in the diraliases.c file.

    '
  severity: high
  tags: cve,cve2020,network,ftp,pure-ftpd,tcp,passive,vuln
tcp:
- extractors:
  - group: 1
    name: version
    regex:
    - Pure-FTPd ([0-9.]+)
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: 0
    type: hex
  matchers:
  - condition: and
    dsl:
    - contains(raw, 'Pure-FTPd')
    - compare_versions(version, '<= 1.0.49')
    type: dsl
  port: 21
  read-size: 1024
