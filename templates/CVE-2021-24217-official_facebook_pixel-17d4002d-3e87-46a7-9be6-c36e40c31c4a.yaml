http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - official-facebook-pixel
  - dsl:
    - compare_versions(version, '<= 2.2.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/official-facebook-pixel/readme.txt'
  redirects: true
id: CVE-2021-24217-official_facebook_pixel-17d4002d-3e87-46a7-9be6-c36e40c31c4a
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24217
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
  description: 'The run_action function of the Facebook for WordPress plugin before
    3.0.0 deserializes user supplied data making it possible for PHP objects to be
    supplied creating an Object Injection vulnerability. There was also a useable
    magic method in the plugin that could be used to achieve remote code execution.

    '
  metadata:
    fofa-query: wp-content/plugins/official-facebook-pixel/
    google-query: inurl:"/wp-content/plugins/official-facebook-pixel/"
    shodan-query: http.html:"wp-content/plugins/official-facebook-pixel/"
  name: 'Meta pixel for WordPress <= 2.2.2 - PHP Object Injection

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/17d4002d-3e87-46a7-9be6-c36e40c31c4a?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,official-facebook-pixel,high,production
