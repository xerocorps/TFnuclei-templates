http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - vikrentcar
  - dsl:
    - compare_versions(version, '<= 1.1.6')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/vikrentcar/readme.txt'
  redirects: true
id: CVE-2021-24388
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24388
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
  description: In the VikRentCar Car Rental Management System WordPress plugin before
    1.1.7, there is a custom field option by which we can manage all the fields that
    the users will have to fill in before saving the order. However, the field name
    is not sanitised or escaped before being output back in the page, leading to a
    stored Cross-Site Scripting issue. There is also no CSRF check done before saving
    the setting, allowing attackers to make a logged in admin set arbitrary Custom
    Fields, including one with XSS payload in it.
  metadata:
    fofa-query: wp-content/plugins/vikrentcar/
    google-query: inurl:"/wp-content/plugins/vikrentcar/"
    shodan-query: vuln:CVE-2021-24388
  name: Vik Rent Car <= 1.1.6 - Cross-Site Request Forgery to Stored Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/e3f6576f-08cb-4278-8c79-3ef4d0b85cd9
  severity: medium
  tags: cve,wordpress,wp-plugin,vikrentcar,medium
