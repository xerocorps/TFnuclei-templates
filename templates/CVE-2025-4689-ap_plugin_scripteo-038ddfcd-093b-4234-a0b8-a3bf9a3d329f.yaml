http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - ap-plugin-scripteo
  - dsl:
    - compare_versions(version, '<= 4.89')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/ap-plugin-scripteo/readme.txt'
  redirects: true
id: CVE-2025-4689-ap_plugin_scripteo-038ddfcd-093b-4234-a0b8-a3bf9a3d329f
info:
  author: topscoder
  classification:
    cve-id: CVE-2025-4689
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The Ads Pro Plugin - Multi-Purpose WordPress Advertising Manager plugin
    for WordPress is vulnerable to Local File Inclusion which leads to Remote Code
    Execution in all versions up to, and including, 4.89. This is due to the presence
    of a SQL Injection vulnerability and Local File Inclusion vulnerability that can
    be chained with an image upload. This makes it possible for unauthenticated attackers
    to execute code on the server upload image files on the server than can be fetched
    via a SQL injection vulnerability, and ultimately executed as PHP code through
    the local file inclusion vulnerability.

    '
  metadata:
    fofa-query: wp-content/plugins/ap-plugin-scripteo/
    google-query: inurl:"/wp-content/plugins/ap-plugin-scripteo/"
    shodan-query: http.html:"wp-content/plugins/ap-plugin-scripteo/"
  name: 'Ads Pro Plugin - Multi-Purpose WordPress Advertising Manager <= 4.89 - Unauthenticated
    Local File Inclusion to Remote Code Execution

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/038ddfcd-093b-4234-a0b8-a3bf9a3d329f?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,ap-plugin-scripteo,critical,production
