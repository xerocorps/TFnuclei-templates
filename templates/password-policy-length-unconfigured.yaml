code:
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"RAM Password Policy Does not contain Minimum Length "'
    type: dsl
  matchers:
  - negative: true
    regex:
    - \"MinimumPasswordLength\":\s*(1[4-9]|[2-9][0-9]{1,})
    type: regex
  - regex:
    - \"MinimumPasswordLength":\s*(\d|1[0-3])
    type: regex
  matchers-condition: and
  source: 'aliyun ram GetPasswordPolicy --region $region

    '
id: password-policy-length-unconfigured
info:
  author: DhiyaneshDK
  description: 'The Alibaba RAM password policy is not configured to require a minimum
    length of 14 characters. This misconfiguration allows users to set shorter, potentially
    weaker passwords, increasing the risk of brute-force attacks.

    '
  metadata:
    max-request: 1
    verified: true
  name: RAM Password Policy requires Minimum Length 14 or Greater
  reference:
  - https://www.alibabacloud.com/help/en/ram/user-guide/configure-a-password-policy-for-ram-users
  - https://www.trendmicro.com/cloudoneconformity/knowledge-base/alibaba-cloud/AlibabaCloud-RAM/require-14-characters-password-policy.html
  severity: medium
  tags: cloud,devops,aliyun,alibaba,alibaba-cloud-config,alibaba-ram
self-contained: true
variables:
  region: cn-hangzhou
