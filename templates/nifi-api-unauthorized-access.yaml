expression: r0()
id: nifi-api-unauthorized-access
info:
  author: wulalalaaa(https://github.com/wulalalaaa)
  description: "Apache NiFi Api\u672A\u6388\u6743\u8BBF\u95EE\u5BFC\u81F4\u547D\u4EE4\
    \u6267\u884C"
  name: Apache Nifi Api Unauthorized Access
  reference:
  - https://nifi.apache.org/docs/nifi-docs/rest-api/index.html
  severity: high
  verified: false
rules:
  r0:
    expression: response.status == 200 && response.headers["content-type"].contains("json")
      && response.body.bcontains(b"\"identity\":\"anonymous\",\"anonymous\":true")
    request:
      method: GET
      path: /nifi-api/flow/current-user
