http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(header, 'application/json','ecology_')
    - contains(body, 'error\":\"system error') && !contains(body, 'securityIntercept')
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/mobile/plugin/CheckServer.jsp?type=mobileSetting'
id: weaver-checkserver-sqli
info:
  author: SleepingBag945
  classification:
    cpe: cpe:2.3:a:weaver:e-cology:*:*:*:*:*:*:*:*
  description: 'Ecology OA system improperly filters incoming data from users, resulting
    in a SQL injection vulnerability. Remote and unauthenticated attackers can use
    this vulnerability to conduct SQL injection attacks and steal sensitive database
    information.

    '
  metadata:
    fofa-query: "app=\"\u6CDB\u5FAE-\u534F\u540C\u529E\u516COA\""
    max-request: 1
    product: e-cology
    vendor: weaver
    verified: true
  name: Ecology OA CheckServer - SQL Injection
  reference:
  - https://stack.chaitin.com/techblog/detail?id=81
  - https://github.com/lal0ne/vulnerability/blob/main/%E6%B3%9B%E5%BE%AE/E-Cology/CheckServer/README.md
  - https://github.com/zan8in/afrog/blob/main/v2/pocs/afrog-pocs/vulnerability/weaver-ecology-oa-plugin-checkserver-setting-sqli.yaml
  severity: high
  tags: weaver,ecology,sqli,vuln
