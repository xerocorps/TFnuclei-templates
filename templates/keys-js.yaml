id: keys-js
info:
  author: geeknik
  name: keys.js
  severity: high
requests:
- matchers:
  - status:
    - 200
    type: status
  - type: word
    words:
    - 'MONGODB_URI:'
  - condition: or
    part: header
    type: word
    words:
    - text/plain
    - text/javascript
    - application/javascript
    - application/x-javascript
  - negative: true
    part: header
    type: word
    words:
    - text/html
  - condition: or
    negative: true
    part: body
    type: word
    words:
    - <html
    - window.location = x
    - can not find keys.js
    - function _popwnd_open
    - window.dataLayer
    - console.log(
    - window.location
    - Unknown Host
    - <h1
    - 'Error 404: Error not found'
    - SERVICE_NOT_EXIST
    - <p>
    - Static content proxy
    - ABORTED
    - // Cedexis Inc.
    - This is a placeholder.
    - Counting any requests
    - ': 409,'
    - No action executes!
  - dsl:
    - len(body) > 50 && len(body) < 1024
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/keys.js'
  - '{{BaseURL}}/api/keys.js'
  - '{{BaseURL}}/config/keys.js'
  - '{{BaseURL}}/web/keys.js'
  - '{{BaseURL}}/src/keys.js'
  - '{{BaseURL}}/src/api/keys.js'
  - '{{BaseURL}}/web/api/keys.js'
