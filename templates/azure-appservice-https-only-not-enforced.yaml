code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: appServiceList
    type: json
  source: 'az webapp list --output json --query ''[*].{id:id}''

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - id + " does not enforce HTTPS-only traffic"
    type: dsl
  matchers:
  - type: word
    words:
    - 'false'
  source: 'az webapp show --ids $id --query ''httpsOnly'' --output json

    '
flow: "code(1);\nfor (let AppServiceData of iterate(template.appServiceList)) {\n\
  \  AppServiceData = JSON.parse(AppServiceData);\n  set(\"id\", AppServiceData.id);\n\
  \  code(2);\n}\n"
id: azure-appservice-https-only-not-enforced
info:
  author: princechaddha
  description: 'Ensure that your Azure App Service web applications redirect all non-secure
    HTTP traffic to HTTPS in order to encrypt the communication between applications
    and web clients. HTTPS uses the Secure Sockets Layer (SSL)/Transport Layer Security
    (TLS) protocol to provide a secure connection, which is both encrypted and authenticated.
    This adds an extra layer of security to the HTTP requests made to the web application.

    '
  impact: 'Not enforcing HTTPS only for web applications can lead to unencrypted and
    unauthenticated traffic, which can be intercepted by attackers.

    '
  name: Azure App Service HTTPS-Only Not Enforced
  reference:
  - https://docs.microsoft.com/en-us/azure/app-service/configure-ssl-bindings#enforce-https
  remediation: 'Enable the HTTPS-only feature on all Azure App Services to enforce
    all traffic to be encrypted and secure.

    '
  severity: medium
  tags: cloud,devops,azure,microsoft,appservice,azure-cloud-config
self-contained: true
