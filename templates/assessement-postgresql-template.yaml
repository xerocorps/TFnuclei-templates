id: assessement-postgresql-template
info:
  author: Cavonstavant
  description: 'This template queries the target on port 5432 and check for a specific
    password.

    '
  name: Assessment PGSQL Template
  severity: info
javascript:
- args:
    DBName: test_database
    Host: '{{Host}}'
    Password: test_password
    Port: 5432
    Username: test_user
  code: 'const postgres = require("nuclei/postgres");

    const client = new postgres.PGClient;

    const connected = {"connected": client.ConnectWithDB(Host, Port, Username, Password,
    DBName)};

    to_json(connected);

    '
  extractors:
  - json:
    - .connected
    name: LoginMatch
    type: json
