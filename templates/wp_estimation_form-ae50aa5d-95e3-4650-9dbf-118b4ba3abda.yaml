http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - WP_Estimation_Form
  - dsl:
    - compare_versions(version, '< 9.644')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/WP_Estimation_Form/readme.txt'
  redirects: true
id: wp_estimation_form-ae50aa5d-95e3-4650-9dbf-118b4ba3abda
info:
  author: topscoder
  classification:
    cve-id: null
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The WP Cost Estimation plugin for WordPress is vulnerable to arbitrary
    file uploads and deletion due to missing file type validation in the lfb_upload_form
    and lfb_removeFile AJAX actions in versions up to, and including, 9.642. This
    makes it possible for unauthenticated attackers to upload arbitrary files on the
    affected sites server which may make remote code execution possible. Additionally,
    the attacker can also delete files on the server such as database configuration
    files, subsequently uploading their own database files.

    '
  metadata:
    fofa-query: wp-content/plugins/WP_Estimation_Form/
    google-query: inurl:"/wp-content/plugins/WP_Estimation_Form/"
    shodan-query: http.html:"wp-content/plugins/WP_Estimation_Form/"
  name: 'WP Cost Estimation <= 9.642 - Missing Authorization to Arbitrary File Upload/Delete

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/ae50aa5d-95e3-4650-9dbf-118b4ba3abda?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,WP_Estimation_Form,high,production
