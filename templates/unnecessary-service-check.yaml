code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - UNNECESSARY_SERVICE_RUNNING
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: "$servicesToCheck = @(\"Alerter\", \"Clipbook\", \"Messenger\", \"Simple\
    \ TCP/IP Services\")\n$vulnerable = $false\nforeach ($svc in $servicesToCheck)\
    \ {\n    $service = Get-Service -Name $svc -ErrorAction SilentlyContinue\n   \
    \ if ($service -and $service.Status -eq \"Running\") {\n        $vulnerable =\
    \ $true\n        break\n    }\n}\nif ($vulnerable) {\n    \"UNNECESSARY_SERVICE_RUNNING\"\
    \n} else {\n    \"UNNECESSARY_SERVICE_STOPPED\"\n}\n"
id: unnecessary-service-check
info:
  author: nukunga[SungHyunJeon]
  description: 'Ensure that unnecessary services such as Alerter, Clipbook, Messenger,
    and Simple TCP/IP Services are not running. If enabled, these services can expose
    the system to security vulnerabilities.

    '
  impact: 'Operating these services can offer attackers potential entry points to
    exploit the system, as they are known to have vulnerabilities.

    '
  name: Unnecessary Service Removal Check
  reference:
  - https://isms.kisa.or.kr/main/csap/notice/?boardId=bbs_0000000000000004&mode=view&cntId=85
  remediation: 'To stop and disable these services, run:

    > net stop [ServiceName]

    > sc config [ServiceName] start= disabled

    '
  severity: medium
  tags: service-management,code,windows-audit,kisa
self-contained: true
