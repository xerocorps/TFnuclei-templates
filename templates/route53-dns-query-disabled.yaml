code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: hostedzones
    type: json
  source: 'aws route53 list-hosted-zones --region $region --query "HostedZones[*].Id"
    --output json

    '
- engine:
  - sh
  - bash
  matchers:
  - internal: true
    type: word
    words:
    - 'false'
  source: 'aws route53 get-hosted-zone --id $hostedzone --query "HostedZone.Config.PrivateZone"
    --region $region --output json

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - hostedzone + " DNSSEC Signing for Route 53 Hosted Zones is Disabled"
    type: dsl
  matchers:
  - type: word
    words:
    - '[]'
  source: 'aws route53 list-query-logging-configs --hosted-zone-id "$hostedzone" --query
    "QueryLoggingConfigs" --region $region --output json

    '
flow: "code(1)\nfor(let HostedZones of iterate(template.hostedzones)){\n  set(\"hostedzone\"\
  , HostedZones)\n  code(2) && code(3)\n}\n"
id: route53-dns-query-disabled
info:
  author: DhiyaneshDK
  description: 'Domain Name System Security Extensions (DNSSEC) represents a set of
    protocols that adds a layer of security to the Domain Name System (DNS) lookup
    and exchange processes by enabling DNS responses to be validated.

    '
  impact: 'Disabling DNS query logging for Route 53 hosted zones prevents visibility
    into DNS queries, making it difficult to detect suspicious activity, troubleshoot
    issues, or analyze traffic patterns.

    '
  name: DNS Query Logging for Route 53 Hosted Zones - Disabled
  reference:
  - https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/Route53/enable-query-logging.html
  - https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/monitoring-overview.html
  remediation: 'Enable DNS query logging in the Route 53 console for the hosted zone
    to capture and store DNS queries, allowing for better monitoring and analysis
    of DNS traffic.

    '
  severity: medium
  tags: cloud,devops,aws,amazon,route53,aws-cloud-config
self-contained: true
variables:
  region: us-west-2
