http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '<= 2.0.3')
    type: dsl
  matchers:
  - condition: and
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - condition: and
    status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - email_tfa
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/email_tfa/email_tfa.info'
  redirects: true
id: drupal_module-email_tfa-access-bypass
info:
  author: me
  description: This module enables you to do Two-Factor Authentication by email, using
    a user registered email to send a verification code to the users email every time
    the user tries to log in to your site. The module did not sufficiently protect
    against brute force attacks, allowing an attacker to bypass the second factor.
    This vulnerability is mitigated by the fact the attacker must be able to present
    the username and first factor (i.e. password).
  metadata:
    created_at: '2025-01-09'
    fofa-query: /sites/all/modules/email_tfa/
    google-query: inurl:'/sites/all/modules/email_tfa/
    impact: medium
    security-risk: "Moderately critical 14\u2009\u2215\u200925 AC:Basic/A:User/CI:Some/II:Some/E:Theoretical/TD:All"
    type: indicator
    vulnerability: access-bypass
  name: drupal_module-email_tfa-access-bypass
  reference:
  - https://www.drupal.org/sa-contrib-2025-001
  severity: medium
  tags: drupal
