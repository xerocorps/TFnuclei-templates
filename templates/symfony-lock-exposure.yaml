http:
- matchers:
  - condition: and
    dsl:
    - 'contains_all(body, "version\":", ": {", "branch\":")'
    - contains_any(body, "symfony/", "php\":")
    - status_code == 200
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/symfony.lock'
id: symfony-lock-exposure
info:
  author: ritikchaddha
  description: 'symfony.lock was found accessible, exposing a full list of installed
    Composer packages, library versions, and metadata for a Symfony-based PHP application.
    Disclosure of this file can provide insight into the application''s attack surface,
    potentially revealing vulnerable or outdated dependencies and aiding an attacker
    in choosing their exploit strategy.

    '
  impact: 'Attackers can enumerate all installed Composer packages and versions, increasing
    the risk of targeted attacks (e.g., against known CVEs in dependencies) or application
    fingerprinting.

    '
  metadata:
    fofa-query: body="symfony.lock"
    max-request: 1
    product: symfony
    shodan-query: http.component:"symfony"
    vendor: symfony
    verified: true
  name: Symfony Lock File - Exposure
  reference:
  - https://cheatsheetseries.owasp.org/cheatsheets/Information_Leakage.html
  - https://symfony.com/doc/current/deployment.html
  remediation: 'Restrict direct access to internal and sensitive files such as symfony.lock
    via proper web server configuration (e.g., .htaccess, nginx directives) and consider
    excluding such files from the web root in deployment.

    '
  severity: low
  tags: symfony,exposure,composer,php,config
