info:
  author: OpenAI
  classification:
    country: any
    tags:
    - firebase
    - messaging
    - notifications
  description: Template to detect Firebase Messaging service.
  id: firebase-messaging
  matcher-condition: or
  matchers:
  - description: Firebase initialization script found in the response body
    pattern: firebase.initializeApp({
    type: script
  - description: Firebase messagingSenderId service worker found in the response body
    pattern: messagingSenderId
    type: body
  - description: Firebase firebase.config service worker found in the response body
    pattern: firebase.config
    type: body
  - description: Firebase firebaseapp.com service worker found in the response body
    pattern: firebaseapp.com
    type: body
  name: Firebase Messaging
  reference:
  - https://firebase.google.com/docs/cloud-messaging
  requests:
    condition: or
    description: Attempt to access Firebase Messaging service endpoints
    method: GET
    path:
    - /firebase-messaging-sw.js
    - /firebase-messaging.js
  response:
  - status:
    - 200
  severity: Info
  whitelist:
    description: Example whitelist firebase.google.com domain
    domains:
    - firebase.google.com
    type: domain
