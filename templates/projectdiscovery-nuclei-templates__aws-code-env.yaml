code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .Account
    name: account
    type: json
  matchers:
  - internal: true
    type: word
    words:
    - '"UserId"'
  source: 'aws sts get-caller-identity --output json

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"AWS CLI is properly configured for account \"" + account + "\" and all the
      necessary tools required are installed"'
    type: dsl
  matchers:
  - type: word
    words:
    - jq is installed
  source: 'jq --version >/dev/null 2>&1 && echo "jq is installed." || echo "jq is
    not installed."

    '
flow: code(1) && code(2)
id: aws-code-env
info:
  author: princechaddha
  description: 'Checks if AWS CLI is set up and all necessary tools are installed
    on the environment.

    '
  metadata:
    max-request: 2
  name: AWS Cloud Environment Validation
  reference:
  - https://aws.amazon.com/cli/
  severity: info
  tags: cloud,devops,aws,amazone,aws-cloud-config
self-contained: true
variables:
  region: us-east-1
