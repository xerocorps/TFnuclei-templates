code:
- args:
  - -c
  - "WARN_AGE_LINE=$(grep -Pi -- '^\\h*PASS_WARN_AGE\\h+\\d+\\b' /etc/login.defs |\
    \ head -n1)\nif [ -n \"$WARN_AGE_LINE\" ]; then\n  VALUE=$(echo \"$WARN_AGE_LINE\"\
    \ | awk '{print $2}')\n  if [ \"$VALUE\" -eq 7 ]; then\n    echo \"[password-warn-age-check:Policy-Pass]\
    \ [PASS_WARN_AGE is $VALUE (valid)] [CIS_PASS]\"\n  else\n    echo \"[password-warn-age-check:Policy-Fail]\
    \ [PASS_WARN_AGE is $VALUE (invalid)] [CIS_FAIL]\"\n  fi\nelse\n  echo \"[password-warn-age-check:Policy-Fail]\
    \ [PASS_WARN_AGE not set or malformed] [CIS_FAIL]\"\nfi\n"
  engine:
  - bash
  matchers:
  - name: policy-pass
    type: word
    words:
    - Policy-Pass
  - name: policy-fail
    type: word
    words:
    - Policy-Fail
id: password-warn-age
info:
  author: Th3l0newolf
  description: 'The PASS_WARN_AGE setting in /etc/login.defs defines the number of
    days before password expiration that users are warned.To comply with CIS Ubuntu
    Linux Benchmark, this value should be set to 7 to provide sufficient notice for
    users to change passwords.

    '
  metadata:
    verified: true
  name: Ensure Password Expiration Warning Days is Configured
  reference:
  - https://www.cisecurity.org/benchmark/ubuntu_linux
  remediation: 'Edit /etc/login.defs and ensure the line is set to: PASS_WARN_AGE
    7.Verify the change with: grep -Pi -- ''^\h*PASS_WARN_AGE\h+\d+\b'' /etc/login.defs

    '
  severity: medium
  tags: cis,local,cisecurity,audit,linux,ubuntu,password
self-contained: true
