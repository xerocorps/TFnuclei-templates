http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - all-in-one-b2b-for-woocommerce
  - dsl:
    - compare_versions(version, '<= 1.0.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/all-in-one-b2b-for-woocommerce/readme.txt'
  redirects: true
id: CVE-2023-4703-abd33185e9a1cfe9176774cce9a1e2d3
info:
  author: topscoder
  classification:
    cve-id: CVE-2023-4703
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The All in One B2B for WooCommerce plugin for WordPress is vulnerable
    to Privilege Escalation in versions up to, and including, 1.0.3. This is due to
    insufficient validation of certain parameters when updating user details. This
    makes it possible for unauthenticated attackers update the details of any user
    (e.g., password) to gain elevated privileges.

    '
  metadata:
    fofa-query: wp-content/plugins/all-in-one-b2b-for-woocommerce/
    google-query: inurl:"/wp-content/plugins/all-in-one-b2b-for-woocommerce/"
    shodan-query: vuln:CVE-2023-4703
  name: 'All in One B2B for WooCommerce <= 1.0.3 - Unauthenticated Privilege Escalation

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/aab3016d-5834-4b4a-a206-0b626884b335?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,all-in-one-b2b-for-woocommerce,critical
