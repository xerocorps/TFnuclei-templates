id: graphql-Detect 51
info:
  author: 0xAwali
  name: graphql-Detect
  severity: info
  tags: exposure,api
requests:
- attack: sniper
  matchers:
  - status:
    - 200
    type: status
  - condition: or
    regex:
    - __schema
    - (Introspection|INTROSPECTION|introspection).*?
    - .*?operation not found.*?
    - '"data":{"__schema":{"queryType":'
    type: regex
  matchers-condition: and
  payloads:
    Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
  raw:
  - "POST /query HTTP/1.1\nHost: {{Subdomains}}\nUser-Agent: Mozilla/5.0 (Windows\
    \ NT 10.0; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept-Encoding: gzip, deflate\n\
    Accept: */*\nContent-Length: 67\nContent-Type: application/json; charset=UTF-8\n\
    \          \n{\"query\":\"query IntrospectionQuery{__schema {queryType { name\
    \ }}}\"}\n"
  threads: 100
