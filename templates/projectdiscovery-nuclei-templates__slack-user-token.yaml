flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    name: token
    part: body
    regex:
    - xoxp-[0-9A-Za-z\\-]{74}
    - (xox[pe](?:-[0-9]{10,13}){3}-[a-zA-Z0-9-]{28,34})
    type: regex
  method: GET
  path:
  - '{{BaseURL}}'
- extractors:
  - dsl:
    - token
    type: dsl
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, "is_admin", "is_app_user", "is_email_confirmed")
    - contains(content_type, "application/json")
    type: dsl
  raw:
  - '@Host: https://slack.com:443

    POST /api/users.list?pretty=1 HTTP/1.1

    Host: slack.com

    Origin: https://api.slack.com

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryDL3VHEC7cFaxeAhK


    ------WebKitFormBoundaryDL3VHEC7cFaxeAhK

    Content-Disposition: form-data; name="content"


    null

    ------WebKitFormBoundaryDL3VHEC7cFaxeAhK

    Content-Disposition: form-data; name="token"


    {{token}}

    ------WebKitFormBoundaryDL3VHEC7cFaxeAhK--

    '
id: slack-user-token
info:
  author: Ice3man,DhiyaneshDK
  metadata:
    max-request: 1
    verified: true
  name: Slack User token disclosure
  reference:
  - https://github.com/praetorian-inc/noseyparker/blob/main/crates/noseyparker/data/default/builtin/rules/slack.yml
  - https://api.slack.com/methods/users.list/test
  - https://api.slack.com/authentication
  - https://github.com/semgrep/semgrep-rules/blob/develop/generic/secrets/gitleaks/slack-user-token.yaml
  - https://github.com/semgrep/semgrep-rules/blob/develop/generic/secrets/gitleaks/slack-user-token.txt
  severity: high
  tags: exposure,token,slack,vuln
