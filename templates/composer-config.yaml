id: composer-config
info:
  author: Mahendra Purbia (Mah3Sec_)
  name: composer-config-file
  severity: info
  tags: config,exposure
requests:
- matchers:
  - dsl:
    - contains(body, 'packages') && contains(tolower(all_headers), 'application/octet-stream')
      && status_code == 200
    name: composer.lock
    type: dsl
  - dsl:
    - contains(body, 'require') && contains(tolower(all_headers), 'application/json')
      && status_code == 200
    name: composer.json
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/composer.json'
  - '{{BaseURL}}/composer.lock'
  - '{{BaseURL}}/.composer/composer.json'
  - '{{BaseURL}}/vendor/composer/installed.json'
