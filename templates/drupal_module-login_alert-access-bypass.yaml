http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '8.x-1.2')
    - compare_versions(version, '8.x-1.1')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - login_alert
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/login_alert/login_alert.info'
  redirects: true
id: drupal_module-login_alert-access-bypass
info:
  author: Bishopfox
  description: This module provides a field on user profiles which allows users to
    get a notification when their account logs in to the site. The notification e-mail
    includes a link which will terminate all sessions for that user. This is useful
    in the case of unauthorised access to the account. The module doesnt employ sufficient
    randomness in the generation of URLs, which represents an Access Bypass vulnerability.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/login_alert/
    google-query: inurl:'/sites/all/modules/login_alert/
    impact: medium
    security-risk: "Moderately critical 13\u221525 AC:Basic/A:None/CI:None/II:Some/E:Theoretical/TD:All"
    type: indicator
    vulnerability: access-bypass
  name: drupal_module-login_alert-access-bypass
  reference:
  - https://www.drupal.org/sa-contrib-2019-013
  severity: medium
  tags: drupal
