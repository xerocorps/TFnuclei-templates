http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - expivi
  - dsl:
    - compare_versions(version, '<= 1.0.5')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/expivi/readme.txt'
  redirects: true
id: CVE-2022-1953
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-1953
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L
    cvss-score: 5.4
  description: The Product Configurator for WooCommerce plugin for WordPress is vulnerable
    to arbitrary file deletions in versions up to, and including, 1.2.31 due to insufficient
    file validation and file path validation on the save_image() function that uses
    unlink() on a user supplied file path. This function is invoked via the wp_ajax_nopriv_mkl_pc_generate_config_image
    AJAX action which is tied to the generate_config_image() function with no capability
    checks or nonce validation which makes this issue exploitable via any unauthenticated
    user such as subscriber, or via a Cross-Site Request Forgery.
  metadata:
    fofa-query: wp-content/plugins/expivi/
    google-query: inurl:"/wp-content/plugins/expivi/"
    shodan-query: vuln:CVE-2022-1953
  name: Product Configurator for WooCommerce <= 1.2.31 - Arbitrary File Deletion
  reference:
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2735614%40product-configurator-for-woocommerce&new=2735614%40product-configurator-for-woocommerce&sfp_email=&sfph_mail=#file6
  - https://wpscan.com/vulnerability/b66d6682-edbc-435f-a73a-dced32a32770
  severity: medium
  tags: cve,wordpress,wp-plugin,expivi,medium
