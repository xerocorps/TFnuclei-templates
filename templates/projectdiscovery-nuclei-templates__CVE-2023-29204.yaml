http:
- matchers:
  - part: header
    regex:
    - (?m)^(?:Location\s*?:\s*?)(?:https?:\/|\/\/|\/\\\\|\/\\)(?:[a-zA-Z0-9\-_\.@]*)oast\.me\/?(\/|[^.].*)?$
    type: regex
  method: GET
  path:
  - '{{BaseURL}}/bin/login/XWiki/XWikiLogin?xredirect=//www.oast.me'
  - '{{BaseURL}}/bin/login/XWiki/XWikiLogin?xredirect=http:/www.oast.me'
id: CVE-2023-29204
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-29204
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-601
    epss-percentile: 0.92716
    epss-score: 0.09834
  description: 'XWiki Commons are technical libraries common to several other top
    level XWiki projects. It is possible to bypass the existing security measures
    put in place to avoid open redirect by using a redirect such as `//mydomain.com`
    (i.e. omitting the `http:`). It was also possible to bypass it when using URL
    such as `http:/mydomain.com`. The problem has been patched on XWiki 13.10.10,
    14.4.4 and 14.8RC1.

    '
  impact: 'An attacker can redirect users to malicious websites, leading to phishing
    attacks or malware downloads.

    '
  metadata:
    fofa-query: body="data-xwiki-reference"
    max-request: 1
    product: xwiki
    shodan-query: html:"data-xwiki-reference"
    vendor: xwiki
  name: XWiki - Open Redirect
  reference:
  - https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-xwph-x6xj-wggv
  - https://jira.xwiki.org/browse/XWIKI-10309
  - https://jira.xwiki.org/browse/XWIKI-19994
  - https://nvd.nist.gov/vuln/detail/CVE-2023-29204
  remediation: 'Implement proper input validation and sanitize user-controlled input
    to prevent open redirect vulnerabilities.

    '
  severity: medium
  tags: cve,cve2023,xwiki,redirect,vuln
