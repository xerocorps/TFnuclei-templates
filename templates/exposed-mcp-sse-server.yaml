http:
- extractors:
  - name: message_endpoint
    regex:
    - 'data: ([/?_=a-zA-Z0-9-]+)'
    type: regex
  matchers:
  - condition: or
    dsl:
    - status_code == 200 && contains(content_type, 'text/event-stream')
    - status_code == 406 && contains(content_type, 'application/json')
    type: dsl
  - condition: or
    dsl:
    - 'contains(body, ''event: endpoint'')'
    - 'contains(body, ''Not Acceptable: Client must accept text/event-stream'')'
    type: dsl
  max-size: 100
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/sse'
  stop-at-first-match: true
id: exposed-mcp-sse-server
info:
  author: domwhewell-sage
  description: 'Detects exposed Model Context Protocol (MCP) servers through the SSE
    API. MCP servers often provide administrative access to AI tools, LLM systems,
    or other automation infrastructure. Exposed MCP interfaces can lead to unauthorized
    access, information disclosure, and potential system compromise. This template
    detects a SSE server event stream and returns the messages endpoint which can
    be used to POST JSON-RPC 2.0 requests.

    '
  metadata:
    max-requests: 2
    shodan-query: text/event-stream
    verified: true
  name: MCP SSE API Exposed - Detect
  reference:
  - https://modelcontextprotocol.io/specification/2024-11-05/basic/transports#http-with-sse
  severity: unknown
  tags: mcp,devtools,exposure,api,ai,llm,discovery
