http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(tolower(content_type), "text/plain")
    - contains(body, "This files describes API changes")
    type: dsl
  - condition: and
    dsl:
    - status_code == 200
    - contains(tolower(content_type), "text/")
    - contains(body, "Developer update notes")
    type: dsl
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}/lib/upgrade.txt'
  - '{{BaseURL}}/UPGRADING.md'
  stop-at-first-match: true
id: moodle-changelog
info:
  author: oppsec,lap1nou
  description: 'Moodle has a file which describes API changes in core libraries and
    APIs, and can be used to discover Moodle version.

    '
  metadata:
    max-request: 2
    verified: true
  name: Moodle Changelog File Detect
  reference:
  - https://moodledev.io/general/development/upgradenotes
  - https://moodle.atlassian.net/browse/MDL-81125
  - https://github.com/moodle/moodle
  severity: info
  tags: moodle,exposure,misc,vuln
