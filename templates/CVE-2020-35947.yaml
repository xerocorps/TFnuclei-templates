http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - pagelayer
  - dsl:
    - compare_versions(version, '< 1.1.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/pagelayer/readme.txt'
  redirects: true
id: CVE-2020-35947
info:
  author: topscoder
  classification:
    cve-id: CVE-2020-35947
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L
    cvss-score: 7.4
  description: An issue was discovered in the PageLayer plugin before 1.1.2 for WordPress.
    Nearly all of the AJAX action endpoints lacked permission checks, allowing these
    actions to be executed by anyone authenticated on the site. This happened because
    nonces were used as a means of authorization, but a nonce was present in a publicly
    viewable page. The greatest impact was the pagelayer_save_content function that
    allowed pages to be modified and allowed XSS to occur.
  metadata:
    fofa-query: wp-content/plugins/pagelayer/
    google-query: inurl:"/wp-content/plugins/pagelayer/"
    shodan-query: vuln:CVE-2020-35947
  name: "Page Builder: Pagelayer \u2013 Drag and Drop website builder <= 1.1.1 - Missing\
    \ Authorization to Cross-Site Scripting"
  reference:
  - https://www.wordfence.com/blog/2020/05/high-severity-vulnerabilities-in-pagelayer-plugin-affect-over-200000-wordpress-sites/
  - https://wpscan.com/vulnerability/10239
  severity: high
  tags: cve,wordpress,wp-plugin,pagelayer,high
