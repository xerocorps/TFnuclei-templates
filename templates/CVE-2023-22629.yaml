id: CVE-2023-22629
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:southrivertech:titan_ftp_server:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-22629
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cwe-id: CWE-22
    epss-percentile: 0.99153
    epss-score: 0.81824
  description: 'TitanFTP versions up to 1.94.1205 contain a path traversal vulnerability
    in the move-file function where the newPath parameter is improperly validated.
    An authenticated user can upload a file and then move it to any location on the
    server filesystem, potentially allowing arbitrary file placement and system compromise.

    '
  impact: 'Authenticated attackers can exploit the move-file function to place files
    anywhere on the server filesystem using path traversal techniques, potentially
    overwriting system files, planting malicious executables, or compromising server
    integrity.

    '
  metadata:
    max-request: 1
    product: titan_ftp_server
    shodan-query: product:"Titan ftpd"
    vendor: southrivertech
  name: "TitanFTP move-file Function \u2264 1.94.1205 - Path Traversal"
  reference:
  - http://packetstormsecurity.com/files/171737/Titan-FTP-Path-Traversal.html
  - https://titanftp.com
  - https://www.southrivertech.com/software/nextgen/titanftp/en/relnotes.pdf
  remediation: 'Upgrade to TitanFTP version newer than 1.94.1205 that properly validates
    the newPath parameter in the move-file function.

    '
  severity: high
  tags: cve,cve2023,network,ftp,titan-ftp,tcp,passive,vuln
tcp:
- extractors:
  - group: 1
    name: version
    regex:
    - TitanFTP ([0-9.]+)
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: 0
    type: hex
  matchers:
  - condition: and
    dsl:
    - contains(raw, 'TitanFTP')
    - compare_versions(version, '<= 1.94.1205')
    type: dsl
  port: 21
  read-size: 1024
