code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: dbclusters
    type: json
  source: 'aws rds describe-db-instances --region $region --output json --query ''DBInstances[?Engine==`mysql`
    || Engine==`postgres`].DBInstanceIdentifier | []''

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - dbcluster + " RDS Instance Storage AutoScaling is Disabled"
    type: dsl
  matchers:
  - type: word
    words:
    - '[]'
  source: 'aws rds describe-db-instances --region $region --db-instance-identifier
    $dbcluster --query ''DBInstances[*].MaxAllocatedStorage'' --output json

    '
flow: "code(1)\nfor(let DBClusterIdentifier of iterate(template.dbclusters)){\n  set(\"\
  dbcluster\", DBClusterIdentifier)\n  code(2)\n}\n"
id: rds-instance-autoscaling-disabled
info:
  author: DhiyaneshDK
  description: 'Ensure that the Storage AutoScaling feature is enabled for your Amazon
    RDS database instances in order to provide dynamic scaling support for the database''s
    storage based on your RDS application needs.

    '
  impact: 'The RDS instance may run out of storage, leading to potential application
    downtime or performance degradation due to lack of disk space.

    '
  name: RDS Instance Storage AutoScaling - Disabled
  reference:
  - https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/RDS/enable-rds-storage-autoscaling.html
  - https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_PIOPS.StorageTypes.html
  remediation: 'Enable storage autoscaling for the RDS instance in the AWS Management
    Console or via CLI/API to automatically adjust storage capacity as needed.

    '
  severity: medium
  tags: cloud,devops,aws,amazon,rds,aws-cloud-config
self-contained: true
variables:
  region: us-west-2
