http:
- matchers:
  - condition: and
    dsl:
    - status_code_1 == 405
    - 'contains(header_2, "Content-Length: 0") || contains(header_3, "Content-Length:
      0")'
    - status_code_2 == 200 && status_code_3 == 200
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    x-http-method-override: POST

    '
  - 'GET / HTTP/1.1

    x-http-method-override: HEAD

    '
  - 'GET / HTTP/1.1

    x-http-method-override: PURGE

    '
  req-condition: true
  stop-at-first-match: true
id: gitlab-cp-dos
info:
  author: pdteam
  name: GitLab CP-DoS Cache Poisoning
  reference: https://youst.in/posts/cache-poisoning-at-scale/
  severity: high
  tags: cache
