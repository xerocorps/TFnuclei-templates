http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - vCenter Converter Standalone ([0-9.]+)
    - <version>(.*?)</version>
    type: regex
  matchers:
  - case-insensitive: true
    part: body
    type: word
    words:
    - VMware vCenter
    - VirtualCenter
    - VMware
  - status:
    - 200
    type: status
  - dsl:
    - compare_versions(version, '>= 4.0', '<= 5.5')
    - compare_versions(version, '>= 7.0', '<= 8.0')
    type: dsl
  matchers-condition: and
  raw:
  - 'GET /en/welcomeRes.js HTTP/1.1

    Host: {{Hostname}}

    '
  - "POST /sdk/ HTTP/1.1\nHost: {{Hostname}}\n\n<?xml version=\"1.0\" encoding=\"\
    UTF-8\"?>\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\
    \ xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\
    >\n   <soap:Header>\n      <operationID>00000001-00000001</operationID>\n   </soap:Header>\n\
    \   <soap:Body>\n      <RetrieveServiceContent xmlns=\"urn:internalvim25\">\n\
    \         <_this xsi:type=\"ManagedObjectReference\" type=\"ServiceInstance\"\
    >ServiceInstance</_this>\n      </RetrieveServiceContent>\n   </soap:Body>\n</soap:Envelope>\n"
  stop-at-first-match: true
id: CVE-2023-34048
info:
  author: ritikchaddha
  classification:
    cve-id: CVE-2023-34048
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-787
    epss-percentile: 0.99739
    epss-score: 0.92716
  description: 'vCenter Server contains an out-of-bounds write caused by a vulnerability
    in the DCERPC protocol implementation. A malicious actor with network access can
    trigger remote code execution on vCenter Server.

    '
  impact: 'Unauthenticated attackers with network access can exploit the out-of-bounds
    write vulnerability in the DCERPC protocol to execute arbitrary code on vCenter
    Server, potentially compromising the entire VMware virtualization infrastructure.

    '
  metadata:
    fofa-query: title="VMware VCenter"
    max-request: 2
    product: vcenter_server
    shodan-query: title:"VMware VCenter"
    vendor: vmware
    verified: true
  name: VMware vCenter Server - Out-of-Bounds Write
  reference:
  - https://www.vicarius.io/vsociety/posts/understanding-cve-2023-34048-a-zero-day-out-of-bound-write-in-vcenter-server
  - https://www.vmware.com/security/advisories/VMSA-2023-0023.html
  - https://nvd.nist.gov/vuln/detail/CVE-2023-34048
  remediation: 'Apply VMware security patches from VMSA-2023-0023 for vCenter Server
    versions 4.0-5.5 and 7.0-8.0 that fix the DCERPC protocol vulnerability.

    '
  severity: critical
  tags: cve,cve2023,vmware,vcenter,rce,kev,vkev,passive
