id: cve-2021-27651
info:
  author: idealphase
  description: In versions 8.2.1 through 8.5.2 of Pega Infinity, the password reset
    functionality for local accounts can be used to bypass local authentication checks.
  name: Pega Infinity Authentication bypass
  reference: '- https://github.com/samwcyo/CVE-2021-27651-PoC/blob/main/RCE.md

    - https://nvd.nist.gov/vuln/detail/CVE-2021-27651

    '
  severity: critical
  tags: cve,cve2021,pega,auth-bypass
requests:
- cookie-reuse: true
  extractors:
  - part: body
    regex:
    - Pega 8\.(?:2\.[1-9]|3\.[0-9]|4\.[0-9]|5\.[0-2])
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - Pega Infinity
  - part: body
    regex:
    - Pega 8\.(?:2\.[1-9]|3\.[0-9]|4\.[0-9]|5\.[0-2])
    type: regex
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}/prweb/PRAuth/app/default/'
  redirects: true
