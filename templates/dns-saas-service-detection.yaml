dns:
- extractors:
  - dsl:
    - cname
    type: dsl
  matchers:
  - name: ms-office
    part: answer
    type: word
    words:
    - outlook.com
    - office.com
  - name: azure
    part: answer
    type: word
    words:
    - azure-api.net
    - azure.com
    - azure-mobile.net
    - azurecontainer.io
    - azurecr.io
    - azuredatalakestore.net
    - azureedge.net
    - azurefd.net
    - azurehdinsight.net
    - azurewebsites.net
    - azurewebsites.windows.net
    - blob.core.windows.net
    - cloudapp.azure.com
    - cloudapp.net
    - database.windows.net
    - redis.cache.windows.net
    - search.windows.net
    - servicebus.windows.net
    - visualstudio.com
    - -msedge.net
    - msappproxy.net
    - trafficmanager.net
  - name: zendesk
    part: answer
    type: word
    words:
    - zendesk.com
  - name: announcekit
    part: answer
    type: word
    words:
    - cname.announcekit.app
  - name: wix
    part: answer
    type: word
    words:
    - wixdns.net
  - name: akamai-cdn
    part: answer
    type: word
    words:
    - akadns.net
    - akagtm.org
    - akahost.net
    - akam.net
    - akamai.com
    - akamai.net
    - akamaiedge-staging.net
    - akamaiedge.net
    - akamaientrypoint.net
    - akamaihd.net
    - akamaistream.net
    - akamaitech.net
    - akamaitechnologies.com
    - akamaitechnologies.fr
    - akamaized.net
    - akaquill.net
    - akasecure.net
    - akasripcn.net
    - edgekey.net
    - edgesuite.net
  - name: cloudflare-cdn
    part: answer
    type: word
    words:
    - cloudflare.net
    - cloudflare-dm-cmpimg.com
    - cloudflare-ipfs.com
    - cloudflare-quic.com
    - cloudflare-terms-of-service-abuse.com
    - cloudflare.com
    - cloudflare.net
    - cloudflare.tv
    - cloudflareaccess.com
    - cloudflareclient.com
    - cloudflareinsights.com
    - cloudflareok.com
    - cloudflareportal.com
    - cloudflareresolve.com
    - cloudflaressl.com
    - cloudflarestatus.com
    - sn-cloudflare.com
  - name: amazon-cloudfront
    part: answer
    type: word
    words:
    - cloudfront.net
  - name: salesforce
    part: answer
    type: word
    words:
    - salesforce.com
    - siteforce.com
    - force.com
  - name: amazon-aws
    part: answer
    type: word
    words:
    - amazonaws.com
    - elasticbeanstalk.com
    - awsglobalaccelerator.com
  - name: fastly-cdn
    part: answer
    type: word
    words:
    - fastly.net
  - name: netlify
    part: answer
    type: word
    words:
    - netlify.app
    - netlify.com
    - netlifyglobalcdn.com
  - name: vercel
    part: answer
    type: word
    words:
    - vercel.app
  - name: sendgrid
    part: answer
    type: word
    words:
    - sendgrid.net
    - sendgrid.com
  - name: qualtrics
    part: answer
    type: word
    words:
    - qualtrics.com
  - name: heroku
    part: answer
    type: word
    words:
    - herokuapp.com
    - herokucdn.com
    - herokudns.com
    - herokussl.com
    - herokuspace.com
  - name: gitlab
    part: answer
    type: word
    words:
    - gitlab.com
    - gitlab.io
  - name: perforce-akana
    part: answer
    type: word
    words:
    - akana.com
    - apiportal.akana.com
  - name: skilljar
    part: answer
    type: word
    words:
    - skilljarapp.com
  - name: datagrail
    part: answer
    type: word
    words:
    - datagrail.io
  - name: platform.sh
    part: answer
    type: word
    words:
    - platform.sh
  - name: folloze
    part: answer
    type: word
    words:
    - folloze.com
  - name: pendo-receptive
    part: answer
    type: word
    words:
    - receptive.io
    - pendo.io
  - name: discourse
    part: answer
    type: word
    words:
    - bydiscourse.com
    - discourse-cdn.com
    - discourse.cloud
    - discourse.org
    - hosted-by-discourse.com
  - name: adobe-marketo
    part: answer
    type: word
    words:
    - marketo.com
    - marketo.co.uk
    - mktoweb.com
    - mktossl.com
    - mktoweb.com
  - name: adobe-marketo - 'mkto-.{5,8}\.com'
    part: answer
    type: word
  - name: adobe-marketo
    part: answer
    type: word
    words:
    - marketo.com
  - name: rock-content
    part: answer
    type: word
    words:
    - postclickmarketing.com
    - rockcontent.com
    - rockstage.io
  - name: rocketlane
    part: answer
    type: word
    words:
    - rocketlane.com
  - name: webflow
    part: answer
    type: word
    words:
    - proxy-ssl.webflow.com
  - name: stacker-hq
    part: answer
    type: word
    words:
    - stacker.app
  - name: hubspot
    part: answer
    type: word
    words:
    - hs-analytics.net
    - hs-banner.com
    - hs-scripts.com
    - hsappstatic.net
    - hscollectedforms.net
    - hscoscdn00.net
    - hscoscdn10.net
    - hscoscdn20.net
    - hscoscdn30.net
    - hscoscdn40.net
    - hsforms.com
    - hsforms.net
    - hubapi.com
    - hubspot.com
    - hubspot.es
    - hubspot.net
    - hubspotemail.net
    - hubspotlinks.com
    - hubspotusercontent-na1.net
    - sidekickopen90.com
    - usemessages.com
  - name: gitbook
    part: answer
    type: word
    words:
    - gitbook.com
    - gitbook.io
  - name: google-firebase
    part: answer
    type: word
    words:
    - fcm.googleapis.com
    - firebase.com
    - firebase.google.com
    - firebase.googleapis.com
    - firebaseapp.com
    - firebaseappcheck.googleapis.com
    - firebasedynamiclinks-ipv4.googleapis.com
    - firebasedynamiclinks-ipv6.googleapis.com
    - firebasedynamiclinks.googleapis.com
    - firebaseinappmessaging.googleapis.com
    - firebaseinstallations.googleapis.com
    - firebaseio.com
    - firebaselogging-pa.googleapis.com
    - firebaselogging.googleapis.com
    - firebaseperusertopics-pa.googleapis.com
    - firebaseremoteconfig.googleapis.com
  - name: zendesk
    part: answer
    type: word
    words:
    - zdassets.com
    - zdorigin.com
    - zendesk.com
    - zopim.com
  - name: imperva
    part: answer
    type: word
    words:
    - incapdns.net
    - incapsula.com
  - name: proofpoint
    part: answer
    type: word
    words:
    - infoprtct.com
    - metanetworks.com
    - ppe-hosted.com
    - pphosted.com
    - proofpoint.com
  - name: q4-investor-relations
    part: answer
    type: word
    words:
    - q4inc.com
    - q4ir.com
    - q4web.com
  - name: google-hosted
    part: answer
    type: word
    words:
    - appspot.com
    - cloudfunctions.net
    - ghs.googlehosted.com
    - ghs4.googlehosted.com
    - ghs46.googlehosted.com
    - ghs6.googlehosted.com
    - googlehosted.com
    - googlehosted.l.googleusercontent.com
    - run.app
  - name: wp-engine
    part: answer
    type: word
    words:
    - wpengine.com
  - name: github
    part: answer
    type: word
    words:
    - github.com
    - github.io
    - githubusercontent.com
  - name: ghost
    part: answer
    type: word
    words:
    - ghost.io
  - name: digital-ocean
    part: answer
    type: word
    words:
    - ondigitalocean.app
  - name: typedream
    part: answer
    type: word
    words:
    - ontypedream.com
  - name: oracle-eloqua-marketing
    part: answer
    type: word
    words:
    - hs.eloqua.com
  - part: answer
    regex:
    - "IN\tCNAME\\t(.+)$"
    - IN\s*CNAME\t(.+)$
    type: regex
  matchers-condition: or
  name: '{{FQDN}}'
  type: CNAME
id: dns-saas-service-detection
info:
  author: noah @thesubtlety,pdteam
  description: A CNAME DNS record was discovered
  metadata:
    max-request: 1
  name: DNS SaaS Service Detection
  reference:
  - https://ns1.com/resources/cname
  - https://www.theregister.com/2021/02/24/dns_cname_tracking/
  - https://www.ionos.com/digitalguide/hosting/technical-matters/cname-record/
  severity: info
  tags: dns,service
