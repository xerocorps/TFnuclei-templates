http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - protect-uploads
  - dsl:
    - compare_versions(version, '<= 0.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/protect-uploads/readme.txt'
  redirects: true
id: protect_uploads-e3702936-9ae2-4efb-bdfe-9e1dfceb246b
info:
  author: topscoder
  classification:
    cve-id: null
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 4.8
  description: 'The Protect uploads plugin for WordPress failed to use a capability
    check and leaked the nonce necessary to save changes in the protect-uploads-admin-settings-page.php
    file. This meant that attackers able to successfully load this file in the context
    of WordPress, such as through a separate local file inclusion vulnerability, could
    save changes to the plugin settings. Note that while the file did allow direct
    access, this was not sufficient to obtain sensitive information or make changes
    on its own.

    '
  metadata:
    fofa-query: wp-content/plugins/protect-uploads/
    google-query: inurl:"/wp-content/plugins/protect-uploads/"
    shodan-query: http.html:"wp-content/plugins/protect-uploads/"
  name: 'Protect uploads <= 0.3 - Authorization Bypass

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/e3702936-9ae2-4efb-bdfe-9e1dfceb246b?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,protect-uploads,medium,production
