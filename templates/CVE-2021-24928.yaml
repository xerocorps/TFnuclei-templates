http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - rearrange-woocommerce-products
  - dsl:
    - compare_versions(version, '< 3.0.8')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/rearrange-woocommerce-products/readme.txt'
  redirects: true
id: CVE-2021-24928
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24928
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 6.5
  description: The Rearrange Woocommerce Products WordPress plugin before 3.0.8 does
    not have proper access controls in the save_all_order AJAX action, nor validation
    and escaping when inserting user data in SQL statement, leading to an SQL injection,
    and allowing any authenticated user, such as subscriber, to modify arbitrary post
    content (for example with an XSS payload), as well as exfiltrate any data by copying
    it to another post.
  metadata:
    fofa-query: wp-content/plugins/rearrange-woocommerce-products/
    google-query: inurl:"/wp-content/plugins/rearrange-woocommerce-products/"
    shodan-query: vuln:CVE-2021-24928
  name: Rearrange Woocommerce Products <= 3.0.7 - Subscriber+ SQL Injection
  reference:
  - https://wpscan.com/vulnerability/3762a77c-b8c9-428f-877c-bbfd7958e7be
  severity: medium
  tags: cve,wordpress,wp-plugin,rearrange-woocommerce-products,medium
