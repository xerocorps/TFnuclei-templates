id: unauthenticated-varnish-cache-purge
info:
  author: 0xelkomy
  description: As per guideline one should protect purges with ACLs from unauthorized
    hosts.
  name: Varnish Unauthenticated Cache Purge
  reference:
  - https://book.varnish-software.com/4.0/chapters/Cache_Invalidation.html
  - https://hackerone.com/reports/154278
  severity: low
  tags: varnish,misconfig,cache
requests:
- matchers:
  - condition: or
    part: body
    type: word
    words:
    - <title>200 Purged</title>
    - '"status": "ok"'
  - status:
    - 200
    type: status
  matchers-condition: and
  method: PURGE
  path:
  - '{{BaseURL}}'
