http:
- matchers:
  - condition: and
    dsl:
    - contains(content_type, "application/json")
    - contains_all(body, "processGroupFlow", "breadcrumb")
    - status_code == 200
    name: process-group-information
    type: dsl
  - condition: and
    dsl:
    - contains(content_type, "application/json")
    - contains_all(body, "maxTimerDrivenThreadCount", "maxEventDrivenThreadCount")
    - status_code == 200
    name: config-information
    type: dsl
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}{{path}}'
  payloads:
    path:
    - /nifi-api/flow/process-groups/root
    - /nifi-api/controller/config
id: CVE-2024-56512
info:
  author: DhiyaneshDK
  classification:
    cve-id: CVE-2024-56512
    epss-percentile: 0.95829
    epss-score: 0.23924
  description: 'Apache NiFi 1.10.0 through 2.0.0 are missing fine-grained authorization
    checking for Parameter Contexts, referenced Controller Services, and referenced
    Parameter Providers, when creating new Process Groups. Creating a new Process
    Group can include binding to a Parameter Context, but in cases where the Process
    Group did not reference any Parameter values, the framework did not check user
    authorization for the bound Parameter Context. Missing authorization for a bound
    Parameter Context enabled clients to download non-sensitive Parameter values after
    creating the Process Group.

    '
  impact: 'Attackers can create Process Groups bound to Parameter Contexts without
    proper authorization checks, enabling them to download non-sensitive parameter
    values and potentially access sensitive configuration data.

    '
  metadata:
    max-request: 1
    shodan-query: title:"Nifi"
    verified: true
  name: Apache NiFi - Information Disclosure
  reference:
  - https://lists.apache.org/thread/cjc8fns5kjsho0s7vonlnojokyfx47wn
  - http://www.openwall.com/lists/oss-security/2024/12/28/1
  - https://github.com/absholi7ly/CVE-2024-56512-Apache-NiFi-Exploit/
  - https://nvd.nist.gov/vuln/detail/CVE-2024-56512
  remediation: 'Update Apache NiFi to version 2.1.0 or later to address the missing
    authorization checks for Parameter Contexts.

    '
  severity: medium
  tags: cve,cve2024,nifi,exposure,vuln
