http:
- extractors:
  - dsl:
    - '"Email: " + email + ". Password: "+ password'
    type: dsl
  matchers:
  - condition: and
    dsl:
    - contains(body, "token\":\"ey")
    - contains(header, 'application/json')
    - status_code == 200
    type: dsl
  raw:
  - 'POST /api/v1/auth/user/signup HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"email":"{{email}}","password":"{{password}}"}

    '
id: nocodb-public-registration-enabled
info:
  author: pussycat0x
  description: 'Detected NocoDB instances that allow public user registration without
    requiring an invitation. This misconfiguration allows anyone to create an account
    on the NocoDB instance, potentially leading to unauthorized access to databases
    and sensitive information.

    '
  metadata:
    fofa-query: title="NocoDB"
    max-request: 1
    product: nocodb
    shodan-query: http.title:"NocoDB"
    vendor: nocodb
    verified: true
  name: NocoDB Public Registration Enabled
  reference:
  - https://docs.nocodb.com/getting-started/self-hosted/environment-variables/
  - https://nocodb.com/docs/product-docs/account-settings/oss-specific-details
  severity: medium
  tags: nocodb,misconfig,exposure,intrusive
variables:
  email: '{{randstr}}@{{rand_base(5)}}.com'
  password: '{{rand_base(8)}}'
