http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '<= 2.0.5')
    - compare_versions(version_by_js, '<= 2.0.5')
    - compare_versions(version_by_css, '<= 2.0.5')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2007-0107
info:
  author: topscoder
  classification:
    cve-id: CVE-2007-0107
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: WordPress before 2.0.6, when mbstring is enabled for PHP, decodes alternate
    character sets after escaping the SQL query, which allows remote attackers to
    bypass SQL injection protection schemes and execute arbitrary SQL commands via
    multibyte charsets, as demonstrated using UTF-7.
  metadata:
    shodan-query: vuln:CVE-2007-0107
  name: WordPress Core <= 2.0.5 - SQL Injection
  reference:
  - https://exchange.xforce.ibmcloud.com/vulnerabilities/31297
  - http://www.securityfocus.com/bid/21907
  - http://secunia.com/advisories/23741
  - http://www.openpkg.com/security/advisories/OpenPKG-SA-2007.005.html
  - http://security.gentoo.org/glsa/glsa-200701-10.xml
  - http://osvdb.org/31579
  - http://wordpress.org/development/2007/01/wordpress-206/
  - http://secunia.com/advisories/23595
  - http://www.securityfocus.com/archive/1/456049/100/0/threaded
  - http://www.vupen.com/english/advisories/2007/0061
  - http://www.hardened-php.net/advisory_022007.141.html
  - http://securityreason.com/securityalert/2112
  - https://wordpress.org/news/2007/01/wordpress-206/
  severity: critical
  tags: cve,wordpress,wp-core,critical
