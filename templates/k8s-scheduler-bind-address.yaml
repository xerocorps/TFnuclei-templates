code:
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"kube-scheduler configuration is missing --bind-address or set to unsafe value
      (expected: 127.0.0.1 or ::1)"'
    type: dsl
  matchers:
  - type: word
    words:
    - kube-scheduler
  - negative: true
    type: word
    words:
    - --bind-address=127.0.0.1
    - --bind-address=::1
  matchers-condition: and
  source: 'kubectl get pods -n kube-system -l component=kube-scheduler -o jsonpath="{.items[*].spec.containers[*].command}"

    '
id: k8s-scheduler-bind-address
info:
  author: songyaeji
  description: 'Ensure kube-scheduler is bound to localhost (127.0.0.1 or ::1). If
    --bind-address is missing or set to

    0.0.0.0 (::), the scheduler API may be reachable from all network interfaces,
    increasing exposure of the

    control-plane component.

    '
  impact: 'If the kube-scheduler listens on all interfaces, an attacker with network
    access may be able to interact

    with the scheduler API, causing potential information leakage or enabling further
    attacks against the cluster.

    '
  name: Ensure kube-scheduler --bind-address is set to localhost
  reference:
  - https://kubernetes.io/docs/reference/command-line-tools-reference/kube-scheduler/
  - Cloud Vulnerability Assessment Guide(2024) by KISA
  remediation: 'Set --bind-address=127.0.0.1 (or ::1) in the kube-scheduler startup
    arguments. For example, edit

    /etc/kubernetes/manifests/kube-scheduler.yaml and add the argument to the command
    section.

    '
  severity: high
  tags: cloud,devops,kubernetes,devsecops,kube-scheduler,bind-address,hardening,k8s,k8s-cluster-security
self-contained: true
variables:
  component: kube-scheduler
