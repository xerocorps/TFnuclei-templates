expression: r0() || r1()
id: hadoop-yarn-unauth
info:
  author: p0wd3r,sharecast
  description: 'app="APACHE-hadoop-YARN"

    '
  name: Hadoop Yarn Unauth
  severity: medium
  verified: true
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b"resourceManagerVersionBuiltOn")
      && response.body.bcontains(b"hadoopVersion")
    request:
      method: GET
      path: /ws/v1/cluster/info
  r1:
    expression: response.status == 200 && response.body.bcontains(b"javax.ws.rs.WebApplicationException")
    request:
      method: GET
      path: /ws/v1/cluster/apps/new-application
