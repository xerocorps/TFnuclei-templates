id: open-redirect-00
info:
  name: Open Redirect Lite
  risk: Low
params:
- root: '{{.BaseURL}}'
- dest: bing.com
requests:
- detections:
  - '(StatusCode() >= 300 && StatusCode() < 400) && (StringSearch("resHeaders", "Location:
    http://{{.dest}}") || StringSearch("resHeaders", "Location: https://{{.dest}}")
    || StringSearch("resHeaders", "Location: {{.dest}}") || StringSearch("resHeaders",
    "Location: https:///{{.dest}}")) && !StringSearch("resHeaders", "Location: https://{{.Host}}")'
  headers:
  - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101
      Firefox/55
  method: GET
  redirect: false
  url: '{{.root}}{{.prefix}}{{.dest}}'
- detections:
  - '(StatusCode() >= 300 && StatusCode() < 400) && (StringSearch("resHeaders", "Location:
    http://{{.dest}}") || StringSearch("resHeaders", "Location: https://{{.dest}}")
    || StringSearch("resHeaders", "Location: {{.dest}}") || StringSearch("resHeaders",
    "Location: https:///{{.dest}}")) && !StringSearch("resHeaders", "Location: https://{{.Host}}")'
  headers:
  - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101
      Firefox/55
  method: GET
  redirect: false
  url: '{{.root}}{{.prefix}}https://{{.dest}}'
variables:
- prefix: "/\n/@\n///\n/%00/\n/%0a/\n/%0d/\n/%5c/%2f%2e%2e\n/\u3031%2f%2e%2e\n"
