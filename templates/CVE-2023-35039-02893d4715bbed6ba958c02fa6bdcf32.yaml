http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - bdvs-password-reset
  - dsl:
    - compare_versions(version, '<= 0.0.15')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/bdvs-password-reset/readme.txt'
  redirects: true
id: CVE-2023-35039-02893d4715bbed6ba958c02fa6bdcf32
info:
  author: topscoder
  classification:
    cve-id: CVE-2023-35039
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The Password Reset with Code for WordPress REST API is vulnerable
    to a Weak Password Recovery Mechanism in versions up to, and including, 0.0.15.
    This allows unauthenticated attackers to set a 4-digit password recovery code
    for arbitrary users that, if guessed correctly, will allow them to reset the password
    for that user. Although each code is only allowed 3 tries by default, there is
    no restriction on the number of code generation attempts allowed, effectively
    reducing the entropy of the password reset mechanism to 4 digits. Additionally
    the code generation mechanism uses str_shuffle which does not use a cryptographically
    secure PNRG.

    '
  metadata:
    fofa-query: wp-content/plugins/bdvs-password-reset/
    google-query: inurl:"/wp-content/plugins/bdvs-password-reset/"
    shodan-query: vuln:CVE-2023-35039
  name: 'Password Reset with Code for WordPress REST API <= 0.0.15 - Weak Password
    Recovery Mechanism

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/f44b9e6d-2f84-45f6-9f74-3f23b03c5a49?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,bdvs-password-reset,critical
