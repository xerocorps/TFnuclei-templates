http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - tawkto-live-chat
  - dsl:
    - compare_versions(version, '< 0.6.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/tawkto-live-chat/readme.txt'
  redirects: true
id: CVE-2021-24914-e20d706c54b250ea8f16969bc41bf054
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24914
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8
  description: 'The Tawk.To Live Chat WordPress plugin before 0.6.0 does not have
    capability and CSRF checks in the tawkto_setwidget and tawkto_removewidget AJAX
    actions, available to any authenticated user. The first one allows low-privileged
    users (including simple subscribers) to change the ''tawkto-embed-widget-page-id''
    and ''tawkto-embed-widget-widget-id'' parameters. Any authenticated user can thus
    link the vulnerable website to their own Tawk.to instance. Consequently, they
    will be able to monitor the vulnerable website and interact with its visitors
    (receive contact messages, answer, ...). They will also be able to display an
    arbitrary Knowledge Base. The second one will remove the live chat widget from
    pages.

    '
  metadata:
    fofa-query: wp-content/plugins/tawkto-live-chat/
    google-query: inurl:"/wp-content/plugins/tawkto-live-chat/"
    shodan-query: vuln:CVE-2021-24914
  name: 'Tawk.To Live Chat <= 0.5.4 - Missing Authorization to Visitor Monitoring
    & Chat Removal

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/4c3ee9fa-5d66-4f84-818f-ceec2f0c0b96?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,tawkto-live-chat,low
