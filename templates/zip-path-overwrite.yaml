file:
- extensions:
  - all
  matchers:
  - condition: or
    regex:
    - require\('unzip'\)
    - require\('unzipper'\)
    - '[\w\W]+?\.pipe\([\w\W]+?\.Parse\([\w\W]*?\)\)\.on\(''entry'', function [\w\W]*?\([\w\W]*?\)
      \{'
    - '[\w\W]+? = [\w\W]+?\.indexOf\([\w\W]*?\)'
    - '[\w\W]+?\.pipe\([\w\W]+?\.createWriteStream\([\w\W]*?\)\)'
    - '[\w\W]+?\.pipe\([\w\W]+?\.writeFile\([\w\W]*?\)\)'
    - '[\w\W]+?\.pipe\([\w\W]+?\.writeFileSync\([\w\W]*?\)\)'
    - '[\w\W]+?\.Parse\([\w\W]*?\)\.on\(''entry'', function [\w\W]*?\([\w\W]*?\) \{'
    - '[\w\W]+?\.createWriteStream\([\w\W]*?\)'
    - '[\w\W]+?\.writeFile\([\w\W]*?\)'
    - '[\w\W]+?\.writeFileSync\([\w\W]*?\)'
    type: regex
id: zip-path-overwrite
info:
  author: me_dheeraj (https://twitter.com/Dheerajmadhukar)
  description: Insecure ZIP archive extraction can result in arbitrary path overwrite
    and can result in code injection.
  name: Zip Path Overwrite
  severity: info
  tags: file,nodejs
