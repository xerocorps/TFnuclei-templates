flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - 'contains_all(body, "Organization: ", "-URL: ")'
    internal: true
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/masthead/masthead.axfm'
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "x-bes-command-hasiteversion:")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/cgi-bin/bfenterprise/clientregister.exe?RequestType=FetchCommands'
id: CVE-2019-4061
info:
  author: daffainfo
  classification:
    cpe: cpe:2.3:a:ibm:bigfix_platform:*:*:*:*:*:*:*:*
    cve-id: CVE-2019-4061
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    cwe-id: CWE-200
    epss-percentile: 0.99018
    epss-score: 0.7919
  description: 'IBM BigFix Platform 9.2 and 9.5 contains an information disclosure
    vulnerability caused by not enabling authenticated access in relay, letting remote
    attackers query and gather update and fixlet information, exploit requires no
    authentication.

    '
  impact: 'Attackers can remotely gather sensitive update and fixlet deployment information,
    potentially aiding targeted attacks.

    '
  metadata:
    max-request: 2
    product: bigfix_platform
    shodan-query: port:52311 "BigFixHTTPServer"
    vendor: ibm
    verified: true
  name: IBM BigFix Platform - Information Disclosure
  reference:
  - https://www.atredis.com/blog/2019/3/18/harvesting-data-from-bigfix-relay-servers
  - https://github.com/rapid7/metasploit-framework/blob/0fd8f0984e10a135c000d1fb8797d76d62fb24f7/modules/auxiliary/gather/ibm_bigfix_sites_packages_enum.rb
  - https://nvd.nist.gov/vuln/detail/CVE-2019-4061
  remediation: 'Enable authenticated access for relay to prevent unauthorized information
    queries.

    '
  severity: medium
  tags: cve,cve2019,ibm,bigfix,disclosure,vkev
