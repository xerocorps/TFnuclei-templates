code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - '1'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'Get-ItemProperty ''HKLM:\SYSTEM\CurrentControlSet\Control\Remote Assistance''
    -Name ''fAllowToGetHelp'' -ErrorAction SilentlyContinue | Where-Object { $_.fAllowToGetHelp
    -eq 1 } | Select-Object -ExpandProperty fAllowToGetHelp

    '
id: remote-assistance-enabled
info:
  author: princechaddha
  description: Checks if Remote Assistance is enabled contrary to security policies.
  impact: 'Enabling Remote Assistance can lead to unauthorized access.

    '
  name: Check Remote Assistance Misconfiguration
  remediation: 'Disable Remote Assistance to comply with security policy.

    '
  severity: medium
  tags: remote-assistance, misconfiguration, windows-audit
self-contained: true
