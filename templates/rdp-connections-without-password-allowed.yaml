code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - RDP connections allowed without password.
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'if ((Get-ItemProperty -Path ''HKLM:\SYSTEM\CurrentControlSet\Control\Terminal
    Server'' -Name ''fPromptForPassword'' -ErrorAction SilentlyContinue).fPromptForPassword
    -eq 0) { "RDP connections allowed without password." }

    '
id: rdp-connections-without-password-allowed
info:
  author: princechaddha
  description: Checks if Remote Desktop Protocol connections are allowed without requiring
    a password.
  impact: 'Allowing RDP connections without a password increases the risk of unauthorized
    access to the system.

    '
  name: Remote Desktop Connections Allowed Without Password
  remediation: 'Require passwords for all RDP connections to secure access.

    '
  severity: high
  tags: windows,rdp,code,windows-audit
self-contained: true
