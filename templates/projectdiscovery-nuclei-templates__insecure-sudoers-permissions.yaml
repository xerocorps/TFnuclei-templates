code:
- engine:
  - sh
  - bash
  matchers:
  - status:
    - 0
    type: status
  - negative: true
    regex:
    - ^-r--r-----\s+\d+\s+root\s+\w+
    type: regex
  matchers-condition: and
  source: 'ls -l /etc/sudoers 2>&1

    '
id: insecure-sudoers-permissions
info:
  author: geeknik
  description: 'Audits permissions on the /etc/sudoers file that defines which users
    can run commands with root privileges on macOS.

    '
  impact: 'Insecure permissions on /etc/sudoers could allow unauthorized users to
    modify the file and grant themselves root privileges.

    '
  name: macOS Insecure /etc/sudoers Permissions
  remediation: 'Ensure that the /etc/sudoers file is owned by root with a system group
    (wheel, admin, etc.) and has permissions of 0440 or more restrictive.

    '
  severity: high
  tags: macos,audit,local,security,sudo
self-contained: true
