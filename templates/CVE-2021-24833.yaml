http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - yop-poll
  - dsl:
    - compare_versions(version, '<= 6.3.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/yop-poll/readme.txt'
  redirects: true
id: CVE-2021-24833
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24833
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
  description: The YOP Poll WordPress plugin before 6.3.1 is affected by a stored
    Cross-Site Scripting vulnerability, which exists in the Admin preview module where
    a user with a role as low as author is allowed to execute arbitrary script code
    within the context of the application. This vulnerability is due to insufficient
    validation of question and answer text parameters in Create Poll module.
  metadata:
    fofa-query: wp-content/plugins/yop-poll/
    google-query: inurl:"/wp-content/plugins/yop-poll/"
    shodan-query: vuln:CVE-2021-24833
  name: YOP Poll <= 6.3.0 - Author+ Stored Cross-Site Scripting via Preview Module
  reference:
  - https://wpscan.com/vulnerability/7cb39087-fbab-463d-9592-003e3fca6d34
  - https://plugins.trac.wordpress.org/changeset/2605368
  - https://www.fortiguard.com/zeroday/FG-VD-21-052
  severity: medium
  tags: cve,wordpress,wp-plugin,yop-poll,medium
