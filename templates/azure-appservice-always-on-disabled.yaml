code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[].[]
    name: webAppList
    type: json
  source: 'az webapp list --output json --query ''[*].{id:id}''

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"Always On feature is disabled for WebApp with ID: " + id'
    type: dsl
  matchers:
  - type: word
    words:
    - 'false'
  source: 'az webapp config show --ids "$ids" --query ''alwaysOn'' --output json

    '
flow: "code(1);\nfor (let WebAppData of iterate(template.webAppList)) {\n  set(\"\
  ids\", WebAppData);\n  code(2);\n}\n"
id: azure-appservice-always-on-disabled
info:
  author: princechaddha
  description: 'Ensure that your Microsoft Azure App Services web applications have
    Always On feature enabled in order to prevent applications from being idled out
    due to inactivity. Always On keeps your websites/web applications loaded even
    when there''s no traffic.

    '
  impact: 'Disabling Always On may lead to your web applications being unloaded during
    periods of inactivity, potentially causing delayed responses to incoming traffic
    and impacting user experience.

    '
  name: Azure App Service Always On Disabled
  reference:
  - https://docs.microsoft.com/en-us/azure/app-service/configure-common
  remediation: 'Enable the Always On feature for your Azure App Services web applications
    to ensure they remain active and responsive at all times.

    '
  severity: medium
  tags: cloud,devops,azure,microsoft,appservice,azure-cloud-config
self-contained: true
