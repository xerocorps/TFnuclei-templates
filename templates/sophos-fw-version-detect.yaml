id: sophos-fw-version-detect
info:
  author: organiccrap
  name: Sophos Firewall version detection
  severity: info
requests:
- extractors:
  - part: body
    regex:
    - (\d{2}.\d{1,2}.\d{1,2}.\d{2,3})
    type: regex
  matchers:
  - type: word
    words:
    - <title>Sophos</title>
  - part: body
    regex:
    - (\d{2}.\d{1,2}.\d{1,2}.\d{2,3})
    type: regex
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/webconsole/webpages/login.jsp'
  - '{{BaseURL}}/userportal/webpages/myaccount/login.jsp'
