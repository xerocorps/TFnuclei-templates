code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: accountList
    type: json
  source: 'az storage account list --query ''[*].{"name":name}''

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - name + " has logging disabled for read, write, and delete operations."
    type: dsl
  matchers:
  - condition: and
    type: word
    words:
    - '"delete": false'
    - '"read": false'
    - '"write": false'
  matchers-condition: and
  source: 'az storage logging show --services b --account-name "$name" --output json

    '
flow: "code(1);\nfor (let AccountData of iterate(template.accountList)) {\n  AccountData\
  \ = JSON.parse(AccountData);\n  set(\"name\", AccountData.name);\n  code(2);\n}\n"
id: azure-blob-service-logging-disabled
info:
  author: princechaddha
  description: 'Ensure that Azure Storage Blob service logging is enabled for read,
    write, and delete requests. The Storage Blob service provides scalable, cost-efficient
    objective storage in the Azure cloud. Storage logging is performed server-side
    and allows details for both successful and failed requests to be recorded in the
    associated storage account. These logs contain the following information about
    the individual requests: timing information such as start time, end-to-end latency,
    server latency, authentication details, concurrency information, and the size
    of the request/response.

    '
  impact: 'Not enabling logging for read, write, and delete operations on Azure Storage
    Blob can prevent tracking of data access and manipulation, thus reducing the ability
    to diagnose issues or detect breaches.

    '
  name: Azure Storage Blob Service Logging Not Enabled
  reference:
  - https://docs.microsoft.com/en-us/azure/storage/common/storage-analytics-logging
  remediation: 'Enable logging for the Azure Storage Blob service by setting the ''read'',
    ''write'', and ''delete'' attributes to true in the storage account settings.

    '
  severity: medium
  tags: cloud,devops,azure,microsoft,azure-storage,azure-cloud-config
self-contained: true
