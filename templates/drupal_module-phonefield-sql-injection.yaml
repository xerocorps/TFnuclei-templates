http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '7.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - phonefield
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/phonefield/phonefield.info'
  redirects: true
id: drupal_module-phonefield-sql-injection
info:
  author: Bishopfox
  description: This module provides a phone field for Drupal 7 that supports the HTML5
    tel:-schema. In an API function that is not used by the module, the name for the
    phone field is not sufficiently sanitised when using it in database queries. This
    vulnerability is mitigated by the fact that it affects an unused function. A site
    is only vulnerable if it has custom code that uses the phonefield_get_entity_id()
    function and exposes control over the $field parameter to visitors to the site.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/phonefield/
    google-query: inurl:'/sites/all/modules/phonefield/
    impact: medium
    security-risk: "Critical 16\u221525 AC:Basic/A:User/CI:All/II:All/E:Theoretical/TD:Uncommon"
    type: indicator
    vulnerability: sql-injection
  name: drupal_module-phonefield-sql-injection
  reference:
  - https://www.drupal.org/sa-contrib-2019-001
  severity: medium
  tags: drupal
