headless:
- extractors:
  - internal: true
    kval:
    - extract
    name: urls
    part: extract
    type: kval
  matchers:
  - part: urls
    type: word
    words:
    - polyfill.io
    - bootcdn.net
    - bootcss.com
    - staticfile.net
    - staticfile.org
    - unionadjs.com
    - xhsbpza.com
    - union.macoms.la
    - newcrbpc.com
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}'
  - action: waitload
  - action: script
    args:
      code: "() => {\n return '\\n' + [...new Set(Array.from(document.querySelectorAll('[src],\
        \ [href], [url], [action]')).map(i => i.src || i.href || i.url || i.action))].join('\\\
        r\\n') + '\\n'\n}\n"
    name: extract
id: CVE-2024-38526
info:
  author: abut0n
  classification:
    cve-id: CVE-2024-38526
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:L
    cvss-score: 7.2
    epss-percentile: 0.99165
    epss-score: 0.82064
  description: 'pdoc provides API Documentation for Python Projects. Documentation
    generated with `pdoc --math` linked to JavaScript files from polyfill.io

    '
  impact: 'The polyfill.io CDN has been sold and now serves malicious code.

    '
  name: Polyfill Supply Chain Attack Malicious Code Execution
  reference:
  - https://sansec.io/research/polyfill-supply-chain-attack
  - https://nvd.nist.gov/vuln/detail/CVE-2024-38526
  - https://x.com/triblondon/status/1761852117579427975
  - https://github.com/mitmproxy/pdoc/pull/703
  - https://github.com/mitmproxy/pdoc/security/advisories/GHSA-5vgj-ggm4-fg62
  remediation: 'This issue has been fixed in pdoc 14.5.1.

    '
  severity: high
  tags: cve,cve2024,supply-chain,polyfill,vkev,vuln
