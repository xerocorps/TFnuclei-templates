http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 5.8', '< 5.8.3')
    - compare_versions(version_by_js, '>= 5.8', '< 5.8.3')
    - compare_versions(version_by_css, '>= 5.8', '< 5.8.3')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2022-21662-wordpress-c272f769-65da-4963-aff0-8f68a277ea63
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-21662
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H
    cvss-score: 8
  description: 'WordPress is a free and open-source content management system written
    in PHP and paired with a MariaDB database. Low-privileged authenticated users
    (like author) in WordPress core are able to execute JavaScript/perform stored
    XSS attack, which can affect high-privileged users. This has been patched in WordPress
    version 5.8.3. Older affected versions are also fixed via security release, that
    go back till 3.7.37. We strongly recommend that you keep auto-updates enabled.
    There are no known workarounds for this issue.

    '
  metadata:
    shodan-query: vuln:CVE-2022-21662
  name: 'WordPress Core < 5.8.3 - Authenticated (Author+) Stored Cross Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/c272f769-65da-4963-aff0-8f68a277ea63?source=api-prod
  severity: low
  tags: cve,wordpress,wp-core,low,production
