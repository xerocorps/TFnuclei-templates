http:
- attack: clusterbomb
  matchers:
  - condition: and
    dsl:
    - body == "{\"code\":0}"
    - status_code == 200
    type: dsl
  - condition: and
    dsl:
    - contains(body, "\"token\":") && contains(body, "\"license\":")
    - contains(content_type, 'application/json')
    - status_code == 200
    type: dsl
  matchers-condition: or
  payloads:
    path:
    - /api/v4/auth
    - /api/v5/login
  raw:
  - 'POST {{path}} HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"username":"{{username}}","password":"{{password}}"}

    '
id: emqx-default-login
info:
  author: For3stCo1d
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L
    cvss-score: 8.3
    cwe-id: CWE-522
  description: Emqx default admin credentials were discovered.
  metadata:
    max-request: 1
    shodan-query: http.favicon.hash:"-670975485"
  name: Emqx Default Admin Login
  severity: high
  tags: emqx,default-login,vuln
variables:
  password: public
  username: admin
