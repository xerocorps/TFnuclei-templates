id: ldap-user-enum
info:
  author: pussycat0x
  description: 'Ldap Usrname Enumeration.

    '
  metadata:
    max-request: 1
    shodan-query: ldap
  name: LDAP UserNames - Enumeration
  reference:
  - https://cxyy4rle.blogspot.com/2019/09/testing-ldap-servers-with-examples.html
  severity: info
  tags: js,network,ldap,anonymous
javascript:
- args:
    Host: ldap://{{Host}}
    Ldap: '{{Host}}'
    Pass: '{{passwords}}'
    Port: 389
    User: '{{usernames}}'
  attack: clusterbomb
  code: 'const ldap = require(''nuclei/ldap'');

    const cfg = new ldap.Config();

    cfg.Upgrade = true;

    const client = new ldap.Client(Host, Ldap, Port, cfg);

    const dcs = client.Search(''cn=admin'',''dc=acme'',''dc=com'');

    log(to_json(dcs));

    '
  matchers:
  - condition: and
    dsl:
    - response != "[]"
    - success == true
    type: dsl
  payloads:
    passwords:
    - toor
    usernames:
    - root
  stop-at-first-match: true
