http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 6.5', '<= 6.5.4')
    - compare_versions(version_by_js, '>= 6.5', '<= 6.5.4')
    - compare_versions(version_by_css, '>= 6.5', '<= 6.5.4')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2024-6307-wordpress-bc0d36f8-6569-49a1-b722-5cf57c4bb32a
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-6307
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 6.4
  description: 'WordPress Core is vulnerable to Stored Cross-Site Scripting via the
    HTML API in various versions prior to 6.5.5 due to insufficient input sanitization
    and output escaping on URLs. This makes it possible for authenticated attackers,
    with contributor-level access and above, to inject arbitrary web scripts in pages
    that will execute whenever a user accesses an injected page.

    '
  metadata:
    shodan-query: vuln:CVE-2024-6307
  name: 'WordPress Core < 6.5.5 - Authenticated (Contributor+) Stored Cross-Site Scripting
    via HTML API

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/bc0d36f8-6569-49a1-b722-5cf57c4bb32a?source=api-prod
  severity: low
  tags: cve,wordpress,wp-core,low,production
