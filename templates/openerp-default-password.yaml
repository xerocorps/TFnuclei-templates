expression: r0()
id: openerp-default-password
info:
  author: zan8in
  description: app="OpenERP"
  name: Openerp Default Password
  severity: high
  verified: true
rules:
  r0:
    expression: 'response.status == 200 && response.body.bcontains(b"\"username\":
      \"admin\",")

      '
    request:
      body: '{"jsonrpc":"2.0","method":"call","params":{"db":"OPENERP7","login":"admin","password":"admin","base_location":"{{hosturl}}","session_id":"{{r1}}","context":{}},"id":"r7"}

        '
      headers:
        Accept: application/json, text/javascript, */*; q=0.01
        Accept-Encoding: gzip, deflate
        Content-Type: application/json
        Origin: '{{hosturl}}'
        Referer: '{{hosturl}}'
        X-Requested-With: XMLHttpRequest
      method: POST
      path: /web/session/authenticate
set:
  hosturl: request.url
  r1: md5(randomLowercase(6))
