http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - regex("\\[\\d{2}-[A-Za-z]{3}-\\d{4} \\d{2}:\\d{2}:\\d{2}", body)
    - contains_any(body, "PHP Fatal error:", "PHP Warning:", "PHP Notice:", "PHP Parse
      error:")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/newsletter/error_log'
  - '{{BaseURL}}/wp-content/plugins/newsletter/classes/Newsletter/Logs.php'
  stop-at-first-match: true
id: wp-newsletter-log-exposure
info:
  author: pussycat0x
  description: 'The Newsletters plugin for WordPress is vulnerable to Sensitive Information
    Exposure in all versions up to, and including, 4.9.5. This makes it possible for
    unauthenticated attackers to extract potentially sensitive information from log
    files.

    '
  metadata:
    shodan-query: http.html:"/wp-content/plugins/newsletter/"
  name: WordPress Newsletter - Log File Exposure
  reference:
  - https://wpscan.com/vulnerability/334e02e9-fcbd-47fe-b7ab-079dd525b396/
  severity: medium
  tags: wordpress,wp-plugin,newsletter,logs
