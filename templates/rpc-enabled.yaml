code:
- engine:
  - bash
  matchers:
  - part: response
    type: word
    words:
    - '[VULNERABLE]'
  source: "if [ -f /etc/xinetd.d/rstatd ]; then\n  if grep -qE 'disable\\s*=\\s*no'\
    \ /etc/xinetd.d/rstatd; then\n    echo \"[VULNERABLE] rstatd RPC service is enabled\
    \ in xinetd\"\n  else\n    echo \"[SAFE] rstatd RPC service is disabled in xinetd\"\
    \n  fi\nelif systemctl is-active --quiet rstatd 2>/dev/null; then\n  echo \"[VULNERABLE]\
    \ rstatd service is active under systemd\"\nelse\n  echo \"[SAFE] rstatd service\
    \ not found\"\nfi\n"
id: rpc-enabled
info:
  author: songyaeji
  description: 'Unnecessary RPC services like rstatd were enabled, allowing attackers
    to exploit buffer overflow, DoS, or remote execution vulnerabilities to gain root
    privileges and compromise the system.These services were expected to be disabled
    unless explicitly required.

    '
  name: Unnecessary RPC Service (rstatd) Enabled
  reference:
  - https://isms.kisa.or.kr
  severity: high
  tags: linux,local,audit,compliance,kisas
self-contained: true
