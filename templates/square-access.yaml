flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    name: token
    part: body
    regex:
    - EAAAl[^\s]+
    type: regex
  method: GET
  path:
  - '{{BaseURL}}'
- disable-path-automerge: true
  extractors:
  - dsl:
    - token
    type: dsl
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - locations
    - longitude
    - country
  raw:
  - '@Host: https://connect.squareup.com:443

    GET /v2/locations HTTP/1.1

    Host: connect.squareup.com

    Square-Version: 2023-01-19

    Authorization: Bearer {{token}}

    Content-Type: application/json

    '
id: square-access
info:
  author: DhiyaneshDK
  metadata:
    max-request: 1
    verified: true
  name: Square Access Token
  reference:
  - https://developer.squareup.com/docs/build-basics/access-tokens
  - https://github.com/praetorian-inc/noseyparker/blob/main/crates/noseyparker/data/default/builtin/rules/square.yml
  - https://github.com/semgrep/semgrep-rules/blob/develop/generic/secrets/gitleaks/square-access-token.yaml
  severity: high
  tags: square,token,exposure,vuln
