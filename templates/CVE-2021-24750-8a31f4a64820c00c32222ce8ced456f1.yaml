http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-stats-manager
  - dsl:
    - compare_versions(version, '< 4.8')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-stats-manager/readme.txt'
  redirects: true
id: CVE-2021-24750-8a31f4a64820c00c32222ce8ced456f1
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24750
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: 'The WP Visitor Statistics (Real Time Traffic) WordPress plugin before
    4.8 does not properly sanitise and escape the refUrl in the refDetails AJAX action,
    available to any authenticated user, which could allow users with a role as low
    as subscriber to perform SQL injection attacks

    '
  metadata:
    fofa-query: wp-content/plugins/wp-stats-manager/
    google-query: inurl:"/wp-content/plugins/wp-stats-manager/"
    shodan-query: vuln:CVE-2021-24750
  name: 'WP Visitor Statistics (Real Time Traffic) <= 4.7 - SQL Injection

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/9687e8e5-add1-477d-9cb7-f94b8af10da5?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,wp-stats-manager,low
