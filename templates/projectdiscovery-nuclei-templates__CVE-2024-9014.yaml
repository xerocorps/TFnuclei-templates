http:
- matchers:
  - negative: true
    part: body
    regex:
    - 'OAUTH2_CLIENT_SECRET": null'
    type: regex
  - condition: and
    part: body
    type: word
    words:
    - <title>pgAdmin 4</title>
    - OAUTH2_CLIENT_SECRET
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /login?next=/ HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-9014
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-9014
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 9.9
    cwe-id: CWE-522
    epss-percentile: 0.99737
    epss-score: 0.92693
  description: 'pgAdmin 4 versions 8.11 and earlier are vulnerable to a security flaw
    in OAuth2 authentication. This vulnerability allows an attacker to potentially
    obtain the client ID and secret, leading to unauthorized access to user data.

    '
  impact: 'Attackers can potentially obtain OAuth2 client ID and secret from exposed
    configuration in the login page, leading to unauthorized access to user data,
    authentication bypass, and compromise of pgAdmin 4 instances.

    '
  metadata:
    fofa-query: pgadmin4
    max-request: 1
    product: pgadmin4
    vendor: pgadmin-org
    verified: true
  name: pgAdmin 4 - Authentication Bypass
  reference:
  - https://github.com/EQSTLab/CVE-2024-9014
  - https://github.com/pgadmin-org/pgadmin4/issues/7945
  - https://nvd.nist.gov/vuln/detail/CVE-2024-9014
  remediation: 'Update pgAdmin 4 to a version later than 8.11 that addresses the OAuth2
    authentication vulnerability and properly secures client credentials from public
    exposure.

    '
  severity: critical
  tags: cve,cve2024,pgadmin,exposure,auth-bypass,vkev,vuln
