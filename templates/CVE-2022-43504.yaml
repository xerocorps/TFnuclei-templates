http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '<= 3.6.1')
    - compare_versions(version_by_js, '<= 3.6.1')
    - compare_versions(version_by_css, '<= 3.6.1')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2022-43504
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-43504
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
  description: WordPress Core in versions up to 6.0.3 are vulnerable to Cross-Site
    Scripting via wp-mail.php. This is due to no validation on what level the user
    was sending the email post and therefore did not perform any sanitization on the
    submitted post data. This meant that users without the unfiltered_html capability,
    with access to submitting posts via email, could inject malicious JavaScript into
    posts that would execute whenever someone accessed the post.
  metadata:
    shodan-query: vuln:CVE-2022-43504
  name: WordPress Core < 6.0.3 - Stored Cross-Site Scripting via wp-mail.php
  reference:
  - https://www.wordfence.com/blog/2022/10/patch-now-the-wordpress-6-0-3-security-update-contains-important-fixes/
  - https://wordpress.org/news/2022/10/wordpress-6-0-3-security-release/
  - https://core.trac.wordpress.org/changeset/54531
  severity: high
  tags: cve,wordpress,wp-core,high
