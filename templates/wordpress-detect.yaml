id: wordpress-detect
info:
  author: pdteam
  metadata:
    shodan-query: http.component:"WordPress"
  name: WordPress Detection
  severity: info
  tags: tech,wordpress
requests:
- extractors:
  - group: 1
    regex:
    - content="WordPress ([0-9.]+)"
    type: regex
  matchers:
  - condition: or
    regex:
    - <link[^>]+s\d+\.wp\.com
    - <!-- This site is optimized with the Yoast (?:WordPress )?SEO plugin v([\d.]+)
      -
    - <!--[^>]+WP-Super-Cache
    type: regex
  - condition: or
    type: word
    words:
    - /wp-content/themes/
    - /wp-includes/
    - name="generator" content="wordpress
    - '<!-- performance optimized by w3 total cache. learn more: http://www.w3-edge.com/wordpress-plugins/'
  matchers-condition: or
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  redirects: true
