flow: http(1) && http(2)
http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - compare_versions(version, '< 7.87')
    internal: true
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/all-in-one-wp-migration/readme.txt'
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, 'Number', 'Message')
    - contains(tolower(header), 'text/plain')
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/all-in-one-wp-migration/storage/error.log'
id: CVE-2024-8852
info:
  author: FLX
  classification:
    cve-id: cve-2024-8852
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-532
  description: 'The All-in-One WP Migration and Backup plugin for WordPress is vulnerable
    to unauthenticated information disclosure due to its error.log file being publicly
    accessible in versions before 7.87.

    '
  impact: 'An unauthenticated attacker can access the error.log file, which may contain
    sensitive information such as full server path disclosures, backup filenames,
    and other debugging details. This information could be used in further attacks.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/all-in-one-wp-migration"
    verified: true
  name: All-in-One WP Migration < 7.87 - Unauthenticated Information Disclosure
  reference:
  - https://wpscan.com/vulnerability/9f533098-8435-4ee1-a423-5142070ceefc/
  - https://wordpress.org/plugins/all-in-one-wp-migration/#developers
  remediation: 'Update the All-in-One WP Migration and Backup plugin to version 7.87
    or later.

    '
  severity: medium
  tags: cve,cve2024,wpscan,wp,wordpress,wp-plugin,all-in-one-wp-migration,disclosure,vkev
