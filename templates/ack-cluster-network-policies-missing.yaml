code:
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"Cluster is not using the plugin to enforce network policies"'
    type: dsl
  matchers:
  - regex:
    - '"Network"\s*:\s*"'
    type: regex
  - negative: true
    type: word
    words:
    - '"Network": "terway-eniip"'
  matchers-condition: and
  source: 'aliyun cs GET /clusters --header "Content-Type=application/json;" --body
    "{}"

    '
id: ack-cluster-network-policies-missing
info:
  author: ritikchaddha
  description: 'Ensure that your ACK clusters are using Kubernetes network policies
    to implement secure policy-based access control. Container Service for Kubernetes
    (ACK) employs the Terway network plugin to enforce network policies at the cluster
    level.

    '
  metadata:
    max-request: 2
    verified: true
  name: Cluster Support for Network Policies - Missing
  reference:
  - https://www.trendmicro.com/cloudoneconformity/knowledge-base/alibaba-cloud/AlibabaCloud-ACK/enable-network-policy-support.html
  severity: medium
  tags: cloud,devops,aliyun,alibaba,aliyun-cloud-config,ack
self-contained: true
variables:
  region: cn-hangzhou
