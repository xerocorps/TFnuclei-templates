http:
- matchers:
  - status:
    - 200
    type: status
  - condition: or
    part: body
    type: word
    words:
    - SERVER_SOFTWARE
    - SERVER_NAME
    - GATEWAY_INTERFACE
    - SERVER_PROTOCOL
    - REQUEST_METHOD
    - QUERY_STRING
    - REMOTE_ADDR
    - HTTP_USER_AGENT
  - condition: or
    part: body
    type: word
    words:
    - PATH=
    - '/bin:'
    - '/usr/bin:'
    - LD_LIBRARY_PATH
    - MYSQL_HOME
    - OPENSSL_CONF
    - DOCUMENT_ROOT
    - SCRIPT_FILENAME
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/info.cgi'
  - '{{BaseURL}}/cgi-bin/info.cgi'
  - '{{BaseURL}}/cgi-sys/info.cgi'
  - '{{BaseURL}}/scripts/info.cgi'
  - '{{BaseURL}}/lite-scripts/info.cgi'
  stop-at-first-match: true
id: info-cgi-env-leak
info:
  author: pussycat0x
  description: 'Detected exposure of server environment variables through the info.cgi
    script. This can leak sensitive paths, internal IPs, software versions, credentials
    in env, etc.

    '
  metadata:
    max-request: 5
    verified: true
  name: info.cgi  Environment Variable - Disclosure
  reference:
  - https://www.acunetix.com/vulnerabilities/web/test-cgi-script-leaking-environment-variables/
  - https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/cgi
  severity: medium
  tags: cgi,exposure,info,env,disclosure,generic
