code:
- engine:
  - sh
  - bash
  matchers:
  - type: word
    words:
    - agetty
  source: 'find /bin /sbin /usr/bin /usr/sbin /usr/local/sbin -type f -name agetty
    2>/dev/null -perm /4000

    find /bin /sbin /usr/bin /usr/sbin /usr/local/sbin -type f -name agetty 2>/dev/null
    -perm /6000

    '
id: privesc-agetty
info:
  author: bobakabill
  description: 'The agetty command in Linux is used to invoke the /bin/login command
    for a given user. If the SUID bit is set, it can be used to gain a high-privilege
    s>

    '
  metadata:
    max-request: 2
    verified: true
  name: agetty - Privilege Escalation
  reference:
  - https://gtfobins.github.io/gtfobins/agetty/
  severity: high
  tags: code,linux,find,privesc,local
self-contained: true
