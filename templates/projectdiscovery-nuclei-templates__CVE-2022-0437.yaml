http:
- extractors:
  - group: 1
    internal: true
    name: version
    regex:
    - '(?m)VERSION: ''([0-9.]+)'''
    type: regex
  matchers:
  - dsl:
    - compare_versions(version, '< 6.3.14')
    type: dsl
  - part: body_2
    type: word
    words:
    - Karma
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/karma.js'
  - '{{BaseURL}}/?return_url=javascript:alert(document.domain)'
id: CVE-2022-0437
info:
  author: pikpikcu
  classification:
    cpe: cpe:2.3:a:karma_project:karma:*:*:*:*:*:node.js:*:*
    cve-id: CVE-2022-0437
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.93548
    epss-score: 0.12079
  description: NPM karma prior to 6.3.14. contains a DOM-based cross-site Scripting
    vulnerability.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to potential data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    framework: node.js
    max-request: 2
    product: karma
    vendor: karma_project
  name: karma-runner DOM-based Cross-Site Scripting
  reference:
  - https://huntr.dev/bounties/64b67ea1-5487-4382-a5f6-e8a95f798885
  - https://github.com/karma-runner/karma/commit/839578c45a8ac42fbc1d72105f97eab77dd3eb8a
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0437
  - https://github.com/karma-runner/karma
  - https://github.com/ARPSyndicate/cvemon
  remediation: 'Upgrade to the latest version of karma-runner that includes proper
    input sanitization to mitigate this vulnerability.

    '
  severity: medium
  tags: cve2022,cve,oss,huntr,karma,xss,karma_project,node.js,passive,vuln
