http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - site-audit
  - dsl:
    - compare_versions(version, '<= 1.2.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/site-audit/readme.txt'
  redirects: true
id: CVE-2021-24445
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24445
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 5.5
  description: The My Site Audit WordPress plugin through 1.2.4 does not sanitise
    or escape the Audit Name field when creating an audit, allowing high privilege
    users to set JavaScript payloads in them, even when he unfiltered_html capability
    is disallowed, leading to an authenticated Stored Cross-Site Scripting issue.
  metadata:
    fofa-query: wp-content/plugins/site-audit/
    google-query: inurl:"/wp-content/plugins/site-audit/"
    shodan-query: vuln:CVE-2021-24445
  name: My Site Audit <= 1.2.5 - Authenticated (Admin+) Stored Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/d60634a3-ca39-43be-893b-ff9ba625360f
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2669756%40site-audit&new=2669756%40site-audit&sfp_email=&sfph_mail=
  severity: medium
  tags: cve,wordpress,wp-plugin,site-audit,medium
