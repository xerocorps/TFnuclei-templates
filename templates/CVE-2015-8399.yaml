id: CVE-2015-8399
info:
  author: princechaddha
  classification:
    cve-id: CVE-2015-8399
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 4.3
    cwe-id: CWE-200
  description: Atlassian Confluence before 5.8.17 allows remote authenticated users
    to read configuration files via the decoratorName parameter to (1) spaces/viewdefaultdecorator.action
    or (2) admin/viewdefaultdecorator.action.
  metadata:
    shodan-query: http.component:"Atlassian Confluence"
  name: Atlassian Confluence configuration files read
  reference:
  - https://jira.atlassian.com/browse/CONFSERVER-39704?src=confmacro
  - https://www.exploit-db.com/exploits/39170/
  - http://www.securityfocus.com/archive/1/537232/100/0/threaded
  severity: medium
  tags: cve,cve2015,atlassian,confluence
requests:
- matchers:
  - status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - confluence-init.properties
    - View Default Decorator
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/spaces/viewdefaultdecorator.action?decoratorName'
