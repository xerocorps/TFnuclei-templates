http:
- fuzzing:
  - fuzz:
    - '{{reflection}}'
    mode: single
    part: query
    type: postfix
  - fuzz:
    - '{{reflection}}'
    mode: single
    part: path
    type: postfix
  matchers:
  - part: body
    type: word
    words:
    - '{{reflection}}'
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  payloads:
    reflection:
    - '''"><{{first}}>'
    - '''><{{first}}>'
    - '"><{{first}}>'
  pre-condition:
  - dsl:
    - method == "GET"
    type: dsl
  stop-at-first-match: true
id: ASVS-4-0-3-V5-3-3-2
info:
  author: AmirHossein Raeisi
  classification:
    cwe-id: CWE-79
  description: 'Verify that context-aware, preferably automated - or at worst, manual
    - output escaping protects against reflected, stored, and DOM based XSS. ([C4](https://owasp.org/www-project-proactive-controls/#div-numbering))

    '
  name: ASVS 5.3.3.2 (Reflected XSS) Check
  reference:
  - https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/01-Testing_for_Reflected_Cross_Site_Scripting
  - https://snbig.github.io/Vulnerable-Pages/ASVS_5_3_3/
  - https://github.com/projectdiscovery/nuclei-templates/blob/main/dast/vulnerabilities/xss/reflected-xss.yaml
  severity: medium
  tags: asvs,5.3.3
variables:
  first: '{{rand_int(10000, 99999)}}'
