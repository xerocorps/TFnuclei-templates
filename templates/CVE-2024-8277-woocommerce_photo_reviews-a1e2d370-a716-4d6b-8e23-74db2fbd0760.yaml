http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - woocommerce-photo-reviews
  - dsl:
    - compare_versions(version, '<= 1.3.13.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/woocommerce-photo-reviews/readme.txt'
  redirects: true
id: CVE-2024-8277-woocommerce_photo_reviews-a1e2d370-a716-4d6b-8e23-74db2fbd0760
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-8277
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The WooCommerce Photo Reviews Premium plugin for WordPress is vulnerable
    to authentication bypass in all versions up to, and including, 1.3.13.2. This
    is due to the plugin not properly validating what user transient is being used
    in the login() function and not properly verifying the user''s identity. This
    makes it possible for unauthenticated attackers to log in as user that has dismissed
    an admin notice in the past 30 days, which is often an administrator. Alternatively,
    a user can log in as any user with any transient that has a valid user_id as the
    value, though it would be more difficult to exploit this successfully.

    '
  metadata:
    fofa-query: wp-content/plugins/woocommerce-photo-reviews/
    google-query: inurl:"/wp-content/plugins/woocommerce-photo-reviews/"
    shodan-query: http.html:"wp-content/plugins/woocommerce-photo-reviews/"
  name: 'WooCommerce Photo Reviews Premium <= 1.3.13.2 - Authentication Bypass to
    Account Takeover and Privilege Escalation

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/a1e2d370-a716-4d6b-8e23-74db2fbd0760?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,woocommerce-photo-reviews,critical,production
