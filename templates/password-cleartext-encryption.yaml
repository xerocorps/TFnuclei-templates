code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - CLEAR_TEXT_PASSWORD_ENABLED
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: "# Export security settings to a configuration file\nsecedit /export /cfg\
    \ C:\\cfg.txt | Out-Null\n$cfg = Get-Content C:\\cfg.txt | Out-String\nif ($cfg\
    \ -match \"ClearTextPassword\\s*=\\s*(\\d)\") {\n    $value = $Matches[1]\n  \
    \  if ($value -eq \"1\") {\n        \"CLEAR_TEXT_PASSWORD_ENABLED\"\n    } else\
    \ {\n        \"CLEAR_TEXT_PASSWORD_DISABLED\"\n    }\n} else {\n    \"CLEAR_TEXT_PASSWORD_NOT_FOUND\"\
    \n}\n"
id: password-cleartext-encryption
info:
  author: nukunga[SungHyunJeon]
  description: 'Ensure the "Store passwords using reversible encryption" policy is
    set to Disabled. If enabled, it can allow stored passwords to be retrieved in
    plaintext, posing a serious security risk.

    '
  impact: 'If this setting is enabled, attackers could potentially recover user passwords,
    leading to unauthorized access and compromise of network resources.

    '
  name: Store Passwords Using Reversible Encryption Check
  reference:
  - https://isms.kisa.or.kr/main/csap/notice/?boardId=bbs_0000000000000004&mode=view&cntId=85
  remediation: "Disable this policy using one of the following methods:\n- Command\
    \ Line: Export the security configuration, set ClearTextPassword=0, and reapply\
    \ it using secedit.\n- GUI: Open Local Security Policy \u2192 Account Policies\
    \ \u2192 Password Policy \u2192 \"Store passwords using reversible encryption\"\
    \ and set it to Disabled.\n"
  severity: medium
  tags: code,windows-audit,kisa,account-management,password-policy
self-contained: true
