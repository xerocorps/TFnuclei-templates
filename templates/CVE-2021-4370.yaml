http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - ulisting
  - dsl:
    - compare_versions(version, '<= 1.7')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/ulisting/readme.txt'
  redirects: true
id: CVE-2021-4370
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-4370
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: The uListing plugin for WordPress is vulnerable to authorization bypass
    as most actions and endpoints are accessible to unauthenticated users, lack security
    nonces, and data is seldom validated. This issue exists in versions up to, and
    including, 1.6.6. This makes it possible for unauthenticated attackers to conduct
    numerous administrative actions, including those less critical than the explicitly
    outlined ones in our detection.
  metadata:
    fofa-query: wp-content/plugins/ulisting/
    google-query: inurl:"/wp-content/plugins/ulisting/"
    shodan-query: vuln:CVE-2021-4370
  name: uListing <= 1.6.6 - Missing Authorization
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/c5ada976-03b8-4219-9ae3-9060fb7b9de5?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,ulisting,critical
