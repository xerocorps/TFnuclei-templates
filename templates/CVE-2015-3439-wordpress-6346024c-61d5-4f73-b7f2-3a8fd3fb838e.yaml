http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 4.1', '<= 4.1.1')
    - compare_versions(version_by_js, '>= 4.1', '<= 4.1.1')
    - compare_versions(version_by_css, '>= 4.1', '<= 4.1.1')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2015-3439-wordpress-6346024c-61d5-4f73-b7f2-3a8fd3fb838e
info:
  author: topscoder
  classification:
    cve-id: CVE-2015-3439
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
  description: 'Cross-site scripting (XSS) vulnerability in the Ephox (formerly Moxiecode)
    plupload.flash.swf shim 2.1.2 in Plupload, as used in WordPress 3.9.x, 4.0.x,
    and 4.1.x before 4.1.2 and other products, allows remote attackers to execute
    same-origin JavaScript functions via the target parameter, as demonstrated by
    executing a certain click function, related to _init.as and _fireEvent.as.

    '
  metadata:
    shodan-query: vuln:CVE-2015-3439
  name: 'WordPress Core < 4.1.2 - Cross-Site Scripting via Ephox in Plupload

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/6346024c-61d5-4f73-b7f2-3a8fd3fb838e?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-core,medium,production
