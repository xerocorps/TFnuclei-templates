http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - automatorwp
  - dsl:
    - compare_versions(version, '< 1.7.6')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/automatorwp/readme.txt'
  redirects: true
id: CVE-2021-24717-automatorwp-9b95fe0e-4677-4667-9a84-96801b547088
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24717
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: 'The AutomatorWP WordPress plugin before 1.7.6 does not perform capability
    checks which allows users with Subscriber roles to enumerate automations, disclose
    title of private posts or user emails, call functions, or perform privilege escalation
    via Ajax actions.

    '
  metadata:
    fofa-query: wp-content/plugins/automatorwp/
    google-query: inurl:"/wp-content/plugins/automatorwp/"
    shodan-query: http.html:"wp-content/plugins/automatorwp/"
  name: 'AutomatorWP <= 1.7.5 - Privilege Escalation

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/9b95fe0e-4677-4667-9a84-96801b547088?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,automatorwp,high,production
