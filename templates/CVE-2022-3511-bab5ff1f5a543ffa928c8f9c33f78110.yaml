http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - awesome-support
  - dsl:
    - compare_versions(version, '<= 6.1.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/awesome-support/readme.txt'
  redirects: true
id: CVE-2022-3511-bab5ff1f5a543ffa928c8f9c33f78110
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-3511
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 4.3
  description: 'The Awesome Support plugin for WordPress is vulnerable to Insecure
    Direct Object Reference to (Subscriber+) Ticket Export in versions up to, and
    including, 6.1.1. Improper protection of the ''file'' parameter used to control
    the user id value during exported tickets archive downloads makes it possible
    for subscriber-level attackers to download arbitrary exported tickets for any
    user with tickets on the target site. These tickets could contain sensitive information.

    '
  metadata:
    fofa-query: wp-content/plugins/awesome-support/
    google-query: inurl:"/wp-content/plugins/awesome-support/"
    shodan-query: vuln:CVE-2022-3511
  name: 'Awesome Support <= 6.1.1 - Insecure Direct Object Reference to (Subscriber+)
    Ticket Export

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/5a94c5e7-a3d6-435b-9d10-0c325a13124f?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,awesome-support,medium
