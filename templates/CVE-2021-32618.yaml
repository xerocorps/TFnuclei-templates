id: CVE-2021-32618
info:
  author: 0x_Akoko
  classification:
    cve-id: CVE-2021-32618
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-601
  description: There is code in FS to validate that the url specified in the next
    parameter is either relative OR has the same netloc (network location) as the
    requesting URL. This check utilizes Pythons urlsplit library. However many browsers
    are very lenient on the kind of URL they accept and 'fill in the blanks' when
    presented with a possibly incomplete URL. As a concrete example - setting http://login?next=\\\github.com
    will pass FS's relative URL check however many browsers will gladly convert this
    to http://github.com.
  name: Flask Security Open Redirect
  reference:
  - https://github.com/Flask-Middleware/flask-security/issues/486
  - https://www.cvedetails.com/cve/CVE-2021-32618
  severity: medium
  tags: cve,cve2021,redirect,flask
requests:
- matchers:
  - part: header
    regex:
    - (?m)^(?:Location\s*?:\s*?)(?:https?://|//)?(?:[a-zA-Z0-9\-_]*\.)?example\.com(?:\s*?)$
    type: regex
  method: GET
  path:
  - '{{BaseURL}}/login?next=\\\example.com'
