code:
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"ActionTrail for Global Service Multi-Region is Disabled "'
    type: dsl
  matchers:
  - negative: true
    type: word
    words:
    - '"TrailRegion": "All"'
  - type: word
    words:
    - '"Status": "Enable"'
  matchers-condition: and
  source: 'aliyun actiontrail DescribeTrails --region $region

    '
id: multi-region-logging-disabled
info:
  author: DhiyaneshDK
  description: 'Global Service (Multi-Region) Logging is disabled, preventing the
    collection and monitoring of logs across multiple regions. This lack of centralized
    logging increases the risk of undetected security incidents and operational issues.

    '
  metadata:
    max-request: 1
    verified: true
  name: Global Service (Multi-Region) Logging - Disabled
  reference:
  - https://www.trendmicro.com/cloudoneconformity/knowledge-base/alibaba-cloud/AlibabaCloud-ActionTrail/enable-multi-region-trails.html
  - https://www.alibabacloud.com/help/en/actiontrail/product-overview/services-that-work-with-actiontrail
  severity: high
  tags: cloud,devops,aliyun,alibaba,alibaba-cloud-config,actiontrail
self-contained: true
variables:
  region: cn-hangzhou
