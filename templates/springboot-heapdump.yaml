http:
- matchers:
  - condition: and
    dsl:
    - '!contains(hex_encode(body_1), ''1f8b080000000000'')'
    - contains(hex_encode(body_2), '1f8b080000000000')
    type: dsl
  - condition: and
    dsl:
    - '!contains(hex_encode(body_1), ''1f8b080000000000'')'
    - contains(hex_encode(body_3), '1f8b080000000000')
    type: dsl
  - condition: or
    dsl:
    - contains(hex_encode(body_2), '4a4156412050524f46494c45') || contains(hex_encode(body_2),
      '4850524f46')
    - contains(hex_encode(body_3), '4a4156412050524f46494c45') || contains(hex_encode(body_3),
      '4850524f46')
    type: dsl
  matchers-condition: or
  max-size: 2097152
  raw:
  - 'GET /{{str}} HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /heapdump HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /actuator/heapdump HTTP/1.1

    Host: {{Hostname}}

    '
id: springboot-heapdump
info:
  author: that_juan_,dwisiswant0,wdahlenb
  description: 'A Spring Boot Actuator heap dump was detected. A heap dump is a snapshot
    of JVM memory, which could expose environment variables and HTTP requests.

    '
  metadata:
    max-request: 3
  name: Spring Boot Actuator - Heap Dump Detection
  reference:
  - https://github.com/pyn3rd/Spring-Boot-Vulnerability
  severity: critical
  tags: springboot,exposure,misconfig
variables:
  str: '{{rand_base(6)}}'
