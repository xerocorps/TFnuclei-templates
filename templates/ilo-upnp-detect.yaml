http:
- extractors:
  - group: 1
    internal: true
    name: model
    regex:
    - <modelName>(.+)</modelName>
    type: regex
  - group: 1
    internal: true
    name: number
    regex:
    - <modelNumber>([0-9.]+)</modelNumber>
    type: regex
  - dsl:
    - '"Model: " + model + " Number: " + number'
    type: dsl
  matchers:
  - status:
    - 200
    type: status
  - part: header
    type: word
    words:
    - text/xml
  - condition: and
    type: word
    words:
    - <manufacturer>
    - Hewlett
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/upnp/BasicDevice.xml'
id: ilo-upnp-detect
info:
  author: gtrrnr
  description: Extract model and version of HP iLO through UPnP interface
  metadata:
    max-request: 1
  name: HP iLO UPnP detect version
  severity: info
  tags: tech,ilo
