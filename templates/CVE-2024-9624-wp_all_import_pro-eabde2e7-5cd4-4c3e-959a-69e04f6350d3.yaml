http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-all-import-pro
  - dsl:
    - compare_versions(version, '<= 4.9.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-all-import-pro/readme.txt'
  redirects: true
id: CVE-2024-9624-wp_all_import_pro-eabde2e7-5cd4-4c3e-959a-69e04f6350d3
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-9624
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:L/A:N
    cvss-score: 7.6
  description: 'The WP All Import Pro plugin for WordPress is vulnerable to Server-Side
    Request Forgery in all versions up to, and including, 4.9.3 due to missing SSRF
    protection on the pmxi_curl_download function. This makes it possible for authenticated
    attackers, with Administrator-level access and above, to make web requests to
    arbitrary locations originating from the web application and can be used to query
    and modify information from internal services. On cloud platforms, it might allow
    attackers to read the Instance metadata.

    '
  metadata:
    fofa-query: wp-content/plugins/wp-all-import-pro/
    google-query: inurl:"/wp-content/plugins/wp-all-import-pro/"
    shodan-query: http.html:"wp-content/plugins/wp-all-import-pro/"
  name: 'WP All Import Pro <= 4.9.3 - Authenticated (Administrator+) Server-Side Request
    Forgery via File Import

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/eabde2e7-5cd4-4c3e-959a-69e04f6350d3?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,wp-all-import-pro,low,production
