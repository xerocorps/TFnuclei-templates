id: http-missing-security-headers
info:
  author: socketz,geeknik,G4L1T0,convisoappsec,kurohost,dawid-czarnecki,forgedhallpass
  description: 'This template searches for missing HTTP security headers. The impact
    of these missing headers can vary.

    '
  name: HTTP Missing Security Headers
  severity: info
  tags: misconfig,generic
requests:
- matchers:
  - condition: and
    dsl:
    - '!regex(''(?i)strict-transport-security'', all_headers)'
    - status_code != 301 && status_code != 302
    name: strict-transport-security
    type: dsl
  - condition: and
    dsl:
    - '!regex(''(?i)content-security-policy'', all_headers)'
    - status_code != 301 && status_code != 302
    name: content-security-policy
    type: dsl
  - condition: and
    dsl:
    - '!regex(''(?i)permission-policy'', all_headers)'
    - status_code != 301 && status_code != 302
    name: permission-policy
    type: dsl
  - condition: and
    dsl:
    - '!regex(''(?i)x-frame-options'', all_headers)'
    - status_code != 301 && status_code != 302
    name: x-frame-options
    type: dsl
  - condition: and
    dsl:
    - '!regex(''(?i)x-content-type-options'', all_headers)'
    - status_code != 301 && status_code != 302
    name: x-content-type-options
    type: dsl
  - condition: and
    dsl:
    - '!regex(''(?i)x-permitted-cross-domain-policies'', all_headers)'
    - status_code != 301 && status_code != 302
    name: x-permitted-cross-domain-policies
    type: dsl
  - condition: and
    dsl:
    - '!regex(''(?i)referrer-policy'', all_headers)'
    - status_code != 301 && status_code != 302
    name: referrer-policy
    type: dsl
  - condition: and
    dsl:
    - '!regex(''(?i)clear-site-data'', all_headers)'
    - status_code != 301 && status_code != 302
    name: clear-site-data
    type: dsl
  - condition: and
    dsl:
    - '!regex(''(?i)cross-origin-embedder-policy'', all_headers)'
    - status_code != 301 && status_code != 302
    name: cross-origin-embedder-policy
    type: dsl
  - condition: and
    dsl:
    - '!regex(''(?i)cross-origin-opener-policy'', all_headers)'
    - status_code != 301 && status_code != 302
    name: cross-origin-opener-policy
    type: dsl
  - condition: and
    dsl:
    - '!regex(''(?i)cross-origin-resource-policy'', all_headers)'
    - status_code != 301 && status_code != 302
    name: cross-origin-resource-policy
    type: dsl
  - condition: and
    dsl:
    - '!regex(''(?i)access-control-allow-origin'', all_headers)'
    - status_code != 301 && status_code != 302
    name: access-control-allow-origin
    type: dsl
  - condition: and
    dsl:
    - '!regex(''(?i)access-control-allow-credentials'', all_headers)'
    - status_code != 301 && status_code != 302
    name: access-control-allow-credentials
    type: dsl
  - condition: and
    dsl:
    - '!regex(''(?i)access-control-expose-headers'', all_headers)'
    - status_code != 301 && status_code != 302
    name: access-control-expose-headers
    type: dsl
  - condition: and
    dsl:
    - '!regex(''(?i)access-control-max-age'', all_headers)'
    - status_code != 301 && status_code != 302
    name: access-control-max-age
    type: dsl
  - condition: and
    dsl:
    - '!regex(''(?i)access-control-allow-methods'', all_headers)'
    - status_code != 301 && status_code != 302
    name: access-control-allow-methods
    type: dsl
  - condition: and
    dsl:
    - '!regex(''(?i)access-control-allow-headers'', all_headers)'
    - status_code != 301 && status_code != 302
    name: access-control-allow-headers
    type: dsl
  matchers-condition: or
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}'
  redirects: true
