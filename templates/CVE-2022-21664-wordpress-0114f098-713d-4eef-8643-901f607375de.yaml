http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 5.8', '< 5.8.3')
    - compare_versions(version_by_js, '>= 5.8', '< 5.8.3')
    - compare_versions(version_by_css, '>= 5.8', '< 5.8.3')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2022-21664-wordpress-0114f098-713d-4eef-8643-901f607375de
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-21664
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L
    cvss-score: 7.4
  description: 'WordPress is a free and open-source content management system written
    in PHP and paired with a MariaDB database. Due to lack of proper sanitization
    in one of the classes, there''s potential for unintended SQL queries to be executed.
    This has been patched in WordPress version 5.8.3. Older affected versions are
    also fixed via security release, that go back till 4.1.34. We strongly recommend
    that you keep auto-updates enabled. There are no known workarounds for this issue.

    '
  metadata:
    shodan-query: vuln:CVE-2022-21664
  name: 'WordPress Core < 5.8.3 - SQL Injection via WP_Meta_Query

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/0114f098-713d-4eef-8643-901f607375de?source=api-prod
  severity: high
  tags: cve,wordpress,wp-core,high,production
