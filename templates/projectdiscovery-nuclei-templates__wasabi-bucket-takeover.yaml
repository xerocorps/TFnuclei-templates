http:
- extractors:
  - group: 1
    part: body
    regex:
    - '<li>BucketName: (.*?)</li>'
    - <BucketName>(.*?)</BucketName>
    type: regex
  matchers:
  - condition: and
    dsl:
    - Host != ip
    - contains(tolower(header), "wasabis3")
    type: dsl
  - condition: and
    type: word
    words:
    - The specified bucket does not exist
    - BucketName
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
id: wasabi-bucket-takeover
info:
  author: philippedelteil
  description: 'wasabi Bucket takeover was detected.

    '
  metadata:
    max-request: 1
    shodan-query: wasabis3
    verified: true
  name: wasabi Bucket Takeover - Detection
  reference:
  - https://github.com/EdOverflow/can-i-take-over-xyz/issues/417
  severity: high
  tags: takeover,wasabi,bucket,vuln
