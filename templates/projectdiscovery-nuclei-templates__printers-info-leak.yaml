id: printers-info-leak
info:
  author: pussycat0x,matejsmycka
  description: 'Unauthorized access to printers allows attackers to print, eavesdrop
    sensitive documents.

    '
  impact: 'Attackers can gain access to sensitive printed documents, manipulate print
    jobs, and potentially compromise printer security

    '
  metadata:
    max-request: 1
    product: printer
    shodan-query: port:9100
    vendor: generic
  name: Unauthorized Printer Access
  reference:
  - https://book.hacktricks.wiki/en/network-services-pentesting/9100-pjl.html
  - https://en.wikipedia.org/wiki/Printer_Job_Language
  remediation: 'Implement proper network segmentation, disable unnecessary printer
    services, and ensure printers are not directly accessible from untrusted networks.

    '
  severity: info
  tags: network,iot,printer,misconfig,tcp,pjl,vuln
tcp:
- extractors:
  - group: 1
    regex:
    - '"([^"]+)"'
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: '@PJL INFO ID

      '
  matchers:
  - binary:
    - 40504a4c20494e464f2049440d0a22
    type: binary
  port: 9100
