http:
- headers:
    Accept: text/html
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_any(body, "<title>Apollo Server", "<title>Apollo Router")
    - contains_any(body, "Apollo Sandbox", "apollo.dev")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/'
id: apollo-sandbox-ui-exposed
info:
  author: Hamza Sahin
  description: 'Detects the Apollo Sandbox developer interface exposed in production
    environments, which could facilitate schema discovery or testing by unauthorized
    users.

    '
  metadata:
    max-request: 1
    shodan-query: http.html:"Apollo Sandbox"
    verified: true
  name: Apollo Sandbox UI - Exposed
  reference:
  - https://www.apollographql.com/docs/studio/sandbox/
  severity: low
  tags: apollo,misconfig,exposure,graphql,vuln
