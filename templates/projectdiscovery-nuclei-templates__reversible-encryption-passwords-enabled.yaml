code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'True'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'Get-Module -ListAvailable -Name ActiveDirectory | % { Get-ADDefaultDomainPasswordPolicy
    | Select-Object -ExpandProperty ReversibleEncryptionEnabled }

    '
id: reversible-encryption-passwords-enabled
info:
  author: princechaddha
  description: Checks if the system is set to store passwords using reversible encryption,
    which is equivalent to plaintext storage.
  impact: 'Storing passwords using reversible encryption significantly weakens password
    security and is comparable to plaintext storage.

    '
  name: Store Passwords Using Reversible Encryption Enabled
  remediation: 'Disable the option to store passwords using reversible encryption
    to protect credentials.

    '
  severity: critical
  tags: windows,code,windows-audit
self-contained: true
