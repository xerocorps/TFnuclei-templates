http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-statistics
  - dsl:
    - compare_versions(version, '< 13.0.8')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-statistics/readme.txt'
  redirects: true
id: CVE-2021-24340-wp_statistics-6f561cce-1c0c-40f5-abba-ada8bc503aa8
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24340
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
  description: 'The WP Statistics WordPress plugin before 13.0.8 relied on using the
    WordPress esc_sql() function on a field not delimited by quotes and did not first
    prepare the query. Additionally, the page, which should have been accessible to
    administrator only, was also available to any visitor, including unauthenticated
    ones.

    '
  metadata:
    fofa-query: wp-content/plugins/wp-statistics/
    google-query: inurl:"/wp-content/plugins/wp-statistics/"
    shodan-query: http.html:"wp-content/plugins/wp-statistics/"
  name: 'WP Statistics <= 13.0.7 - Unauthenticated SQL Injection

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/6f561cce-1c0c-40f5-abba-ada8bc503aa8?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,wp-statistics,critical,production
