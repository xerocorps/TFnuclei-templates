http:
- attack: pitchfork
  extractors:
  - group: 1
    internal: true
    name: auth
    part: header_2
    regex:
    - currentAuth=([0-9a-zA-Z]+)
    type: regex
  matchers:
  - part: body_2
    type: word
    words:
    - <response>success</response>
  - part: header_2
    type: word
    words:
    - text/xml
  matchers-condition: and
  payloads:
    password:
    - crushadmin
    username:
    - crushadmin
  raw:
  - 'GET /WebInterface/ HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /WebInterface/function/ HTTP/1.1

    Host: {{Hostname}}

    Origin: {{RootURL}}

    Referer: {{RootURL}}/WebInterface/login.html


    command=login&username={{username}}&password={{password}}&encoded=true&language=en&random=0.34712915617878926

    '
  stop-at-first-match: true
id: crushftp-default-login
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:crushftp:crushftp:*:*:*:*:*:*:*:*
  description: 'CrushFTP default login credentials were discovered.

    '
  metadata:
    max-request: 2
    product: crushftp
    shodan-query: html:"CrushFTP"
    vendor: crushftp
    verified: true
  name: CrushFTP - Default Login
  severity: high
  tags: default-login,crushftp,vuln
