code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: cacheclusterids
    type: json
  source: 'aws elasticache describe-cache-clusters --region $region --output json
    --query ''CacheClusters[*].CacheClusterId''

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - replicationgroup + " ElastiCache Event Notifications is Disabled"
    type: dsl
  matchers:
  - type: word
    words:
    - '[]'
  source: 'aws elasticache describe-cache-clusters --region $region --cache-cluster-id
    $cacheclusterid --query ''CacheClusters[*].NotificationConfiguration.TopicArn''
    --output json

    '
flow: "code(1)\nfor(let CacheClusterId of iterate(template.cacheclusterids)){\n  set(\"\
  cacheclusterid\", CacheClusterId)\n  code(2)\n}\n"
id: cache-event-notification-disabled
info:
  author: DhiyaneshDK
  description: 'Ensure that your Amazon ElastiCache clusters are configured to send
    event notifications via Amazon Simple Notification Service (SNS) in order to monitor
    your cache clusters for important events and quickly mitigate any issues with
    your cache system.

    '
  impact: 'Disabling ElastiCache event notifications prevents timely alerts about
    cluster events, such as failovers, maintenance updates, or configuration changes,
    which can hinder proactive incident response and monitoring.

    '
  name: ElastiCache Event Notifications - Disabled
  reference:
  - https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/ElastiCache/enable-cluster-event-notifications.html
  - https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/ECEvents.SNS.html
  remediation: 'To remediate the disabled ElastiCache event notifications, enable
    event notifications in the AWS Management Console by configuring an Amazon SNS
    topic to receive alerts for important cluster events.

    '
  severity: medium
  tags: cloud,devops,aws,amazon,elasticache,aws-cloud-config
self-contained: true
variables:
  region: us-west-2
