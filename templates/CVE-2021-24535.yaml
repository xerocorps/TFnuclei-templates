http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - light-messages
  - dsl:
    - compare_versions(version, '<=  1.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/light-messages/readme.txt'
  redirects: true
id: CVE-2021-24535
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24535
    cvss-metrics: null
    cvss-score: null
  description: The Light Messages WordPress plugin through 1.0 is lacking CSRF check
    when updating it's settings, and is not sanitising its Message Content in them
    (even with the unfiltered_html disallowed). As a result, an attacker could make
    a logged in admin update the settings to arbitrary values, and set a Cross-Site
    Scripting payload in the Message Content. Depending on the options set, the XSS
    payload can be triggered either in the backend only (in the plugin's settings),
    or both frontend and backend.
  metadata:
    fofa-query: wp-content/plugins/light-messages/
    google-query: inurl:"/wp-content/plugins/light-messages/"
    shodan-query: vuln:CVE-2021-24535
  name: Light Messages <= 1.0 - Authenticated (Admin+) Cross-Site Scripting
  reference: null
  severity: medium
  tags: cve,wordpress,wp-plugin,light-messages,medium
