http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - advanced-custom-fields
  - dsl:
    - compare_versions(version, '<= 5.12.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/advanced-custom-fields/readme.txt'
  redirects: true
id: CVE-2022-2594-advanced_custom_fields-e5bab390-1590-44f2-8c65-bc329955ed84
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-2594
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 4.3
  description: 'The Advanced Custom Fields plugin for WordPress has a file upload
    vulnerability in versions up to, and including, 5.12.2. This allows users without
    the upload_files capability, such as contributors, or unauthenticated users in
    cases where a frontend form is added to the site, to upload allowed file types.
    The upload is handled by WordPress so file type and extension checks still occur,
    though this could potentially be used by high-privileged users in certain locked-down
    configurations to bypass other security mechanisms and upload dangerous file types.

    '
  metadata:
    fofa-query: wp-content/plugins/advanced-custom-fields/
    google-query: inurl:"/wp-content/plugins/advanced-custom-fields/"
    shodan-query: http.html:"wp-content/plugins/advanced-custom-fields/"
  name: 'Advanced Custom Fields <= 5.12.2 - File Upload

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/e5bab390-1590-44f2-8c65-bc329955ed84?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,advanced-custom-fields,medium,production
