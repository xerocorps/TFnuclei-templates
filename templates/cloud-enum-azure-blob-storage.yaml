id: cloud-enum-azure-blob-storage
info:
  author: initstring
  description: Searches for Azure Blob Storage accounts and containers within valid
    accounts
  name: Cloud Enumeration - Azure Blob Storage
  reference: tba
  severity: info
  tags: cloud,azure
requests:
- attack: batteringram
  matchers:
  - condition: and
    dsl:
    - status_code==400
    - contains(body, "Value for one of the query parameters specified in the request
      URI is invalid")
    name: Valid Azure Storage Account
    type: dsl
  - condition: and
    dsl:
    - status_code==403
    - contains(body, "The specified account is disabled")
    name: Disabled Azure Storage Account
    type: dsl
  - condition: and
    dsl:
    - status_code==403
    - contains(body, "Server failed to authenticate the request")
    name: Protected Azure Storage Account
    type: dsl
  raw:
  - 'GET https://{{keyword}}.{{baseDNS}} HTTP/1.1

    Host: {{keyword}}.{{baseDNS}}

    '
  redirects: false
  threads: 10
self-contained: true
variables:
  baseDNS: blob.core.windows.net
