http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - <span class="version">([0-9.]+)</span>
    type: regex
  matchers:
  - condition: or
    type: word
    words:
    - Adminer</title>
    - Adminer</a>
  - status:
    - 200
    type: status
  - dsl:
    - compare_versions(version, '<=4.6.2')
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/'
  - '{{BaseURL}}/adminer.php'
  - '{{BaseURL}}/_adminer.php'
  - '{{BaseURL}}/adminer/'
  - '{{BaseURL}}/editor.php'
  - '{{BaseURL}}/mysql.php'
  - '{{BaseURL}}/sql.php'
  - '{{BaseURL}}/wp-content/plugins/adminer/adminer.php'
  - '{{BaseURL}}/admin.php'
id: CVE-2021-43008
info:
  author: ProjectDiscoveryAI
  classification:
    cpe: cpe:2.3:a:adminer:adminer:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-43008
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    epss-percentile: 0.56092
    epss-score: 0.00184
  description: 'Improper Access Control in Adminer versions <= 4.6.2 (fixed in version
    4.6.3) allows an attacker to achieve Arbitrary File Read on the server by connecting
    a remote MySQL database to the Adminer.

    In order to fix this vulnerability you need to update your Adminer to the latest
    version or a version >= 4.6.3. This vulnerability was fixed by the editor in version
    4.6.3.

    '
  metadata:
    fofa-query:
    - title="login - adminer"
    - app="adminer" && body="4.7.8"
    google-query: intitle:"login - adminer"
    hunter-query: app.name="adminer"&&web.body="4.7.8"
    product: adminer
    shodan-query:
    - http.title:"login - adminer"
    - cpe:"cpe:2.3:a:adminer:adminer"
    vendor: adminer
  name: Adminer Arbitrary File Read
  reference:
  - https://github.com/vrana/adminer/releases/tag/v4.6.3
  - https://lists.debian.org/debian-lts-announce/2022/05/msg00012.html
  - https://www.adminer.org/
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/Threekiii/Vulhub-Reproduce
  severity: high
