code:
- engine:
  - sh
  - bash
  matchers:
  - regex:
    - \d+\s+-[rwx-]*w[rwx-]*w[rwx-]*\s+
    type: regex
  source: 'find /System/Library/LaunchDaemons/ /System/Library/LaunchAgents/ /Library/LaunchDaemons/
    /Library/LaunchAgents/ ~/Library/LaunchAgents/ -perm -o+w -type f -ls 2>/dev/null

    '
id: insecure-launchd-jobs
info:
  author: geeknik
  description: 'Searches for world-writable launchd job files on macOS that allow
    modification by any user.

    '
  impact: 'World-writable launchd job files can be modified by any user on the system,
    potentially leading to privilege escalation or execution of malicious code.

    '
  name: macOS World-Writable Launchd Jobs
  remediation: 'Review and correct the permissions of world-writable launchd job files.

    '
  severity: medium
  tags: macos,audit,local,security,launchd
self-contained: true
