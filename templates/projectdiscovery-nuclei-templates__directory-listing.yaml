flow: "function target_is_in_scope(url) {\n  if (url.startsWith(template.http_1_host)\
  \ || url.startsWith(\"/\")) {\n    return true;\n  }\n  return false;\n}\n\nhttp(1);\n\
  \nif(template.links) {\n  var path_checked = [];\n  var paths = [];\n\n  for(i=0;\
  \ i<template.links.length; i++) {\n    if (target_is_in_scope(template.links[i]))\
  \ {\n\n      var path = template.links[i].replace(template.http_1_host, \"\");\n\
  \      var path_split = path.split(\"/\");\n      var path_to_check = \"\";\n\n\
  \      for(p in path_split) {\n        if (path_split[p] != \"\") {\n          path_to_check\
  \ += \"/\"+path_split[p];\n\n          if (!path_checked.includes(path_to_check))\
  \ {\n            path_checked.push(path_to_check);\n\n            set(\"path_to_check\"\
  , path_to_check);\n            http(2);\n          }\n        }\n      }\n\n   \
  \ }\n  }\n}\n"
http:
- extractors:
  - internal: true
    name: links
    part: body
    type: xpath
    xpath:
    - //*/@href|//*/@src
  host-redirects: true
  matchers:
  - condition: and
    dsl:
    - contains(header, "text/html")
    - status_code_1 == 200
    internal: true
    type: dsl
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
- host-redirects: true
  matchers:
  - case-insensitive: true
    part: body
    type: word
    words:
    - <title>Index of
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}{{path_to_check}}'
id: directory-listing
info:
  author: theMiddle
  description: Directory Indexing is a web server feature that allows the contents
    of a directory to be displayed when no index file is present. This can be a security
    risk as it can expose sensitive files, old backup or unreferenced files.
  impact: 'Sensitive files and directories may be exposed to unauthorized users.

    '
  metadata:
    max-request: 2
  name: Directory Listing Enabled
  reference:
  - https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/04-Review_Old_Backup_and_Unreferenced_Files_for_Sensitive_Information
  - https://portswigger.net/kb/issues/00600100_directory-listing
  remediation: 'Disable directory listing in the web server configuration.

    '
  severity: low
  tags: misc,generic,misconfig,fuzz,miscellaneous,vuln
