expression: r0()
id: laravel-debug-info-leak
info:
  author: Dem0ns (https://github.com/dem0ns)
  description: "Laravel \u5F00\u542F Debug mode\uFF0C\u53EF\u80FD\u6CC4\u9732web\u8DEF\
    \u5F84\u3001\u6570\u636E\u5E93\u8D26\u53F7\u5BC6\u7801\u7B49\u654F\u611F\u4FE1\
    \u606F\n"
  name: Laravel Debug Info Leak
  severity: high
  verified: true
rules:
  r0:
    expression: response.status == 405 && response.body.bcontains(b"MethodNotAllowedHttpException")
      && response.body.bcontains(b"Environment &amp; details") && (response.body.bcontains(b"vendor\\laravel\\framework\\src\\Illuminate\\Routing\\RouteCollection.php")
      || response.body.bcontains(b"vendor/laravel/framework/src/Illuminate/Routing/RouteCollection.php"))
    request:
      method: POST
      path: /
