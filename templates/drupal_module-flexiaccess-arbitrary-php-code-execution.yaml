http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '9.x-99.99')
    type: dsl
  matchers:
  - condition: and
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - condition: and
    status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - flexiaccess
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/flexiaccess/flexiaccess.info'
  redirects: true
id: drupal_module-flexiaccess-arbitrary-php-code-execution
info:
  author: me
  description: The Flexi Access module will provide a simple and flexible interface
    to the ACL (Access Control List) module. It will let you set up and mange ACLs
    naming individual users that are allowed access to a particular node. The module
    processes user input in a way that could be unsafe. This can lead to Remote Code
    Execution via Object Injection. This vulnerability is mitigated by the fact that
    known exploit paths require an attacker to have a combination of permissions provided
    by the module; for example access flexiaccess and flexiaccess view. See _flexiaccess_node_access()
    for details. The administer flexiaccess permission alone does not grant access
    to the vulnerable functionality. This Security Advisory is being released in coordination
    with SA-CONTRIB-2023-034 for the ACL module, on which Flexi Access depends.
  metadata:
    created_at: '2025-01-09'
    fofa-query: /sites/all/modules/flexiaccess/
    google-query: inurl:'/sites/all/modules/flexiaccess/
    impact: medium
    security-risk: "Critical 17\u2009\u2215\u200925 AC:Basic/A:Admin/CI:All/II:All/E:Theoretical/TD:All"
    type: indicator
    vulnerability: arbitrary-php-code-execution
  name: drupal_module-flexiaccess-arbitrary-php-code-execution
  reference:
  - https://www.drupal.org/sa-contrib-2023-036
  severity: medium
  tags: drupal
