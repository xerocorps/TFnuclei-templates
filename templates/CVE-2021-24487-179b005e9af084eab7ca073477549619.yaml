http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - st-daily-tip
  - dsl:
    - compare_versions(version, '<= 4.7')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/st-daily-tip/readme.txt'
  redirects: true
id: CVE-2021-24487-179b005e9af084eab7ca073477549619
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24487
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
  description: 'The St-Daily-Tip WordPress plugin through 4.7 does not have any CSRF
    check in place when saving its ''Default Text to Display if no tips'' setting,
    and was also lacking sanitisation as well as escaping before outputting it the
    page. This could allow attacker to make logged in administrators set a malicious
    payload in it, leading to a Stored Cross-Site Scripting issue

    '
  metadata:
    fofa-query: wp-content/plugins/st-daily-tip/
    google-query: inurl:"/wp-content/plugins/st-daily-tip/"
    shodan-query: vuln:CVE-2021-24487
  name: 'St Daily Tip <= 4.7 - Cross-Site Request Forgery to Stored Cross-Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/432b71ea-dd81-4536-abda-33da8185abb6?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,st-daily-tip,medium
