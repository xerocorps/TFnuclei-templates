http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '< 3.3.2')
    - compare_versions(version_by_js, '< 3.3.2')
    - compare_versions(version_by_css, '< 3.3.2')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2012-2401
info:
  author: topscoder
  classification:
    cve-id: CVE-2012-2401
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 6.5
  description: Plupload before 1.5.4, as used in wp-includes/js/plupload/ in WordPress
    before 3.3.2 and other products, enables scripting regardless of the domain from
    which the SWF content was loaded, which allows remote attackers to bypass the
    Same Origin Policy via crafted content.
  metadata:
    shodan-query: vuln:CVE-2012-2401
  name: WordPress Core <= 3.3.1 - Same Origin Policy Bypass
  reference:
  - http://osvdb.org/81461
  - http://secunia.com/advisories/49138
  - http://www.plupload.com/punbb/viewtopic.php?id=1685
  - http://core.trac.wordpress.org/browser/branches/3.3/wp-includes/js/plupload?rev=20487
  - https://exchange.xforce.ibmcloud.com/vulnerabilities/75208
  - http://www.debian.org/security/2012/dsa-2470
  - https://nealpoole.com/blog/2012/05/xss-and-csrf-via-swf-applets-swfupload-plupload/
  - http://core.trac.wordpress.org/browser/branches/3.3/wp-includes/js/plupload/changelog.txt?rev=20487
  - http://www.securityfocus.com/bid/53192
  - http://wordpress.org/news/2012/04/wordpress-3-3-2/
  severity: medium
  tags: cve,wordpress,wp-core,medium
