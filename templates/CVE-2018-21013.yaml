http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Version: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Version: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - swape
  - dsl:
    - compare_versions(version, '< 1.2.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/themes/swape/style.css'
  redirects: true
id: CVE-2018-21013
info:
  author: topscoder
  classification:
    cve-id: CVE-2018-21013
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: The 'Swape - App Showcase & App Store WordPress Theme' theme for WordPress
    is vulnerable to authorization bypass due to a missing capability check on the
    'call_upper_load_settings' AJAX action in versions up to 1.2.1. This makes it
    possible for unauthenticated attackers to modify arbitrary site options which
    can be used to create new administrative user accounts and achieve privilege escalation.
  metadata:
    fofa-query: wp-content/themes/swape/
    google-query: inurl:"/wp-content/themes/swape/"
    shodan-query: vuln:CVE-2018-21013
  name: Swape - App Showcase & App Store WordPress Theme < 1.2.1 - Missing Authorization
    to Arbitrary Options Update
  reference:
  - https://wpvulndb.com/vulnerabilities/9024
  severity: critical
  tags: cve,wordpress,wp-theme,swape,critical
