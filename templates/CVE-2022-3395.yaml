http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-all-export-pro
  - dsl:
    - compare_versions(version, '<= 1.7.8')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-all-export-pro/readme.txt'
  redirects: true
id: CVE-2022-3395
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-3395
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: The WP ALL Export Pro plugin for WordPress is vulnerable to SQL Injection
    via the cc_sql  parameter in versions up to, and including, 1.7.8. This allows
    low-level attackers (depending on whether they have been given permission to perform
    SQL queries) to to append additional SQL queries into already existing queries
    that can be used to extract sensitive information from the database. While the
    plugin defaults to allow only administrators to perform such queries, they can
    also delegate this task to lower-privileged users.
  metadata:
    fofa-query: wp-content/plugins/wp-all-export-pro/
    google-query: inurl:"/wp-content/plugins/wp-all-export-pro/"
    shodan-query: vuln:CVE-2022-3395
  name: WP ALL Export Pro <= 1.7.8 - Authenticated SQL Injection
  reference:
  - https://patchstack.com/database/vulnerability/wp-all-export-pro/wordpress-wp-all-export-pro-premium-plugin-1-7-8-authenticated-sql-injection-sqli-vulnerability
  - https://wpscan.com/vulnerability/10742154-368a-40be-a67d-80ea848493a0
  severity: high
  tags: cve,wordpress,wp-plugin,wp-all-export-pro,high
