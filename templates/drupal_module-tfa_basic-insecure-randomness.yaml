http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '7.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - tfa_basic
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/tfa_basic/tfa_basic.info'
  redirects: true
id: drupal_module-tfa_basic-insecure-randomness
info:
  author: Bishopfox
  description: The TFA Basic module enables you to use Two Factor Authentication via
    a variety of plugins including TOTP and one-time codes delivered via email or
    sms. The module doesnt use a strong source of randomness, creating weak and predictable
    one-time login codes that are then delivered using SMS. This weakness does not
    affect the more common TOTP second factor. This vulnerability is mitigated by
    the fact that the site must be configured to use SMS to deliver one-time login
    codes which is an uncommon configuration.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/tfa_basic/
    google-query: inurl:'/sites/all/modules/tfa_basic/
    impact: medium
    security-risk: "Less critical 9\u221525 AC:Complex/A:User/CI:Some/II:None/E:Theoretical/TD:Default"
    type: indicator
    vulnerability: insecure-randomness
  name: drupal_module-tfa_basic-insecure-randomness
  reference:
  - https://www.drupal.org/sa-contrib-2018-044
  severity: medium
  tags: drupal
