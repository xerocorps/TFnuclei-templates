http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - prismatic
  - dsl:
    - compare_versions(version, '<= 2.7')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/prismatic/readme.txt'
  redirects: true
id: CVE-2021-24408
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24408
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
  description: The Prismatic WordPress plugin before 2.8 does not sanitise or validate
    some of its shortcode parameters, allowing users with a role as low as Contributor
    to set Cross-Site payload in them. A post made by a contributor would still have
    to be approved by an admin to have the XSS trigger able in the frontend, however,
    higher privilege users, such as editor could exploit this without the need of
    approval, and even when the blog disallows the unfiltered_html capability.
  metadata:
    fofa-query: wp-content/plugins/prismatic/
    google-query: inurl:"/wp-content/plugins/prismatic/"
    shodan-query: vuln:CVE-2021-24408
  name: Prismatic <= 2.7 - Stored Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/51855853-e7bd-425f-802c-824209f4f84d
  severity: medium
  tags: cve,wordpress,wp-plugin,prismatic,medium
