http:
- matchers:
  - condition: and
    dsl:
    - 'contains(tolower(header), ''access-control-allow-origin: {{cors_origin}}'')'
    - 'contains(tolower(header), ''access-control-allow-credentials: true'')'
    name: arbitrary-origin
    type: dsl
  payloads:
    cors_origin:
    - https://{{tolower(rand_base(5))}}.{{RDN}}
  raw:
  - 'GET  HTTP/1.1

    Host: {{Hostname}}

    Origin: {{cors_origin}}

    '
  stop-at-first-match: true
id: cors-misconfig
info:
  author: coffin
  name: CORS Misconfiguration
  severity: high
  tags: cors,generic,misconfig
