http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - advanced-product-labels-for-woocommerce
  - dsl:
    - compare_versions(version, '<= 1.2.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/advanced-product-labels-for-woocommerce/readme.txt'
  redirects: true
id: CVE-2022-45813
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-45813
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 5.4
  description: Several BeRocket Plugins for WordPress are vulnerable to authorization
    bypass due to missing capability checks on functions corresponding to AJAX actions
    that are available to subscribers. This includes the close_notice, subscribe,
    disable_rate_notice, feature_request_send, get_plugin_error_ajax, close_notice,
    and test_key functions This makes it possible for authenticated attackers, with
    subscriber-level permissions and above, to invoke those functions intended for
    administrator use. One of the functions is used to subscribe to the BeRocket newsletter
    and can be used by subscribers to subscribe arbitrary email addresses. These functions
    are still missing Cross-Site Request Forgery Protection.
  metadata:
    fofa-query: wp-content/plugins/advanced-product-labels-for-woocommerce/
    google-query: inurl:"/wp-content/plugins/advanced-product-labels-for-woocommerce/"
    shodan-query: vuln:CVE-2022-45813
  name: BeRocket Plugins <= (Various Versions) - Missing Authorization
  reference:
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2832957%40brands-for-woocommerce%2Ftrunk&old=2819772%40brands-for-woocommerce%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2833038%40wish-wait-list-for-woocommerce%2Ftrunk&old=2819763%40wish-wait-list-for-woocommerce%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2833036%40splash-popup-for-woocommerce%2Ftrunk&old=2819759%40splash-popup-for-woocommerce%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2833037%40terms-and-conditions-popup-for-woocommerce%2Ftrunk&old=2819761%40terms-and-conditions-popup-for-woocommerce%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2833022%40sales-report-for-woocommerce%2Ftrunk&old=2819754%40sales-report-for-woocommerce%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2833029%40sequential-order-numbers-for-woocommerce%2Ftrunk&old=2819756%40sequential-order-numbers-for-woocommerce%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2833020%40product-watermark-for-woocommerce%2Ftrunk&old=2819752%40product-watermark-for-woocommerce%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2833019%40product-tabs-manager-for-woocommerce%2Ftrunk&old=2819751%40product-tabs-manager-for-woocommerce%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2833018%40products-compare-for-woocommerce%2Ftrunk&old=2819748%40products-compare-for-woocommerce%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2833014%40product-of-the-day-for-woocommerce%2Ftrunk&old=2819745%40product-of-the-day-for-woocommerce%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2833010%40minmax-quantity-for-woocommerce%2Ftrunk&old=2819741%40minmax-quantity-for-woocommerce%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2833006%40load-more-products-for-woocommerce%2Ftrunk&old=2819739%40load-more-products-for-woocommerce%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2833002%40gridlist-view-for-woocommerce%2Ftrunk&old=2819737%40gridlist-view-for-woocommerce%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2832994%40force-sell-for-woocommerce%2Ftrunk&old=2819735%40force-sell-for-woocommerce%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2832993%40currency-exchange-for-woocommerce%2Ftrunk&old=2819732%40currency-exchange-for-woocommerce%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2832985%40cart-products-suggestions-for-woocommerce%2Ftrunk&old=2819728%40cart-products-suggestions-for-woocommerce%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2832982%40advanced-product-labels-for-woocommerce%2Ftrunk&old=2819720%40advanced-product-labels-for-woocommerce%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2832983%40cart-notices-for-woocommerce%2Ftrunk&old=2819721%40cart-notices-for-woocommerce%2Ftrunk&sfp_email=&sfph_mail=
  severity: medium
  tags: cve,wordpress,wp-plugin,advanced-product-labels-for-woocommerce,medium
