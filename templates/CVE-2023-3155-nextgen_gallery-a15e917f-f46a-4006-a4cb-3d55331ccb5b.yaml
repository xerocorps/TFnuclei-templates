http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - nextgen-gallery
  - dsl:
    - compare_versions(version, '<= 3.37')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/nextgen-gallery/readme.txt'
  redirects: true
id: CVE-2023-3155-nextgen_gallery-a15e917f-f46a-4006-a4cb-3d55331ccb5b
info:
  author: topscoder
  classification:
    cve-id: CVE-2023-3155
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 6.5
  description: 'The NextGEN Gallery plugin for WordPress is vulnerable to Arbitrary
    File Read and Deletion in versions up to, and including, 3.37. This is due to
    insufficient input validation within the gallery_edit function. This makes it
    possible for authenticated attackers, with administrator-level privileges and
    above, to read and delete arbitrary files.

    '
  metadata:
    fofa-query: wp-content/plugins/nextgen-gallery/
    google-query: inurl:"/wp-content/plugins/nextgen-gallery/"
    shodan-query: http.html:"wp-content/plugins/nextgen-gallery/"
  name: 'NextGEN Gallery <= 3.37 - Authenticated (Admininistrator+) Arbitrary File
    Read and Deletion in gallery_edit

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/a15e917f-f46a-4006-a4cb-3d55331ccb5b?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,nextgen-gallery,low,production
