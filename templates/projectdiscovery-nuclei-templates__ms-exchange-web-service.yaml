http:
- extractors:
  - kval:
    - x_owa_version
    type: kval
  matchers:
  - part: header
    regex:
    - (?i)(X-Owa-Version:)
    type: regex
  - status:
    - 401
    - 302
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/EWS/Exchange.asmx'
  - '{{BaseURL}}/owa/service.svc'
  stop-at-first-match: true
id: ms-exchange-web-service
info:
  author: bhutch,userdehghani
  classification:
    cpe: cpe:2.3:a:microsoft:exchange_server:*:*:*:*:*:*:*:*
  description: 'Microsoft Exchange Web Services was detected.

    '
  metadata:
    fofa-query:
    - icon_hash=1768726119
    - title="outlook"
    google-query: intitle:"outlook"
    max-request: 2
    product: exchange_server
    shodan-query:
    - http.favicon.hash:1768726119
    - http.title:"outlook"
    - cpe:"cpe:2.3:a:microsoft:exchange_server"
    vendor: microsoft
    verified: true
  name: Microsoft Exchange Web Service - Detect
  reference:
  - https://learn.microsoft.com/en-us/exchange/client-developer/exchange-web-services/start-using-web-services-in-exchange
  - https://pentestlab.blog/tag/ews/
  severity: info
  tags: ms,microsoft,exchange,tech,panel,discovery
