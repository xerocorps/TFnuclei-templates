http:
- matchers:
  - condition: and
    dsl:
    - 'contains_any(body, "Directory listing for", "Index of /", "[To Parent Directory]",
      "Directory: /")'
    - contains_all(response, "Jetty", "jetty-dir.css")
    - status_code == 200
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/'
  - '{{BaseURL}}/static/'
  - '{{BaseURL}}/resources/'
  - '{{BaseURL}}/assets/'
  - '{{BaseURL}}/files/'
  stop-at-first-match: true
id: jetty-directory-listing
info:
  author: ritikchaddha
  description: 'Eclipse Jetty server has directory listing enabled, which exposes
    the directory structure and file names to unauthenticated users. This can reveal
    sensitive files, backup files, configuration files, and aid attackers in reconnaissance.

    '
  impact: 'Attackers can enumerate files and directories, discover hidden resources,
    backup files, configuration files, and potentially sensitive data that should
    not be publicly accessible.

    '
  metadata:
    fofa-query: server="Jetty"
    max-request: 5
    shodan-query: 'Server: Jetty'
    verified: true
  name: Eclipse Jetty - Directory Listing Enabled
  reference:
  - https://www.eclipse.org/jetty/documentation/jetty-11/operations-guide/index.html
  - https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/04-Review_Old_Backup_and_Unreferenced_Files_for_Sensitive_Information
  - https://cwe.mitre.org/data/definitions/548.html
  remediation: 'Disable directory listing by setting dirAllowed to false in the DefaultServlet
    configuration or by setting allowDirectoryListing to false in WebAppContext. Add
    index files (index.html) to directories that should not list contents.

    '
  severity: low
  tags: jetty,misconfig,exposure,listing,eclipse
