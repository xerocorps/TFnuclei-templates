code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[].projectId
    name: projectIds
    type: json
  source: 'gcloud projects list --format="json(projectId)"

    '
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: buckets
    type: json
  source: 'gsutil ls -p $projectId | jq -R . | jq -s .

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"The bucket " + bucketName + " in project " + projectId + " does not have a
      valid static website configuration with both index page suffix and error page
      defined"'
    type: dsl
  matchers:
  - type: word
    words:
    - has no website configuration
  source: 'gsutil web get $bucketName

    '
flow: "code(1)\nfor(let projectId of iterate(template.projectIds)){\n  set(\"projectId\"\
  , projectId)\n  code(2)\n  for(let bucketName of iterate(template.buckets)){\n \
  \   set(\"bucketName\", bucketName)\n    code(3)\n  }\n}\n"
id: gcloud-bucket-website-config-not-defined
info:
  author: princechaddha
  description: 'Ensure that website index (main) page suffix and error (404 not found)
    page are defined for your Google Cloud Storage buckets with static website configuration.
    Specifying these configurations ensures proper functionality and user experience
    for websites hosted on Cloud Storage buckets.

    '
  impact: 'Without a defined index page suffix and error page, users may encounter
    broken functionality or unexpected behavior when accessing the hosted website.

    '
  name: Define Index Page Suffix and Error Page for Bucket Website Configuration
  reference:
  - https://cloud.google.com/storage/docs/hosting-static-website
  remediation: 'Define an index page suffix (e.g., index.html) and an error page (e.g.,
    404.html) in the static website configuration for your Cloud Storage buckets.

    '
  severity: high
  tags: cloud,devops,gcp,gcloud,google-cloud-storage,website-config,static-website,gcp-cloud-config
self-contained: true
