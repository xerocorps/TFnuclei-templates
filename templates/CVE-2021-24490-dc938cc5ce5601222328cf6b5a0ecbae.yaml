http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - email-artillery
  - dsl:
    - compare_versions(version, '<= 4.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/email-artillery/readme.txt'
  redirects: true
id: CVE-2021-24490-dc938cc5ce5601222328cf6b5a0ecbae
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24490
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
  description: 'The Email Artillery (MASS EMAIL) WordPress plugin through 4.1 does
    not properly check the uploaded files from the Import Emails feature, allowing
    arbitrary files to be uploaded. Furthermore, the plugin is also lacking any CSRF
    check, allowing such issue to be exploited via a CSRF attack as well. However,
    due to the presence of a .htaccess, denying access to everything in the folder
    the file is uploaded to, the malicious uploaded file will only be accessible on
    Web Servers such as Nginx/IIS

    '
  metadata:
    fofa-query: wp-content/plugins/email-artillery/
    google-query: inurl:"/wp-content/plugins/email-artillery/"
    shodan-query: vuln:CVE-2021-24490
  name: 'Email Artillery (MASS EMAIL) <= 4.1 - Arbitrary File Upload

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/1cbb309c-015b-4bdb-917a-a67e028484e6?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,email-artillery,high
