code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - Plaintext passwords are stored in memory.
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'if ((Get-ItemProperty -Path ''HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest''
    -Name ''UseLogonCredential'' -ErrorAction SilentlyContinue).UseLogonCredential
    -eq 1) { "Plaintext passwords are stored in memory." }

    '
id: plaintext-passwords-in-memory
info:
  author: princechaddha
  description: Checks if passwords are stored in memory in plaintext, potentially
    exposing sensitive information to unauthorized memory access.
  impact: 'Storing passwords in plaintext in memory can expose sensitive credentials
    to attackers who gain access to memory dumps or can read memory directly, leading
    to unauthorized access and data breaches.

    '
  name: Plaintext Passwords Stored in Memory
  remediation: 'Ensure that all sensitive data, especially passwords, are stored in
    memory in an encrypted or hashed format to mitigate the risk of exposure.

    '
  severity: high
  tags: windows,security,credentials,windows-audit
self-contained: true
