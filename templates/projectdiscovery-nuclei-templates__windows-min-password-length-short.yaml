code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell.exe
  matchers:
  - part: body
    type: word
    words:
    - Minimum password length is too short
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: "$policy = Get-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Services\\\
    Netlogon\\Parameters' -Name 'MinimumPasswordLength' -ErrorAction SilentlyContinue;\n\
    if ($policy -and $policy.MinimumPasswordLength -lt 8) {\n  Write-Output 'Minimum\
    \ password length is too short';\n}\n"
id: windows-min-password-length-short
info:
  author: princechaddha
  description: Checks if the minimum password length for local accounts is set to
    less than 8 characters.
  impact: 'Short passwords are easier to crack, compromising system security.

    '
  name: Minimum Password Length Too Short
  remediation: 'Set the minimum password length to at least 8 characters for local
    accounts.

    '
  severity: high
  tags: windows,code,windows-audit
self-contained: true
