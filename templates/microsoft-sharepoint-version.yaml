http:
- extractors:
  - group: 1
    name: siteClientTag
    regex:
    - '"?siteClientTag"?\s*:\s*"\d*[$]+([^"]+)"'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - content="Microsoft SharePoint"
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/_layouts/15/error.aspx'
id: microsoft-sharepoint-version
info:
  author: darses
  description: 'Detects Microsoft SharePoint Server version based on error.aspx page,
    as discoverd by Stephen Fewer.

    '
  metadata:
    fofa-query:
    - icon_hash="-19436759"
    - icon_hash="-146638980"
    - icon_hash="-1969918997"
    - body="/_layouts/15/init.js"
    - X-Sharepointhealthscore
    - Sprequestguid
    - X-Ms-Invokeapp
    product: sharepoint_server
    shodan-query:
    - http.favicon.hash:-19436759
    - http.favicon.hash:-146638980
    - http.favicon.hash:-1969918997
    - http.html:"/_layouts/15/init.js"
    - X-Sharepointhealthscore
    - Sprequestguid
    - X-Ms-Invokeapp
    - http.component:"Microsoft SharePoint"
    vendor: microsoft
  name: Microsoft SharePoint Server - Version
  severity: info
  tags: detect,microsoft,sharepoint
