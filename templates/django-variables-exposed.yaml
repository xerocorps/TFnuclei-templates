id: django-variables-exposed
info:
  author: nobody
  description: Detects suspicious Django web application framework exceptions that
    could indicate exploitation attempts
  metadata:
    verified: true
  name: Exposed Django variables
  reference:
  - https://docs.djangoproject.com/en/1.11/ref/exceptions/
  - https://docs.djangoproject.com/en/1.11/topics/logging/#django-security
  - https://github.com/projectdiscovery/nuclei-templates/blob/master/file/logs/django-framework-exceptions.yaml
  severity: info
  tags: exposure,config,django
requests:
- matchers:
  - condition: or
    type: word
    words:
    - seeing this error because you have <code>DEBUG = True</code>
    - SuspiciousOperation
    - DisallowedHost
    - DisallowedModelAdminLookup
    - DisallowedModelAdminToField
    - DisallowedRedirect
    - InvalidSessionKey
    - RequestDataTooBig
    - SuspiciousFileOperation
    - SuspiciousMultipartForm
    - SuspiciousSession
    - TooManyFieldsSent
    - PermissionDenied
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 400
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
