http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - CLIENT_VERSION\",\s+{type:ZmSetting\.T_CONFIG, defaultValue:"([0-9.]+)_([A-Z_0-9]+)"\}
    type: regex
  matchers:
  - part: body
    type: word
    words:
    - Zimbra Collaboration Suite
  - part: header
    type: word
    words:
    - application/x-javascript
  - condition: or
    dsl:
    - compare_versions(version, '9.0.0')
    - compare_versions(version, '>= 10.0.0', '< 10.0.13')
    - compare_versions(version, '>= 10.1.0', '< 10.1.5')
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/js/zimbraMail/share/model/ZmSettings.js'
id: CVE-2025-27915
info:
  author: Snbig,EhsanCreator,eliotworkspac-max
  classification:
    cve-id: CVE-2025-27915
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cwe-id: CWE-79
    epss-percentile: 0.96427
    epss-score: 0.29359
  description: 'Detects Zimbra Collaboration Suite versions vulnerable to CVE-2025-27915,
    a stored XSS vulnerability in the Classic Web Client due to insufficient sanitization
    of HTML content in ICS files. When a user views an email with a malicious ICS
    entry, embedded JavaScript executes via an ontoggle event inside a details tag,
    allowing attackers to perform unauthorized actions like email redirection and
    data exfiltration.

    '
  impact: 'Authenticated users viewing malicious ICS files can have JavaScript executed
    in their browser context through stored XSS, potentially leading to session hijacking
    and data exfiltration.

    '
  metadata:
    fofa-query: title="Zimbra Collaboration Suite"
    max-request: 1
    product: collaboration
    shodan-query: http.title:"Zimbra Collaboration Suite"
    vendor: zimbra
    verified: true
  name: Zimbra - Cross-Site Scripting via ICS Files
  reference:
  - https://wiki.zimbra.com/wiki/Security_Center
  - https://www.cisa.gov/known-exploited-vulnerabilities-catalog
  - https://nvd.nist.gov/vuln/detail/CVE-2025-27915
  remediation: 'Upgrade to Zimbra Collaboration Suite version 9.0.1, 10.0.13, or 10.1.5
    or later that properly sanitizes HTML content in ICS files.

    '
  severity: medium
  tags: cve,cve2025,zimbra,xss,ics,kev,vkev
