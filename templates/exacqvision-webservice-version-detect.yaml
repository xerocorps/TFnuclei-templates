http:
- extractors:
  - json:
    - .version.webServer
    name: exacq_webserver_version
    type: json
  - json:
    - .version.service
    name: exacq_service_version
    type: json
  - json:
    - .version.evapi
    name: exacq_evapi_version
    type: json
  headers:
    Accept: application/json
  matchers:
  - status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - '"version"'
    - '"webServer"'
    - '"service"'
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/health.web'
id: exacqvision-webservice-version-detect
info:
  author: Mark Dube
  description: 'Queries /health.web to extract exacqVision Web Service version fields.
    This endpoint historically exposed version and OS details without auth (CVE-2021-27656).
    Johnson Controls advised upgrading the Web Service to v21.03+ (v21.03.3+ is the
    patched train).

    '
  metadata:
    cve: CVE-2021-27656
    product: exacqVision Web Service
    vendor: Johnson Controls
  name: exacqVision Web Service - Version Detection via /health.web (CVE-2021-27656)
  reference:
  - https://www.cisa.gov/news-events/ics-advisories/icsa-21-077-01
  - https://support.avigilon.com/s/article/ACM--CVE202127656-Johnson-Controls-exacqVision-Web-Service
  - https://nvd.nist.gov/vuln/detail/CVE-2021-27656
  severity: info
  tags: tech,exacqvision,ics,exposure,cve,fingerprint
