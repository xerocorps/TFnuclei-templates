http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - widget-logic
  - dsl:
    - compare_versions(version, '< 5.10.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/widget-logic/readme.txt'
  redirects: true
id: CVE-2019-12826-widget_logic-a4999de1-07b7-49ef-8897-267b836bc469
info:
  author: topscoder
  classification:
    cve-id: CVE-2019-12826
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: 'A Cross-Site-Request-Forgery (CSRF) vulnerability in widget_logic.php
    in the 2by2host Widget Logic plugin before 5.10.2 for WordPress allows remote
    attackers to execute PHP code via snippets (that are attached to widgets and then
    eval''d to dynamically determine their visibility) by crafting a malicious POST
    request that tricks administrators into adding the code.

    '
  metadata:
    fofa-query: wp-content/plugins/widget-logic/
    google-query: inurl:"/wp-content/plugins/widget-logic/"
    shodan-query: http.html:"wp-content/plugins/widget-logic/"
  name: 'Widget Logic < 5.10.2 - Cross-Site Request Forgery

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/a4999de1-07b7-49ef-8897-267b836bc469?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,widget-logic,high,production
