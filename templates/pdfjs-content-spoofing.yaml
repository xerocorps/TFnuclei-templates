headless:
- matchers:
  - part: body
    type: word
    words:
    - mozila-content-spoof.pdf
  - part: body
    type: word
    words:
    - pdf.js
  - condition: or
    negative: true
    part: body
    type: word
    words:
    - file origin does not match
    - blocked
    - Not Found
  matchers-condition: and
  payloads:
    path:
    - pdf.js/web/viewer.html
    - pdfjs/web/viewer.html
    - web/viewer.html
    - pdfjs-dist/web/viewer.html
    - uiFramework/js/pdfjs/web/viewer.html
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}/{{path}}?file=https://raw.githubusercontent.com/projectdiscovery/nuclei-templates/main/helpers/payloads/mozila-content-spoof.pdf'
  - action: waitload
  stop-at-first-match: true
id: pdfjs-content-spoofing
info:
  author: 0x_Akoko
  classification:
    cwe-id: CWE-451
  description: 'Detected PDF.js viewer loads and renders external PDF files without
    proper origin validation. Versions < v1.3.91 are vulnerable to content spoofing
    attacks.

    '
  metadata:
    max-request: 5
    verified: true
  name: Mozilla PDF.js - Content Spoofing
  reference:
  - https://groups.google.com/g/mozilla.dev.pdf-js/c/_WdU9T0TRfo
  - https://github.com/mozilla/pdf.js/issues/6920
  severity: medium
  tags: pdfjs,spoofing,headless
