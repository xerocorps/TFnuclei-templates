flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    name: token
    part: body
    regex:
    - \b[a-fA-F\d]{40}\b
    type: regex
  method: GET
  path:
  - '{{BaseURL}}'
- disable-path-automerge: true
  extractors:
  - dsl:
    - token
    type: dsl
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, 'valid') && contains(body, 'true')
    - contains(content_type, "application/json")
    type: dsl
  raw:
  - '@Host: https://sonarcloud.io:443

    GET /api/authentication/validate HTTP/1.1

    Host: sonarcloud.io

    Authorization: Basic {{base64(token + '':'')}}

    '
id: sonarqube-cloud-token
info:
  author: DhiyaneshDk
  metadata:
    max-request: 1
    verified: true
  name: SonarQube Cloud Token Disclosure
  reference:
  - https://sonarcloud.io/web_api/api/authentication
  - https://docs.sonarsource.com/sonarqube/latest/user-guide/user-account/generating-and-using-tokens/#types-of-tokens
  severity: high
  tags: exposure,token,sonarqube,vuln
