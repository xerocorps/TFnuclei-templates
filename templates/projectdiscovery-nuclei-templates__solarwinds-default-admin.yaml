http:
- attack: pitchfork
  matchers:
  - part: header
    type: word
    words:
    - 'Content-Type: application/json'
  - condition: and
    part: body
    regex:
    - (totalRow|result|swi)s(:\/\/)?
    - (Orion\.|Poller(ID)?)s?
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  payloads:
    username:
    - admin
  raw:
  - 'GET /SolarWinds/InformationService/v3/Json/Query?query=SELECT+Uri+FROM+Orion.Pollers+ORDER+BY+PollerID+WITH+ROWS+1+TO+3+WITH+TOTALROWS
    HTTP/1.1

    Host: {{Hostname}}

    Authorization: Basic {{base64(username)}}

    '
  - 'GET /InformationService/v3/Json/Query?query=SELECT+Uri+FROM+Orion.Pollers+ORDER+BY+PollerID+WITH+ROWS+1+TO+3+WITH+TOTALROWS
    HTTP/1.1

    Host: {{Hostname}}

    Authorization: Basic {{base64(username)}}

    '
id: solarwinds-default-admin
info:
  author: dwisiswant0
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L
    cvss-score: 8.3
    cwe-id: CWE-522
  description: SolarWinds Orion default admin credentials were discovered.
  metadata:
    max-request: 2
  name: SolarWinds Orion Default Login
  reference:
  - https://github.com/solarwinds/OrionSDK/wiki/REST
  severity: high
  tags: solarwinds,default-login,vuln
