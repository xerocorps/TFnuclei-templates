id: redis-pass-brute
info:
  author: tarunKoyalwar
  description: 'This template bruteforces passwords for protected redis instances.

    If redis is not protected with password. it is also matched

    '
  metadata:
    shodan-query: product:"redis"
  name: redis password bruteforce
  severity: high
javascript:
- args:
    Host: '{{Host}}'
    Password: '{{passwords}}'
    Port: '6379'
  code: 'var m = require("nuclei/redis");

    m.GetServerInfoAuth(Host,Port,Password);

    '
  matchers:
  - type: word
    words:
    - redis_version
  - negative: true
    type: word
    words:
    - redis_mode:sentinel
  matchers-condition: and
  payloads:
    passwords:
    - ''
    - root
    - password
    - admin
    - iamadmin
  pre-condition: 'isPortOpen(Host,Port)

    '
  stop-at-first-match: true
