http:
- extractors:
  - part: body
    regex:
    - Magento.*$
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - 'Magento\/([0-9.]+) '
    type: regex
  matchers:
  - regex:
    - ^Magento/.*$
    type: regex
  - name: magento-1.9
    type: word
    words:
    - Copyright (c) 2014 Magento Inc.
  - name: magento-1.8
    type: word
    words:
    - Copyright (c) 2013 Magento Inc.
  - name: magento-1.7
    type: word
    words:
    - Copyright (c) 2012 Magento Inc.
  - name: magento-1.6
    type: word
    words:
    - Copyright (c) 2011 Magento Inc.
  - name: magento-1.4.1-1.5
    type: word
    words:
    - Copyright (c) 2010 Magento Inc.
  - name: magento-1.4.0
    type: word
    words:
    - Copyright (c) 2009 Irubin Consulting Inc.
  - name: magento-1.0-1.3
    type: word
    words:
    - Copyright (c) 2008 Irubin Consulting Inc.
  matchers-condition: or
  raw:
  - 'GET /magento_version HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /skin/frontend/default/default/css/styles.css HTTP/1.1

    Host: {{Hostname}}

    '
id: magento-version-detect
info:
  author: sullo,dogancanbakir
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    cwe-id: CWE-200
  description: 'Magento version detection via version module and copyright text.

    '
  metadata:
    max-request: 2
    shodan-query: http.component:"Magento"
    verified: 'true'
  name: Magento Version Detect
  reference:
  - https://www.magento.com/
  - https://magento.stackexchange.com/a/62966
  severity: info
  tags: tech,magento,cms
