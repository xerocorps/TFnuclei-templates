http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - mobile-login-woocommerce
  - dsl:
    - compare_versions(version, '<= 2.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/mobile-login-woocommerce/readme.txt'
  redirects: true
id: CVE-2023-2706
info:
  author: topscoder
  classification:
    cve-id: CVE-2023-2706
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
  description: The OTP Login Woocommerce & Gravity Forms plugin for WordPress is vulnerable
    to authentication bypass. This is due to the fact that when generating OTP codes
    for users to use in order to login via phone number, the plugin returns these
    codes in an AJAX response. This makes it possible for unauthenticated attackers
    to obtain login codes for administrators. This does require an attacker have access
    to the phone number configured for an account, which can be obtained via social
    engineering or reconnaissance.
  metadata:
    fofa-query: wp-content/plugins/mobile-login-woocommerce/
    google-query: inurl:"/wp-content/plugins/mobile-login-woocommerce/"
    shodan-query: vuln:CVE-2023-2706
  name: OTP Login Woocommerce & Gravity Forms <= 2.2 - Authentication Bypass to Privilege
    Escalation
  reference:
  - https://plugins.trac.wordpress.org/browser/mobile-login-woocommerce/tags/2.2/includes/class-xoo-ml-verification.php#L362
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2912731%40mobile-login-woocommerce&new=2912731%40mobile-login-woocommerce&sfp_email=&sfph_mail=
  severity: high
  tags: cve,wordpress,wp-plugin,mobile-login-woocommerce,high
