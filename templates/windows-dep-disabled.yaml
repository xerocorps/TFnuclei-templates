code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell.exe
  matchers:
  - type: word
    words:
    - DEP not fully enabled
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: "$EnableDEP = (Get-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\\
    Control\\Session Manager\\Memory Management' -Name 'EnableDEP' -ErrorAction SilentlyContinue).EnableDEP\n\
    if ($EnableDEP -ne 2) {\n  Write-Output 'DEP not fully enabled'\n}\n"
id: windows-dep-disabled
info:
  author: princechaddha
  description: Checks if Data Execution Prevention (DEP) is not fully enabled for
    all programs.
  impact: 'Disabling DEP allows certain types of memory-based attacks, such as buffer
    overflows.

    '
  name: Data Execution Prevention (DEP) Not Enabled
  remediation: 'Enable DEP for all programs to enhance memory protection.

    '
  severity: high
  tags: windows,security,dep,code,windows-audit
self-contained: true
