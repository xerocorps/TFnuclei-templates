http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - newsletter-api
  - dsl:
    - compare_versions(version, '<= 2.4.5')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/newsletter-api/readme.txt'
  redirects: true
id: CVE-2024-5674-67bf283d4591a49135af60d64b087982
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-5674
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 6.5
  description: 'The Newsletter - API v1 and v2 addon plugin for WordPress is vulnerable
    to unauthorized subscribers management due to PHP type juggling issue on the check_api_key
    function in all versions up to, and including, 2.4.5. This makes it possible for
    unauthenticated attackers to list, create or delete newsletter subscribers. This
    issue affects only sites running the PHP version below 8.0

    '
  metadata:
    fofa-query: wp-content/plugins/newsletter-api/
    google-query: inurl:"/wp-content/plugins/newsletter-api/"
    shodan-query: vuln:CVE-2024-5674
  name: 'Newsletter - API v1 and v2 addon for Newsletter <= 2.4.5 - Missing Authorization
    to Email Subscribers Management

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/ecd9800e-ce0f-45f3-bb66-3690c51d885b?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,newsletter-api,high
