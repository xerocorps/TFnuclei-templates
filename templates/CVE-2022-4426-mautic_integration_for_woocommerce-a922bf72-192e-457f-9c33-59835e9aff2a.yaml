http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - mautic-integration-for-woocommerce
  - dsl:
    - compare_versions(version, '< 1.0.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/mautic-integration-for-woocommerce/readme.txt'
  redirects: true
id: CVE-2022-4426-mautic_integration_for_woocommerce-a922bf72-192e-457f-9c33-59835e9aff2a
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-4426
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    cvss-score: 4.3
  description: 'The Mautic Integration for WooCommerce plugin for WordPress is vulnerable
    to Cross-Site Request Forgery in versions up to, but not including, 1.0.3. This
    is due to missing or incorrect nonce validation when updating plugin settings.  Further,
    the options being updated are not checked properly to restrict them to the plugin''s
    own settings.  This makes it possible for unauthenticated attackers to change
    arbitrary WordPress options granted they can trick a site administrator into performing
    an action such as clicking on a link.

    '
  metadata:
    fofa-query: wp-content/plugins/mautic-integration-for-woocommerce/
    google-query: inurl:"/wp-content/plugins/mautic-integration-for-woocommerce/"
    shodan-query: http.html:"wp-content/plugins/mautic-integration-for-woocommerce/"
  name: 'Mautic Integration for WooCommerce < 1.0.3 - Cross-Site Request Forgery leading
    to Arbitrary Options Update

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/a922bf72-192e-457f-9c33-59835e9aff2a?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,mautic-integration-for-woocommerce,medium,production
