expression: r0() || r1()
id: javamelody-detect
info:
  author: zan8in
  description: 'JavaMelody is a tool used to monitor Java or Java EE applications
    in QA and production environments. JavaMelody was detected on this web application.
    One option in the dashboard is to "View http sessions".

    This can be used by an attacker to steal a user''s session.

    fofa: app="JavaMelody"

    '
  name: JavaMelody Monitoring Exposed
  reference:
  - https://www.acunetix.com/vulnerabilities/web/javamelody-publicly-accessible/
  - https://github.com/javamelody/javamelody/wiki/UserGuide#16-security
  - https://mp.weixin.qq.com/s/ye9qWPm0wcn90zoKQpExGg
  - https://paper.seebug.org/705/
  severity: high
  verified: true
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'Monitoring JavaMelody
      on')
    request:
      method: GET
      path: /monitoring
  r1:
    expression: response.status == 200 && response.body.bcontains(b'Monitoring JavaMelody
      on')
    request:
      method: GET
      path: /..%3B/monitoring
