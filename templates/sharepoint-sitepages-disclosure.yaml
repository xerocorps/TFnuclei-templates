http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, "Site Contents","Libraries","accessible mode")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/SitePages/Forms/AllPages.aspx'
id: sharepoint-sitepages-disclosure
info:
  author: pussycat0x
  description: 'Microsoft SharePoint Site Pages library (/SitePages/) is accessible
    without proper authentication, exposing site content, page structure, and potentially
    sensitive information. The Site Pages library contains modern SharePoint pages
    (.aspx files)

    '
  metadata:
    fofa-query: app="Microsoft-SharePoint"
    product: sharepoint
    shodan-query: cpe:"cpe:2.3:a:microsoft:sharepoint_server"
    vendor: microsoft
    verified: true
  name: Microsoft SharePoint - Site Pages Disclosure
  reference:
  - https://learn.microsoft.com/en-us/sharepoint/dev/general-development/work-with-site-pages
  - https://support.microsoft.com/en-us/office/site-pages-library
  - https://learn.microsoft.com/en-us/sharepoint/dev/features/site-pages-overview
  severity: low
  tags: sharepoint,microsoft,disclosure,sitepages,exposure
