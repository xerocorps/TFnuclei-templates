http:
- matchers:
  - part: body
    regex:
    - '(?i)SYSTEM STATS: Time:'
    - '(?i)POLLER: Poller\['
    - (?i)Cacti\[[0-9]+\]
    - '(?i)CMDPHP:'
    type: regex
  - condition: and
    part: body
    type: word
    words:
    - SYSTEM STATS
    - 'Method:'
    - 'Processes:'
    - 'Threads:'
    - 'Hosts:'
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/cacti/log/cacti.log'
  - '{{BaseURL}}/log/cacti.log'
  - '{{BaseURL}}/cacti.log'
  - '{{BaseURL}}/include/cacti.log'
  stop-at-first-match: true
id: cacti-log-exposure
info:
  author: theamanrawat
  description: 'Exposed Cacti log files (cacti.log) were detected. These files contain
    system statistics, error messages, and potentially sensitive information. They
    can also be used in log poisoning attacks.

    '
  metadata:
    fofa-query:
    - icon_hash="-1797138069"
    - title="cacti"
    - title="login to cacti"
    google-query:
    - intitle:"cacti"
    - intitle:"login to cacti"
    max-request: 4
    product: cacti
    shodan-query:
    - http.title:"login to cacti"
    - http.title:"cacti"
    - http.favicon.hash:"-1797138069"
    vendor: cacti
  name: Cacti Log - Exposure
  reference:
  - https://docs.cacti.net/Cacti-Log.md
  severity: medium
  tags: cacti,log,exposure,file
