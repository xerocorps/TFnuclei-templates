http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - prismatic
  - dsl:
    - compare_versions(version, '<= 2.7')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/prismatic/readme.txt'
  redirects: true
id: CVE-2021-24408-prismatic-d93c70d6-c439-4bcd-a855-b71896bf9d22
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24408
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
  description: 'The Prismatic WordPress plugin before 2.8 does not sanitise or validate
    some of its shortcode parameters, allowing users with a role as low as Contributor
    to set Cross-Site payload in them. A post made by a contributor would still have
    to be approved by an admin to have the XSS trigger able in the frontend, however,
    higher privilege users, such as editor could exploit this without the need of
    approval, and even when the blog disallows the unfiltered_html capability.

    '
  metadata:
    fofa-query: wp-content/plugins/prismatic/
    google-query: inurl:"/wp-content/plugins/prismatic/"
    shodan-query: http.html:"wp-content/plugins/prismatic/"
  name: 'Prismatic <= 2.7 - Stored Cross-Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/d93c70d6-c439-4bcd-a855-b71896bf9d22?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,prismatic,medium,production
