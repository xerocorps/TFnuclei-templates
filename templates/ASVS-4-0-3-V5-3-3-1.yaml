headless:
- fuzzing:
  - fuzz:
    - '{{reflection}}'
    mode: single
    part: query
    type: postfix
  - fuzz:
    - '{{reflection}}'
    mode: single
    part: path
    type: postfix
  matchers:
  - part: body
    type: word
    words:
    - <h1>{{num}}</h1>
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  payloads:
    reflection:
    - '''"><h1>{{num}}</h1>'
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}'
  - action: waitload
  stop-at-first-match: true
id: ASVS-4-0-3-V5-3-3-1
info:
  author: AmirHossein Raeisi
  classification:
    cwe-id: CWE-79
  description: 'Verify that context-aware, preferably automated - or at worst, manual
    - output escaping protects against reflected, stored, and DOM based XSS. ([C4](https://owasp.org/www-project-proactive-controls/#div-numbering))

    '
  name: ASVS 5.3.3.1 (Dom-based XSS) Check
  reference:
  - https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/11-Client-side_Testing/01-Testing_for_DOM-based_Cross_Site_Scripting
  - https://snbig.github.io/Vulnerable-Pages/ASVS_5_3_3/
  - https://github.com/projectdiscovery/nuclei-templates/blob/main/dast/vulnerabilities/xss/dom-xss.yaml
  severity: medium
  tags: asvs,5.3.3
variables:
  num: '{{rand_int(10000, 99999)}}'
