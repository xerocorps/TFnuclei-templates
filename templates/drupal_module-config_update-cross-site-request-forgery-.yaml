http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '8.x-1.4')
    - compare_versions(version, '8.x-1.3')
    - compare_versions(version, '8.x-1.2')
    - compare_versions(version, '8.x-1.1')
    - compare_versions(version, '8.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - config_update
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/config_update/config_update.info'
  redirects: true
id: drupal_module-config_update-cross-site-request-forgery-
info:
  author: Bishopfox
  description: The Configuration Update Reports sub-module in the Configuration Update
    module project enables you to run reports to see what configuration on your site
    differs from the configuration distributed by a module, theme, or installation
    profile, and to revert, delete, or import configuration. This module doesnt sufficiently
    protect the Import operation, thereby exposing a Cross Site Request Forgery (CSRF)
    vulnerability which can be exploited by unprivileged users to trick an administrator
    into unwanted import of configuration. This vulnerability is mitigated by the
    fact that only configuration items distributed with a module, theme, or installation
    profile that is currently installed and enabled on the site can be imported, not
    arbitrary configuration values.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/config_update/
    google-query: inurl:'/sites/all/modules/config_update/
    impact: medium
    security-risk: "Moderately critical 12\u221525 AC:Basic/A:None/CI:None/II:Some/E:Theoretical/TD:Default"
    type: indicator
    vulnerability: cross-site-request-forgery-
  name: drupal_module-config_update-cross-site-request-forgery-
  reference:
  - https://www.drupal.org/sa-contrib-2017-091
  severity: medium
  tags: drupal
