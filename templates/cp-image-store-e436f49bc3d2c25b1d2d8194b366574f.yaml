http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - cp-image-store
  - dsl:
    - compare_versions(version, '< 1.0.7')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/cp-image-store/readme.txt'
  redirects: true
id: cp-image-store-e436f49bc3d2c25b1d2d8194b366574f
info:
  author: topscoder
  classification:
    cve-id: null
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
  description: The CP Image Store with Slideshow plugin for WordPress is vulnerable
    to an Arbitrary File Download in versions up to, and including, 1.0.6. This is
    due to insufficient path validation on the 'f' parameter. This makes it possible
    for unauthenticated attackers to obtain Purchase IDs, and potentially use the
    IDs to exploit an arbitrary file download vulnerability found in the plugin before
    1.0.6.
  metadata:
    fofa-query: wp-content/plugins/cp-image-store/
    google-query: inurl:"/wp-content/plugins/cp-image-store/"
    shodan-query: 'vuln:'
  name: CP Image Store with Slideshow < 1.0.7 - Arbitrary File Download
  reference:
  - https://wordpress.org/plugins/cp-image-store/changelog/
  - https://plugins.trac.wordpress.org/changeset/1196710
  - https://plugins.trac.wordpress.org/changeset/1196184
  - https://www.exploit-db.com/exploits/37559
  severity: high
  tags: cve,wordpress,wp-plugin,cp-image-store,high
