http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - mstore-api
  - dsl:
    - compare_versions(version, '<= 3.1.9')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/mstore-api/readme.txt'
  redirects: true
id: CVE-2021-24148-16afe15327526c9560b3e67230986d4d
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24148
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'A business logic issue in the MStore API WordPress plugin, versions
    before 3.2.0, had an authentication bypass with Sign In With Apple allowing unauthenticated
    users to recover an authentication cookie with only an email address.

    '
  metadata:
    fofa-query: wp-content/plugins/mstore-api/
    google-query: inurl:"/wp-content/plugins/mstore-api/"
    shodan-query: vuln:CVE-2021-24148
  name: 'MStore API <= 3.1.9 - Authentication Bypass

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/16e3ca1b-817d-4f03-92ae-346a56271c47?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,mstore-api,critical
