http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_any(body, "text\":\"HEC is healthy\",\"code")
    - contains(header, "application/json")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/services/collector/health'
id: splunk-hec-detect
info:
  author: idealphase
  description: 'Splunk HCE (HTTP Event Collector (HEC)) was detected.

    '
  metadata:
    max-request: 1
    verified: true
  name: Splunk HEC - Detect
  reference:
  - https://dev.splunk.com/enterprise/docs/devtools/httpeventcollector/
  - https://community.splunk.com/t5/Getting-Data-In/How-to-check-if-an-HEC-is-up-or-not-before-posting-any-data-to/td-p/417404
  severity: info
  tags: tech,splunk,hec,detect
