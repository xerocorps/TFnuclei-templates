http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-login-security-and-history
  - dsl:
    - compare_versions(version, '<= 1.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-login-security-and-history/readme.txt'
  redirects: true
id: CVE-2021-24328
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24328
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: The WP Login Security and History WordPress plugin through 1.0 did
    not have CSRF check when saving its settings, not any sanitisation or validation
    on them. This could allow attackers to make logged in administrators change the
    plugin's settings to arbitrary values, and set XSS payloads on them as well
  metadata:
    fofa-query: wp-content/plugins/wp-login-security-and-history/
    google-query: inurl:"/wp-content/plugins/wp-login-security-and-history/"
    shodan-query: vuln:CVE-2021-24328
  name: WP Login Security and History <= 1.0 - Cross-Site Request Forgery to Stored
    Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/eeb41d7b-8f9e-4a12-b65f-f310f08e4ace
  - https://m0ze.ru/exploit/csrf-wp-login-security-and-history-v1.0.html
  - https://m0ze.ru/vulnerability/%5B2021-03-29%5D-%5BWordPress%5D-%5BCWE-352%5D-WP-Login-Security-and-History-WordPress-Plugin-v1.0.txt
  - https://m0ze.ru/vulnerability/%5B2021-03-29%5D-%5BWordPress%5D-%5BCWE-79%5D-WP-Login-Security-and-History-WordPress-Plugin-v1.0.txt
  severity: high
  tags: cve,wordpress,wp-plugin,wp-login-security-and-history,high
