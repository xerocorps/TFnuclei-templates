http:
- extractors:
  - json:
    - .productname,.version
    name: software
    part: body
    type: json
  matchers:
  - status:
    - 200
    type: status
  - part: header
    type: word
    words:
    - application/json
  - condition: and
    type: word
    words:
    - needsDbUpgrade
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/status.php'
  - '{{BaseURL}}/nc/status.php'
  - '{{BaseURL}}/oc/status.php'
  - '{{BaseURL}}/cloud/status.php'
  - '{{BaseURL}}/owncloud/status.php'
  - '{{BaseURL}}/Nextcloud/status.php'
  - '{{BaseURL}}/nextcloud/status.php'
id: owncloud-nextcloud-version
info:
  author: gtrrnr, metascan
  description: Discover Owncloud/Nextcloud version.
  name: Owncloud/Nextcloud Version
  severity: info
  tags: misc,owncloud, nextcloud
