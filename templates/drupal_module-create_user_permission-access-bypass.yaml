http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '8.x-1.1')
    - compare_versions(version, '8.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - create_user_permission
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/create_user_permission/create_user_permission.info'
  redirects: true
id: drupal_module-create_user_permission-access-bypass
info:
  author: Bishopfox
  description: This module enables you to have a separate permission only for creating
    users. The module doesnt respect Drupals setting for Who can register accounts?
    when set to Visitors, but administrator approval is required. When this option
    is chosen, the module overrides the setting, and makes it possible to register
    accounts with no approval. This vulnerability can be mitigated by having other
    settings in place for account registration, such as requiring email verification
    for new accounts, or permitting account creation for Administrators only.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/create_user_permission/
    google-query: inurl:'/sites/all/modules/create_user_permission/
    impact: medium
    security-risk: "Critical 15\u221525 AC:Basic/A:None/CI:Some/II:Some/E:Theoretical/TD:Default"
    type: indicator
    vulnerability: access-bypass
  name: drupal_module-create_user_permission-access-bypass
  reference:
  - https://www.drupal.org/sa-contrib-2019-066
  severity: medium
  tags: drupal
