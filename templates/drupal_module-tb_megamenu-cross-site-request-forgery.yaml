http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '8.x-1.3')
    - compare_versions(version, '8.x-1.2')
    - compare_versions(version, '8.x-1.1')
    - compare_versions(version, '8.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - tb_megamenu
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/tb_megamenu/tb_megamenu.info'
  redirects: true
id: drupal_module-tb_megamenu-cross-site-request-forgery
info:
  author: Bishopfox
  description: This module provides an admin interface for creating drop down menus
    that combine Drupal menu items with rich media content. The module does not use
    CSRF tokens to protect routes for saving menu configurations. This vulnerability
    can be exploited by an anonymous user.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/tb_megamenu/
    google-query: inurl:'/sites/all/modules/tb_megamenu/
    impact: medium
    security-risk: "Critical 15\u221525 AC:Complex/A:None/CI:Some/II:Some/E:Theoretical/TD:All"
    type: indicator
    vulnerability: cross-site-request-forgery
  name: drupal_module-tb_megamenu-cross-site-request-forgery
  reference:
  - https://www.drupal.org/sa-contrib-2021-040
  severity: medium
  tags: drupal
