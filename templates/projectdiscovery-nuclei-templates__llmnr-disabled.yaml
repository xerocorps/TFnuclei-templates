code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - LLMNR is misconfigured or enabled by default
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: '$lmnrStatus = Get-ItemProperty -Path ''HKLM:\SOFTWARE\Policies\Microsoft\Windows
    NT\DNSClient'' -Name ''EnableMulticast'' -ErrorAction SilentlyContinue

    if ($lmnrStatus -and $lmnrStatus.EnableMulticast -eq 0) {"LLMNR is correctly disabled"}
    else {"LLMNR is misconfigured or enabled by default"}

    '
id: llmnr-disabled
info:
  author: princechaddha
  description: Determine if LLMNR (Link-Local Multicast Name Resolution) is disabled.
  impact: 'Enabling LLMNR can expose systems to man-in-the-middle attacks.

    '
  name: LLMNR Disabled
  remediation: 'Disable LLMNR to reduce the risk of such attacks.

    '
  severity: medium
  tags: windows,llmnr,network,security,code,windows-audit
self-contained: true
