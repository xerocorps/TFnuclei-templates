flow: http(1) && http(2)
http:
- matchers:
  - dsl:
    - 'contains(tolower(all_headers), ''x-powered-by: express'')'
    internal: true
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}'
- matchers:
  - condition: and
    dsl:
    - status_code==400
    - 'contains(body, ''SyntaxError: Unexpected token'')'
    - 'contains(tolower(all_headers), ''x-powered-by: express'')'
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json

    Connection: close


    t

    '
id: node-express-dev-env
info:
  author: FLX
  description: 'The Node.js application runs in development mode, which can expose
    sensitive information, such as source code and secrets, depending on the application.

    '
  metadata:
    max-request: 2
    shodan-query: 'X-Powered-By: Express'
    verified: true
  name: Node.js Express NODE_ENV Development Mode
  reference:
  - https://www.invicti.com/web-vulnerability-scanner/vulnerabilities/express-development-mode-is-enabled/
  - https://www.synopsys.com/blogs/software-security/nodejs-mean-stack-vulnerabilities.html
  severity: medium
  tags: nodejs,express,misconfig,devops,cicd,trace
