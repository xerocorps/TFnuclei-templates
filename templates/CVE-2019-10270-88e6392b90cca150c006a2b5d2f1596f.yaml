http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - ultimate-member
  - dsl:
    - compare_versions(version, '<= 2.0.39')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/ultimate-member/readme.txt'
  redirects: true
id: CVE-2019-10270-88e6392b90cca150c006a2b5d2f1596f
info:
  author: topscoder
  classification:
    cve-id: CVE-2019-10270
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: 'An arbitrary password reset issue was discovered in the Ultimate Member
    plugin 2.0.39 for WordPress. It is possible (due to lack of verification and correlation
    between the reset password key sent by mail and the user_id parameter) to reset
    the password of another user. One only needs to know the user_id, which is publicly
    available. One just has to intercept the password modification request and modify
    user_id. It is possible to modify the passwords for any users or admin WordPress
    Ultimate Members. This could lead to account compromise and privilege escalation.

    '
  metadata:
    fofa-query: wp-content/plugins/ultimate-member/
    google-query: inurl:"/wp-content/plugins/ultimate-member/"
    shodan-query: vuln:CVE-2019-10270
  name: 'Ultimate Member <= 2.0.39 - Privilege Escalation

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/e556d8c9-3ca5-4bec-a840-7a6d67532e59?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,ultimate-member,high
