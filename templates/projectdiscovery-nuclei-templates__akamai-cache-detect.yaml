http:
- headers:
    Pragma: akamai-x-cache-on
  matchers:
  - part: header
    regex:
    - (?:TCP_HIT|TCP_MISS).*deploy\.akamaitechnologies\.com
    type: regex
  method: HEAD
  path:
  - '{{BaseURL}}'
id: akamai-cache-detect
info:
  author: nybble04
  description: 'Sends a HEAD request with a Pragma header value of "akamai-x-cache-on"
    and looks for an akamai-specific response header value.

    '
  metadata:
    max-request: 1
    verified: true
  name: Akamai Cache Detection
  reference:
  - https://community.akamai.com/customers/s/article/Using-Akamai-Pragma-headers-to-investigate-or-troubleshoot-Akamai-content-delivery?language=en_US
  - https://spyclub.tech/2022/12/14/unusual-cache-poisoning-akamai-s3/
  severity: info
  tags: cache,akamai,tech,discovery
