http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '<= 4.9.8')
    - compare_versions(version_by_js, '<= 4.9.8')
    - compare_versions(version_by_css, '<= 4.9.8')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2018-1000773
info:
  author: topscoder
  classification:
    cve-id: CVE-2018-1000773
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: WordPress version 4.9.8 and earlier contains a CWE-20 Input Validation
    vulnerability in thumbnail processing that can result in remote code execution
    due to an incomplete fix for CVE-2017-1000600. This attack appears to be exploitable
    via thumbnail upload by an authenticated user and may require additional plugins
    in order to be exploited however this has not been confirmed at this time.
  metadata:
    shodan-query: vuln:CVE-2018-1000773
  name: WordPress Core <= 4.9.8 - Remote Code Execution
  reference:
  - https://youtu.be/GePBmsNJw6Y?t=1763
  - https://www.theregister.co.uk/2018/08/20/php_unserialisation_wordpress_vuln/
  severity: high
  tags: cve,wordpress,wp-core,high
