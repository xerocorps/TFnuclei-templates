id: CVE-2020-131672
info:
  author: dwisiswant0
  description: Netsweeper through 6.4.3 allows unauthenticated remote code execution
    because webadmin/tools/unixlogin.php (with certain Referer headers) launches a
    command line with client-supplied parameters, and allows injection of shell metacharacters.
  name: Netsweeper WebAdmin unixlogin.php Python Code Injection
  reference: '- https://ssd-disclosure.com/ssd-advisory-netsweeper-preauth-rce/

    - https://portswigger.net/daily-swig/severe-rce-vulnerability-in-content-filtering-system-has-been-patched-netsweeper-says

    '
  severity: critical
  tags: cve,cve2020,netsweeper,rce
requests:
- matchers:
  - part: body
    type: word
    words:
    - nonexistent
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /webadmin/out HTTP/1.1

    Host: {{Hostname}}

    Referer: "http://{{Hostname}}/webadmin/admin/service_manager_data.php"

    User-Agent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36
    (KHTML, like Gecko)"

    '
