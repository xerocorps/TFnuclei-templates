id: CVE-2015-1419
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:o:opensuse:opensuse:13.1:*:*:*:*:*:*:*
    cve-id: CVE-2015-1419
    cvss-metrics: CVSS:2.0/AV:N/AC:L/Au:N/C:N/I:P/A:N
    cvss-score: 5
    epss-percentile: 0.98351
    epss-score: 0.64113
  description: 'vsftpd 3.0.2 and earlier contain a vulnerability that allows remote
    attackers to bypass access restrictions due to improper parsing of the deny_file
    configuration directive.

    '
  impact: 'Unauthenticated attackers can bypass access restrictions configured via
    the deny_file directive to access files that should be restricted, potentially
    exposing sensitive data on vsftpd servers.

    '
  metadata:
    max-request: 1
    product: opensuse
    shodan-query: vsFTPd
    vendor: opensuse
    verified: true
  name: vsftpd <= 3.0.2 - Access Restriction Bypass
  remediation: 'Update vsftpd to a version newer than 3.0.2 that properly parses and
    enforces the deny_file configuration directive to prevent access restriction bypass.

    '
  severity: medium
  tags: cve,cve2015,network,ftp,vsftpd,tcp,passive,vuln
tcp:
- extractors:
  - group: 1
    name: version
    regex:
    - vsFTPd ([0-9.]+)
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: 0
    type: hex
  matchers:
  - condition: and
    dsl:
    - contains(raw, 'vsFTPd')
    - compare_versions(version, '<= 3.0.2')
    type: dsl
  port: 21
  read-size: 1024
