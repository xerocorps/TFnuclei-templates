code:
- engine:
  - bash
  source: "if ! grep -qi 'restrictqrun' /etc/mail/sendmail.cf 2>/dev/null; then\n\
    \  echo \"[VULNERABLE] sendmail.cf missing 'restrictqrun'\"\nelse\n  echo \"[SAFE]\
    \ restrictqrun option is set in sendmail.cf\"\nfi\n"
- engine:
  - bash
  source: "if [ -x /usr/sbin/postfix ]; then\n  PERM=\"$(stat -c '%A' /usr/sbin/postfix\
    \ 2>/dev/null || echo '')\"\n  if [ \"$PERM\" != \"-rwxr-x---\" ]; then\n    echo\
    \ \"[VULNERABLE] /usr/sbin/postfix permission is '$PERM' (expected -rwxr-x---)\"\
    \n  else\n    echo \"[SAFE] postfix binary permission is correct\"\n  fi\nfi\n"
- engine:
  - bash
  matchers:
  - name: restrictqrun
    part: code_1_response
    type: word
    words:
    - '[VULNERABLE]'
  - name: postfix-permission
    part: code_2_response
    type: word
    words:
    - '[VULNERABLE]'
  - name: postfix-group
    part: code_3_response
    type: word
    words:
    - '[VULNERABLE]'
  source: "if getent group postfix >/dev/null 2>&1; then\n  MEMBERS=\"$(getent group\
    \ postfix | awk -F ':' '{print $4}')\"\n  echo \"$MEMBERS\" | grep -qw root ||\
    \ echo \"[VULNERABLE] 'root' not in 'postfix' group\"\nfi\n"
id: sendmail-postfix-execution-restrictions
info:
  author: songyaeji
  description: 'General users were not restricted from executing Sendmail with the
    q option, and the Postfix binary lacked proper permission controls.This misconfiguration
    allowed unauthorized users to manipulate the mail queue or disrupt mail delivery.

    '
  name: Sendmail/Postfix Execution Restrictions Misconfigured
  reference:
  - https://isms.kisa.or.kr
  severity: medium
  tags: local,linux,audit,sendmail,postfix,compliance
self-contained: true
