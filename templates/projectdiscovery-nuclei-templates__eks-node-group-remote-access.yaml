code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: clusters
    type: json
  source: 'aws eks list-clusters --region $region --query ''clusters[]'' --output
    json

    '
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: nodegroups
    type: json
  source: 'aws eks list-nodegroups --cluster-name $cluster --region $region --query
    ''nodegroups[]'' --output json

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"EKS node group " + nodegroup + " in cluster " + cluster + " does not have
      remote access configured"'
    type: dsl
  matchers:
  - regex:
    - .*
    type: regex
  - negative: true
    type: word
    words:
    - 'null'
  matchers-condition: and
  source: 'aws eks describe-nodegroup --cluster-name $cluster --nodegroup-name $nodegroup
    --region $region --query ''nodegroup.remoteAccess'' --output json

    '
flow: "code(1)\nfor(let clusterName of iterate(template.clusters)){\n  set(\"cluster\"\
  , clusterName)\n  code(2)\n  for(let nodegroupName of iterate(template.nodegroups)){\n\
  \    set(\"nodegroup\", nodegroupName)\n    code(3)\n  }\n}\n"
id: eks-node-group-remote-access
info:
  author: princechaddha
  description: 'Ensure that Amazon EKS node groups are configured with appropriate
    remote access settings to maintain security and enable necessary administrative
    access.

    '
  impact: 'Improper remote access configuration in EKS node groups can lead to security
    vulnerabilities or hinder necessary administrative access, potentially affecting
    cluster management and troubleshooting capabilities.

    '
  name: EKS Node Group Remote Access Configuration
  reference:
  - https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EKS/eks-node-group-remote-access.html
  - https://docs.aws.amazon.com/eks/latest/userguide/launch-templates.html
  remediation: 'Configure remote access settings for EKS node groups by specifying
    appropriate SSH key pairs and source security groups to enable secure administrative
    access while maintaining security best practices.

    '
  severity: high
  tags: cloud,devops,aws,amazon,eks,aws-cloud-config
self-contained: true
variables:
  region: us-east-1
