http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - bot-for-telegram-on-woocommerce
  - dsl:
    - compare_versions(version, '<= 1.2.7')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/bot-for-telegram-on-woocommerce/readme.txt'
  redirects: true
id: CVE-2024-9821-bot_for_telegram_on_woocommerce-a662c904-ba2e-494c-a603-b22eeeddf43d
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-9821
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: 'The Bot for Telegram on WooCommerce plugin for WordPress is vulnerable
    to sensitive information disclosure due to missing authorization checks on the
    ''stm_wpcfto_get_settings'' AJAX action in all versions up to, and including,
    1.2.7.  This makes it possible for authenticated attackers, with subscriber-level
    access and above, to view the Telegram Bot Token, a secret token used to control
    the bot, which can then be used to log in as any existing user on the site, such
    as an administrator, if they know the username, due to the Login with Telegram
    feature.

    '
  metadata:
    fofa-query: wp-content/plugins/bot-for-telegram-on-woocommerce/
    google-query: inurl:"/wp-content/plugins/bot-for-telegram-on-woocommerce/"
    shodan-query: http.html:"wp-content/plugins/bot-for-telegram-on-woocommerce/"
  name: 'Bot for Telegram on WooCommerce <= 1.2.7 - Authenticated (Subscriber+) Telegram
    Bot Token Disclosure to Authentication Bypass

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/a662c904-ba2e-494c-a603-b22eeeddf43d?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,bot-for-telegram-on-woocommerce,low,production
