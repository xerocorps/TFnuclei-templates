headless:
- extractors:
  - internal: true
    kval:
    - extract
    name: urls
    part: extract
    type: kval
  matchers:
  - part: urls
    type: word
    words:
    - polyfill.io
    - bootcdn.net
    - bootcss.com
    - staticfile.net
    - staticfile.org
    - unionadjs.com
    - xhsbpza.com
    - union.macoms.la
    - newcrbpc.com
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}'
  - action: waitload
  - action: script
    args:
      code: "() => {\n return '\\n' + [...new Set(Array.from(document.querySelectorAll('[src],\
        \ [href], [url], [action]')).map(i => i.src || i.href || i.url || i.action))].join('\\\
        r\\n') + '\\n'\n}\n"
    name: extract
id: CVE-2024-38526
info:
  author: abut0n
  description: 'The polyfill.js is a popular open source library to support older
    browsers. 100K+ sites embed it using the cdn.polyfill.io. However, in February
    of 2024, a Chinese company bought the domain and the Github account. Since then,
    this domain was caught injecting malware on mobile devices via any site that embeds
    cdn.polyfill.io

    '
  impact: 'The new Chinese owner of the popular Polyfill JS project injects malware
    into more than 100 thousand sites.

    '
  name: CVE-2024-38526 - Untrusted 3rd party
  reference:
  - https://sansec.io/research/polyfill-supply-chain-attack
  - https://nvd.nist.gov/vuln/detail/CVE-2024-38526
  - https://x.com/triblondon/status/1761852117579427975
  remediation: 'Remove the dependecy.

    '
  severity: high
  tags: CVE,CVE-2024-38526,headless,supply-chain
