http:
- extractors:
  - kval:
    - feature_policy
    part: header
    type: kval
  matchers:
  - case-insensitive: true
    part: header
    type: word
    words:
    - 'Feature-Policy:'
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
id: deprecated-feature-policy
info:
  author: ritikchaddha
  description: 'Detected the presence of the deprecated Feature-Policy HTTP response
    header. The Feature-Policy header has been deprecated and replaced by the Permissions-Policy
    header. While Feature-Policy is still supported in some browsers for backward
    compatibility, it is recommended to migrate to Permissions-Policy for future-proofing
    web applications.

    '
  metadata:
    max-request: 1
    verified: true
  name: Deprecated Feature-Policy Header - Detection
  reference:
  - https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Feature-Policy
  - https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Permissions-Policy
  - https://www.w3.org/TR/permissions-policy-1/
  - https://github.com/w3c/webappsec-permissions-policy/blob/main/permissions-policy-explainer.md
  severity: info
  tags: misc,headers,deprecated,feature-policy,permissions
