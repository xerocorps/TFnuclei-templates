http:
- matchers:
  - condition: or
    type: word
    words:
    - 'mkdir '
    - 'chmod '
    - 'mv '
    - 'nano '
    - 'vim '
    - 'pico '
    - 'sudo '
    - 'cd '
    - 'cp '
    - ps aux
    - 'ls '
    - logout
  - negative: true
    part: response
    type: word
    words:
    - <?xml
    - <env
    - application/javascript
    - application/json
    - application/xml
    - html>
    - text/html
    - image/
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 1
  method: GET
  path:
  - '{{BaseURL}}/.bash_history'
  - '{{BaseURL}}/.ksh_history'
  - '{{BaseURL}}/.sh_history'
  - '{{BaseURL}}/.zsh_history'
id: shell-history
info:
  author: pentest_swissky,geeknik
  description: Discover history for bash, ksh, sh, and zsh
  metadata:
    max-request: 4
  name: Shell History
  severity: low
  tags: misconfig
