id: aws-bucket-takeover
info:
  author: pdcommunity
  name: AWS Bucket Takeover Detection
  reference: https://github.com/EdOverflow/can-i-take-over-xyz
  severity: high
  tags: takeover,aws
requests:
- matchers:
  - type: word
    words:
    - The specified bucket does not exist
  - dsl:
    - contains(tolower(all_headers), 'x-guploader-uploadid')
    negative: true
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
