http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - stopbadbots
  - dsl:
    - compare_versions(version, '< 6.67')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/stopbadbots/readme.txt'
  redirects: true
id: CVE-2021-24863
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24863
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: The WP Block and Stop Bad Bots Crawlers and Spiders and Anti Spam Protection
    Plugin StopBadBots WordPress plugin before 6.67 does not sanitise and escape the
    User Agent before using it in a SQL statement to save it, leading to a SQL injection
  metadata:
    fofa-query: wp-content/plugins/stopbadbots/
    google-query: inurl:"/wp-content/plugins/stopbadbots/"
    shodan-query: vuln:CVE-2021-24863
  name: WP Block and Stop Bad Bots Crawlers and Spiders and Anti Spam Protection Plugin
    StopBadBots < 6.67 - Unauthenticated SQL Injection
  reference:
  - https://wpscan.com/vulnerability/1e4dd002-6c96-44f9-bd55-61359265f7ae
  severity: critical
  tags: cve,wordpress,wp-plugin,stopbadbots,critical
