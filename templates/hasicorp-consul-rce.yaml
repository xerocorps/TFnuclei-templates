id: hasicorp-consul-rce
info:
  name: Hashicorp Consul RCE
  risk: Potential
params:
- root: '{{.BaseURL}}'
- dest: t3xc2xpi6jd3rwpz7jgc4w4s2j8dw2.burpcollaborator.net
references:
- link1: https://www.exploit-db.com/exploits/46073
- link2: https://www.exploit-db.com/exploits/46074
requests:
- detections:
  - StatusCode() == 200 && (StringSearch("body", '"EnableScriptChecks":true') || StringSearch("body",
    '"EnableRemoteScriptChecks":true') || StringSearch("body", '"DisableRemoteExec":false'))
  headers:
  - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101
      Firefox/55
  method: GET
  redirect: false
  url: '{{.root}}/v1/agent/self'
variables:
- ran: RandomString(6)
