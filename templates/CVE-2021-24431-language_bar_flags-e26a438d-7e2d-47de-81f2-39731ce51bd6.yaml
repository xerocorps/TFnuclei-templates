http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - language-bar-flags
  - dsl:
    - compare_versions(version, '<= 1.0.8')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/language-bar-flags/readme.txt'
  redirects: true
id: CVE-2021-24431-language_bar_flags-e26a438d-7e2d-47de-81f2-39731ce51bd6
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24431
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
  description: 'The Language Bar Flags WordPress plugin through 1.0.8 does not have
    any CSRF in place when saving its settings and did not sanitise or escape them
    when generating the flag bar in the frontend. This could allow attackers to make
    a logged in admin change the settings, and set Cross-Site Scripting payload in
    them, which will be executed in the frontend for all users

    '
  metadata:
    fofa-query: wp-content/plugins/language-bar-flags/
    google-query: inurl:"/wp-content/plugins/language-bar-flags/"
    shodan-query: http.html:"wp-content/plugins/language-bar-flags/"
  name: 'Language Bar Flags <= 1.0.8 - Cross-Site Request Forgery leading to Stored
    Cross-Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/e26a438d-7e2d-47de-81f2-39731ce51bd6?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,language-bar-flags,medium,production
