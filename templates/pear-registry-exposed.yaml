http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, 'install-pear.php','PEAR_ErrorStack','install-pear-nozlib.phar')
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/.registry/pear.reg.ber'
  - '{{BaseURL}}/.registry/pear.reg'
  - '{{BaseURL}}/PEAR/.registry/pear.reg.ber'
  - '{{BaseURL}}/PEAR/.registry/pear.reg'
  stop-at-first-match: true
id: pear-registry-exposed
info:
  author: pussycat0x
  description: 'Detected exposed PEAR registry files (.reg) containing serialized
    PHP metadata, including package versions and local paths. This exposure facilitated
    supply-chain reconnaissance by revealing installed dependencies and system mappings.

    '
  metadata:
    max-request: 4
    verified: false
  name: PEAR Registry Files Exposed
  reference:
  - https://pear.php.net/manual/en/core.pear.pear-registry.php
  - https://github.com/pear/pear-core/blob/master/PEAR/Registry.php
  - https://blog.sonarsource.com/php-supply-chain-attack-on-pear/
  severity: low
  tags: misconfig,pear,php,registry,exposure
