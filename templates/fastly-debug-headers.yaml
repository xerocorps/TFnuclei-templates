http:
- headers:
    Fastly-Debug: '1'
  matchers:
  - name: fastly-debug-path
    part: header
    regex:
    - (?i)fastly-debug-path:\s*.+
    type: regex
  - name: fastly-debug-ttl
    part: header
    regex:
    - (?i)fastly-debug-ttl:\s*.+
    type: regex
  - name: fastly-debug-digest
    part: header
    regex:
    - (?i)fastly-debug-digest:\s*.+
    type: regex
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}'
id: fastly-debug-headers
info:
  author: pussycat0x
  description: 'Detected Fastly CDN debug headers being exposed when the Fastly-Debug
    header was sent in a request.This exposure disclosed sensitive debugging information
    such as cache paths, TTL values, content digests, surrogate keys, and cache server
    identities, which could help attackers understand CDN configuration and cache
    behavior.

    '
  metadata:
    max-request: 1
    shodan-query: 'X-Served-By: cache'
    verified: true
  name: Fastly CDN Debug Headers Exposure
  reference:
  - https://www.fastly.com/documentation/reference/http/http-headers/Fastly-Debug/
  severity: info
  tags: fastly,cdn,exposure,misconfig
