http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - capability-manager-enhanced
  - dsl:
    - compare_versions(version, '< 2.3.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/capability-manager-enhanced/readme.txt'
  redirects: true
id: CVE-2021-25032-capability_manager_enhanced-cf3df923-9426-4e5b-ba59-eda0b5c18d40
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-25032
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The PublishPress Capabilities WordPress plugin before 2.3.1, PublishPress
    Capabilities Pro WordPress plugin before 2.3.1 does not have authorisation and
    CSRF checks when updating the plugin''s settings via the init hook, and does not
    ensure that the options to be updated belong to the plugin. As a result, unauthenticated
    attackers could update arbitrary blog options, such as the default role and make
    any new registered user with an administrator role.

    '
  metadata:
    fofa-query: wp-content/plugins/capability-manager-enhanced/
    google-query: inurl:"/wp-content/plugins/capability-manager-enhanced/"
    shodan-query: http.html:"wp-content/plugins/capability-manager-enhanced/"
  name: 'PublishPress Capabilities <= 2.3 - Unauthenticated Arbitrary Options Update

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/cf3df923-9426-4e5b-ba59-eda0b5c18d40?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,capability-manager-enhanced,critical,production
