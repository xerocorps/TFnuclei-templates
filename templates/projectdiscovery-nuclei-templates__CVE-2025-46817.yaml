flow: javascript(1) && javascript(2)
id: CVE-2025-46817
info:
  author: pussycat0x
  description: 'Redis is an open source, in-memory database that persists on disk.
    Versions 8.2.1 and below allow an authenticated user to use a specially crafted
    Lua script to cause an integer overflow and potentially lead to remote code execution
    The problem exists in all versions of Redis with Lua scripting. This issue is
    fixed in version 8.2.2.

    '
  impact: 'Authenticated users can execute arbitrary code remotely, potentially compromising
    the entire system.

    '
  metadata:
    max-request: 1
    shodan-query: product:"redis"
    verified: true
  name: Redis < 8.2.1 lua script - Integer Overflow
  reference:
  - https://github.com/dwisiswant0/CVE-2025-46817/blob/master/README.md
  remediation: 'Update to version 8.2.2 or later.

    '
  severity: critical
  tags: cve,cve2025,js,redis,network,passive,authenticated,vuln
javascript:
- args:
    Host: '{{Host}}'
    Port: '6379'
  code: 'const redis = require(''nuclei/redis'');

    const info = redis.GetServerInfo(Host,Port);

    Export(info);

    '
  extractors:
  - group: 1
    name: version
    part: response
    regex:
    - redis_version:(\d+\.\d+\.\d+)
    type: regex
  matchers:
  - condition: and
    dsl:
    - success == true
    - compare_versions(version, ' <= 8.2.1')
    type: dsl
  pre-condition: 'isPortOpen(Host,Port);

    '
- args:
    Host: '{{Host}}'
    Password: '{{passwords}}'
    Payload: return "lua enabled"
    Port: '6379'
  code: 'const redis = require(''nuclei/redis'');

    const info = redis.RunLuaScript(Host,Port,Password,Payload);

    Export(info);

    '
  matchers:
  - condition: and
    dsl:
    - success == true
    - contains(response, 'lua enabled')
    internal: true
    type: dsl
  payloads:
    passwords:
    - ''
