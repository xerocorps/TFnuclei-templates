http:
- fuzzing:
  - fuzz:
    - '{{rfi}}'
    mode: single
    part: query
  matchers:
  - part: body
    type: word
    words:
    - d5b82f27-b7a4-4c3e-8b6e-88fd9e97b16a
  - part: interactsh_protocol
    type: word
    words:
    - http
    - dns
  payloads:
    rfi:
    - https://snbig.github.io/Vulnerable-Pages/ASVS_12_3_3/rfi.txt
    - https://{{interactsh-url}}
  pre-condition:
  - dsl:
    - method == "GET"
    type: dsl
  stop-at-first-match: true
id: ASVS-4-0-3-V12-3-3
info:
  author: AmirHossein Raeisi
  classification:
    cwe-id: CWE-918, CWE-98
  description: 'Verify that user-submitted filename metadata is validated or ignored
    to prevent the disclosure or execution of remote files via Remote File Inclusion
    (RFI) or Server-side Request Forgery (SSRF) attacks.

    '
  name: ASVS 12.3.3 Check
  reference:
  - https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.2-Testing_for_Remote_File_Inclusion
  - https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/19-Testing_for_Server-Side_Request_Forgery
  - https://snbig.github.io/Vulnerable-Pages/ASVS_12_3_3/
  severity: high
  tags: asvs,12.3.3
