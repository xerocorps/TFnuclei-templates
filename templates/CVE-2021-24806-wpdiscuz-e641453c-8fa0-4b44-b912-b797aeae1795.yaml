http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wpdiscuz
  - dsl:
    - compare_versions(version, '< 7.3.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wpdiscuz/readme.txt'
  redirects: true
id: CVE-2021-24806-wpdiscuz-e641453c-8fa0-4b44-b912-b797aeae1795
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24806
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    cvss-score: 4.3
  description: 'The wpDiscuz WordPress plugin before 7.3.4 does check for CSRF when
    adding, editing and deleting comments, which could allow attacker to make logged
    in users such as admin edit and delete arbitrary comment, or the user who made
    the comment to edit it via a CSRF attack. Attackers could also make logged in
    users post arbitrary comment.

    '
  metadata:
    fofa-query: wp-content/plugins/wpdiscuz/
    google-query: inurl:"/wp-content/plugins/wpdiscuz/"
    shodan-query: http.html:"wp-content/plugins/wpdiscuz/"
  name: 'Comments - wpDiscuz <= 7.3.3 - Arbitrary Comment Addition/Edition/Deletion
    by Cross-Site Request Forgery

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/e641453c-8fa0-4b44-b912-b797aeae1795?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,wpdiscuz,medium,production
