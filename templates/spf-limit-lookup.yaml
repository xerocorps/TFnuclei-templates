dns:
- extractors:
  - internal: true
    name: spf_record
    regex:
    - v=spf1[^\"]*
    type: regex
  - internal: true
    name: spf_record_limit
    part: spf_record
    regex:
    - (?i)(include|all):?[^ ]*?
    type: regex
  matchers:
  - dsl:
    - len(spf_record_limit)>10
    type: dsl
  name: '{{FQDN}}'
  type: TXT
id: spf-limit-lookup
info:
  author: theamanrawat
  description: 'SPF (Sender Policy Framework) records that exceed the 10 DNS lookup
    limit was detected. SPF records with more than 10 DNS-based mechanisms may cause
    SPF authentication failures, leading to potential email delivery issues and spoofing
    risks.

    '
  name: SPF record DNS lookup limit
  reference:
  - https://dmarcly.com/blog/spf-permerror-too-many-dns-lookups-when-spf-record-exceeds-10-dns-lookup-limit
  severity: info
  tags: dns,spf,discovery
