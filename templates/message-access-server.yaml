code:
- args:
  - -c
  - "if dpkg-query -s dovecot-imapd &>/dev/null; then\n  echo \"[message-access-server-check:Policy-Fail]\
    \ [dovecot-imapd is installed] [CIS_FAIL]\"\nelse\n  echo \"[message-access-server-check:Policy-Pass]\
    \ [dovecot-imapd is not installed] [CIS_PASS]\"\nfi\n"
  engine:
  - bash
  matchers:
  - name: policy-pass
    type: word
    words:
    - Policy-Pass
  - name: policy-fail
    type: word
    words:
    - Policy-Fail
id: message-access-server
info:
  author: Th3l0newolf
  description: 'The dovecot-imapd package provides the Dovecot IMAP server, which
    allows users to remotely access email stored on the system. If not explicitly
    required, having this service installed unnecessarily increases the system''s
    attack surface and could expose it to potential remote exploits. To maintain a
    secure system, IMAP services should only be installed and enabled when there is
    a clear business requirement.

    '
  metadata:
    verified: true
  name: Ensure Message Access Server Service is Not Installed
  reference:
  - https://www.cisecurity.org/benchmark/ubuntu_linux
  remediation: '- Ensure the `slapd` package is not installed unless explicitly required.

    - To remove the package, run: sudo apt-get remove slapd -y

    '
  severity: info
  tags: cis,local,cisecurity,audit,linux,ubuntu
self-contained: true
