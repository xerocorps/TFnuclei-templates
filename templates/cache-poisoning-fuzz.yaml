id: cache-poisoning-fuzz
info:
  author: dwisiswant0
  name: Cache Poison Fuzzing
  reference:
  - https://youst.in/posts/cache-poisoning-at-scale/
  severity: info
  tags: cache,fuzz
requests:
- attack: clusterbomb
  matchers:
  - dsl:
    - contains(body_2, "{{uniq}}")
    type: dsl
  payloads:
    headers: helpers/wordlists/headers.txt
    uniq:
    - '{{md5(rand_text_numeric(32))}}'
  raw:
  - 'GET /?{{uniq}}=1 HTTP/1.1

    Host: {{Hostname}}

    {{headers}}: {{uniq}}.tld

    '
  - 'GET /?{{uniq}}=1 HTTP/1.1

    Host: {{Hostname}}

    '
  req-condition: true
  stop-at-first-match: true
