id: direct-connect-detect
info:
  author: pussycat0x
  metadata:
    max-request: 1
    shodan-query: product:"Direct Connect P2P"
    verfied: true
  name: Direct Connect P2P - Detect
  reference:
  - https://en.wikipedia.org/wiki/Direct_Connect_(protocol)
  severity: info
  tags: js,network,detect,dc,direct-connect,p2p,discovery
tcp:
- host:
  - '{{Hostname}}'
  inputs:
  - data: 0
    type: hex
  matchers:
  - condition: or
    type: word
    words:
    - $MyNick bb3096
    - $Lock EXTENDEDPROTOCOL
  port: 548
  read-size: 1024
