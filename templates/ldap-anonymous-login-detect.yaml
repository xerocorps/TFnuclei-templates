id: ldap-anonymous-login-detect
info:
  author: pussycat0x,s0obi
  description: 'Detects whether an LDAP server allows anonymous bind (login without
    credentials).Anonymous access can expose sensitive directory information and should
    be restricted

    unless explicitly intended.

    '
  metadata:
    max-request: 1
    shodan-query: ldap
    verified: true
  name: LDAP Anonymous Login - Detect
  reference:
  - https://ldap.com/ldapv3-wire-protocol-reference-bind/#anonymous
  - https://docs.projectdiscovery.io/templates/protocols/javascript/modules/ldap.Client#getadgroups
  severity: medium
  tags: js,network,ldap,enum,vuln
javascript:
- args:
    Host: ldap://{{Host}}
    Port: 389
  code: 'let ldap = require(''nuclei/ldap'');

    let cfg = ldap.Config();

    cfg.Upgrade = true;

    let client = ldap.Client(Host, Port, cfg);

    let result = client.Authenticate('''', '''');

    let metadata = client.CollectMetadata();

    Export(metadata);

    '
  matchers:
  - dsl:
    - success == true
    type: dsl
