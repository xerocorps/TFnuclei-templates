http:
- matchers:
  - part: body
    type: word
    words:
    - ':rubygems_api_key:'
  - negative: true
    part: body
    type: word
    words:
    - <html
    - <body
    - <!DOCTYPE
    - <script
    - <?php
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/.gem/credentials'
  - '{{BaseURL}}/credentials'
  - '{{BaseURL}}/.gem/credentials.yaml'
  stop-at-first-match: true
id: rubygems-credentials-exposure
info:
  author: theamanrawat
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-200
  description: 'Ruby Gem credentials file is exposed, potentially leaking RubyGems
    API keys. The ~/.gem/credentials file stores authentication tokens for publishing
    gems to RubyGems.org or private gem servers.

    '
  metadata:
    max-request: 3
    verified: false
  name: Ruby Gem::ConfigFile Credential - Exposure
  reference:
  - https://guides.rubygems.org/rubygems-org-api/
  - https://blog.rubygems.org/2020/07/28/api-key-leak.html
  severity: high
  tags: exposure,rubygems,credentials,config,token
