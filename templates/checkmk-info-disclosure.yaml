id: checkmk-info-disclosure
info:
  author: ivaldivieso
  description: 'The Checkmk agent had exposed sensitive system information on TCP
    port 6556 without requiring authentication.

    '
  metadata:
    shodan-query: product:"check_mk"
    verified: true
  name: Checkmk Agent Info Disclosure
  reference:
  - https://medium.com/@Th3hound/the-hidden-danger-of-the-exposed-checkmk-agent-mapping-your-infrastructure-for-attackers-151cc2180e73
  severity: medium
  tags: tcp,network,checkmk,unauth,discovery
tcp:
- host:
  - '{{Hostname}}'
  inputs:
  - data: '

      '
  matchers:
  - condition: or
    type: word
    words:
    - <<<check_mk>>>
    - 'AgentOS:'
    - 'Version:'
  - negative: true
    type: word
    words:
    - HTTP/1.1
  matchers-condition: and
  port: 6556
  read-size: 1024
