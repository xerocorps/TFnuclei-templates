http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)- v: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)- v: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - Open Web Analytics
  - dsl:
    - compare_versions(version, "< 1.7.4")
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/owa/index.php?owa_do=base.loginForm'
  redirects: true
id: CVE-2022-24637
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-24637
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: Open Web Analytics (OWA) before 1.7.4 allows an unauthenticated remote
    attacker to obtain sensitive user information, which can be used to gain admin
    privileges by leveraging cache hashes. This occurs because files generated with
    '<?php (instead of the intended <?php sequence) aren't handled by the PHP interpreter.
  metadata:
    fofa-query: /wp-content/plugins/owa/
    google-query: inurl:"/wp-content/plugins/owa/"
    shodan-query: vuln:CVE-2022-24637
  name: Open Web Analytics 1.7.3 - Remote Code Execution
  reference:
  - https://devel0pment.de/?p=2494
  - https://github.com/Open-Web-Analytics/Open-Web-Analytics/releases/tag/1.7.4
  - http://packetstormsecurity.com/files/169811/Open-Web-Analytics-1.7.3-Remote-Code-Execution.html
  - https://github.com/garySec/CVE-2022-24637
  - https://github.com/hupe1980/CVE-2022-24637
  severity: critical
  tags: cve,wordpress,plugin,wp-plugin,critical,critical
