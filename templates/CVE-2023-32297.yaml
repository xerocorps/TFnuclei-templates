http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - lws-affiliation
  - dsl:
    - compare_versions(version, '<= 2.2.6')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/lws-affiliation/readme.txt'
  redirects: true
id: CVE-2023-32297
info:
  author: topscoder
  classification:
    cve-id: CVE-2023-32297
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The LWS Affiliation plugin for WordPress is vulnerable to Remote/Local
    File Inclusion in versions up to, and including, 2.2.6 via the ''path'' parameter.
    This allows unauthenticated attackers to include and execute arbitrary remote
    code on the server, provided that allow_url_include is enabled. Local File Inclusion
    is also possible, albeit less useful because it requires that the attacker be
    able to upload a malicious php file via FTP or some other means into a directory
    readable by the web server.

    '
  metadata:
    fofa-query: wp-content/plugins/lws-affiliation/
    google-query: inurl:"/wp-content/plugins/lws-affiliation/"
    shodan-query: vuln:CVE-2023-32297
  name: 'LWS Affiliation <= 2.2.6 - Unauthenticated Remote/Local File Inclusion

    '
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/a7b1871d-9d26-4bdc-bd20-0535143902d4?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,lws-affiliation,critical
