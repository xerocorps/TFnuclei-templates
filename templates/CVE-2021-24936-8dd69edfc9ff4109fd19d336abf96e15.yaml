http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-extra-file-types
  - dsl:
    - compare_versions(version, '<= 0.5')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-extra-file-types/readme.txt'
  redirects: true
id: CVE-2021-24936-8dd69edfc9ff4109fd19d336abf96e15
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24936
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: 'The WP Extra File Types WordPress plugin before 0.5.1 does not have
    CSRF check when saving its settings, nor sanitise and escape some of them, which
    could allow attackers to make a logged in admin change them and perform Cross-Site
    Scripting attacks

    '
  metadata:
    fofa-query: wp-content/plugins/wp-extra-file-types/
    google-query: inurl:"/wp-content/plugins/wp-extra-file-types/"
    shodan-query: vuln:CVE-2021-24936
  name: 'WP Extra File Types <= 0.5 - Cross-Site Request Forgery to Stored Cross-Site
    Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/ae397949-12d2-4323-871e-4fd4f14f35c6?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,wp-extra-file-types,high
