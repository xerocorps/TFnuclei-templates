id: mismatched-ssl-certificate
info:
  author: pdteam
  description: 'Mismatched certificates occur when there is inconsistency between
    the common name to which the certificate was issued and the domain name in the
    URL. This issue impacts the trust value of the affected website.

    '
  metadata:
    max-request: 1
  name: Mismatched SSL Certificate
  reference:
  - https://www.invicti.com/web-vulnerability-scanner/vulnerabilities/ssl-certificate-name-hostname-mismatch/
  severity: info
  tags: ssl,tls,mismatched,vuln
ssl:
- address: '{{Host}}:{{Port}}'
  extractors:
  - dsl:
    - '"CN: " + subject_cn'
    type: dsl
  matchers:
  - condition: and
    dsl:
    - mismatched == true
    - ip != host
    - '!contains(host, ''enterpriseregistration.'') && !contains(host, ''enterpriseenrollment.'')'
    type: dsl
