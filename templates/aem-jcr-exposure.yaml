http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "application/json")
    - contains_all(body, "jcr:createdBy", "cq:template")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/jcr:content.json'
  - '{{BaseURL}}/etc/replication/agents.author/publish/jcr:content.json'
  stop-at-first-match: true
id: aem-jcr-exposure
info:
  author: pussycat0x
  description: 'Detected an exposed Adobe AEM JCR compare functionality that was accessible
    without proper authorization. This exposure may have allowed attackers to infer
    repository structure or sensitive content through comparison operations.

    '
  metadata:
    max-request: 1
    shodan-query: http.component:"Adobe Experience Manager"
    verified: true
  name: Adobe AEM JCR Compare Exposure
  reference:
  - https://experienceleague.adobe.com/docs/experience-manager-65/administering/security/security-checklist.html
  - https://medium.com/@vsr061/adobe-experience-manager-security-issues-9b5bd24e0eb0
  severity: medium
  tags: aem,adobe,exposure,misconfiguration,jcr
