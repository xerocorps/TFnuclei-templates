headless:
- extractors:
  - kval:
    - extract
    part: extract
    type: kval
  matchers:
  - type: word
    words:
    - test.html
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}'
  - action: waitload
  - action: script
    args:
      code: '() => ''\n'' + [...new Set(Array.from(document.querySelectorAll(''[src],
        [href], [url], [action]'')).map(i => i.src || i.href || i.url || i.action))].join(''\r\n'')
        + ''\n''

        '
    name: extract
id: headless-extract-values
info:
  author: pdteam
  name: Headless Extract Value
  severity: info
  tags: headless
