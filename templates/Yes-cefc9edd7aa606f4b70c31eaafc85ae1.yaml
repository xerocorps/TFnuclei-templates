http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '<= 3.6.1')
    - compare_versions(version_by_js, '<= 3.6.1')
    - compare_versions(version_by_css, '<= 3.6.1')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: Yes-cefc9edd7aa606f4b70c31eaafc85ae1
info:
  author: topscoder
  classification:
    cve-id: null
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 4.9
  description: WordPress Core, in versions up to 6.0.2, is vulnerable to Authenticated
    Stored Cross-Site Scripting that can be exploited by users with access to the
    WordPress post and page editor, typically consisting of Authors, Contributors,
    and Editors making it possible to inject arbitrary web scripts into posts and
    pages that execute if the the_meta(); function is called on that page.
  metadata:
    shodan-query: 'vuln:'
  name: WordPress Core < 6.0.2 - Authenticated (Contributor+) Stored Cross-Site Scripting
    via use of the_meta(); function
  reference:
  - https://core.trac.wordpress.org/changeset/53961
  - https://wordpress.org/news/2022/08/wordpress-6-0-2-security-and-maintenance-release/
  - https://www.wordfence.com/blog/2022/08/wordpress-core-6-0-2-security-maintenance-release-what-you-need-to-know/
  severity: medium
  tags: cve,wordpress,wp-core,medium
