http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '8.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - config_perms
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/config_perms/config_perms.info'
  redirects: true
id: drupal_module-config_perms-access-bypass
info:
  author: Bishopfox
  description: Custom Permissions is a lightweight module that allows permissions
    to be created and managed through an administrative form. When this module is
    in use, any user who is able to perform an action which rebuilds some of Drupals
    caches can trigger a scenario in which certain pages protected by this modules
    custom permissions temporarily lose those custom access controls, thereby leading
    to an access bypass vulnerability.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/config_perms/
    google-query: inurl:'/sites/all/modules/config_perms/
    impact: medium
    security-risk: "Moderately critical 13\u221525 AC:Basic/A:Admin/CI:Some/II:Some/E:Theoretical/TD:All"
    type: indicator
    vulnerability: access-bypass
  name: drupal_module-config_perms-access-bypass
  reference:
  - https://www.drupal.org/sa-contrib-2017-083
  severity: medium
  tags: drupal
