code:
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"Logs Router Encryption with CMK not enabled for your organization"'
    type: dsl
  matchers:
  - type: word
    words:
    - 'null'
  source: 'gcloud alpha logging cmek-settings describe --organization=$organization
    --format="json(kmsKeyName)"

    '
id: gcloud-logs-router-cmek-not-enabled
info:
  author: princechaddha
  description: 'Ensure that Google Cloud Logs Router data is encrypted with Customer-Managed
    Keys (CMKs) to provide full control over your data encryption and decryption process
    and to help meet compliance requirements. Using Cloud Key Management Service (Cloud
    KMS), you can create and manage your CMKs, ensuring secure and efficient encryption
    key management, controlled key rotation, and revocation mechanisms.

    '
  impact: 'Without Customer-Managed Keys (CMKs) encryption, your Logs Router data
    may not meet organizational compliance requirements and is not protected by keys
    you control, potentially exposing sensitive information to unauthorized access.

    '
  name: Logs Router Encryption with Customer-Managed Keys Not Enabled
  reference:
  - https://cloud.google.com/logging/docs/routing/managed-encryption
  remediation: 'Enable Customer-Managed Keys (CMKs) for Logs Router encryption within
    your GCP organization by configuring Cloud KMS keys and associating them with
    the Logs Router service. Ensure the CMKs are properly managed and rotated per
    compliance requirements.

    '
  severity: high
  tags: cloud,devops,gcp,gcloud,google-cloud-logging,gcp-cloud-config
self-contained: true
