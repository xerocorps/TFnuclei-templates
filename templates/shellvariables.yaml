id: shellvariables
info:
  author: panch0r3d
  name: Published shell variables usually in javascript files
  severity: info
requests:
- extractors:
  - part: body
    regex:
    - SHELL.*?bin
    - XDG_SESSION_TYPE.*?tty
    - LOGNAME.*?root
    - DBUS_SESSION_BUS_ADDRESS.*?unix
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    regex:
    - .*?XDG_SESSION_TYPE.*?tty
    - .*?LOGNAME.*?root
    - .*?DBUS_SESSION_BUS_ADDRESS.*?unix
    type: regex
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
