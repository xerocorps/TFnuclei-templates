id: ssh-cbc-mode-ciphers
info:
  author: pussycat0x
  description: '"SSH Server CBC Mode Ciphers Enabled" signifies that the SSH server
    supports Cipher Block Chaining (CBC) mode ciphers, which are known for potential
    vulnerabilities. This configuration poses a security risk, and it''s recommended
    to disable CBC ciphers in favor of more secure alternatives for enhanced protection
    during data transmission.

    '
  metadata:
    max-request: 2
    shodan-query: product:"OpenSSH"
    verified: true
  name: SSH Server CBC Mode Ciphers Enabled
  reference:
  - https://www.tenable.com/plugins/nessus/70658
  severity: low
  tags: js,enum,ssh,misconfig,network,vuln
javascript:
- args:
    Host: '{{Host}}'
    Port: '22'
  code: 'let m = require("nuclei/ssh");

    let c = m.SSHClient();

    let response = c.ConnectSSHInfoMode(Host, Port);

    Export(response);

    '
  matchers:
  - condition: and
    type: word
    words:
    - client_to_server_ciphers
    - server_to_client_ciphers
  - condition: or
    type: word
    words:
    - aes128-cbc
    - 'aes192-cbc:'
    - aes256-cbc
    - 3des-cbc
    - blowfish-cbc
    - cast128-cbc
  matchers-condition: and
  pre-condition: 'isPortOpen(Host,Port)

    '
