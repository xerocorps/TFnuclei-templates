http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 1', '<= 5.8')
    - compare_versions(version_by_js, '>= 1', '<= 5.8')
    - compare_versions(version_by_css, '>= 1', '<= 5.8')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2021-39202
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-39202
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:L/A:N
    cvss-score: 7.6
  description: WordPress is a free and open-source content management system written
    in PHP and paired with a MySQL or MariaDB database. In affected versions the widgets
    editor introduced in WordPress 5.8 beta 1 has improper handling of HTML input
    in the Custom HTML feature. This leads to stored XSS in the custom HTML widget.
    This has been patched in WordPress 5.8. It was only present during the testing/beta
    phase of WordPress 5.8.
  metadata:
    shodan-query: vuln:CVE-2021-39202
  name: WordPress Core 5.8 beta -  Stored Cross-Site Scripting in Custom HTML Block
  reference:
  - https://github.com/WordPress/wordpress-develop/security/advisories/GHSA-fr6h-3855-j297
  - https://hackerone.com/reports/1222797
  severity: high
  tags: cve,wordpress,wp-core,high
