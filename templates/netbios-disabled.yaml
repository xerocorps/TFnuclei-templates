code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - NetBIOS is misconfigured or enabled
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: '$netbiosStatus = Get-WmiObject Win32_NetworkAdapterConfiguration | Where-Object
    { $_."TCP/IPNetBIOSOptions" -ne 2 }

    if ($netbiosStatus) {"NetBIOS is misconfigured or enabled"} else {"NetBIOS is
    correctly disabled"}

    '
id: netbios-disabled
info:
  author: princechaddha
  description: Determine if NetBIOS over TCP/IP is disabled on all network adapters.
  impact: 'Enabling NetBIOS can expose systems to network-related attacks such as
    traffic interception and spoofing.

    '
  name: NetBIOS Disabled
  remediation: 'Disable NetBIOS on all network adapters to mitigate potential security
    risks.

    '
  severity: medium
  tags: windows,netbios,network,security,code,windows-audit
self-contained: true
