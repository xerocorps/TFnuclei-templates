http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '8.x-1.4')
    - compare_versions(version, '8.x-1.3')
    - compare_versions(version, '8.x-1.2')
    - compare_versions(version, '8.x-1.1')
    - compare_versions(version, '8.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - ckeditor_uploadimage
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/ckeditor_uploadimage/ckeditor_uploadimage.info'
  redirects: true
id: drupal_module-ckeditor_uploadimage-access-bypass
info:
  author: Bishopfox
  description: This module enables you to drag and drop or paste images into CKEditor.
    The module does not sufficiently verify users permissions, which leads to anonymous
    users being able to upload files to the server.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/ckeditor_uploadimage/
    google-query: inurl:'/sites/all/modules/ckeditor_uploadimage/
    impact: medium
    security-risk: "Critical 15\u221525 AC:None/A:None/CI:None/II:Some/E:Theoretical/TD:All"
    type: indicator
    vulnerability: access-bypass
  name: drupal_module-ckeditor_uploadimage-access-bypass
  reference:
  - https://www.drupal.org/sa-contrib-2018-014
  severity: medium
  tags: drupal
