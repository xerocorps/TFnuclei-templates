http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - yop-poll
  - dsl:
    - compare_versions(version, '<= 6.2.7')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/yop-poll/readme.txt'
  redirects: true
id: CVE-2021-24454-52e9fd4471160f6c0ac6aa1fa9c18239
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24454
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
  description: 'In the YOP Poll WordPress plugin before 6.2.8, when a pool is created
    with the options "Allow other answers", "Display other answers in the result list"
    and "Show results", it can lead to Stored Cross-Site Scripting issues as the ''Other''
    answer is not sanitised before being output in the page. The execution of the
    XSS payload depends on the ''Show results'' option selected, which could be before
    or after sending the vote for example.

    '
  metadata:
    fofa-query: wp-content/plugins/yop-poll/
    google-query: inurl:"/wp-content/plugins/yop-poll/"
    shodan-query: vuln:CVE-2021-24454
  name: 'YOP Poll <= 6.2.7 - Unauthenticated Stored Cross-Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/5df238dd-6269-4ee0-a0f4-12bdb74f74e8?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,yop-poll,high
