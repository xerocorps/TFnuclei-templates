http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Version: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Version: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - bricks
  - dsl:
    - compare_versions(version, '>= 1.2', '<= 1.5.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/themes/bricks/style.css'
  redirects: true
id: CVE-2022-3401-a9262a3395d55dbf8e11db4b52000c19
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-3401
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: 'The Bricks theme for WordPress is vulnerable to remote code execution
    due to the theme allowing site editors to include executable code blocks in website
    content in versions 1.2 to 1.5.3. This, combined with the missing authorization
    vulnerability (CVE-2022-3400), makes it possible for authenticated attackers with
    minimal permissions, such as a subscriber, can edit any page, post, or template
    on the vulnerable WordPress website and inject a code execution block that can
    be used to achieve remote code execution.

    '
  metadata:
    fofa-query: wp-content/themes/bricks/
    google-query: inurl:"/wp-content/themes/bricks/"
    shodan-query: vuln:CVE-2022-3401
  name: 'Bricks 1.2 - 1.5.3 - Remote Code Execution

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/2471d06b-7d9a-41b9-b38c-3f40322d8a5b?source=api-prod
  severity: low
  tags: cve,wordpress,wp-theme,bricks,low
