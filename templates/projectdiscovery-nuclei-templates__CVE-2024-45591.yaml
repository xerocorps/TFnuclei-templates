http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - version
    - historySummary
    - pageId
    - comment
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/xwiki/rest/wikis/xwiki/spaces/Main/pages/WebHome/history'
id: CVE-2024-45591
info:
  author: pd-bot
  classification:
    cpe: cpe:2.3:a:xwiki:platform:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-45591
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-359,CWE-862
    epss-percentile: 0.99166
    epss-score: 0.82065
  description: 'A vulnerability in XWiki Platform''s REST API allows unauthorized
    users to access document history information. The REST API endpoint exposes the
    history of any page including modification times, version numbers, author details
    (username and display name), and version comments, regardless of access rights
    configuration, even on private wikis.

    '
  impact: 'An attacker can access document history of any known page

    '
  metadata:
    max-request: 1
    product: xwiki-platform
    shodan-query: http.html:"data-xwiki-reference"
    vendor: xwiki
    verified: true
  name: XWiki Platform - Unauthorized Document History Access
  reference:
  - https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-pvmm-55r5-g3mm
  - https://jira.xwiki.org/browse/XWIKI-22052
  - https://nvd.nist.gov/vuln/detail/cve-2024-45591
  remediation: 'Upgrade to XWiki Platform version 15.10.9 or 16.3.0-rc-1 or later.
    No workarounds are available for earlier versions

    '
  severity: medium
  tags: cve,cve2024,xwiki,exposure,rest-api,vuln
