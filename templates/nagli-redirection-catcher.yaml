http:
- fuzzing:
  - fuzz:
    - '{{redirect}}'
    mode: single
    part: query
    type: replace
  matchers:
  - part: header
    regex:
    - (?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)?(?:[a-zA-Z0-9\-_\.@]*)oast\.me\/?(\/|[^.].*)?$
    type: regex
  - status:
    - 301
    - 302
    - 303
    - 304
    - 306
    - 307
    - 308
    type: status
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}'
  payloads:
    redirect:
    - \"><meta http-equiv="Refresh" content=0; url=https://oast.me">
  redirects: true
  stop-at-first-match: true
id: nagli-redirection-catcher
info:
  author: reewardius
  name: Nagli Url Redirection Template Via Params
  reference: https://twitter.com/naglinagli/status/1316671412686462976
  severity: low
  tags: fuzzing-redirect,fuzzing-req,dast
