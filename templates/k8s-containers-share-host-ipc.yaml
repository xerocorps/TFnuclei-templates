code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .items[]
    name: items
    type: json
  source: kubectl get pods --all-namespaces --output=json
flow: "code(1);\nfor (let pod of template.items) {\n  set(\"pod\",pod)\n  javascript(1);\n\
  }\n"
id: k8s-containers-share-host-ipc
info:
  author: princechaddha
  description: Checks if any containers in Kubernetes Pods are configured to share
    the host's IPC namespace, which can lead to security risks.
  impact: 'Sharing the host''s IPC namespace allows containers to access data across
    all containers on the same host, posing potential security risks.

    '
  metadata:
    max-request: 2
  name: Containers sharing host IPC namespace
  reference:
  - https://kubernetes.io/docs/tasks/configure-pod-container/security-context/
  remediation: Ensure that no container in Kubernetes Pods is set to share the host
    IPC namespace. Configure 'spec.hostIPC' to 'false' for all pods to isolate IPC
    namespaces.
  severity: critical
  tags: cloud,devops,kubernetes,k8s,devsecops,pods,k8s-cluster-security
javascript:
- code: "pod = JSON.parse(template.pod);\nif (pod.spec.hostIPC) {\n  let result =\
    \ (`Pod '${pod.metadata.name}' in namespace '${pod.metadata.namespace}' is configured\
    \ to share the host IPC namespace.`);\n  Export(result);\n}\n"
  extractors:
  - dsl:
    - response
    type: dsl
self-contained: true
