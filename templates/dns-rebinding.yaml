dns:
- extractors:
  - group: 1
    name: IPv4
    part: answer
    regex:
    - IN.*A.(\s)*(127\.0\.0\.1|10\.\d{1,3}\.\d{1,3}\.\d{1,3}|172\.(1[6-9]|2\d|3[0-1])\.\d{1,3}\.\d{1,3}|192\.168\.\d{1,3}\.\d{1,3})(127\.0\.0\.1|\b10\.\d{1,3}\.\d{1,3}\.\d{1,3}\b|172\.(1[6-9]|2\d|3[0-1])\.\d{1,3}\.\d{1,3}|192\.168\.\d{1,3}\.\d{1,3})
    type: regex
  matchers:
  - part: answer
    regex:
    - IN.*A.(\s)*(127\.0\.0\.1|10\.\d{1,3}\.\d{1,3}\.\d{1,3}|172\.(1[6-9]|2\d|3[0-1])\.\d{1,3}\.\d{1,3}|192\.168\.\d{1,3}\.\d{1,3})(127\.0\.0\.1|\b10\.\d{1,3}\.\d{1,3}\.\d{1,3}\b|172\.(1[6-9]|2\d|3[0-1])\.\d{1,3}\.\d{1,3}|192\.168\.\d{1,3}\.\d{1,3})$
    type: regex
  name: '{{FQDN}}'
  type: A
- extractors:
  - group: 1
    name: IPv6_Compressed
    part: answer
    regex:
    - IN.+A.+(fd([0-9a-fA-F]{2}):([0-9a-fA-F]{0,4}:){0,5}(:[0-9a-fA-F]{0,4}){1,2}(:)?)$
    type: regex
  - group: 1
    name: IPv6
    part: answer
    regex:
    - IN.+A.+(fd([0-9a-fA-F]{2}):([0-9a-fA-F]{1,4}:){0,5}([0-9a-fA-F]{1,4}:){1,2}[0-9a-fA-F]{1,4})$
    type: regex
  matchers:
  - part: answer
    regex:
    - IN.+A.+(fd([0-9a-fA-F]{2}):([0-9a-fA-F]{0,4}:){0,5}(:[0-9a-fA-F]{0,4}){1,2}(:)?)$
    type: regex
  - part: answer
    regex:
    - IN.+A.+(fd([0-9a-fA-F]{2}):([0-9a-fA-F]{1,4}:){0,5}([0-9a-fA-F]{1,4}:){1,2}[0-9a-fA-F]{1,4})$
    type: regex
  name: '{{FQDN}}'
  type: AAAA
id: dns-rebinding
info:
  author: ricardomaia
  description: 'Detects DNS Rebinding attacks by checking if the DNS response contains
    a private IPv4 or IPv6 address.

    '
  name: DNS Rebinding Attack
  reference:
  - https://capec.mitre.org/data/definitions/275.html
  - https://payatu.com/blog/dns-rebinding/
  - https://heimdalsecurity.com/blog/dns-rebinding/
  severity: unknown
  tags: redirect,dns,network
