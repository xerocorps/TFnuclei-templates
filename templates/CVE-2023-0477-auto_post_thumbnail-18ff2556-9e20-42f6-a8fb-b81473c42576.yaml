http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - auto-post-thumbnail
  - dsl:
    - compare_versions(version, '<= 3.9.15')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/auto-post-thumbnail/readme.txt'
  redirects: true
id: CVE-2023-0477-auto_post_thumbnail-18ff2556-9e20-42f6-a8fb-b81473c42576
info:
  author: topscoder
  classification:
    cve-id: CVE-2023-0477
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
  description: 'The Auto Featured Image (Auto Post Thumbnail) plugin for WordPress
    is vulnerable to Arbitrary File Upload due to insufficient file type validation
    in versions up to, and including, 3.9.15. This allows authenticated users with
    author-level permissions to upload arbitrary files from remote sources onto the
    affected site''s server which may make remote code execution possible.

    '
  metadata:
    fofa-query: wp-content/plugins/auto-post-thumbnail/
    google-query: inurl:"/wp-content/plugins/auto-post-thumbnail/"
    shodan-query: http.html:"wp-content/plugins/auto-post-thumbnail/"
  name: 'Auto Featured Image (Auto Post Thumbnail) <= 3.9.15 - Authenticated (Author+)
    Arbitrary File Upload

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/18ff2556-9e20-42f6-a8fb-b81473c42576?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,auto-post-thumbnail,low,production
