info:
  author: OpenAI
  classification:
    country: any
    tags:
    - elasticsearch
    - security
    - configuration
    - high
  description: Template to detect Elasticsearch installations with insecure default
    configurations
  id: elasticsearch-insecure-default-config
  matcher-condition: or
  matchers:
  - description: Single-node discovery mode found in Elasticsearch configuration
    pattern: discovery.type=single-node
    type: body
  name: Elasticsearch Insecure Default Configuration - Detect
  reference:
  - https://www.elastic.co/guide/en/elasticsearch/reference/7.x/security-settings.html
  requests:
    condition: and
    description: Attempt to retrieve plugin information
    method: GET
    path:
    - /_cat/plugins?v&s=component&h=name,component,version,description,elasticsearch_version
  response:
  - status:
    - 200
  severity: High
