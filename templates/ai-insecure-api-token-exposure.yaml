http:
- extractors:
  - name: api_token
    part: body
    regex:
    - (?i)(API_KEY|SECRET_KEY|TOKEN)=[a-zA-Z0-9]{20,}
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    regex:
    - (?i)API_KEY=[a-zA-Z0-9]{20,}
    - (?i)SECRET_KEY=[a-zA-Z0-9]{20,}
    - (?i)TOKEN=[a-zA-Z0-9]{20,}
    type: regex
  - condition: or
    part: body
    type: word
    words:
    - API_KEY
    - SECRET_KEY
    - TOKEN
    - AWS_ACCESS_KEY
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/.env'
  - '{{BaseURL}}/config.json'
  - '{{BaseURL}}/api/config'
  - '{{BaseURL}}/settings.yaml'
id: ai-insecure-api-token-exposure
info:
  author: xai
  description: Identifies exposed API tokens or keys in configuration files or responses.
  name: Detect Insecure API Token Exposure
  severity: critical
  tags: api
