http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '8.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - stacks
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/stacks/stacks.info'
  redirects: true
id: drupal_module-stacks-arbitrary-php-code-execution
info:
  author: Bishopfox
  description: This module enables content editors to create complex pages and layouts
    on the fly without the help from a developer, using reusable widgets. The module
    does not sufficiently filter values posted to its AJAX endpoint, which leads to
    the instantiation of an arbitrary PHP class. This vulnerability is mitigated by
    the fact that only sites with the Stacks - Content Feed submodule enabled are
    affected.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/stacks/
    google-query: inurl:'/sites/all/modules/stacks/
    impact: medium
    security-risk: "Critical 18\u221525 AC:None/A:None/CI:Some/II:Some/E:Theoretical/TD:All"
    type: indicator
    vulnerability: arbitrary-php-code-execution
  name: drupal_module-stacks-arbitrary-php-code-execution
  reference:
  - https://www.drupal.org/sa-contrib-2018-001
  severity: medium
  tags: drupal
