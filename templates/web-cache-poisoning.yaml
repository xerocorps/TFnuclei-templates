http:
- matchers:
  - status:
    - 200
    type: status
  - part: interactsh_protocol
    type: word
    words:
    - dns
  matchers-condition: and
  raw:
  - 'GET {{Path}} HTTP/1.1

    Host: {{Hostname}}

    X-Forwarded-Host: {{interactsh-url}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
    like Gecko) Chrome/96.0.4664.45 Safari/537.36

    '
- matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - test.com
  matchers-condition: and
  raw:
  - 'GET {{Path}} HTTP/1.1

    Host: {{Hostname}}

    X-Forwarded-Host: test.com

    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
    like Gecko) Chrome/96.0.4664.45 Safari/537.36

    '
id: web-cache-poisoning
info:
  author: RosePwns
  description: 'This web application is using a caching system. By sending a request
    with a X-Forwarded-Host header, we can overide the Host header and force the caching
    system to cache a response that contains a redirect to our server.

    '
  impact: 'Allows attacks to ptentially server harmful HTTP responses to other users.

    '
  metadata:
    verified: false
  name: Web Cache Poisoning via Host Header
  severity: high
  tags: web,cache,poisioning,headers
