file:
- extensions:
  - all
  matchers:
  - condition: or
    regex:
    - require\('serialize-javascript'\)
    - '\$S\(\.\*?, \{unsafe: true\}\)'
    type: regex
  - condition: or
    negative: true
    regex:
    - escape\(.*?\)
    - encodeURI\(.*?\)
    type: regex
id: xss-serialize-javascript
info:
  author: me_dheeraj (https://twitter.com/Dheerajmadhukar)
  description: Untrusted user input reaching `serialize-javascript` with `unsafe`
    attribute can cause Cross Site Scripting (XSS).
  name: XSS Serialize Javascript
  severity: info
  tags: file,nodejs,serialize,xss
