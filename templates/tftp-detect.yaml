id: tftp-detect
info:
  author: pussycat0x
  description: 'Detect TFTP Service.

    '
  metadata:
    shodan-query: port:69
    verified: true
  name: TFTP Service - Detection
  severity: info
  tags: js,tftp,udp,network
javascript:
- args:
    Host: '{{Host}}'
    Port: 69
  code: 'let packet = bytes.NewBuffer();

    let message = "1.txt"

    let data = message;

    packet.WriteString(data)

    let c = require("nuclei/net");

    let conn = c.Open(''udp'', `${Host}:${Port}`);

    conn.SendHex(packet.Hex());

    let resp = conn.RecvString(256);

    resp;

    '
  matchers:
  - type: word
    words:
    - Unknown transfer ID
