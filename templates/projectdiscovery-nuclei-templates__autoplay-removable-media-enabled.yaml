code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'DisableAutoplay : 0'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'Get-ItemProperty -Path ''HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers''
    -Name ''DisableAutoplay''

    '
id: autoplay-removable-media-enabled
info:
  author: princechaddha
  description: Checks if AutoPlay is enabled for removable media, which can automatically
    execute malicious software.
  impact: 'Enabling AutoPlay may allow the automatic execution of malware from external
    devices, increasing the attack surface.

    '
  name: AutoPlay Enabled for Removable Media
  remediation: 'Disable AutoPlay for all removable media to mitigate potential security
    threats.

    '
  severity: medium
  tags: windows,autoplay,removable-media,code,windows-audit
self-contained: true
