http:
- matchers:
  - status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - '"mbean":"Users:database=UserDatabase,type=UserDatabase"'
    - '"users":'
  - negative: true
    part: body
    type: word
    words:
    - '"users":[]'
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/jolokia/read/Users:database=UserDatabase,type=UserDatabase'
  - '{{BaseURL}}/actuator/jolokia/read/Users:database=UserDatabase,type=UserDatabase'
  stop-at-first-match: true
id: jolokia-tomcat-creds-leak
info:
  author: pathtaga
  description: Tomcat's credential disclosure leading to Remote Code Execution via
    WAR upload.
  name: Jolokia <= 1.7.1 Information Leakage
  reference:
  - https://github.com/laluka/jolokia-exploitation-toolkit/blob/main/exploits/info-leak-tomcat-creds.py
  - https://therealcoiffeur.github.io/c11011
  severity: critical
  tags: jolokia,tomcat,exposure,vuln
