http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - woocommerce-for-japan
  - dsl:
    - compare_versions(version, '< 2.6.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/woocommerce-for-japan/readme.txt'
  redirects: true
id: CVE-2023-47698
info:
  author: topscoder
  classification:
    cve-id: CVE-2023-47698
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 6.5
  description: 'The Japanized For WooCommerce plugin for WordPress is vulnerable to
    unauthorized access and modification due to missing capability checks on several
    functions called via REST API function in versions up to, and including, 2.6.4.
    This makes it possible for unauthenticated attackers to perform a wide variety
    of actions such as updating the plugin''s settings and retrieving information
    about settings.

    '
  metadata:
    fofa-query: wp-content/plugins/woocommerce-for-japan/
    google-query: inurl:"/wp-content/plugins/woocommerce-for-japan/"
    shodan-query: vuln:CVE-2023-47698
  name: 'Japanized For WooCommerce <= 2.6.4 - Missing Authorization

    '
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/0fc675e8-8ba1-40b0-829e-7a48d5eb586d?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,woocommerce-for-japan,medium
