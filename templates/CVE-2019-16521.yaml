http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - broken-link-checker
  - dsl:
    - compare_versions(version, '< 1.11.9')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/broken-link-checker/readme.txt'
  redirects: true
id: CVE-2019-16521
info:
  author: topscoder
  classification:
    cve-id: CVE-2019-16521
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
  description: 'The Broken Link Checker plugin through 1.11.8 for WordPress is susceptible
    to Reflected XSS due to improper encoding and insertion of an HTTP GET parameter
    into HTML. The filter function on the page listing all detected broken links can
    be exploited by providing an XSS payload in the s_filter GET parameter in a filter_id=search
    request. NOTE: this is an end-of-life product.'
  metadata:
    fofa-query: wp-content/plugins/broken-link-checker/
    google-query: inurl:"/wp-content/plugins/broken-link-checker/"
    shodan-query: vuln:CVE-2019-16521
  name: Broken Link Checker <= 1.11.8 - Reflected Cross-Site Scripting
  reference:
  - https://wordpress.org/plugins/broken-link-checker/#developers
  - https://github.com/sbaresearch/advisories/tree/public/2019/SBA-ADV-20190913-02_WordPress_Plugin_Broken_Link_Checker
  - http://www.openwall.com/lists/oss-security/2019/10/16/3
  - https://wpvulndb.com/vulnerabilities/9917
  - https://nvd.nist.gov/vuln/detail/CVE-2019-16521
  severity: medium
  tags: cve,wordpress,wp-plugin,broken-link-checker,medium
