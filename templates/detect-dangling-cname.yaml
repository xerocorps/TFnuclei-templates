dns:
- class: inet
  extractors:
  - group: 1
    regex:
    - "IN\tCNAME\t(.+)"
    type: regex
  matchers:
  - type: word
    words:
    - NXDOMAIN
  - type: word
    words:
    - "IN\tCNAME"
  matchers-condition: and
  name: '{{FQDN}}'
  recursion: true
  retries: 3
  type: A
id: detect-dangling-cname
info:
  author: pdteam,nytr0gen
  name: Detect Dangling cname
  reference: '- https://securitytrails.com/blog/subdomain-takeover-tips

    - https://nominetcyber.com/dangling-dns-is-no-laughing-matter/

    - https://nabeelxy.medium.com/dangling-dns-records-are-a-real-vulnerability-361f2a29d37f

    - https://docs.microsoft.com/en-us/azure/security/fundamentals/subdomain-takeover

    '
  severity: info
  tags: dns,takeover
