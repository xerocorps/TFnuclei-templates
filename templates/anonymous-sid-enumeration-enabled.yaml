code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'everyoneincludesanonymous : 1'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'Get-ItemProperty -Path ''HKLM:\SYSTEM\CurrentControlSet\Control\Lsa'' -Name
    ''EveryoneIncludesAnonymous''

    '
id: anonymous-sid-enumeration-enabled
info:
  author: princechaddha
  description: Checks if anonymous users can enumerate Security Identifiers (SIDs).
  impact: 'Allowing anonymous SID enumeration can expose user account details and
    increase the risk of unauthorized access.

    '
  name: Anonymous SID Enumeration Enabled
  remediation: 'Restrict anonymous access to SID enumeration to enhance security.

    '
  severity: medium
  tags: windows,code,windows-audit
self-contained: true
