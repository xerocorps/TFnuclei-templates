http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '5.0')
    - compare_versions(version_by_js, '5.0')
    - compare_versions(version_by_css, '5.0')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2018-20149-wordpress-4df635b8-4c56-4b24-8446-8e39e6fe7441
info:
  author: topscoder
  classification:
    cve-id: CVE-2018-20149
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 6.4
  description: 'In WordPress before 4.9.9 and 5.x before 5.0.1, when the Apache HTTP
    Server is used, authors could upload crafted files that bypass intended MIME type
    restrictions, leading to XSS, as demonstrated by a .jpg file without JPEG data.

    '
  metadata:
    shodan-query: vuln:CVE-2018-20149
  name: 'WordPress Core < 5.0.1 - Stored Cross-Site Scripting via File Uploads

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/4df635b8-4c56-4b24-8446-8e39e6fe7441?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-core,medium,production
