code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - SHUTDOWN_WITHOUT_LOGON_ENABLED
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: "$regPath = \"HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\policies\\\
    system\"\n$shutdownValue = (Get-ItemProperty -Path $regPath -Name ShutdownWithoutLogon\
    \ -ErrorAction SilentlyContinue).ShutdownWithoutLogon\nif ($shutdownValue -eq\
    \ 0) {\n    \"SHUTDOWN_WITHOUT_LOGON_DISABLED\"\n} else {\n    \"SHUTDOWN_WITHOUT_LOGON_ENABLED\"\
    \n}\n"
id: shutdown-without-logon
info:
  author: nukunga[SungHyunJeon]
  description: 'Ensure the "Shutdown Without Logon" policy is disabled by confirming
    that the ShutdownWithoutLogon registry value is set to 0. If enabled, the system
    permits shutdown from the logon screen, increasing the risk of unauthorized shutdowns.

    '
  impact: 'When enabled, this setting permits unauthorized users to shut down the
    system without logging in, which can lead to service interruptions.

    '
  name: Shutdown Without Logon Check
  reference:
  - https://isms.kisa.or.kr/main/csap/notice/?boardId=bbs_0000000000000004&mode=view&cntId=85
  remediation: 'Disable this policy by setting the ShutdownWithoutLogon registry value
    to 0 at:

    - HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System

    - Alternatively, configure the setting through the Local Security Policy.

    '
  severity: medium
  tags: code,windows-audit,kisa,registry
self-contained: true
