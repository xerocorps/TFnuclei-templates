http:
- extractors:
  - group: 1
    regex:
    - <h1>RouterOS (.+)</h1>
    - <div class="top">mikrotik routeros (.[0-9.]+) configuration page</div>
    - 'routeros (.[0-9.]+) '
    - <b>MikroTik RouterOS (.[0-9.]+)</b>
    type: regex
  matchers:
  - condition: and
    type: word
    words:
    - If this device is not in your possession, please contact your local network
      administrator
    - .mikrotik.com
  - condition: or
    name: router-old
    part: body
    type: word
    words:
    - <title>mikrotik routeros > administration</title>
    - <title>Mikrotik Router
    - <img src="/webcfg/
    - <title>MikroTik RouterOS Managing Webpage</title>
  - condition: and
    name: hotspot
    part: body
    type: word
    words:
    - Please log on to use the mikrotik hotspot service
    - mikrotik hotspot > login
  - name: mikrotik-httpproxy
    part: header
    type: word
    words:
    - 'Server: mikrotik httpproxy'
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
id: mikrotik-routeros
info:
  author: gy741
  classification:
    cpe: cpe:2.3:o:mikrotik:routeros:*:*:*:*:*:*:*:*
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    cwe-id: CWE-200
  description: MikroTik Router OS login panel was detected.
  metadata:
    fofa-query: title="mikrotik routeros > administration"
    google-query: intitle:"mikrotik routeros > administration"
    max-request: 1
    product: routeros
    shodan-query: http.title:"mikrotik routeros > administration"
    vendor: mikrotik
  name: MikroTik Router OS Login Panel - Detect
  reference:
  - https://systemweakness.com/routeros-user-with-just-ftp-policy-can-write-to-filesystem-cve-2021-27221-e3e45d780dfe
  severity: info
  tags: panel,login,mikrotik,discovery
