http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - APP_NAME=
    - APP_DEBUG=
    - DB_PASSWORD=
  - part: header
    type: word
    words:
    - application/octet-stream
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/.env'
id: CVE-2017-16894
info:
  author: j4vaovo
  classification:
    cpe: cpe:2.3:a:laravel:laravel:*:*:*:*:*:*:*:*
    cve-id: CVE-2017-16894
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-200
    epss-percentile: 0.99489
    epss-score: 0.88787
  description: 'Laravel through 5.5.21 is susceptible to information disclosure. An
    attacker can obtain sensitive information such as externally usable passwords
    via a direct request for the /.env URI. NOTE: CVE pertains only to the writeNewEnvironmentFileWith
    function in src/Illuminate/Foundation/Console/KeyGenerateCommand.php, which uses
    file_put_contents without restricting .env permissions. The .env filename is not
    used exclusively by Laravel.

    '
  impact: 'An attacker can exploit this vulnerability to gain sensitive information
    from the application.

    '
  metadata:
    fofa-query:
    - app="Laravel-Framework"
    - app="laravel-framework"
    max-request: 1
    product: laravel
    shodan-query:
    - Laravel-Framework
    - cpe:"cpe:2.3:a:laravel:laravel"
    - laravel-framework
    vendor: laravel
    verified: true
  name: Laravel <5.5.21 - Information Disclosure
  reference:
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16894
  - https://packetstormsecurity.com/files/cve/CVE-2017-16894
  - http://whiteboyz.xyz/laravel-env-file-vuln.html
  - https://twitter.com/finnwea/status/967709791442341888
  - https://nvd.nist.gov/vuln/detail/CVE-2017-16894
  remediation: 'Upgrade Laravel to version 5.5.21 or higher to fix the information
    disclosure vulnerability.

    '
  severity: high
  tags: cve,cve2017,laravel,exposure,packetstorm,vkev,vuln
