http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-ses
  - dsl:
    - compare_versions(version, '<= 1.4.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-ses/readme.txt'
  redirects: true
id: CVE-2021-24494-wp_ses-132a6661-c21b-4ba6-955a-2c905425de6a
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24494
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
  description: 'The WP Offload SES Lite WordPress plugin before 1.4.5 did not escape
    some of the fields in the Activity page of the admin dashboard, such as the email''s
    id, subject and recipient, which could lead to Stored Cross-Site Scripting issues
    when an attacker can control any of these fields, like the subject when filling
    a contact form for example. The XSS will be executed in the context of a logged
    in admin viewing the Activity tab of the plugin.

    '
  metadata:
    fofa-query: wp-content/plugins/wp-ses/
    google-query: inurl:"/wp-content/plugins/wp-ses/"
    shodan-query: http.html:"wp-content/plugins/wp-ses/"
  name: 'WP Offload SES Lite <= 1.4.4 - Stored Cross-Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/132a6661-c21b-4ba6-955a-2c905425de6a?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,wp-ses,medium,production
