code:
- engine:
  - bash
  matchers:
  - part: response
    type: word
    words:
    - '[VULNERABLE]'
  source: "if grep -q -E '^ftp:' /etc/passwd; then\n    echo \"[VULNERABLE] FTP user\
    \ exists in /etc/passwd\"\nelse\n    echo \"[SAFE] No FTP user found in /etc/passwd\"\
    \nfi\n\n# Check vsftpd anonymous login\nif grep -q -i 'anonymous_enable.*yes'\
    \ /etc/vsftpd/vsftpd.conf 2>/dev/null; then\n    echo \"[VULNERABLE] anonymous_enable=YES\
    \ in vsftpd.conf\"\nelse\n    echo \"[SAFE] Anonymous login disabled in vsftpd.conf\"\
    \nfi\n\n# Check proftpd anonymous login\nif grep -q -i 'UserAlias.*anonymous'\
    \ /etc/proftpd/proftpd.conf 2>/dev/null; then\n    echo \"[VULNERABLE] UserAlias\
    \ anonymous in proftpd.conf\"\nelse\n    echo \"[SAFE] Anonymous login disabled\
    \ in proftpd.conf\"\nfi\n"
id: linux-anonymous-ftp-enabled
info:
  author: songyaeji
  description: 'FTP account allows malicious users to exploit it to log in anonymously
    and write to directories, potentially gaining unauthorized access or executing
    local exploits.This template checks for signs of anonymous FTP being enabled via
    /etc/passwd, vsFTPD, or ProFTPD configuration files.

    '
  metadata:
    verified: true
  name: Linux Anonymous FTP Access Enabled
  reference:
  - https://isms.kisa.or.kr
  severity: high
  tags: linux,local,kisa,audit,ftp,anonymous,local
self-contained: true
