http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 5.1', '<= 5.1.9')
    - compare_versions(version_by_js, '>= 5.1', '<= 5.1.9')
    - compare_versions(version_by_css, '>= 5.1', '<= 5.1.9')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2021-29450
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-29450
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 6.5
  description: Wordpress is an open source CMS. One of the blocks in the WordPress
    editor can be exploited in a way that exposes password-protected posts and pages.
    This requires at least contributor privileges. This has been patched in WordPress
    5.7.1, along with the older affected versions via minor releases. It's strongly
    recommended that you keep auto-updates enabled to receive the fix.
  metadata:
    shodan-query: vuln:CVE-2021-29450
  name: WordPress Core < 5.7.1 - Sensitive Information Disclosure
  reference:
  - https://wordpress.org/news/category/security/
  - https://github.com/WordPress/wordpress-develop/security/advisories/GHSA-pmmh-2f36-wvhq
  - https://lists.debian.org/debian-lts-announce/2021/04/msg00017.html
  - https://www.debian.org/security/2021/dsa-4896
  severity: medium
  tags: cve,wordpress,wp-core,medium
