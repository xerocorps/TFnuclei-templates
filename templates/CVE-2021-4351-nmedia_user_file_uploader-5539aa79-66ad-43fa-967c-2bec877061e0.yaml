http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - nmedia-user-file-uploader
  - dsl:
    - compare_versions(version, '< 18.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/nmedia-user-file-uploader/readme.txt'
  redirects: true
id: CVE-2021-4351-nmedia_user_file_uploader-5539aa79-66ad-43fa-967c-2bec877061e0
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-4351
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N
    cvss-score: 5.8
  description: 'The Frontend File Manager plugin for WordPress is vulnerable to Unauthenticated
    Post Meta Change in versions up to, and including, 18.2. This is due to lacking
    authentication protections, capability checks, and sanitization, all on the wpfm_file_meta_update
    AJAX action. This makes it possible for unauthenticated attackers to change the
    meta data of certain posts and pages.

    '
  metadata:
    fofa-query: wp-content/plugins/nmedia-user-file-uploader/
    google-query: inurl:"/wp-content/plugins/nmedia-user-file-uploader/"
    shodan-query: http.html:"wp-content/plugins/nmedia-user-file-uploader/"
  name: 'Frontend File Manager <= 18.2 - Unauthenticated Post Meta Change

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/5539aa79-66ad-43fa-967c-2bec877061e0?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,nmedia-user-file-uploader,medium,production
