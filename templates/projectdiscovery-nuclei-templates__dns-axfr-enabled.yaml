code:
- engine:
  - bash
  extractors:
  - group: 1
    regex:
    - SOA\s+([^\s]+)
    type: regex
  matchers:
  - condition: and
    regex:
    - 'XFR size: [1-9][0-9]* records?'
    type: regex
  source: 'domain=$Host

    dig axfr $domain @$(dig $domain ns +short | head -n1)

    '
id: dns-axfr-enabled
info:
  author: matejsmycka
  description: 'Checks if particular domain can be queried via DNS Zone Transfer (AXFR).
    An open zone transfer can disclose all DNS records for a zone, leading to information
    leakage.

    '
  metadata:
    shodan-query: port:53
    verified: true
  name: DNS Zone Transfer Check (AXFR)
  reference:
  - https://beaglesecurity.com/blog/vulnerability/dns-zone-transfer.html
  severity: medium
  tags: dns,tcp,axfr,code
