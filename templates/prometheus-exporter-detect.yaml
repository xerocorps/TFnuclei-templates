id: prometheus-exporter-detect
info:
  author: jarijaas
  description: Prometheus exporter detector
  name: Prometheus exporter detect
  reference: https://github.com/prometheus/prometheus/wiki/Default-port-allocations
  severity: info
  tags: panel
requests:
- extractors:
  - group: 1
    name: exporter_name
    part: body
    regex:
    - <title>(.*?)</title>
    type: regex
  headers:
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101
      Firefox/55
  matchers:
  - condition: and
    type: word
    words:
    - Exporter
    - /metrics
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
