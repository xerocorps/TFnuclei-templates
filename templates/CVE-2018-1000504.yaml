http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - redirection
  - dsl:
    - compare_versions(version, '<= 2.7.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/redirection/readme.txt'
  redirects: true
id: CVE-2018-1000504
info:
  author: topscoder
  classification:
    cve-id: CVE-2018-1000504
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
  description: Redirection version 2.7.3 contains a ACE via file inclusion vulnerability
    in Pass-through mode that can result in allows admins to execute any PHP file
    in the filesystem. This attack appear to be exploitable via Attacker must be have
    access to an admin account on the target site. This vulnerability appears to have
    been fixed in 2.8.
  metadata:
    fofa-query: wp-content/plugins/redirection/
    google-query: inurl:"/wp-content/plugins/redirection/"
    shodan-query: vuln:CVE-2018-1000504
  name: Redirection <= 2.7.3 - Local File Inclusion
  reference:
  - https://advisories.dxw.com/advisories/ace-file-inclusion-redirection/
  - https://seclists.org/fulldisclosure/2018/Jun/29
  severity: high
  tags: cve,wordpress,wp-plugin,redirection,high
