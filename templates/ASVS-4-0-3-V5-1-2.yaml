http:
- attack: clusterbomb
  extractors:
  - part: body
    regex:
    - key="(?P<key>[^"]+)",value="(?:\\")?(?P<value>[^"\\]+)(?:\\")?"
    type: regex
  matchers:
  - part: body
    type: word
    words:
    - '{{key}}'
  - part: body
    type: word
    words:
    - '{{value}}'
  matchers-condition: or
  payloads:
    key: assets/keysList.txt
    value: assets/valuesList.txt
  raw:
  - 'POST {{Path}} HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json

    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
    like Gecko) Chrome/134.0.0.0 Safari/537.36 Edg/134.0.0.0


    { "{{key}}": {{value}}}

    '
id: ASVS-4-0-3-V5-1-2
info:
  author: Masoud Abdaal
  classification:
    cwe-id: CWE-915
  description: 'Verify that frameworks protect against mass parameter assignment attacks,
    or that the application has countermeasures to protect against unsafe parameter
    assignment, such as marking fields private or similar.

    Require Switch: -lfa (Load File Wordlist)

    '
  name: ASVS 5.1.2 Check
  reference:
  - https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v51-input-validation
  - https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/20-Testing_for_Mass_Assignment
  severity: high
  tags: asvs,5.1.2
