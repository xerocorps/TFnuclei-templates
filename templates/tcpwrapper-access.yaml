code:
- engine:
  - sh
  - bash
  source: "echo \"[*] Checking /etc/hosts.deny (default deny policy)\"\nif grep -Eq\
    \ \"^[[:space:]]*ALL:[[:space:]]*ALL\" /etc/hosts.deny; then\n  echo \"[SAFE]\
    \ /etc/hosts.deny has ALL:ALL policy\"\nelse\n  echo \"[VULNERABLE] /etc/hosts.deny\
    \ is missing ALL:ALL (default deny)\"\nfi\n"
- engine:
  - sh
  - bash
  matchers:
  - name: hosts.deny
    part: code_1_response
    type: word
    words:
    - '[VULNERABLE]'
  - name: sshd
    part: code_2_response
    type: word
    words:
    - '[VULNERABLE]'
  source: "echo \"[*] Checking sshd allow policy in /etc/hosts.allow\"\nif grep -Eq\
    \ \"^[[:space:]]*sshd\" /etc/hosts.allow; then\n  if grep -Eq \"^[[:space:]]*sshd:[[:space:]]*ALL\"\
    \ /etc/hosts.allow; then\n    echo \"[VULNERABLE] sshd allows ALL hosts (too permissive)\"\
    \n  else\n    echo \"[SAFE] sshd-specific allow policy found with restrictions\"\
    \n  fi\nelse\n  echo \"[VULNERABLE] No sshd-specific allow policy found\"\nfi\n"
id: tcpwrapper-access
info:
  author: songyaeji
  description: 'Checked if IP and port restrictions were properly applied using TCP
    Wrapper (/etc/hosts.allow and /etc/hosts.deny). Reported systems as vulnerable
    if unrestricted remote access (e.g. Telnet, RSH, SSH) was possible.

    '
  name: TCP Wrapper Access Control Check
  reference:
  - https://isms.kisa.or.kr
  severity: low
  tags: linux,local,audit,kisa,compliance
self-contained: true
