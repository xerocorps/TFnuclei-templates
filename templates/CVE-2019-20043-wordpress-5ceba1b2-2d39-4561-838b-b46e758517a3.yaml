http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '5.3')
    - compare_versions(version_by_js, '5.3')
    - compare_versions(version_by_css, '5.3')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2019-20043-wordpress-5ceba1b2-2d39-4561-838b-b46e758517a3
info:
  author: topscoder
  classification:
    cve-id: CVE-2019-20043
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 4.3
  description: 'In in wp-includes/rest-api/endpoints/class-wp-rest-posts-controller.php
    in WordPress 3.7 to 5.3.0, authenticated users who do not have the rights to publish
    a post are able to mark posts as sticky or unsticky via the REST API. For example,
    the contributor role does not have such rights, but this allowed them to bypass
    that. This has been patched in WordPress 5.3.1, along with all the previous WordPress
    versions from 3.7 to 5.3 via a minor release.

    '
  metadata:
    shodan-query: vuln:CVE-2019-20043
  name: 'WordPress Core < 5.3.1 - Authorization Bypass

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/5ceba1b2-2d39-4561-838b-b46e758517a3?source=api-prod
  severity: low
  tags: cve,wordpress,wp-core,low,production
