http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - themeisle-companion
  - dsl:
    - compare_versions(version, '< 2.10.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/themeisle-companion/readme.txt'
  redirects: true
id: CVE-2021-24158-0db3114ddc4fe4a5970d908e7193659c
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24158
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 9.9
  description: 'Orbit Fox by ThemeIsle has a feature to add a registration form to
    both the Elementor and Beaver Builder page builders functionality. As part of
    the registration form, administrators can choose which role to set as the default
    for users upon registration. This field is hidden from view for lower-level users,
    however, they can still supply the user_role parameter to update the default role
    for registration.

    '
  metadata:
    fofa-query: wp-content/plugins/themeisle-companion/
    google-query: inurl:"/wp-content/plugins/themeisle-companion/"
    shodan-query: vuln:CVE-2021-24158
  name: 'Orbit Fox by ThemeIsle <= 2.10.2 - Authenticated Privilege Escalation

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/53c9d3d0-5fea-4e36-b356-8d3c0e672cac?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,themeisle-companion,low
