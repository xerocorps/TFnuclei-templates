http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - n5-uploadform
  - dsl:
    - compare_versions(version, '<= 1.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/n5-uploadform/readme.txt'
  redirects: true
id: CVE-2021-24223-n5_uploadform-121afcc4-754c-4f4b-8b02-9b5a4a248041
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24223
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The N5 Upload Form WordPress plugin through 1.0 suffers from an arbitrary
    file upload issue in page where a Form from the plugin is embed, as any file can
    be uploaded. The uploaded filename might be hard to guess as it''s generated with
    md5(uniqid(rand())), however, in the case of misconfigured servers with Directory
    listing enabled, accessing it is trivial.

    '
  metadata:
    fofa-query: wp-content/plugins/n5-uploadform/
    google-query: inurl:"/wp-content/plugins/n5-uploadform/"
    shodan-query: http.html:"wp-content/plugins/n5-uploadform/"
  name: 'N5 Upload Form <= 1.0 - Arbitrary File Upload

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/121afcc4-754c-4f4b-8b02-9b5a4a248041?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,n5-uploadform,critical,production
