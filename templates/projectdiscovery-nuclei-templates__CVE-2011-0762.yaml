id: CVE-2011-0762
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:vsftpd_project:vsftpd:*:*:*:*:*:*:*:*
    cve-id: CVE-2011-0762
    cvss-metrics: CVSS:2.0/AV:N/AC:L/Au:S/C:N/I:N/A:P
    cvss-score: 4
    cwe-id: CWE-400
    epss-percentile: 0.97466
    epss-score: 0.45278
  description: 'The vsf_filename_passes_filter function in ls.c in vsftpd before 2.3.3
    allows remote authenticated users to cause a denial of service (CPU consumption
    and process slot exhaustion) via crafted glob expressions in STAT commands in
    multiple FTP sessions, a different vulnerability than CVE-2010-2632.

    '
  impact: 'Authenticated attackers can send crafted glob expressions in STAT commands
    across multiple FTP sessions to cause CPU consumption and process slot exhaustion,
    leading to denial of service on vsftpd servers.

    '
  metadata:
    max-request: 1
    product: vsftpd
    shodan-query:
    - vsftpd
    - product:"vsftpd"
    vendor: vsftpd_project
    verified: true
  name: vsftpd < 2.3.3 - DoS
  reference:
  - ftp://vsftpd.beasts.org/users/cevans/untar/vsftpd-2.3.4/Changelog
  - http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=622741
  - http://cxib.net/stuff/vspoc232.c
  - http://jvn.jp/en/jp/JVN37417423/index.html
  - http://lists.fedoraproject.org/pipermail/package-announce/2011-March/055881.html
  remediation: 'Update vsftpd to version 2.3.3 or later that properly handles glob
    expressions in STAT commands and prevents resource exhaustion attacks.

    '
  severity: medium
  tags: cve,cve2011,network,ftp,vsftpd,tcp,passive,vuln
tcp:
- extractors:
  - group: 1
    name: version
    regex:
    - vsFTPd ([0-9.]+)
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: 0
    type: hex
  matchers:
  - condition: and
    dsl:
    - contains(raw, 'vsFTPd')
    - compare_versions(version, '< 2.3.3')
    type: dsl
  port: 21
  read-size: 1024
