http:
- extractors:
  - json:
    - .systemParams
    name: system-params
    type: json
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, "systemParams", "lockfileEntries")
    - contains_any(body, "topLevelPatterns","linkedModules","modulesFolders")
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/node_modules/.yarn-integrity'
  - '{{BaseURL}}/.yarn-integrity'
  stop-at-first-match: true
id: yarn-integrity-disclosure
info:
  author: pussycat0x
  description: 'Detected the .yarn-integrity file generated by the Yarn package manager
    and stored in node_modules/.yarn-integrity.Exposure of this file could have revealed
    sensitive dependency information and aided attackers in identifying vulnerable
    packages for supply chain attacks.

    '
  metadata:
    verified: true
  name: Yarn Integrity File Disclosure
  reference:
  - https://classic.yarnpkg.com/lang/en/docs/yarn-lock/
  - https://github.com/yarnpkg/yarn/blob/master/src/integrity-checker.js
  severity: info
  tags: exposure,yarn,node,npm,misconfig
