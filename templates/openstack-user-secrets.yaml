id: openstack-user-secrets
info:
  author: geeknik
  name: Openstack User Secrets
  reference: https://github.com/openstack/openstack-ansible/blob/master/etc/openstack_deploy/user_secrets.yml
  severity: high
  tags: openstack,config,auth
requests:
- matchers:
  - status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - '############################# WARNING'
    - may break your OpenStack environment
    - '#NOTE: Please uncomment those'
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/user_secrets.yml'
  - '{{BaseURL}}/user_secrets.yml.old'
