code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    name: bucketname
    regex:
    - oss://([a-zA-Z0-9-]+)
    type: regex
  source: 'aliyun oss ls --region $region

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - bucket + " Access Logging for OSS Buckets is Disabled "
    type: dsl
  matchers:
  - condition: and
    type: word
    words:
    - <LoggingEnabled>
    - <TargetBucket></TargetBucket>
  source: 'aliyun oss logging --method get $bucket --region $region

    '
flow: "code(1)\nfor (let BucketName of iterate(template.bucketname)) {\n  set(\"bucket\"\
  , BucketName)\n  code(2)\n}\n"
id: access-logoss-disabled
info:
  author: DhiyaneshDK
  description: 'Disabling access logging for OSS buckets reduces the ability to monitor
    and audit access, increasing the risk of undetected unauthorized activity.

    '
  metadata:
    max-request: 2
    verified: true
  name: Access Logging for OSS Buckets - Disabled
  reference:
  - https://www.trendmicro.com/cloudoneconformity/knowledge-base/alibaba-cloud/AlibabaCloud-OSS/enable-bucket-access-logging.html
  - https://www.alibabacloud.com/help/en/oss/user-guide/getting-started
  - https://www.alibabacloud.com/help/en/oss/user-guide/enable-logging
  severity: medium
  tags: cloud,devops,aliyun,alibaba,aliyun-cloud-config,alibaba-oss
self-contained: true
variables:
  region: cn-hangzhou
