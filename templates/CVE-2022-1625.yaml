http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - new-user-approve
  - dsl:
    - compare_versions(version, '<= 2.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/new-user-approve/readme.txt'
  redirects: true
id: CVE-2022-1625
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-1625
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    cvss-score: 9.6
  description: The New User Approve WordPress plugin before 2.4.1 does not have CSRF
    check in place when updating its settings and adding invitation codes, which could
    allow attackers to add invitation codes (for bypassing the provided restrictions)
    and to change plugin settings by tricking admin users into visiting specially
    crafted websites.
  metadata:
    fofa-query: wp-content/plugins/new-user-approve/
    google-query: inurl:"/wp-content/plugins/new-user-approve/"
    shodan-query: vuln:CVE-2022-1625
  name: New User Approve <= 2.4 - Cross-Site Request Forgery
  reference:
  - https://wpscan.com/vulnerability/e1693318-900c-47f1-bb77-008b0d33327f
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2733982%40new-user-approve&new=2733982%40new-user-approve&sfp_email=&sfph_mail=
  severity: critical
  tags: cve,wordpress,wp-plugin,new-user-approve,critical
