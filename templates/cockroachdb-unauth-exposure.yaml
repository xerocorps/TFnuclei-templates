flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "<title>Cockroach Console")
    internal: true
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}'
- matchers:
  - condition: and
    dsl:
    - contains_all(body, "nodes", "ServerVersion","buildInfo")
    - status_code == 200
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/_status/nodes'
id: cockroachdb-unauth-exposure
info:
  author: pussycat0x
  description: 'Unauthenticated access to the CockroachDB console allows viewing the
    cluster nodes and server version.

    '
  metadata:
    shodan-query: product:cockroachdb
    verified: true
  name: CockroachDB Unauthenticated Console Exposure
  severity: high
  tags: cockroachdb,exposure,misconfig,unauth
