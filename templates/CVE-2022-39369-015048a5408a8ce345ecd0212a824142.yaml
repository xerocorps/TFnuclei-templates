http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - authorizer
  - dsl:
    - compare_versions(version, '< 1.6.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/authorizer/readme.txt'
  redirects: true
id: CVE-2022-39369-015048a5408a8ce345ecd0212a824142
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-39369
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8
  description: 'The phpCAS library uses HTTP headers to determine the service URL
    used to validate tickets. This allows an attacker to control the host header and
    use a valid ticket granted for any authorized service in the same SSO realm (CAS
    server) to authenticate to the service protected by phpCAS. Depending on the settings
    of the CAS server service registry in worst case this may be any other service
    URL (if the allowed URLs are configured to "^(https)://.*") or may be strictly
    limited to known and authorized services in the same SSO federation if proper
    URL service validation is applied.

    This vulnerability may allow an attacker to gain access to a victim''s account
    on a vulnerable CASified service without victim''s knowledge, when the victim
    visits attacker''s website while being logged in to the same CAS server. WordPress
    plugins containing a vulnerable copy of this library may or may not be vulnerable
    to exploitation.

    '
  metadata:
    fofa-query: wp-content/plugins/authorizer/
    google-query: inurl:"/wp-content/plugins/authorizer/"
    shodan-query: vuln:CVE-2022-39369
  name: 'phpCAS authentication library < 1.6.0 - Service Hostname Discovery Exploitation

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/7d8365a6-dfa2-4753-b655-3c2bcadeae75?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,authorizer,high
