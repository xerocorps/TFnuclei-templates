http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - sp-client-document-manager
  - dsl:
    - compare_versions(version, '< 4.22')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/sp-client-document-manager/readme.txt'
  redirects: true
id: CVE-2021-24347-sp_client_document_manager-1f81d9f2-f7a1-4085-aa20-d991cecacd23
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24347
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: 'The SP Project & Document Manager WordPress plugin before 4.22 allows
    users to upload files, however, the plugin attempts to prevent php and other similar
    files that could be executed on the server from being uploaded by checking the
    file extension. It was discovered that php files could still be uploaded by changing
    the file extension''s case, for example, from "php" to "pHP".

    '
  metadata:
    fofa-query: wp-content/plugins/sp-client-document-manager/
    google-query: inurl:"/wp-content/plugins/sp-client-document-manager/"
    shodan-query: http.html:"wp-content/plugins/sp-client-document-manager/"
  name: 'SP Project & Document Manager <= 4.21 - Authenticated Shell Upload

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/1f81d9f2-f7a1-4085-aa20-d991cecacd23?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,sp-client-document-manager,low,production
