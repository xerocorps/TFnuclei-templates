id: sri-check
info:
  author: geeknik
  description: Check if the fetched resources have SRI implemented.
  name: Subresource Integrity Check
  severity: info
  tags: sri, pci
requests:
- extractors:
  - name: script_src
    part: body
    regex:
    - <script src="(.*?)"
    type: regex
  method: GET
  path:
  - '{{BaseURL}}'
- matchers:
  - part: body
    type: word
    words:
    - integrity=
  - condition: or
    part: body
    type: word
    words:
    - sha256-
    - sha384-
    - sha512-
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/{{script_src}}'
