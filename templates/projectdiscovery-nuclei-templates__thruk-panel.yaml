http:
- extractors:
  - group: 1
    part: body
    regex:
    - (?i)version_info\s*=\s*.?([a-z0-9./\s.-]+).?
    type: regex
  matchers:
  - condition: or
    dsl:
    - contains_any(to_lower(body), "<title>thruk monitoring webinterface", "<title>thruk
      - monitoring webinterface", "thruk_static_export")
    - contains_any(to_lower(header), "x-thruk-auth-key", "thruk_test=")
    type: dsl
  - dsl:
    - status_code == 200 || status_code == 401
    type: dsl
  matchers-condition: and
  max-redirects: 6
  method: GET
  path:
  - '{{BaseURL}}'
  redirects: true
id: thruk-panel
info:
  author: ffffffff0x,righettod
  classification:
    cpe: cpe:2.3:a:thruk:thruk:*:*:*:*:*:*:*:*
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    cwe-id: CWE-200
  description: Thruk Monitoring panel was detected.
  metadata:
    fofa-query:
    - title=="Thruk Monitoring Webinterface"
    - title=="thruk monitoring webinterface"
    - body="thruk"
    max-request: 6
    product: thruk
    shodan-query: http.html:"thruk" || http.title:"thruk monitoring webinterface"
    vendor: thruk
  name: Thruk Login Panel - Detect
  reference:
  - https://thruk.org/
  severity: info
  tags: thruk,panel,login,discovery
