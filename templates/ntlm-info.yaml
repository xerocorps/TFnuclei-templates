id: ntlm-info
info:
  author: pussycat0x
  description: 'Windows New Technology LAN Manager (NTLM) is a suite of security protocols
    offered by Microsoft to authenticate users'' identity and protect the integrity
    and confidentiality of their activity. At its core, NTLM is a single sign on (SSO)
    tool that relies on a challenge-response protocol to confirm the user without
    requiring them to submit a password.

    '
  metadata:
    shodan-query: port:445
    verified: true
  name: NTLM Information - Detection
  reference:
  - https://www.crowdstrike.com/cybersecurity-101/ntlm-windows-new-technology-lan-manager/
  severity: info
  tags: js,network,smb,enum,discovery
javascript:
- args:
    Host: '{{Host}}'
    Port: '445'
  code: 'var m = require("nuclei/smb");

    var c = m.SMBClient();

    var response = c.ConnectSMBInfoMode(Host, Port);

    to_json(response);

    '
  extractors:
  - internal: true
    json:
    - .NTLM
    name: ntlm
    part: response
    type: json
  - json:
    - '"NTLM: "+ .NTLM'
    type: json
  matchers:
  - dsl:
    - len(ntlm) != 0
    type: dsl
