code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: accountList
    type: json
  source: 'az storage account list --query ''[*].id''

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - ids + " has public access enabled"
    type: dsl
  matchers:
  - type: word
    words:
    - 'false'
  matchers-condition: and
  source: 'az storage account show --ids "$ids" --query ''allowBlobPublicAccess''

    '
flow: "code(1);\nfor (let AccountData of iterate(template.accountList)) {\n  set(\"\
  ids\", AccountData);\n  code(2);\n}\n"
id: azure-storage-blob-public-access
info:
  author: princechaddha
  description: 'Ensure that public (anonymous) access is disabled for all the blob
    containers available within your Microsoft Azure storage accounts in order to
    protect your data against unauthorized access. Disabling public access at the
    storage account level overrides the public access setting configured for the individual
    blob containers in that storage account.

    '
  impact: 'If public access is not disabled, blob containers can be accessed by anyone,
    potentially exposing sensitive data to unauthorized users.

    '
  name: Azure Storage Blob Public Access Not Disabled
  reference:
  - https://docs.microsoft.com/en-us/azure/storage/common/storage-disallow-access
  remediation: 'Disable public access to all storage accounts containing blob containers
    to prevent unauthorized data access.

    '
  severity: medium
  tags: cloud,devops,azure,microsoft,storage,azure-cloud-config
self-contained: true
