code:
- engine:
  - sh
  - bash
  source: 'whoami

    '
- engine:
  - sh
  - bash
  source: 'ssh-agent whoami

    '
- engine:
  - sh
  - bash
  matchers:
  - negative: true
    part: code_1_response
    type: word
    words:
    - root
  - condition: or
    dsl:
    - contains(code_2_response, "root")
    - contains(code_3_response, "root")
    type: dsl
  matchers-condition: and
  source: 'sudo ssh-agent whoami

    '
id: privesc-ssh-agent
info:
  author: daffainfo
  description: 'ssh-agent is a program that helps manage and store private keys used
    for SSH authentication. It is often used to hold the decrypted private keys in
    memory, allowing for seamless authentication to remote servers without the need
    to re-enter passphrases for the keys.

    '
  metadata:
    max-request: 3
    verified: true
  name: ssh-agent - Privilege Escalation
  reference:
  - https://gtfobins.github.io/gtfobins/ssh-agent/
  severity: high
  tags: code,linux,ssh-agent,privesc,local
self-contained: true
