http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - stockdio-historical-chart
  - dsl:
    - compare_versions(version, '<= 2.8.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/stockdio-historical-chart/readme.txt'
  redirects: true
id: CVE-2020-28707
info:
  author: topscoder
  classification:
    cve-id: CVE-2020-28707
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
  description: 'The Stockdio Historical Chart plugin before 2.8.1 for WordPress is
    affected by Cross Site Scripting (XSS) via stockdio_chart_historical-wp.js in
    wp-content/plugins/stockdio-historical-chart/assets/ because the origin of a postMessage()
    event is not validated. The stockdio_eventer function listens for any postMessage
    event. After a message event is sent to the application, this function sets the
    "e" variable as the event and checks that the types of the data and data.method
    are not undefined (empty) before proceeding to eval the data.method received from
    the postMessage. However, on a different website. JavaScript code can call window.open
    for the vulnerable WordPress instance and do a postMessage(msg,''*'') for that
    object.

    '
  metadata:
    fofa-query: wp-content/plugins/stockdio-historical-chart/
    google-query: inurl:"/wp-content/plugins/stockdio-historical-chart/"
    shodan-query: vuln:CVE-2020-28707
  name: 'Stockdio Historical Chart < 2.8.1 - Reflected Cross-Site Scripting

    '
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/57162a5e-5f5d-4b22-bb7f-0ff65332910b?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,stockdio-historical-chart,medium
