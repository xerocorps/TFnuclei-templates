code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell.exe
  matchers:
  - type: word
    words:
    - Credential Manager stores plain text passwords
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: "if ((Get-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\\
    SecurityProviders\\WDigest' -Name 'UseLogonCredential' -ErrorAction SilentlyContinue).UseLogonCredential\
    \ -eq 1)\n  {\n    Write-Output 'Credential Manager stores plain text passwords';\n\
    \  }\n"
id: windows-credential-manager-plaintext-passwords-allowed
info:
  author: princechaddha
  description: Checks if the system allows storage of plain text passwords in Credential
    Manager.
  impact: 'Storing plain text passwords can lead to credential theft if the system
    is compromised.

    '
  name: Credential Manager Allows Storing of Plain Text Passwords
  remediation: 'Configure Credential Manager to prevent the storage of plain text
    passwords.

    '
  severity: high
  tags: windows,credentials,password,code,windows-audit
self-contained: true
