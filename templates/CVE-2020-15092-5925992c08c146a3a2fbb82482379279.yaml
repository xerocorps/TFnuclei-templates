http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - knight-lab-timelinejs
  - dsl:
    - compare_versions(version, '< 3.7.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/knight-lab-timelinejs/readme.txt'
  redirects: true
id: CVE-2020-15092-5925992c08c146a3a2fbb82482379279
info:
  author: topscoder
  classification:
    cve-id: CVE-2020-15092
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
  description: 'In TimelineJS before version 3.7.0, some user data renders as HTML.
    An attacker could implement an XSS exploit with maliciously crafted content in
    a number of data fields. This risk is present whether the source data for the
    timeline is stored on Google Sheets or in a JSON configuration file. Most TimelineJS
    users configure their timeline with a Google Sheets document. Those users are
    exposed to this vulnerability if they grant write access to the document to a
    malicious inside attacker, if the access of a trusted user is compromised, or
    if they grant public write access to the document. Some TimelineJS users configure
    their timeline with a JSON document. Those users are exposed to this vulnerability
    if they grant write access to the document to a malicious inside attacker, if
    the access of a trusted user is compromised, or if write access to the system
    hosting that document is otherwise compromised. Version 3.7.0 of TimelineJS addresses
    this in two ways. For content which is intended to support limited HTML markup
    for styling and linking, that content is "sanitized" before being added to the
    DOM. For content intended for simple text display, all markup is stripped. Very
    few users of TimelineJS actually install the TimelineJS code on their server.
    Most users publish a timeline using a URL hosted on systems we control. The fix
    for this issue is published to our system such that **those users will automatically
    begin using the new code**. The only exception would be users who have deliberately
    edited the embed URL to "pin" their timeline to an earlier version of the code.
    Some users of TimelineJS use it as a part of a wordpress plugin (knight-lab-timelinejs).
    Version 3.7.0.0 of that plugin and newer integrate the updated code. Users are
    encouraged to update the plugin rather than manually update the embedded version
    of TimelineJS.

    '
  metadata:
    fofa-query: wp-content/plugins/knight-lab-timelinejs/
    google-query: inurl:"/wp-content/plugins/knight-lab-timelinejs/"
    shodan-query: vuln:CVE-2020-15092
  name: 'TimelineJS3 < 3.7.0 - Stored Cross-Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/bf4e3fc3-b9f4-4ae5-ad48-2f764879360a?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,knight-lab-timelinejs,high
