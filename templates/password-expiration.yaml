code:
- args:
  - -c
  - "MAX_DAYS_LINE=$(grep -Pi -- '^\\h*PASS_MAX_DAYS\\h+\\d+\\b' /etc/login.defs |\
    \ head -n1)\nif [ -n \"$MAX_DAYS_LINE\" ]; then\n  VALUE=$(echo \"$MAX_DAYS_LINE\"\
    \ | awk '{print $2}')\n  if [ \"$VALUE\" -gt 0 ] && [ \"$VALUE\" -le 365 ]; then\n\
    \    echo \"[password-expiration-check:Policy-Pass] [PASS_MAX_DAYS is $VALUE (valid)]\
    \ [CIS_PASS]\"\n  else\n    echo \"[password-expiration-check:Policy-Fail] [PASS_MAX_DAYS\
    \ is $VALUE (invalid)] [CIS_FAIL]\"\n  fi\nelse\n  echo \"[password-expiration-check:Policy-Fail]\
    \ [PASS_MAX_DAYS not set or malformed] [CIS_FAIL]\"\nfi\n"
  engine:
  - bash
  matchers:
  - name: policy-pass
    type: word
    words:
    - Policy-Pass
  - name: policy-fail
    type: word
    words:
    - Policy-Fail
id: password-expiration
info:
  author: Th3l0newolf
  description: 'The PASS_MAX_DAYS setting in /etc/login.defs defines how long a password
    may be used before it must be changed.To comply with CIS Ubuntu Linux Benchmark,
    this value should be set to a number greater than 0 and less than or equal to
    365.

    '
  metadata:
    verified: true
  name: Ensure Password Expiration is Configured
  reference:
  - https://www.cisecurity.org/benchmark/ubuntu_linux
  remediation: 'Edit /etc/login.defs and ensure the line is set to: PASS_MAX_DAYS
    365 (or another value between 1 and 365).Verify the change with: grep -Pi -- ''^\h*PASS_MAX_DAYS\h+\d+\b''
    /etc/login.defs

    '
  severity: medium
  tags: cis,local,cisecurity,audit,linux,ubuntu,password
self-contained: true
