http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 5.8', '< 5.8.3')
    - compare_versions(version_by_js, '>= 5.8', '< 5.8.3')
    - compare_versions(version_by_css, '>= 5.8', '< 5.8.3')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2022-21663-wordpress-b5ebc99d-b82a-452b-8f53-bd96135aeecb
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-21663
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 6.6
  description: 'WordPress is a free and open-source content management system written
    in PHP and paired with a MariaDB database. On a multisite, users with Super Admin
    role can bypass explicit/additional hardening under certain conditions through
    object injection. This has been patched in WordPress version 5.8.3. Older affected
    versions are also fixed via security release, that go back till 3.7.37. We strongly
    recommend that you keep auto-updates enabled. There are no known workarounds for
    this issue.

    '
  metadata:
    shodan-query: vuln:CVE-2022-21663
  name: 'WordPress Core < 5.8.3 - Super Admin Multi-Site Installation Object Injection

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/b5ebc99d-b82a-452b-8f53-bd96135aeecb?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-core,medium,production
