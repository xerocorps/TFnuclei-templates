id: OOB-RCE-SSRF-TEST
info:
  author: 25
  description: Detects potential SSRF or RCE by monitoring out-of-band DNS and HTTP
    interactions using Interactsh.
  name: Out-of-Band RCE/SSRF Test via Interactsh (Headers)
  severity: critical
requests:
- extractors:
  - group: 1
    part: interactsh_request
    regex:
    - ([a-z0-9]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  headers:
    Accept: '{{interactsh-url}}'
    Accept-Encoding: '{{interactsh-url}}'
    Accept-Language: '{{interactsh-url}}'
    Access-Control-Request-Headers: '{{interactsh-url}}'
    Access-Control-Request-Method: '{{interactsh-url}}'
    Authorization: '{{interactsh-url}}'
    CF-Connecting-IP: '{{interactsh-url}}'
    Client-IP: '{{interactsh-url}}'
    Contact: root@{{interactsh-url}}
    Cookie: test={{interactsh-url}}
    Forwarded: '{{interactsh-url}}'
    From: root@{{interactsh-url}}
    Origin: '{{interactsh-url}}'
    Referer: http://{{interactsh-url}}/test
    True-Client-IP: '{{interactsh-url}}'
    User-Agent: '{{interactsh-url}}'
    X-Api-Version: '{{interactsh-url}}'
    X-CSRF-Token: '{{interactsh-url}}'
    X-Client-IP: '{{interactsh-url}}'
    X-Forwarded-For: '{{interactsh-url}}'
    X-Forwarded-Host: '{{interactsh-url}}'
    X-Forwarded-Server: '{{interactsh-url}}'
    X-HTTP-Host-Override: '{{interactsh-url}}'
    X-Host: '{{interactsh-url}}'
    X-Origin: '{{interactsh-url}}'
    X-Originating-IP: '{{interactsh-url}}'
    X-Real-IP: '{{interactsh-url}}'
    X-User-Id: '{{interactsh-url}}'
    X-Wap-Profile: http://{{interactsh-url}}/profile.xml
  interactsh:
  - dns
  - http
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: interactsh_protocol
    type: word
    words:
    - http
  - part: interactsh_request
    regex:
    - ([a-z0-9]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}'
