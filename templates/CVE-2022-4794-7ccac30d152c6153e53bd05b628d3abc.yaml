http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - aawp
  - dsl:
    - compare_versions(version, '<= 3.12.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/aawp/readme.txt'
  redirects: true
id: CVE-2022-4794-7ccac30d152c6153e53bd05b628d3abc
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-4794
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The Amazon Affiliate plugin for WordPress is vulnerable to Reflected
    File Download via image proxy in versions up to, and including, 3.12.2. This makes
    it possible for unauthenticated attackers to abuse trusted domains to load malicious
    files from external sources.

    '
  metadata:
    fofa-query: wp-content/plugins/aawp/
    google-query: inurl:"/wp-content/plugins/aawp/"
    shodan-query: vuln:CVE-2022-4794
  name: 'Amazon Affiliate <= 3.12.2 - Reflected File Download

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/e94f9cde-5e8b-4d68-8ede-12d678a370ed?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,aawp,critical
