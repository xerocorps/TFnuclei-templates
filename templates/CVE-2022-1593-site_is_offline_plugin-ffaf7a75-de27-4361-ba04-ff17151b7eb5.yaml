http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - site-is-offline-plugin
  - dsl:
    - compare_versions(version, '<= 1.6.6')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/site-is-offline-plugin/readme.txt'
  redirects: true
id: CVE-2022-1593-site_is_offline_plugin-ffaf7a75-de27-4361-ba04-ff17151b7eb5
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-1593
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    cvss-score: 9.6
  description: 'The Site Offline or Coming Soon WordPress plugin through 1.6.6 does
    not have CSRF check in place when updating its settings, and it also lacking sanitisation
    as well as escaping in some of them. As a result, attackers could make a logged
    in admin change them and put Cross-Site Scripting payloads in them via a CSRF
    attack

    '
  metadata:
    fofa-query: wp-content/plugins/site-is-offline-plugin/
    google-query: inurl:"/wp-content/plugins/site-is-offline-plugin/"
    shodan-query: http.html:"wp-content/plugins/site-is-offline-plugin/"
  name: 'Site Offline or Coming Soon <= 1.6.6 - Cross-Site Request Forgery to Settings
    Update and Cross-Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/ffaf7a75-de27-4361-ba04-ff17151b7eb5?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,site-is-offline-plugin,critical,production
