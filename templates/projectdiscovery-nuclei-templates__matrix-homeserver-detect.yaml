http:
- extractors:
  - json:
    - .server | select((.name != null) and (.version != null)) | .name, .version
    part: body
    type: json
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"server":'
    - '"name":'
    - '"version":'
  - part: content_type
    type: word
    words:
    - application/json
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}/_matrix/federation/v1/version'
  redirects: true
id: matrix-homeserver-detect
info:
  author: davidegirardi
  classification:
    cpe: cpe:2.3:a:matrix:synapse:*:*:*:*:*:*:*:*
  description: 'Extract the Matrix homeserver name and version

    '
  metadata:
    max-request: 1
    product: synapse
    shodan-query: title:"Synapse is running"
    vendor: matrix
    verified: true
  name: Matrix Homeserver - Version Detection
  severity: info
  tags: tech,matrix,synapse,discovery
