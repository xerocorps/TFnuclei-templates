http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - user-activity-log
  - dsl:
    - compare_versions(version, '<= 1.6.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/user-activity-log/readme.txt'
  redirects: true
id: CVE-2023-3435-user_activity_log-b4ca985e-cae1-4e26-ad2d-413724cfd45d
info:
  author: topscoder
  classification:
    cve-id: CVE-2023-3435
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
  description: 'The User Activity Log plugin for WordPress is vulnerable to SQL Injection
    in versions up to, and including, 1.6.4 via the ual_export_log() and ual_export_user_log()
    function that is missing preparation on existing queries as well as escaping on
    the user input passed to them. This makes it possible for unauthenticated attackers
    to append additional SQL queries into already existing queries that can be used
    to extract sensitive information from the database.  This issue was partially
    patched in 1.6.4, which made it only exploitable by authenticated users, a full
    patch was released in 1.6.5.

    '
  metadata:
    fofa-query: wp-content/plugins/user-activity-log/
    google-query: inurl:"/wp-content/plugins/user-activity-log/"
    shodan-query: http.html:"wp-content/plugins/user-activity-log/"
  name: 'User Activity Log <= 1.6.4 - Unauthenticated SQL Injection

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/b4ca985e-cae1-4e26-ad2d-413724cfd45d?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,user-activity-log,low,production
