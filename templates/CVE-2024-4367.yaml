http:
- matchers:
  - part: body
    regex:
    - pdfjsVersion\s*[:=]\s*['"]?(0\.[0-9]{1,2}\.[0-9]{1,3}|[1-3]\.[0-9]{1,2}\.[0-9]{1,3}|4\.[0-2]\.(?:[0-5]?[0-9]|6[0-6]))['"]?
    type: regex
  - part: body
    regex:
    - PDF\.js v(0\.[0-9]{1,2}\.[0-9]{1,3}|[1-3]\.[0-9]{1,2}\.[0-9]{1,3}|4\.[0-2]\.(?:[0-5]?[0-9]|6[0-6]))
    type: regex
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}/web/static/lib/pdfjs/web/pdf.js'
  - '{{BaseURL}}/web/static/lib/pdfjs/web/pdf.worker.js'
  - '{{BaseURL}}/web/static/lib/pdfjs/build/pdf.js'
  - '{{BaseURL}}/web/static/lib/pdfjs/build/pdf.worker.js'
  - '{{BaseURL}}/web/static/lib/pdfjs/build/pdf.min.js'
  - '{{BaseURL}}/web/static/lib/pdfjs/build/pdf.worker.min.js'
  - '{{BaseURL}}/web/static/lib/pdfjs-dist/web/pdf.js'
  - '{{BaseURL}}/web/static/lib/pdfjs-dist/web/pdf.worker.js'
  - '{{BaseURL}}/web/static/lib/pdfjs-dist/build/pdf.js'
  - '{{BaseURL}}/web/static/lib/pdfjs-dist/build/pdf.worker.js'
  - '{{BaseURL}}/web/static/lib/pdfjs-dist/build/pdf.min.js'
  - '{{BaseURL}}/web/static/lib/pdfjs-dist/build/pdf.worker.min.js'
  - '{{BaseURL}}/web/static/lib/pdfjs/web/viewer.html'
id: CVE-2024-4367
info:
  author: 0xr2r
  description: "Vulnerable PDF.js (pdfjs-dist versions lower than 4.2.67) uses eval()\
    \ to process fonts when rendering PDFs. This can allow attackers to execute arbitrary\
    \ JavaScript \nby providing a specially crafted PDF. Disabling isEvalSupported\
    \ or updating to version 4.2.67 or higher mitigates this issue.\n"
  impact: 'Vulnerable PDF.js can allow arbitrary JavaScript execution when opening
    manipulated PDFs.

    '
  name: Odoo PDF.js affected by CVE-2024-4367 allowing arbitrary JavaScript execution
  reference:
  - https://lists.debian.org/debian-lts-announce/2024/05/msg00012.html
  - https://security.snyk.io/vuln/SNYK-JS-PDFJSDIST-6810403
  remediation: 'Update PDF.js (pdfjs-dist) to 4.2.67 or higher, or disable isEvalSupported
    (may affect interactive PDFs).

    '
  severity: high
