http:
- attack: pitchfork
  host-redirects: true
  matchers:
  - condition: and
    dsl:
    - status_code_1 == 200 && status_code_2 == 401
    - contains(body_2, "Unauthorized")
    - '!contains(body_1, "/index.html")'
    - contains_any(tolower(body_1), "<TITLE>DELL DPI Remote Power Management", "title=\"DELL
      DPI Remote Power Management")
    type: dsl
  matchers-condition: and
  max-redirects: 2
  payloads:
    password:
    - admin
    username:
    - admin
  raw:
  - 'POST /index2.html HTTP/1.1

    Host: {{Hostname}}

    Authorization: Basic {{base64(''{{username}}:{{password}}'')}}

    '
  - 'POST /index2.html HTTP/1.1

    Host: {{Hostname}}

    Authorization: Basic {{base64(''{{str}}:{{str}}'')}}

    '
id: dell-dpi-default-login
info:
  author: megamansec
  classification:
    cwe-id: CWE-798
  description: 'The Dell Metered Rack Power Distribution Unit uses a default username
    and password which is widely known, and any user could change the default password
    with access.

    '
  metadata:
    max-request: 2
  name: Dell DPI Remote Power Management - Default Login
  reference:
  - https://dl.dell.com/manuals/all-products/esuprt_ser_stor_net/esuprt_rack_infrastructure/dell-metered-pdu_user%27s%20guide3_en-us.pdf
  severity: medium
  tags: dell,dpi,rpm,default-login,vuln
variables:
  str: '{{to_lower(rand_text_alpha(5))}}'
