http:
- extractors:
  - group: 0
    name: tsunami
    regex:
    - CSRFGuard_\d+
    type: regex
  - group: 1
    name: typhoon
    regex:
    - type="hidden" value="(.*?)"
    type: regex
  method: GET
  path:
  - '{{BaseURL}}/testlink/login.php'
- attack: pitchfork
  body: 'CSRFName={{tsunami}}&CSRFToken={{typhoon}}&reqURI=&destination=&tl_login={{username}}&tl_password={{password}}

    '
  headers:
    Content-Type: application/x-www-form-urlencoded
    Origin: '{{BaseURL}}'
    Referer: '{{BaseURL}}/testlink/login.php'
  matchers:
  - part: body
    type: word
    words:
    - Users/Roles
    - My Settings
  - status:
    - 200
    type: status
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/testlink/login.php'
  payloads:
    password:
    - admin
    username:
    - admin
id: TestLink-Default-Access
info:
  author: YashVardhanTripathi
  description: Check for default access in TestLink CMS.
  name: TestLink Default Access Check
  severity: high
