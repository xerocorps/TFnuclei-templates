http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - easy-digital-downloads
  - dsl:
    - compare_versions(version, '>= 3.1', '<= 3.3.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/easy-digital-downloads/readme.txt'
  redirects: true
id: CVE-2024-9654-easy_digital_downloads-d3f4de75-abf5-46e8-854d-be91ed74a5f3
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-9654
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 3.7
  description: 'The Easy Digital Downloads plugin for WordPress is vulnerable to Improper
    Authorization in versions 3.1 through 3.3.4. This is due to a lack of sufficient
    validation checks within the ''verify_guest_email'' function to ensure the requesting
    user is the intended recipient of the purchase receipt. This makes it possible
    for unauthenticated attackers to bypass intended security restrictions and view
    the receipts of other users, which contains a link to download paid content. Successful
    exploitation requires knowledge of another customers email address as well as
    the file ID of the content they purchased.

    '
  metadata:
    fofa-query: wp-content/plugins/easy-digital-downloads/
    google-query: inurl:"/wp-content/plugins/easy-digital-downloads/"
    shodan-query: http.html:"wp-content/plugins/easy-digital-downloads/"
  name: 'Easy Digital Downloads 3.1 - 3.3.4 - Improper Authorization to Paywall Bypass

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/d3f4de75-abf5-46e8-854d-be91ed74a5f3?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,easy-digital-downloads,low,production
