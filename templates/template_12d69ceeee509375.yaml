info:
  author: OpenAI
  classification:
    country: any
    tags:
    - azure
    - apim
    - secret key
    - security
    - sensitive information
  description: Template to detect Azure API Management (APIM) secret key disclosure
  id: azure-apim-secret-key-disclosure
  matcher-condition: or
  matchers:
  - description: Azure APIM secret key found in request headers
    pattern: Ocp-Apim-Subscription-Key
    type: headers
  name: Azure APIM Secret Key Disclosure - Detect
  requests:
    description: Example request to trigger detection
    method: GET
    path:
    - /
  response:
  - description: Successful response status
    status:
    - 200
  severity: Critical
