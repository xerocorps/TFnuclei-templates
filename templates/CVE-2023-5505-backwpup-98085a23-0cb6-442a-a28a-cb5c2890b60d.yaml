http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - backwpup
  - dsl:
    - compare_versions(version, '<= 4.0.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/backwpup/readme.txt'
  redirects: true
id: CVE-2023-5505-backwpup-98085a23-0cb6-442a-a28a-cb5c2890b60d
info:
  author: topscoder
  classification:
    cve-id: CVE-2023-5505
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:N/I:N/A:H
    cvss-score: 6.8
  description: 'The BackWPup plugin for WordPress is vulnerable to Directory Traversal
    in versions up to, and including, 4.0.1 via the job-specific backup folder. This
    allows authenticated attackers to store backups in arbitrary folders on the server
    provided they can be written to by the server. Additionally, default settings
    will place an index.php and a .htaccess file into the chosen directory (unless
    already present) when the first backup job is run that are intended to prevent
    directory listing and file access. This means that an attacker could set the backup
    directory to the root of another site in a shared environment and thus disable
    that site.

    '
  metadata:
    fofa-query: wp-content/plugins/backwpup/
    google-query: inurl:"/wp-content/plugins/backwpup/"
    shodan-query: http.html:"wp-content/plugins/backwpup/"
  name: 'BackWPup <= 4.0.1 - Authenticated (Administrator+) Directory Traversal

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/98085a23-0cb6-442a-a28a-cb5c2890b60d?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,backwpup,low,production
