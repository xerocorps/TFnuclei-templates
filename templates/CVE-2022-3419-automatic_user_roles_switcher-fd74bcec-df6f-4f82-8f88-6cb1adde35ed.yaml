http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - automatic-user-roles-switcher
  - dsl:
    - compare_versions(version, '<= 1.1.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/automatic-user-roles-switcher/readme.txt'
  redirects: true
id: CVE-2022-3419-automatic_user_roles_switcher-fd74bcec-df6f-4f82-8f88-6cb1adde35ed
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-3419
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 8.1
  description: 'The Automatic User Roles Switcher plugin for WordPress is vulnerable
    to authorization bypass due to missing authorization on an unknown function in
    versions up to, and including, 1.1.1. This makes it possible for authenticated
    attackers, with subscriber-level permissions and above, to change their own role
    to administrator.

    '
  metadata:
    fofa-query: wp-content/plugins/automatic-user-roles-switcher/
    google-query: inurl:"/wp-content/plugins/automatic-user-roles-switcher/"
    shodan-query: http.html:"wp-content/plugins/automatic-user-roles-switcher/"
  name: 'Automatic User Roles Switcher <= 1.1.1 - Missing Authorization to Privilege
    Escalation

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/fd74bcec-df6f-4f82-8f88-6cb1adde35ed?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,automatic-user-roles-switcher,low,production
