http:
- attack: batteringram
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - server_sql.php
    - server_status.php
    - server_variables.php
    - server_databases.php
  - part: header
    type: word
    words:
    - 'Set-Cookie: phpMyAdmin='
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  payloads:
    path:
    - /index.php
    - /pma/index.php
    - /pmd/index.php
    - /phpMyAdmin/index.php
    - /phpmyadmin/index.php
    - /_phpmyadmin/index.php
  raw:
  - 'GET {{path}} HTTP/1.1

    Host: {{Hostname}}

    '
  stop-at-first-match: true
id: phpmyadmin-unauth-access
info:
  author: pwnhxl
  description: Unauthenticated Access to phpmyadmin dashboard.
  metadata:
    fofa-query: body="server_databases.php"
    max-request: 6
    shodan-query: html:"server_databases.php"
    verified: true
  name: PhpMyAdmin - Unauthenticated Access
  reference:
  - https://www.phpmyadmin.net
  severity: critical
  tags: misconfig,phpmyadmin,unauth
