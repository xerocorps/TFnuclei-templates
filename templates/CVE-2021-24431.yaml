http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - language-bar-flags
  - dsl:
    - compare_versions(version, '<=  1.0.8')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/language-bar-flags/readme.txt'
  redirects: true
id: CVE-2021-24431
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24431
    cvss-metrics: null
    cvss-score: null
  description: The Language Bar Flags WordPress plugin through 1.0.8 does not have
    any CSRF in place when saving its settings and did not sanitise or escape them
    when generating the flag bar in the frontend. This could allow attackers to make
    a logged in admin change the settings, and set Cross-Site Scripting payload in
    them, which will be executed in the frontend for all users
  metadata:
    fofa-query: wp-content/plugins/language-bar-flags/
    google-query: inurl:"/wp-content/plugins/language-bar-flags/"
    shodan-query: vuln:CVE-2021-24431
  name: Language Bar Flags <= 1.0.8 - Cross-Site Request Forgery leading to Stored
    Cross-Site Scripting
  reference: null
  severity: medium
  tags: cve,wordpress,wp-plugin,language-bar-flags,medium
