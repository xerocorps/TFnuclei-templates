flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    name: token
    part: body
    regex:
    - sk\.eyJ1Ijoi\w+\.[\w-]*
    type: regex
  method: GET
  path:
  - '{{BaseURL}}'
- disable-path-automerge: true
  extractors:
  - dsl:
    - token
    type: dsl
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, "type","query","features")
    type: dsl
  raw:
  - '@Host: https://api.mapbox.com:443

    GET /geocoding/v5/mapbox.places/Los%20Angeles.json?access_token={{token}} HTTP/1.1

    Host: api.mapbox.com

    '
id: mapbox-token-disclosure
info:
  author: Devang-Solanki
  description: Mapbox secret token is exposed to external users.
  metadata:
    max-request: 2
    verified: true
  name: Mapbox Token Disclosure
  reference:
  - https://docs.gitguardian.com/secrets-detection/detectors/specifics/mapbox_token
  - https://github.com/zricethezav/gitleaks/blob/master/cmd/generate/config/rules/mapbox.go
  - https://docs.mapbox.com/api/accounts/tokens/#token-format
  - https://docs.mapbox.com/help/getting-started/access-tokens/
  severity: medium
  tags: token,exposure,mapbox,vuln
