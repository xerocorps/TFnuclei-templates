code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: appList
    type: json
  source: 'az webapp list --output json --query ''[*].{id:id}''

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - id + " does not have the latest TLS version configured"
    type: dsl
  matchers:
  - negative: true
    type: word
    words:
    - '1.2'
  source: 'az webapp config show --ids $id --query ''minTlsVersion'' --output json

    '
flow: "code(1);\nfor (let appData of iterate(template.appList)) {\n  appData = JSON.parse(appData);\n\
  \  set(\"id\", appData.id);\n  code(2);\n}\n"
id: azure-appservice-tls-latest-version-missing
info:
  author: princechaddha
  description: 'Ensure that all Microsoft Azure App Service web applications are using
    the latest version of TLS encryption protocol to secure the applications traffic
    over the Internet and comply with the industry standards. This check verifies
    if the minimum TLS version configured is not "1.2", indicating that the latest
    version of TLS is not used.

    '
  impact: 'Using an outdated TLS version can expose the application to security vulnerabilities
    and non-compliance with industry standards.

    '
  name: Azure App Service TLS Latest Version Not Configured
  reference:
  - https://docs.microsoft.com/en-us/azure/app-service/configure-ssl-bindings#enforce-https
  remediation: 'Configure the minimum TLS version to "1.2" in the Azure App Service
    settings to ensure data is encrypted with the latest security standards.

    '
  severity: medium
  tags: cloud,devops,azure,microsoft,appservice,azure-cloud-config
self-contained: true
