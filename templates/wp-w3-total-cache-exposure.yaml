http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, "wp-content/w3tc/dbcache", "Index of","Parent Directory")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/wp-content/w3tc/dbcache/'
id: wp-w3-total-cache-exposure
info:
  author: pussycat0x
  description: 'Detects publicly accessible W3 Total Cache database cache files in
    the wp-content/w3tc/dbcache/ directory. When database caching to disk is enabled,
    these files contain raw SQL query results, potentially exposing sensitive data
    such as user details, password hashes, emails, or other database content if the
    directory is not properly protected.

    '
  metadata:
    fofa-query: body="/wp-content/w3tc/dbcache/"
    max-request: 1
    verified: true
  name: WordPress W3 Total Cache - Cache Files Exposure
  reference:
  - https://www.acunetix.com/vulnerabilities/web/wordpress-w3-total-cache-plugin-predictable-cache-filenames/
  - https://www.openwall.com/lists/oss-security/2012/12/30/3 (CVE-2012-6077 related
    discussion)
  - https://siteground.com/blog/w3-total-cache-vulnerability/
  severity: high
  tags: wordpress,wp-plugin,w3-total-cache,exposure,cache,misconfig
