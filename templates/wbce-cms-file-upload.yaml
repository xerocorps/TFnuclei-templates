id: wbce-cms-file-upload
info:
  author: YourName
  description: 'This template checks for the presence of a file upload vulnerability
    in WBCE CMS.

    '
  name: WBCE CMS File Upload Vulnerability
  references:
  - https://example.com/advisory
  severity: high
requests:
- matchers:
  - status:
    - 200
    - 302
    type: status
  - type: word
    words:
    - WBCE CMS
    - Login
    - Media
  matchers-condition: and
  method: GET
  path:
  - /WBCE_CMS-1.6.1/wbce/admin/login/index.php
  - /WBCE_CMS-1.6.1/wbce/admin/media/index.php#elf_l1_Lw
- inputs:
  - name: url
    payloads:
    - /wbce/media/css-keylogger.html
    type: file
  matchers:
  - status:
    - 302
    type: status
  - type: word
    words:
    - Redirecting
  matchers-condition: and
  method: POST
  path: /WBCE_CMS-1.6.1/wbce/admin/login/index.php
- matchers:
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path: /WBCE_CMS-1.6.1/wbce/media/css-keylogger.html
