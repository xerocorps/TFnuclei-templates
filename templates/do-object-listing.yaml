http:
- extractors:
  - group: 1
    part: body
    regex:
    - <Name>([a-z0-9-._]+)
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - <ListBucketResult xmlns=
    - <Marker/>
    - <ID>
    - <DisplayName>
    - <StorageClass>
  - part: header
    type: word
    words:
    - application/xml
  matchers-condition: and
  max-size: 1000
  method: GET
  path:
  - '{{Hostname}}/'
  - '{{Host}}.ams3.digitaloceanspaces.com'
  - '{{Host}}.sfo2.digitaloceanspaces.com'
  - '{{Host}}.fra1.digitaloceanspaces.com'
  - '{{Host}}.nyc3.digitaloceanspaces.com'
  - '{{Host}}.sgp1.digitaloceanspaces.com'
  - '{{Host}}.syd1.digitaloceanspaces.com'
  - '{{Host}}.lon1.digitaloceanspaces.com'
  - '{{Host}}.tor1.digitaloceanspaces.com'
  - '{{Host}}.blr1.digitaloceanspaces.com'
  - '{{Host}}.sfo3.digitaloceanspaces.com'
  stop-at-first-match: true
id: do-object-listing
info:
  author: reewardius
  name: Digital Ocean bucket with Object listing
  reference:
  - https://mikey96.medium.com/cloud-based-storage-misconfigurations-critical-bounties-361647f78a29
  severity: medium
  tags: bucket,do,digitalocean,provider,generic,listing
