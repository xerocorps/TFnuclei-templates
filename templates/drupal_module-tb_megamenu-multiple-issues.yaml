http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '8.x-1.3')
    - compare_versions(version, '8.x-1.2')
    - compare_versions(version, '8.x-1.1')
    - compare_versions(version, '8.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - tb_megamenu
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/tb_megamenu/tb_megamenu.info'
  redirects: true
id: drupal_module-tb_megamenu-multiple-issues
info:
  author: Bishopfox
  description: This module provides an admin interface for creating drop down menus
    that combine Drupal menu items with rich media content. The module does not sanitize
    values for CSS properties that are added by admins and rendered on the front-end,
    allowing attackers to inject malicious code into the front-end markup. This vulnerability
    is mitigated by the fact that it can only be exploited by an attacker with permissions
    to administer TB Mega Menu, or a sophisticated anonymous user using a site-specific
    attack that exploits the Cross Site Request Forgery vulnerability that is fixed
    by this same release.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/tb_megamenu/
    google-query: inurl:'/sites/all/modules/tb_megamenu/
    impact: medium
    security-risk: "Moderately critical 12\u221525 AC:Complex/A:Admin/CI:Some/II:Some/E:Theoretical/TD:All"
    type: indicator
    vulnerability: multiple-issues
  name: drupal_module-tb_megamenu-multiple-issues
  reference:
  - https://www.drupal.org/sa-contrib-2021-038
  severity: medium
  tags: drupal
