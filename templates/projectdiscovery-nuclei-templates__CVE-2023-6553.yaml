flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "Backup Migration")
    internal: true
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/backup-backup/readme.txt'
- headers:
    Content-Dir: '{{rand_text_alpha(10)}}'
  matchers:
  - condition: and
    dsl:
    - len(body) == 0
    - status_code == 200
    - '!contains(body, "Incorrect parameters")'
    type: dsl
  method: POST
  path:
  - '{{BaseURL}}/wp-content/plugins/backup-backup/includes/backup-heart.php'
id: CVE-2023-6553
info:
  author: FLX
  classification:
    cpe: cpe:2.3:a:backupbliss:backup_migration:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2023-6553
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    epss-percentile: 0.99763
    epss-score: 0.92952
  description: 'The Backup Migration plugin for WordPress is vulnerable to Remote
    Code Execution in all versions up to, and including, 1.3.7 via the /includes/backup-heart.php
    file. This is due to an attacker being able to control the values passed to an
    include, and subsequently leverage that to achieve remote code execution. This
    makes it possible for unauthenticated threat actors to easily execute code on
    the server.

    '
  impact: 'Unauthenticated attackers can leverage file inclusion via backup-heart.php
    to achieve arbitrary code execution, potentially compromising the entire WordPress
    site and server.

    '
  metadata:
    fofa-query: body=/wp-content/plugins/backup-backup/
    framework: wordpress
    google-query: inurl:"/wp-content/plugins/backup-backup/"
    max-request: 2
    product: backup_migration
    publicwww-query: /wp-content/plugins/backup-backup/
    shodan-query: http.html:/wp-content/plugins/backup-backup/
    vendor: backupbliss
  name: Worpress Backup Migration <= 1.3.7 - Unauthenticated Remote Code Execution
  reference:
  - https://www.wordfence.com/blog/2023/12/critical-unauthenticated-remote-code-execution-found-in-backup-migration-plugin/
  - https://github.com/Chocapikk/CVE-2023-6553
  - http://packetstormsecurity.com/files/176638/WordPress-Backup-Migration-1.3.7-Remote-Command-Execution.html
  - https://www.synacktiv.com/en/publications/php-filters-chain-what-is-it-and-how-to-use-it
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/3511ba64-56a3-43d7-8ab8-c6e40e3b686e?source=cve
  remediation: 'Upgrade Backup Migration plugin to version 1.3.8 or later.

    '
  severity: critical
  tags: packetstorm,cve,cve2023,wp-plugin,rce,unauth,wordpress,wp,backupbliss,vkev,vuln
