http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_any(body, "PHONY:", "all:", "clean:", ".SUFFIXES:", "$(MAKE)")
    - '!contains_any(body,"<!DOCTYPE","<html","<script>")'
    - len(body) > 100 && len(body) < 100000
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/Makefile'
  - '{{BaseURL}}/makefile'
  stop-at-first-match: true
id: makefile-exposure
info:
  author: 0x_Akoko
  description: 'Detected Makefile configuration file was identified, which potentially
    exposed build process details, author information, and directory structure

    '
  metadata:
    max-request: 2
    verified: true
  name: Makefile - Exposure
  reference:
  - https://www.gnu.org/software/make/manual/make.html
  severity: low
  tags: exposure,config,makefile
