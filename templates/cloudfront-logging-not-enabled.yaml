id: cloudfront-logging-not-enabled
info:
  author: princechaddha
  description: 'Checks if logging is not enabled for any CloudFront distribution.

    '
  name: CloudFront Logging Not Enabled
  reference:
  - https://docs.aws.amazon.com/cloudfront/latest/APIReference/API_GetDistribution.html
  severity: medium
  tags: aws,amazon,cloud,cloudfront
requests:
- extractors:
  - group: 1
    internal: true
    name: ListDistributions
    part: body
    regex:
    - <DistributionSummary><Id>([A-Z0-9]+)<\/Id>
    type: regex
  - dsl:
    - '"CloudFront Logging is not enabled for " + ListDistributions + " distribution"'
    type: dsl
  iterate-all: true
  matchers:
  - part: body_2
    type: word
    words:
    - <Logging><Enabled>false</Enabled>
  matchers-condition: and
  method: GET
  path:
  - https://{{service}}.amazonaws.com/2020-05-31/distribution
  - https://{{service}}.amazonaws.com/2020-05-31/distribution/{{ListDistributions}}
self-contained: true
signature: aws
variables:
  region: us-east-1
  service: cloudfront
