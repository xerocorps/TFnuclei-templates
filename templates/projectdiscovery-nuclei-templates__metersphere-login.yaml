http:
- matchers:
  - condition: and
    dsl:
    - status_code==200
    - ('1023469568' == mmh3(base64_py(body)))
    type: dsl
  - condition: and
    dsl:
    - status_code==200
    - contains(tolower(body), 'metersphere')
    type: dsl
  - dsl:
    - contains(tolower(header), 'ms_session_id')
    type: dsl
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}/favicon.ico'
  - '{{BaseURL}}/login'
  stop-at-first-match: true
id: metersphere-login
info:
  author: pdteam
  classification:
    cpe: cpe:2.3:a:metersphere:metersphere:*:*:*:*:*:*:*:*
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    cwe-id: CWE-200
  description: MeterSphere login panel was detected.
  metadata:
    fofa-query:
    - body="metersphere"
    - title="metersphere"
    max-request: 2
    product: metersphere
    shodan-query: http.html:"metersphere"
    vendor: metersphere
  name: MeterSphere Login Panel - Detect
  reference:
  - https://github.com/metersphere/metersphere
  severity: info
  tags: panel,metersphere,discovery
