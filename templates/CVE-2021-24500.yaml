http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Version: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Version: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - workreap
  - dsl:
    - compare_versions(version, '< 2.2.2')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/themes/workreap/style.css'
  redirects: true
id: CVE-2021-24500
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24500
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H
    cvss-score: 8.1
  description: Several AJAX actions available in the Workreap WordPress theme before
    2.2.2 lacked CSRF protections, as well as allowing insecure direct object references
    that were not validated. This allows an attacker to trick a logged in user to
    submit a POST request to the vulnerable site, potentially modifying or deleting
    arbitrary objects on the target site.
  metadata:
    fofa-query: wp-content/themes/workreap/
    google-query: inurl:"/wp-content/themes/workreap/"
    shodan-query: vuln:CVE-2021-24500
  name: Workreap < 2.2.2 - Cross-Site Request Forgery
  reference:
  - https://jetpack.com/2021/07/07/multiple-vulnerabilities-in-workreap-theme/
  - https://wpscan.com/vulnerability/0c4b5ecc-54d0-45ec-9f92-b2ca3cadbe56
  severity: high
  tags: cve,wordpress,wp-theme,workreap,high
