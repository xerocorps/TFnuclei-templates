id: moodle-version-detect
info:
  author: milo2012
  description: Moodle has a file which describes API changes in core libraries and
    APIs, and can be used to discover Moodle version.
  name: Moodle Version Detect
  severity: info
  tags: misc,moodle
requests:
- extractors:
  - group: 1
    part: body
    regex:
    - information provided here is intended especially for developers.\n\n=== (.*?)
      ===
    type: regex
  matchers:
  - condition: and
    type: word
    words:
    - This files describes API changes in core libraries and APIs,
    - information provided here is intended especially for developers.
    - new my moodle and profiles API
  - part: header
    type: word
    words:
    - text/plain
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/lib/upgrade.txt'
