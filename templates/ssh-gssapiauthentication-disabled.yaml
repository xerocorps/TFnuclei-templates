code:
- args:
  - -c
  - "# Use sudo for elevated access to parse the effective SSH configuration\nif !\
    \ command -v sshd &> /dev/null; then\n  echo \"[cis-ssh-gssapiauthentication-disabled:Policy-Error]\
    \ [SSH daemon not found] [CIS_ERROR] [medium]\"\n  exit 1\nfi\n\n# Get the effective\
    \ SSH configuration\nif ! gssapi_auth=$(sudo sshd -T 2>/dev/null | grep -i gssapiauthentication\
    \ | awk '{print tolower($2)}' | tr -d ' \\t'); then\n  echo \"[cis-ssh-gssapiauthentication-disabled:Policy-Error]\
    \ [Failed to get SSH configuration] [CIS_ERROR] [medium]\"\n  exit 1\nfi\n\n#\
    \ Check if the value is explicitly set to 'no'\nif [[ -n \"$gssapi_auth\" && \"\
    $gssapi_auth\" == \"no\" ]]; then\n  echo \"[cis-ssh-gssapiauthentication-disabled:Policy-Pass]\
    \ [GSSAPIAuthentication $gssapi_auth] [CIS_PASS] [medium]\"\nelse\n  echo \"[cis-ssh-gssapiauthentication-disabled:Policy-Fail]\
    \ [GSSAPIAuthentication ${gssapi_auth:-unset}] [CIS_FAIL] [medium]\"\nfi\n"
  engine:
  - bash
  matchers:
  - name: policy-pass
    type: word
    words:
    - Policy-Pass
  - name: policy-fail
    type: word
    words:
    - Policy-Fail
  - name: policy-error
    type: word
    words:
    - Policy-Error
id: ssh-gssapiauthentication-disabled
info:
  author: Th3l0newolf
  description: 'The GSSAPIAuthentication parameter in the SSH configuration file (sshd_config)
    controls whether GSSAPI-based user authentication is permitted. When enabled,
    it allows the use of Kerberos or other GSSAPI mechanisms for authenticating SSH
    connections.

    '
  metadata:
    verified: true
  name: sshd GSSAPIAuthentication - Disabled
  reference:
  - https://www.cisecurity.org/benchmark/ubuntu_linux
  remediation: Disable GSSAPIAuthentication by editing /etc/ssh/sshd_config to set
    GSSAPIAuthentication no and restart SSH with sudo systemctl restart sshd.
  severity: low
  tags: cis,local,ssh,linux,audit,ubuntu,benchmark
self-contained: true
