expression: r0() && r1()
id: rabbitmq-default-password
info:
  author: mumu0215(https://github.com/mumu0215)
  description: app="RabbitMQ-Management"
  name: RabbitMQ Default Password
  severity: high
  verified: true
rules:
  r0:
    expression: response.status == 401
    request:
      method: GET
      path: /api/whoami
  r1:
    expression: response.status == 200 && response.body.bcontains(b"\"name\":\"guest\"")
    request:
      headers:
        Authorization: Basic Z3Vlc3Q6Z3Vlc3Q=
      method: GET
      path: /api/whoami
