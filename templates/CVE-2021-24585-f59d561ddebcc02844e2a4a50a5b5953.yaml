http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - mp-timetable
  - dsl:
    - compare_versions(version, '<= 2.3.19')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/mp-timetable/readme.txt'
  redirects: true
id: CVE-2021-24585-f59d561ddebcc02844e2a4a50a5b5953
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24585
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 6.5
  description: 'The Timetable and Event Schedule WordPress plugin before 2.4.0 outputs
    the Hashed Password, Username and Email Address (along other less sensitive data)
    of the user related to the Even Head of the Timeslot in the response when requesting
    the event Timeslot data with a user with the edit_posts capability. Combined with
    the other Unauthorised Event Timeslot Modification issue (https://wpscan.com/reports/submissions/4699/)
    where an arbitrary user ID can be set, this could allow low privilege users with
    the edit_posts capability (such as author) to retrieve sensitive User data by
    iterating over the user_id

    '
  metadata:
    fofa-query: wp-content/plugins/mp-timetable/
    google-query: inurl:"/wp-content/plugins/mp-timetable/"
    shodan-query: vuln:CVE-2021-24585
  name: 'Timetable and Event Schedule by MotoPress <= 2.3.19 - Arbitrary User''s Hashed
    Password/Email/Username Disclosure

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/b14af68e-960f-4817-bab4-881f2720cb82?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,mp-timetable,medium
