code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'NoLmHash     : 0'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'Get-ItemProperty -Path ''HKLM:\SYSTEM\CurrentControlSet\Control\Lsa'' -Name
    ''NoLMHash''

    '
id: lm-hash-storage-enabled
info:
  author: princechaddha
  description: Checks if LM hashes are stored, which is an insecure practice.
  impact: 'Storing LM hashes can lead to easier password cracking due to the weak
    nature of the LM hashing algorithm.

    '
  name: LM Hash Storage Enabled
  remediation: 'Disable LM hash storage by setting the NoLMHash registry key to prevent
    storing weak LM hashes.

    '
  severity: high
  tags: windows,hashing,security,code,windows-audit
self-contained: true
