http:
- matchers:
  - condition: and
    dsl:
    - status_code_1 == 200 && contains_all(body_1,"java.io","EOFExceptionYI")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/service/~baseapp/UploadServlet'
id: yonyou-nc-baseapp-deserialization
info:
  author: SleepingBag945
  classification:
    cpe: cpe:2.3:a:yonyou:ufida-nc:*:*:*:*:*:*:*:*
  description: 'Yonyou NC is an enterprise-level management software, widely used
    in large and medium-sized enterprises.Realize modeling, development, inheritance,
    operation, management integration of IT solution information platform.UFIDA NC
    for C/S architecture, the use of Java programming language development, the client
    can directly use UClient, the server interface for HTTP.A page of UFIDA NC6.5,
    there is arbitrary file upload vulnerability.The cause of vulnerability is that
    there is no type restriction at the uploading file, and an attacker without authentication
    can take advantage of this vulnerability by sending special data packets to the
    target system, and a remote attacker who successfully takes advantage of this
    vulnerability can upload any file to the target system to execute commands.

    '
  metadata:
    fofa-query: app="Yonyou-UFIDA-NC"
    max-request: 1
    product: ufida-nc
    vendor: yonyou
    verified: true
  name: Yonyou NC BaseApp UploadServlet - Deserialization Detect
  reference:
  - https://github.com/cqr-cryeye-forks/goby-pocs/blob/main/Yonyou-NC-BaseApp-UploadServlet-Deserialization-RCE.json
  severity: high
  tags: yonyou,nc,fileupload,baseapp,deserialization,intrusive,vuln
