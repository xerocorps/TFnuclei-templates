http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - pdf-light-viewer
  - dsl:
    - compare_versions(version, '<= 1.4.11')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/pdf-light-viewer/readme.txt'
  redirects: true
id: CVE-2021-24684
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24684
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 9.9
  description: The WordPress PDF Light Viewer Plugin WordPress plugin before 1.4.12
    allows users with Author roles to execute arbitrary OS command on the server via
    OS Command Injection when invoking Ghostscript.
  metadata:
    fofa-query: wp-content/plugins/pdf-light-viewer/
    google-query: inurl:"/wp-content/plugins/pdf-light-viewer/"
    shodan-query: vuln:CVE-2021-24684
  name: PDF Light Viewer <= 1.4.11 - Authenticated Command Injection
  reference:
  - https://wpscan.com/vulnerability/b5295bf9-8cf6-416e-b215-074742a5fc63
  severity: critical
  tags: cve,wordpress,wp-plugin,pdf-light-viewer,critical
