code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .Items.DBInstance[].DBInstanceId
    name: dbinstanceid
    type: json
  source: 'aliyun rds DescribeDBInstances --region $region

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - dbinstanceid + " Transparent Data Encryption is Disabled "
    type: dsl
  matchers:
  - type: word
    words:
    - '"TDEStatus": "Disabled"'
  source: 'aliyun rds DescribeDBInstanceTDE --DBInstanceId $dbinstanceid --region
    $region

    '
flow: "code(1)\nfor(let DBInstanceId of iterate(template.dbinstanceid)){\n  set(\"\
  dbinstanceid\", DBInstanceId)\n  code(2)\n}\n"
id: transparent-encryption-disabled
info:
  author: DhiyaneshDK
  description: 'Alibaba Cloud Transparent Data Encryption (TDE) is disabled, meaning
    sensitive data at rest is not encrypted automatically. This may expose the data
    to unauthorized access, compromising confidentiality and security.

    '
  metadata:
    max-request: 2
    verified: true
  name: Transparent Data Encryption - Disabled
  reference:
  - https://www.alibabacloud.com/help/en/rds/apsaradb-rds-for-postgresql/enable-tde-for-an-apsaradb-rds-for-postgresql-instance-and-use-tde
  - https://www.trendmicro.com/cloudoneconformity/knowledge-base/alibaba-cloud/AlibabaCloud-RDS/enable-sql-database-tde.html
  severity: medium
  tags: cloud,devops,aliyun,alibaba,alibaba-cloud-config,alibaba-rds
self-contained: true
variables:
  region: cn-hangzhou
