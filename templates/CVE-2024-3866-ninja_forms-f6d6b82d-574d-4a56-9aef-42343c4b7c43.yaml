http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - ninja-forms
  - dsl:
    - compare_versions(version, '<= 3.8.15')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/ninja-forms/readme.txt'
  redirects: true
id: CVE-2024-3866-ninja_forms-f6d6b82d-574d-4a56-9aef-42343c4b7c43
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-3866
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 4.7
  description: 'The Ninja Forms Contact Form plugin for WordPress is vulnerable to
    Reflected Self-Based Cross-Site Scripting via the ''Referer'' header in all versions
    up to, and including, 3.8.15 due to insufficient input sanitization and output
    escaping. This makes it possible for unauthenticated attackers to inject arbitrary
    web scripts in pages that execute if they can successfully trick a user into performing
    an action such as clicking on a link. Successful exploitation of this vulnerability
    requires "maintenance mode" for a targeted form to be enabled. However, there
    is no setting available to the attacker or even an administrator-level user to
    enable this mode. The mode is only enabled during a required update, which is
    a very short window of time. Additionally, because of the self-based nature of
    this vulnerability, attackers would have to rely on additional techniques to execute
    a supplied payload in the context of targeted user.

    '
  metadata:
    fofa-query: wp-content/plugins/ninja-forms/
    google-query: inurl:"/wp-content/plugins/ninja-forms/"
    shodan-query: http.html:"wp-content/plugins/ninja-forms/"
  name: 'Ninja Forms Contact Form <= 3.8.15 - Reflected Self-Based Cross-Site Scripting
    via Referer

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/f6d6b82d-574d-4a56-9aef-42343c4b7c43?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,ninja-forms,high,production
