http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '5.0')
    - compare_versions(version_by_js, '5.0')
    - compare_versions(version_by_css, '5.0')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2018-1000773-ee4dff63b0a6414b5c244935d33072cf
info:
  author: topscoder
  classification:
    cve-id: CVE-2018-1000773
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.5
  description: 'WordPress Core versions before 5.0.1 contain a CWE-20 Input Validation
    vulnerability in thumbnail processing that can result in remote code execution
    due to an incomplete fix for CVE-2017-1000600. This attack appears to be exploitable
    via thumbnail upload by an authenticated user and may require additional plugins
    in order to be exploited however this has not been confirmed at this time.

    '
  metadata:
    shodan-query: vuln:CVE-2018-1000773
  name: 'WordPress Core < 5.0.1 - PHAR Unserialization

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/1f846ffa-0dfa-4549-845a-7884a390462a?source=api-prod
  severity: low
  tags: cve,wordpress,wp-core,low
