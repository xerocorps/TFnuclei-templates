http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - thirstyaffiliates
  - dsl:
    - compare_versions(version, '<= 3.10.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/thirstyaffiliates/readme.txt'
  redirects: true
id: CVE-2022-0398-80eb23ad0014a390e320be1608464570
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-0398
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 5.4
  description: 'The ThirstyAffiliates Affiliate Link Manager WordPress plugin before
    3.10.5 does not have authorisation and Cross-Site Request Forgery checks when
    creating affiliate links, which could allow any authenticated user, such as subscriber
    to create arbitrary affiliate links, which could then be used to redirect users
    to an arbitrary website

    '
  metadata:
    fofa-query: wp-content/plugins/thirstyaffiliates/
    google-query: inurl:"/wp-content/plugins/thirstyaffiliates/"
    shodan-query: vuln:CVE-2022-0398
  name: 'ThirstyAffiliates Affiliate Link Manager <= 3.10.4 - Subscriber+ Arbitrary
    Affiliate Links Creation

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/7661d648-543e-46c8-a859-fb722a0c3fc2?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,thirstyaffiliates,low
