http:
- extractors:
  - group: 1
    part: body
    regex:
    - (?i)Micro\s+Focus\s+Open\s+Enterprise\s+Server\s+([A-Z0-9\s]+)
    - (?i)Copyright\s+([0-9]+)\s+Micro\s+Focus
    type: regex
  matchers:
  - condition: or
    dsl:
    - status_code == 200 && contains(to_lower(header), "micro focus dsd")
    - status_code == 200 && contains_any(to_lower(body), "micro focus imanager", "micro
      focus imonitor", "micro focus remote manager", "micro focus open enterprise
      server")
    type: dsl
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/nps/servlet/portalservice'
  - '{{BaseURL}}/nds'
  - '{{BaseURL}}/_LOGIN_SERVER_'
  redirects: true
  stop-at-first-match: true
id: microfocus-admin-server
info:
  author: theabhinavgaur,righettod
  classification:
    cpe: cpe:2.3:a:microfocus:enterprise_server:*:*:*:*:*:*:*:*
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    cwe-id: CWE-200
  description: Micro Focus Enterprise Server Admin panel was detected.
  metadata:
    max-request: 4
    product: enterprise_server
    shodan-query:
    - Micro Focus DSD
    - micro focus dsd
    vendor: microfocus
    verified: true
  name: Micro Focus Enterprise Server Admin Panel - Detect
  severity: info
  tags: panel,microfocus,detect,login,discovery
