id: aws-bucket-service
info:
  author: pdteam
  name: Detect websites using AWS bucket storage
  severity: info
  tags: aws,tech,bucket
requests:
- matchers:
  - condition: or
    dsl:
    - contains(tolower(all_headers), 'x-amz-bucket')
    - contains(tolower(all_headers), 'x-amz-request')
    - contains(tolower(all_headers), 'x-amz-id')
    - contains(tolower(all_headers), 'amazons3')
    part: header
    type: dsl
  - dsl:
    - contains(tolower(all_headers), 'x-guploader-uploadid')
    negative: true
    part: header
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
