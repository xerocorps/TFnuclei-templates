flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    name: token
    part: body
    regex:
    - ([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})
    type: regex
  method: GET
  path:
  - '{{BaseURL}}'
- disable-path-automerge: true
  extractors:
  - dsl:
    - token
    type: dsl
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, 'application/json')
    - contains(body, 'remaining_requests')
    type: dsl
  raw:
  - '@Host: https://app.zenscrape.com:443

    GET /api/v1/status HTTP/1.1

    Host: app.zenscrape.com

    Apikey: {{token}}

    '
id: zenscrape-api-key
info:
  author: ritikchaddha
  metadata:
    max-request: 2
    verified: true
  name: Zenscrape API Key
  reference:
  - https://github.com/trufflesecurity/trufflehog/blob/main/pkg/detectors/zenscrape/zenscrape.go
  severity: high
  tags: exposure,token,zenscrape,apikey,vuln
