code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: distributions
    type: json
  source: 'aws cloudfront list-distributions --output table --query ''DistributionList.Items[*].Id''
    --region $region --output json

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"CloudFront Origin Shield " + distribution + " not Enabled"'
    type: dsl
  matchers:
  - type: word
    words:
    - 'False'
  source: 'aws cloudfront get-distribution-config --id $distribution --query ''DistributionConfig.Origins.Items[*].OriginShield.Enabled''
    --region $region --output text

    '
flow: "code(1)\nfor(let DistributionListItemsId of iterate(template.distributions)){\n\
  \  set(\"distribution\", DistributionListItemsId)\n  code(2)\n}\n"
id: cloudfront-origin-shield
info:
  author: DhiyaneshDK
  description: 'Ensure that the Origin Shield performance optimization feature is
    enabled for all your Amazon CloudFront distributions in order to help reduce the
    load on your distribution''s origin, improve its availability, and reduce its
    operating costs.

    '
  impact: 'Not enabling CloudFront Origin Shield can lead to increased load on your
    origin server, higher latency, and greater costs due to more frequent requests
    during traffic spikes.

    '
  name: CloudFront Origin Shield - Not Enabled
  reference:
  - https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/CloudFront/enable-origin-shield.html
  - https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/origin-shield.html
  remediation: 'Enable CloudFront Origin Shield for your distributions to optimize
    cache efficiency, reduce load on your origin server, and improve content delivery
    performance during high traffic periods.

    '
  severity: medium
  tags: cloud,devops,aws,amazon,cloudfront,aws-cloud-config
self-contained: true
variables:
  region: us-west-2
