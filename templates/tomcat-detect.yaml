id: tomcat-detect
info:
  author: philippedelteil,dhiyaneshDk
  description: If an Tomcat instance is deployed on the target URL, when we send a
    request for a non existent resource we receive a Tomcat error page with version.
  metadata:
    shodan-query: title:"Apache Tomcat"
  name: Tomcat Detection
  severity: info
  tags: tech,tomcat,apache
requests:
- extractors:
  - group: 1
    regex:
    - (?i)Apache Tomcat.*([0-9]\.[0-9]+\.[0-9]+)
    type: regex
  matchers:
  - dsl:
    - contains(tolower(all_headers), "tomcat")
    type: dsl
  - condition: or
    dsl:
    - contains(tolower(body), "apache tomcat")
    - contains(tolower(body), "/manager/html")
    - contains(tolower(body), "/manager/status")
    type: dsl
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/{{randstr}}'
  stop-at-first-match: true
