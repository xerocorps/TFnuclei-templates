id: dionaea-mongodb-honeypot-detection
info:
  author: UnaPibaGeek
  description: 'A MongoDB honeypot has been identified.

    The response to the ''buildinfo'' command differs from real installations, signaling
    a possible deceptive setup.

    '
  metadata:
    max-request: 2
    product: dionaea
    vendor: mongodb
  name: Dionaea MongoDB Honeypot Detection
  severity: info
  tags: dionaea,mongodb,honeypot
tcp:
- extractors:
  - regex:
    - ([A-Za-z:0-9.]+)
    type: regex
  host:
  - '{{Hostname}}'
  - '{{Host}}:27017'
  inputs:
  - data: 3b0000003c300000ffffffffd40700000000000061646d696e2e24636d640000000000ffffffff14000000106275696c64696e666f000100000000
    type: hex
  matchers:
  - negative: true
    part: raw
    type: word
    words:
    - version
  read-size: 2048
