http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - fluent-smtp
  - dsl:
    - compare_versions(version, '< 2.0.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/fluent-smtp/readme.txt'
  redirects: true
id: CVE-2021-24528
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24528
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 5.5
  description: The FluentSMTP WordPress plugin before 2.0.1 does not sanitize parameters
    before storing the settings in the database, nor does the plugin escape the values
    before outputting them when viewing the SMTP settings set by this plugin, leading
    to a stored cross site scripting (XSS) vulnerability. Only users with roles capable
    of managing plugins can modify the plugin's settings.
  metadata:
    fofa-query: wp-content/plugins/fluent-smtp/
    google-query: inurl:"/wp-content/plugins/fluent-smtp/"
    shodan-query: vuln:CVE-2021-24528
  name: FluentSMTP <= 2.0.0 - Authenticated (Admin+) Stored Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/8b8d316b-96b2-4cdc-9da5-c9ea6108a85b
  severity: medium
  tags: cve,wordpress,wp-plugin,fluent-smtp,medium
