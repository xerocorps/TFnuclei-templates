id: cve-2020-16846
info:
  author: dwisiswant0
  description: 'SaltStack Salt through 3002. Sending crafted web requests to the Salt
    API,

    with the SSH client enabled, can result in shell injection.


    This template supports the detection part only. See references.

    '
  name: SaltStack Shell Injection
  reference: '- https://mp.weixin.qq.com/s/R8qw_lWizGyeJS0jOcYXag

    - https://github.com/vulhub/vulhub/tree/master/saltstack/CVE-2020-16846

    '
  severity: critical
  tags: cve,cve2020,saltstack
requests:
- body: token=1337&client=ssh&tgt=*&fun=a&roster=projectdiscovery&ssh_priv=nuclei
  headers:
    Content-Type: application/x-www-form-urlencoded
  matchers:
  - status:
    - 500
    type: status
  - part: header
    type: word
    words:
    - application/json
  - part: body
    type: word
    words:
    - An unexpected error occurred
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/run'
