id: servicenow-helpdesk-credential
info:
  author: ok_bye_now
  description: Detection of exposed credentials in help the help desk JS file.
  name: ServiceNow Helpdesk Credential Exposure
  reference:
  - https://jordanpotti.com/2021/02/21/ServiceNow-HelpTheHelpDeskAndTheHackers/
  severity: high
  tags: servicenow,exposure
requests:
- extractors:
  - group: 1
    regex:
    - var server = "([a-z:/0-9.-]+)"
    type: regex
  matchers:
  - type: word
    words:
    - 'var httpPassword = "encrypt:'
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{RootURL}}/HelpTheHelpDesk.jsdbx'
  redirects: true
