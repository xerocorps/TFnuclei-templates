http:
- extractors:
  - group: 1
    name: script-src-directive
    part: header
    regex:
    - (?i)(script-src[^;]+)
    type: regex
  - group: 1
    name: default-src-directive
    part: header
    regex:
    - (?i)(default-src[^;]+)
    type: regex
  matchers:
  - case-insensitive: true
    part: header
    type: word
    words:
    - Content-Security-Policy
  - part: header
    regex:
    - (?i)script-src[^;]*(?:https:|'unsafe-inline'|'unsafe-eval'|'unsafe-hashes'|\*|data:|blob:)[^;]*(?:;|$)
    - (?i)default-src[^;]*(?:https:|'unsafe-inline'|'unsafe-eval|'unsafe-hashes'|\*|data:|blob:)[^;]*(?:;|$)
    type: regex
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
id: weak-csp-detect
info:
  author: pussycat0x
  description: 'Detected misconfigured CSP directives containing unsafe and overly
    permissive keywords that weakened resource loading restrictions. This configuration
    allowed high-risk script behaviors, resulting in reduced protection against XSS
    attacks.

    '
  metadata:
    max-request: 1
    verified: true
  name: Weak Content Security Policy - Detect
  reference:
  - https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src
  - https://content-security-policy.com/
  severity: info
  tags: csp,misconfig,headers
