headless:
- extractors:
  - kval:
    - extract
    part: extract
    type: kval
  - kval:
    - extract1
    part: extract1
    type: kval
  - kval:
    - extract2
    part: extract2
    type: kval
  - kval:
    - extract3
    part: extract3
    type: kval
  - kval:
    - extract4
    part: extract4
    type: kval
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}'
  - action: waitload
  - action: script
    args:
      code: "() => {\n  return [...document.getElementsByClassName('tilk')].map(tilk\
        \ => tilk.href).join(\"\\n\")\n}\n"
    name: extract
  - action: script
    args:
      code: "() => {\n  var nextPageElement = document.querySelector('.sb_pagN.sb_pagN_bp.b_widePag.sb_bp');\n\
        \  if (nextPageElement) {\n    nextPageElement.click();\n  } else {\n    var\
        \ currentPageElement = document.querySelector('.sb_pagS.sb_pagS_bp.b_widePag.sb_bp');\n\
        \    if (currentPageElement) {\n        var currentListItem = currentPageElement.parentElement;\n\
        \        if (currentListItem) {\n            var nextListItem = currentListItem.nextElementSibling;\n\
        \            if (nextListItem) {\n                var nextLink = nextListItem.querySelector('a');\n\
        \                if (nextLink) {\n                    nextLink.click();\n\
        \                }\n            }\n        }\n    }\n  }\n}\n"
    name: jump1
  - action: waitvisible
    args:
      by: xpath
      xpath: /html/body/div[1]/main/ol/li[3]/div[1]/a
  - action: script
    args:
      code: "() => {\n  return [...document.getElementsByClassName('tilk')].map(tilk\
        \ => tilk.href).join(\"\\n\")\n}\n"
    name: extract1
  - action: script
    args:
      code: "() => {\n  var nextPageElement = document.querySelector('.sb_pagN.sb_pagN_bp.b_widePag.sb_bp');\n\
        \  if (nextPageElement) {\n    nextPageElement.click();\n  } else {\n    var\
        \ currentPageElement = document.querySelector('.sb_pagS.sb_pagS_bp.b_widePag.sb_bp');\n\
        \    if (currentPageElement) {\n        var currentListItem = currentPageElement.parentElement;\n\
        \        if (currentListItem) {\n            var nextListItem = currentListItem.nextElementSibling;\n\
        \            if (nextListItem) {\n                var nextLink = nextListItem.querySelector('a');\n\
        \                if (nextLink) {\n                    nextLink.click();\n\
        \                }\n            }\n        }\n    }\n  }\n}\n"
    name: jump2
  - action: waitvisible
    args:
      by: xpath
      xpath: /html/body/div[1]/main/ol/li[3]/div[1]/a
  - action: script
    args:
      code: "() => {\n  return [...document.getElementsByClassName('tilk')].map(tilk\
        \ => tilk.href).join(\"\\n\")\n}\n"
    name: extract2
  - action: script
    args:
      code: "() => {\n  var nextPageElement = document.querySelector('.sb_pagN.sb_pagN_bp.b_widePag.sb_bp');\n\
        \  if (nextPageElement) {\n    nextPageElement.click();\n  } else {\n    var\
        \ currentPageElement = document.querySelector('.sb_pagS.sb_pagS_bp.b_widePag.sb_bp');\n\
        \    if (currentPageElement) {\n        var currentListItem = currentPageElement.parentElement;\n\
        \        if (currentListItem) {\n            var nextListItem = currentListItem.nextElementSibling;\n\
        \            if (nextListItem) {\n                var nextLink = nextListItem.querySelector('a');\n\
        \                if (nextLink) {\n                    nextLink.click();\n\
        \                }\n            }\n        }\n    }\n  }\n}\n"
    name: jump3
  - action: waitvisible
    args:
      by: xpath
      xpath: /html/body/div[1]/main/ol/li[3]/div[1]/a
  - action: script
    args:
      code: "() => {\n  return [...document.getElementsByClassName('tilk')].map(tilk\
        \ => tilk.href).join(\"\\n\")\n}\n"
    name: extract3
  - action: script
    args:
      code: "() => {\n  var nextPageElement = document.querySelector('.sb_pagN.sb_pagN_bp.b_widePag.sb_bp');\n\
        \  if (nextPageElement) {\n    nextPageElement.click();\n  } else {\n    var\
        \ currentPageElement = document.querySelector('.sb_pagS.sb_pagS_bp.b_widePag.sb_bp');\n\
        \    if (currentPageElement) {\n        var currentListItem = currentPageElement.parentElement;\n\
        \        if (currentListItem) {\n            var nextListItem = currentListItem.nextElementSibling;\n\
        \            if (nextListItem) {\n                var nextLink = nextListItem.querySelector('a');\n\
        \                if (nextLink) {\n                    nextLink.click();\n\
        \                }\n            }\n        }\n    }\n  }\n}\n"
    name: jump4
  - action: waitvisible
    args:
      by: xpath
      xpath: /html/body/div[1]/main/ol/li[3]/div[1]/a
  - action: script
    args:
      code: "() => {\n  return [...document.getElementsByClassName('tilk')].map(tilk\
        \ => tilk.href).join(\"\\n\")\n}\n"
    name: extract4
id: bing-search
info:
  author: Co5mos
  name: Bing Search
  severity: info
