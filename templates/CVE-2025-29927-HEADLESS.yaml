headless:
- extractors:
  - dsl:
    - '"Vulnerable Next.js => " + nextjs_version'
    part: nextjs_version
    type: dsl
  matchers:
  - condition: or
    dsl:
    - compare_versions(nextjs_version, '>= 11.1.4', '<= 13.5.6')
    - compare_versions(nextjs_version, '> 14.0.0', '< 14.2.25')
    - compare_versions(nextjs_version, '> 15.0.0', '< 15.2.3')
    type: dsl
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}'
  - action: waitstable
  - action: script
    args:
      code: "() => {\n  if (!window.next || !window.next.version) {\n    return \"\
        \";\n  }\n  return window.next.version;\n}\n"
    name: nextjs_version
id: CVE-2025-29927-HEADLESS
info:
  author: ademking
  classification:
    cve-id: CVE-2025-29927
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 9.1
    cwe-id: CWE-285
    epss-percentile: 0.99718
    epss-score: 0.92365
  description: 'A critical vulnerability in Next.js middleware allows attackers to
    bypass authorization checks by manipulating the x-middleware-subrequest header.
    This flaw affects Next.js versions prior to 14.2.25 and 15.2.3, potentially granting
    unauthorized access to sensitive resources.

    '
  impact: 'Unauthenticated attackers can bypass middleware authorization checks by
    manipulating the x-middleware-subrequest header, gaining unauthorized access to
    protected Next.js application routes and sensitive resources.

    '
  metadata:
    framework: node.js
    product: Next.js
    vendor: vercel
  name: Next.js Middleware Authorization Bypass
  reference:
  - https://github.com/advisories/GHSA-f82v-jwr5-mffw
  - https://nvd.nist.gov/vuln/detail/CVE-2025-29927
  - https://www.tenable.com/cve/CVE-2025-29927
  remediation: 'Upgrade to Next.js version 14.2.25, 15.2.3 or later that properly
    validates middleware subrequest headers.

    '
  severity: critical
  tags: cve,cve2025,headless,nextjs,vkev,passive,vuln
