code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: distributions
    type: json
  source: 'aws cloudfront list-distributions --output table --query ''DistributionList.Items[*].Id''
    --region $region --output json

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"Cloudfront Logging " + distribution + " is Disabled"'
    type: dsl
  matchers:
  - type: word
    words:
    - 'False'
  source: 'aws cloudfront get-distribution --id $distribution --query ''Distribution.DistributionConfig.Logging.Enabled''
    --region $region --output text

    '
flow: "code(1)\nfor(let DistributionListItemsId of iterate(template.distributions)){\n\
  \  set(\"distribution\", DistributionListItemsId)\n  code(2)\n}\n"
id: cloudfront-logging-disabled
info:
  author: DhiyaneshDK
  description: 'Ensure that access (standard) logging is enabled for your Amazon CloudFront
    distributions in order to track all viewer requests for the web content delivered
    through the Content Delivery Network (CDN).

    '
  impact: 'Disabling CloudFront logging reduces visibility into traffic patterns,
    hinders incident response and forensic analysis, compromises compliance efforts,
    and limits troubleshooting capabilities, increasing security risks.

    '
  name: Cloudfront Logging Disabled
  reference:
  - https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/CloudFront/cloudfront-logging-enabled.html
  - http://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/AccessLogs.html
  remediation: 'Enable encryption for all existing EBS volumes and ensure that all
    new volumes created are configured to use encryption by default. Additionally,
    update any snapshots to be encrypted and use AWS Key Management Service (KMS)
    to manage encryption keys securely.

    '
  severity: medium
  tags: cloud,devops,aws,amazon,cloudfront,aws-cloud-config
self-contained: true
variables:
  region: us-west-2
