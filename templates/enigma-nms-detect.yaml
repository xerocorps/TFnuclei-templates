http:
- extractors:
  - group: 1
    part: header
    regex:
    - WWW-Authenticate:\s*Basic\s+realm="([^"]+)"
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains(tolower(header), "enigma")
    - status_code == 401
    - contains(tolower(header), "www-authenticate")
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/cgi-bin/protected/main.cgi'
id: enigma-nms-detect
info:
  author: 0x_Akoko
  metadata:
    max-request: 1
    shodan-query: http.title:"ENIGMA NMS"
    verified: true
  name: Enigma NMS - Detection
  reference:
  - https://www.netsas.com.au/enigma-nms-introduction
  severity: info
  tags: tech,enigma,nms,detection,discovery
