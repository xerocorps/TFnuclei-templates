http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - 'Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, 'Better Search')
    - compare_versions(version, '< 1.4.5')
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/better-search-replace/README.txt'
  - '{{BaseURL}}/wp-content/plugins/better-search-replace/readme.txt'
  stop-at-first-match: true
id: CVE-2023-6933
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:wpengine:better_search_replace:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2023-6933
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-502
    epss-percentile: 0.99758
    epss-score: 0.92907
  description: 'The Better Search Replace plugin for WordPress is vulnerable to PHP
    Object Injection in all versions up to, and including, 1.4.4 via deserialization
    of untrusted input. This makes it possible for unauthenticated attackers to inject
    a PHP Object. No POP chain is present in the vulnerable plugin. If a POP chain
    is present via an additional plugin or theme installed on the target system, it
    could allow the attacker to delete arbitrary files, retrieve sensitive data, or
    execute code.

    '
  impact: 'Attackers can execute arbitrary code, delete files, or retrieve sensitive
    data on the server.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/better-search-replace/"
    framework: wordpress
    max-request: 1
    product: better_search_replace
    vendor: wpengine
    verified: true
  name: Better Search Replace < 1.4.5 - PHP Object Injection
  reference:
  - https://posimyth.ticksy.com/ticket/2713734/
  - https://www.wordfence.com/blog/2021/03/critical-0-day-in-the-plus-addons-for-elementor-allows-site-takeover/
  remediation: Update to the latest version of the plugin, version 1.4.5 or later.
  severity: critical
  tags: cve,cve2023,wordpress,wp-plugin,wp,wpscan,better-search-replace,passive,vkev,vuln
