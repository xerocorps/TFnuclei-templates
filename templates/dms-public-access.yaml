code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: replications
    type: json
  source: 'aws dms describe-replication-instances --region $region --query "ReplicationInstances[*].ReplicationInstanceArn"
    --output json

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"DMS Replication Instances  " + replication + " Publicly Accessible"'
    type: dsl
  matchers:
  - type: word
    words:
    - 'true'
  source: 'aws dms describe-replication-instances --region $region --filters Name=replication-instance-arn,Values=$replication
    --query "ReplicationInstances[*].PubliclyAccessible" --output json

    '
flow: "code(1)\nfor(let ReplicationInstances of iterate(template.replications)){\n\
  \  set(\"replication\", ReplicationInstances)\n  code(2)\n}\n"
id: dms-public-access
info:
  author: DhiyaneshDK
  description: 'Ensure that your Amazon Database Migration Service (DMS) are not publicly
    accessible from the Internet in order to avoid exposing private data and minimize
    security risks.

    '
  impact: 'Publicly accessible DMS replication instances expose your database to unauthorized
    access and potential attacks, increasing the risk of data breaches and compromising
    the security of sensitive information.

    '
  name: Publicly Accessible DMS Replication Instances
  reference:
  - https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/DMS/publicly-accessible.html
  - https://docs.aws.amazon.com/dms/latest/userguide/CHAP_ReplicationInstance.html
  remediation: 'Restrict access to your DMS replication instances by configuring security
    groups and network access controls to allow connections only from trusted IP addresses
    and private subnets, ensuring that they are not publicly accessible.

    '
  severity: medium
  tags: cloud,devops,aws,amazon,dms,aws-cloud-config
self-contained: true
variables:
  region: us-west-2
