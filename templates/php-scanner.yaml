file:
- extensions:
  - html
  - htm
  - phtml
  - php
  - php3
  - php4
  - php5
  - phps
  - cgi
  - inc
  - tpl
  - test
  - module
  - plugin
  extractors:
  - regex:
    - (?i)getone|getrow|getall|getcol|getassoc|execute|replace
    type: regex
  - regex:
    - var_dump
    type: regex
  - regex:
    - display_errors
    type: regex
  - regex:
    - eval
    - eval\((base64|eval|\$_|\$\$|\$[A-Za-z_0-9\{]*(\(|\{|\[))
    type: regex
  - regex:
    - exit
    - die
    type: regex
  - regex:
    - and
    type: regex
  - regex:
    - ereg
    type: regex
  - regex:
    - extract
    type: regex
  - regex:
    - echo
    - print
    - printf
    - print_r
    - vprintf
    - sprintf
    type: regex
  - regex:
    - file_get_contents
    type: regex
  - regex:
    - \\`
    type: regex
  - regex:
    - readfile
    - readlink
    - readgzfile
    type: regex
  - regex:
    - parse_st
    - mb_parse_str
    type: regex
  - regex:
    - session_regenerate
    type: regex
  - regex:
    - \\$_REQUEST
    type: regex
  - regex:
    - mysql_real_escape_string
    type: regex
  - regex:
    - import_request_variables
    type: regex
  - regex:
    - GLOBALS
    type: regex
  - regex:
    - _GET
    type: regex
  - regex:
    - _POST
    type: regex
  - regex:
    - _COOKIE
    type: regex
  - regex:
    - _SESSION
    type: regex
  - regex:
    - \\=\\=\\=
    type: regex
  - regex:
    - \\/e
    type: regex
  - regex:
    - header
    type: regex
  - regex:
    - \\$http_raw_post_data
    type: regex
  - regex:
    - __autoload
    - __destruct
    - __wakeup
    - __toString
    - __call
    - __callStatic
    - __get
    - __set
    - __isset
    - __unset
    type: regex
  - regex:
    - phpinfo
    type: regex
  - regex:
    - registerPHPFunctions
    type: regex
  - regex:
    - session_start
    type: regex
  - regex:
    - dbase_open
    type: regex
  - regex:
    - dbplus_open
    - dbplus_ropen
    type: regex
  - regex:
    - fbsql_connect
    type: regex
  - regex:
    - ifx_connect
    type: regex
  - regex:
    - db2_(p?)connect
    type: regex
  - regex:
    - ftp_(ssl_)?connect
    type: regex
  - regex:
    - ingres_(p?)connect
    type: regex
  - regex:
    - ldap_connect
    type: regex
  - regex:
    - msession_connect
    type: regex
  - regex:
    - msql_(p?)connect
    type: regex
  - regex:
    - mssql_(p?)connect
    type: regex
  - regex:
    - mysql_(p?)connect
    type: regex
  - regex:
    - mysqli((_real)?_connect)?|_query
    type: regex
  - regex:
    - oci|(_new?)|_connect|(n?|p?)logon
    type: regex
  - regex:
    - ora_(p?)connect
    type: regex
  - regex:
    - ovrimos_connect
    type: regex
  - regex:
    - pg_(p?)connect
    type: regex
  - regex:
    - sqlite_(p?)open
    type: regex
  - regex:
    - SQLite3
    type: regex
  - regex:
    - sybase_(p?)connect
    type: regex
  - regex:
    - TokyoTyrant
    type: regex
  - regex:
    - x(ptr|path)_new_context
    type: regex
  - regex:
    - GetTableFields
    type: regex
  - regex:
    - ini_get.*magic_quotes_gpc.*
    type: regex
id: php-scanner
info:
  author: geeknik
  name: PHP Scanner
  severity: info
  tags: php,file
