http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '<= 3.6.1')
    - compare_versions(version_by_js, '<= 3.6.1')
    - compare_versions(version_by_css, '<= 3.6.1')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: Yes-3ffb64ebe5daf18122a5997f9ccef2b8
info:
  author: topscoder
  classification:
    cve-id: null
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 5.5
  description: WordPress Core is vulnerable to Stored Cross-Site Scripting via the
    Customizer in versions up to 6.0.3. This is due to insufficient escaping on the
    'Blog Name' value that could be edited and become executable with the right payload
    while in the theme customizer. This would make it possible for authenticated attacker
    with access to customize a theme, such as administrators to inject malicious JavaScript
    into the page.
  metadata:
    shodan-query: 'vuln:'
  name: WordPress Core < 6.0.3 - Authenticated (Admin+) Stored Cross-Site Scripting
    via Customizer
  reference:
  - https://www.wordfence.com/blog/2022/10/patch-now-the-wordpress-6-0-3-security-update-contains-important-fixes/
  - https://wordpress.org/news/2022/10/wordpress-6-0-3-security-release/
  - https://core.trac.wordpress.org/changeset/54536/
  severity: medium
  tags: cve,wordpress,wp-core,medium
