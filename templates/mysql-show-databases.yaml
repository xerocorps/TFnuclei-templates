id: mysql-show-databases
info:
  author: DhiyaneshDk
  metadata:
    max-request: 16
    shodan-query: port:3306
    verified: true
  name: MySQL - Show Databases
  reference:
  - https://nmap.org/nsedoc/scripts/mysql-databases.html
  severity: high
  tags: js,mysql,network,enum
javascript:
- args:
    Host: '{{Host}}'
    Pass: '{{passwords}}'
    Port: '3306'
    Query: show databases;
    User: '{{usernames}}'
  attack: clusterbomb
  code: 'let m = require(''nuclei/mysql'');

    let c = m.MySQLClient();

    let response = c.ExecuteQuery(Host,Port,User,Pass,Query);

    Export(response);

    '
  extractors:
  - json:
    - .Rows[] | .Database
    part: response
    type: json
  matchers:
  - dsl:
    - success == true
    type: dsl
  payloads:
    passwords:
    - root
    - admin
    - mysql
    - test
    usernames:
    - root
    - admin
    - mysql
    - test
  stop-at-first-match: true
