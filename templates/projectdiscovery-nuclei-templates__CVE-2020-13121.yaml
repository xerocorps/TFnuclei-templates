http:
- matchers:
  - part: header
    regex:
    - (?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)(?:[a-zA-Z0-9\-_\.@]*)interact\.sh\/?(\/|[^.].*)?$
    type: regex
  raw:
  - 'POST /authentication/check_login?old=http%253A%252F%252Finteract.sh%252Fhome
    HTTP/1.1

    Host: {{Hostname}}

    Origin: {{RootURL}}

    Content-Type: application/x-www-form-urlencoded

    Referer: {{RootURL}}/authentication/login


    user_id={{username}}&password={{password}}&stay_logged_in=on&login=Login

    '
id: CVE-2020-13121
info:
  author: 0x_Akoko
  classification:
    cpe: cpe:2.3:a:rcos:submitty:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-13121
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-601
    epss-percentile: 0.94596
    epss-score: 0.1626
  description: Submitty through 20.04.01 contains an open redirect vulnerability via
    authentication/login?old= during an invalid login attempt. An attacker can redirect
    a user to a malicious site and possibly obtain sensitive information, modify data,
    and/or execute unauthorized operations.
  impact: 'An attacker can exploit this vulnerability to redirect users to malicious
    websites, leading to phishing attacks.

    '
  metadata:
    max-request: 1
    product: submitty
    vendor: rcos
  name: Submitty <= 20.04.01 - Open Redirect
  reference:
  - https://github.com/Submitty/Submitty/issues/5265
  - https://nvd.nist.gov/vuln/detail/CVE-2020-13121
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Upgrade to Submitty version 20.04.01 or later to fix the open redirect
    vulnerability.

    '
  severity: medium
  tags: cve,cve2020,redirect,submitty,oos,rcos,vuln
