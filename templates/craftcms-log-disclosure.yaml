http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - craft_cms
    - UrlManager
    - schemaVersion
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/storage/logs/web.log'
id: craftcms-log-disclosure
info:
  author: pussycat0x
  description: 'Detected exposed Craft CMS log files due to misconfiguration, allowing
    unauthenticated access to sensitive information including error messages, stack
    traces, database queries, and potentially credentials or session data.

    '
  metadata:
    fofa-query: app="Craft-CMS"
    max-request: 1
    shodan-query: http.component:"Craft CMS"
    verified: true
  name: Craft CMS - Log File Disclosure
  reference:
  - https://craftcms.com/docs/5.x/system/logging.html
  - https://craftcms.com/knowledge-base/locating-error-logs-and-database-backups
  - https://github.com/craftcms/cms/issues/3619
  severity: medium
  tags: craftcms,cms,exposure,logs,misconfig
