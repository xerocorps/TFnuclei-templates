http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '7.x-3.21')
    - compare_versions(version, '7.x-3.20')
    - compare_versions(version, '7.x-3.19')
    - compare_versions(version, '7.x-3.18')
    - compare_versions(version, '7.x-3.17')
    - compare_versions(version, '7.x-3.16')
    - compare_versions(version, '7.x-3.15')
    - compare_versions(version, '7.x-3.14')
    - compare_versions(version, '7.x-3.13')
    - compare_versions(version, '7.x-3.12')
    - compare_versions(version, '7.x-3.11')
    - compare_versions(version, '7.x-3.10')
    - compare_versions(version, '7.x-3.7')
    - compare_versions(version, '7.x-3.6')
    - compare_versions(version, '7.x-3.5')
    - compare_versions(version, '7.x-3.4')
    - compare_versions(version, '7.x-3.3')
    - compare_versions(version, '7.x-3.2')
    - compare_versions(version, '7.x-3.1')
    - compare_versions(version, '7.x-3.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - services
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/services/services.info'
  redirects: true
id: drupal_module-services-sql-injection
info:
  author: Bishopfox
  description: This module provides a standardized solution for building APIs so that
    external clients can communicate with Drupal. The module doesnt sufficiently sanitize
    user input for entity index resources thus allowing SQL Injection attacks. This
    vulnerability is mitigated by the fact that the Drupal 7 site must have an index
    resource(s) enabled under the Services endpoint configuration (admin/structure/services/list/MY-ENDPOINT/resources)
    and an attacker must know the endpoints machine name. Install the 7.x-3.22 version
    of the Services module for the fix, or simply disable any index resources to stop
    the attack vector.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/services/
    google-query: inurl:'/sites/all/modules/services/
    impact: medium
    security-risk: "Critical 19\u221525 AC:None/A:None/CI:All/II:Some/E:Theoretical/TD:Default"
    type: indicator
    vulnerability: sql-injection
  name: drupal_module-services-sql-injection
  reference:
  - https://www.drupal.org/sa-contrib-2019-026
  severity: medium
  tags: drupal
