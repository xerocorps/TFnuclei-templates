http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-svg-images
  - dsl:
    - compare_versions(version, '<= 3.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-svg-images/readme.txt'
  redirects: true
id: CVE-2021-24386
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24386
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 6.4
  description: The WP SVG images WordPress plugin before 3.4 did not sanitise the
    SVG files uploaded, which could allow low privilege users such as author+ to upload
    a malicious SVG and then perform XSS attacks by inducing another user to access
    the file directly. In v3.4, the plugin restricted such upload to editors and admin,
    with an option to also allow author to do so. The description of the plugin has
    also been updated with a security warning as upload of such content is intended.
  metadata:
    fofa-query: wp-content/plugins/wp-svg-images/
    google-query: inurl:"/wp-content/plugins/wp-svg-images/"
    shodan-query: vuln:CVE-2021-24386
  name: WP SVG Images <= 3.3 - Authenticated (author+) Stored Cross-Site Scripting
    via SVG
  reference:
  - https://wpscan.com/vulnerability/e9b48b19-14cc-41ad-a029-f7f9ae236e4e
  severity: medium
  tags: cve,wordpress,wp-plugin,wp-svg-images,medium
