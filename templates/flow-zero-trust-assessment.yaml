flow: "// Initialize Zero Trust assessment parameters\ntemplate[\"zero_trust_principles\"\
  ] = [\n  \"verify_explicitly\",\n  \"least_privilege_access\",\n  \"assume_breach\"\
  ,\n  \"continuous_monitoring\",\n  \"defense_in_depth\"\n];\n\ntemplate[\"critical_endpoints\"\
  ] = [\n  \"/admin\",\n  \"/api/admin\",\n  \"/management\",\n  \"/dashboard\",\n\
  \  \"/config\",\n  \"/api/users\",\n  \"/api/keys\",\n  \"/internal\",\n  \"/debug\"\
  \n];\n\ntemplate[\"trust_boundaries\"] = [];\ntemplate[\"access_controls\"] = [];\n\
  let zeroTrustScore = 100;\n\n// Analyze initial response for Zero Trust indicators\n\
  http(\"initial-assessment\");\n\nconst initialResponse = template[\"initial_response\"\
  ];\nconst initialHeaders = template[\"initial_headers\"];\n\nif (initialResponse\
  \ && initialHeaders) {\n  template[\"zero_trust_indicators\"] = {\n    \"authentication_required\"\
  : initialResponse.includes(\"login\") ||\n                              initialResponse.includes(\"\
  authentication\") ||\n                              initialHeaders.includes(\"WWW-Authenticate\"\
  ),\n    \"authorization_headers\": initialHeaders.includes(\"Authorization\") ||\n\
  \                           initialHeaders.includes(\"X-API-Key\") ||\n        \
  \                   initialHeaders.includes(\"Bearer\"),\n    \"session_management\"\
  : initialHeaders.includes(\"Set-Cookie\") &&\n                        (initialHeaders.includes(\"\
  Secure\") || initialHeaders.includes(\"HttpOnly\")),\n    \"rate_limiting\": initialHeaders.includes(\"\
  X-RateLimit\") ||\n                   initialHeaders.includes(\"X-Rate-Limit\"),\n\
  \    \"security_monitoring\": initialHeaders.includes(\"X-Request-ID\") ||\n   \
  \                      initialHeaders.includes(\"X-Trace-ID\")\n  };\n\n  // Calculate\
  \ initial security posture\n  if (!template[\"zero_trust_indicators\"][\"authentication_required\"\
  ]) zeroTrustScore -= 25;\n  if (!template[\"zero_trust_indicators\"][\"session_management\"\
  ]) zeroTrustScore -= 20;\n  if (!template[\"zero_trust_indicators\"][\"rate_limiting\"\
  ]) zeroTrustScore -= 15;\n  if (!template[\"zero_trust_indicators\"][\"security_monitoring\"\
  ]) zeroTrustScore -= 10;\n}\n\n// Test each critical endpoint for access controls\n\
  for (let endpoint of iterate(template[\"critical_endpoints\"])) {\n  set(\"current_endpoint\"\
  , endpoint);\n\n  // Test endpoint accessibility\n  http(\"endpoint-access-test\"\
  );\n\n  const endpointStatus = template[\"endpoint_status\"];\n  const endpointResponse\
  \ = template[\"endpoint_response\"];\n\n  template[\"endpoint_accessible\"] = (endpointStatus\
  \ === \"200\");\n  template[\"requires_authentication\"] = (endpointStatus === \"\
  401\" || endpointStatus === \"403\");\n\n  // Track trust boundary violations\n\
  \  if (endpointStatus === \"200\" && endpoint.includes(\"admin\")) {\n    template[\"\
  trust_boundaries\"].push({\n      \"endpoint\": endpoint,\n      \"violation\":\
  \ \"admin_endpoint_publicly_accessible\",\n      \"severity\": \"high\"\n    });\n\
  \    zeroTrustScore -= 30;\n  }\n\n  // Test authentication bypass attempts if endpoint\
  \ requires auth\n  if (template[\"requires_authentication\"]) {\n    http(\"auth-bypass-test\"\
  );\n\n    const bypassStatus = template[\"auth_bypass_status\"];\n    const bypassResponse\
  \ = template[\"auth_bypass_response\"];\n\n    template[\"auth_bypass_successful\"\
  ] = (\n      bypassStatus === \"200\" &&\n      bypassResponse &&\n      !bypassResponse.includes(\"\
  unauthorized\")\n    );\n\n    if (template[\"auth_bypass_successful\"]) {\n   \
  \   template[\"trust_boundaries\"].push({\n        \"endpoint\": endpoint,\n   \
  \     \"violation\": \"authentication_bypass\",\n        \"severity\": \"critical\"\
  \n      });\n      zeroTrustScore -= 40;\n    }\n  }\n\n  // Test privilege escalation\n\
  \  if (template[\"endpoint_accessible\"]) {\n    http(\"privilege-escalation-test\"\
  );\n\n    const privilegeStatus = template[\"privilege_status\"];\n    const privilegeResponse\
  \ = template[\"privilege_response\"];\n\n    template[\"privilege_escalation\"]\
  \ = (\n      privilegeStatus === \"200\" &&\n      privilegeResponse &&\n      (privilegeResponse.includes(\"\
  admin\") ||\n       privilegeResponse.includes(\"root\") ||\n       privilegeResponse.includes(\"\
  elevated\"))\n    );\n\n    if (template[\"privilege_escalation\"]) {\n      template[\"\
  trust_boundaries\"].push({\n        \"endpoint\": endpoint,\n        \"violation\"\
  : \"privilege_escalation\",\n        \"severity\": \"critical\"\n      });\n   \
  \   zeroTrustScore -= 35;\n    }\n  }\n}\n\n// Calculate final Zero Trust maturity\
  \ assessment\ntemplate[\"zero_trust_score\"] = Math.max(zeroTrustScore, 0);\ntemplate[\"\
  zero_trust_maturity\"] = zeroTrustScore > 90 ? \"Advanced\" :\n                \
  \                 zeroTrustScore > 70 ? \"Intermediate\" :\n                   \
  \              zeroTrustScore > 50 ? \"Basic\" : \"Initial\";\n\ntemplate[\"risk_level\"\
  ] = zeroTrustScore > 80 ? \"Low\" :\n                        zeroTrustScore > 60\
  \ ? \"Medium\" :\n                        zeroTrustScore > 40 ? \"High\" : \"Critical\"\
  ;\n"
http:
- extractors:
  - internal: true
    name: initial_response
    regex:
    - (?s).*
    type: regex
  - internal: true
    name: initial_headers
    part: header
    regex:
    - (?s).*
    type: regex
  id: initial-assessment
  matchers:
  - internal: true
    status:
    - 200
    - 401
    - 403
    type: status
  method: GET
  path:
  - '{{BaseURL}}'
- extractors:
  - internal: true
    name: endpoint_status
    regex:
    - HTTP/\d\.\d\s+(\d+)
    type: regex
  - internal: true
    name: endpoint_response
    regex:
    - (?s).*
    type: regex
  id: endpoint-access-test
  matchers:
  - internal: true
    status:
    - 200
    - 401
    - 403
    - 404
    type: status
  method: GET
  path:
  - '{{BaseURL}}{{current_endpoint}}'
- extractors:
  - internal: true
    name: auth_bypass_status
    regex:
    - HTTP/\d\.\d\s+(\d+)
    type: regex
  - internal: true
    name: auth_bypass_response
    regex:
    - (?s).*
    type: regex
  headers:
    X-Forwarded-For: 127.0.0.1
    X-Original-URL: /admin
    X-Real-IP: 127.0.0.1
    X-Rewrite-URL: /admin
  id: auth-bypass-test
  matchers:
  - internal: true
    status:
    - 200
    - 401
    - 403
    type: status
  method: GET
  path:
  - '{{BaseURL}}{{current_endpoint}}'
- extractors:
  - internal: true
    name: privilege_status
    regex:
    - HTTP/\d\.\d\s+(\d+)
    type: regex
  - internal: true
    name: privilege_response
    regex:
    - (?s).*
    type: regex
  headers:
    Authorization: Bearer invalid_token
    X-Privilege-Level: elevated
    X-User-Role: admin
  id: privilege-escalation-test
  matchers:
  - internal: true
    status:
    - 200
    - 401
    - 403
    type: status
  method: GET
  path:
  - '{{BaseURL}}{{current_endpoint}}'
id: flow-zero-trust-assessment
info:
  author: geeknik
  description: 'Comprehensive Zero Trust architecture evaluation using Flow Protocol
    for

    micro-segmentation and access control analysis. This template performs advanced

    Zero Trust security assessment including network segmentation testing, access

    control validation, and trust boundary analysis while maintaining defensive

    research principles for identifying Zero Trust architecture gaps.

    '
  name: Zero Trust Network Assessment
  reference:
  - https://www.nist.gov/publications/zero-trust-architecture
  - https://www.cisa.gov/zero-trust-maturity-model
  severity: medium
  tags: zero-trust,network-security,flow,access-control,defensive
