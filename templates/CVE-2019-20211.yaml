http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Version: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Version: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - citybook
  - dsl:
    - compare_versions(version, '<= 2.3.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/themes/citybook/style.css'
  redirects: true
id: CVE-2019-20211
info:
  author: topscoder
  classification:
    cve-id: CVE-2019-20211
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
  description: The CTHthemes CityBook before 2.3.4, TownHub before 1.0.6, and EasyBook
    before 1.2.2 themes for WordPress allow Persistent XSS via Listing Address, Listing
    Latitude, Listing Longitude, Email Address, Description, Name, Job or Position,
    Description, Service Name, Address, Latitude, Longitude, Phone Number, or Website.
  metadata:
    fofa-query: wp-content/themes/citybook/
    google-query: inurl:"/wp-content/themes/citybook/"
    shodan-query: vuln:CVE-2019-20211
  name: CTHthemes CityBook <= 2.3.3, TownHub <= 1.0.5, and EasyBook <= 1.2.1 - Stored
    Cross-Site Scripting
  reference:
  - https://themeforest.net/item/citybook-directory-listing-wordpress-theme/21694727
  - https://themeforest.net/item/townhub-directory-listing-wordpress-theme/25019571
  - https://themeforest.net/item/easybook-directory-listing-wordpress-theme/23206622
  - https://wpvulndb.com/vulnerabilities/10013
  - https://wpvulndb.com/vulnerabilities/10014
  - https://wpvulndb.com/vulnerabilities/10018
  - https://cxsecurity.com/issue/WLB-2019120111
  - https://cxsecurity.com/issue/WLB-2019120112
  - https://cxsecurity.com/issue/WLB-2019120110
  severity: high
  tags: cve,wordpress,wp-theme,citybook,high
