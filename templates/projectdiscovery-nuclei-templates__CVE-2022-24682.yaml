http:
- extractors:
  - group: 1
    name: detected_version
    part: body
    regex:
    - CLIENT_VERSION\",\s+{type:ZmSetting\.T_CONFIG, defaultValue:"([0-9.]+)_([A-Z_0-9]+)"\}
    type: regex
  matchers:
  - part: body
    type: word
    words:
    - Zimbra Collaboration Suite Web Client
  - part: content_type
    type: word
    words:
    - application/x-javascript
  - condition: and
    dsl:
    - compare_versions(detected_version, '< 8.8.15')
    - compare_versions(detected_version, '> 8.7.15')
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/js/zimbraMail/share/model/ZmSettings.js'
id: CVE-2022-24682
info:
  author: rxerium
  classification:
    cve-id: CVE-2022-24682
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-116
    epss-percentile: 0.99436
    epss-score: 0.87687
  description: 'An issue was discovered in the Calendar feature in Zimbra Collaboration
    Suite 8.8.x before 8.8.15 patch 30 (update 1), as exploited in the wild starting
    in December 2021. An attacker could place HTML containing executable JavaScript
    inside element attributes. This markup becomes unescaped, causing arbitrary markup
    to be injected into the document.

    '
  impact: 'Attackers can inject malicious JavaScript through the Calendar feature
    that executes in victims'' browsers, potentially stealing session tokens and accessing
    email communications of Zimbra users.

    '
  metadata:
    fofa-query: icon_hash="1624375939"
    max-request: 1
    product: collaboration
    shodan-query:
    - http.favicon.hash:"1624375939"
    - http.html:"Zimbra Collaboration Suite Web Client"
    vendor: zimbra
  name: Zimbra Collaboration Suite < 8.8.15 - Improper Encoding
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2022-24682
  - https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-228a
  remediation: 'Update Zimbra Collaboration Suite to version 8.8.15 patch 30 or later
    that properly escapes HTML in Calendar feature attributes.

    '
  severity: medium
  tags: cve,cve2022,zimbra,collaboration,xss,kev,passive,vkev,vuln
