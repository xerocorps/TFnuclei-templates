id: redis-info
info:
  author: DhiyaneshDK
  description: 'Retrieves information (such as version number and architecture) from
    a Redis key-value store.

    '
  metadata:
    fofa-query:
    - apache airflow
    - title="airflow - dags" || http.html:"apache airflow"
    - title="sign in - airflow"
    google-query:
    - intitle:"airflow - dags" || http.html:"apache airflow"
    - intitle:"sign in - airflow"
    max-request: 1
    product: airflow
    shodan-query:
    - product:"redis"
    - http.title:"airflow - dags" || http.html:"apache airflow"
    - http.title:"sign in - airflow"
    vendor: apache
  name: Redis Info - Detect
  reference:
  - https://nmap.org/nsedoc/scripts/redis-info.html
  severity: info
  tags: js,redis,network,enum,discovery
javascript:
- args:
    Host: '{{Host}}'
    Port: '6379'
  code: 'const redis = require(''nuclei/redis'');

    const info = redis.GetServerInfo(Host,Port);

    Export(info);

    '
  extractors:
  - part: response
    regex:
    - redis_version:(\d+\.\d+\.\d+)
    - os:(.*?)\\r\\n
    - arch_bits:(\d+)\s+bits
    - process_id:(\d+)
    - used_cpu_sys:(\d+\.\d+)
    - used_cpu_user:(\d+\.\d+)
    - connected_clients:(\d+)
    - connected_slaves:(\d+)
    - used_memory_human:(\d+\.\d+[KMGTPEZY]?)
    - role:(\w+)
    type: regex
  pre-condition: 'isPortOpen(Host,Port);

    '
