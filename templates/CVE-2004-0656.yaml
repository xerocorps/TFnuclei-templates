id: CVE-2004-0656
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:pureftpd:pureftpd:0.96:*:*:*:*:*:*:*
    cve-id: CVE-2004-0656
    cvss-metrics: CVSS:2.0/AV:N/AC:L/Au:N/C:N/I:N/A:P
    cvss-score: 5
    epss-percentile: 0.48804
    epss-score: 0.00256
  description: "Pure-FTPd versions \u2264 1.0.18 are vulnerable to denial of service\
    \ through connection limit exhaustion. The vulnerability occurs in the accept_client\
    \ function when the maximum number of connections is exceeded, potentially causing\
    \ the server to become unresponsive or crash.\n"
  impact: 'Attackers can exhaust server connections by sending large numbers of simultaneous
    connection requests, causing Pure-FTPd to become unresponsive or crash.

    '
  metadata:
    max-request: 1
    product: pureftpd
    shodan-query: product:"Pure-FTPd" version:"1.0.14"
    vendor: pureftpd
    verified: true
  name: "Pure-FTPd \u2264 1.0.18 - DoS via Connection Limit Exhaustion"
  reference:
  - http://www.pureftpd.org/
  - https://exchange.xforce.ibmcloud.com/vulnerabilities/16611
  remediation: 'Upgrade Pure-FTPd to version 1.0.19 or later that properly handles
    connection limit scenarios.

    '
  severity: medium
  tags: cve,cve2004,network,ftp,pure-ftpd,tcp,passive,vuln
tcp:
- extractors:
  - group: 1
    name: version
    regex:
    - Pure-FTPd ([0-9.]+)
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: 0
    type: hex
  matchers:
  - condition: and
    dsl:
    - contains(raw, 'Pure-FTPd')
    - compare_versions(version, '<= 1.0.18')
    type: dsl
  port: 21
  read-size: 1024
