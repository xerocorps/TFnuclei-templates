id: aem-fuzz
info:
  author: MRiambatman
  name: AEM FUZZ
  reference: https://speakerdeck.com/0ang3el/hunting-for-security-bugs-in-aem-webapps?slide=43
  severity: medium
  tags: aem
requests:
- attack: clusterbomb
  matchers:
  - status:
    - 200
    - 500
    - 301
    - 400
    - 302
    type: status
  - condition: and
    type: word
    words:
    - jcr:createdBy
    - Web console
    - authenticated=true
    - userid=
    - 'jcr:'
    - 'AccessKeyId:'
    - java heap space
  matchers-condition: and
  payloads:
    header: helpers/payloads/aem2.txt
  raw:
  - "GET /\xA7header\xA7 HTTP/1.1\nHost: {{Hostname}}\nUser-Agent: Mozilla/5.0 (X11;\
    \ Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0 \n"
  redirects: true
