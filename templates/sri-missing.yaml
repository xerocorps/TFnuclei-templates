http:
- extractors:
  - attribute: src
    type: xpath
    xpath:
    - //script[contains(@src,'//') and not(contains(translate(@integrity,'ABCDEFGHIJKLMNOPQRSTUVWXYZ','abcdefghijklmnopqrstuvwxyz'),'^sha'))]
  matchers:
  - part: body
    type: xpath
    xpath:
    - //script[contains(@src,'//') and not(contains(translate(@integrity,'ABCDEFGHIJKLMNOPQRSTUVWXYZ','abcdefghijklmnopqrstuvwxyz'),'^sha'))]
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  max-redirects: 5
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  redirects: true
  stop-at-first-match: false
id: sri-missing
info:
  author: lucky0x0d,PulseSecurity.co.nz
  description: 'Checks if script tags within the HTML response have Subresource Integrity
    implemented via the integrity attribute

    '
  metadata:
    max-request: 1
  name: SRI missing
  reference:
  - https://cheatsheetseries.owasp.org/cheatsheets/Third_Party_Javascript_Management_Cheat_Sheet.html#subresource-integrity
  severity: info
  tags: javascript,subresource integrity
