code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: certificatearns
    type: json
  source: 'aws acm list-certificates --region $region --certificate-statuses ISSUED
    --query ''CertificateSummaryList[*].CertificateArn'' --output json

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - certificatearn + " AWS ACM certificate is a wildcard certificate"
    type: dsl
  matchers:
  - type: word
    words:
    - '*.'
  source: 'aws acm describe-certificate --region $region --certificate-arn $certificatearn
    --query ''Certificate.DomainName''

    '
flow: "code(1)\nfor(let arns of iterate(template.certificatearns)){\n  set(\"certificatearn\"\
  , arns)\n  code(2)\n}\n"
id: acm-wildcard-cert
info:
  author: princechaddha
  description: 'Ensure ACM certificates for specific domain names are used over wildcard
    certificates to adhere to best security practices, providing unique private keys
    for each domain/subdomain.

    '
  impact: 'Using wildcard certificates can expose your AWS environment to increased
    risk by potentially allowing unauthorized subdomains to be protected under the
    same certificate, reducing the granularity of access control and increasing the
    blast radius in the event of a key compromise.

    '
  name: Wildcard ACM Certificate Usage
  reference:
  - https://docs.aws.amazon.com/acm/latest/userguide/acm-certificate.html
  remediation: 'Replace wildcard ACM certificates with single domain name certificates
    for each domain/subdomain within your AWS account. This enhances security by ensuring
    each domain/subdomain has its own unique private key and certificate.

    '
  severity: low
  tags: cloud,devops,aws,amazon,acm,aws-cloud-config
self-contained: true
variables:
  region: us-east-1
