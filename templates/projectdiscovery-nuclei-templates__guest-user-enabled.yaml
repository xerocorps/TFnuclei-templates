code:
- engine:
  - sh
  - bash
  matchers:
  - status:
    - 0
    type: status
  - regex:
    - ^1$
    type: regex
  matchers-condition: and
  source: 'defaults read /Library/Preferences/com.apple.loginwindow GuestEnabled 2>&1

    '
id: guest-user-enabled
info:
  author: geeknik
  description: 'Identifies if the guest user account is enabled on macOS, allowing
    anyone to use the computer without authentication.

    '
  impact: 'Enabling the guest user account can allow unauthorized users to access
    the system with limited, but potentially risky, privileges.

    '
  name: macOS Guest User Enabled
  remediation: 'Disable the guest user account to reduce the risk of unauthorized
    access.

    '
  severity: medium
  tags: macos,audit,local,security
self-contained: true
