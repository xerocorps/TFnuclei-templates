http:
- attack: batteringram
  matchers:
  - dsl:
    - status_code==200
    name: Open GCP App Engine App
    type: dsl
  - condition: and
    dsl:
    - status_code==302
    - contains(location, "login")
    name: Protected GCP App Engine App
    type: dsl
  raw:
  - 'GET https://{{wordlist}}.{{BaseDNS}} HTTP/1.1

    Host: {{wordlist}}.{{BaseDNS}}

    '
  redirects: false
  threads: 10
id: gcp-app-engine-enum
info:
  author: initstring
  description: 'Searches for App Engine Apps in GCP.

    '
  metadata:
    max-request: 1
    verified: true
  name: GCP App Engine (Appspot) - Cloud Enumeration
  severity: info
  tags: enum,cloud,cloud-enum,gcp,discovery
self-contained: true
variables:
  BaseDNS: appspot.com
  loginRedirect: accounts.google.com
