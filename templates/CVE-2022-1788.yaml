http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - change-uploaded-file-permissions
  - dsl:
    - compare_versions(version, '<= 4.0.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/change-uploaded-file-permissions/readme.txt'
  redirects: true
id: CVE-2022-1788
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-1788
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: Due to missing checks the Change Uploaded File Permissions WordPress
    plugin through 4.0.0 is vulnerable to CSRF attacks. This can be used to change
    the file and folder permissions of any folder. This could be problematic when
    specific files like ini files are made readable for everyone due to this.
  metadata:
    fofa-query: wp-content/plugins/change-uploaded-file-permissions/
    google-query: inurl:"/wp-content/plugins/change-uploaded-file-permissions/"
    shodan-query: vuln:CVE-2022-1788
  name: Change Uploaded File Permissions <= 4.0.0 - Cross-Site Request Forgery to
    Options Update
  reference:
  - https://wpscan.com/vulnerability/c39719e5-dadd-4414-a96d-5e70a1e3d462
  - https://plugins.trac.wordpress.org/browser/change-uploaded-file-permissions/tags/4.0.0/change-uploaded-file-permissions.php#L167
  severity: high
  tags: cve,wordpress,wp-plugin,change-uploaded-file-permissions,high
