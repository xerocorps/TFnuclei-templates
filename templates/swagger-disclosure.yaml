expression: r0() || r1() || r2() || r3() || r4() || r5() || r6() || r7() || r8() ||
  r9() || r10() || r11() || r12() || r13() || r14()
id: swagger-disclosure
info:
  author: pdteam
  name: Public Swagger API Desclosure
  severity: info
  verified: true
rules:
  r0:
    expression: "response.status == 200 && \n(response.body.bcontains(b'swagger:')\
      \ ||\nresponse.body.bcontains(b'Swagger 2.0') ||\nresponse.body.bcontains(b\"\
      \\\"swagger\\\":\") ||\nresponse.body.bcontains(b'Swagger UI') ||\nresponse.body.bcontains(b'**token**:'))\n"
    request:
      method: GET
      path: /swagger-ui.html
  r1:
    expression: "response.status == 200 && \n(response.body.bcontains(b'swagger:')\
      \ ||\nresponse.body.bcontains(b'Swagger 2.0') ||\nresponse.body.bcontains(b\"\
      \\\"swagger\\\":\") ||\nresponse.body.bcontains(b'Swagger UI') ||\nresponse.body.bcontains(b'**token**:'))\n"
    request:
      method: GET
      path: /swagger/ui/index
  r10:
    expression: "response.status == 200 && \n(response.body.bcontains(b'swagger:')\
      \ ||\nresponse.body.bcontains(b'Swagger 2.0') ||\nresponse.body.bcontains(b\"\
      \\\"swagger\\\":\") ||\nresponse.body.bcontains(b'Swagger UI') ||\nresponse.body.bcontains(b'**token**:'))\n"
    request:
      method: GET
      path: /api/index.html
  r11:
    expression: "response.status == 200 && \n(response.body.bcontains(b'swagger:')\
      \ ||\nresponse.body.bcontains(b'Swagger 2.0') ||\nresponse.body.bcontains(b\"\
      \\\"swagger\\\":\") ||\nresponse.body.bcontains(b'Swagger UI') ||\nresponse.body.bcontains(b'**token**:'))\n"
    request:
      method: GET
      path: /api/docs/
  r12:
    expression: "response.status == 200 && \n(response.body.bcontains(b'swagger:')\
      \ ||\nresponse.body.bcontains(b'Swagger 2.0') ||\nresponse.body.bcontains(b\"\
      \\\"swagger\\\":\") ||\nresponse.body.bcontains(b'Swagger UI') ||\nresponse.body.bcontains(b'**token**:'))\n"
    request:
      method: GET
      path: /api_docs
  r13:
    expression: "response.status == 200 && \n(response.body.bcontains(b'swagger:')\
      \ ||\nresponse.body.bcontains(b'Swagger 2.0') ||\nresponse.body.bcontains(b\"\
      \\\"swagger\\\":\") ||\nresponse.body.bcontains(b'Swagger UI') ||\nresponse.body.bcontains(b'**token**:'))\n"
    request:
      method: GET
      path: /api/swagger-ui.html
  r14:
    expression: "response.status == 200 && \n(response.body.bcontains(b'swagger:')\
      \ ||\nresponse.body.bcontains(b'Swagger 2.0') ||\nresponse.body.bcontains(b\"\
      \\\"swagger\\\":\") ||\nresponse.body.bcontains(b'Swagger UI') ||\nresponse.body.bcontains(b'**token**:'))\n"
    request:
      method: GET
      path: /v2/api-docs
  r2:
    expression: "response.status == 200 && \n(response.body.bcontains(b'swagger:')\
      \ ||\nresponse.body.bcontains(b'Swagger 2.0') ||\nresponse.body.bcontains(b\"\
      \\\"swagger\\\":\") ||\nresponse.body.bcontains(b'Swagger UI') ||\nresponse.body.bcontains(b'**token**:'))\n"
    request:
      method: GET
      path: /swagger/index.html
  r3:
    expression: "response.status == 200 && \n(response.body.bcontains(b'swagger:')\
      \ ||\nresponse.body.bcontains(b'Swagger 2.0') ||\nresponse.body.bcontains(b\"\
      \\\"swagger\\\":\") ||\nresponse.body.bcontains(b'Swagger UI') ||\nresponse.body.bcontains(b'**token**:'))\n"
    request:
      method: GET
      path: /swagger/swagger-ui.html
  r4:
    expression: "response.status == 200 && \n(response.body.bcontains(b'swagger:')\
      \ ||\nresponse.body.bcontains(b'Swagger 2.0') ||\nresponse.body.bcontains(b\"\
      \\\"swagger\\\":\") ||\nresponse.body.bcontains(b'Swagger UI') ||\nresponse.body.bcontains(b'**token**:'))\n"
    request:
      method: GET
      path: /api-docs/swagger.json
  r5:
    expression: "response.status == 200 && \n(response.body.bcontains(b'swagger:')\
      \ ||\nresponse.body.bcontains(b'Swagger 2.0') ||\nresponse.body.bcontains(b\"\
      \\\"swagger\\\":\") ||\nresponse.body.bcontains(b'Swagger UI') ||\nresponse.body.bcontains(b'**token**:'))\n"
    request:
      method: GET
      path: /api-docs/swagger.yaml
  r6:
    expression: "response.status == 200 && \n(response.body.bcontains(b'swagger:')\
      \ ||\nresponse.body.bcontains(b'Swagger 2.0') ||\nresponse.body.bcontains(b\"\
      \\\"swagger\\\":\") ||\nresponse.body.bcontains(b'Swagger UI') ||\nresponse.body.bcontains(b'**token**:'))\n"
    request:
      method: GET
      path: /swagger.json
  r7:
    expression: "response.status == 200 && \n(response.body.bcontains(b'swagger:')\
      \ ||\nresponse.body.bcontains(b'Swagger 2.0') ||\nresponse.body.bcontains(b\"\
      \\\"swagger\\\":\") ||\nresponse.body.bcontains(b'Swagger UI') ||\nresponse.body.bcontains(b'**token**:'))\n"
    request:
      method: GET
      path: /swagger.yaml
  r8:
    expression: "response.status == 200 && \n(response.body.bcontains(b'swagger:')\
      \ ||\nresponse.body.bcontains(b'Swagger 2.0') ||\nresponse.body.bcontains(b\"\
      \\\"swagger\\\":\") ||\nresponse.body.bcontains(b'Swagger UI') ||\nresponse.body.bcontains(b'**token**:'))\n"
    request:
      method: GET
      path: /swagger/v1/swagger.json
  r9:
    expression: "response.status == 200 && \n(response.body.bcontains(b'swagger:')\
      \ ||\nresponse.body.bcontains(b'Swagger 2.0') ||\nresponse.body.bcontains(b\"\
      \\\"swagger\\\":\") ||\nresponse.body.bcontains(b'Swagger UI') ||\nresponse.body.bcontains(b'**token**:'))\n"
    request:
      method: GET
      path: /swagger/v1/swagger.yaml
