id: ssh-password-auth
info:
  author: princechaddha
  metadata:
    max-request: 2
    shodan-query: product:"OpenSSH"
    verified: true
  name: SSH Password-based Authentication
  reference:
  - https://nmap.org/nsedoc/scripts/ssh-auth-methods.html
  severity: info
  tags: ssh,js,enum,network
javascript:
- args:
    Host: '{{Host}}'
    Port: '22'
  code: 'var m = require("nuclei/ssh");

    var c = m.SSHClient();

    var response = c.ConnectSSHInfoMode(Host, Port);

    to_json(response);

    '
  matchers:
  - condition: and
    type: word
    words:
    - '"UserAuth":'
    - '"password"'
  pre-condition: 'isPortOpen(Host,Port);

    '
