http:
- extractors:
  - name: fcm-server-key
    part: body
    regex:
    - AAAA[A-Za-z0-9_-]{7}:[A-Za-z0-9_-]{140}
    type: regex
  matchers:
  - part: body
    regex:
    - AAAA[A-Za-z0-9_-]{7}:[A-Za-z0-9_-]{140}
    type: regex
  - condition: or
    part: body
    type: word
    words:
    - firebaseConfig
    - serverKey
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/'
  - '{{BaseURL}}/firebase-messaging-sw.js'
  - '{{BaseURL}}/manifest.json'
  stop-at-first-match: true
id: firebase-fcm-server-key-disclosure
info:
  author: 0x_Akoko
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 5.4
    cwe-id: CWE-200
  description: 'Detected Firebase Cloud Messaging (FCM) legacy server keys were identified
    in client-side files. These keys can be used to send push notifications to any
    device.

    '
  metadata:
    max-request: 3
    verified: true
  name: Firebase Cloud Messaging - Server Key Disclosure
  reference:
  - https://firebase.google.com/docs/cloud-messaging
  severity: medium
  tags: firebase,google,fcm,server-key,exposure
