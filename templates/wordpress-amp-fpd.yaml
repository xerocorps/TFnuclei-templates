http:
- matchers:
  - condition: and
    dsl:
    - contains_all(body, "Fatal error", "Uncaught Error:") || contains_all(body, "Warning:",
      "failed to open stream")
    - contains(body, "accelerated-mobile-pages")
    - status_code == 200 || status_code == 500
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/accelerated-mobile-pages/includes/options/redux-core/framework.php'
  - '{{BaseURL}}/wp-content/plugins/accelerated-mobile-pages/includes/options/admin-config.php'
  - '{{BaseURL}}/wp-content/plugins/accelerated-mobile-pages/includes/thirdparty-compatibility.php'
  - '{{BaseURL}}/wp-content/plugins/accelerated-mobile-pages/templates/starter-flavor.php'
  - '{{BaseURL}}/wp-content/plugins/accelerated-mobile-pages/classes/class-flavor.php'
  stop-at-first-match: true
id: wordpress-amp-fpd
info:
  author: pussycat0x
  description: 'The WordPress AMP - Accelerated Mobile Pages plugin was detected to
    be vulnerable to Full Path Disclosure, allowing unauthenticated access to the
    full application path.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/accelerated-mobile-pages"
    max-request: 5
    product: accelerated-mobile-pages
    vendor: wordpress
  name: WordPress AMP - Full Path Disclosure
  reference:
  - https://wordpress.org/plugins/accelerated-mobile-pages/
  severity: low
  tags: wordpress,wp,wp-plugin,accelerated-mobile-pages,fpd
