http:
- extractors:
  - group: 1
    internal: true
    name: token
    part: body
    regex:
    - id="CSRFToken" name="CSRFToken" value="([^"]+)"
    type: regex
  raw:
  - 'GET /hp/device/SignIn/Index HTTP/1.1

    Host: {{Hostname}}

    Accept-Encoding: identity

    Accept-Language: en

    '
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - 'User: Administrator'
    - Sign out
  - part: header
    regex:
    - 'Set-Cookie: .*session.*'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: or
  max-redirects: 2
  raw:
  - 'POST /hp/device/SignIn/Index HTTP/1.1

    Host: {{Hostname}}

    Accept-Encoding: identity

    Content-Type: application/x-www-form-urlencoded

    Origin: {{RootURL}}

    Referer: {{RootURL}}/hp/device/SignIn/Index


    CSRFToken={{token}}&agentIdSelect=hp_EmbeddedPin_v1&PinDropDown=AdminItem&PasswordTextBox=&signInOk=Sign+In

    '
  redirects: true
id: hp-printer-default-login
info:
  author: JohnAsbjorn
  description: 'HP printers often allow administrative access without requiring a
    password by default. This behavior enables anyone to log in as the Administrator
    without authentication, potentially exposing sensitive settings or functions.

    '
  metadata:
    max-request: 2
    shodan-query: html:"hp/device/SignIn/Index"
    verified: true
  name: Hewlett Packard LaserJet Printer - Default Login
  reference:
  - https://h30434.www3.hp.com/t5/Printing-Errors-or-Lights-Stuck-Print-Jobs/What-is-the-user-name-and-password-in-Embedded-Web-Server/td-p/6165417
  severity: high
  tags: hp,printer,default-login,vuln
