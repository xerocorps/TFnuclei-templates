http:
- matchers:
  - name: pgpass
    regex:
    - ([a-zA-Z0-9.-]+):5432:([a-zA-Z0-9_*-]+):([a-zA-Z0-9_-]+):(.+)
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/.pgpass'
id: postgres-credentials-exposure
info:
  author: theamanrawat
  description: 'Detects the exposure of PostgreSQL credentials and history files (.pgpass)
    via HTTP. These files may contain plaintext database usernames and passwords,
    and their leakage could allow unauthorized access to sensitive databases or internal
    infrastructure.

    '
  name: PostgreSQL Credentials - Exposure
  reference:
  - https://www.postgresql.org/docs/current/libpq-pgpass.html
  - https://cheatsheetseries.owasp.org/cheatsheets/Database_Security_Cheat_Sheet.html#postgresql
  severity: high
  tags: exposure,config,postgres,database
