id: clamav-unauth
info:
  author: dwisiswant0
  description: 'ClamAV server 0.99.2, and possibly other previous versions, allow
    the execution

    of dangerous service commands without authentication. Specifically, the command
    ''SCAN''

    may be used to list system files and the command ''SHUTDOWN'' shut downs the service.

    '
  metadata:
    max-request: 1
    shodan-query: port:3310 product:"ClamAV" version:"0.99.2"
    verified: true
  name: ClamAV Server - Unauthenticated Access
  reference:
  - https://seclists.org/nmap-dev/2016/q2/201
  - https://bugzilla.clamav.net/show_bug.cgi?id=11585
  severity: high
  tags: network,clamav,unauth,seclists,misconfig
tcp:
- host:
  - '{{Hostname}}'
  inputs:
  - data: "SCAN /nonexistent/{{to_lower(rand_text_alpha(10))}}\r\n"
  matchers:
  - condition: and
    type: word
    words:
    - No such
    - lstat() failed
  port: 3310
  read-size: 48
