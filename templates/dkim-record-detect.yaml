dns:
- extractors:
  - regex:
    - v=DKIM1(.+)
    type: regex
  matchers:
  - case-insensitive: true
    type: word
    words:
    - v=DKIM1
  - negative: false
    regex:
    - p=[A-Za-z0-9+/]{20,}
    type: regex
  matchers-condition: and
  name: '{{selector}}._domainkey.{{FQDN}}'
  payloads:
    selector:
    - default
    - selector1
    - selector2
    - google
    - k1
    - s1
    - s2
    - dkim
    - mail
    - email
  type: TXT
id: dkim-record-detect
info:
  author: princechaddha
  description: 'A DKIM (DomainKeys Identified Mail) TXT record was detected. DKIM
    is an email authentication method that allows the receiver to check that an email
    claimed to have come from a specific domain was indeed authorized by the owner
    of that domain.

    '
  metadata:
    max-request: 10
  name: DKIM Record - Detection
  reference:
  - https://www.rfc-editor.org/rfc/rfc6376
  - https://dkim.org/
  severity: info
  tags: dns,dkim,email,discovery
