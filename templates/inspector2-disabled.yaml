code:
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"Amazon Inspector 2 " + region + " is Disabled"'
    type: dsl
  matchers:
  - type: word
    words:
    - '"DISABLED"'
  source: 'aws inspector2 batch-get-account-status --region $region --query ''accounts[*].[accountId,state.status]''
    --output json

    '
id: inspector2-disabled
info:
  author: DhiyaneshDK
  description: 'Ensure that the new version of Amazon Inspector is enabled in order
    to help you improve the security and compliance of your AWS cloud environment.

    '
  impact: 'Amazon Inspector 2 disabled increases the risk of unaddressed vulnerabilities
    in your EC2 instances, Lambda functions, and container images, leaving your environment
    exposed to potential security threats.

    '
  name: Amazon Inspector 2 - Disabled
  reference:
  - https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/Inspector2/enable-amazon-inspector2.html
  - https://aws.amazon.com/about-aws/whats-new/2021/11/amazon-inspector-continual-vulnerability-management/
  remediation: 'Enable Amazon Inspector 2 to automatically scan for vulnerabilities
    in EC2 instances, Lambda functions, and container images by using the AWS Management
    Console or using the AWS CLI.

    '
  severity: info
  tags: cloud,devops,aws,amazon,inspector2,aws-cloud-config
self-contained: true
variables:
  region: us-west-2
