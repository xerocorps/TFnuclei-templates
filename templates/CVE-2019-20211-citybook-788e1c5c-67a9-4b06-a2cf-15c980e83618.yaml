http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Version:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - citybook
  - dsl:
    - compare_versions(version, '<= 2.3.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/themes/citybook/style.css'
  redirects: true
id: CVE-2019-20211-citybook-788e1c5c-67a9-4b06-a2cf-15c980e83618
info:
  author: topscoder
  classification:
    cve-id: CVE-2019-20211
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
  description: 'The CTHthemes CityBook before 2.3.4, TownHub before 1.0.6, and EasyBook
    before 1.2.2 themes for WordPress allow Persistent XSS via Listing Address, Listing
    Latitude, Listing Longitude, Email Address, Description, Name, Job or Position,
    Description, Service Name, Address, Latitude, Longitude, Phone Number, or Website.

    '
  metadata:
    fofa-query: wp-content/themes/citybook/
    google-query: inurl:"/wp-content/themes/citybook/"
    shodan-query: http.html:"wp-content/themes/citybook/"
  name: 'CTHthemes CityBook <= 2.3.3, TownHub <= 1.0.5, and EasyBook <= 1.2.1 - Stored
    Cross-Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/788e1c5c-67a9-4b06-a2cf-15c980e83618?source=api-prod
  severity: high
  tags: cve,wordpress,wp-theme,citybook,high,production
