http:
- extractors:
  - internal: true
    name: aadhar-with-spaces
    part: body
    regex:
    - '[2-9]{1}[0-9]{3}\s[0-9]{4}\s[0-9]{4}'
    type: regex
  - internal: true
    name: aadhar-without-spaces
    part: body
    regex:
    - '[2-9]{1}[0-9]{11}'
    type: regex
  - internal: true
    name: pan-cards
    part: body
    regex:
    - '[A-Z]{5}[0-9]{4}[A-Z]{1}'
    type: regex
  - internal: true
    name: context-aadhar
    part: body
    regex:
    - .{0,50}[2-9]{1}[0-9]{3}\s?[0-9]{4}\s?[0-9]{4}.{0,50}
    type: regex
  - internal: true
    name: context-pan
    part: body
    regex:
    - .{0,50}[A-Z]{5}[0-9]{4}[A-Z]{1}.{0,50}
    type: regex
  - kval:
    - content_type
    name: content-type
    type: kval
  headers:
    Accept: '*/*'
    User-Agent: Mozilla/5.0 (compatible; SecurityScanner/1.0)
  matchers:
  - condition: or
    name: identity-documents
    part: body
    regex:
    - '[2-9]{1}[0-9]{3}\s[0-9]{4}\s[0-9]{4}'
    - '[2-9]{1}[0-9]{11}'
    - '[A-Z]{5}[0-9]{4}[A-Z]{1}'
    - (?i)(aadhar|aadhaar|uid|unique.?id).{0,50}[2-9]{1}[0-9]{3}\s?[0-9]{4}\s?[0-9]{4}
    - (?i)(pan.?card|pan.?number|permanent.?account).{0,50}[A-Z]{5}[0-9]{4}[A-Z]{1}
    - '"(aadhar|aadhaar|uid|pan)".{0,30}"?[2-9]{1}[0-9]{3}\\s?[0-9]{4}\\s?[0-9]{4}"?'
    - '"(pan.?card|pan.?number)".{0,30}"?[A-Z]{5}[0-9]{4}[A-Z]{1}"?'
    type: regex
  - status:
    - 200
    - 201
    - 400
    - 403
    - 404
    - 500
    type: status
  matchers-condition: and
  method: GET
  negative:
  - case-insensitive: true
    condition: or
    part: body
    type: word
    words:
    - example
    - sample
    - dummy
    - test data
    - placeholder
    - XXXXX
    - '12345'
    - '00000'
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/'
  - '{{BaseURL}}/index'
  - '{{BaseURL}}/home'
  - '{{BaseURL}}/login'
  - '{{BaseURL}}/register'
  - '{{BaseURL}}/profile'
  - '{{BaseURL}}/account'
  - '{{BaseURL}}/user'
  - '{{BaseURL}}/users'
  - '{{BaseURL}}/dashboard'
  - '{{BaseURL}}/admin'
  - '{{BaseURL}}/kyc'
  - '{{BaseURL}}/verification'
  - '{{BaseURL}}/documents'
  - '{{BaseURL}}/verify'
  - '{{BaseURL}}/onboarding'
  - '{{BaseURL}}/api'
  - '{{BaseURL}}/api/users'
  - '{{BaseURL}}/api/user'
  - '{{BaseURL}}/api/profile'
  - '{{BaseURL}}/api/customers'
  - '{{BaseURL}}/api/kyc'
  - '{{BaseURL}}/api/verification'
  - '{{BaseURL}}/api/documents'
  - '{{BaseURL}}/rest/users'
  - '{{BaseURL}}/v1/users'
  - '{{BaseURL}}/v2/users'
  - '{{BaseURL}}/uploads'
  - '{{BaseURL}}/files'
  - '{{BaseURL}}/media'
  - '{{BaseURL}}/static/uploads'
  - '{{BaseURL}}/assets/uploads'
  - '{{BaseURL}}/public/uploads'
  - '{{BaseURL}}/storage'
  - '{{BaseURL}}/download'
  - '{{BaseURL}}/attachment'
  - '{{BaseURL}}/debug'
  - '{{BaseURL}}/error'
  - '{{BaseURL}}/test'
  - '{{BaseURL}}/dev'
  - '{{BaseURL}}/logs'
  - '{{BaseURL}}/trace'
  - '{{BaseURL}}/exception'
id: aadhar-pan-scanner-spaces
info:
  author: gigachad80
  classification:
    cve-id: N/A
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-200
  description: 'Comprehensive detection template for exposed Indian identity documents
    including:

    - Aadhar cards (with and without spaces)

    - PAN cards

    - Covers web pages, APIs, file endpoints, and error pages

    '
  metadata:
    max-request: 25
    shodan-query: N/A
    verified: true
  name: Indian Identity Cards Detection (Aadhar with spaces & PAN)
  reference:
  - https://uidai.gov.in/
  - https://www.incometax.gov.in/
  severity: critical
  tags: exposure,aadhar,aadhaar,pan,pii,india,sensitive-data,identity,comprehensive
