id: rlogin-detect
info:
  author: pussycat0x
  description: 'rlogin was a remote login protocol that allowed users to access UNIX
    systems over TCP port 513.  It transmitted credentials and session data in plaintext,
    which made it insecure and obsolete once SSH was introduced.

    '
  metadata:
    max-request: 1
    shodan-query: rlogin
    verified: true
  name: Rlogin Detect
  reference:
  - https://www.ibm.com/docs/en/aix/7.1.0?topic=r-rlogin-command
  severity: info
  tags: rlogin,network,js,tcp,discovery
javascript:
- args:
    Host: '{{Host}}'
    Port: 513
  code: 'let packet = bytes.NewBuffer();

    const c = require("nuclei/net");

    const cmd = "\x00"

    packet.WriteString(cmd)

    let conn = c.Open(''tcp'', `${Host}:${Port}`);

    conn.SendHex(packet.Hex());

    const result = conn.RecvFullString()

    result

    '
  matchers:
  - condition: and
    dsl:
    - success == true
    - contains(response, "rlogin")
    type: dsl
  pre-condition: 'isPortOpen(Host,Port);

    '
