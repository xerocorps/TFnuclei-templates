id: github-gitlab-recovery-code
info:
  author: osamahamad
  description: Dislcosure of github OR gitlab 2fa recovery code due to unsafe recovery
    code generation via SSH
  name: Disclosure of github or gitlab 2FA recovery code.
  severity: high
  tags: custom
requests:
- matchers:
  - part: body
    regex:
    - ^([a-z0-9A-Z]{16})$
    type: regex
  - part: header
    type: word
    words:
    - text/plain
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/app/gitlab-recovery-codes.txt'
  - '{{BaseURL}}/gitlab/gitlab-recovery-codes.txt'
  - '{{BaseURL}}/gitlab-recovery-codes.txt'
  - '{{BaseURL}}/uploads/github-recovery-codes.txt'
  - '{{BaseURL}}/github-recovery-codes.txt'
  - '{{BaseURL}}/github/github-recovery-codes.txt'
  - http://gitlab.{{Hostname}}/gitlab-recovery-codes.txt
  - http://github.{{Hostname}}/github-recovery-codes.txt
  - https://gitlab.{{Hostname}}/github-recovery-codes.txt
  - https://github.{{Hostname}}/github-recovery-codes.txt
