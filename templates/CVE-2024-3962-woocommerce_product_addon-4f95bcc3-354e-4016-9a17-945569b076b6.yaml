http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - woocommerce-product-addon
  - dsl:
    - compare_versions(version, '<= 32.0.18')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/woocommerce-product-addon/readme.txt'
  redirects: true
id: CVE-2024-3962-woocommerce_product_addon-4f95bcc3-354e-4016-9a17-945569b076b6
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-3962
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The Product Addons & Fields for WooCommerce plugin for WordPress is
    vulnerable to arbitrary file uploads due to missing file type validation in the
    ppom_upload_file function in all versions up to, and including, 32.0.18. This
    makes it possible for unauthenticated attackers to upload arbitrary files on the
    affected site''s server which may make remote code execution possible. Successful
    exploitation requires the PPOM Pro plugin to be installed along with a WooCommerce
    product that contains a file upload field to retrieve the correct nonce.

    '
  metadata:
    fofa-query: wp-content/plugins/woocommerce-product-addon/
    google-query: inurl:"/wp-content/plugins/woocommerce-product-addon/"
    shodan-query: http.html:"wp-content/plugins/woocommerce-product-addon/"
  name: 'Product Addons & Fields for WooCommerce <= 32.0.18 - Unauthenticated Arbitrary
    File Upload via ppom_upload_file

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/4f95bcc3-354e-4016-9a17-945569b076b6?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,woocommerce-product-addon,critical,production
