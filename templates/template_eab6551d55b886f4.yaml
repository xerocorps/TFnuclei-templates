info:
  author: OpenAI
  classification:
    country: any
    tags:
    - confluence
    - oauth
    - security
  description: Detect Confluence OAuth Administration Endpoint
  id: confluence-oauth-admin
  matcher-condition: or
  matchers:
  - pattern: OAuth Client Administration
  - description: Confluence OAuth Administration Endpoint found in the response body
    pattern: <title>OAuth Consumer Information
    type: body
  name: Confluence OAuth Administration Endpoint - Detect
  reference:
  - https://confluence.atlassian.com/doc/oauth-security-architecture-156197.html
  requests:
    condition: or
    description: Attempt to retrieve Confluence OAuth administration endpoint
    method: GET
    path:
    - /plugins/servlet/oauth/admin/clients
    - /plugins/servlet/oauth/view-consumer-info
    - /confluence/plugins/servlet/oauth/view-consumer-info
  response:
  - description: Successful response status
    status:
    - 200
  severity: Low
