id: CVE-2008-0702
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:south_river_technologies:titan_ftp_server:6.0.5.549:*:*:*:*:*:*:*
    cve-id: CVE-2008-0702
    cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:C/I:C/A:C
    cvss-score: 9.3
    cwe-id: CWE-119
    epss-percentile: 0.87771
    epss-score: 0.03827
  description: 'Titan FTP Server versions 6.03 and 6.05 (builds) contain multiple
    heap-based buffer overflow vulnerabilities. Remote attackers can cause denial
    of service (daemon crash) or potentially execute arbitrary code by sending excessively
    long USER, PASS, or other FTP commands that trigger heap overflows.

    '
  impact: 'Unauthenticated attackers can send excessively long USER, PASS, or other
    FTP commands to trigger heap overflows, causing denial of service by crashing
    the daemon or potentially executing arbitrary code on the server.

    '
  metadata:
    max-request: 1
    product: titan_ftp_server
    shodan-query: product:"Titan ftpd" version:"16.00.2672"
    vendor: south_river_technologies
    verified: true
  name: Titan FTP Server 6.03 and 6.0.5.549 - Heap Overflow via Long Commands
  reference:
  - http://securityreason.com/securityalert/3639
  - http://www.vupen.com/english/advisories/2008/0393
  - https://www.exploit-db.com/exploits/5036
  remediation: 'Update Titan FTP Server to a version newer than 6.05 build 549 that
    properly validates command length and prevents heap overflow vulnerabilities in
    FTP command handlers.

    '
  severity: critical
  tags: cve,cve2008,network,ftp,titan-ftp,tcp,passive,vuln
tcp:
- extractors:
  - group: 1
    name: version
    regex:
    - Titan FTP Server ([0-9.]+)
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: 0
    type: hex
  matchers:
  - condition: and
    dsl:
    - contains(raw, 'Titan')
    - contains(version, '6.03') || contains(version, '6.0.5.549')
    type: dsl
  port: 21
  read-size: 1024
