code:
- engine:
  - sh
  - bash
  matchers:
  - regex:
    - ^-rws.*
    - ^-..s.*
    type: regex
  source: 'find /usr/local /opt /Applications -perm -4000 -o -perm -2000 -type f -ls
    2>/dev/null

    '
id: suid-sgid-files
info:
  author: geeknik
  description: 'Discovers files with SUID or SGID permissions in user-writable directories
    (/usr/local, /opt, /Applications) that could be exploited for privilege escalation
    if misconfigured or vulnerable.

    '
  impact: 'Misconfigured SUID/SGID executables in user-writable directories can be
    exploited by local users to gain elevated privileges.

    '
  name: macOS SUID/SGID Files Detection
  remediation: 'Review the list of SUID/SGID files and remove the permissions if they
    are not necessary.

    '
  severity: high
  tags: macos,audit,local,security,privesc
self-contained: true
