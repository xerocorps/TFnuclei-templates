http:
- matchers:
  - part: body
    type: word
    words:
    - '49'
  - negative: true
    part: body
    type: word
    words:
    - 7*7
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/?name={{payload}}'
  - '{{BaseURL}}/?id={{payload}}'
  - '{{BaseURL}}/?q={{payload}}'
  payloads:
    payload:
    - '{{7*7}}'
    - '{{7[''multiply''](7)}}'
    - '{self::get_defined_constants()}{7*7}'
    - <%= 7 * 7 %>
    - '{{{7*7}}}'
  stop-at-first-match: true
id: advanced-ssti-waf-bypass
info:
  author: thenawabx
  description: Targeted at multiple template engines (Jinja2, Twig, Smarty) using
    mathematical payloads to confirm execution.
  name: Advanced SSTI Detector (WAF Bypass)
  severity: critical
  tags: ssti, advanced, waf-bypass, rce
