http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - photoswipe-masonry
  - dsl:
    - compare_versions(version, '<= 1.2.14')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/photoswipe-masonry/readme.txt'
  redirects: true
id: CVE-2022-0750
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-0750
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 6.4
  description: The Photoswipe Masonry Gallery WordPress plugin is vulnerable to Cross-Site
    Scripting due to insufficient escaping and sanitization of the thumbnail_width,
    thumbnail_height, max_image_width, and max_image_height parameters  found in the
    ~/photoswipe-masonry.php file which allows authenticated attackers to inject arbitrary
    web scripts into galleries created by the plugin and on the PhotoSwipe Options
    page. This affects versions up to and including 1.2.14.
  metadata:
    fofa-query: wp-content/plugins/photoswipe-masonry/
    google-query: inurl:"/wp-content/plugins/photoswipe-masonry/"
    shodan-query: vuln:CVE-2022-0750
  name: Photoswipe Masonry Gallery <= 1.2.14 Stored Cross-Site Scripting
  reference:
  - https://wordpress.org/plugins/photoswipe-masonry/
  - https://www.wordfence.com/blog/2022/02/stored-cross-site-scripting-vulnerability-patched-in-a-wordpress-photo-gallery-plugin/
  severity: medium
  tags: cve,wordpress,wp-plugin,photoswipe-masonry,medium
