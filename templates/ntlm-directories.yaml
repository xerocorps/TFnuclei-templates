http:
- extractors:
  - kval:
    - www_authenticate
    type: kval
  matchers:
  - dsl:
    - 'contains(tolower(all_headers), ''www-authenticate: ntlm'')'
    type: dsl
  - status:
    - 401
    type: status
  matchers-condition: and
  payloads:
    path:
    - /
    - /abs/
    - /ecp/
    - /etc/
    - /ews/
    - /mcx/
    - /oab/
    - /owa/
    - /rgs/
    - /rpc/
    - /conf/
    - /meet/
    - /ocsp/
    - /ucwa/
    - /adfs/
    - /dialin/
    - /public/
    - /certsrv/
    - /exchweb/
    - /meeting/
    - /certprov/
    - /exchange/
    - /scheduler/
    - /webticket/
    - /autoupdate/
    - /certenroll/
    - /powershell/
    - /rgsclients/
    - /rpcwithcert/
    - /autodiscover/
    - /hybridconfig/
    - /reach/sip.svc
    - /aspnet_client/
    - /groupexpansion/
    - /persistentchat/
    - /requesthandler/
    - /unifiedmessaging/
    - /mcx/mcxservice.svc
    - /phoneconferencing/
    - /requesthandlerext/
    - /deviceupdatefiles_ext/
    - /deviceupdatefiles_int/
    - /microsoft-server-activesync/
    - /webticket/webticketservice.svc
    - /webticket/webticketservice.svcabs/
    - /adfs/services/trust/2005/windowstransport
  raw:
  - 'GET {{path}} HTTP/1.1

    Host: {{Hostname}}

    Authorization: NTLM TlRMTVNTUAABAAAAB4IIAAAAAAAAAAAAAAAAAAAAAAA=

    '
  stop-at-first-match: true
  threads: 10
id: ntlm-directories
info:
  author: puzzlepeaches,incogbyte
  name: Discovering directories w/ NTLM
  reference:
  - https://medium.com/swlh/internal-information-disclosure-using-hidden-ntlm-authentication-18de17675666
  severity: medium
  tags: iis,bypass,asp
