http:
- matchers:
  - part: header
    regex:
    - (?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)(?:[a-zA-Z0-9\-_\.@]*)interact\.sh\/?(\/|[^.].*)?$
    type: regex
  method: GET
  path:
  - '{{BaseURL}}/login?redir=http://www.interact.sh'
id: CVE-2016-3978
info:
  author: 0x_Akoko
  classification:
    cpe: cpe:2.3:o:fortinet:fortios:5.0.0:*:*:*:*:*:*:*
    cve-id: CVE-2016-3978
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.89953
    epss-score: 0.05549
  description: FortiOS Web User Interface in 5.0.x before 5.0.13, 5.2.x before 5.2.3,
    and 5.4.x before 5.4.0 allows remote attackers to redirect users to arbitrary
    web sites and conduct phishing attacks or cross-site scripting attacks via the
    "redirect" parameter to "login."
  impact: 'Successful exploitation of this vulnerability could lead to unauthorized
    access, phishing attacks, and potential data theft.

    '
  metadata:
    fofa-query:
    - body="/remote/login" "xxxxxxxx"
    - icon_hash=945408572
    max-request: 1
    product: fortios
    shodan-query:
    - http.html:"/remote/login" "xxxxxxxx"
    - http.favicon.hash:945408572
    - cpe:"cpe:2.3:o:fortinet:fortios"
    - port:10443 http.favicon.hash:945408572
    vendor: fortinet
  name: Fortinet FortiOS - Open Redirect/Cross-Site Scripting
  reference:
  - http://www.fortiguard.com/advisory/fortios-open-redirect-vulnerability
  - https://nvd.nist.gov/vuln/detail/CVE-2016-3978
  - http://seclists.org/fulldisclosure/2016/Mar/68
  - http://www.securitytracker.com/id/1035332
  remediation: 'Apply the latest security patches and updates provided by Fortinet
    to mitigate the vulnerability.

    '
  severity: medium
  tags: cve2016,cve,redirect,fortinet,fortios,seclists,vuln
