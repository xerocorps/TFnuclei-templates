http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - narnoo-distributor
  - dsl:
    - compare_versions(version, '<= 2.5.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/narnoo-distributor/readme.txt'
  redirects: true
id: CVE-2022-0679-60782fa63b48b07bca5800c576f2b0ac
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-0679
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
  description: 'The Narnoo Distributor WordPress plugin through 2.5.1 fails to validate
    and sanitize the lib_path parameter before it is passed into a call to require()
    via the narnoo_distributor_lib_request AJAX action (available to both unauthenticated
    and authenticated users) which results in the disclosure of arbitrary files as
    the content of the file is then displayed in the response as JSON data. This could
    also lead to RCE with various tricks but depends on the underlying system and
    it''s configuration.

    '
  metadata:
    fofa-query: wp-content/plugins/narnoo-distributor/
    google-query: inurl:"/wp-content/plugins/narnoo-distributor/"
    shodan-query: vuln:CVE-2022-0679
  name: 'Narnoo Distributor <= 2.5.1 - Path Traversal

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/bc860f44-c8ee-4b32-9702-7214e213790b?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,narnoo-distributor,low
