code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: vmList
    type: json
  source: 'az vm list --query ''[*].{"id":id}''

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - 'enabled: "false"'
    type: dsl
  matchers:
  - type: word
    words:
    - 'false'
  matchers-condition: and
  source: 'az network nic show --ids "$id" --query ''enableAcceleratedNetworking''

    '
flow: "code(1);\nfor (let VM of iterate(template.vmList)) {\n  set(\"id\", VM);\n\
  \  code(2);\n  }\n"
id: azure-vm-accelerated-networking-not-enabled
info:
  author: princechaddha
  description: 'Ensure that Accelerated Networking feature is enabled for your Azure
    virtual machines (VMs) in order to provide low latency and high throughput for
    the network interfaces (NICs) attached to the VMs. Accelerated networking enables
    single root input/output virtualization (SR-IOV) for virtual machines, vastly
    improving its networking performance. This high-performance pathway bypasses the
    host from the datapath, reducing latency, jitter, and CPU utilization, so it can
    be used with the most demanding network workloads that can be installed on the
    supported VM types.

    '
  impact: 'If Accelerated Networking is not enabled, the VM may experience higher
    latency and lower throughput, leading to suboptimal performance, especially in
    demanding network scenarios.

    '
  name: Azure VM Accelerated Networking Not Enabled
  reference:
  - https://docs.microsoft.com/en-us/azure/virtual-network/create-vm-accelerated-networking-cli
  remediation: 'Enable Accelerated Networking on all Azure VMs that support this feature
    to ensure optimal networking performance.

    '
  severity: medium
  tags: cloud,devops,azure,microsoft,vm,azure-cloud-config
self-contained: true
