code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: vnetdata
    type: json
  source: 'az network vnet list --query ''[*].{name:name, resourceGroup:resourceGroup}''
    --output json

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"DDoS Protection is not enabled for " + vnet + " virtual network"'
    type: dsl
  matchers:
  - type: word
    words:
    - 'false'
  source: 'az network vnet show --resource-group $resourcegroup --name $vnet --query
    "provisioningState" --output json

    '
flow: "code(1);\nfor (let VnetData of iterate(template.vnetdata)) {\n  VnetData =\
  \ JSON.parse(VnetData)\n  set(\"vnet\", VnetData.name)\n  set(\"resourcegroup\"\
  , VnetData.resourceGroup)\n  code(2)\n}\n"
id: azure-vnet-ddos-protection
info:
  author: princechaddha
  description: 'Ensure that DDoS Standard Protection feature is enabled for all your
    security-critical Microsoft Azure virtual networks (VNETs). DDoS Protection Standard
    is a premium paid cloud feature that offers enhanced Distributed Denial-of-Service
    (DDoS) mitigation capabilities via adaptive tuning, attack alert notifications,
    and telemetry to protect against the impacts of large DDoS attacks for all the
    protected resources available within your Azure virtual networks.

    '
  impact: 'Not enabling DDoS Standard Protection can leave your virtual networks vulnerable
    to distributed denial-of-service attacks, potentially leading to significant disruptions
    and loss of service.

    '
  name: Azure VNet DDoS Unprotected Check
  reference:
  - https://docs.microsoft.com/en-us/azure/virtual-network/ddos-protection-overview
  remediation: 'Enable DDoS Standard Protection for all security-critical virtual
    networks in your Microsoft Azure subscription to mitigate the risks associated
    with DDoS attacks.

    '
  severity: medium
  tags: cloud,devops,azure,microsoft,ddos,azure-cloud-config
self-contained: true
