id: CVE-2020-16846
info:
  author: dwisiswant0
  classification:
    cve-id: CVE-2020-16846
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
  description: SaltStack Salt through 3002 allows an unauthenticated user with network
    access to the Salt API to use shell injections to run code on the Salt-API using
    the SSH client.
  name: SaltStack <=3002 - Shell Injection
  reference:
  - https://saltproject.io/on-november-3-2020-saltstack-publicly-disclosed-three-new-cves/
  - https://mp.weixin.qq.com/s/R8qw_lWizGyeJS0jOcYXag
  - https://github.com/vulhub/vulhub/tree/master/saltstack/CVE-2020-16846
  - https://nvd.nist.gov/vuln/detail/CVE-2020-16846
  severity: critical
  tags: cve,cve2020,saltstack
requests:
- body: token=1337&client=ssh&tgt=*&fun=a&roster=projectdiscovery&ssh_priv=nuclei
  headers:
    Content-Type: application/x-www-form-urlencoded
  matchers:
  - status:
    - 500
    type: status
  - part: header
    type: word
    words:
    - application/json
  - part: body
    type: word
    words:
    - An unexpected error occurred
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/run'
