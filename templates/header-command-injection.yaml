id: header-command-injection
info:
  author: geeknik
  description: Fuzzing headers for command injection
  name: Header Command Injection
  severity: high
  tags: fuzz,rce
requests:
- attack: clusterbomb
  matchers:
  - condition: and
    type: word
    words:
    - uid=
    - gid=
    - groups=
  - regex:
    - 'root:[x*]:0:0:'
    type: regex
  matchers-condition: or
  payloads:
    header: helpers/payloads/request-headers.txt
    payload: helpers/payloads/command-injection.txt
  raw:
  - "GET /?\xA7header\xA7 HTTP/1.1\nHost: {{Hostname}}\nUser-Agent: Mozilla/5.0 (X11;\
    \ Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\n\xA7header\xA7: \xA7payload\xA7\
    \nConnection: close\n"
  redirects: true
