http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - ecwid-shopping-cart
  - dsl:
    - compare_versions(version, '<= 4.4.3')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/ecwid-shopping-cart/readme.txt'
  redirects: true
id: ecwid-shopping-cart-ebae8f8b50dfadb3a0e1ef0b723f3647
info:
  author: topscoder
  classification:
    cve-id: null
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: The Ecwid Ecommerce Shopping Cart plugin for WordPress is vulnerable
    to PHP Object Injection in versions before 4.4.4 via deserialization of untrusted
    input from the vulnerable cookie parameter 'ecwid_oauth_state' in the _load_state
    function. This allows unauthenticated attackers to inject a PHP Object. No POP
    chain is present in the vulnerable plugin. If a POP chain is present via an additional
    plugin or theme installed on the target system, it could allow the attacker to
    delete arbitrary files, retrieve sensitive data, or execute code.
  metadata:
    fofa-query: wp-content/plugins/ecwid-shopping-cart/
    google-query: inurl:"/wp-content/plugins/ecwid-shopping-cart/"
    shodan-query: 'vuln:'
  name: Ecwid Ecommerce Shopping Cart <= 4.4.3 - Unauthenticated PHP Object injection
  reference:
  - https://sumofpwn.nl/advisory/2016/ecwid_ecommerce_shopping_cart_wordpress_plugin_unauthenticated_php_object_injection_vulnerability.html
  - https://seclists.org/fulldisclosure/2016/Aug/29
  - https://plugins.trac.wordpress.org/changeset/1468056
  severity: critical
  tags: cve,wordpress,wp-plugin,ecwid-shopping-cart,critical
