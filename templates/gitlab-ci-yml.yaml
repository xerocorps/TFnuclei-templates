http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - 'variables:'
    - 'before_script:'
  - condition: and
    part: body
    type: word
    words:
    - 'stage: build'
    - 'script:'
    - 'image:'
  - condition: and
    part: body
    type: word
    words:
    - 'variables:'
    - 'releasePath:'
    - 'sshUser:'
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}/.gitlab-ci.yml'
  - '{{BaseURL}}/gitlab-ci.yml'
  - '{{BaseURL}}/.gitlab-ci/variables.yml'
  stop-at-first-match: true
id: gitlab-ci-yml
info:
  author: DhiyaneshDK
  classification:
    cpe: cpe:2.3:a:gitlab:gitlab:*:*:*:*:*:*:*:*
  description: 'The gitlab-ci.yml file, used for configuring CI/CD pipelines in GitLab,
    has been found exposed. This file contains crucial details about the build, test,
    and deployment processes, and may include sensitive information such as API keys,
    tokens, environment variables, and other credentials.

    '
  impact: 'Unauthorized access to this file can lead to severe security risks and
    operational disruptions.

    '
  metadata:
    max-request: 2
    product: gitlab
    shodan-query: html:"gitlab-ci.yml"
    vendor: gitlab
    verified: true
  name: GitLab CI YAML - Exposure
  reference:
  - https://x.com/RootMoksha/status/1816571625388818923/photo/1
  severity: medium
  tags: exposure,config,cicd,gitlab,vuln
