http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - timthumb
  - dsl:
    - compare_versions(version, '< 2.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/timthumb/readme.txt'
  redirects: true
id: CVE-2011-4106-timthumb-e062c794-1ab7-4d44-95da-40cd401f3a37
info:
  author: topscoder
  classification:
    cve-id: CVE-2011-4106
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'TimThumb (timthumb.php) before 2.0 does not validate the entire source
    with the domain white list, which allows remote attackers to upload and execute
    arbitrary code via a URL containing a white-listed domain in the src parameter,
    then accessing it via a direct request to the file in the cache directory, as
    exploited in the wild in August 2011. Note: this is not a WordPress plugin or
    theme, but may be used by WordPress plugins and themes. Make sure to check for
    the presence of  the timthumb.php file when determining if your installation is
    vulnerable.

    '
  metadata:
    fofa-query: wp-content/plugins/timthumb/
    google-query: inurl:"/wp-content/plugins/timthumb/"
    shodan-query: http.html:"wp-content/plugins/timthumb/"
  name: 'TimThumb <= 1.33 - Remote File Download

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/e062c794-1ab7-4d44-95da-40cd401f3a37?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,timthumb,critical,production
