id: beanstalk-service
info:
  author: pussycat0x
  description: 'Beanstalk is a simple, fast work queue. Its interface is generic,
    but was originally designed for reducing the latency of page views in high-volume
    web applications by running time-consuming tasks asynchronously.

    '
  metadata:
    max-request: 1
    shodan-query: port:11300 "cmd-peek"
    verified: true
  name: Beanstalk Service - Detect
  reference:
  - https://jhadiary.wordpress.com/2016/05/18/beanstalk-helping-commands/
  severity: info
  tags: network,beanstalk,detect,enum,tcp,discovery
tcp:
- extractors:
  - name: stats
    regex:
    - '([a-z-A-Z: 0-9]+)'
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: "stats\r\n"
    read: 8
  matchers:
  - condition: and
    part: raw
    type: word
    words:
    - cmd-release
    - cmd-peek
  port: 11300
