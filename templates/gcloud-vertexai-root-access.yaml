code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[].projectId
    name: projectIds
    type: json
  source: 'gcloud projects list --format="json(projectId)"

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"Project " + projectId + " has Vertex AI notebook instances with root access
      enabled"'
    type: dsl
  matchers:
  - type: word
    words:
    - 'null'
  source: 'gcloud workbench instances describe tm-vertex-ai-notebook-instance --location=us-central1-a
    --project=$projectId --format="yaml(gceSetup.metadata.notebook-disable-root)"

    '
flow: "code(1)\nfor(let projectId of iterate(template.projectIds)){\n  set(\"projectId\"\
  , projectId)\n  code(2)\n}\n"
id: gcloud-vertexai-root-access
info:
  author: princechaddha
  description: 'Ensure that root access to your Google Cloud Vertex AI notebook instances
    is disabled in order to reduce the risk of accidental or malicious system damage
    by limiting administrative privileges within the instances. Disabling root access
    minimizes the risk of unauthorized modifications and helps maintain a more controlled
    and secure AI environment.

    '
  impact: 'Allowing root access to Vertex AI notebook instances increases the risk
    of unauthorized modifications and potential misuse of superuser privileges. This
    could lead to system damage, data breaches, or compromise of the AI environment.

    '
  name: Root Access Not Disabled for Vertex AI Notebooks
  reference:
  - https://trendmicro.com/cloudoneconformity/knowledge-base/gcp/VertexAI/disable-root-access.html
  - https://cloud.google.com/vertex-ai/docs/workbench/user-managed/manage-instance
  remediation: 'Disable root access for Vertex AI notebook instances using the ''gcloud
    workbench instances update'' command with metadata parameter ''notebook-disable-root=true''.
    Note that instances must be stopped before updating this configuration.

    '
  severity: high
  tags: cloud,devops,gcp,gcloud,vertexai,security,root-access,gcp-cloud-config
self-contained: true
