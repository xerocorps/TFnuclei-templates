http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?i)\basyncapi\s*:\s*['"]?([0-9.]+)
    - (?i)"asyncapi"\s*:\s*"([0-9.]+)"
    type: regex
  matchers:
  - condition: or
    part: body
    regex:
    - (?i)\basyncapi\s*:\s*['"]?[0-9.]+
    - (?i)"asyncapi"\s*:\s*"([0-9.]+)"
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/asyncapi'
  - '{{BaseURL}}/asyncapi.yaml'
  - '{{BaseURL}}/asyncapi.yml'
  - '{{BaseURL}}/asyncapi.json'
  - '{{BaseURL}}/api/asyncapi'
  - '{{BaseURL}}/api/docs/asyncapi'
  - '{{BaseURL}}/docs/asyncapi'
  redirects: true
  stop-at-first-match: true
id: asyncapi-inventory
info:
  author: hamzasahin61
  description: 'Detected publicly accessible AsyncAPI specification files (YAML/JSON),
    which might have exposed message channels, server endpoints, and security schemes.

    '
  name: AsyncAPI Spec Inventory
  reference:
  - https://www.asyncapi.com/docs/reference/specification
  - https://raw.githubusercontent.com/asyncapi/spec/v2.6.0/examples/streetlights-kafka.yml
  severity: info
  tags: exposure,asyncapi,api,discovery
