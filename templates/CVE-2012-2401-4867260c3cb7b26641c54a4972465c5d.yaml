http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '< 3.3.2')
    - compare_versions(version_by_js, '< 3.3.2')
    - compare_versions(version_by_css, '< 3.3.2')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2012-2401-4867260c3cb7b26641c54a4972465c5d
info:
  author: topscoder
  classification:
    cve-id: CVE-2012-2401
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 6.5
  description: 'Plupload before 1.5.4, as used in wp-includes/js/plupload/ in WordPress
    before 3.3.2 and other products, enables scripting regardless of the domain from
    which the SWF content was loaded, which allows remote attackers to bypass the
    Same Origin Policy via crafted content.

    '
  metadata:
    shodan-query: vuln:CVE-2012-2401
  name: 'WordPress Core <= 3.3.1 - Same Origin Policy Bypass

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/1ab4dc20-ce50-4ad0-aff4-9fc529d1911f?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-core,medium
