http:
- extractors:
  - group: 1
    regex:
    - <version who="sg">(.+)</version>
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "config-auth")
    - contains(body, "<version who=")
    type: dsl
  raw:
  - 'POST / HTTP/1.1

    Host: {{Hostname}}

    X-Aggregate-Auth: 1

    Connection: close


    <?xml version="1.0" encoding="UTF-8"?>

    <config-auth client="vpn" type="init" aggregate-auth-version="2">

    <version who="vpn">3.1.337</version>

    <device-id device-type="Nuclei" platform-version="3.1.3.3.7">mac-intel</device-id>

    </config-auth>

    '
id: cisco-asa-version
info:
  author: gtrrnr
  description: Detects Cisco ASA device and extracts the version from the response.
  name: Cisco ASA version
  severity: info
