code:
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '" OS Patches are Outdated "'
    type: dsl
  matchers:
  - condition: and
    type: word
    words:
    - '"RaspStatus":'
    - '"Type":'
  - condition: and
    negative: true
    type: word
    words:
    - '"TotalCount": 0'
    - '"VulRecords":'
  matchers-condition: and
  source: 'aliyun sas DescribeVulList --Type cve --region $region

    '
id: os-patches-outdated
info:
  author: DhiyaneshDK
  description: 'Ensure that the latest OS patches for ECS virtual machines (VM) instances
    are applied in order to mitigate security vulnerabilities and ensure optimal performance
    and stability.

    '
  metadata:
    max-request: 1
    verified: true
  name: OS Patches - Outdated
  reference:
  - https://www.trendmicro.com/cloudoneconformity/knowledge-base/alibaba-cloud/AlibabaCloud-ECS/apply-latest-os-patches.html
  - https://www.alibabacloud.com/help/en/security-center/user-guide/fix-software-vulnerabilities
  severity: medium
  tags: cloud,devops,aliyun,alibaba,alibaba-cloud-config,ecs
self-contained: true
variables:
  region: cn-hangzhou
