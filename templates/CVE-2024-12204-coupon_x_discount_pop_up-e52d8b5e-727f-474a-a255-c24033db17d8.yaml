http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - coupon-x-discount-pop-up
  - dsl:
    - compare_versions(version, '<= 1.3.5')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/coupon-x-discount-pop-up/readme.txt'
  redirects: true
id: CVE-2024-12204-coupon_x_discount_pop_up-e52d8b5e-727f-474a-a255-c24033db17d8
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-12204
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 5.4
  description: 'The Coupon X: Discount Pop Up, Promo Code Pop Ups, Announcement Pop
    Up, WooCommerce Popups plugin for WordPress is vulnerable to unauthorized access
    due to missing capability checks on several functions in the class-cx-rest.php
    file in all versions up to, and including, 1.3.5. This makes it possible for authenticated
    attackers, with Subscriber-level access and above, to create 100% off coupons,
    delete posts, delete leads, and update coupon statuses.

    '
  metadata:
    fofa-query: wp-content/plugins/coupon-x-discount-pop-up/
    google-query: inurl:"/wp-content/plugins/coupon-x-discount-pop-up/"
    shodan-query: http.html:"wp-content/plugins/coupon-x-discount-pop-up/"
  name: 'Coupon X: Discount Pop Up, Promo Code Pop Ups, Announcement Pop Up, WooCommerce
    Popups <= 1.3.5 - Missing Authorization

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/e52d8b5e-727f-474a-a255-c24033db17d8?source=api-prod
  severity: low
  tags: cve,wordpress,wp-plugin,coupon-x-discount-pop-up,low,production
