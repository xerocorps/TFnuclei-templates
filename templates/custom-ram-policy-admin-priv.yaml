code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .Policies.Policy[].PolicyName
    name: policyname
    type: json
  source: 'aliyun ram ListPolicies --PolicyType Custom --region $region

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - policy + " custom RAM Policy allow Full Administrative Privileges "
    type: dsl
  matchers:
  - condition: and
    type: word
    words:
    - '"Effect\":\"Allow\'
    - \"Action\":\"*\"
    - \"Resource\":\"*\"
  source: 'aliyun ram GetPolicy --PolicyName $policyname --PolicyType Custom --region
    $region

    '
flow: "code(1)\nfor(let PolicyName of iterate(template.policyname)){\n  set(\"policy\"\
  , PolicyName)\n  code(2)\n}\n"
id: custom-ram-policy-admin-priv
info:
  author: DhiyaneshDK
  description: 'The Alibaba Cloud Custom RAM policies with full administrative privileges
    grant users or groups unrestricted access to all resources and actions within
    the cloud environment.

    '
  metadata:
    max-request: 1
    verified: true
  name: Custom RAM Policies With Full Administrative Privileges
  reference:
  - https://www.alibabacloud.com/help/en/ram/user-guide/create-a-custom-policy
  - https://www.trendmicro.com/cloudoneconformity/knowledge-base/alibaba-cloud/AlibabaCloud-RAM/policies-with-full-administrative-privileges.html
  severity: high
  tags: cloud,devops,aliyun,alibaba,alibaba-cloud-config,alibaba-ram
self-contained: true
variables:
  region: cn-hangzhou
