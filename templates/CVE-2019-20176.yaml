id: CVE-2019-20176
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:pureftpd:pure-ftpd:1.0.49:*:*:*:*:*:*:*
    cve-id: CVE-2019-20176
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cwe-id: CWE-400
    epss-percentile: 0.95622
    epss-score: 0.22328
  description: 'Pure-FTPd versions prior to 1.0.50 are vulnerable to resource exhaustion
    leading to denial of service. The vulnerability occurs in the listdir() function
    when processing crafted LIST commands, causing stack exhaustion that can crash
    the FTP server.

    '
  impact: 'Unauthenticated attackers can send crafted LIST commands to exhaust stack
    resources in the listdir() function, causing denial of service by crashing the
    Pure-FTPd server.

    '
  metadata:
    max-request: 1
    product: pure-ftpd
    shodan-query:
    - product:"pure-ftpd" version:"1.0.45"
    - cpe:"cpe:2.3:a:pureftpd:pure-ftpd"
    vendor: pureftpd
    verified: true
  name: Pure-FTPd < 1.0.50 - DoS via Resource Exhaustion
  reference:
  - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/AHZG5FPCRMCB6Z3L7FPICC6BZ5ZATFTO/
  - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/PICL3U2J4EPGBLOE555Y5RAZTQL3WBBV/
  remediation: 'Update Pure-FTPd to version 1.0.50 or later that properly handles
    LIST command processing and prevents stack exhaustion vulnerabilities.

    '
  severity: high
  tags: cve,cve2019,network,ftp,pure-ftpd,tcp,passive,vuln
tcp:
- extractors:
  - group: 1
    name: version
    regex:
    - Pure-FTPd ([0-9.]+)
    type: regex
  host:
  - '{{Hostname}}'
  inputs:
  - data: 0
    type: hex
  matchers:
  - condition: and
    dsl:
    - contains(raw, 'Pure-FTPd')
    - compare_versions(version, '< 1.0.50')
    type: dsl
  port: 21
  read-size: 1024
