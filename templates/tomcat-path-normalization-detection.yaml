http:
- extractors:
  - dsl:
    - status_code_1
    - status_code_2
    - status_code_3
    type: dsl
  matchers:
  - dsl:
    - status_code_1 != 400 && status_code_2 == 400 && status_code_3 != 400
    type: dsl
  matchers-condition: and
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}


    '
  - 'GET {{RootURL}}/..;/..;/..;/..;/..;/..;/..;/..;/..;/..;/..;/..;/ HTTP/1.1

    Host: {{Hostname}}


    '
  - 'GET {{RootURL}}/..;/ HTTP/1.1

    Host: {{Hostname}}


    '
id: tomcat-path-normalization-detection
info:
  author: watchTowr
  description: Identifying path normalization behaviour at scale for detecting log4j
    https://labs.watchtowr.com/log4shell-is-dead-long-live-log4shell/
  name: Tomcat Path Normalization detection
  severity: medium
  tags: tomcat,path-normalization
