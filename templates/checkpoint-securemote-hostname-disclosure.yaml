id: checkpoint-securemote-hostname-disclosure
info:
  author: milo2012
  description: 'Two-step TCP request to leak firewall and SmartCenter hostnames from
    CheckPoint Firewall-1.

    '
  name: CheckPoint SecuRemote Topology Hostname Disclosure
  severity: info
  tags: checkpoint,firewall,disclosure,tcp
tcp:
- extractors:
  - part: raw
    regex:
    - CN=([^,]+)
    type: regex
  host:
  - '{{Hostname}}:264'
  inputs:
  - data: '5100000000000021'
    read: 4
    type: hex
  - data: 0000000b7365637572656d6f746500
    read: 1024
    type: hex
  matchers:
  - part: raw
    regex:
    - CN=([^,]+)
    type: regex
