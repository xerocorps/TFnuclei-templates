http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Version:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wplms
  - dsl:
    - compare_versions(version, '<= 4.962')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/themes/wplms/style.css'
  redirects: true
id: CVE-2024-10470-wplms-1932c9b4-2fea-40f8-9748-09ded8143c11
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-10470
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The WPLMS Learning Management System for WordPress, WordPress LMS
    theme for WordPress is vulnerable to arbitrary file read and deletion due to insufficient
    file path validation and permissions checks in the readfile and unlink functions
    in all versions up to, and including, 4.962. This makes it possible for unauthenticated
    attackers to delete arbitrary files on the server, which can easily lead to remote
    code execution when the right file is deleted (such as wp-config.php). The theme
    is vulnerable even when it is not activated.

    '
  metadata:
    fofa-query: wp-content/themes/wplms/
    google-query: inurl:"/wp-content/themes/wplms/"
    shodan-query: http.html:"wp-content/themes/wplms/"
  name: 'WPLMS Learning Management System for WordPress <= 4.962 - Unauthenticated
    Arbitrary File Read and Deletion

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/1932c9b4-2fea-40f8-9748-09ded8143c11?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-theme,wplms,critical,production
