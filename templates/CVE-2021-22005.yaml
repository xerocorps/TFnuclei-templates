id: CVE-2021-22005
info:
  author: PR3R00T
  classification:
    cve-id: CVE-2021-22005
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-434
  description: VMware vCenter Server contains an arbitrary file upload vulnerability
    in the Analytics service. A malicious actor with network access to port 443 on
    vCenter Server may exploit this issue to execute code on vCenter Server by uploading
    a specially crafted file.
  name: VMware vCenter Server - Arbitrary File Upload
  reference:
  - https://kb.vmware.com/s/article/85717
  - https://www.vmware.com/security/advisories/VMSA-2021-0020.html
  - https://core.vmware.com/vmsa-2021-0020-questions-answers-faq
  - https://nvd.nist.gov/vuln/detail/CVE-2021-22005
  severity: critical
  tags: cve,cve2021,vmware,vcenter,upload
requests:
- matchers:
  - condition: and
    dsl:
    - status_code_1 == 200
    - status_code_2 == 201
    - contains(body_1, 'VMware vSphere')
    - content_length_2 == 0
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /analytics/telemetry/ph/api/hyper/send?_c&_i=test HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    test_data

    '
  req-condition: true
