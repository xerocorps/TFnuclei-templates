id: cookie-injection
info:
  author: pdteam
  name: Parameter based cookie injection
  reference:
  - https://www.invicti.com/blog/web-security/understanding-cookie-poisoning-attacks/
  - https://docs.imperva.com/bundle/on-premises-knowledgebase-reference-guide/page/cookie_injection.htm
  severity: info
  tags: reflected,dast,cookie,injection
requests:
- fuzzing:
  - fuzz:
    - '{{reflection}}'
    part: query
    type: postfix
  matchers:
  - part: header
    regex:
    - (?m)(?i)(^set-cookie.*cookie_injection.*)
    type: regex
  method: GET
  path:
  - '{{BaseURL}}'
  payloads:
    reflection:
    - '{{first}}'
variables:
  first: cookie_injection
