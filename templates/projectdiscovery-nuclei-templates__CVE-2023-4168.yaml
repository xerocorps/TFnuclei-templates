http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(content_type, "text/html")
    - contains_all(body, "google_map_key", "api_key", "auth_domain")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/ad-list-search?keyword=&lat=&long=&long=&lat=&location=&category=&keyword='
id: CVE-2023-4168
info:
  author: r3Y3r53
  classification:
    cpe: cpe:2.3:a:templatecookie:adlisting:2.14.0:*:*:*:*:*:*:*
    cve-id: CVE-2023-4168
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-200,NVD-CWE-noinfo
    epss-percentile: 0.98965
    epss-score: 0.78168
  description: 'Information disclosure issue in the redirect responses, When accessing
    any page on the website, Sensitive data, such as API keys, server keys, and app
    IDs, is being exposed in the body of these redirects.

    '
  impact: 'Unauthenticated attackers can access sensitive API keys, server keys, and
    app IDs exposed in redirect responses, potentially compromising integrated third-party
    services and the Google Maps API used by the classified ads platform.

    '
  metadata:
    max-request: 1
    product: adlisting
    vendor: templatecookie
    verified: true
  name: Adlisting Classified Ads 2.14.0 - Information Disclosure
  reference:
  - https://www.exploit-db.com/exploits/51667
  - https://templatecookie.com/demo/adlisting-classified-ads-script
  - https://nvd.nist.gov/vuln/detail/CVE-2023-4168
  - https://vuldb.com/?ctiid.236184
  - https://vuldb.com/?id.236184
  remediation: 'Update Adlisting to a version newer than 2.14.0 that removes sensitive
    credentials from client-side code and stores API keys securely on the server side.

    '
  severity: high
  tags: cve,cve2023,adlisting,exposure,templatecookie,vuln
