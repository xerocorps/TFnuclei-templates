code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'UserAuthentication : 0'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'Get-ItemProperty -Path ''HKLM:\SYSTEM\CurrentControlSet\Control\Terminal
    Server\WinStations\RDP-Tcp'' -Name ''UserAuthentication''

    '
id: rdp-nla-disabled
info:
  author: princechaddha
  description: Checks if Network Level Authentication (NLA) for Remote Desktop Protocol
    is disabled, increasing the risk of unauthorized access.
  impact: 'Disabling NLA for RDP exposes the system to potential unauthorized remote
    access and brute force attacks.

    '
  name: Network Level Authentication for RDP Disabled
  remediation: 'Enable Network Level Authentication (NLA) to secure remote desktop
    connections.

    '
  severity: high
  tags: windows,rdp,nla,authentication,code,windows-audit
self-contained: true
