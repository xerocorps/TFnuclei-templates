code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[]
    name: webAppIds
    type: json
  source: 'az webapp list --query ''[*].id'' --output json

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - id + " does not have HTTP/2 enabled"
    type: dsl
  matchers:
  - type: word
    words:
    - 'false'
  source: 'az webapp config show --ids $id --query ''http20Enabled'' --output json

    '
flow: "code(1);\nfor (let WebAppId of iterate(template.webAppIds)) {\n  set(\"id\"\
  , WebAppId);\n  code(2);\n}\n"
id: azure-appservice-http2-not-enabled
info:
  author: princechaddha
  description: 'Ensure that your Microsoft Azure App Service web applications are
    using the latest version of the HTTP protocol (i.e. HTTP/2) in order to make your
    web applications load faster. HTTP 2.0 represents a major upgrade of the HTTP/1.1
    protocol, with the primary goals of reducing the impact of latency and connection
    load on web servers through full request and response multiplexing, minimizing
    protocol overhead via HTTP header field compression, and supporting HTTP request
    prioritization and server push.

    '
  impact: 'Not using HTTP/2 can result in slower web applications due to increased
    latency and connection load.

    '
  name: Azure App Service HTTP/2 Not Enabled
  reference:
  - https://docs.microsoft.com/en-us/azure/app-service/configure-language-http2
  remediation: 'Enable HTTP/2 on your Azure App Service web applications to improve
    their performance and adhere to modern web standards.

    '
  severity: low
  tags: cloud,devops,azure,microsoft,appservice,azure-cloud-config
self-contained: true
