http:
- extractors:
  - kval:
    - expect_ct
    part: header
    type: kval
  matchers:
  - condition: and
    dsl:
    - contains(tolower(header), "expect-ct")
    - contains(tolower(header), "max-age=0") || !contains(tolower(header), "enforce")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}'
id: expect-ct-misconfigured
info:
  author: theamanrawat
  description: 'Detected misconfigured Expect-CT headers: max-age is 0 (ineffective)
    and enforce directive is missing

    '
  name: Expect-CT Header - Misconfigured
  reference:
  - https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Expect-CT
  - https://scotthelme.co.uk/a-new-security-header-expect-ct/
  severity: info
  tags: headers,expect-ct,misconfiguration
