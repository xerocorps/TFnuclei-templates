code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - 'SafeDllSearchMode: 0'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: '$dllSearchMode = Get-ItemProperty -Path ''HKLM:\System\CurrentControlSet\Control\Session
    Manager'' -Name ''SafeDllSearchMode''

    Write-Host "SafeDllSearchMode: $($dllSearchMode.SafeDllSearchMode)"

    '
id: safe-dll-search-mode-disabled
info:
  author: princechaddha
  description: Determines if Safe DLL search mode is disabled.
  impact: 'Disabling Safe DLL search mode may allow attackers to load malicious DLLs
    from untrusted locations.

    '
  name: Safe DLL Search Mode Disabled
  remediation: 'Enable Safe DLL search mode by setting the SafeDllSearchMode registry
    key to 1.

    '
  severity: high
  tags: windows,dll,code,windows-audit
self-contained: true
