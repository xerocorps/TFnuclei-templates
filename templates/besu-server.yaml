http:
- extractors:
  - group: 1
    part: body
    regex:
    - (v[0-9a-z-_.]+)
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(header, "application/json")
    - contains(body, "besu")
    type: dsl
  raw:
  - 'POST / HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json

    Content-Length: 66


    {"method":"web3_clientVersion","params":[],"id":1,"jsonrpc":"2.0"}

    '
id: besu-server
info:
  author: Nullfuzz
  description: 'Besu is an open source Ethereum client developed under the Apache
    2.0 license and written in Java. By default Besu runs a JSON-RPC HTTP server on
    port 8545/TCP

    '
  metadata:
    max-request: 1
    shodan-query: product:"besu"
  name: Besu JSON-RPC HTTP Server Detect
  reference:
  - https://besu.hyperledger.org/
  - https://besu.hyperledger.org/public-networks/how-to/use-besu-api#service-ports
  severity: info
  tags: tech,besu,ethereum,web3,blockchain
