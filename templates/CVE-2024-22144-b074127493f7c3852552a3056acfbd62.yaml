http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - gotmls
  - dsl:
    - compare_versions(version, '<= 4.21.96')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/gotmls/readme.txt'
  redirects: true
id: CVE-2024-22144-b074127493f7c3852552a3056acfbd62
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-22144
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 9
  description: 'The Anti-Malware Security and Brute-Force Firewall plugin for WordPress
    is vulnerable to Remote Code Execution in all versions up to, and including, 4.21.96
    due to weak nonce generation combined with missing authorization. This makes it
    possible for unauthenticated attackers to brute force a valid nonce that can be
    used to add malware rule and execute code on the server.

    '
  metadata:
    fofa-query: wp-content/plugins/gotmls/
    google-query: inurl:"/wp-content/plugins/gotmls/"
    shodan-query: vuln:CVE-2024-22144
  name: 'Anti-Malware Security and Brute-Force Firewall <= 4.21.96 - Unauthenticated
    Remote Code Execution

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/d7e81331-0b39-4490-8624-38078b3d5420?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-plugin,gotmls,critical
