http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - site-offline
  - dsl:
    - compare_versions(version, '<= 1.4.9')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/site-offline/readme.txt'
  redirects: true
id: CVE-2022-1580
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-1580
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
  description: The Site Offline plugin for WordPress is vulnerable to Maintenance
    Mode Bypass in versions up to, and including, 1.4.9. The presence of certain keywords
    in the URL allowed users to visit a site placed in maintenance mode thus bypassing
    the plugin's provided feature.
  metadata:
    fofa-query: wp-content/plugins/site-offline/
    google-query: inurl:"/wp-content/plugins/site-offline/"
    shodan-query: vuln:CVE-2022-1580
  name: Site Offline <= 1.4.9 - Maintenance Mode Bypass
  reference:
  - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2773275%40site-offline%2Ftrunk&old=2764490%40site-offline%2Ftrunk&sfp_email=&sfph_mail=
  - https://patchstack.com/database/vulnerability/site-offline-/wordpress-site-offline-plugin-1-4-9-access-bypass-vulnerability
  - https://wpscan.com/vulnerability/7b6f91cd-5a00-49ca-93ff-db7220d2630a
  severity: medium
  tags: cve,wordpress,wp-plugin,site-offline,medium
