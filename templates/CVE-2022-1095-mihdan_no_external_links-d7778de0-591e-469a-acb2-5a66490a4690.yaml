http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - mihdan-no-external-links
  - dsl:
    - compare_versions(version, '<= 4.7.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/mihdan-no-external-links/readme.txt'
  redirects: true
id: CVE-2022-1095-mihdan_no_external_links-d7778de0-591e-469a-acb2-5a66490a4690
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-1095
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 5.5
  description: 'The Mihdan: No External Links plugin for WordPress is vulnerable to
    Stored Cross-Site Scripting via several parameters in versions up to, and including
    4.7.4. This makes it possible for admin level attackers to inject arbitrary web
    scripts on web pages that execute whenever another administrator accesses the
    page. This can be exploited on multi-site installations and installations where
    unfiltered_html is disabled.

    '
  metadata:
    fofa-query: wp-content/plugins/mihdan-no-external-links/
    google-query: inurl:"/wp-content/plugins/mihdan-no-external-links/"
    shodan-query: http.html:"wp-content/plugins/mihdan-no-external-links/"
  name: 'Mihdan: No External Links <= 4.7.4 - Cross-Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/d7778de0-591e-469a-acb2-5a66490a4690?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,mihdan-no-external-links,medium,production
