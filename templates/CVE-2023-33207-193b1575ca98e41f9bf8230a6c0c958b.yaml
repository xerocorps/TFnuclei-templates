http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - stop-referrer-spam
  - dsl:
    - compare_versions(version, '<= 1.3.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/stop-referrer-spam/readme.txt'
  redirects: true
id: CVE-2023-33207-193b1575ca98e41f9bf8230a6c0c958b
info:
  author: topscoder
  classification:
    cve-id: CVE-2023-33207
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L
    cvss-score: 5.4
  description: 'The Stop Referrer Spam plugin for WordPress is vulnerable to Cross-Site
    Request Forgery in versions up to, and including, 1.3.0. This is due to insufficient
    nonce validation on the processParameters function. This makes it possible for
    unauthenticated attackers to refresh the spam blocklist and save custom URLs via
    a forged request granted they can trick a site administrator into performing an
    action such as clicking on a link. The issue was partially patched in version
    1.3.0 but because nonce generation does not occur until the first time the admin
    page is visited, it is possible for an attacker to supply an empty nonce value
    which will successfully result in settings being saved if the administrator has
    not yet visited the plugin''s admin page.

    '
  metadata:
    fofa-query: wp-content/plugins/stop-referrer-spam/
    google-query: inurl:"/wp-content/plugins/stop-referrer-spam/"
    shodan-query: vuln:CVE-2023-33207
  name: 'Stop Referrer Spam <= 1.3.0 - Cross-Site Request Forgery via processParameters

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/a5deac61-031f-452a-a478-d5d0c7953817?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,stop-referrer-spam,medium
