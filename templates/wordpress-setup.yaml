id: wordpress-setup
info:
  author: rix4uni
  description: It allows an attacker can create a new database.
  metadata:
    google-query:
    - inurl:"/wp-admin/setup-config.php?step=1"
    shodan-query:
    - http.title:"wordpress"
  name: Wordpress new database Setup - Detect
  reference:
  - https://twitter.com/0xJin/status/1399809593262358528?t=8qZIUP4_Qbtd5qASWNBgGw&s=09
  - https://smaranchand.com.np/2020/04/misconfigured-wordpress-takeover-to-remote-code-execution
  severity: medium
  tags: wordpress,authetication,misconfig
requests:
- matchers:
  - part: body
    type: word
    words:
    - <td><input name="dbname" id="dbname" type="text" size="25" value="wordpress"
      /></td>
    - Database Name
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-admin/setup-config.php?step=1'
  - '{{BaseURL}}/wordpress/wp-admin/setup-config.php?step=1'
  stop-at-first-match: true
