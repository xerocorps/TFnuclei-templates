code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .items[]
    name: items
    type: json
  source: kubectl get deployments --all-namespaces --output=json
flow: "code(1);\nfor (let deployment of template.items) {\n  set(\"deployment\", deployment)\n\
  \  javascript(1);\n}\n"
id: k8s-default-namespace-used
info:
  author: princechaddha
  description: Checks if Kubernetes Deployments are using the default namespace, which
    can lead to security risks and mismanagement issues.
  impact: 'Using the default namespace for Kubernetes Deployments can increase security
    risks as it might allow broader access than necessary. It also complicates resource
    management across multiple teams and applications.

    '
  name: Default Namespace Usage in Deployments
  reference:
  - https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/
  remediation: 'Avoid using the default namespace for Kubernetes Deployments. Create
    and specify dedicated namespaces tailored to specific applications or teams to
    enhance security and manage resources effectively.

    '
  severity: high
  tags: cloud,devops,kubernetes,k8s,devsecops,namespaces,k8s-cluster-security
javascript:
- code: "deployment = JSON.parse(template.deployment);\nif (deployment.metadata.namespace.toLowerCase()\
    \ === \"default\") {\n  let result = (`Deployment '${deployment.metadata.name}'\
    \ is using the default namespace, which is not recommended.`);\n  Export(result);\n\
    }\n"
  extractors:
  - dsl:
    - response
    type: dsl
self-contained: true
