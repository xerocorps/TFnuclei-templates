id: wp-woocommerce-pdf-invoice-listing
info:
  author: mohammedsaneem,sec_hawk
  description: A vulnerability in Woocommerce allows remote unauthenticated attackers
    to access company invoices and other sensitive information.
  name: Woocommerce PDF Invoice Exposure
  reference:
  - https://twitter.com/sec_hawk/status/1426984595094913025?s=21
  - https://github.com/Mohammedsaneem/wordpress-upload-information-disclosure/blob/main/worpress-upload.yaml
  - https://woocommerce.com/products/pdf-invoices/
  severity: medium
  tags: wordpress,listing,exposure,woocommerce
requests:
- matchers:
  - condition: and
    type: word
    words:
    - Index of /wp-content/uploads/pdf-invoices
    - Parent Directory
    - .pdf
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/wp-content/uploads/pdf-invoices/'
