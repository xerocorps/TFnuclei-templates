http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - directorist
  - dsl:
    - compare_versions(version, '<= 8.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/directorist/readme.txt'
  redirects: true
id: CVE-2025-1570-directorist-853562ed-7f2e-453c-b3d0-67c90bd0231f
info:
  author: topscoder
  classification:
    cve-id: CVE-2025-1570
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
  description: 'The Directorist: AI-Powered Business Directory Plugin with Classified
    Ads Listings plugin for WordPress is vulnerable to privilege escalation via account
    takeover in all versions up to, and including, 8.1. This is due to the directorist_generate_password_reset_pin_code()
    and reset_user_password() functions not having enough controls to prevent a successful
    brute force attack of the OTP to change a password, or verify that a password
    reset request came from an authorized user. This makes it possible for unauthenticated
    attackers to generate and brute force an OTP that makes it possible to change
    any users passwords, including an administrator.

    '
  metadata:
    fofa-query: wp-content/plugins/directorist/
    google-query: inurl:"/wp-content/plugins/directorist/"
    shodan-query: http.html:"wp-content/plugins/directorist/"
  name: 'Directorist: AI-Powered Business Directory Plugin with Classified Ads Listings
    <= 8.1 - Privilege Escalation and Account Takeover via Weak OTP

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/853562ed-7f2e-453c-b3d0-67c90bd0231f?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,directorist,high,production
