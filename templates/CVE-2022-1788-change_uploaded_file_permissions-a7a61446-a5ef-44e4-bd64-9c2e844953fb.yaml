http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - change-uploaded-file-permissions
  - dsl:
    - compare_versions(version, '<= 4.0.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/change-uploaded-file-permissions/readme.txt'
  redirects: true
id: CVE-2022-1788-change_uploaded_file_permissions-a7a61446-a5ef-44e4-bd64-9c2e844953fb
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-1788
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: 'Due to missing checks the Change Uploaded File Permissions WordPress
    plugin through 4.0.0 is vulnerable to CSRF attacks. This can be used to change
    the file and folder permissions of any folder. This could be problematic when
    specific files like ini files are made readable for everyone due to this.

    '
  metadata:
    fofa-query: wp-content/plugins/change-uploaded-file-permissions/
    google-query: inurl:"/wp-content/plugins/change-uploaded-file-permissions/"
    shodan-query: http.html:"wp-content/plugins/change-uploaded-file-permissions/"
  name: 'Change Uploaded File Permissions <= 4.0.0 - Cross-Site Request Forgery to
    Options Update

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/a7a61446-a5ef-44e4-bd64-9c2e844953fb?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,change-uploaded-file-permissions,high,production
