id: influxdb-version-detect
info:
  author: c-sh0
  description: Obtain InfluxDB Version Information
  metadata:
    shodan-query: X-Influxdb-
    verified: true
  name: InfluxDB Version Detection
  reference:
  - https://docs.influxdata.com/influxdb/v1.8/tools/api/#ping-http-endpoint
  - https://github.com/influxdata/influxdb/blob/master/http/platform_handler.go#L62
  severity: info
  tags: tech,influxdb,api
requests:
- extractors:
  - kval:
    - X_Influxdb_Version
    type: kval
  matchers:
  - part: header
    type: word
    words:
    - X-Influxdb-
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
