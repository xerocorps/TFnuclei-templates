http:
- matchers:
  - condition: and
    dsl:
    - startswith(body, "SQLite")
    - contains(body, "CREATE TABLE")
    - '!contains(body, "<html")'
    - status_code == 200
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/{{path}}'
  payloads:
    path:
    - database/database.sqlite
    - database/production.db
    - database/production.sqlite
    - database/production.sqlite3
    - app/database/production.sqlite
    - writable/db.sqlite3
    - writable/database.db
    - var/app.db
    - var/data/db.sqlite
    - var/data/data.sqlite
    - app/sqlite.db
    - sqlite.db
    - db.sqlite3
    - db/production.sqlite3
    - db.sqlite
    - mydb.sqlite
    - app/data/app_db.sqlite
    - app/webroot/database.sqlite
    - app/database.sqlite
    - application/databases/db.sqlite
    - application/db/database.sqlite
    - application/Database/db1.db
    - application/database/data.db
    - data/app.db
    - data/sqlite.db
    - data/sqlite3.db
    - data/database.db
    - data/production.db
    - storage/database/database.sqlite
    - protected/data/app.db
    - protected/data/sqlite.db
    - protected/data/sqlite3.db
    - protected/data/database.db
    - protected/data/production.db
    - db/database.db
    - db/database.sqlite
    - app/Model/app.db
    - app/Model/sqlite.db
    - app/Model/sqlite3.db
    - app/Model/database.db
    - app/Model/production.db
    - app.db
    - sqlite3.db
    - app.sqlite
    - app.sqlite3
    - database.db
    - database.sqlite
    - database.sqlite3
    - production.db
    - production.sqlite
    - production.sqlite3
    - db/db.sqlite
    - db/db.sqlite3
    - db/sqlite.db
    - db/sqlite3.db
    - db/app.db
    - db/app.sqlite
    - db/app.sqlite3
    - db/database.sqlite3
    - db/production.db
    - db/production.sqlite
    - app/db.sqlite
    - app/db.sqlite3
    - app/sqlite3.db
    - app/app.db
    - app/app.sqlite
    - app/app.sqlite3
    - app/database.db
    - app/database.sqlite3
    - app/production.db
    - app/production.sqlite
    - app/production.sqlite3
    - data/db.sqlite
    - data/db.sqlite3
    - data/app.sqlite
    - data/app.sqlite3
    - data/database.sqlite
    - data/database.sqlite3
    - data/production.sqlite
    - data/production.sqlite3
    - database/db.sqlite
    - database/db.sqlite3
    - database/sqlite.db
    - database/sqlite3.db
    - database/app.db
    - database/app.sqlite
    - database/app.sqlite3
    - database/database.db
    - database/database.sqlite3
  stop-at-first-match: true
id: generic-db
info:
  author: Michal Mikolas (nanuqcz)
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
  description: 'This is collection of some web frameworks recommendation or default
    configuration for SQLite database file location. If this file is publicly accessible
    due to server misconfiguration, it could result in application data leak including
    users sensitive data, password hashes etc.

    '
  metadata:
    max-request: 89
  name: Generic Database File - Exposure
  reference:
  - https://laravel.com/docs/11.x/database#sqlite-configuration
  - https://laravel.com/docs/5.2/database
  - https://github.com/laracasts/larabook/blob/master/app/config/database.php#L51
  - https://forum.codeigniter.com/post-389846.html
  - https://github.com/codeigniter4projects/playground/blob/develop/.env.example#L33
  - https://symfony.com/doc/current/doctrine.html#configuring-the-database
  - https://symfony.com/doc/4.x/doctrine.html#configuring-the-database
  - https://symfony.com/doc/3.x/doctrine.html
  - https://symfony.com/doc/2.x/doctrine.html
  - https://openclassrooms.com/forum/sujet/symfony3-sqlite-could-not-create-database
  - https://symfony.com/doc/current/reference/configuration/doctrine.html#doctrine-dbal-configuration
  - https://stackoverflow.com/questions/31762878/sqlite-3-database-with-django
  - https://medium.com/@codewithbushra/using-sqlite-as-a-database-backend-in-django-projects-code-with-bushra-d23e3100686e
  - https://gist.github.com/jwo/4512764?permalink_comment_id=2235763#gistcomment-2235763
  - https://stackoverflow.com/a/30345819/1632572
  - https://developerhowto.com/2018/12/29/build-a-rest-api-with-node-js-and-express-js/
  - https://sqldocs.org/sqlite/sqlite-nodejs/
  - https://stackoverflow.com/questions/41620788/error-database-connection-sqlite-is-missing-or-could-not-be-created-cakephp
  - https://stackoverflow.com/questions/2722383/using-sqlite3-with-cakephp
  - https://levelup.gitconnected.com/how-to-connect-and-use-the-sqlite-database-in-codeigniter-3-48cd50d3e78d
  - https://turmanauli.medium.com/how-to-connect-codeigniter-to-sqlite3-database-like-a-pro-2177497a6d30
  - https://forum.codeigniter.com/thread-74522.html
  - https://stackoverflow.com/a/37088960/1632572
  - https://docs.laminas.dev/tutorials/getting-started/database-and-models/
  - https://phalcon-nucleon.github.io/#!database/getting-started.html
  - https://www.yiiframework.com/doc/blog/1.1/en/prototype.database
  - https://pusher.com/tutorials/rest-api-slim-part-1/
  - https://www.digitalocean.com/community/tutorials/how-to-use-the-fat-free-php-framework
  - https://doc.nette.org/en/database/configuration#toc-single-connection
  - https://www.sqlite.org/fileformat.html
  - https://en.wikipedia.org/wiki/List_of_file_signatures
  severity: high
  tags: files,database,exposure,sqlite,sqlite3,fuzz,sqli,vuln
