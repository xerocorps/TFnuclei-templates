http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '8.x-4.1')
    - compare_versions(version, '8.x-4.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - graphql
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/graphql/graphql.info'
  redirects: true
id: drupal_module-graphql-access-bypass
info:
  author: Bishopfox
  description: 'This advisory addresses a similar issue to Drupal core - Moderately
    critical - Access bypass - SA-CORE-2021-008. The GraphQL module allows file uploads
    through its HTTP API. The module does not correctly run all file validation, which
    causes an access bypass vulnerability. An attacker might be able to upload files
    that bypass the file validation process implemented by modules on the site. This
    vulnerability is mitigated by four factors:  The GraphQL module must be enabled
    on the site. The GraphQL schema must expose a file upload by using the helper
    src/GraphQL/Utility/FileUpload.php in the module. An attacker must have access
    to that file upload via the GraphQL API. The site must employ a file validation
    module.'
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/graphql/
    google-query: inurl:'/sites/all/modules/graphql/
    impact: medium
    security-risk: "Moderately critical 13\u221525 AC:Basic/A:User/CI:Some/II:Some/E:Theoretical/TD:Default"
    type: indicator
    vulnerability: access-bypass
  name: drupal_module-graphql-access-bypass
  reference:
  - https://www.drupal.org/sa-contrib-2021-029
  severity: medium
  tags: drupal
