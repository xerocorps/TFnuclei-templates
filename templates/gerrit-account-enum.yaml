http:
- extractors:
  - group: 1
    name: usernames
    part: body
    regex:
    - '"username":\s*"([^"]+)"'
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - _account_id
    - username
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/accounts/?q=a&n=10'
  - '{{BaseURL}}/accounts/?suggest&q=a&n=10'
  stop-at-first-match: true
id: gerrit-account-enum
info:
  author: DhiyaneshDk
  description: 'Gerrit Code Review exposes the /accounts/ REST API endpoint which
    can be used to enumerate user accounts.The endpoint allows querying for accounts
    by username, email, or name, potentially revealing sensitive user information
    including account IDs, names, emails, and usernames without authentication.

    '
  metadata:
    fofa-query: title="Gerrit Code Review"
    max-request: 2
    shodan-query: title:"Gerrit Code Review"
    verified: true
  name: Gerrit Code Review - Account Enumeration
  reference:
  - https://gerrit-review.googlesource.com/Documentation/rest-api-accounts.html
  - https://gerrit-documentation.storage.googleapis.com/Documentation/2.11/rest-api-accounts.html
  severity: medium
  tags: gerrit,enum,exposure,misconfig
