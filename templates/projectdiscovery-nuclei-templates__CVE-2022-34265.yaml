http:
- fuzzing:
  - fuzz:
    - test'{{rand_string}}
    part: query
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - syntax error at or near &quot;{{rand_string}}&quot
    - 'LINE 1: SELECT DATE_TRUNC'
  - status:
    - 500
    type: status
  matchers-condition: and
  pre-condition:
  - dsl:
    - method == "GET"
    type: dsl
id: CVE-2022-34265
info:
  author: princechaddha
  classification:
    cve-id: CVE-2022-34265
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.99741
    epss-score: 0.92734
  description: 'An issue was discovered in Django 3.2 before 3.2.14 and 4.0 before
    4.0.6. The Trunc() and Extract() database functions are subject to SQL injection
    if untrusted data is used as a kind/lookup_name value. Applications that constrain
    the lookup name and kind choice to a known safe list are unaffected.

    '
  impact: 'Attackers can execute arbitrary SQL commands, potentially leading to data
    theft, modification, or deletion.

    '
  name: Django - SQL injection
  reference:
  - https://github.com/vulhub/vulhub/tree/master/django/CVE-2022-34265
  - https://nvd.nist.gov/vuln/detail/CVE-2022-34265
  - https://www.djangoproject.com/weblog/2022/jul/04/security-releases/
  - https://docs.djangoproject.com/en/4.0/releases/security/
  remediation: 'Upgrade Django to version 3.2.14 or 4.0.6 or later that properly sanitizes
    kind/lookup_name values in Trunc() and Extract() database functions.

    '
  severity: critical
  tags: sqli,dast,vulhub,cve,cve2022,django,vuln
variables:
  rand_string: '{{rand_text_alpha(15, "abc")}}'
