code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .[].projectId
    name: projectIds
    type: json
  source: 'gcloud projects list --format="json(projectId)"

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - '"Security Command Center API is not enabled in Project: " + projectId'
    type: dsl
  matchers:
  - type: word
    words:
    - '[]'
  source: 'gcloud services list --project $projectId --enabled --filter="name:securitycenter.googleapis.com"
    --format="json"

    '
flow: "code(1)\nfor(let projectId of iterate(template.projectIds)){\n  set(\"projectId\"\
  , projectId)\n  code(2)\n}\n"
id: gcloud-security-center-api-disabled
info:
  author: princechaddha
  description: 'To access historical security findings and asset data in Security
    Command Center, ensure that the Security Command Center API is enabled within
    your Google Cloud account. If the API is not enabled, certain security features
    and monitoring capabilities will be unavailable.

    '
  impact: 'Disabling the Security Command Center API may limit visibility and control
    over security threats, leading to potential vulnerabilities and undetected risks
    within Google Cloud environments.

    '
  name: Security Command Center API Disabled
  reference:
  - https://cloud.google.com/security-command-center/docs/reference/rest
  remediation: 'Enable the Security Command Center API for each Google Cloud project
    to maintain proper security monitoring and threat detection capabilities. This
    can be done through the Google Cloud Console or using the `gcloud services enable
    securitycenter.googleapis.com` command.

    '
  severity: high
  tags: cloud,devops,gcp,gcloud,security-center,gcp-cloud-config
self-contained: true
