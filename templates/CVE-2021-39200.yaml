http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 5.4', '<= 5.4.7')
    - compare_versions(version_by_js, '>= 5.4', '<= 5.4.7')
    - compare_versions(version_by_css, '>= 5.4', '<= 5.4.7')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2021-39200
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-39200
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 5.3
  description: WordPress is a free and open-source content management system written
    in PHP and paired with a MySQL or MariaDB database. In affected versions output
    data of the function wp_die() can be leaked under certain conditions, which can
    include data like nonces. It can then be used to perform actions on your behalf.
    This has been patched in WordPress 5.8.1, along with any older affected versions
    via minor releases. It's strongly recommended that you keep auto-updates enabled
    to receive the fix.
  metadata:
    shodan-query: vuln:CVE-2021-39200
  name: WordPress Core 5.4 - 5.8 - Sensitive Information Disclosure
  reference:
  - https://github.com/WordPress/wordpress-develop/security/advisories/GHSA-m9hc-7v5q-x8q5
  - https://hackerone.com/reports/1142140
  - https://www.debian.org/security/2021/dsa-4985
  severity: medium
  tags: cve,wordpress,wp-core,medium
