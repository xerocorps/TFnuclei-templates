http:
- host-redirects: true
  matchers:
  - part: body
    regex:
    - location\.href(.*)\/([A-Z]+)\/userRpm\/Index\.htm";
    type: regex
  - part: header
    type: word
    words:
    - text/html
  - part: header
    status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  raw:
  - 'GET /userRpm/LoginRpm.htm?Save=Save HTTP/1.1

    Host: {{Hostname}}

    Cookie: JS=true; Authorization=Basic {{cookie}}

    '
id: tplink-wR940n-default-login
info:
  author: ritikchaddha
  metadata:
    max-request: 1
    shodan-query: html:"/userRpm/"
    verified: true
  name: TP-Link Wireless N Router WR940N - Default-Login
  severity: high
  tags: tplink,wR940n,default-login,misconfig,vuln
variables:
  cookie: '{{base64(username + '':'' + en_pass)}}'
  en_pass: '{{md5(password)}}'
  password: admin
  username: admin
