http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - version
    - build
    - built by
  method: GET
  path:
  - '{{BaseURL}}/api/7/nginx?fields=version,build'
  - '{{BaseURL}}/api/8/nginx?fields=version,build'
  - '{{BaseURL}}/api/9/nginx?fields=version,build'
  stop-at-first-match: true
id: nginx-plus-rest-api
info:
  author: reewardius
  metadata:
    max-request: 3
  name: All API requests should contain a supported API version in the URI
  reference: https://zoidsec.medium.com/breaking-parse-logic-gain-access-to-nginx-api-read-write-upstreams-1cb062aa44ca
  severity: medium
  tags: nginx
