http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Version:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - adforest
  - dsl:
    - compare_versions(version, '<= 5.1.8')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/themes/adforest/style.css'
  redirects: true
id: CVE-2024-12857-adforest-4ff3b4f1-dd36-43d0-b472-55a940907437
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-12857
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  description: 'The AdForest theme for WordPress is vulnerable to authentication bypass
    in all versions up to, and including, 5.1.8. This is due to the plugin not properly
    verifying a user''s identity prior to logging them in as that user. This makes
    it possible for unauthenticated attackers to authenticate as any user as long
    as they have configured OTP login by phone number.

    '
  metadata:
    fofa-query: wp-content/themes/adforest/
    google-query: inurl:"/wp-content/themes/adforest/"
    shodan-query: http.html:"wp-content/themes/adforest/"
  name: 'AdForest <= 5.1.8 - Authentication Bypass

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/4ff3b4f1-dd36-43d0-b472-55a940907437?source=api-prod
  severity: critical
  tags: cve,wordpress,wp-theme,adforest,critical,production
