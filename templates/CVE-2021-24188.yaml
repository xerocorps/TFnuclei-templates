http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-content-copy-protector
  - dsl:
    - compare_versions(version, '< 3.1.5')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-content-copy-protector/readme.txt'
  redirects: true
id: CVE-2021-24188
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24188
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  description: Low privileged users can use the AJAX action 'cp_plugins_do_button_job_later_callback'
    in the WP Content Copy Protection & No Right Click WordPress plugin before 3.1.5,
    to install any plugin (including a specific version) from the WordPress repository,
    as well as activate arbitrary plugin from then blog, which helps attackers install
    vulnerable plugins and could lead to more critical vulnerabilities like RCE.
  metadata:
    fofa-query: wp-content/plugins/wp-content-copy-protector/
    google-query: inurl:"/wp-content/plugins/wp-content-copy-protector/"
    shodan-query: vuln:CVE-2021-24188
  name: WP Copy Protection & No Right Click <= 3.1.4 - Missing Authorization to Arbitrary
    Plugin Installation/Activation
  reference:
  - https://wpscan.com/vulnerability/74889e29-5349-43d1-baf5-1622493be90c
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24188
  severity: high
  tags: cve,wordpress,wp-plugin,wp-content-copy-protector,high
