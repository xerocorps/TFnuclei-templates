http:
- matchers:
  - status:
    - 401
    type: status
  - part: header
    regex:
    - Microsoft-HTTPAPI\/[0-9\.]+
    type: regex
  - condition: or
    part: header
    type: word
    words:
    - 'Www-Authenticate: NTLM'
    - 'Www-Authenticate: Negotiate'
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/wsman'
id: winrm-detect
info:
  author: pussycat0x
  description: 'Detects Windows Remote Management (WinRM) by checking HTTP response
    headers on ports 5985 (HTTP) and 5986 (HTTPS).

    '
  metadata:
    max-request: 1
    shodan-query: product:"WinRM"
    verified: true
  name: Windows Remote Management - Detection
  severity: info
  tags: network,winrm,windows,discovery
