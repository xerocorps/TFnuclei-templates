code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    name: bucketname
    regex:
    - oss://([a-zA-Z0-9-]+)
    type: regex
  source: 'aliyun oss ls --region $region

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - bucket + " OSS Bucket is Public Accessible "
    type: dsl
  matchers:
  - negative: true
    type: word
    words:
    - private
  - condition: or
    type: word
    words:
    - public-read
    - public-read-write
  matchers-condition: and
  source: 'aliyun oss stat $bucket --region $region

    '
flow: "code(1)\nfor (let BucketName of iterate(template.bucketname)) {\n  set(\"bucket\"\
  , BucketName)\n  code(2)\n}\n"
id: oos-bucket-public-access
info:
  author: DhiyaneshDK
  description: 'Ensure that your Object Storage Service (OSS) buckets are not publicly
    accessible to the Internet in order to protect against unauthorized access. Allowing
    public, anonymous access through bucket ACLs and bucket policies gives everyone
    the ability to access bucket contents.

    '
  metadata:
    max-request: 2
    verified: true
  name: OSS Bucket Public Accessible
  reference:
  - https://www.trendmicro.com/cloudoneconformity/knowledge-base/alibaba-cloud/AlibabaCloud-OSS/publicly-accessible-oss-bucket.html
  - https://www.alibabacloud.com/help/en/oss/user-guide/block-public-access
  severity: high
  tags: cloud,devops,aliyun,alibaba,aliyun-cloud-config,alibaba-oss
self-contained: true
variables:
  region: cn-hangzhou
