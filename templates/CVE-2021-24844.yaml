http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - affiliates-manager
  - dsl:
    - compare_versions(version, '<= 2.8.6')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/affiliates-manager/readme.txt'
  redirects: true
id: CVE-2021-24844
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24844
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
  description: The Affiliates Manager WordPress plugin before 2.8.7 does not validate
    the orderby parameter before using it in an SQL statement in the admin dashboard,
    leading to an SQL Injection issue
  metadata:
    fofa-query: wp-content/plugins/affiliates-manager/
    google-query: inurl:"/wp-content/plugins/affiliates-manager/"
    shodan-query: vuln:CVE-2021-24844
  name: Affiliate Manager <= 2.8.6 - Admin+ SQL injection
  reference:
  - https://wpscan.com/vulnerability/ebd6d13c-572e-4861-b7d1-a7a87332ce0d
  - https://plugins.trac.wordpress.org/changeset/2611862/
  severity: high
  tags: cve,wordpress,wp-plugin,affiliates-manager,high
