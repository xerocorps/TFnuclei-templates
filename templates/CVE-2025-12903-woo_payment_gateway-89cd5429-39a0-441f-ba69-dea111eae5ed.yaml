http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - woo-payment-gateway
  - dsl:
    - compare_versions(version, '<= 3.2.78')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/woo-payment-gateway/readme.txt'
  redirects: true
id: CVE-2025-12903-woo_payment_gateway-89cd5429-39a0-441f-ba69-dea111eae5ed
info:
  author: topscoder
  classification:
    cve-id: CVE-2025-12903
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
  description: 'The Payment Plugins Braintree For WooCommerce plugin for WordPress
    is vulnerable to authorization bypass due to a missing capability check on the
    wc-braintree/v1/3ds/vaulted_nonce REST API endpoint in all versions up to, and
    including, 3.2.78. This is due to the endpoint being registered with permission_callback
    set to __return_true and processing user-supplied token IDs without verifying
    ownership or authentication. This makes it possible for unauthenticated attackers
    to retrieve payment method nonces for any stored payment token in the system,
    which can be used to create fraudulent transactions, charge customer credit cards,
    or attach payment methods to other subscriptions.

    '
  metadata:
    fofa-query: wp-content/plugins/woo-payment-gateway/
    google-query: inurl:"/wp-content/plugins/woo-payment-gateway/"
    shodan-query: http.html:"wp-content/plugins/woo-payment-gateway/"
  name: 'Payment Plugins Braintree For WooCommerce <= 3.2.78 - Missing Authorization
    to Payment Token Exposure and Transaction Fraud

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/89cd5429-39a0-441f-ba69-dea111eae5ed?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,woo-payment-gateway,high,production
