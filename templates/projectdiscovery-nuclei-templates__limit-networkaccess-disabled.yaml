code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    name: bucketname
    regex:
    - oss://([a-zA-Z0-9-]+)
    type: regex
  source: 'aliyun oss ls --region $region

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - bucket + " Limit Network Access to Selected Networks is Disabled "
    type: dsl
  matchers:
  - negative: true
    type: word
    words:
    - '"IpAddress":'
    - '"acs:SourceIp":'
  - condition: and
    type: word
    words:
    - '"Principal":'
    - '"Resource":'
    - '"Action":'
  matchers-condition: and
  source: 'aliyun oss bucket-policy --method get $bucket --region $region

    '
flow: "code(1)\nfor (let BucketName of iterate(template.bucketname)) {\n  set(\"bucket\"\
  , BucketName)\n  code(2)\n}\n"
id: limit-networkaccess-disabled
info:
  author: DhiyaneshDK
  description: 'Limit Network Access to Selected Networks in Alibaba OSS allows you
    to restrict access to your object storage service (OSS) to specific IP addresses
    or IP ranges, enhancing security by ensuring that only trusted networks can interact
    with your data."

    '
  metadata:
    max-request: 2
    verified: true
  name: Limit Network Access to Selected Networks - Disabled
  reference:
  - https://www.trendmicro.com/cloudoneconformity/knowledge-base/alibaba-cloud/AlibabaCloud-OSS/publicly-accessible-oss-bucket.html
  - https://www.alibabacloud.com/help/en/oss/user-guide/block-public-access
  severity: medium
  tags: cloud,devops,aliyun,alibaba,aliyun-cloud-config,alibaba-oss
self-contained: true
variables:
  region: cn-hangzhou
