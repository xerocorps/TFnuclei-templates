code:
- engine:
  - sh
  - bash
  extractors:
  - internal: true
    json:
    - .Items.DBInstance[].DBInstanceId
    name: dbinstanceid
    type: json
  source: 'aliyun rds DescribeDBInstances --region $region

    '
- engine:
  - sh
  - bash
  extractors:
  - dsl:
    - instance + " RDS log_connections Parameter for PostgreSQL Database Instances
      "
    type: dsl
  matchers:
  - condition: and
    type: word
    words:
    - '"ParameterValue": "off"'
    - '"ParameterName": "log_connections"'
  source: 'aliyun rds DescribeParameters --DBInstanceId $dbinstanceid --region $region
    | jq -r ''.RunningParameters.DBInstanceParameter[] | select(.ParameterName ==
    "log_connections") | {ParameterName, ParameterValue}''

    '
flow: "code(1)\nfor(let DBInstanceId of iterate(template.dbinstanceid)){\n  set(\"\
  instance\", DBInstanceId)\n  code(2)\n}\n"
id: log-connections-disabled
info:
  author: DhiyaneshDK
  description: 'The log_connections parameter in PostgreSQL is disabled, meaning the
    database does not log new client connections. This may limit the ability to monitor
    and track when clients connect to the database for security and auditing purposes.

    '
  metadata:
    max-request: 2
    verified: true
  name: PostgreSQL "log_connections" Parameter - Disabled
  reference:
  - https://www.alibabacloud.com/help/en/rds/apsaradb-rds-for-postgresql/use-a-parameter-template-to-configure-the-parameters-of-apsaradb-rds-for-postgresql-instances
  - https://www.trendmicro.com/cloudoneconformity/knowledge-base/alibaba-cloud/AlibabaCloud-RDS/enable-log-connections-for-postgresql.html
  severity: medium
  tags: cloud,devops,aliyun,alibaba,alibaba-cloud-config,alibaba-rds
self-contained: true
variables:
  region: cn-hangzhou
