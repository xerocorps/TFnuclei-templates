id: svn-leak
info:
  confidence: Certain
  name: SVN Leak Source
  risk: Medium
params:
- root: '{{.BaseURL}}'
requests:
- detections:
  - StatusCode() == 200 && (RegexSearch("resHeaders", ".*Content-Type:.*octet-stream")
    || RegexSearch("resHeaders", "text/plain")) && StringSearch("body", "END")  &&
    StringSearch("body", "svn:")
  - StatusCode() == 200 && (RegexSearch("resHeaders", ".*Content-Type:.*octet-stream")
    || RegexSearch("resHeaders", "text/plain")) && StringSearch("body","dir") && StringSearch("body",
    "file")
  headers:
  - User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_1) AppleWebKit/537.36
      (KHTML, like Gecko) Chrome/80.0.3984.0 Safari/537.36
  method: GET
  redirect: false
  url: '{{.root}}/{{.svnfile}}'
variables:
- svnfile: '.svn/entries

    .svn/all-wcprops

    CVS/Entries

    '
