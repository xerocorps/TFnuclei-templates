http:
- extractors:
  - attribute: src
    type: xpath
    xpath:
    - //script[contains(@src,'//') and not(matches(translate(@integrity,'ABCDEFGHIJKLMNOPQRSTUVWXYZ+/-=','abcdefghijklmnopqrstuvwxyz+/-='),
      '^sha(256|384|512)-'))]
  - attribute: src
    type: xpath
    xpath:
    - //script[contains(@src, '//') and (not(@integrity) or not(matches(translate(@integrity,
      'ABCDEFGHIJKLMNOPQRSTUVWXYZ+/-=', 'abcdefghijklmnopqrstuvwxyz+/-='), '^sha(256|384|512)-')))]
  - attribute: href
    type: xpath
    xpath:
    - //link[@rel='stylesheet' and contains(@href, '//') and (not(@integrity) or not(matches(translate(@integrity,
      'ABCDEFGHIJKLMNOPQRSTUVWXYZ+/-=', 'abcdefghijklmnopqrstuvwxyz+/-='), '^sha(256|384|512)-')))]
  matchers:
  - part: body
    type: xpath
    xpath:
    - //script[contains(@src,'//') and not(matches(translate(@integrity,'ABCDEFGHIJKLMNOPQRSTUVWXYZ+/-=','abcdefghijklmnopqrstuvwxyz+/-='),
      '^sha(256|384|512)-'))]
    - //script[contains(@src, '//') and (not(@integrity) or not(matches(translate(@integrity,
      'ABCDEFGHIJKLMNOPQRSTUVWXYZ+/-=', 'abcdefghijklmnopqrstuvwxyz+/-='), '^sha(256|384|512)-')))]
    - //link[@rel='stylesheet' and contains(@href, '//') and (not(@integrity) or not(matches(translate(@integrity,
      'ABCDEFGHIJKLMNOPQRSTUVWXYZ+/-=', 'abcdefghijklmnopqrstuvwxyz+/-='), '^sha(256|384|512)-')))]
  max-redirects: 5
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  redirects: true
id: missing-sri
info:
  author: lucky0x0d,PulseSecurity.co.nz,sullo amarsct
  description: 'Checks if external script and stylesheet tags in the HTML response
    are missing the Subresource Integrity (SRI) attribute.

    '
  metadata:
    max-request: 1
  name: Missing Subresource Integrity
  reference:
  - https://cheatsheetseries.owasp.org/cheatsheets/Third_Party_Javascript_Management_Cheat_Sheet.html#subresource-integrity
  - https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity
  severity: info
  tags: compliance,js,css,sri,misconfig,vuln
