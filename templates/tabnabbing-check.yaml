id: tabnabbing-check
info:
  author: bolli95
  name: Reverse Tabnabbing
  reference: '- https://owasp.org/www-community/attacks/Reverse_Tabnabbing

    - https://www.youtube.com/watch?v=TMKZCHYmtD4

    - https://hackerone.com/reports/211065

    '
  severity: info
  tags: misc
requests:
- matchers:
  - dsl:
    - regex("<a[A-z0-9\/\"\&\=\%\#\.\:\_\@\\\$ ]*target\=\"_blank\"[A-z0-9\/\"\&\%\=\#\.\:\_\@\\\$
      ]*>", replace_regex(replace_regex(body, "<a[A-z0-9\/\"\&\=\%\#\.\:\_\@\\\$ ]*target\=\"_blank\"[A-z0-9\/\"\&\%\=\#\.\:\_\@\\\$
      ]*(rel=\"noopener noreferrer\"|rel=\"noreferrer noopener\"|rel=\"noreferrer\"|rel=\"noopener\")[A-z0-9\/\"\&\%\=\#\.\:\_\@\\\$
      ]*>", ""), "<a[A-z0-9\/\"\&\=\%\#\.\:\_\@\\\$ ]*(rel=\"noopener noreferrer\"|rel=\"noreferrer
      noopener\"|rel=\"noreferrer\"|rel=\"noopener\")[A-z0-9\/\"\&\%\=\#\.\:\_\@\\\$
      ]*target\=\"_blank\"[A-z0-9\/\"\&\%\=\#\.\:\_\@\\\$ ]*>", "")) || regex("window\.open\\([^,]+\\)",
      body)
    type: dsl
  - dsl:
    - '!contains(tolower(all_headers), ''referrer-policy: no-referrer'')'
    type: dsl
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}'
