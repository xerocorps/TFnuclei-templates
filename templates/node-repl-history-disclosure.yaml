http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains_any(body, "require(",".exit","module.exports","let","process.","console.log(")
    - contains(header, "application/octet-stream")
    type: dsl
  method: GET
  path:
  - '{{BaseURL}}/.node_repl_history'
  - '{{BaseURL}}/node_repl_history'
  stop-at-first-match: true
id: node-repl-history-disclosure
info:
  author: pussycat0x
  description: 'The Node.js REPL history file (.node_repl_history) was exposed, which
    had contained a log of commands entered into the Node.js interactive shell.

    '
  metadata:
    max-request: 2
    shodan-query: http.html:".node_repl_history"
    verified: true
  name: Node.js REPL History Disclosure
  reference:
  - https://nodejs.org/api/repl.html#persistent-history
  - https://joshtronic.com/2022/12/18/nodejs-repl-history/
  severity: low
  tags: exposure,nodejs,history,disclosure,misconfiguration
