http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - product-input-fields-for-woocommerce
  - dsl:
    - compare_versions(version, '<= 1.12.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/product-input-fields-for-woocommerce/readme.txt'
  redirects: true
id: CVE-2024-13359-product_input_fields_for_woocommerce-a9c08f2e-bffd-40a6-89f3-559cb34f4395
info:
  author: topscoder
  classification:
    cve-id: CVE-2024-13359
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
  description: 'The Product Input Fields for WooCommerce plugin for WordPress is vulnerable
    to arbitrary file uploads due to insufficient file type validation in the add_product_input_fields_to_order_item_meta()
    function in all versions up to, and including, 1.12.0. This may make it possible
    for unauthenticated attackers to upload arbitrary files on the affected site''s
    server which may make remote code execution possible. Please note that by default
    the plugin is only vulnerable to a double extension file upload attack, unless
    an administrators leaves the accepted file extensions field blank which can make
    .php file uploads possible. Please note 1.12.2 was mistakenly marked as patched
    while 1.12.1 was marked as vulnerable for a short period of time, this is not
    the case and 1.12.1 is fully patched.

    '
  metadata:
    fofa-query: wp-content/plugins/product-input-fields-for-woocommerce/
    google-query: inurl:"/wp-content/plugins/product-input-fields-for-woocommerce/"
    shodan-query: http.html:"wp-content/plugins/product-input-fields-for-woocommerce/"
  name: 'Product Input Fields for WooCommerce  <= 1.12.0 - Unauthenticated Limited
    File Upload

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/a9c08f2e-bffd-40a6-89f3-559cb34f4395?source=api-prod
  severity: high
  tags: cve,wordpress,wp-plugin,product-input-fields-for-woocommerce,high,production
