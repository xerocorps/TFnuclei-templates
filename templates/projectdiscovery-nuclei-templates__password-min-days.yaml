code:
- args:
  - -c
  - "MIN_DAYS_LINE=$(grep -Pi -- '^\\h*PASS_MIN_DAYS\\h+\\d+\\b' /etc/login.defs |\
    \ head -n1)\nif [ -n \"$MIN_DAYS_LINE\" ]; then\n  VALUE=$(echo \"$MIN_DAYS_LINE\"\
    \ | awk '{print $2}')\n  if [ \"$VALUE\" -gt 0 ]; then\n    echo \"[password-min-days-check:Policy-Pass]\
    \ [PASS_MIN_DAYS is $VALUE (valid)] [CIS_PASS]\"\n  else\n    echo \"[password-min-days-check:Policy-Fail]\
    \ [PASS_MIN_DAYS is $VALUE (invalid)] [CIS_FAIL]\"\n  fi\nelse\n  echo \"[password-min-days-check:Policy-Fail]\
    \ [PASS_MIN_DAYS not set or malformed] [CIS_FAIL]\"\nfi\n"
  engine:
  - bash
  matchers:
  - name: policy-pass
    type: word
    words:
    - Policy-Pass
  - name: policy-fail
    type: word
    words:
    - Policy-Fail
id: password-min-days
info:
  author: Th3l0newolf
  description: 'The PASS_MIN_DAYS setting in /etc/login.defs defines the minimum number
    of days required between password changes.This prevents users from rapidly cycling
    through passwords to bypass password history requirements.

    '
  metadata:
    verified: true
  name: Ensure Minimum Password Days is Configured
  reference:
  - https://www.cisecurity.org/benchmark/ubuntu_linux
  remediation: 'Edit /etc/login.defs and ensure the line is set to: PASS_MIN_DAYS
    1 (or another value greater than 0).Verify the change with: grep -Pi -- ''^\h*PASS_MIN_DAYS\h+\d+\b''
    /etc/login.defs

    '
  severity: medium
  tags: cis,local,cisecurity,audit,linux,ubuntu,password
self-contained: true
