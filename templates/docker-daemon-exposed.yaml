http:
- extractors:
  - group: 1
    internal: true
    name: version
    regex:
    - '"ApiVersion":"(.*?)"'
    type: regex
  matchers:
  - condition: and
    dsl:
    - status_code_2 == 200
    - contains(body_1, "ApiVersion") && contains(body_1, "GitCommit") && contains(body_1,
      "GoVersion")  && contains(body_1, "KernelVersion")
    - contains(body_2, "Id") && contains(body_2, "Names") && contains(body_2, "Image")
      && contains(body_2, "Command") && contains(body_2, "PrivatePort") && contains(body_2,
      "PublicPort") || contains(body_2, "[]")
    type: dsl
  raw:
  - 'GET /version HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /v{{version}}/containers/json HTTP/1.1

    Host: {{Hostname}}

    '
id: docker-daemon-exposed
info:
  author: Arm!tage
  description: 'Docker Daemon exposed on the network map can help remote attacker
    to gain access to the Docker containers and potentially the host system.

    '
  metadata:
    fofa-query: app="docker-Daemon" && port="2375"
    max-request: 2
    shodan-query: port:2375 product:"docker"
    verified: true
  name: Docker Daemon Exposed
  severity: critical
  tags: docker,exposure,misconfig
