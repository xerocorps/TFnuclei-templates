http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - w3-total-cache
  - dsl:
    - compare_versions(version, '<= 0.9.4')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/w3-total-cache/readme.txt'
  redirects: true
id: CVE-2014-8724-w3_total_cache-71114965-c8e3-4f2f-b308-f75adc7f2d31
info:
  author: topscoder
  classification:
    cve-id: CVE-2014-8724
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    cvss-score: 5.4
  description: 'Cross-site scripting (XSS) vulnerability in the W3 Total Cache plugin
    before 0.9.4.1 for WordPress, when debug mode is enabled, allows remote attackers
    to inject arbitrary web script or HTML via the "Cache key" in the HTML-Comments,
    as demonstrated by the PATH_INFO to the default URI.

    '
  metadata:
    fofa-query: wp-content/plugins/w3-total-cache/
    google-query: inurl:"/wp-content/plugins/w3-total-cache/"
    shodan-query: http.html:"wp-content/plugins/w3-total-cache/"
  name: 'W3 Total Cache <= 0.9.4 - Cross-Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/71114965-c8e3-4f2f-b308-f75adc7f2d31?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,w3-total-cache,medium,production
