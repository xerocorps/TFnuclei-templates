http:
- matchers:
  - condition: and
    part: body
    regex:
    - \"errors\":\s*\[.*?\]
    - \"message\":\s*\".*?@aa.*?\"
    type: regex
  - part: content_type
    type: word
    words:
    - application/json
  matchers-condition: and
  raw:
  - 'POST /graphql HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"query": "query cop { __typename @aa@aa@aa@aa@aa@aa@aa@aa@aa@aa }", "operationName":
    "cop"}

    '
id: graphql-directive-overloading
info:
  author: shamo0
  description: 'GraphQL directive overloading occurs when multiple duplicated directives
    are allowed in a single query, potentially leading to denial of service attacks
    or resource exhaustion.

    '
  impact: 'An attacker could exploit directive overloading to consume excessive server
    resources, potentially leading to denial of service conditions.

    '
  metadata:
    max-request: 1
    verified: true
  name: GraphQL Directive Overloading
  reference:
  - https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/12-API_Testing/01-Testing_GraphQL
  - https://github.com/dolevf/graphql-cop/blob/main/lib/tests/dos_directive_overloading.py
  remediation: 'Configure GraphQL server to limit or prevent directive overloading
    by implementing proper validation and rate limiting.

    '
  severity: info
  tags: graphql,misconfig,vuln
