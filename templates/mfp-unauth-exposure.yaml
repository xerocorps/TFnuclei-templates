http:
- extractors:
  - group: 1
    regex:
    - <(?:pwg:)?SerialNumber>([^<]+)</(?:pwg:)?SerialNumber>
    - <(?:pwg:)?Model>([^<]+)</(?:pwg:)?Model>
    - <(?:pwg:)?MakeAndModel>([^<]+)</(?:pwg:)?MakeAndModel>
    type: regex
  matchers:
  - condition: and
    type: word
    words:
    - xmlns:pwg=
    - <scan:ScannerCapabilities
  - condition: or
    part: header
    type: word
    words:
    - application/xml
    - text/xml
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/eSCL/ScannerCapabilities'
id: mfp-unauth-exposure
info:
  author: matejsmycka
  description: 'Unauthorized access to MFP (Multi-function printer) using eSCL protocol
    allows attackers to scan documents left physically in the printer and send them
    to an arbitrary location. Furthermore, exposure of this endpoint allows attackers
    to gather information about the printer, serial number, model, and possibly pull
    documents scanned by legitimate users.

    '
  metadata:
    max-request: 1
    verified: true
  name: Multi-function Printer - Unauthorized Access
  reference:
  - https://wiki.debian.org/eSCL
  - https://support.princh.com/en/the-onboarding-process-1
  - https://mopria.org/spec-download
  - https://github.com/xJonathanLEI/escl-rs
  severity: medium
  tags: network,iot,printer,misconfig,escl,vuln
