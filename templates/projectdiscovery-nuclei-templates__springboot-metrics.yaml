http:
- matchers:
  - condition: and
    dsl:
    - contains_any(tolower(content_type), 'application/json', 'application/vnd.spring-boot')
    - status_code == 200
    type: dsl
  - condition: or
    part: body
    type: word
    words:
    - '{"mem":'
    - '{"heap":'
    - '{"nonheap":'
    - '{"threads":'
    - '{"gc":'
    - '{"names":['
    - '"jvm.memory'
    - '"process.cpu'
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/metrics'
  - '{{BaseURL}}/actuator/metrics'
  stop-at-first-match: true
id: springboot-metrics
info:
  author: pussycat0x,TheZakMan
  description: 'Spring Boot Metrics Actuator endpoint was detected, which may expose
    system metrics information. This template detects both older Spring Boot 1.x format
    and newer 2.x/3.x format.

    '
  metadata:
    max-request: 2
    verified: true
  name: Springboot Actuator Metrics - Exposure
  severity: low
  tags: springboot,exposure,misconfig,vuln
