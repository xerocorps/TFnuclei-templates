http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - iq-block-country
  - dsl:
    - compare_versions(version, '< 1.2.13')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/iq-block-country/readme.txt'
  redirects: true
id: CVE-2022-0246
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-0246
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 6.8
  description: The settings of the iQ Block Country WordPress plugin before 1.2.13
    can be exported or imported using its backup functionality. An authorized user
    can import preconfigured settings of the plugin by uploading a zip file. After
    the uploading process, files in the uploaded zip file are extracted one by one.
    During the extraction process, existence of a file is checked. If the file exists,
    it is deleted without any security control by only considering the name of the
    extracted file. This behavior leads to 'Zip Slip' vulnerability.
  metadata:
    fofa-query: wp-content/plugins/iq-block-country/
    google-query: inurl:"/wp-content/plugins/iq-block-country/"
    shodan-query: vuln:CVE-2022-0246
  name: iQ Block Country < 1.2.13 - Admin+ Arbitrary File Deletion via Zip Slip
  reference:
  - https://wpscan.com/vulnerability/892802b1-26e2-4ce1-be6f-71ce29687776
  - https://www.exploit-db.com/exploits/50830
  - https://vuldb.com/?id.196813
  severity: medium
  tags: cve,wordpress,wp-plugin,iq-block-country,medium
