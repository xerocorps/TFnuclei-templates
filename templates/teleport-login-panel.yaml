http:
- extractors:
  - json:
    - '"Version: " +.server_version'
    type: json
  matchers:
  - condition: and
    part: body
    regex:
    - '"server_version"\s*:\s*"\d+\.\d+\.\d+"'
    - teleport
    type: regex
  method: GET
  path:
  - '{{BaseURL}}/webapi/ping'
id: teleport-login-panel
info:
  author: pdteam,mahmoud0x00
  description: 'Detects Teleport web login interface exposed at /web/login and version
    information from /webapi/ping

    '
  metadata:
    fofa-query:
    - icon_hash="544208100"
    - icon_hash="1854879765"
    - icon_hash="-1275955539"
    - 'Set-Cookie: __Host-grv_csrf'
    max-request: 1
    shodan-query:
    - http.favicon.hash:544208100
    - http.favicon.hash:1854879765
    - http.favicon.hash:-1275955539
    - 'Set-Cookie: __Host-grv_csrf'
    verified: true
  name: Teleport Login Panel - Detect
  reference:
  - https://github.com/gravitational/teleport
  severity: info
  tags: panel,teleport,login,oss,discovery
