code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell.exe
  matchers:
  - type: word
    words:
    - AutoRun is enabled
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'if ((Get-ItemProperty -Path ''HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer''
    -Name ''NoDriveTypeAutoRun'' -ErrorAction SilentlyContinue).NoDriveTypeAutoRun
    -ne ''0xFF'') { Write-Output ''AutoRun is enabled''; }

    '
id: windows-autorun-enabled
info:
  author: princechaddha
  description: Checks if AutoRun is enabled for removable media.
  impact: 'Enabling AutoRun for removable media can lead to automatic execution of
    malicious software.

    '
  name: AutoRun Enabled
  remediation: 'Disable AutoRun to prevent potential malware from running automatically
    when a device is connected.

    '
  severity: medium
  tags: windows,autorun,code,windows-audit
self-contained: true
