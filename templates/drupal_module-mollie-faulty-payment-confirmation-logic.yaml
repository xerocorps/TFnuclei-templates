http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '<= 2.2.1')
    type: dsl
  matchers:
  - condition: and
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - condition: and
    status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - mollie
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/mollie/mollie.info'
  redirects: true
id: drupal_module-mollie-faulty-payment-confirmation-logic
info:
  author: me
  description: This module enables you to pay online via Mollie. The module might
    not properly load the correct order to update the payment status when Mollie redirects
    to the redirect URL. This can allow an attacker to apply other peoples orders
    to their own, getting credit without paying. This vulnerability is mitigated by
    the fact that an attacker must have some knowledge about the modules internal
    functionality. The issue only affects installations that use the Mollie for Drupal
    Commerce submodule.
  metadata:
    created_at: '2025-01-09'
    fofa-query: /sites/all/modules/mollie/
    google-query: inurl:'/sites/all/modules/mollie/
    impact: medium
    security-risk: "Moderately critical 12\u2009\u2215\u200925 AC:Complex/A:None/CI:None/II:Some/E:Theoretical/TD:All"
    type: indicator
    vulnerability: faulty-payment-confirmation-logic
  name: drupal_module-mollie-faulty-payment-confirmation-logic
  reference:
  - https://www.drupal.org/sa-contrib-2023-052
  severity: medium
  tags: drupal
