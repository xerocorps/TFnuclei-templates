code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - AvailableSecurityProperties
  - negative: true
    type: word
    words:
    - Credential Guard
  matchers-condition: and
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: 'Get-CimInstance -ClassName Win32_DeviceGuard -Namespace root\Microsoft\Windows\DeviceGuard

    '
id: credential-guard-disabled
info:
  author: princechaddha
  description: Verifies if Windows Defender Credential Guard is disabled, reducing
    protection against credential theft.
  impact: 'Disabling Credential Guard reduces protection against modern credential
    theft techniques.

    '
  name: Credential Guard Not Enabled
  remediation: 'Enable Credential Guard to enhance security against credential theft.

    '
  severity: high
  tags: credential-guard,code,windows-audit
self-contained: true
