http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - (?mi)Stable tag:\s*([0-9.]+)
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - new-user-approve
  - dsl:
    - compare_versions(version, '<= 3.0.9')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/new-user-approve/readme.txt'
  redirects: true
id: CVE-2025-12770-new_user_approve-3f1cf77a-64b4-405b-adcb-ef16d9e82ab2
info:
  author: topscoder
  classification:
    cve-id: CVE-2025-12770
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
  description: 'The New User Approve plugin for WordPress is vulnerable to unauthorized
    data disclosure in all versions up to, and including, 3.0.9 due to insufficient
    API key validation using loose equality comparison. This makes it possible for
    unauthenticated attackers to retrieve personally identifiable information (PII),
    including usernames and email addresses of users with various approval statuses
    via the Zapier REST API endpoints, by exploiting PHP type juggling with the api_key
    parameter set to "0" on sites where the Zapier API key has not been configured.

    '
  metadata:
    fofa-query: wp-content/plugins/new-user-approve/
    google-query: inurl:"/wp-content/plugins/new-user-approve/"
    shodan-query: http.html:"wp-content/plugins/new-user-approve/"
  name: 'New User Approve <= 3.0.9 - Unauthenticated Sensitive Information Disclosure
    via Type Juggling

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/3f1cf77a-64b4-405b-adcb-ef16d9e82ab2?source=api-prod
  severity: medium
  tags: cve,wordpress,wp-plugin,new-user-approve,medium,production
