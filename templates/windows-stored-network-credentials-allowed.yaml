code:
- args:
  - -ExecutionPolicy
  - Bypass
  engine:
  - powershell
  - powershell.exe
  matchers:
  - type: word
    words:
    - '0'
  pattern: '*.ps1'
  pre-condition: 'IsWindows();

    '
  source: '(Get-ItemProperty -Path ''HKLM:\SYSTEM\CurrentControlSet\Control\Lsa'').DisableDomainCreds

    '
id: windows-stored-network-credentials-allowed
info:
  author: princechaddha
  description: Checks if the system allows storage of credentials for network authentication.
  impact: 'Storing credentials for network authentication can be exploited to compromise
    network security.

    '
  name: Credentials storage for Network Authentication allowed
  remediation: 'Disable the storage of network credentials to enhance security.

    '
  severity: medium
  tags: windows,credentials,code,windows-audit
self-contained: true
