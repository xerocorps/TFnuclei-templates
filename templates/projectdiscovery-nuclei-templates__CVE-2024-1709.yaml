http:
- extractors:
  - kval:
    - Server
    part: header
    type: kval
  matchers:
  - condition: and
    part: body
    type: word
    words:
    - SetupWizardPage
    - ContentPanel SetupWizard
  - status:
    - 200
    type: status
  matchers-condition: and
  method: GET
  path:
  - '{{BaseURL}}/SetupWizard.aspx/{{string}}'
id: CVE-2024-1709
info:
  author: johnk3r
  classification:
    cpe: cpe:2.3:a:connectwise:screenconnect:*:*:*:*:*:*:*:*
    cve-id: CVE-2024-1709
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cwe-id: CWE-288,NVD-CWE-Other
    epss-percentile: 0.99946
    epss-score: 0.94322
  description: 'ConnectWise ScreenConnect 23.9.7 and prior are affected by an Authentication
    Bypass Using an Alternate Path or Channel vulnerability, which may allow an attacker
    direct access to confidential information or critical systems.

    '
  impact: 'Unauthenticated attackers can bypass authentication to access confidential
    information or critical systems, potentially leading to complete system compromise.

    '
  metadata:
    fofa-query:
    - app="ScreenConnect-Remote-Support-Software"
    - app="screenconnect-remote-support-software"
    - icon_hash=-82958153
    hunter-query:
    - app.name="ConnectWise ScreenConnect software"
    - app.name="connectwise screenconnect software"
    max-request: 1
    product: screenconnect
    shodan-query: http.favicon.hash:-82958153
    vendor: connectwise
    verified: true
    zoomeye-query: app="ScreenConnect Remote Management Software"
  name: ConnectWise ScreenConnect 23.9.7 - Authentication Bypass
  reference:
  - https://www.huntress.com/blog/a-catastrophe-for-control-understanding-the-screenconnect-authentication-bypass
  - https://github.com/watchtowrlabs/connectwise-screenconnect_auth-bypass-add-user-poc
  - https://www.connectwise.com/company/trust/security-bulletins/connectwise-screenconnect-23.9.8
  - https://nvd.nist.gov/vuln/detail/CVE-2024-1709
  - https://github.com/rapid7/metasploit-framework/pull/18870
  remediation: 'Update ConnectWise ScreenConnect to version 23.9.8 or later.

    '
  severity: critical
  tags: cve,cve2024,screenconnect,connectwise,auth-bypass,kev,vkev,vuln
variables:
  string: '{{rand_text_alpha(10)}}'
