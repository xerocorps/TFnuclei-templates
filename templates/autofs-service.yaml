code:
- args:
  - -c
  - "if dpkg-query -s autofs &>/dev/null; then\n  echo \"[autofs-service-check:Policy-Fail]\
    \ [autofs is installed] [CIS_FAIL]\"\nelse\n  echo \"[autofs-service-check:Policy-Pass]\
    \ [autofs is not installed] [CIS_PASS]\"\nfi\n"
  engine:
  - bash
  matchers:
  - name: policy-pass
    type: word
    words:
    - Policy-Pass
  - name: policy-fail
    type: word
    words:
    - Policy-Fail
id: autofs-service
info:
  author: Th3l0newolf
  description: "The autofs package provides the automounting service, which mounts\
    \ file systems automatically on demand. If not explicitly required, having this\
    \ service installed increases the system\u2019s attack surface and should be avoided.\n"
  metadata:
    verified: true
  name: Ensure autofs Service is Not Installed
  reference:
  - https://www.cisecurity.org/benchmark/ubuntu_linux
  remediation: '- Ensure the `autofs` package is not installed unless explicitly required.

    - To disable the service if present, run: sudo systemctl disable --now autofs
    2>/dev/null || true

    - To remove the package, run: sudo apt-get purge -y autofs

    - To clean up dependencies, run: sudo apt-get autoremove -y

    - To verify removal, run: dpkg-query -s autofs || echo "autofs not installed"

    '
  severity: info
  tags: cis,local,cisecurity,audit,linux,ubuntu
self-contained: true
