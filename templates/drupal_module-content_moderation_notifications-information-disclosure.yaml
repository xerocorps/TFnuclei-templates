http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '>=3.0.0 <= 3.6.0')
    type: dsl
  matchers:
  - condition: and
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - condition: and
    part: body
    type: word
    words:
    - content_moderation_notifications
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/content_moderation_notifications/content_moderation_notifications.info'
  redirects: true
id: drupal_module-content_moderation_notifications-information-disclosure
info:
  author: me
  description: This module enables notifications to be sent to all users of a particular
    role, or to the contents author when a piece of content is transitioned from one
    state to another via cores content_moderation module. The module doesnt sufficiently
    check access to content when sending notifications. This vulnerability is mitigated
    by the fact that an attacker must have been assigned to receive notifications
    for the given content. Additionally, only data sent in the email is visible, so
    the attacker cannot access the content on the site.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/content_moderation_notifications/
    google-query: inurl:'/sites/all/modules/content_moderation_notifications/
    impact: medium
    security-risk: "Moderately critical 11\u221525 AC:Complex/A:User/CI:Some/II:None/E:Proof/TD:All"
    type: indicator
    vulnerability: information-disclosure
  name: drupal_module-content_moderation_notifications-information-disclosure
  reference:
  - https://www.drupal.org/sa-contrib-2023-047
  severity: medium
  tags: drupal
