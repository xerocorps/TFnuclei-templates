http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '<= 3.4.2')
    - compare_versions(version_by_js, '<= 3.4.2')
    - compare_versions(version_by_css, '<= 3.4.2')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2012-4421
info:
  author: topscoder
  classification:
    cve-id: CVE-2012-4421
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 6.3
  description: The create_post function in wp-includes/class-wp-atom-server.php in
    WordPress before 3.4.2 does not perform a capability check, which allows remote
    authenticated users to bypass intended access restrictions and publish new posts
    by leveraging the Contributor role and using the Atom Publishing Protocol (aka
    AtomPub) feature.
  metadata:
    shodan-query: vuln:CVE-2012-4421
  name: WordPress Core < 3.4.2 - Missing Authorization Checks on create_post
  reference:
  - http://openwall.com/lists/oss-security/2012/09/13/4
  - http://core.trac.wordpress.org/changeset?old_path=%2Ftags%2F3.4.1&old=21780&new_path=%2Ftags%2F3.4.2&new=21780#file2
  - http://codex.wordpress.org/Version_3.4.2
  severity: medium
  tags: cve,wordpress,wp-core,medium
