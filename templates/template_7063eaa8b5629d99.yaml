info:
  author: OpenAI
  classification:
    country: any
    tags:
    - vmware
    - vcenter
    - rce
    - security
    - vulnerability
  description: Template to detect VMware vCenter Server instances vulnerable to Remote
    Code Execution (CVE-2021-22022)
  id: vcenter-rce
  matcher-condition: or
  matchers:
  - description: Response status indicates vCenter Server not vulnerable
    pattern: 400 Bad Request
    type: status
  - description: Vulnerable vCenter Server instance found in response body
    pattern: Invalid serialized Java type
    type: body
  name: VMware vCenter Server Remote Code Execution - Detect (CVE-2021-22022)
  reference:
  - https://www.vmware.com/security/advisories/VMSA-2021-0020.html
  requests:
    condition: and
    description: Attempt to exploit RCE vulnerability
    method: GET
    path:
    - /ui/h5-vsan/rest/proxy/service/&vsanQueryUtilSvc.getDiagnosticLog
  response:
  - description: Successful response status if vCenter Server is not vulnerable
    status:
    - 400
  severity: Critical
