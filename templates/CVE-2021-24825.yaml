http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - custom-content-shortcode
  - dsl:
    - compare_versions(version, '<= 4.0.1')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/custom-content-shortcode/readme.txt'
  redirects: true
id: CVE-2021-24825
info:
  author: topscoder
  classification:
    cve-id: CVE-2021-24825
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 4.3
  description: The Custom Content Shortcode WordPress plugin before 4.0.2 does not
    validate the data passed to its load shortcode, which could allow Contributor+
    (v < 4.0.1) or Admin+ (v < 4.0.2) users to display arbitrary files from the filesystem
    (such as logs, .htaccess etc), as well as perform Local File Inclusion attacks
    as PHP files will be executed. Please note that such attack is still possible
    by admin+ in single site blogs by default (but won't be when either the unfiltered_html
    or file_edit is disallowed)
  metadata:
    fofa-query: wp-content/plugins/custom-content-shortcode/
    google-query: inurl:"/wp-content/plugins/custom-content-shortcode/"
    shodan-query: vuln:CVE-2021-24825
  name: Custom Content Shortcode <= 4.0.1 - Authenticated Arbitrary File Access /
    Local File Inclusion
  reference:
  - https://wpscan.com/vulnerability/be9d6f82-c972-459a-bacf-65b3dfb11a09
  severity: medium
  tags: cve,wordpress,wp-plugin,custom-content-shortcode,medium
