http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '8.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - spamspan
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/spamspan/spamspan.info'
  redirects: true
id: drupal_module-spamspan-cross-site-scripting
info:
  author: Bishopfox
  description: The SpamSpan module obfuscates email addresses to help prevent spambots
    from collecting them. This module contains a spamspan twig filter which doesnt
    sanitize the passed HTML string. This vulnerability is mitigated by the fact that
    sites must have custom twig template files that use the SpamSpan filter on a field
    that an attacker could populate. By default the SpamSpan module does not use the
    vulnerable twig filter.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/spamspan/
    google-query: inurl:'/sites/all/modules/spamspan/
    impact: medium
    security-risk: "Moderately critical 11\u221525 AC:Basic/A:None/CI:None/II:Some/E:Theoretical/TD:Uncommon"
    type: indicator
    vulnerability: cross-site-scripting
  name: drupal_module-spamspan-cross-site-scripting
  reference:
  - https://www.drupal.org/sa-contrib-2020-002
  severity: medium
  tags: drupal
