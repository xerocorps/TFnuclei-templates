expression: r0() || r1() || r2() || r3() || r4() || r5() || r6() || r7()
id: jira-unauthenticated
info:
  author: TESS
  name: Jira Unauthenticated Admin Projects
  severity: info
  verfied: true
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(b'key') && response.body.bcontains(b'link')
      && response.body.bcontains(b'label') && response.body.bcontains(b'self') &&
      response.headers["set-cookie"].icontains("atlassian.xsrf.token")
    request:
      method: GET
      path: /rest/menu/latest/admin
  r1:
    expression: response.status == 200 && response.body.bcontains(b'dashboards') &&
      response.body.bcontains(b'startAt') && response.body.bcontains(b'maxResults')
    request:
      method: GET
      path: /rest/api/2/dashboard?maxResults=100
  r2:
    expression: response.status == 200 && response.body.bcontains(b'jaxbDirectoryContents')
    request:
      follow_redirects: true
      method: GET
      path: /rest/config/1.0/directory
  r3:
    expression: response.status == 200 && response.body.bcontains(b'self') && response.body.bcontains(b'description')
      && response.body.bcontains(b'name')  && response.headers["set-cookie"].icontains("atlassian.xsrf.token")
    request:
      method: GET
      path: /rest/api/2/projectCategory?maxResults=1000
  r4:
    expression: response.status == 200 && response.body.bcontains(b'projects') &&
      response.body.bcontains(b'startAt') && response.body.bcontains(b'maxResults')
    request:
      method: GET
      path: /rest/api/2/project?maxResults=100
  r5:
    expression: response.status == 200 && response.body.bcontains(b'self') && response.body.bcontains(b'description')
      && response.body.bcontains(b'name') && response.headers["set-cookie"].icontains("atlassian.xsrf.token")
    request:
      method: GET
      path: /rest/api/2/resolution
  r6:
    expression: response.status == 200 && response.body.bcontains(b'"id":') && response.body.bcontains(b'"name":')
      && response.body.bcontains(b'"description":')
    request:
      method: GET
      path: /rest/api/2/screens
  r7:
    expression: response.body.bcontains(b'user-picker')
    request:
      method: GET
      path: /secure/popups/UserPickerBrowser.jspa
