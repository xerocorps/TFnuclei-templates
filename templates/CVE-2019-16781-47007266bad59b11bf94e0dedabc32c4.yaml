http:
- extractors:
  - group: 1
    name: version_by_generator
    regex:
    - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
    type: regex
  - group: 1
    name: version_by_js
    regex:
    - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
    type: regex
  - group: 1
    name: version_by_css
    regex:
    - install\.min\.css\?ver=((\d+\.?)+)\b
    type: regex
  matchers:
  - dsl:
    - compare_versions(version_by_generator, '>= 5.2', '<= 5.2.4')
    - compare_versions(version_by_js, '>= 5.2', '<= 5.2.4')
    - compare_versions(version_by_css, '>= 5.2', '<= 5.2.4')
    type: dsl
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/wp-admin/install.php'
  - '{{BaseURL}}/feed/'
  - '{{BaseURL}}/?feed=rss2'
  redirects: true
  stop-at-first-match: true
id: CVE-2019-16781-47007266bad59b11bf94e0dedabc32c4
info:
  author: topscoder
  classification:
    cve-id: CVE-2019-16781
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:N/A:N
    cvss-score: 5.8
  description: 'In WordPress before 5.3.1, authenticated users with lower privileges
    (like contributors) can inject JavaScript code in the block editor, which is executed
    within the dashboard. It can lead to an admin opening the affected post in the
    editor leading to XSS.

    '
  metadata:
    shodan-query: vuln:CVE-2019-16781
  name: 'WordPress Core < 5.3.1 - Authenticated Stored Cross-Site Scripting

    '
  reference:
  - https://github.com/topscoder/nuclei-wordfence-cve
  - https://www.wordfence.com/threat-intel/vulnerabilities/id/149eb7ef-be96-442e-925e-01d8d76e3a1a?source=api-prod
  severity: low
  tags: cve,wordpress,wp-core,low
