http:
- extractors:
  - group: 1
    name: version
    part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - dsl:
    - compare_versions(version, '7.x-1.2')
    - compare_versions(version, '7.x-1.1')
    - compare_versions(version, '7.x-1.0')
    type: dsl
  matchers:
  - part: body
    regex:
    - version = "([0-9]+\.x-[0-9]+\.[0-9]+)"
    type: regex
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - role_delegation
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/sites/all/modules/role_delegation/role_delegation.info'
  redirects: true
id: drupal_module-role_delegation-privilege-escalation
info:
  author: Bishopfox
  description: This module allows site administrators to grant specific roles the
    authority to assign selected roles to users, without them needing the administer
    permissions permission. The module contains an access bypass vulnerability when
    used in combination with the Views Bulk Operations module. An authenticated user
    is able to assign the administrator role to his own user.  This vulnerability
    is mitigated by the fact that an attacker must have access to an overview of users
    with the views bulk operations module enabled. E.g. The admin_views module provides
    such a view.
  metadata:
    created_at: '0001-01-01T00:00:00Z'
    fofa-query: /sites/all/modules/role_delegation/
    google-query: inurl:'/sites/all/modules/role_delegation/
    impact: medium
    security-risk: "Moderately critical 14\u221525 AC:Basic/A:User/CI:Some/II:Some/E:Proof/TD:Default"
    type: indicator
    vulnerability: privilege-escalation
  name: drupal_module-role_delegation-privilege-escalation
  reference:
  - https://www.drupal.org/sa-contrib-2022-031
  severity: medium
  tags: drupal
