http:
- extractors:
  - group: 1
    internal: true
    name: hash
    part: body
    regex:
    - name="__hash__" content="([0-9a-z_]+)"
    type: regex
  host-redirects: true
  matchers:
  - condition: and
    part: body_2
    type: word
    words:
    - Login Successfully! Loading...
  - status:
    - 200
    type: status
  matchers-condition: and
  max-redirects: 2
  raw:
  - 'GET /index.php/Home/login/index.html HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /index.php/Home/Login/login_post.html HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    saas=default&account={{username}}&password={{base64(password)}}&to=admin&app=&__hash__={{hash}}&__hash__={{hash}}&submit=

    '
id: bigant-default-login
info:
  author: ritikchaddha
  classification:
    cwe-id: CWE-522
  description: 'Misconfiguratoin leads to Default Login into BigAnt Super Admin Account.

    '
  metadata:
    fofa-query: title="BigAnt"
    max-request: 2
    shodan-query: title:"BigAnt"
    verified: true
  name: BigAnt - Default Password
  reference:
  - https://www.bigantsoft.com/support/faq/2-4_How_to_switch_login_accounts_System_admin_Security_admin_Audit_admin_super_admin.html#:~:text=How%2Dto-,How%20to%20switch%20login%20accounts%3A%20System%20admin%2FSecurity%20admin%2F,password%20is%20123456%20by%20default.
  severity: critical
  tags: default-login,bigant
variables:
  password: '123456'
  username: superadmin
