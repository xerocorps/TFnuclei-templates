http:
- extractors:
  - group: 1
    internal: true
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  - group: 1
    name: version
    part: body
    regex:
    - '(?mi)Stable tag: ([0-9.]+)'
    type: regex
  matchers:
  - status:
    - 200
    type: status
  - part: body
    type: word
    words:
    - wp-cerber
  - dsl:
    - compare_versions(version, '<= 9.0')
    type: dsl
  matchers-condition: and
  max-redirects: 3
  method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/wp-cerber/readme.txt'
  redirects: true
id: CVE-2022-2939
info:
  author: topscoder
  classification:
    cve-id: CVE-2022-2939
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
  description: The WP Cerber Security plugin for WordPress is vulnerable to security
    protection bypass in versions up to, and including 9.0, that makes user enumeration
    possible. This is due to improper validation on the value supplied through the
    'author' parameter found in the ~/cerber-load.php file. In vulnerable versions,
    the plugin only blocks requests if the value supplied is numeric, making it possible
    for attackers to supply additional non-numeric characters to bypass the protection.
    The non-numeric characters are stripped and the user requested is displayed.  This
    can be used by unauthenticated attackers to gather information about users that
    can targeted in further attacks.
  metadata:
    fofa-query: wp-content/plugins/wp-cerber/
    google-query: inurl:"/wp-content/plugins/wp-cerber/"
    shodan-query: vuln:CVE-2022-2939
  name: WP Cerber Security <= 9.0 - User Enumeration Bypass
  reference:
  - https://www.wordfence.com/vulnerability-advisories/#CVE-2022-2939
  - https://plugins.trac.wordpress.org/changeset/2772930/wp-cerber/trunk/cerber-load.php
  severity: medium
  tags: cve,wordpress,wp-plugin,wp-cerber,medium
